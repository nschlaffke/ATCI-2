Params 2000 0.100 0.00 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.073105 seconds. 
  Full-batch training loss = 0.605107, test loss = 0.648095
  Training set accuracy = 0.813000, Test set accuracy = 0.796900
 epoch 2/30. Took 0.036489 seconds. 
  Full-batch training loss = 0.362009, test loss = 0.425913
  Training set accuracy = 0.898500, Test set accuracy = 0.877700
 epoch 3/30. Took 0.034303 seconds. 
  Full-batch training loss = 0.283605, test loss = 0.381945
  Training set accuracy = 0.919500, Test set accuracy = 0.888900
 epoch 4/30. Took 0.031834 seconds. 
  Full-batch training loss = 0.246315, test loss = 0.375551
  Training set accuracy = 0.934500, Test set accuracy = 0.888600
 epoch 5/30. Took 0.034426 seconds. 
  Full-batch training loss = 0.206023, test loss = 0.352228
  Training set accuracy = 0.945500, Test set accuracy = 0.896900
 epoch 6/30. Took 0.03254 seconds. 
  Full-batch training loss = 0.178623, test loss = 0.359768
  Training set accuracy = 0.954000, Test set accuracy = 0.897300
 epoch 7/30. Took 0.032516 seconds. 
  Full-batch training loss = 0.145921, test loss = 0.344413
  Training set accuracy = 0.966000, Test set accuracy = 0.898000
 epoch 8/30. Took 0.036871 seconds. 
  Full-batch training loss = 0.140352, test loss = 0.351169
  Training set accuracy = 0.965000, Test set accuracy = 0.895500
 epoch 9/30. Took 0.036458 seconds. 
  Full-batch training loss = 0.108281, test loss = 0.333880
  Training set accuracy = 0.975000, Test set accuracy = 0.902000
 epoch 10/30. Took 0.036584 seconds. 
  Full-batch training loss = 0.095179, test loss = 0.348167
  Training set accuracy = 0.980000, Test set accuracy = 0.899200
 epoch 11/30. Took 0.036508 seconds. 
  Full-batch training loss = 0.079515, test loss = 0.339880
  Training set accuracy = 0.986500, Test set accuracy = 0.902100
 epoch 12/30. Took 0.032644 seconds. 
  Full-batch training loss = 0.066425, test loss = 0.337264
  Training set accuracy = 0.992000, Test set accuracy = 0.904700
 epoch 13/30. Took 0.037868 seconds. 
  Full-batch training loss = 0.058446, test loss = 0.336578
  Training set accuracy = 0.994000, Test set accuracy = 0.904200
 epoch 14/30. Took 0.037164 seconds. 
  Full-batch training loss = 0.054822, test loss = 0.340864
  Training set accuracy = 0.995500, Test set accuracy = 0.906200
 epoch 15/30. Took 0.036494 seconds. 
  Full-batch training loss = 0.044100, test loss = 0.338352
  Training set accuracy = 0.997000, Test set accuracy = 0.905700
 epoch 16/30. Took 0.037626 seconds. 
  Full-batch training loss = 0.041071, test loss = 0.343246
  Training set accuracy = 0.998000, Test set accuracy = 0.905600
 epoch 17/30. Took 0.032935 seconds. 
  Full-batch training loss = 0.040803, test loss = 0.354123
  Training set accuracy = 0.996500, Test set accuracy = 0.904600
 epoch 18/30. Took 0.036998 seconds. 
  Full-batch training loss = 0.037026, test loss = 0.349244
  Training set accuracy = 0.996500, Test set accuracy = 0.905000
 epoch 19/30. Took 0.037193 seconds. 
  Full-batch training loss = 0.029463, test loss = 0.348060
  Training set accuracy = 0.999000, Test set accuracy = 0.907800
 epoch 20/30. Took 0.037228 seconds. 
  Full-batch training loss = 0.029213, test loss = 0.355555
  Training set accuracy = 0.999500, Test set accuracy = 0.907100
 epoch 21/30. Took 0.037539 seconds. 
  Full-batch training loss = 0.023051, test loss = 0.355355
  Training set accuracy = 1.000000, Test set accuracy = 0.907100
 epoch 22/30. Took 0.036587 seconds. 
  Full-batch training loss = 0.019970, test loss = 0.352044
  Training set accuracy = 0.999500, Test set accuracy = 0.907800
 epoch 23/30. Took 0.033787 seconds. 
  Full-batch training loss = 0.018823, test loss = 0.354158
  Training set accuracy = 1.000000, Test set accuracy = 0.909100
 epoch 24/30. Took 0.033962 seconds. 
  Full-batch training loss = 0.017130, test loss = 0.356204
  Training set accuracy = 0.999500, Test set accuracy = 0.908800
 epoch 25/30. Took 0.037575 seconds. 
  Full-batch training loss = 0.016226, test loss = 0.358640
  Training set accuracy = 1.000000, Test set accuracy = 0.909800
 epoch 26/30. Took 0.044663 seconds. 
  Full-batch training loss = 0.014960, test loss = 0.362404
  Training set accuracy = 1.000000, Test set accuracy = 0.909000
 epoch 27/30. Took 0.036969 seconds. 
  Full-batch training loss = 0.013691, test loss = 0.361599
  Training set accuracy = 1.000000, Test set accuracy = 0.909100
 epoch 28/30. Took 0.036112 seconds. 
  Full-batch training loss = 0.012919, test loss = 0.362184
  Training set accuracy = 1.000000, Test set accuracy = 0.909300
 epoch 29/30. Took 0.03366 seconds. 
  Full-batch training loss = 0.012143, test loss = 0.363983
  Training set accuracy = 1.000000, Test set accuracy = 0.909500
 epoch 30/30. Took 0.032861 seconds. 
  Full-batch training loss = 0.011350, test loss = 0.365604
  Training set accuracy = 1.000000, Test set accuracy = 0.910300
Elapsed time is 4.709975 seconds.
End Training
-----
Params 2000 0.100 0.00 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.065129 seconds. 
  Full-batch training loss = 0.535793, test loss = 0.583591
  Training set accuracy = 0.840000, Test set accuracy = 0.820100
 epoch 2/30. Took 0.057165 seconds. 
  Full-batch training loss = 0.361069, test loss = 0.449960
  Training set accuracy = 0.892000, Test set accuracy = 0.862100
 epoch 3/30. Took 0.063165 seconds. 
  Full-batch training loss = 0.274777, test loss = 0.403829
  Training set accuracy = 0.919000, Test set accuracy = 0.876200
 epoch 4/30. Took 0.066091 seconds. 
  Full-batch training loss = 0.211622, test loss = 0.355085
  Training set accuracy = 0.947500, Test set accuracy = 0.894400
 epoch 5/30. Took 0.068917 seconds. 
  Full-batch training loss = 0.173548, test loss = 0.338756
  Training set accuracy = 0.958000, Test set accuracy = 0.897900
 epoch 6/30. Took 0.063403 seconds. 
  Full-batch training loss = 0.145523, test loss = 0.329550
  Training set accuracy = 0.969500, Test set accuracy = 0.902000
 epoch 7/30. Took 0.066656 seconds. 
  Full-batch training loss = 0.176240, test loss = 0.368879
  Training set accuracy = 0.947500, Test set accuracy = 0.890100
 epoch 8/30. Took 0.065042 seconds. 
  Full-batch training loss = 0.105639, test loss = 0.325118
  Training set accuracy = 0.980000, Test set accuracy = 0.904100
 epoch 9/30. Took 0.06406 seconds. 
  Full-batch training loss = 0.090358, test loss = 0.318605
  Training set accuracy = 0.982500, Test set accuracy = 0.906200
 epoch 10/30. Took 0.065902 seconds. 
  Full-batch training loss = 0.094766, test loss = 0.334789
  Training set accuracy = 0.981000, Test set accuracy = 0.899600
 epoch 11/30. Took 0.06281 seconds. 
  Full-batch training loss = 0.062542, test loss = 0.313362
  Training set accuracy = 0.992000, Test set accuracy = 0.908100
 epoch 12/30. Took 0.058196 seconds. 
  Full-batch training loss = 0.053605, test loss = 0.311817
  Training set accuracy = 0.992500, Test set accuracy = 0.909400
 epoch 13/30. Took 0.064598 seconds. 
  Full-batch training loss = 0.046468, test loss = 0.312300
  Training set accuracy = 0.994500, Test set accuracy = 0.911100
 epoch 14/30. Took 0.060832 seconds. 
  Full-batch training loss = 0.041571, test loss = 0.325143
  Training set accuracy = 0.998000, Test set accuracy = 0.906600
 epoch 15/30. Took 0.057195 seconds. 
  Full-batch training loss = 0.033734, test loss = 0.318878
  Training set accuracy = 0.999500, Test set accuracy = 0.911900
 epoch 16/30. Took 0.076529 seconds. 
  Full-batch training loss = 0.030038, test loss = 0.325286
  Training set accuracy = 1.000000, Test set accuracy = 0.909800
 epoch 17/30. Took 0.062388 seconds. 
  Full-batch training loss = 0.026874, test loss = 0.328780
  Training set accuracy = 1.000000, Test set accuracy = 0.909800
 epoch 18/30. Took 0.059771 seconds. 
  Full-batch training loss = 0.024600, test loss = 0.329785
  Training set accuracy = 1.000000, Test set accuracy = 0.910000
 epoch 19/30. Took 0.070232 seconds. 
  Full-batch training loss = 0.021785, test loss = 0.322250
  Training set accuracy = 1.000000, Test set accuracy = 0.912600
 epoch 20/30. Took 0.059208 seconds. 
  Full-batch training loss = 0.020350, test loss = 0.329310
  Training set accuracy = 1.000000, Test set accuracy = 0.911500
 epoch 21/30. Took 0.065288 seconds. 
  Full-batch training loss = 0.018078, test loss = 0.332180
  Training set accuracy = 1.000000, Test set accuracy = 0.911700
 epoch 22/30. Took 0.071278 seconds. 
  Full-batch training loss = 0.017034, test loss = 0.328609
  Training set accuracy = 1.000000, Test set accuracy = 0.913500
 epoch 23/30. Took 0.060594 seconds. 
  Full-batch training loss = 0.016082, test loss = 0.331167
  Training set accuracy = 1.000000, Test set accuracy = 0.913300
 epoch 24/30. Took 0.065453 seconds. 
  Full-batch training loss = 0.014321, test loss = 0.335379
  Training set accuracy = 1.000000, Test set accuracy = 0.912700
 epoch 25/30. Took 0.067181 seconds. 
  Full-batch training loss = 0.013179, test loss = 0.334440
  Training set accuracy = 1.000000, Test set accuracy = 0.913100
 epoch 26/30. Took 0.068194 seconds. 
  Full-batch training loss = 0.012381, test loss = 0.336727
  Training set accuracy = 1.000000, Test set accuracy = 0.913200
 epoch 27/30. Took 0.067685 seconds. 
  Full-batch training loss = 0.011643, test loss = 0.341604
  Training set accuracy = 1.000000, Test set accuracy = 0.911800
 epoch 28/30. Took 0.080856 seconds. 
  Full-batch training loss = 0.010962, test loss = 0.342590
  Training set accuracy = 1.000000, Test set accuracy = 0.913300
 epoch 29/30. Took 0.07081 seconds. 
  Full-batch training loss = 0.010439, test loss = 0.345708
  Training set accuracy = 1.000000, Test set accuracy = 0.912300
 epoch 30/30. Took 0.071267 seconds. 
  Full-batch training loss = 0.010032, test loss = 0.347792
  Training set accuracy = 1.000000, Test set accuracy = 0.912700
Elapsed time is 7.883285 seconds.
End Training
-----
Params 2000 0.100 0.00 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.13863 seconds. 
  Full-batch training loss = 0.495629, test loss = 0.534542
  Training set accuracy = 0.852500, Test set accuracy = 0.838100
 epoch 2/30. Took 0.13331 seconds. 
  Full-batch training loss = 0.325848, test loss = 0.409359
  Training set accuracy = 0.905500, Test set accuracy = 0.878600
 epoch 3/30. Took 0.13161 seconds. 
  Full-batch training loss = 0.270389, test loss = 0.388605
  Training set accuracy = 0.920500, Test set accuracy = 0.886600
 epoch 4/30. Took 0.12906 seconds. 
  Full-batch training loss = 0.193389, test loss = 0.339040
  Training set accuracy = 0.947000, Test set accuracy = 0.898700
 epoch 5/30. Took 0.14197 seconds. 
  Full-batch training loss = 0.155763, test loss = 0.328959
  Training set accuracy = 0.962500, Test set accuracy = 0.900500
 epoch 6/30. Took 0.13699 seconds. 
  Full-batch training loss = 0.133874, test loss = 0.322373
  Training set accuracy = 0.967500, Test set accuracy = 0.905300
 epoch 7/30. Took 0.12116 seconds. 
  Full-batch training loss = 0.114846, test loss = 0.322189
  Training set accuracy = 0.974000, Test set accuracy = 0.905800
 epoch 8/30. Took 0.13842 seconds. 
  Full-batch training loss = 0.090817, test loss = 0.307850
  Training set accuracy = 0.982000, Test set accuracy = 0.910600
 epoch 9/30. Took 0.14079 seconds. 
  Full-batch training loss = 0.080807, test loss = 0.309019
  Training set accuracy = 0.986500, Test set accuracy = 0.911800
 epoch 10/30. Took 0.14816 seconds. 
  Full-batch training loss = 0.068020, test loss = 0.305640
  Training set accuracy = 0.992500, Test set accuracy = 0.913200
 epoch 11/30. Took 0.14693 seconds. 
  Full-batch training loss = 0.057016, test loss = 0.312778
  Training set accuracy = 0.994000, Test set accuracy = 0.911100
 epoch 12/30. Took 0.13453 seconds. 
  Full-batch training loss = 0.047825, test loss = 0.311961
  Training set accuracy = 0.996500, Test set accuracy = 0.911600
 epoch 13/30. Took 0.15018 seconds. 
  Full-batch training loss = 0.046350, test loss = 0.313253
  Training set accuracy = 0.995500, Test set accuracy = 0.910600
 epoch 14/30. Took 0.12283 seconds. 
  Full-batch training loss = 0.035907, test loss = 0.303020
  Training set accuracy = 0.999000, Test set accuracy = 0.913900
 epoch 15/30. Took 0.12464 seconds. 
  Full-batch training loss = 0.029806, test loss = 0.303374
  Training set accuracy = 1.000000, Test set accuracy = 0.915600
 epoch 16/30. Took 0.12244 seconds. 
  Full-batch training loss = 0.028072, test loss = 0.310839
  Training set accuracy = 1.000000, Test set accuracy = 0.913300
 epoch 17/30. Took 0.11943 seconds. 
  Full-batch training loss = 0.023632, test loss = 0.306069
  Training set accuracy = 1.000000, Test set accuracy = 0.915800
 epoch 18/30. Took 0.1238 seconds. 
  Full-batch training loss = 0.020069, test loss = 0.306520
  Training set accuracy = 1.000000, Test set accuracy = 0.915400
 epoch 19/30. Took 0.15526 seconds. 
  Full-batch training loss = 0.018576, test loss = 0.311448
  Training set accuracy = 1.000000, Test set accuracy = 0.916200
 epoch 20/30. Took 0.12954 seconds. 
  Full-batch training loss = 0.017964, test loss = 0.312038
  Training set accuracy = 1.000000, Test set accuracy = 0.916700
 epoch 21/30. Took 0.13462 seconds. 
  Full-batch training loss = 0.016697, test loss = 0.316868
  Training set accuracy = 1.000000, Test set accuracy = 0.917600
 epoch 22/30. Took 0.14572 seconds. 
  Full-batch training loss = 0.014236, test loss = 0.311643
  Training set accuracy = 1.000000, Test set accuracy = 0.918200
 epoch 23/30. Took 0.12 seconds. 
  Full-batch training loss = 0.013711, test loss = 0.314903
  Training set accuracy = 1.000000, Test set accuracy = 0.916600
 epoch 24/30. Took 0.14488 seconds. 
  Full-batch training loss = 0.012394, test loss = 0.315637
  Training set accuracy = 1.000000, Test set accuracy = 0.918200
 epoch 25/30. Took 0.12273 seconds. 
  Full-batch training loss = 0.011866, test loss = 0.318142
  Training set accuracy = 1.000000, Test set accuracy = 0.916600
 epoch 26/30. Took 0.12092 seconds. 
  Full-batch training loss = 0.011079, test loss = 0.319653
  Training set accuracy = 1.000000, Test set accuracy = 0.917500
 epoch 27/30. Took 0.12134 seconds. 
  Full-batch training loss = 0.010468, test loss = 0.320450
  Training set accuracy = 1.000000, Test set accuracy = 0.918400
 epoch 28/30. Took 0.13911 seconds. 
  Full-batch training loss = 0.009815, test loss = 0.319354
  Training set accuracy = 1.000000, Test set accuracy = 0.918100
 epoch 29/30. Took 0.11895 seconds. 
  Full-batch training loss = 0.009343, test loss = 0.320867
  Training set accuracy = 1.000000, Test set accuracy = 0.918200
 epoch 30/30. Took 0.12145 seconds. 
  Full-batch training loss = 0.008960, test loss = 0.325255
  Training set accuracy = 1.000000, Test set accuracy = 0.918900
Elapsed time is 13.766647 seconds.
End Training
-----
Params 2000 0.100 0.00 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.053387 seconds. 
  Full-batch training loss = 0.762929, test loss = 0.793671
  Training set accuracy = 0.744500, Test set accuracy = 0.738700
 epoch 2/30. Took 0.042154 seconds. 
  Full-batch training loss = 0.332613, test loss = 0.402666
  Training set accuracy = 0.914500, Test set accuracy = 0.878100
 epoch 3/30. Took 0.046181 seconds. 
  Full-batch training loss = 0.268781, test loss = 0.379413
  Training set accuracy = 0.923500, Test set accuracy = 0.885400
 epoch 4/30. Took 0.04631 seconds. 
  Full-batch training loss = 0.196939, test loss = 0.344711
  Training set accuracy = 0.948000, Test set accuracy = 0.894500
 epoch 5/30. Took 0.041256 seconds. 
  Full-batch training loss = 0.204450, test loss = 0.390505
  Training set accuracy = 0.934500, Test set accuracy = 0.878400
 epoch 6/30. Took 0.040692 seconds. 
  Full-batch training loss = 0.118031, test loss = 0.313284
  Training set accuracy = 0.971000, Test set accuracy = 0.906800
 epoch 7/30. Took 0.042548 seconds. 
  Full-batch training loss = 0.091651, test loss = 0.322306
  Training set accuracy = 0.975000, Test set accuracy = 0.903000
 epoch 8/30. Took 0.040789 seconds. 
  Full-batch training loss = 0.091390, test loss = 0.337551
  Training set accuracy = 0.974000, Test set accuracy = 0.901700
 epoch 9/30. Took 0.04623 seconds. 
  Full-batch training loss = 0.054744, test loss = 0.315259
  Training set accuracy = 0.988500, Test set accuracy = 0.910900
 epoch 10/30. Took 0.045703 seconds. 
  Full-batch training loss = 0.039464, test loss = 0.320257
  Training set accuracy = 0.995500, Test set accuracy = 0.912300
 epoch 11/30. Took 0.043843 seconds. 
  Full-batch training loss = 0.040605, test loss = 0.334098
  Training set accuracy = 0.990500, Test set accuracy = 0.907300
 epoch 12/30. Took 0.041645 seconds. 
  Full-batch training loss = 0.035175, test loss = 0.342904
  Training set accuracy = 0.994500, Test set accuracy = 0.906300
 epoch 13/30. Took 0.042832 seconds. 
  Full-batch training loss = 0.018341, test loss = 0.323729
  Training set accuracy = 0.997500, Test set accuracy = 0.912900
 epoch 14/30. Took 0.046258 seconds. 
  Full-batch training loss = 0.013691, test loss = 0.329703
  Training set accuracy = 1.000000, Test set accuracy = 0.913100
 epoch 15/30. Took 0.047519 seconds. 
  Full-batch training loss = 0.010685, test loss = 0.329366
  Training set accuracy = 1.000000, Test set accuracy = 0.916200
 epoch 16/30. Took 0.044583 seconds. 
  Full-batch training loss = 0.011771, test loss = 0.351348
  Training set accuracy = 1.000000, Test set accuracy = 0.912100
 epoch 17/30. Took 0.045636 seconds. 
  Full-batch training loss = 0.007878, test loss = 0.335344
  Training set accuracy = 1.000000, Test set accuracy = 0.917000
 epoch 18/30. Took 0.040056 seconds. 
  Full-batch training loss = 0.007048, test loss = 0.345632
  Training set accuracy = 1.000000, Test set accuracy = 0.915600
 epoch 19/30. Took 0.043183 seconds. 
  Full-batch training loss = 0.006285, test loss = 0.343229
  Training set accuracy = 1.000000, Test set accuracy = 0.917100
 epoch 20/30. Took 0.039904 seconds. 
  Full-batch training loss = 0.005425, test loss = 0.350482
  Training set accuracy = 1.000000, Test set accuracy = 0.918000
 epoch 21/30. Took 0.040803 seconds. 
  Full-batch training loss = 0.004979, test loss = 0.350105
  Training set accuracy = 1.000000, Test set accuracy = 0.918500
 epoch 22/30. Took 0.040962 seconds. 
  Full-batch training loss = 0.004465, test loss = 0.352995
  Training set accuracy = 1.000000, Test set accuracy = 0.918300
 epoch 23/30. Took 0.041406 seconds. 
  Full-batch training loss = 0.004136, test loss = 0.351811
  Training set accuracy = 1.000000, Test set accuracy = 0.918600
 epoch 24/30. Took 0.046257 seconds. 
  Full-batch training loss = 0.003756, test loss = 0.358896
  Training set accuracy = 1.000000, Test set accuracy = 0.918400
 epoch 25/30. Took 0.045153 seconds. 
  Full-batch training loss = 0.003585, test loss = 0.362970
  Training set accuracy = 1.000000, Test set accuracy = 0.918500
 epoch 26/30. Took 0.045637 seconds. 
  Full-batch training loss = 0.003363, test loss = 0.362118
  Training set accuracy = 1.000000, Test set accuracy = 0.918300
 epoch 27/30. Took 0.041632 seconds. 
  Full-batch training loss = 0.003082, test loss = 0.362988
  Training set accuracy = 1.000000, Test set accuracy = 0.919100
 epoch 28/30. Took 0.04444 seconds. 
  Full-batch training loss = 0.002903, test loss = 0.368313
  Training set accuracy = 1.000000, Test set accuracy = 0.918400
 epoch 29/30. Took 0.041934 seconds. 
  Full-batch training loss = 0.002720, test loss = 0.370490
  Training set accuracy = 1.000000, Test set accuracy = 0.918700
 epoch 30/30. Took 0.044766 seconds. 
  Full-batch training loss = 0.002593, test loss = 0.373095
  Training set accuracy = 1.000000, Test set accuracy = 0.918700
Elapsed time is 5.891653 seconds.
End Training
-----
Params 2000 0.100 0.00 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.085861 seconds. 
  Full-batch training loss = 0.688382, test loss = 0.690291
  Training set accuracy = 0.787000, Test set accuracy = 0.790200
 epoch 2/30. Took 0.071609 seconds. 
  Full-batch training loss = 0.376182, test loss = 0.422333
  Training set accuracy = 0.891500, Test set accuracy = 0.876700
 epoch 3/30. Took 0.080927 seconds. 
  Full-batch training loss = 0.328074, test loss = 0.420720
  Training set accuracy = 0.897500, Test set accuracy = 0.873800
 epoch 4/30. Took 0.085208 seconds. 
  Full-batch training loss = 0.193862, test loss = 0.334792
  Training set accuracy = 0.950500, Test set accuracy = 0.901900
 epoch 5/30. Took 0.087474 seconds. 
  Full-batch training loss = 0.144233, test loss = 0.300898
  Training set accuracy = 0.963500, Test set accuracy = 0.910200
 epoch 6/30. Took 0.083825 seconds. 
  Full-batch training loss = 0.122932, test loss = 0.316124
  Training set accuracy = 0.970000, Test set accuracy = 0.909800
 epoch 7/30. Took 0.070258 seconds. 
  Full-batch training loss = 0.079941, test loss = 0.298786
  Training set accuracy = 0.985000, Test set accuracy = 0.913500
 epoch 8/30. Took 0.071544 seconds. 
  Full-batch training loss = 0.054915, test loss = 0.288893
  Training set accuracy = 0.991000, Test set accuracy = 0.919700
 epoch 9/30. Took 0.085284 seconds. 
  Full-batch training loss = 0.051961, test loss = 0.301198
  Training set accuracy = 0.991500, Test set accuracy = 0.916300
 epoch 10/30. Took 0.087305 seconds. 
  Full-batch training loss = 0.029709, test loss = 0.297168
  Training set accuracy = 0.998000, Test set accuracy = 0.919200
 epoch 11/30. Took 0.080747 seconds. 
  Full-batch training loss = 0.022963, test loss = 0.301971
  Training set accuracy = 0.999000, Test set accuracy = 0.920500
 epoch 12/30. Took 0.072035 seconds. 
  Full-batch training loss = 0.024457, test loss = 0.320988
  Training set accuracy = 0.999000, Test set accuracy = 0.914200
 epoch 13/30. Took 0.072321 seconds. 
  Full-batch training loss = 0.017190, test loss = 0.313849
  Training set accuracy = 1.000000, Test set accuracy = 0.919300
 epoch 14/30. Took 0.069983 seconds. 
  Full-batch training loss = 0.011377, test loss = 0.323097
  Training set accuracy = 1.000000, Test set accuracy = 0.919400
 epoch 15/30. Took 0.072235 seconds. 
  Full-batch training loss = 0.008237, test loss = 0.313890
  Training set accuracy = 1.000000, Test set accuracy = 0.922600
 epoch 16/30. Took 0.071056 seconds. 
  Full-batch training loss = 0.006999, test loss = 0.319340
  Training set accuracy = 1.000000, Test set accuracy = 0.923000
 epoch 17/30. Took 0.080526 seconds. 
  Full-batch training loss = 0.006276, test loss = 0.325262
  Training set accuracy = 1.000000, Test set accuracy = 0.922300
 epoch 18/30. Took 0.06843 seconds. 
  Full-batch training loss = 0.006040, test loss = 0.327138
  Training set accuracy = 1.000000, Test set accuracy = 0.919800
 epoch 19/30. Took 0.070435 seconds. 
  Full-batch training loss = 0.004953, test loss = 0.330730
  Training set accuracy = 1.000000, Test set accuracy = 0.921600
 epoch 20/30. Took 0.069463 seconds. 
  Full-batch training loss = 0.004582, test loss = 0.336566
  Training set accuracy = 1.000000, Test set accuracy = 0.922100
 epoch 21/30. Took 0.08272 seconds. 
  Full-batch training loss = 0.004111, test loss = 0.336266
  Training set accuracy = 1.000000, Test set accuracy = 0.922600
 epoch 22/30. Took 0.069593 seconds. 
  Full-batch training loss = 0.003908, test loss = 0.340880
  Training set accuracy = 1.000000, Test set accuracy = 0.922500
 epoch 23/30. Took 0.07092 seconds. 
  Full-batch training loss = 0.003522, test loss = 0.341931
  Training set accuracy = 1.000000, Test set accuracy = 0.922500
 epoch 24/30. Took 0.078679 seconds. 
  Full-batch training loss = 0.003275, test loss = 0.343708
  Training set accuracy = 1.000000, Test set accuracy = 0.923000
 epoch 25/30. Took 0.068133 seconds. 
  Full-batch training loss = 0.003127, test loss = 0.345093
  Training set accuracy = 1.000000, Test set accuracy = 0.922500
 epoch 26/30. Took 0.082816 seconds. 
  Full-batch training loss = 0.002980, test loss = 0.350963
  Training set accuracy = 1.000000, Test set accuracy = 0.921700
 epoch 27/30. Took 0.082424 seconds. 
  Full-batch training loss = 0.002721, test loss = 0.350178
  Training set accuracy = 1.000000, Test set accuracy = 0.922800
 epoch 28/30. Took 0.088862 seconds. 
  Full-batch training loss = 0.002648, test loss = 0.357300
  Training set accuracy = 1.000000, Test set accuracy = 0.921400
 epoch 29/30. Took 0.085348 seconds. 
  Full-batch training loss = 0.002468, test loss = 0.355905
  Training set accuracy = 1.000000, Test set accuracy = 0.922600
 epoch 30/30. Took 0.081807 seconds. 
  Full-batch training loss = 0.002318, test loss = 0.356207
  Training set accuracy = 1.000000, Test set accuracy = 0.922600
Elapsed time is 10.329981 seconds.
End Training
-----
Params 2000 0.100 0.00 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23193 seconds. 
  Full-batch training loss = 0.655397, test loss = 0.678062
  Training set accuracy = 0.791000, Test set accuracy = 0.779900
 epoch 2/30. Took 0.22367 seconds. 
  Full-batch training loss = 0.320319, test loss = 0.421829
  Training set accuracy = 0.904500, Test set accuracy = 0.872000
 epoch 3/30. Took 0.19867 seconds. 
  Full-batch training loss = 0.252111, test loss = 0.377384
  Training set accuracy = 0.930500, Test set accuracy = 0.886500
 epoch 4/30. Took 0.21524 seconds. 
  Full-batch training loss = 0.164834, test loss = 0.335647
  Training set accuracy = 0.952500, Test set accuracy = 0.895500
 epoch 5/30. Took 0.25605 seconds. 
  Full-batch training loss = 0.105954, test loss = 0.313834
  Training set accuracy = 0.978500, Test set accuracy = 0.906000
 epoch 6/30. Took 0.20272 seconds. 
  Full-batch training loss = 0.084215, test loss = 0.308351
  Training set accuracy = 0.983000, Test set accuracy = 0.906400
 epoch 7/30. Took 0.21699 seconds. 
  Full-batch training loss = 0.061298, test loss = 0.301675
  Training set accuracy = 0.987500, Test set accuracy = 0.910300
 epoch 8/30. Took 0.20254 seconds. 
  Full-batch training loss = 0.044678, test loss = 0.320583
  Training set accuracy = 0.994500, Test set accuracy = 0.904700
 epoch 9/30. Took 0.22085 seconds. 
  Full-batch training loss = 0.033504, test loss = 0.306169
  Training set accuracy = 0.994500, Test set accuracy = 0.913800
 epoch 10/30. Took 0.24209 seconds. 
  Full-batch training loss = 0.022281, test loss = 0.310694
  Training set accuracy = 0.998000, Test set accuracy = 0.916200
 epoch 11/30. Took 0.25921 seconds. 
  Full-batch training loss = 0.017124, test loss = 0.322508
  Training set accuracy = 0.999500, Test set accuracy = 0.912100
 epoch 12/30. Took 0.20328 seconds. 
  Full-batch training loss = 0.014863, test loss = 0.317935
  Training set accuracy = 1.000000, Test set accuracy = 0.916300
 epoch 13/30. Took 0.23388 seconds. 
  Full-batch training loss = 0.010438, test loss = 0.319529
  Training set accuracy = 1.000000, Test set accuracy = 0.915300
 epoch 14/30. Took 0.20357 seconds. 
  Full-batch training loss = 0.008662, test loss = 0.323779
  Training set accuracy = 1.000000, Test set accuracy = 0.916900
 epoch 15/30. Took 0.21321 seconds. 
  Full-batch training loss = 0.007547, test loss = 0.327681
  Training set accuracy = 1.000000, Test set accuracy = 0.916500
 epoch 16/30. Took 0.21465 seconds. 
  Full-batch training loss = 0.006416, test loss = 0.335788
  Training set accuracy = 1.000000, Test set accuracy = 0.916300
 epoch 17/30. Took 0.22468 seconds. 
  Full-batch training loss = 0.006088, test loss = 0.343305
  Training set accuracy = 1.000000, Test set accuracy = 0.915000
 epoch 18/30. Took 0.20134 seconds. 
  Full-batch training loss = 0.005117, test loss = 0.340508
  Training set accuracy = 1.000000, Test set accuracy = 0.916800
 epoch 19/30. Took 0.22969 seconds. 
  Full-batch training loss = 0.004765, test loss = 0.340833
  Training set accuracy = 1.000000, Test set accuracy = 0.918400
 epoch 20/30. Took 0.2166 seconds. 
  Full-batch training loss = 0.004331, test loss = 0.349877
  Training set accuracy = 1.000000, Test set accuracy = 0.916900
 epoch 21/30. Took 0.24613 seconds. 
  Full-batch training loss = 0.003882, test loss = 0.347963
  Training set accuracy = 1.000000, Test set accuracy = 0.916900
 epoch 22/30. Took 0.21118 seconds. 
  Full-batch training loss = 0.003555, test loss = 0.348068
  Training set accuracy = 1.000000, Test set accuracy = 0.917500
 epoch 23/30. Took 0.2364 seconds. 
  Full-batch training loss = 0.003292, test loss = 0.352684
  Training set accuracy = 1.000000, Test set accuracy = 0.917300
 epoch 24/30. Took 0.2188 seconds. 
  Full-batch training loss = 0.003081, test loss = 0.354523
  Training set accuracy = 1.000000, Test set accuracy = 0.918000
 epoch 25/30. Took 0.20248 seconds. 
  Full-batch training loss = 0.002906, test loss = 0.354337
  Training set accuracy = 1.000000, Test set accuracy = 0.918400
 epoch 26/30. Took 0.19612 seconds. 
  Full-batch training loss = 0.002726, test loss = 0.359732
  Training set accuracy = 1.000000, Test set accuracy = 0.917700
 epoch 27/30. Took 0.1987 seconds. 
  Full-batch training loss = 0.002596, test loss = 0.359826
  Training set accuracy = 1.000000, Test set accuracy = 0.916700
 epoch 28/30. Took 0.19574 seconds. 
  Full-batch training loss = 0.002419, test loss = 0.360680
  Training set accuracy = 1.000000, Test set accuracy = 0.917800
 epoch 29/30. Took 0.19774 seconds. 
  Full-batch training loss = 0.002301, test loss = 0.363294
  Training set accuracy = 1.000000, Test set accuracy = 0.917300
 epoch 30/30. Took 0.19515 seconds. 
  Full-batch training loss = 0.002199, test loss = 0.364993
  Training set accuracy = 1.000000, Test set accuracy = 0.917900
Elapsed time is 23.299568 seconds.
End Training
-----
Params 2000 0.100 0.00 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.053089 seconds. 
  Full-batch training loss = 0.711810, test loss = 0.794964
  Training set accuracy = 0.755000, Test set accuracy = 0.721500
 epoch 2/30. Took 0.046566 seconds. 
  Full-batch training loss = 0.360446, test loss = 0.486267
  Training set accuracy = 0.889000, Test set accuracy = 0.851500
 epoch 3/30. Took 0.04668 seconds. 
  Full-batch training loss = 0.271811, test loss = 0.395712
  Training set accuracy = 0.922500, Test set accuracy = 0.880800
 epoch 4/30. Took 0.044546 seconds. 
  Full-batch training loss = 0.179849, test loss = 0.372216
  Training set accuracy = 0.948500, Test set accuracy = 0.884300
 epoch 5/30. Took 0.050133 seconds. 
  Full-batch training loss = 0.139196, test loss = 0.361567
  Training set accuracy = 0.959500, Test set accuracy = 0.899400
 epoch 6/30. Took 0.042426 seconds. 
  Full-batch training loss = 0.102361, test loss = 0.332392
  Training set accuracy = 0.973500, Test set accuracy = 0.903700
 epoch 7/30. Took 0.043061 seconds. 
  Full-batch training loss = 0.059430, test loss = 0.333940
  Training set accuracy = 0.986000, Test set accuracy = 0.910500
 epoch 8/30. Took 0.042786 seconds. 
  Full-batch training loss = 0.040938, test loss = 0.351592
  Training set accuracy = 0.992000, Test set accuracy = 0.913700
 epoch 9/30. Took 0.042829 seconds. 
  Full-batch training loss = 0.026275, test loss = 0.332444
  Training set accuracy = 0.995000, Test set accuracy = 0.915300
 epoch 10/30. Took 0.045478 seconds. 
  Full-batch training loss = 0.017401, test loss = 0.345129
  Training set accuracy = 0.997000, Test set accuracy = 0.916700
 epoch 11/30. Took 0.043098 seconds. 
  Full-batch training loss = 0.010278, test loss = 0.349707
  Training set accuracy = 0.999000, Test set accuracy = 0.917300
 epoch 12/30. Took 0.042843 seconds. 
  Full-batch training loss = 0.008260, test loss = 0.349755
  Training set accuracy = 1.000000, Test set accuracy = 0.917200
 epoch 13/30. Took 0.04283 seconds. 
  Full-batch training loss = 0.005600, test loss = 0.357869
  Training set accuracy = 0.999500, Test set accuracy = 0.919500
 epoch 14/30. Took 0.043025 seconds. 
  Full-batch training loss = 0.004094, test loss = 0.369765
  Training set accuracy = 1.000000, Test set accuracy = 0.918100
 epoch 15/30. Took 0.042812 seconds. 
  Full-batch training loss = 0.003088, test loss = 0.369275
  Training set accuracy = 1.000000, Test set accuracy = 0.920000
 epoch 16/30. Took 0.042909 seconds. 
  Full-batch training loss = 0.002579, test loss = 0.378366
  Training set accuracy = 1.000000, Test set accuracy = 0.919900
 epoch 17/30. Took 0.042902 seconds. 
  Full-batch training loss = 0.002206, test loss = 0.382651
  Training set accuracy = 1.000000, Test set accuracy = 0.920200
 epoch 18/30. Took 0.042983 seconds. 
  Full-batch training loss = 0.002002, test loss = 0.388399
  Training set accuracy = 1.000000, Test set accuracy = 0.920900
 epoch 19/30. Took 0.04298 seconds. 
  Full-batch training loss = 0.001834, test loss = 0.391725
  Training set accuracy = 1.000000, Test set accuracy = 0.919800
 epoch 20/30. Took 0.044383 seconds. 
  Full-batch training loss = 0.001626, test loss = 0.398216
  Training set accuracy = 1.000000, Test set accuracy = 0.920200
 epoch 21/30. Took 0.044854 seconds. 
  Full-batch training loss = 0.001536, test loss = 0.402244
  Training set accuracy = 1.000000, Test set accuracy = 0.920300
 epoch 22/30. Took 0.04719 seconds. 
  Full-batch training loss = 0.001368, test loss = 0.404973
  Training set accuracy = 1.000000, Test set accuracy = 0.921400
 epoch 23/30. Took 0.043965 seconds. 
  Full-batch training loss = 0.001278, test loss = 0.408075
  Training set accuracy = 1.000000, Test set accuracy = 0.920900
 epoch 24/30. Took 0.050513 seconds. 
  Full-batch training loss = 0.001187, test loss = 0.411514
  Training set accuracy = 1.000000, Test set accuracy = 0.921200
 epoch 25/30. Took 0.053114 seconds. 
  Full-batch training loss = 0.001105, test loss = 0.414902
  Training set accuracy = 1.000000, Test set accuracy = 0.920600
 epoch 26/30. Took 0.051092 seconds. 
  Full-batch training loss = 0.001040, test loss = 0.417600
  Training set accuracy = 1.000000, Test set accuracy = 0.921100
 epoch 27/30. Took 0.054817 seconds. 
  Full-batch training loss = 0.000980, test loss = 0.421876
  Training set accuracy = 1.000000, Test set accuracy = 0.920600
 epoch 28/30. Took 0.05508 seconds. 
  Full-batch training loss = 0.000922, test loss = 0.423592
  Training set accuracy = 1.000000, Test set accuracy = 0.920400
 epoch 29/30. Took 0.057286 seconds. 
  Full-batch training loss = 0.000883, test loss = 0.427234
  Training set accuracy = 1.000000, Test set accuracy = 0.920500
 epoch 30/30. Took 0.050425 seconds. 
  Full-batch training loss = 0.000829, test loss = 0.428821
  Training set accuracy = 1.000000, Test set accuracy = 0.921700
Elapsed time is 6.456070 seconds.
End Training
-----
Params 2000 0.100 0.00 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.094378 seconds. 
  Full-batch training loss = 0.866611, test loss = 0.884372
  Training set accuracy = 0.692500, Test set accuracy = 0.689600
 epoch 2/30. Took 0.091873 seconds. 
  Full-batch training loss = 0.394566, test loss = 0.477913
  Training set accuracy = 0.877000, Test set accuracy = 0.849200
 epoch 3/30. Took 0.091477 seconds. 
  Full-batch training loss = 0.226822, test loss = 0.342616
  Training set accuracy = 0.940000, Test set accuracy = 0.897900
 epoch 4/30. Took 0.11323 seconds. 
  Full-batch training loss = 0.196986, test loss = 0.367985
  Training set accuracy = 0.939000, Test set accuracy = 0.888500
 epoch 5/30. Took 0.087027 seconds. 
  Full-batch training loss = 0.103430, test loss = 0.301555
  Training set accuracy = 0.972500, Test set accuracy = 0.908800
 epoch 6/30. Took 0.082663 seconds. 
  Full-batch training loss = 0.074498, test loss = 0.313018
  Training set accuracy = 0.980500, Test set accuracy = 0.906400
 epoch 7/30. Took 0.085142 seconds. 
  Full-batch training loss = 0.057678, test loss = 0.313311
  Training set accuracy = 0.986500, Test set accuracy = 0.913700
 epoch 8/30. Took 0.085425 seconds. 
  Full-batch training loss = 0.193479, test loss = 0.502541
  Training set accuracy = 0.937500, Test set accuracy = 0.866700
 epoch 9/30. Took 0.091412 seconds. 
  Full-batch training loss = 0.043875, test loss = 0.327990
  Training set accuracy = 0.990500, Test set accuracy = 0.905700
 epoch 10/30. Took 0.085229 seconds. 
  Full-batch training loss = 0.020044, test loss = 0.331861
  Training set accuracy = 0.997500, Test set accuracy = 0.913300
 epoch 11/30. Took 0.084496 seconds. 
  Full-batch training loss = 0.014255, test loss = 0.320147
  Training set accuracy = 0.998000, Test set accuracy = 0.918300
 epoch 12/30. Took 0.083907 seconds. 
  Full-batch training loss = 0.006270, test loss = 0.321971
  Training set accuracy = 1.000000, Test set accuracy = 0.921600
 epoch 13/30. Took 0.084759 seconds. 
  Full-batch training loss = 0.003700, test loss = 0.322645
  Training set accuracy = 1.000000, Test set accuracy = 0.923900
 epoch 14/30. Took 0.10968 seconds. 
  Full-batch training loss = 0.002961, test loss = 0.330346
  Training set accuracy = 1.000000, Test set accuracy = 0.924800
 epoch 15/30. Took 0.11078 seconds. 
  Full-batch training loss = 0.002409, test loss = 0.332559
  Training set accuracy = 1.000000, Test set accuracy = 0.924700
 epoch 16/30. Took 0.099257 seconds. 
  Full-batch training loss = 0.002003, test loss = 0.340440
  Training set accuracy = 1.000000, Test set accuracy = 0.924800
 epoch 17/30. Took 0.086304 seconds. 
  Full-batch training loss = 0.001754, test loss = 0.344185
  Training set accuracy = 1.000000, Test set accuracy = 0.924700
 epoch 18/30. Took 0.087379 seconds. 
  Full-batch training loss = 0.001572, test loss = 0.348184
  Training set accuracy = 1.000000, Test set accuracy = 0.926400
 epoch 19/30. Took 0.084938 seconds. 
  Full-batch training loss = 0.001434, test loss = 0.350192
  Training set accuracy = 1.000000, Test set accuracy = 0.926000
 epoch 20/30. Took 0.086148 seconds. 
  Full-batch training loss = 0.001305, test loss = 0.354848
  Training set accuracy = 1.000000, Test set accuracy = 0.926000
 epoch 21/30. Took 0.099878 seconds. 
  Full-batch training loss = 0.001204, test loss = 0.357119
  Training set accuracy = 1.000000, Test set accuracy = 0.925400
 epoch 22/30. Took 0.10201 seconds. 
  Full-batch training loss = 0.001120, test loss = 0.359507
  Training set accuracy = 1.000000, Test set accuracy = 0.926400
 epoch 23/30. Took 0.10152 seconds. 
  Full-batch training loss = 0.001045, test loss = 0.361614
  Training set accuracy = 1.000000, Test set accuracy = 0.925800
 epoch 24/30. Took 0.084948 seconds. 
  Full-batch training loss = 0.000973, test loss = 0.365033
  Training set accuracy = 1.000000, Test set accuracy = 0.926300
 epoch 25/30. Took 0.096453 seconds. 
  Full-batch training loss = 0.000918, test loss = 0.366666
  Training set accuracy = 1.000000, Test set accuracy = 0.926700
 epoch 26/30. Took 0.10726 seconds. 
  Full-batch training loss = 0.000867, test loss = 0.368928
  Training set accuracy = 1.000000, Test set accuracy = 0.926800
 epoch 27/30. Took 0.10191 seconds. 
  Full-batch training loss = 0.000814, test loss = 0.371006
  Training set accuracy = 1.000000, Test set accuracy = 0.926300
 epoch 28/30. Took 0.092598 seconds. 
  Full-batch training loss = 0.000777, test loss = 0.373089
  Training set accuracy = 1.000000, Test set accuracy = 0.926300
 epoch 29/30. Took 0.087483 seconds. 
  Full-batch training loss = 0.000735, test loss = 0.374528
  Training set accuracy = 1.000000, Test set accuracy = 0.926400
 epoch 30/30. Took 0.084708 seconds. 
  Full-batch training loss = 0.000701, test loss = 0.376055
  Training set accuracy = 1.000000, Test set accuracy = 0.927200
Elapsed time is 11.600867 seconds.
End Training
-----
Params 2000 0.100 0.00 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35025 seconds. 
  Full-batch training loss = 0.604347, test loss = 0.632988
  Training set accuracy = 0.810000, Test set accuracy = 0.800300
 epoch 2/30. Took 0.30681 seconds. 
  Full-batch training loss = 0.283000, test loss = 0.385475
  Training set accuracy = 0.914000, Test set accuracy = 0.880200
 epoch 3/30. Took 0.29583 seconds. 
  Full-batch training loss = 0.215999, test loss = 0.393093
  Training set accuracy = 0.935500, Test set accuracy = 0.873600
 epoch 4/30. Took 0.29618 seconds. 
  Full-batch training loss = 0.133693, test loss = 0.328493
  Training set accuracy = 0.960000, Test set accuracy = 0.896800
 epoch 5/30. Took 0.29845 seconds. 
  Full-batch training loss = 0.074066, test loss = 0.307715
  Training set accuracy = 0.983500, Test set accuracy = 0.907300
 epoch 6/30. Took 0.27602 seconds. 
  Full-batch training loss = 0.040827, test loss = 0.300407
  Training set accuracy = 0.994500, Test set accuracy = 0.913500
 epoch 7/30. Took 0.27506 seconds. 
  Full-batch training loss = 0.022733, test loss = 0.308356
  Training set accuracy = 0.997500, Test set accuracy = 0.914500
 epoch 8/30. Took 0.28073 seconds. 
  Full-batch training loss = 0.015746, test loss = 0.309768
  Training set accuracy = 0.998000, Test set accuracy = 0.915300
 epoch 9/30. Took 0.29564 seconds. 
  Full-batch training loss = 0.009711, test loss = 0.323067
  Training set accuracy = 1.000000, Test set accuracy = 0.915000
 epoch 10/30. Took 0.29187 seconds. 
  Full-batch training loss = 0.006068, test loss = 0.316246
  Training set accuracy = 1.000000, Test set accuracy = 0.919500
 epoch 11/30. Took 0.27232 seconds. 
  Full-batch training loss = 0.004065, test loss = 0.324618
  Training set accuracy = 1.000000, Test set accuracy = 0.918900
 epoch 12/30. Took 0.31833 seconds. 
  Full-batch training loss = 0.003171, test loss = 0.331417
  Training set accuracy = 1.000000, Test set accuracy = 0.919800
 epoch 13/30. Took 0.31968 seconds. 
  Full-batch training loss = 0.002676, test loss = 0.337386
  Training set accuracy = 1.000000, Test set accuracy = 0.920100
 epoch 14/30. Took 0.33547 seconds. 
  Full-batch training loss = 0.002407, test loss = 0.343024
  Training set accuracy = 1.000000, Test set accuracy = 0.920600
 epoch 15/30. Took 0.28141 seconds. 
  Full-batch training loss = 0.002120, test loss = 0.347935
  Training set accuracy = 1.000000, Test set accuracy = 0.919700
 epoch 16/30. Took 0.28127 seconds. 
  Full-batch training loss = 0.001842, test loss = 0.348458
  Training set accuracy = 1.000000, Test set accuracy = 0.921800
 epoch 17/30. Took 0.32716 seconds. 
  Full-batch training loss = 0.001714, test loss = 0.352724
  Training set accuracy = 1.000000, Test set accuracy = 0.921500
 epoch 18/30. Took 0.27721 seconds. 
  Full-batch training loss = 0.001525, test loss = 0.353828
  Training set accuracy = 1.000000, Test set accuracy = 0.921800
 epoch 19/30. Took 0.27643 seconds. 
  Full-batch training loss = 0.001405, test loss = 0.358929
  Training set accuracy = 1.000000, Test set accuracy = 0.921400
 epoch 20/30. Took 0.27526 seconds. 
  Full-batch training loss = 0.001300, test loss = 0.360205
  Training set accuracy = 1.000000, Test set accuracy = 0.922000
 epoch 21/30. Took 0.27251 seconds. 
  Full-batch training loss = 0.001213, test loss = 0.363944
  Training set accuracy = 1.000000, Test set accuracy = 0.922200
 epoch 22/30. Took 0.30274 seconds. 
  Full-batch training loss = 0.001132, test loss = 0.366121
  Training set accuracy = 1.000000, Test set accuracy = 0.922000
 epoch 23/30. Took 0.34777 seconds. 
  Full-batch training loss = 0.001063, test loss = 0.368154
  Training set accuracy = 1.000000, Test set accuracy = 0.922300
 epoch 24/30. Took 0.2784 seconds. 
  Full-batch training loss = 0.000999, test loss = 0.370428
  Training set accuracy = 1.000000, Test set accuracy = 0.921700
 epoch 25/30. Took 0.32892 seconds. 
  Full-batch training loss = 0.000942, test loss = 0.371788
  Training set accuracy = 1.000000, Test set accuracy = 0.921700
 epoch 26/30. Took 0.29465 seconds. 
  Full-batch training loss = 0.000894, test loss = 0.374193
  Training set accuracy = 1.000000, Test set accuracy = 0.921700
 epoch 27/30. Took 0.30272 seconds. 
  Full-batch training loss = 0.000854, test loss = 0.376946
  Training set accuracy = 1.000000, Test set accuracy = 0.921300
 epoch 28/30. Took 0.38628 seconds. 
  Full-batch training loss = 0.000805, test loss = 0.377356
  Training set accuracy = 1.000000, Test set accuracy = 0.921800
 epoch 29/30. Took 0.41447 seconds. 
  Full-batch training loss = 0.000774, test loss = 0.378981
  Training set accuracy = 1.000000, Test set accuracy = 0.922100
 epoch 30/30. Took 0.37423 seconds. 
  Full-batch training loss = 0.000737, test loss = 0.381590
  Training set accuracy = 1.000000, Test set accuracy = 0.921900
Elapsed time is 31.730220 seconds.
End Training
-----
Params 2000 0.100 0.10 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.06278 seconds. 
  Full-batch training loss = 0.680936, test loss = 0.693401
  Training set accuracy = 0.815500, Test set accuracy = 0.800200
 epoch 2/30. Took 0.043533 seconds. 
  Full-batch training loss = 0.405352, test loss = 0.461776
  Training set accuracy = 0.883500, Test set accuracy = 0.865700
 epoch 3/30. Took 0.050427 seconds. 
  Full-batch training loss = 0.305226, test loss = 0.380233
  Training set accuracy = 0.915000, Test set accuracy = 0.890000
 epoch 4/30. Took 0.045007 seconds. 
  Full-batch training loss = 0.262347, test loss = 0.368958
  Training set accuracy = 0.926500, Test set accuracy = 0.894200
 epoch 5/30. Took 0.054283 seconds. 
  Full-batch training loss = 0.215673, test loss = 0.335451
  Training set accuracy = 0.946000, Test set accuracy = 0.902500
 epoch 6/30. Took 0.058759 seconds. 
  Full-batch training loss = 0.191367, test loss = 0.335303
  Training set accuracy = 0.948500, Test set accuracy = 0.899800
 epoch 7/30. Took 0.06786 seconds. 
  Full-batch training loss = 0.160187, test loss = 0.315741
  Training set accuracy = 0.963000, Test set accuracy = 0.909600
 epoch 8/30. Took 0.066158 seconds. 
  Full-batch training loss = 0.133498, test loss = 0.302377
  Training set accuracy = 0.966500, Test set accuracy = 0.911500
 epoch 9/30. Took 0.085259 seconds. 
  Full-batch training loss = 0.122101, test loss = 0.303902
  Training set accuracy = 0.975500, Test set accuracy = 0.912000
 epoch 10/30. Took 0.056178 seconds. 
  Full-batch training loss = 0.106184, test loss = 0.300227
  Training set accuracy = 0.975500, Test set accuracy = 0.911600
 epoch 11/30. Took 0.073482 seconds. 
  Full-batch training loss = 0.111284, test loss = 0.327115
  Training set accuracy = 0.972500, Test set accuracy = 0.902500
 epoch 12/30. Took 0.064095 seconds. 
  Full-batch training loss = 0.083389, test loss = 0.296163
  Training set accuracy = 0.983500, Test set accuracy = 0.913700
 epoch 13/30. Took 0.052763 seconds. 
  Full-batch training loss = 0.073628, test loss = 0.293715
  Training set accuracy = 0.988500, Test set accuracy = 0.916000
 epoch 14/30. Took 0.058822 seconds. 
  Full-batch training loss = 0.059294, test loss = 0.287508
  Training set accuracy = 0.991500, Test set accuracy = 0.915800
 epoch 15/30. Took 0.039754 seconds. 
  Full-batch training loss = 0.050865, test loss = 0.284226
  Training set accuracy = 0.996500, Test set accuracy = 0.917800
 epoch 16/30. Took 0.036941 seconds. 
  Full-batch training loss = 0.055838, test loss = 0.288798
  Training set accuracy = 0.991500, Test set accuracy = 0.917700
 epoch 17/30. Took 0.040483 seconds. 
  Full-batch training loss = 0.042875, test loss = 0.288247
  Training set accuracy = 0.998000, Test set accuracy = 0.915900
 epoch 18/30. Took 0.039165 seconds. 
  Full-batch training loss = 0.038106, test loss = 0.289882
  Training set accuracy = 0.998500, Test set accuracy = 0.917300
 epoch 19/30. Took 0.044083 seconds. 
  Full-batch training loss = 0.032421, test loss = 0.282303
  Training set accuracy = 0.998000, Test set accuracy = 0.918700
 epoch 20/30. Took 0.048188 seconds. 
  Full-batch training loss = 0.028749, test loss = 0.280365
  Training set accuracy = 1.000000, Test set accuracy = 0.921200
 epoch 21/30. Took 0.048102 seconds. 
  Full-batch training loss = 0.030272, test loss = 0.285645
  Training set accuracy = 0.999000, Test set accuracy = 0.917200
 epoch 22/30. Took 0.071093 seconds. 
  Full-batch training loss = 0.022961, test loss = 0.278758
  Training set accuracy = 1.000000, Test set accuracy = 0.921700
 epoch 23/30. Took 0.051925 seconds. 
  Full-batch training loss = 0.027579, test loss = 0.295796
  Training set accuracy = 0.997500, Test set accuracy = 0.917100
 epoch 24/30. Took 0.070329 seconds. 
  Full-batch training loss = 0.020967, test loss = 0.280623
  Training set accuracy = 0.999500, Test set accuracy = 0.923700
 epoch 25/30. Took 0.040018 seconds. 
  Full-batch training loss = 0.018102, test loss = 0.284491
  Training set accuracy = 1.000000, Test set accuracy = 0.923300
 epoch 26/30. Took 0.041824 seconds. 
  Full-batch training loss = 0.016940, test loss = 0.281885
  Training set accuracy = 1.000000, Test set accuracy = 0.922600
 epoch 27/30. Took 0.039515 seconds. 
  Full-batch training loss = 0.015795, test loss = 0.284920
  Training set accuracy = 0.999500, Test set accuracy = 0.923000
 epoch 28/30. Took 0.039144 seconds. 
  Full-batch training loss = 0.014752, test loss = 0.283367
  Training set accuracy = 1.000000, Test set accuracy = 0.923600
 epoch 29/30. Took 0.040129 seconds. 
  Full-batch training loss = 0.014335, test loss = 0.281428
  Training set accuracy = 1.000000, Test set accuracy = 0.923300
 epoch 30/30. Took 0.039608 seconds. 
  Full-batch training loss = 0.013343, test loss = 0.286365
  Training set accuracy = 1.000000, Test set accuracy = 0.921900
Elapsed time is 6.507363 seconds.
End Training
-----
Params 2000 0.100 0.10 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.068614 seconds. 
  Full-batch training loss = 0.546931, test loss = 0.587201
  Training set accuracy = 0.859000, Test set accuracy = 0.843000
 epoch 2/30. Took 0.0674 seconds. 
  Full-batch training loss = 0.375244, test loss = 0.448342
  Training set accuracy = 0.891500, Test set accuracy = 0.872300
 epoch 3/30. Took 0.071053 seconds. 
  Full-batch training loss = 0.304256, test loss = 0.407088
  Training set accuracy = 0.910000, Test set accuracy = 0.879100
 epoch 4/30. Took 0.077023 seconds. 
  Full-batch training loss = 0.245495, test loss = 0.376813
  Training set accuracy = 0.931500, Test set accuracy = 0.891200
 epoch 5/30. Took 0.07609 seconds. 
  Full-batch training loss = 0.209535, test loss = 0.360689
  Training set accuracy = 0.947000, Test set accuracy = 0.895000
 epoch 6/30. Took 0.09476 seconds. 
  Full-batch training loss = 0.190924, test loss = 0.362843
  Training set accuracy = 0.949000, Test set accuracy = 0.893100
 epoch 7/30. Took 0.094531 seconds. 
  Full-batch training loss = 0.154814, test loss = 0.337191
  Training set accuracy = 0.966500, Test set accuracy = 0.900700
 epoch 8/30. Took 0.082079 seconds. 
  Full-batch training loss = 0.147386, test loss = 0.349487
  Training set accuracy = 0.961000, Test set accuracy = 0.900200
 epoch 9/30. Took 0.085852 seconds. 
  Full-batch training loss = 0.118488, test loss = 0.331366
  Training set accuracy = 0.970000, Test set accuracy = 0.904200
 epoch 10/30. Took 0.089885 seconds. 
  Full-batch training loss = 0.105952, test loss = 0.328582
  Training set accuracy = 0.977500, Test set accuracy = 0.905500
 epoch 11/30. Took 0.082344 seconds. 
  Full-batch training loss = 0.087357, test loss = 0.324660
  Training set accuracy = 0.983500, Test set accuracy = 0.906300
 epoch 12/30. Took 0.085261 seconds. 
  Full-batch training loss = 0.075942, test loss = 0.319931
  Training set accuracy = 0.985000, Test set accuracy = 0.908700
 epoch 13/30. Took 0.078553 seconds. 
  Full-batch training loss = 0.064987, test loss = 0.308830
  Training set accuracy = 0.989500, Test set accuracy = 0.910900
 epoch 14/30. Took 0.078401 seconds. 
  Full-batch training loss = 0.063333, test loss = 0.321445
  Training set accuracy = 0.989500, Test set accuracy = 0.904500
 epoch 15/30. Took 0.075688 seconds. 
  Full-batch training loss = 0.054658, test loss = 0.314807
  Training set accuracy = 0.994500, Test set accuracy = 0.907500
 epoch 16/30. Took 0.077702 seconds. 
  Full-batch training loss = 0.044821, test loss = 0.311220
  Training set accuracy = 0.995000, Test set accuracy = 0.910300
 epoch 17/30. Took 0.076094 seconds. 
  Full-batch training loss = 0.037556, test loss = 0.308086
  Training set accuracy = 0.997500, Test set accuracy = 0.913900
 epoch 18/30. Took 0.077402 seconds. 
  Full-batch training loss = 0.036192, test loss = 0.310730
  Training set accuracy = 0.997000, Test set accuracy = 0.911100
 epoch 19/30. Took 0.07889 seconds. 
  Full-batch training loss = 0.031424, test loss = 0.309783
  Training set accuracy = 0.999500, Test set accuracy = 0.912900
 epoch 20/30. Took 0.080595 seconds. 
  Full-batch training loss = 0.030427, test loss = 0.314402
  Training set accuracy = 0.999500, Test set accuracy = 0.912200
 epoch 21/30. Took 0.08791 seconds. 
  Full-batch training loss = 0.027781, test loss = 0.316226
  Training set accuracy = 0.998500, Test set accuracy = 0.911700
 epoch 22/30. Took 0.086686 seconds. 
  Full-batch training loss = 0.022662, test loss = 0.308754
  Training set accuracy = 1.000000, Test set accuracy = 0.916400
 epoch 23/30. Took 0.089151 seconds. 
  Full-batch training loss = 0.020466, test loss = 0.311579
  Training set accuracy = 1.000000, Test set accuracy = 0.916900
 epoch 24/30. Took 0.073926 seconds. 
  Full-batch training loss = 0.019554, test loss = 0.315762
  Training set accuracy = 1.000000, Test set accuracy = 0.916400
 epoch 25/30. Took 0.082311 seconds. 
  Full-batch training loss = 0.018052, test loss = 0.311373
  Training set accuracy = 1.000000, Test set accuracy = 0.915300
 epoch 26/30. Took 0.081548 seconds. 
  Full-batch training loss = 0.016358, test loss = 0.308859
  Training set accuracy = 1.000000, Test set accuracy = 0.917100
 epoch 27/30. Took 0.074337 seconds. 
  Full-batch training loss = 0.016652, test loss = 0.316898
  Training set accuracy = 1.000000, Test set accuracy = 0.914700
 epoch 28/30. Took 0.078927 seconds. 
  Full-batch training loss = 0.014091, test loss = 0.310306
  Training set accuracy = 1.000000, Test set accuracy = 0.917100
 epoch 29/30. Took 0.077679 seconds. 
  Full-batch training loss = 0.013709, test loss = 0.314418
  Training set accuracy = 1.000000, Test set accuracy = 0.917000
 epoch 30/30. Took 0.079332 seconds. 
  Full-batch training loss = 0.012933, test loss = 0.312298
  Training set accuracy = 1.000000, Test set accuracy = 0.917600
Elapsed time is 9.434869 seconds.
End Training
-----
Params 2000 0.100 0.10 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.18061 seconds. 
  Full-batch training loss = 0.526747, test loss = 0.554480
  Training set accuracy = 0.854000, Test set accuracy = 0.847000
 epoch 2/30. Took 0.15614 seconds. 
  Full-batch training loss = 0.365391, test loss = 0.435603
  Training set accuracy = 0.893000, Test set accuracy = 0.869800
 epoch 3/30. Took 0.19276 seconds. 
  Full-batch training loss = 0.275992, test loss = 0.372512
  Training set accuracy = 0.916000, Test set accuracy = 0.892500
 epoch 4/30. Took 0.17276 seconds. 
  Full-batch training loss = 0.224193, test loss = 0.360077
  Training set accuracy = 0.939500, Test set accuracy = 0.896700
 epoch 5/30. Took 0.14336 seconds. 
  Full-batch training loss = 0.199569, test loss = 0.370722
  Training set accuracy = 0.947500, Test set accuracy = 0.888300
 epoch 6/30. Took 0.17316 seconds. 
  Full-batch training loss = 0.164803, test loss = 0.337933
  Training set accuracy = 0.956500, Test set accuracy = 0.900700
 epoch 7/30. Took 0.14095 seconds. 
  Full-batch training loss = 0.142978, test loss = 0.327255
  Training set accuracy = 0.966000, Test set accuracy = 0.901200
 epoch 8/30. Took 0.14268 seconds. 
  Full-batch training loss = 0.126875, test loss = 0.320257
  Training set accuracy = 0.966500, Test set accuracy = 0.905000
 epoch 9/30. Took 0.15294 seconds. 
  Full-batch training loss = 0.103737, test loss = 0.323577
  Training set accuracy = 0.978000, Test set accuracy = 0.905200
 epoch 10/30. Took 0.18068 seconds. 
  Full-batch training loss = 0.083824, test loss = 0.310303
  Training set accuracy = 0.985500, Test set accuracy = 0.909600
 epoch 11/30. Took 0.19257 seconds. 
  Full-batch training loss = 0.079675, test loss = 0.324865
  Training set accuracy = 0.984000, Test set accuracy = 0.907000
 epoch 12/30. Took 0.1791 seconds. 
  Full-batch training loss = 0.061910, test loss = 0.310164
  Training set accuracy = 0.990500, Test set accuracy = 0.910000
 epoch 13/30. Took 0.16762 seconds. 
  Full-batch training loss = 0.052106, test loss = 0.303678
  Training set accuracy = 0.993000, Test set accuracy = 0.911300
 epoch 14/30. Took 0.14046 seconds. 
  Full-batch training loss = 0.047630, test loss = 0.305281
  Training set accuracy = 0.996500, Test set accuracy = 0.912400
 epoch 15/30. Took 0.14157 seconds. 
  Full-batch training loss = 0.040506, test loss = 0.305318
  Training set accuracy = 0.998000, Test set accuracy = 0.912100
 epoch 16/30. Took 0.14208 seconds. 
  Full-batch training loss = 0.040556, test loss = 0.311759
  Training set accuracy = 0.998500, Test set accuracy = 0.911200
 epoch 17/30. Took 0.20364 seconds. 
  Full-batch training loss = 0.032951, test loss = 0.311313
  Training set accuracy = 0.996500, Test set accuracy = 0.912900
 epoch 18/30. Took 0.20818 seconds. 
  Full-batch training loss = 0.030846, test loss = 0.311950
  Training set accuracy = 0.998000, Test set accuracy = 0.914000
 epoch 19/30. Took 0.15925 seconds. 
  Full-batch training loss = 0.025208, test loss = 0.313528
  Training set accuracy = 1.000000, Test set accuracy = 0.915500
 epoch 20/30. Took 0.13969 seconds. 
  Full-batch training loss = 0.022121, test loss = 0.305022
  Training set accuracy = 1.000000, Test set accuracy = 0.917000
 epoch 21/30. Took 0.1489 seconds. 
  Full-batch training loss = 0.022387, test loss = 0.309593
  Training set accuracy = 0.999000, Test set accuracy = 0.916000
 epoch 22/30. Took 0.15173 seconds. 
  Full-batch training loss = 0.018837, test loss = 0.309021
  Training set accuracy = 1.000000, Test set accuracy = 0.915100
 epoch 23/30. Took 0.15286 seconds. 
  Full-batch training loss = 0.017296, test loss = 0.314102
  Training set accuracy = 1.000000, Test set accuracy = 0.916400
 epoch 24/30. Took 0.15889 seconds. 
  Full-batch training loss = 0.015744, test loss = 0.313600
  Training set accuracy = 1.000000, Test set accuracy = 0.915800
 epoch 25/30. Took 0.14689 seconds. 
  Full-batch training loss = 0.015296, test loss = 0.312488
  Training set accuracy = 1.000000, Test set accuracy = 0.916900
 epoch 26/30. Took 0.15485 seconds. 
  Full-batch training loss = 0.013956, test loss = 0.314995
  Training set accuracy = 1.000000, Test set accuracy = 0.916400
 epoch 27/30. Took 0.15731 seconds. 
  Full-batch training loss = 0.013250, test loss = 0.317788
  Training set accuracy = 1.000000, Test set accuracy = 0.916200
 epoch 28/30. Took 0.15074 seconds. 
  Full-batch training loss = 0.012168, test loss = 0.317630
  Training set accuracy = 1.000000, Test set accuracy = 0.915800
 epoch 29/30. Took 0.17394 seconds. 
  Full-batch training loss = 0.011645, test loss = 0.324509
  Training set accuracy = 1.000000, Test set accuracy = 0.915100
 epoch 30/30. Took 0.14523 seconds. 
  Full-batch training loss = 0.010890, test loss = 0.321881
  Training set accuracy = 1.000000, Test set accuracy = 0.917000
Elapsed time is 16.835466 seconds.
End Training
-----
Params 2000 0.100 0.10 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.066938 seconds. 
  Full-batch training loss = 0.965435, test loss = 1.011532
  Training set accuracy = 0.721500, Test set accuracy = 0.701100
 epoch 2/30. Took 0.060588 seconds. 
  Full-batch training loss = 0.461975, test loss = 0.542809
  Training set accuracy = 0.844500, Test set accuracy = 0.818800
 epoch 3/30. Took 0.05581 seconds. 
  Full-batch training loss = 0.355752, test loss = 0.486048
  Training set accuracy = 0.884000, Test set accuracy = 0.845700
 epoch 4/30. Took 0.060609 seconds. 
  Full-batch training loss = 0.253074, test loss = 0.390668
  Training set accuracy = 0.923500, Test set accuracy = 0.881600
 epoch 5/30. Took 0.052457 seconds. 
  Full-batch training loss = 0.200628, test loss = 0.368173
  Training set accuracy = 0.939500, Test set accuracy = 0.888200
 epoch 6/30. Took 0.066534 seconds. 
  Full-batch training loss = 0.169245, test loss = 0.372709
  Training set accuracy = 0.957000, Test set accuracy = 0.886300
 epoch 7/30. Took 0.05459 seconds. 
  Full-batch training loss = 0.132684, test loss = 0.341912
  Training set accuracy = 0.968000, Test set accuracy = 0.898900
 epoch 8/30. Took 0.064194 seconds. 
  Full-batch training loss = 0.101331, test loss = 0.325802
  Training set accuracy = 0.972500, Test set accuracy = 0.903600
 epoch 9/30. Took 0.058152 seconds. 
  Full-batch training loss = 0.075098, test loss = 0.311163
  Training set accuracy = 0.984000, Test set accuracy = 0.911900
 epoch 10/30. Took 0.059516 seconds. 
  Full-batch training loss = 0.065559, test loss = 0.325156
  Training set accuracy = 0.984000, Test set accuracy = 0.908900
 epoch 11/30. Took 0.055752 seconds. 
  Full-batch training loss = 0.055203, test loss = 0.322465
  Training set accuracy = 0.989000, Test set accuracy = 0.911800
 epoch 12/30. Took 0.054329 seconds. 
  Full-batch training loss = 0.050778, test loss = 0.328676
  Training set accuracy = 0.986000, Test set accuracy = 0.910200
 epoch 13/30. Took 0.05196 seconds. 
  Full-batch training loss = 0.040618, test loss = 0.327405
  Training set accuracy = 0.994000, Test set accuracy = 0.913300
 epoch 14/30. Took 0.050996 seconds. 
  Full-batch training loss = 0.029338, test loss = 0.328372
  Training set accuracy = 0.996500, Test set accuracy = 0.912500
 epoch 15/30. Took 0.060134 seconds. 
  Full-batch training loss = 0.047287, test loss = 0.358080
  Training set accuracy = 0.986000, Test set accuracy = 0.907200
 epoch 16/30. Took 0.060397 seconds. 
  Full-batch training loss = 0.024444, test loss = 0.321226
  Training set accuracy = 0.994500, Test set accuracy = 0.915400
 epoch 17/30. Took 0.060203 seconds. 
  Full-batch training loss = 0.021116, test loss = 0.339738
  Training set accuracy = 0.997000, Test set accuracy = 0.914800
 epoch 18/30. Took 0.051668 seconds. 
  Full-batch training loss = 0.017048, test loss = 0.335270
  Training set accuracy = 0.998500, Test set accuracy = 0.916000
 epoch 19/30. Took 0.084896 seconds. 
  Full-batch training loss = 0.013304, test loss = 0.337014
  Training set accuracy = 0.998500, Test set accuracy = 0.919400
 epoch 20/30. Took 0.066302 seconds. 
  Full-batch training loss = 0.016508, test loss = 0.363554
  Training set accuracy = 0.998500, Test set accuracy = 0.912400
 epoch 21/30. Took 0.089046 seconds. 
  Full-batch training loss = 0.013548, test loss = 0.333131
  Training set accuracy = 0.998500, Test set accuracy = 0.917400
 epoch 22/30. Took 0.059664 seconds. 
  Full-batch training loss = 0.008610, test loss = 0.339579
  Training set accuracy = 1.000000, Test set accuracy = 0.918200
 epoch 23/30. Took 0.056511 seconds. 
  Full-batch training loss = 0.015308, test loss = 0.398183
  Training set accuracy = 0.998500, Test set accuracy = 0.908500
 epoch 24/30. Took 0.056105 seconds. 
  Full-batch training loss = 0.008861, test loss = 0.358868
  Training set accuracy = 0.999500, Test set accuracy = 0.915900
 epoch 25/30. Took 0.058555 seconds. 
  Full-batch training loss = 0.006305, test loss = 0.348537
  Training set accuracy = 1.000000, Test set accuracy = 0.916800
 epoch 26/30. Took 0.049759 seconds. 
  Full-batch training loss = 0.007622, test loss = 0.338246
  Training set accuracy = 1.000000, Test set accuracy = 0.920000
 epoch 27/30. Took 0.048017 seconds. 
  Full-batch training loss = 0.005902, test loss = 0.353867
  Training set accuracy = 1.000000, Test set accuracy = 0.919000
 epoch 28/30. Took 0.050204 seconds. 
  Full-batch training loss = 0.004393, test loss = 0.344720
  Training set accuracy = 1.000000, Test set accuracy = 0.919500
 epoch 29/30. Took 0.049009 seconds. 
  Full-batch training loss = 0.004376, test loss = 0.349974
  Training set accuracy = 1.000000, Test set accuracy = 0.920200
 epoch 30/30. Took 0.064672 seconds. 
  Full-batch training loss = 0.003502, test loss = 0.350421
  Training set accuracy = 1.000000, Test set accuracy = 0.920800
Elapsed time is 6.828109 seconds.
End Training
-----
Params 2000 0.100 0.10 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.13558 seconds. 
  Full-batch training loss = 0.791294, test loss = 0.782541
  Training set accuracy = 0.782500, Test set accuracy = 0.779000
 epoch 2/30. Took 0.12885 seconds. 
  Full-batch training loss = 0.449800, test loss = 0.486028
  Training set accuracy = 0.884000, Test set accuracy = 0.858000
 epoch 3/30. Took 0.12047 seconds. 
  Full-batch training loss = 0.325708, test loss = 0.398078
  Training set accuracy = 0.916000, Test set accuracy = 0.885000
 epoch 4/30. Took 0.12138 seconds. 
  Full-batch training loss = 0.244583, test loss = 0.351385
  Training set accuracy = 0.935500, Test set accuracy = 0.898000
 epoch 5/30. Took 0.11413 seconds. 
  Full-batch training loss = 0.215719, test loss = 0.352581
  Training set accuracy = 0.932000, Test set accuracy = 0.886700
 epoch 6/30. Took 0.11704 seconds. 
  Full-batch training loss = 0.163459, test loss = 0.325102
  Training set accuracy = 0.953000, Test set accuracy = 0.899900
 epoch 7/30. Took 0.1082 seconds. 
  Full-batch training loss = 0.117476, test loss = 0.310600
  Training set accuracy = 0.972000, Test set accuracy = 0.903600
 epoch 8/30. Took 0.12727 seconds. 
  Full-batch training loss = 0.086715, test loss = 0.291597
  Training set accuracy = 0.982500, Test set accuracy = 0.912400
 epoch 9/30. Took 0.11898 seconds. 
  Full-batch training loss = 0.069776, test loss = 0.280085
  Training set accuracy = 0.986500, Test set accuracy = 0.917300
 epoch 10/30. Took 0.1198 seconds. 
  Full-batch training loss = 0.062073, test loss = 0.301596
  Training set accuracy = 0.985500, Test set accuracy = 0.912300
 epoch 11/30. Took 0.12226 seconds. 
  Full-batch training loss = 0.051152, test loss = 0.303838
  Training set accuracy = 0.991000, Test set accuracy = 0.912700
 epoch 12/30. Took 0.11276 seconds. 
  Full-batch training loss = 0.048371, test loss = 0.323606
  Training set accuracy = 0.991000, Test set accuracy = 0.912900
 epoch 13/30. Took 0.11139 seconds. 
  Full-batch training loss = 0.036426, test loss = 0.310234
  Training set accuracy = 0.994000, Test set accuracy = 0.916800
 epoch 14/30. Took 0.11542 seconds. 
  Full-batch training loss = 0.020810, test loss = 0.296440
  Training set accuracy = 0.997500, Test set accuracy = 0.922300
 epoch 15/30. Took 0.11791 seconds. 
  Full-batch training loss = 0.019441, test loss = 0.303842
  Training set accuracy = 0.999000, Test set accuracy = 0.918800
 epoch 16/30. Took 0.14864 seconds. 
  Full-batch training loss = 0.011486, test loss = 0.287942
  Training set accuracy = 1.000000, Test set accuracy = 0.922200
 epoch 17/30. Took 0.14483 seconds. 
  Full-batch training loss = 0.008678, test loss = 0.287573
  Training set accuracy = 1.000000, Test set accuracy = 0.926300
 epoch 18/30. Took 0.13058 seconds. 
  Full-batch training loss = 0.014625, test loss = 0.305253
  Training set accuracy = 0.998000, Test set accuracy = 0.919800
 epoch 19/30. Took 0.12643 seconds. 
  Full-batch training loss = 0.009112, test loss = 0.304564
  Training set accuracy = 0.999000, Test set accuracy = 0.923500
 epoch 20/30. Took 0.11584 seconds. 
  Full-batch training loss = 0.006714, test loss = 0.299300
  Training set accuracy = 1.000000, Test set accuracy = 0.923200
 epoch 21/30. Took 0.12404 seconds. 
  Full-batch training loss = 0.006328, test loss = 0.307237
  Training set accuracy = 0.999500, Test set accuracy = 0.920900
 epoch 22/30. Took 0.11466 seconds. 
  Full-batch training loss = 0.005165, test loss = 0.295992
  Training set accuracy = 1.000000, Test set accuracy = 0.926000
 epoch 23/30. Took 0.11107 seconds. 
  Full-batch training loss = 0.004897, test loss = 0.303213
  Training set accuracy = 1.000000, Test set accuracy = 0.925100
 epoch 24/30. Took 0.15876 seconds. 
  Full-batch training loss = 0.003622, test loss = 0.301750
  Training set accuracy = 1.000000, Test set accuracy = 0.927400
 epoch 25/30. Took 0.12632 seconds. 
  Full-batch training loss = 0.003814, test loss = 0.302689
  Training set accuracy = 1.000000, Test set accuracy = 0.925800
 epoch 26/30. Took 0.12359 seconds. 
  Full-batch training loss = 0.003003, test loss = 0.309785
  Training set accuracy = 1.000000, Test set accuracy = 0.927100
 epoch 27/30. Took 0.14585 seconds. 
  Full-batch training loss = 0.002595, test loss = 0.308201
  Training set accuracy = 1.000000, Test set accuracy = 0.928500
 epoch 28/30. Took 0.14637 seconds. 
  Full-batch training loss = 0.002270, test loss = 0.310204
  Training set accuracy = 1.000000, Test set accuracy = 0.928400
 epoch 29/30. Took 0.10973 seconds. 
  Full-batch training loss = 0.003092, test loss = 0.313402
  Training set accuracy = 1.000000, Test set accuracy = 0.925000
 epoch 30/30. Took 0.10439 seconds. 
  Full-batch training loss = 0.002200, test loss = 0.307423
  Training set accuracy = 1.000000, Test set accuracy = 0.928000
Elapsed time is 12.401470 seconds.
End Training
-----
Params 2000 0.100 0.10 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.30662 seconds. 
  Full-batch training loss = 0.621587, test loss = 0.661596
  Training set accuracy = 0.802000, Test set accuracy = 0.788900
 epoch 2/30. Took 0.30399 seconds. 
  Full-batch training loss = 0.393754, test loss = 0.461038
  Training set accuracy = 0.877500, Test set accuracy = 0.864600
 epoch 3/30. Took 0.30683 seconds. 
  Full-batch training loss = 0.258243, test loss = 0.388802
  Training set accuracy = 0.916000, Test set accuracy = 0.880600
 epoch 4/30. Took 0.31229 seconds. 
  Full-batch training loss = 0.202804, test loss = 0.375689
  Training set accuracy = 0.927500, Test set accuracy = 0.885000
 epoch 5/30. Took 0.41191 seconds. 
  Full-batch training loss = 0.144845, test loss = 0.318759
  Training set accuracy = 0.955000, Test set accuracy = 0.907000
 epoch 6/30. Took 0.32829 seconds. 
  Full-batch training loss = 0.105766, test loss = 0.309932
  Training set accuracy = 0.972500, Test set accuracy = 0.908800
 epoch 7/30. Took 0.32453 seconds. 
  Full-batch training loss = 0.075550, test loss = 0.297974
  Training set accuracy = 0.983500, Test set accuracy = 0.915800
 epoch 8/30. Took 0.30704 seconds. 
  Full-batch training loss = 0.081740, test loss = 0.324128
  Training set accuracy = 0.982000, Test set accuracy = 0.909300
 epoch 9/30. Took 0.33312 seconds. 
  Full-batch training loss = 0.053147, test loss = 0.302840
  Training set accuracy = 0.989500, Test set accuracy = 0.916300
 epoch 10/30. Took 0.33393 seconds. 
  Full-batch training loss = 0.037188, test loss = 0.301954
  Training set accuracy = 0.993000, Test set accuracy = 0.916700
 epoch 11/30. Took 0.31646 seconds. 
  Full-batch training loss = 0.035653, test loss = 0.316965
  Training set accuracy = 0.994500, Test set accuracy = 0.912600
 epoch 12/30. Took 0.35422 seconds. 
  Full-batch training loss = 0.021142, test loss = 0.298602
  Training set accuracy = 0.998500, Test set accuracy = 0.919900
 epoch 13/30. Took 0.32646 seconds. 
  Full-batch training loss = 0.019261, test loss = 0.307395
  Training set accuracy = 0.999500, Test set accuracy = 0.919900
 epoch 14/30. Took 0.31422 seconds. 
  Full-batch training loss = 0.013210, test loss = 0.303889
  Training set accuracy = 0.999500, Test set accuracy = 0.920800
 epoch 15/30. Took 0.36948 seconds. 
  Full-batch training loss = 0.011571, test loss = 0.305133
  Training set accuracy = 0.999000, Test set accuracy = 0.923600
 epoch 16/30. Took 0.33391 seconds. 
  Full-batch training loss = 0.009187, test loss = 0.314083
  Training set accuracy = 1.000000, Test set accuracy = 0.920000
 epoch 17/30. Took 0.38505 seconds. 
  Full-batch training loss = 0.007099, test loss = 0.314081
  Training set accuracy = 1.000000, Test set accuracy = 0.923400
 epoch 18/30. Took 0.35856 seconds. 
  Full-batch training loss = 0.007449, test loss = 0.338270
  Training set accuracy = 1.000000, Test set accuracy = 0.918700
 epoch 19/30. Took 0.3024 seconds. 
  Full-batch training loss = 0.006281, test loss = 0.332783
  Training set accuracy = 1.000000, Test set accuracy = 0.921500
 epoch 20/30. Took 0.23215 seconds. 
  Full-batch training loss = 0.005253, test loss = 0.327970
  Training set accuracy = 1.000000, Test set accuracy = 0.921400
 epoch 21/30. Took 0.2739 seconds. 
  Full-batch training loss = 0.005586, test loss = 0.331288
  Training set accuracy = 1.000000, Test set accuracy = 0.923800
 epoch 22/30. Took 0.25906 seconds. 
  Full-batch training loss = 0.004313, test loss = 0.331997
  Training set accuracy = 1.000000, Test set accuracy = 0.921100
 epoch 23/30. Took 0.36045 seconds. 
  Full-batch training loss = 0.004095, test loss = 0.330946
  Training set accuracy = 1.000000, Test set accuracy = 0.921600
 epoch 24/30. Took 0.3111 seconds. 
  Full-batch training loss = 0.003449, test loss = 0.338584
  Training set accuracy = 1.000000, Test set accuracy = 0.920900
 epoch 25/30. Took 0.26715 seconds. 
  Full-batch training loss = 0.003443, test loss = 0.335246
  Training set accuracy = 1.000000, Test set accuracy = 0.924000
 epoch 26/30. Took 0.23132 seconds. 
  Full-batch training loss = 0.003005, test loss = 0.338659
  Training set accuracy = 1.000000, Test set accuracy = 0.924500
 epoch 27/30. Took 0.24612 seconds. 
  Full-batch training loss = 0.002573, test loss = 0.335261
  Training set accuracy = 1.000000, Test set accuracy = 0.924900
 epoch 28/30. Took 0.25307 seconds. 
  Full-batch training loss = 0.002362, test loss = 0.339107
  Training set accuracy = 1.000000, Test set accuracy = 0.922800
 epoch 29/30. Took 0.22884 seconds. 
  Full-batch training loss = 0.002110, test loss = 0.340437
  Training set accuracy = 1.000000, Test set accuracy = 0.924500
 epoch 30/30. Took 0.28213 seconds. 
  Full-batch training loss = 0.002322, test loss = 0.349415
  Training set accuracy = 1.000000, Test set accuracy = 0.922000
Elapsed time is 29.216704 seconds.
End Training
-----
Params 2000 0.100 0.10 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.076828 seconds. 
  Full-batch training loss = 1.269798, test loss = 1.273175
  Training set accuracy = 0.616500, Test set accuracy = 0.616100
 epoch 2/30. Took 0.079774 seconds. 
  Full-batch training loss = 0.535322, test loss = 0.579279
  Training set accuracy = 0.825500, Test set accuracy = 0.811900
 epoch 3/30. Took 0.071366 seconds. 
  Full-batch training loss = 0.439016, test loss = 0.518425
  Training set accuracy = 0.846000, Test set accuracy = 0.816900
 epoch 4/30. Took 0.080257 seconds. 
  Full-batch training loss = 0.255749, test loss = 0.377949
  Training set accuracy = 0.924500, Test set accuracy = 0.882700
 epoch 5/30. Took 0.080614 seconds. 
  Full-batch training loss = 0.185620, test loss = 0.337639
  Training set accuracy = 0.953500, Test set accuracy = 0.895500
 epoch 6/30. Took 0.11315 seconds. 
  Full-batch training loss = 0.155608, test loss = 0.348329
  Training set accuracy = 0.956000, Test set accuracy = 0.893900
 epoch 7/30. Took 0.079761 seconds. 
  Full-batch training loss = 0.124989, test loss = 0.333960
  Training set accuracy = 0.965500, Test set accuracy = 0.903900
 epoch 8/30. Took 0.073481 seconds. 
  Full-batch training loss = 0.144510, test loss = 0.382257
  Training set accuracy = 0.950500, Test set accuracy = 0.886900
 epoch 9/30. Took 0.05998 seconds. 
  Full-batch training loss = 0.078291, test loss = 0.304362
  Training set accuracy = 0.978500, Test set accuracy = 0.907300
 epoch 10/30. Took 0.064433 seconds. 
  Full-batch training loss = 0.045443, test loss = 0.315398
  Training set accuracy = 0.991000, Test set accuracy = 0.913100
 epoch 11/30. Took 0.058931 seconds. 
  Full-batch training loss = 0.066658, test loss = 0.369017
  Training set accuracy = 0.981500, Test set accuracy = 0.901400
 epoch 12/30. Took 0.064828 seconds. 
  Full-batch training loss = 0.039883, test loss = 0.323330
  Training set accuracy = 0.991500, Test set accuracy = 0.911500
 epoch 13/30. Took 0.055159 seconds. 
  Full-batch training loss = 0.024491, test loss = 0.331319
  Training set accuracy = 0.995000, Test set accuracy = 0.916700
 epoch 14/30. Took 0.061148 seconds. 
  Full-batch training loss = 0.016596, test loss = 0.326648
  Training set accuracy = 0.996000, Test set accuracy = 0.920300
 epoch 15/30. Took 0.060267 seconds. 
  Full-batch training loss = 0.011996, test loss = 0.328460
  Training set accuracy = 0.998500, Test set accuracy = 0.918100
 epoch 16/30. Took 0.060896 seconds. 
  Full-batch training loss = 0.015556, test loss = 0.359697
  Training set accuracy = 0.996000, Test set accuracy = 0.912400
 epoch 17/30. Took 0.058332 seconds. 
  Full-batch training loss = 0.015493, test loss = 0.345416
  Training set accuracy = 0.996500, Test set accuracy = 0.916900
 epoch 18/30. Took 0.064456 seconds. 
  Full-batch training loss = 0.011453, test loss = 0.356040
  Training set accuracy = 0.996500, Test set accuracy = 0.914900
 epoch 19/30. Took 0.056831 seconds. 
  Full-batch training loss = 0.005971, test loss = 0.339166
  Training set accuracy = 0.999000, Test set accuracy = 0.922600
 epoch 20/30. Took 0.059722 seconds. 
  Full-batch training loss = 0.013839, test loss = 0.353794
  Training set accuracy = 0.997500, Test set accuracy = 0.917300
 epoch 21/30. Took 0.060647 seconds. 
  Full-batch training loss = 0.004275, test loss = 0.356331
  Training set accuracy = 1.000000, Test set accuracy = 0.923300
 epoch 22/30. Took 0.063523 seconds. 
  Full-batch training loss = 0.003432, test loss = 0.349943
  Training set accuracy = 1.000000, Test set accuracy = 0.923800
 epoch 23/30. Took 0.069808 seconds. 
  Full-batch training loss = 0.007308, test loss = 0.380774
  Training set accuracy = 0.998500, Test set accuracy = 0.917500
 epoch 24/30. Took 0.057761 seconds. 
  Full-batch training loss = 0.002268, test loss = 0.377096
  Training set accuracy = 1.000000, Test set accuracy = 0.921100
 epoch 25/30. Took 0.059888 seconds. 
  Full-batch training loss = 0.002790, test loss = 0.376272
  Training set accuracy = 0.999500, Test set accuracy = 0.921900
 epoch 26/30. Took 0.066381 seconds. 
  Full-batch training loss = 0.007754, test loss = 0.406540
  Training set accuracy = 0.999500, Test set accuracy = 0.918000
 epoch 27/30. Took 0.072582 seconds. 
  Full-batch training loss = 0.002765, test loss = 0.375194
  Training set accuracy = 1.000000, Test set accuracy = 0.917700
 epoch 28/30. Took 0.062369 seconds. 
  Full-batch training loss = 0.002316, test loss = 0.355528
  Training set accuracy = 0.999500, Test set accuracy = 0.924700
 epoch 29/30. Took 0.06452 seconds. 
  Full-batch training loss = 0.002265, test loss = 0.382081
  Training set accuracy = 0.999500, Test set accuracy = 0.921800
 epoch 30/30. Took 0.058419 seconds. 
  Full-batch training loss = 0.001010, test loss = 0.365749
  Training set accuracy = 1.000000, Test set accuracy = 0.926400
Elapsed time is 7.559725 seconds.
End Training
-----
Params 2000 0.100 0.10 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.12739 seconds. 
  Full-batch training loss = 1.026003, test loss = 1.021101
  Training set accuracy = 0.698000, Test set accuracy = 0.699800
 epoch 2/30. Took 0.10851 seconds. 
  Full-batch training loss = 0.470664, test loss = 0.522783
  Training set accuracy = 0.861500, Test set accuracy = 0.841900
 epoch 3/30. Took 0.13697 seconds. 
  Full-batch training loss = 0.347276, test loss = 0.471462
  Training set accuracy = 0.894000, Test set accuracy = 0.858000
 epoch 4/30. Took 0.13567 seconds. 
  Full-batch training loss = 0.253200, test loss = 0.391579
  Training set accuracy = 0.925500, Test set accuracy = 0.881300
 epoch 5/30. Took 0.11233 seconds. 
  Full-batch training loss = 0.238420, test loss = 0.400289
  Training set accuracy = 0.929500, Test set accuracy = 0.879600
 epoch 6/30. Took 0.14209 seconds. 
  Full-batch training loss = 0.139213, test loss = 0.331714
  Training set accuracy = 0.960500, Test set accuracy = 0.899400
 epoch 7/30. Took 0.13234 seconds. 
  Full-batch training loss = 0.086410, test loss = 0.295891
  Training set accuracy = 0.976500, Test set accuracy = 0.912300
 epoch 8/30. Took 0.11927 seconds. 
  Full-batch training loss = 0.109056, test loss = 0.343001
  Training set accuracy = 0.962000, Test set accuracy = 0.901300
 epoch 9/30. Took 0.12382 seconds. 
  Full-batch training loss = 0.049592, test loss = 0.297047
  Training set accuracy = 0.988500, Test set accuracy = 0.918500
 epoch 10/30. Took 0.13417 seconds. 
  Full-batch training loss = 0.041816, test loss = 0.300757
  Training set accuracy = 0.990500, Test set accuracy = 0.914800
 epoch 11/30. Took 0.13555 seconds. 
  Full-batch training loss = 0.023896, test loss = 0.310237
  Training set accuracy = 0.997000, Test set accuracy = 0.919000
 epoch 12/30. Took 0.12867 seconds. 
  Full-batch training loss = 0.013802, test loss = 0.279853
  Training set accuracy = 0.998500, Test set accuracy = 0.926800
 epoch 13/30. Took 0.14541 seconds. 
  Full-batch training loss = 0.018403, test loss = 0.310656
  Training set accuracy = 0.996500, Test set accuracy = 0.919800
 epoch 14/30. Took 0.16548 seconds. 
  Full-batch training loss = 0.010637, test loss = 0.302898
  Training set accuracy = 0.999500, Test set accuracy = 0.921700
 epoch 15/30. Took 0.13033 seconds. 
  Full-batch training loss = 0.007869, test loss = 0.300083
  Training set accuracy = 0.999500, Test set accuracy = 0.923700
 epoch 16/30. Took 0.12127 seconds. 
  Full-batch training loss = 0.007352, test loss = 0.324135
  Training set accuracy = 0.999500, Test set accuracy = 0.918000
 epoch 17/30. Took 0.11337 seconds. 
  Full-batch training loss = 0.004314, test loss = 0.300939
  Training set accuracy = 0.999500, Test set accuracy = 0.926000
 epoch 18/30. Took 0.12695 seconds. 
  Full-batch training loss = 0.005030, test loss = 0.314257
  Training set accuracy = 0.999500, Test set accuracy = 0.925500
 epoch 19/30. Took 0.18398 seconds. 
  Full-batch training loss = 0.003116, test loss = 0.322651
  Training set accuracy = 0.999500, Test set accuracy = 0.924600
 epoch 20/30. Took 0.20266 seconds. 
  Full-batch training loss = 0.008340, test loss = 0.348418
  Training set accuracy = 0.997500, Test set accuracy = 0.922200
 epoch 21/30. Took 0.18624 seconds. 
  Full-batch training loss = 0.014284, test loss = 0.379139
  Training set accuracy = 0.995500, Test set accuracy = 0.913800
 epoch 22/30. Took 0.1929 seconds. 
  Full-batch training loss = 0.005954, test loss = 0.345252
  Training set accuracy = 1.000000, Test set accuracy = 0.918200
 epoch 23/30. Took 0.14502 seconds. 
  Full-batch training loss = 0.003669, test loss = 0.317981
  Training set accuracy = 0.999500, Test set accuracy = 0.926800
 epoch 24/30. Took 0.11106 seconds. 
  Full-batch training loss = 0.001795, test loss = 0.316042
  Training set accuracy = 1.000000, Test set accuracy = 0.926500
 epoch 25/30. Took 0.1189 seconds. 
  Full-batch training loss = 0.001526, test loss = 0.322777
  Training set accuracy = 1.000000, Test set accuracy = 0.928500
 epoch 26/30. Took 0.16618 seconds. 
  Full-batch training loss = 0.000979, test loss = 0.311785
  Training set accuracy = 1.000000, Test set accuracy = 0.930200
 epoch 27/30. Took 0.12249 seconds. 
  Full-batch training loss = 0.001031, test loss = 0.334443
  Training set accuracy = 1.000000, Test set accuracy = 0.925500
 epoch 28/30. Took 0.18308 seconds. 
  Full-batch training loss = 0.000718, test loss = 0.322515
  Training set accuracy = 1.000000, Test set accuracy = 0.929600
 epoch 29/30. Took 0.13517 seconds. 
  Full-batch training loss = 0.002530, test loss = 0.336427
  Training set accuracy = 1.000000, Test set accuracy = 0.926900
 epoch 30/30. Took 0.14358 seconds. 
  Full-batch training loss = 0.001266, test loss = 0.333344
  Training set accuracy = 1.000000, Test set accuracy = 0.928600
Elapsed time is 14.787250 seconds.
End Training
-----
Params 2000 0.100 0.10 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.39039 seconds. 
  Full-batch training loss = 0.816383, test loss = 0.821454
  Training set accuracy = 0.725000, Test set accuracy = 0.710900
 epoch 2/30. Took 0.3359 seconds. 
  Full-batch training loss = 0.459561, test loss = 0.529848
  Training set accuracy = 0.843000, Test set accuracy = 0.823800
 epoch 3/30. Took 0.3314 seconds. 
  Full-batch training loss = 0.294305, test loss = 0.396233
  Training set accuracy = 0.913500, Test set accuracy = 0.877600
 epoch 4/30. Took 0.41263 seconds. 
  Full-batch training loss = 0.218898, test loss = 0.374865
  Training set accuracy = 0.931500, Test set accuracy = 0.881300
 epoch 5/30. Took 0.38169 seconds. 
  Full-batch training loss = 0.175436, test loss = 0.370043
  Training set accuracy = 0.947000, Test set accuracy = 0.892700
 epoch 6/30. Took 0.34626 seconds. 
  Full-batch training loss = 0.105631, test loss = 0.317538
  Training set accuracy = 0.973000, Test set accuracy = 0.906800
 epoch 7/30. Took 0.36506 seconds. 
  Full-batch training loss = 0.060969, test loss = 0.282064
  Training set accuracy = 0.988500, Test set accuracy = 0.920500
 epoch 8/30. Took 0.35515 seconds. 
  Full-batch training loss = 0.061126, test loss = 0.314323
  Training set accuracy = 0.987000, Test set accuracy = 0.913200
 epoch 9/30. Took 0.32442 seconds. 
  Full-batch training loss = 0.036373, test loss = 0.295071
  Training set accuracy = 0.994000, Test set accuracy = 0.919600
 epoch 10/30. Took 0.34788 seconds. 
  Full-batch training loss = 0.026264, test loss = 0.313117
  Training set accuracy = 0.993500, Test set accuracy = 0.912100
 epoch 11/30. Took 0.37548 seconds. 
  Full-batch training loss = 0.015452, test loss = 0.289401
  Training set accuracy = 0.998000, Test set accuracy = 0.924400
 epoch 12/30. Took 0.39407 seconds. 
  Full-batch training loss = 0.027796, test loss = 0.317146
  Training set accuracy = 0.993500, Test set accuracy = 0.915600
 epoch 13/30. Took 0.36775 seconds. 
  Full-batch training loss = 0.011479, test loss = 0.287469
  Training set accuracy = 0.998500, Test set accuracy = 0.927300
 epoch 14/30. Took 0.42298 seconds. 
  Full-batch training loss = 0.005869, test loss = 0.307696
  Training set accuracy = 1.000000, Test set accuracy = 0.924500
 epoch 15/30. Took 0.35214 seconds. 
  Full-batch training loss = 0.003392, test loss = 0.312678
  Training set accuracy = 1.000000, Test set accuracy = 0.927400
 epoch 16/30. Took 0.37659 seconds. 
  Full-batch training loss = 0.003570, test loss = 0.337831
  Training set accuracy = 1.000000, Test set accuracy = 0.923800
 epoch 17/30. Took 0.39447 seconds. 
  Full-batch training loss = 0.001759, test loss = 0.314085
  Training set accuracy = 1.000000, Test set accuracy = 0.929400
 epoch 18/30. Took 0.36725 seconds. 
  Full-batch training loss = 0.001371, test loss = 0.322473
  Training set accuracy = 1.000000, Test set accuracy = 0.929000
 epoch 19/30. Took 0.37982 seconds. 
  Full-batch training loss = 0.003141, test loss = 0.338841
  Training set accuracy = 1.000000, Test set accuracy = 0.923900
 epoch 20/30. Took 0.34567 seconds. 
  Full-batch training loss = 0.001396, test loss = 0.335342
  Training set accuracy = 1.000000, Test set accuracy = 0.926900
 epoch 21/30. Took 0.39158 seconds. 
  Full-batch training loss = 0.001279, test loss = 0.348437
  Training set accuracy = 1.000000, Test set accuracy = 0.926400
 epoch 22/30. Took 0.36488 seconds. 
  Full-batch training loss = 0.000874, test loss = 0.335209
  Training set accuracy = 1.000000, Test set accuracy = 0.929900
 epoch 23/30. Took 0.3758 seconds. 
  Full-batch training loss = 0.000831, test loss = 0.344416
  Training set accuracy = 1.000000, Test set accuracy = 0.927500
 epoch 24/30. Took 0.3307 seconds. 
  Full-batch training loss = 0.000624, test loss = 0.338372
  Training set accuracy = 1.000000, Test set accuracy = 0.929900
 epoch 25/30. Took 0.33525 seconds. 
  Full-batch training loss = 0.000625, test loss = 0.343825
  Training set accuracy = 1.000000, Test set accuracy = 0.929500
 epoch 26/30. Took 0.39797 seconds. 
  Full-batch training loss = 0.000587, test loss = 0.343683
  Training set accuracy = 1.000000, Test set accuracy = 0.931200
 epoch 27/30. Took 0.36142 seconds. 
  Full-batch training loss = 0.000470, test loss = 0.341500
  Training set accuracy = 1.000000, Test set accuracy = 0.930700
 epoch 28/30. Took 0.35503 seconds. 
  Full-batch training loss = 0.000460, test loss = 0.344200
  Training set accuracy = 1.000000, Test set accuracy = 0.929800
 epoch 29/30. Took 0.35392 seconds. 
  Full-batch training loss = 0.000419, test loss = 0.345806
  Training set accuracy = 1.000000, Test set accuracy = 0.931800
 epoch 30/30. Took 0.39606 seconds. 
  Full-batch training loss = 0.000616, test loss = 0.364678
  Training set accuracy = 1.000000, Test set accuracy = 0.928300
Elapsed time is 34.840653 seconds.
End Training
-----
Params 2000 0.100 0.20 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.047845 seconds. 
  Full-batch training loss = 0.696202, test loss = 0.716799
  Training set accuracy = 0.814500, Test set accuracy = 0.803100
 epoch 2/30. Took 0.040686 seconds. 
  Full-batch training loss = 0.454255, test loss = 0.509224
  Training set accuracy = 0.865000, Test set accuracy = 0.844600
 epoch 3/30. Took 0.053283 seconds. 
  Full-batch training loss = 0.331652, test loss = 0.399899
  Training set accuracy = 0.903000, Test set accuracy = 0.888200
 epoch 4/30. Took 0.043818 seconds. 
  Full-batch training loss = 0.286198, test loss = 0.389075
  Training set accuracy = 0.930000, Test set accuracy = 0.888700
 epoch 5/30. Took 0.039874 seconds. 
  Full-batch training loss = 0.241915, test loss = 0.356439
  Training set accuracy = 0.939500, Test set accuracy = 0.896900
 epoch 6/30. Took 0.040372 seconds. 
  Full-batch training loss = 0.212478, test loss = 0.342841
  Training set accuracy = 0.946000, Test set accuracy = 0.899200
 epoch 7/30. Took 0.045751 seconds. 
  Full-batch training loss = 0.185002, test loss = 0.330620
  Training set accuracy = 0.956000, Test set accuracy = 0.904800
 epoch 8/30. Took 0.055442 seconds. 
  Full-batch training loss = 0.168023, test loss = 0.322466
  Training set accuracy = 0.958500, Test set accuracy = 0.904900
 epoch 9/30. Took 0.053106 seconds. 
  Full-batch training loss = 0.161922, test loss = 0.332738
  Training set accuracy = 0.957500, Test set accuracy = 0.904700
 epoch 10/30. Took 0.039112 seconds. 
  Full-batch training loss = 0.136227, test loss = 0.314151
  Training set accuracy = 0.971000, Test set accuracy = 0.905800
 epoch 11/30. Took 0.057255 seconds. 
  Full-batch training loss = 0.122827, test loss = 0.324762
  Training set accuracy = 0.970500, Test set accuracy = 0.902700
 epoch 12/30. Took 0.040718 seconds. 
  Full-batch training loss = 0.102387, test loss = 0.307019
  Training set accuracy = 0.980000, Test set accuracy = 0.907800
 epoch 13/30. Took 0.046146 seconds. 
  Full-batch training loss = 0.091136, test loss = 0.301835
  Training set accuracy = 0.981500, Test set accuracy = 0.911000
 epoch 14/30. Took 0.040623 seconds. 
  Full-batch training loss = 0.084931, test loss = 0.303773
  Training set accuracy = 0.984000, Test set accuracy = 0.909900
 epoch 15/30. Took 0.038714 seconds. 
  Full-batch training loss = 0.081348, test loss = 0.303243
  Training set accuracy = 0.983500, Test set accuracy = 0.910200
 epoch 16/30. Took 0.039193 seconds. 
  Full-batch training loss = 0.081993, test loss = 0.313697
  Training set accuracy = 0.982500, Test set accuracy = 0.903900
 epoch 17/30. Took 0.041868 seconds. 
  Full-batch training loss = 0.060295, test loss = 0.297580
  Training set accuracy = 0.992500, Test set accuracy = 0.912000
 epoch 18/30. Took 0.040047 seconds. 
  Full-batch training loss = 0.055252, test loss = 0.294448
  Training set accuracy = 0.994500, Test set accuracy = 0.912200
 epoch 19/30. Took 0.038949 seconds. 
  Full-batch training loss = 0.047921, test loss = 0.293168
  Training set accuracy = 0.996000, Test set accuracy = 0.912400
 epoch 20/30. Took 0.039529 seconds. 
  Full-batch training loss = 0.043402, test loss = 0.289059
  Training set accuracy = 0.997000, Test set accuracy = 0.914200
 epoch 21/30. Took 0.056568 seconds. 
  Full-batch training loss = 0.040456, test loss = 0.293438
  Training set accuracy = 0.996500, Test set accuracy = 0.913100
 epoch 22/30. Took 0.050861 seconds. 
  Full-batch training loss = 0.037582, test loss = 0.288846
  Training set accuracy = 0.998500, Test set accuracy = 0.916100
 epoch 23/30. Took 0.043693 seconds. 
  Full-batch training loss = 0.032053, test loss = 0.286555
  Training set accuracy = 0.999000, Test set accuracy = 0.914500
 epoch 24/30. Took 0.043146 seconds. 
  Full-batch training loss = 0.030345, test loss = 0.298085
  Training set accuracy = 0.998500, Test set accuracy = 0.912800
 epoch 25/30. Took 0.038093 seconds. 
  Full-batch training loss = 0.028826, test loss = 0.297224
  Training set accuracy = 0.999000, Test set accuracy = 0.914200
 epoch 26/30. Took 0.036511 seconds. 
  Full-batch training loss = 0.026152, test loss = 0.294820
  Training set accuracy = 0.999000, Test set accuracy = 0.914000
 epoch 27/30. Took 0.050479 seconds. 
  Full-batch training loss = 0.022636, test loss = 0.288229
  Training set accuracy = 0.999000, Test set accuracy = 0.918700
 epoch 28/30. Took 0.042401 seconds. 
  Full-batch training loss = 0.022619, test loss = 0.299374
  Training set accuracy = 0.999000, Test set accuracy = 0.915900
 epoch 29/30. Took 0.039966 seconds. 
  Full-batch training loss = 0.021880, test loss = 0.292325
  Training set accuracy = 0.999500, Test set accuracy = 0.915600
 epoch 30/30. Took 0.043195 seconds. 
  Full-batch training loss = 0.019980, test loss = 0.305672
  Training set accuracy = 0.999500, Test set accuracy = 0.914800
Elapsed time is 5.678050 seconds.
End Training
-----
Params 2000 0.100 0.20 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.069509 seconds. 
  Full-batch training loss = 0.663479, test loss = 0.685217
  Training set accuracy = 0.818500, Test set accuracy = 0.812700
 epoch 2/30. Took 0.06414 seconds. 
  Full-batch training loss = 0.404884, test loss = 0.462005
  Training set accuracy = 0.896000, Test set accuracy = 0.869800
 epoch 3/30. Took 0.062601 seconds. 
  Full-batch training loss = 0.320899, test loss = 0.407353
  Training set accuracy = 0.919000, Test set accuracy = 0.885100
 epoch 4/30. Took 0.065356 seconds. 
  Full-batch training loss = 0.271059, test loss = 0.372972
  Training set accuracy = 0.932500, Test set accuracy = 0.891700
 epoch 5/30. Took 0.064792 seconds. 
  Full-batch training loss = 0.253283, test loss = 0.385492
  Training set accuracy = 0.932000, Test set accuracy = 0.880600
 epoch 6/30. Took 0.063362 seconds. 
  Full-batch training loss = 0.205682, test loss = 0.352487
  Training set accuracy = 0.944500, Test set accuracy = 0.892900
 epoch 7/30. Took 0.085737 seconds. 
  Full-batch training loss = 0.180397, test loss = 0.340428
  Training set accuracy = 0.955500, Test set accuracy = 0.898300
 epoch 8/30. Took 0.065304 seconds. 
  Full-batch training loss = 0.149004, test loss = 0.327863
  Training set accuracy = 0.964000, Test set accuracy = 0.898700
 epoch 9/30. Took 0.069625 seconds. 
  Full-batch training loss = 0.129765, test loss = 0.325505
  Training set accuracy = 0.969500, Test set accuracy = 0.902200
 epoch 10/30. Took 0.079207 seconds. 
  Full-batch training loss = 0.110028, test loss = 0.315969
  Training set accuracy = 0.978500, Test set accuracy = 0.905800
 epoch 11/30. Took 0.091182 seconds. 
  Full-batch training loss = 0.094932, test loss = 0.302344
  Training set accuracy = 0.980500, Test set accuracy = 0.909500
 epoch 12/30. Took 0.064079 seconds. 
  Full-batch training loss = 0.083795, test loss = 0.302221
  Training set accuracy = 0.984000, Test set accuracy = 0.909600
 epoch 13/30. Took 0.084258 seconds. 
  Full-batch training loss = 0.073858, test loss = 0.303275
  Training set accuracy = 0.985500, Test set accuracy = 0.907300
 epoch 14/30. Took 0.06953 seconds. 
  Full-batch training loss = 0.068249, test loss = 0.313053
  Training set accuracy = 0.988000, Test set accuracy = 0.906700
 epoch 15/30. Took 0.06762 seconds. 
  Full-batch training loss = 0.060693, test loss = 0.311108
  Training set accuracy = 0.991500, Test set accuracy = 0.908100
 epoch 16/30. Took 0.064487 seconds. 
  Full-batch training loss = 0.050385, test loss = 0.301867
  Training set accuracy = 0.994500, Test set accuracy = 0.911700
 epoch 17/30. Took 0.064096 seconds. 
  Full-batch training loss = 0.047765, test loss = 0.314227
  Training set accuracy = 0.995500, Test set accuracy = 0.908800
 epoch 18/30. Took 0.093586 seconds. 
  Full-batch training loss = 0.042637, test loss = 0.307206
  Training set accuracy = 0.997000, Test set accuracy = 0.911200
 epoch 19/30. Took 0.075427 seconds. 
  Full-batch training loss = 0.042517, test loss = 0.313301
  Training set accuracy = 0.997000, Test set accuracy = 0.909100
 epoch 20/30. Took 0.064211 seconds. 
  Full-batch training loss = 0.036218, test loss = 0.300406
  Training set accuracy = 0.999000, Test set accuracy = 0.913700
 epoch 21/30. Took 0.081515 seconds. 
  Full-batch training loss = 0.029929, test loss = 0.303089
  Training set accuracy = 1.000000, Test set accuracy = 0.914300
 epoch 22/30. Took 0.075804 seconds. 
  Full-batch training loss = 0.027571, test loss = 0.307429
  Training set accuracy = 1.000000, Test set accuracy = 0.912400
 epoch 23/30. Took 0.06564 seconds. 
  Full-batch training loss = 0.024053, test loss = 0.308630
  Training set accuracy = 1.000000, Test set accuracy = 0.910900
 epoch 24/30. Took 0.066729 seconds. 
  Full-batch training loss = 0.022769, test loss = 0.314415
  Training set accuracy = 1.000000, Test set accuracy = 0.910900
 epoch 25/30. Took 0.065624 seconds. 
  Full-batch training loss = 0.022888, test loss = 0.319759
  Training set accuracy = 0.999500, Test set accuracy = 0.909900
 epoch 26/30. Took 0.063147 seconds. 
  Full-batch training loss = 0.020602, test loss = 0.318645
  Training set accuracy = 1.000000, Test set accuracy = 0.911100
 epoch 27/30. Took 0.064267 seconds. 
  Full-batch training loss = 0.018178, test loss = 0.316155
  Training set accuracy = 1.000000, Test set accuracy = 0.912800
 epoch 28/30. Took 0.064167 seconds. 
  Full-batch training loss = 0.015880, test loss = 0.307644
  Training set accuracy = 1.000000, Test set accuracy = 0.915700
 epoch 29/30. Took 0.066339 seconds. 
  Full-batch training loss = 0.014907, test loss = 0.311340
  Training set accuracy = 1.000000, Test set accuracy = 0.914400
 epoch 30/30. Took 0.074965 seconds. 
  Full-batch training loss = 0.014448, test loss = 0.314251
  Training set accuracy = 1.000000, Test set accuracy = 0.912900
Elapsed time is 7.977617 seconds.
End Training
-----
Params 2000 0.100 0.20 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.15345 seconds. 
  Full-batch training loss = 0.556790, test loss = 0.601356
  Training set accuracy = 0.874500, Test set accuracy = 0.845500
 epoch 2/30. Took 0.13795 seconds. 
  Full-batch training loss = 0.376974, test loss = 0.446846
  Training set accuracy = 0.898500, Test set accuracy = 0.867000
 epoch 3/30. Took 0.14489 seconds. 
  Full-batch training loss = 0.300264, test loss = 0.387627
  Training set accuracy = 0.919500, Test set accuracy = 0.888800
 epoch 4/30. Took 0.16672 seconds. 
  Full-batch training loss = 0.276927, test loss = 0.398514
  Training set accuracy = 0.918500, Test set accuracy = 0.878700
 epoch 5/30. Took 0.13904 seconds. 
  Full-batch training loss = 0.220535, test loss = 0.347968
  Training set accuracy = 0.950000, Test set accuracy = 0.896500
 epoch 6/30. Took 0.16845 seconds. 
  Full-batch training loss = 0.198978, test loss = 0.345545
  Training set accuracy = 0.952500, Test set accuracy = 0.896700
 epoch 7/30. Took 0.15236 seconds. 
  Full-batch training loss = 0.162285, test loss = 0.319582
  Training set accuracy = 0.963000, Test set accuracy = 0.905300
 epoch 8/30. Took 0.14946 seconds. 
  Full-batch training loss = 0.142490, test loss = 0.315372
  Training set accuracy = 0.966500, Test set accuracy = 0.902100
 epoch 9/30. Took 0.14437 seconds. 
  Full-batch training loss = 0.119431, test loss = 0.297059
  Training set accuracy = 0.974000, Test set accuracy = 0.909900
 epoch 10/30. Took 0.14229 seconds. 
  Full-batch training loss = 0.122555, test loss = 0.316322
  Training set accuracy = 0.971500, Test set accuracy = 0.903800
 epoch 11/30. Took 0.13676 seconds. 
  Full-batch training loss = 0.099571, test loss = 0.305246
  Training set accuracy = 0.980000, Test set accuracy = 0.909700
 epoch 12/30. Took 0.13847 seconds. 
  Full-batch training loss = 0.079904, test loss = 0.284020
  Training set accuracy = 0.985000, Test set accuracy = 0.915100
 epoch 13/30. Took 0.14406 seconds. 
  Full-batch training loss = 0.077722, test loss = 0.290023
  Training set accuracy = 0.985000, Test set accuracy = 0.912700
 epoch 14/30. Took 0.16253 seconds. 
  Full-batch training loss = 0.064426, test loss = 0.289990
  Training set accuracy = 0.990500, Test set accuracy = 0.915500
 epoch 15/30. Took 0.14489 seconds. 
  Full-batch training loss = 0.059016, test loss = 0.287239
  Training set accuracy = 0.989500, Test set accuracy = 0.914100
 epoch 16/30. Took 0.1427 seconds. 
  Full-batch training loss = 0.054777, test loss = 0.291273
  Training set accuracy = 0.990500, Test set accuracy = 0.913800
 epoch 17/30. Took 0.15033 seconds. 
  Full-batch training loss = 0.042834, test loss = 0.278826
  Training set accuracy = 0.995000, Test set accuracy = 0.917800
 epoch 18/30. Took 0.16481 seconds. 
  Full-batch training loss = 0.040003, test loss = 0.280398
  Training set accuracy = 0.995500, Test set accuracy = 0.917400
 epoch 19/30. Took 0.1449 seconds. 
  Full-batch training loss = 0.035160, test loss = 0.280543
  Training set accuracy = 0.998000, Test set accuracy = 0.915900
 epoch 20/30. Took 0.1503 seconds. 
  Full-batch training loss = 0.031195, test loss = 0.275130
  Training set accuracy = 0.998500, Test set accuracy = 0.919300
 epoch 21/30. Took 0.14591 seconds. 
  Full-batch training loss = 0.029148, test loss = 0.275626
  Training set accuracy = 0.999000, Test set accuracy = 0.918300
 epoch 22/30. Took 0.14075 seconds. 
  Full-batch training loss = 0.026349, test loss = 0.275940
  Training set accuracy = 0.999500, Test set accuracy = 0.918500
 epoch 23/30. Took 0.15398 seconds. 
  Full-batch training loss = 0.025084, test loss = 0.275528
  Training set accuracy = 0.999000, Test set accuracy = 0.920400
 epoch 24/30. Took 0.14275 seconds. 
  Full-batch training loss = 0.021865, test loss = 0.274978
  Training set accuracy = 0.999000, Test set accuracy = 0.920700
 epoch 25/30. Took 0.13962 seconds. 
  Full-batch training loss = 0.022162, test loss = 0.286830
  Training set accuracy = 0.999500, Test set accuracy = 0.918200
 epoch 26/30. Took 0.14114 seconds. 
  Full-batch training loss = 0.018606, test loss = 0.279563
  Training set accuracy = 0.999500, Test set accuracy = 0.920100
 epoch 27/30. Took 0.14884 seconds. 
  Full-batch training loss = 0.016938, test loss = 0.281085
  Training set accuracy = 0.999500, Test set accuracy = 0.919700
 epoch 28/30. Took 0.16031 seconds. 
  Full-batch training loss = 0.015615, test loss = 0.282320
  Training set accuracy = 0.999500, Test set accuracy = 0.920000
 epoch 29/30. Took 0.15671 seconds. 
  Full-batch training loss = 0.014708, test loss = 0.282438
  Training set accuracy = 0.999500, Test set accuracy = 0.920800
 epoch 30/30. Took 0.17314 seconds. 
  Full-batch training loss = 0.014189, test loss = 0.282434
  Training set accuracy = 0.999500, Test set accuracy = 0.921100
Elapsed time is 15.150711 seconds.
End Training
-----
Params 2000 0.100 0.20 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.052015 seconds. 
  Full-batch training loss = 1.261233, test loss = 1.248180
  Training set accuracy = 0.616500, Test set accuracy = 0.618700
 epoch 2/30. Took 0.055171 seconds. 
  Full-batch training loss = 0.544245, test loss = 0.569906
  Training set accuracy = 0.837500, Test set accuracy = 0.828500
 epoch 3/30. Took 0.052653 seconds. 
  Full-batch training loss = 0.369299, test loss = 0.421363
  Training set accuracy = 0.896000, Test set accuracy = 0.877800
 epoch 4/30. Took 0.050338 seconds. 
  Full-batch training loss = 0.312965, test loss = 0.386826
  Training set accuracy = 0.905000, Test set accuracy = 0.878800
 epoch 5/30. Took 0.046106 seconds. 
  Full-batch training loss = 0.245932, test loss = 0.348161
  Training set accuracy = 0.933000, Test set accuracy = 0.895200
 epoch 6/30. Took 0.048864 seconds. 
  Full-batch training loss = 0.197775, test loss = 0.318796
  Training set accuracy = 0.949500, Test set accuracy = 0.900400
 epoch 7/30. Took 0.047193 seconds. 
  Full-batch training loss = 0.178162, test loss = 0.329660
  Training set accuracy = 0.951000, Test set accuracy = 0.902900
 epoch 8/30. Took 0.053339 seconds. 
  Full-batch training loss = 0.144638, test loss = 0.288829
  Training set accuracy = 0.962000, Test set accuracy = 0.913600
 epoch 9/30. Took 0.051177 seconds. 
  Full-batch training loss = 0.116144, test loss = 0.279958
  Training set accuracy = 0.969000, Test set accuracy = 0.916000
 epoch 10/30. Took 0.056983 seconds. 
  Full-batch training loss = 0.118694, test loss = 0.301726
  Training set accuracy = 0.965500, Test set accuracy = 0.908100
 epoch 11/30. Took 0.055141 seconds. 
  Full-batch training loss = 0.091202, test loss = 0.287727
  Training set accuracy = 0.977500, Test set accuracy = 0.916900
 epoch 12/30. Took 0.051355 seconds. 
  Full-batch training loss = 0.081106, test loss = 0.274573
  Training set accuracy = 0.978500, Test set accuracy = 0.918700
 epoch 13/30. Took 0.052948 seconds. 
  Full-batch training loss = 0.065954, test loss = 0.266936
  Training set accuracy = 0.984000, Test set accuracy = 0.921500
 epoch 14/30. Took 0.053887 seconds. 
  Full-batch training loss = 0.052674, test loss = 0.259010
  Training set accuracy = 0.986500, Test set accuracy = 0.924300
 epoch 15/30. Took 0.048742 seconds. 
  Full-batch training loss = 0.049536, test loss = 0.267920
  Training set accuracy = 0.988500, Test set accuracy = 0.919900
 epoch 16/30. Took 0.051874 seconds. 
  Full-batch training loss = 0.039168, test loss = 0.260381
  Training set accuracy = 0.989500, Test set accuracy = 0.927900
 epoch 17/30. Took 0.051697 seconds. 
  Full-batch training loss = 0.031917, test loss = 0.256748
  Training set accuracy = 0.993000, Test set accuracy = 0.927600
 epoch 18/30. Took 0.051664 seconds. 
  Full-batch training loss = 0.041281, test loss = 0.268314
  Training set accuracy = 0.990000, Test set accuracy = 0.924700
 epoch 19/30. Took 0.051533 seconds. 
  Full-batch training loss = 0.024305, test loss = 0.264450
  Training set accuracy = 0.995000, Test set accuracy = 0.927700
 epoch 20/30. Took 0.050969 seconds. 
  Full-batch training loss = 0.021937, test loss = 0.268903
  Training set accuracy = 0.997000, Test set accuracy = 0.924400
 epoch 21/30. Took 0.051276 seconds. 
  Full-batch training loss = 0.020539, test loss = 0.271721
  Training set accuracy = 0.997500, Test set accuracy = 0.927200
 epoch 22/30. Took 0.050619 seconds. 
  Full-batch training loss = 0.016822, test loss = 0.268365
  Training set accuracy = 0.998000, Test set accuracy = 0.926100
 epoch 23/30. Took 0.049973 seconds. 
  Full-batch training loss = 0.017072, test loss = 0.274578
  Training set accuracy = 0.997500, Test set accuracy = 0.926900
 epoch 24/30. Took 0.050418 seconds. 
  Full-batch training loss = 0.015112, test loss = 0.288743
  Training set accuracy = 0.998000, Test set accuracy = 0.925700
 epoch 25/30. Took 0.075636 seconds. 
  Full-batch training loss = 0.015231, test loss = 0.278957
  Training set accuracy = 0.997500, Test set accuracy = 0.924500
 epoch 26/30. Took 0.056996 seconds. 
  Full-batch training loss = 0.011070, test loss = 0.263014
  Training set accuracy = 0.999500, Test set accuracy = 0.929100
 epoch 27/30. Took 0.05048 seconds. 
  Full-batch training loss = 0.010707, test loss = 0.274723
  Training set accuracy = 1.000000, Test set accuracy = 0.926200
 epoch 28/30. Took 0.06139 seconds. 
  Full-batch training loss = 0.008451, test loss = 0.275999
  Training set accuracy = 1.000000, Test set accuracy = 0.928500
 epoch 29/30. Took 0.089327 seconds. 
  Full-batch training loss = 0.007950, test loss = 0.292823
  Training set accuracy = 1.000000, Test set accuracy = 0.926500
 epoch 30/30. Took 0.049091 seconds. 
  Full-batch training loss = 0.005825, test loss = 0.275087
  Training set accuracy = 1.000000, Test set accuracy = 0.931400
Elapsed time is 6.097890 seconds.
End Training
-----
Params 2000 0.100 0.20 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.094596 seconds. 
  Full-batch training loss = 1.007377, test loss = 1.035661
  Training set accuracy = 0.713500, Test set accuracy = 0.690500
 epoch 2/30. Took 0.088062 seconds. 
  Full-batch training loss = 0.431205, test loss = 0.500079
  Training set accuracy = 0.873000, Test set accuracy = 0.850400
 epoch 3/30. Took 0.10416 seconds. 
  Full-batch training loss = 0.298696, test loss = 0.390851
  Training set accuracy = 0.913000, Test set accuracy = 0.886400
 epoch 4/30. Took 0.1177 seconds. 
  Full-batch training loss = 0.292063, test loss = 0.417999
  Training set accuracy = 0.911500, Test set accuracy = 0.878200
 epoch 5/30. Took 0.093698 seconds. 
  Full-batch training loss = 0.211963, test loss = 0.367155
  Training set accuracy = 0.946000, Test set accuracy = 0.892500
 epoch 6/30. Took 0.088425 seconds. 
  Full-batch training loss = 0.164223, test loss = 0.327271
  Training set accuracy = 0.951000, Test set accuracy = 0.905000
 epoch 7/30. Took 0.10242 seconds. 
  Full-batch training loss = 0.163861, test loss = 0.356133
  Training set accuracy = 0.950000, Test set accuracy = 0.894700
 epoch 8/30. Took 0.090274 seconds. 
  Full-batch training loss = 0.103772, test loss = 0.312387
  Training set accuracy = 0.976000, Test set accuracy = 0.907200
 epoch 9/30. Took 0.089512 seconds. 
  Full-batch training loss = 0.086050, test loss = 0.296969
  Training set accuracy = 0.978500, Test set accuracy = 0.912400
 epoch 10/30. Took 0.096568 seconds. 
  Full-batch training loss = 0.086634, test loss = 0.327365
  Training set accuracy = 0.976000, Test set accuracy = 0.903000
 epoch 11/30. Took 0.10055 seconds. 
  Full-batch training loss = 0.064231, test loss = 0.303320
  Training set accuracy = 0.986500, Test set accuracy = 0.913000
 epoch 12/30. Took 0.088779 seconds. 
  Full-batch training loss = 0.050503, test loss = 0.285004
  Training set accuracy = 0.989500, Test set accuracy = 0.917600
 epoch 13/30. Took 0.093172 seconds. 
  Full-batch training loss = 0.050138, test loss = 0.307714
  Training set accuracy = 0.988500, Test set accuracy = 0.915200
 epoch 14/30. Took 0.09549 seconds. 
  Full-batch training loss = 0.036406, test loss = 0.287975
  Training set accuracy = 0.993500, Test set accuracy = 0.920000
 epoch 15/30. Took 0.088384 seconds. 
  Full-batch training loss = 0.026500, test loss = 0.289184
  Training set accuracy = 0.997000, Test set accuracy = 0.917700
 epoch 16/30. Took 0.097941 seconds. 
  Full-batch training loss = 0.026536, test loss = 0.300542
  Training set accuracy = 0.997000, Test set accuracy = 0.918800
 epoch 17/30. Took 0.08773 seconds. 
  Full-batch training loss = 0.016786, test loss = 0.285476
  Training set accuracy = 0.998500, Test set accuracy = 0.922100
 epoch 18/30. Took 0.088999 seconds. 
  Full-batch training loss = 0.018597, test loss = 0.300854
  Training set accuracy = 0.997000, Test set accuracy = 0.919900
 epoch 19/30. Took 0.10087 seconds. 
  Full-batch training loss = 0.014244, test loss = 0.296345
  Training set accuracy = 0.998000, Test set accuracy = 0.921700
 epoch 20/30. Took 0.10166 seconds. 
  Full-batch training loss = 0.014518, test loss = 0.305521
  Training set accuracy = 0.998500, Test set accuracy = 0.919900
 epoch 21/30. Took 0.090186 seconds. 
  Full-batch training loss = 0.013325, test loss = 0.302475
  Training set accuracy = 0.999000, Test set accuracy = 0.921200
 epoch 22/30. Took 0.088916 seconds. 
  Full-batch training loss = 0.009284, test loss = 0.293163
  Training set accuracy = 0.999500, Test set accuracy = 0.924800
 epoch 23/30. Took 0.10004 seconds. 
  Full-batch training loss = 0.008795, test loss = 0.290235
  Training set accuracy = 0.999000, Test set accuracy = 0.926600
 epoch 24/30. Took 0.087149 seconds. 
  Full-batch training loss = 0.007135, test loss = 0.305571
  Training set accuracy = 0.999500, Test set accuracy = 0.922300
 epoch 25/30. Took 0.098057 seconds. 
  Full-batch training loss = 0.009644, test loss = 0.323065
  Training set accuracy = 0.998000, Test set accuracy = 0.917300
 epoch 26/30. Took 0.10126 seconds. 
  Full-batch training loss = 0.007422, test loss = 0.296323
  Training set accuracy = 0.999000, Test set accuracy = 0.925800
 epoch 27/30. Took 0.099777 seconds. 
  Full-batch training loss = 0.004359, test loss = 0.299272
  Training set accuracy = 1.000000, Test set accuracy = 0.927600
 epoch 28/30. Took 0.094933 seconds. 
  Full-batch training loss = 0.005564, test loss = 0.318072
  Training set accuracy = 1.000000, Test set accuracy = 0.922200
 epoch 29/30. Took 0.10079 seconds. 
  Full-batch training loss = 0.003792, test loss = 0.312116
  Training set accuracy = 1.000000, Test set accuracy = 0.927600
 epoch 30/30. Took 0.091966 seconds. 
  Full-batch training loss = 0.005054, test loss = 0.318586
  Training set accuracy = 1.000000, Test set accuracy = 0.925500
Elapsed time is 9.940822 seconds.
End Training
-----
Params 2000 0.100 0.20 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.25065 seconds. 
  Full-batch training loss = 0.889564, test loss = 0.909859
  Training set accuracy = 0.719500, Test set accuracy = 0.700200
 epoch 2/30. Took 0.23433 seconds. 
  Full-batch training loss = 0.496883, test loss = 0.529319
  Training set accuracy = 0.846000, Test set accuracy = 0.834500
 epoch 3/30. Took 0.28078 seconds. 
  Full-batch training loss = 0.313537, test loss = 0.376700
  Training set accuracy = 0.912000, Test set accuracy = 0.888200
 epoch 4/30. Took 0.23637 seconds. 
  Full-batch training loss = 0.246772, test loss = 0.345511
  Training set accuracy = 0.931000, Test set accuracy = 0.900900
 epoch 5/30. Took 0.23258 seconds. 
  Full-batch training loss = 0.208155, test loss = 0.338819
  Training set accuracy = 0.941500, Test set accuracy = 0.900300
 epoch 6/30. Took 0.23561 seconds. 
  Full-batch training loss = 0.148865, test loss = 0.295436
  Training set accuracy = 0.963000, Test set accuracy = 0.911100
 epoch 7/30. Took 0.23485 seconds. 
  Full-batch training loss = 0.124116, test loss = 0.298625
  Training set accuracy = 0.971000, Test set accuracy = 0.912500
 epoch 8/30. Took 0.24585 seconds. 
  Full-batch training loss = 0.105591, test loss = 0.301440
  Training set accuracy = 0.973500, Test set accuracy = 0.909400
 epoch 9/30. Took 0.25453 seconds. 
  Full-batch training loss = 0.079555, test loss = 0.289188
  Training set accuracy = 0.981500, Test set accuracy = 0.913100
 epoch 10/30. Took 0.23247 seconds. 
  Full-batch training loss = 0.056492, test loss = 0.273925
  Training set accuracy = 0.993000, Test set accuracy = 0.920900
 epoch 11/30. Took 0.23203 seconds. 
  Full-batch training loss = 0.063406, test loss = 0.298895
  Training set accuracy = 0.985000, Test set accuracy = 0.915500
 epoch 12/30. Took 0.28058 seconds. 
  Full-batch training loss = 0.044202, test loss = 0.290947
  Training set accuracy = 0.991000, Test set accuracy = 0.918300
 epoch 13/30. Took 0.23264 seconds. 
  Full-batch training loss = 0.038766, test loss = 0.295477
  Training set accuracy = 0.990000, Test set accuracy = 0.918800
 epoch 14/30. Took 0.23288 seconds. 
  Full-batch training loss = 0.033555, test loss = 0.289320
  Training set accuracy = 0.994500, Test set accuracy = 0.920400
 epoch 15/30. Took 0.24404 seconds. 
  Full-batch training loss = 0.018611, test loss = 0.276820
  Training set accuracy = 0.998500, Test set accuracy = 0.926200
 epoch 16/30. Took 0.23115 seconds. 
  Full-batch training loss = 0.015337, test loss = 0.277470
  Training set accuracy = 0.999500, Test set accuracy = 0.925800
 epoch 17/30. Took 0.25435 seconds. 
  Full-batch training loss = 0.014392, test loss = 0.280996
  Training set accuracy = 0.999000, Test set accuracy = 0.924800
 epoch 18/30. Took 0.2484 seconds. 
  Full-batch training loss = 0.016837, test loss = 0.292290
  Training set accuracy = 0.997000, Test set accuracy = 0.919600
 epoch 19/30. Took 0.23406 seconds. 
  Full-batch training loss = 0.014895, test loss = 0.291703
  Training set accuracy = 0.998500, Test set accuracy = 0.923700
 epoch 20/30. Took 0.23453 seconds. 
  Full-batch training loss = 0.010348, test loss = 0.289769
  Training set accuracy = 0.999000, Test set accuracy = 0.924700
 epoch 21/30. Took 0.23337 seconds. 
  Full-batch training loss = 0.008232, test loss = 0.285813
  Training set accuracy = 0.999500, Test set accuracy = 0.928100
 epoch 22/30. Took 0.23622 seconds. 
  Full-batch training loss = 0.007230, test loss = 0.286374
  Training set accuracy = 0.999500, Test set accuracy = 0.926100
 epoch 23/30. Took 0.234 seconds. 
  Full-batch training loss = 0.005613, test loss = 0.288372
  Training set accuracy = 0.999500, Test set accuracy = 0.929000
 epoch 24/30. Took 0.27655 seconds. 
  Full-batch training loss = 0.004571, test loss = 0.291727
  Training set accuracy = 0.999500, Test set accuracy = 0.929500
 epoch 25/30. Took 0.23185 seconds. 
  Full-batch training loss = 0.005012, test loss = 0.301172
  Training set accuracy = 0.999500, Test set accuracy = 0.927300
 epoch 26/30. Took 0.22898 seconds. 
  Full-batch training loss = 0.004382, test loss = 0.297617
  Training set accuracy = 1.000000, Test set accuracy = 0.925300
 epoch 27/30. Took 0.23172 seconds. 
  Full-batch training loss = 0.004829, test loss = 0.300454
  Training set accuracy = 1.000000, Test set accuracy = 0.925800
 epoch 28/30. Took 0.26653 seconds. 
  Full-batch training loss = 0.003508, test loss = 0.299215
  Training set accuracy = 0.999500, Test set accuracy = 0.927400
 epoch 29/30. Took 0.23385 seconds. 
  Full-batch training loss = 0.003415, test loss = 0.298170
  Training set accuracy = 1.000000, Test set accuracy = 0.927000
 epoch 30/30. Took 0.24878 seconds. 
  Full-batch training loss = 0.003420, test loss = 0.297331
  Training set accuracy = 0.999500, Test set accuracy = 0.930500
Elapsed time is 23.597257 seconds.
End Training
-----
Params 2000 0.100 0.20 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.06977 seconds. 
  Full-batch training loss = 1.897040, test loss = 1.908228
  Training set accuracy = 0.534500, Test set accuracy = 0.506400
 epoch 2/30. Took 0.061211 seconds. 
  Full-batch training loss = 0.910069, test loss = 0.970162
  Training set accuracy = 0.647500, Test set accuracy = 0.637300
 epoch 3/30. Took 0.064948 seconds. 
  Full-batch training loss = 0.469267, test loss = 0.514509
  Training set accuracy = 0.872500, Test set accuracy = 0.851100
 epoch 4/30. Took 0.060757 seconds. 
  Full-batch training loss = 0.408344, test loss = 0.478449
  Training set accuracy = 0.870000, Test set accuracy = 0.847000
 epoch 5/30. Took 0.067142 seconds. 
  Full-batch training loss = 0.283663, test loss = 0.383549
  Training set accuracy = 0.916500, Test set accuracy = 0.883000
 epoch 6/30. Took 0.061244 seconds. 
  Full-batch training loss = 0.258001, test loss = 0.389671
  Training set accuracy = 0.919000, Test set accuracy = 0.880400
 epoch 7/30. Took 0.061492 seconds. 
  Full-batch training loss = 0.226259, test loss = 0.381896
  Training set accuracy = 0.931000, Test set accuracy = 0.881000
 epoch 8/30. Took 0.061328 seconds. 
  Full-batch training loss = 0.157233, test loss = 0.321482
  Training set accuracy = 0.956000, Test set accuracy = 0.902600
 epoch 9/30. Took 0.060941 seconds. 
  Full-batch training loss = 0.149312, test loss = 0.337030
  Training set accuracy = 0.952000, Test set accuracy = 0.899400
 epoch 10/30. Took 0.061122 seconds. 
  Full-batch training loss = 0.122482, test loss = 0.301877
  Training set accuracy = 0.968000, Test set accuracy = 0.910200
 epoch 11/30. Took 0.067966 seconds. 
  Full-batch training loss = 0.090961, test loss = 0.295065
  Training set accuracy = 0.973500, Test set accuracy = 0.914000
 epoch 12/30. Took 0.059792 seconds. 
  Full-batch training loss = 0.081307, test loss = 0.311907
  Training set accuracy = 0.977000, Test set accuracy = 0.911200
 epoch 13/30. Took 0.065806 seconds. 
  Full-batch training loss = 0.072408, test loss = 0.324890
  Training set accuracy = 0.980000, Test set accuracy = 0.909600
 epoch 14/30. Took 0.065676 seconds. 
  Full-batch training loss = 0.048691, test loss = 0.283213
  Training set accuracy = 0.989000, Test set accuracy = 0.919400
 epoch 15/30. Took 0.0648 seconds. 
  Full-batch training loss = 0.032917, test loss = 0.294169
  Training set accuracy = 0.994500, Test set accuracy = 0.918500
 epoch 16/30. Took 0.063234 seconds. 
  Full-batch training loss = 0.040274, test loss = 0.319137
  Training set accuracy = 0.990000, Test set accuracy = 0.911500
 epoch 17/30. Took 0.056003 seconds. 
  Full-batch training loss = 0.025886, test loss = 0.312166
  Training set accuracy = 0.994000, Test set accuracy = 0.920100
 epoch 18/30. Took 0.061104 seconds. 
  Full-batch training loss = 0.031217, test loss = 0.323659
  Training set accuracy = 0.992000, Test set accuracy = 0.915500
 epoch 19/30. Took 0.066632 seconds. 
  Full-batch training loss = 0.025885, test loss = 0.321807
  Training set accuracy = 0.994500, Test set accuracy = 0.915400
 epoch 20/30. Took 0.06192 seconds. 
  Full-batch training loss = 0.022505, test loss = 0.307566
  Training set accuracy = 0.995500, Test set accuracy = 0.921600
 epoch 21/30. Took 0.060784 seconds. 
  Full-batch training loss = 0.022456, test loss = 0.371525
  Training set accuracy = 0.994500, Test set accuracy = 0.915000
 epoch 22/30. Took 0.064474 seconds. 
  Full-batch training loss = 0.013033, test loss = 0.309561
  Training set accuracy = 0.997500, Test set accuracy = 0.923700
 epoch 23/30. Took 0.058696 seconds. 
  Full-batch training loss = 0.013821, test loss = 0.321888
  Training set accuracy = 0.998000, Test set accuracy = 0.922300
 epoch 24/30. Took 0.059952 seconds. 
  Full-batch training loss = 0.011114, test loss = 0.352593
  Training set accuracy = 0.998500, Test set accuracy = 0.917100
 epoch 25/30. Took 0.066199 seconds. 
  Full-batch training loss = 0.009268, test loss = 0.334363
  Training set accuracy = 0.999000, Test set accuracy = 0.918300
 epoch 26/30. Took 0.067542 seconds. 
  Full-batch training loss = 0.014064, test loss = 0.363309
  Training set accuracy = 0.995000, Test set accuracy = 0.920000
 epoch 27/30. Took 0.062246 seconds. 
  Full-batch training loss = 0.009266, test loss = 0.319213
  Training set accuracy = 0.999000, Test set accuracy = 0.922800
 epoch 28/30. Took 0.061867 seconds. 
  Full-batch training loss = 0.006355, test loss = 0.316738
  Training set accuracy = 0.999000, Test set accuracy = 0.928100
 epoch 29/30. Took 0.058614 seconds. 
  Full-batch training loss = 0.011519, test loss = 0.358232
  Training set accuracy = 0.996500, Test set accuracy = 0.918600
 epoch 30/30. Took 0.061539 seconds. 
  Full-batch training loss = 0.009846, test loss = 0.370332
  Training set accuracy = 0.998500, Test set accuracy = 0.915400
Elapsed time is 6.879480 seconds.
End Training
-----
Params 2000 0.100 0.20 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11013 seconds. 
  Full-batch training loss = 1.673691, test loss = 1.690906
  Training set accuracy = 0.520000, Test set accuracy = 0.503900
 epoch 2/30. Took 0.12268 seconds. 
  Full-batch training loss = 0.881869, test loss = 0.941373
  Training set accuracy = 0.686000, Test set accuracy = 0.666600
 epoch 3/30. Took 0.10805 seconds. 
  Full-batch training loss = 0.417381, test loss = 0.474281
  Training set accuracy = 0.877000, Test set accuracy = 0.861600
 epoch 4/30. Took 0.11623 seconds. 
  Full-batch training loss = 0.314976, test loss = 0.407608
  Training set accuracy = 0.892000, Test set accuracy = 0.870300
 epoch 5/30. Took 0.112 seconds. 
  Full-batch training loss = 0.210091, test loss = 0.343913
  Training set accuracy = 0.934500, Test set accuracy = 0.894900
 epoch 6/30. Took 0.11017 seconds. 
  Full-batch training loss = 0.186437, test loss = 0.341991
  Training set accuracy = 0.944000, Test set accuracy = 0.898600
 epoch 7/30. Took 0.1209 seconds. 
  Full-batch training loss = 0.142765, test loss = 0.325708
  Training set accuracy = 0.952500, Test set accuracy = 0.903100
 epoch 8/30. Took 0.12767 seconds. 
  Full-batch training loss = 0.103153, test loss = 0.302945
  Training set accuracy = 0.974000, Test set accuracy = 0.907900
 epoch 9/30. Took 0.12239 seconds. 
  Full-batch training loss = 0.099157, test loss = 0.315552
  Training set accuracy = 0.965000, Test set accuracy = 0.906400
 epoch 10/30. Took 0.10937 seconds. 
  Full-batch training loss = 0.063552, test loss = 0.294334
  Training set accuracy = 0.982500, Test set accuracy = 0.918900
 epoch 11/30. Took 0.12372 seconds. 
  Full-batch training loss = 0.070838, test loss = 0.300825
  Training set accuracy = 0.977500, Test set accuracy = 0.914800
 epoch 12/30. Took 0.12599 seconds. 
  Full-batch training loss = 0.045513, test loss = 0.295497
  Training set accuracy = 0.989500, Test set accuracy = 0.917000
 epoch 13/30. Took 0.11964 seconds. 
  Full-batch training loss = 0.037714, test loss = 0.306796
  Training set accuracy = 0.989500, Test set accuracy = 0.917500
 epoch 14/30. Took 0.1244 seconds. 
  Full-batch training loss = 0.029831, test loss = 0.302752
  Training set accuracy = 0.991000, Test set accuracy = 0.920700
 epoch 15/30. Took 0.12194 seconds. 
  Full-batch training loss = 0.024070, test loss = 0.291696
  Training set accuracy = 0.995500, Test set accuracy = 0.926300
 epoch 16/30. Took 0.12074 seconds. 
  Full-batch training loss = 0.023884, test loss = 0.309115
  Training set accuracy = 0.996000, Test set accuracy = 0.921100
 epoch 17/30. Took 0.12326 seconds. 
  Full-batch training loss = 0.017513, test loss = 0.307742
  Training set accuracy = 0.998000, Test set accuracy = 0.923200
 epoch 18/30. Took 0.1246 seconds. 
  Full-batch training loss = 0.013824, test loss = 0.295971
  Training set accuracy = 0.998000, Test set accuracy = 0.928500
 epoch 19/30. Took 0.12146 seconds. 
  Full-batch training loss = 0.018122, test loss = 0.294610
  Training set accuracy = 0.997500, Test set accuracy = 0.924900
 epoch 20/30. Took 0.11558 seconds. 
  Full-batch training loss = 0.012261, test loss = 0.317405
  Training set accuracy = 0.999000, Test set accuracy = 0.921100
 epoch 21/30. Took 0.12611 seconds. 
  Full-batch training loss = 0.008596, test loss = 0.313321
  Training set accuracy = 0.999000, Test set accuracy = 0.925600
 epoch 22/30. Took 0.10504 seconds. 
  Full-batch training loss = 0.004369, test loss = 0.293555
  Training set accuracy = 1.000000, Test set accuracy = 0.929300
 epoch 23/30. Took 0.10504 seconds. 
  Full-batch training loss = 0.006250, test loss = 0.324685
  Training set accuracy = 0.999500, Test set accuracy = 0.926400
 epoch 24/30. Took 0.11093 seconds. 
  Full-batch training loss = 0.003584, test loss = 0.310761
  Training set accuracy = 1.000000, Test set accuracy = 0.929100
 epoch 25/30. Took 0.1261 seconds. 
  Full-batch training loss = 0.002844, test loss = 0.326522
  Training set accuracy = 1.000000, Test set accuracy = 0.930000
 epoch 26/30. Took 0.11021 seconds. 
  Full-batch training loss = 0.004912, test loss = 0.349345
  Training set accuracy = 0.999500, Test set accuracy = 0.926300
 epoch 27/30. Took 0.11081 seconds. 
  Full-batch training loss = 0.003273, test loss = 0.312188
  Training set accuracy = 1.000000, Test set accuracy = 0.932000
 epoch 28/30. Took 0.11021 seconds. 
  Full-batch training loss = 0.006997, test loss = 0.342585
  Training set accuracy = 0.999000, Test set accuracy = 0.925500
 epoch 29/30. Took 0.11037 seconds. 
  Full-batch training loss = 0.004948, test loss = 0.322745
  Training set accuracy = 0.999500, Test set accuracy = 0.928600
 epoch 30/30. Took 0.10624 seconds. 
  Full-batch training loss = 0.004596, test loss = 0.357687
  Training set accuracy = 0.999000, Test set accuracy = 0.924700
Elapsed time is 11.852290 seconds.
End Training
-----
Params 2000 0.100 0.20 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.3442 seconds. 
  Full-batch training loss = 1.350728, test loss = 1.353240
  Training set accuracy = 0.652500, Test set accuracy = 0.653400
 epoch 2/30. Took 0.32453 seconds. 
  Full-batch training loss = 0.489074, test loss = 0.534542
  Training set accuracy = 0.864000, Test set accuracy = 0.840200
 epoch 3/30. Took 0.35797 seconds. 
  Full-batch training loss = 0.355255, test loss = 0.452971
  Training set accuracy = 0.883000, Test set accuracy = 0.860700
 epoch 4/30. Took 0.38859 seconds. 
  Full-batch training loss = 0.330247, test loss = 0.452978
  Training set accuracy = 0.890000, Test set accuracy = 0.865200
 epoch 5/30. Took 0.3375 seconds. 
  Full-batch training loss = 0.183221, test loss = 0.339829
  Training set accuracy = 0.947500, Test set accuracy = 0.893500
 epoch 6/30. Took 0.33756 seconds. 
  Full-batch training loss = 0.118408, test loss = 0.301960
  Training set accuracy = 0.968500, Test set accuracy = 0.910700
 epoch 7/30. Took 0.32724 seconds. 
  Full-batch training loss = 0.095741, test loss = 0.301298
  Training set accuracy = 0.975500, Test set accuracy = 0.910300
 epoch 8/30. Took 0.32451 seconds. 
  Full-batch training loss = 0.089552, test loss = 0.322608
  Training set accuracy = 0.973500, Test set accuracy = 0.905500
 epoch 9/30. Took 0.34164 seconds. 
  Full-batch training loss = 0.053191, test loss = 0.313302
  Training set accuracy = 0.985500, Test set accuracy = 0.912300
 epoch 10/30. Took 0.32567 seconds. 
  Full-batch training loss = 0.041733, test loss = 0.294628
  Training set accuracy = 0.991000, Test set accuracy = 0.915600
 epoch 11/30. Took 0.37789 seconds. 
  Full-batch training loss = 0.023332, test loss = 0.289874
  Training set accuracy = 0.996000, Test set accuracy = 0.922200
 epoch 12/30. Took 0.32792 seconds. 
  Full-batch training loss = 0.022853, test loss = 0.297730
  Training set accuracy = 0.997500, Test set accuracy = 0.921200
 epoch 13/30. Took 0.33791 seconds. 
  Full-batch training loss = 0.016652, test loss = 0.289638
  Training set accuracy = 0.996500, Test set accuracy = 0.922100
 epoch 14/30. Took 0.35857 seconds. 
  Full-batch training loss = 0.012794, test loss = 0.285132
  Training set accuracy = 0.999500, Test set accuracy = 0.923800
 epoch 15/30. Took 0.32448 seconds. 
  Full-batch training loss = 0.029229, test loss = 0.334276
  Training set accuracy = 0.991500, Test set accuracy = 0.912400
 epoch 16/30. Took 0.41039 seconds. 
  Full-batch training loss = 0.010081, test loss = 0.286617
  Training set accuracy = 1.000000, Test set accuracy = 0.925800
 epoch 17/30. Took 0.41053 seconds. 
  Full-batch training loss = 0.005821, test loss = 0.292821
  Training set accuracy = 1.000000, Test set accuracy = 0.927000
 epoch 18/30. Took 0.34111 seconds. 
  Full-batch training loss = 0.006667, test loss = 0.307554
  Training set accuracy = 0.999000, Test set accuracy = 0.925300
 epoch 19/30. Took 0.32443 seconds. 
  Full-batch training loss = 0.004483, test loss = 0.304593
  Training set accuracy = 0.999500, Test set accuracy = 0.927700
 epoch 20/30. Took 0.34969 seconds. 
  Full-batch training loss = 0.004061, test loss = 0.309430
  Training set accuracy = 1.000000, Test set accuracy = 0.926400
 epoch 21/30. Took 0.35445 seconds. 
  Full-batch training loss = 0.003323, test loss = 0.316584
  Training set accuracy = 1.000000, Test set accuracy = 0.925200
 epoch 22/30. Took 0.37418 seconds. 
  Full-batch training loss = 0.002859, test loss = 0.315578
  Training set accuracy = 1.000000, Test set accuracy = 0.926900
 epoch 23/30. Took 0.36061 seconds. 
  Full-batch training loss = 0.002834, test loss = 0.324655
  Training set accuracy = 1.000000, Test set accuracy = 0.923700
 epoch 24/30. Took 0.32762 seconds. 
  Full-batch training loss = 0.001289, test loss = 0.313811
  Training set accuracy = 1.000000, Test set accuracy = 0.929600
 epoch 25/30. Took 0.33322 seconds. 
  Full-batch training loss = 0.001230, test loss = 0.317445
  Training set accuracy = 1.000000, Test set accuracy = 0.929700
 epoch 26/30. Took 0.32865 seconds. 
  Full-batch training loss = 0.000881, test loss = 0.317173
  Training set accuracy = 1.000000, Test set accuracy = 0.930800
 epoch 27/30. Took 0.32603 seconds. 
  Full-batch training loss = 0.000683, test loss = 0.324122
  Training set accuracy = 1.000000, Test set accuracy = 0.930800
 epoch 28/30. Took 0.35893 seconds. 
  Full-batch training loss = 0.000593, test loss = 0.333792
  Training set accuracy = 1.000000, Test set accuracy = 0.930900
 epoch 29/30. Took 0.33924 seconds. 
  Full-batch training loss = 0.000909, test loss = 0.347854
  Training set accuracy = 1.000000, Test set accuracy = 0.926500
 epoch 30/30. Took 0.35971 seconds. 
  Full-batch training loss = 0.001064, test loss = 0.353301
  Training set accuracy = 1.000000, Test set accuracy = 0.927800
Elapsed time is 32.596884 seconds.
End Training
-----
Params 2000 0.100 0.30 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.044492 seconds. 
  Full-batch training loss = 0.846593, test loss = 0.847779
  Training set accuracy = 0.829000, Test set accuracy = 0.825100
 epoch 2/30. Took 0.041265 seconds. 
  Full-batch training loss = 0.508570, test loss = 0.531519
  Training set accuracy = 0.856000, Test set accuracy = 0.849100
 epoch 3/30. Took 0.040022 seconds. 
  Full-batch training loss = 0.405337, test loss = 0.456022
  Training set accuracy = 0.878500, Test set accuracy = 0.868200
 epoch 4/30. Took 0.040729 seconds. 
  Full-batch training loss = 0.343888, test loss = 0.405639
  Training set accuracy = 0.899000, Test set accuracy = 0.885100
 epoch 5/30. Took 0.040424 seconds. 
  Full-batch training loss = 0.285284, test loss = 0.379461
  Training set accuracy = 0.922000, Test set accuracy = 0.891600
 epoch 6/30. Took 0.04518 seconds. 
  Full-batch training loss = 0.253364, test loss = 0.354437
  Training set accuracy = 0.934500, Test set accuracy = 0.896900
 epoch 7/30. Took 0.038384 seconds. 
  Full-batch training loss = 0.220160, test loss = 0.343569
  Training set accuracy = 0.940500, Test set accuracy = 0.897600
 epoch 8/30. Took 0.038569 seconds. 
  Full-batch training loss = 0.198852, test loss = 0.339405
  Training set accuracy = 0.949500, Test set accuracy = 0.898200
 epoch 9/30. Took 0.038005 seconds. 
  Full-batch training loss = 0.182974, test loss = 0.324470
  Training set accuracy = 0.956000, Test set accuracy = 0.903700
 epoch 10/30. Took 0.039301 seconds. 
  Full-batch training loss = 0.163423, test loss = 0.323570
  Training set accuracy = 0.962500, Test set accuracy = 0.901600
 epoch 11/30. Took 0.03973 seconds. 
  Full-batch training loss = 0.142995, test loss = 0.311651
  Training set accuracy = 0.969500, Test set accuracy = 0.906700
 epoch 12/30. Took 0.045418 seconds. 
  Full-batch training loss = 0.138959, test loss = 0.319752
  Training set accuracy = 0.968000, Test set accuracy = 0.904600
 epoch 13/30. Took 0.039369 seconds. 
  Full-batch training loss = 0.123003, test loss = 0.317056
  Training set accuracy = 0.972500, Test set accuracy = 0.903500
 epoch 14/30. Took 0.040808 seconds. 
  Full-batch training loss = 0.108971, test loss = 0.305339
  Training set accuracy = 0.979500, Test set accuracy = 0.907900
 epoch 15/30. Took 0.039215 seconds. 
  Full-batch training loss = 0.097087, test loss = 0.299880
  Training set accuracy = 0.982000, Test set accuracy = 0.910100
 epoch 16/30. Took 0.039498 seconds. 
  Full-batch training loss = 0.091604, test loss = 0.293011
  Training set accuracy = 0.984000, Test set accuracy = 0.912900
 epoch 17/30. Took 0.042979 seconds. 
  Full-batch training loss = 0.080077, test loss = 0.289560
  Training set accuracy = 0.988500, Test set accuracy = 0.912500
 epoch 18/30. Took 0.043721 seconds. 
  Full-batch training loss = 0.075708, test loss = 0.300954
  Training set accuracy = 0.987500, Test set accuracy = 0.912000
 epoch 19/30. Took 0.040023 seconds. 
  Full-batch training loss = 0.070459, test loss = 0.292375
  Training set accuracy = 0.985500, Test set accuracy = 0.914400
 epoch 20/30. Took 0.044717 seconds. 
  Full-batch training loss = 0.063321, test loss = 0.296209
  Training set accuracy = 0.988500, Test set accuracy = 0.913800
 epoch 21/30. Took 0.041414 seconds. 
  Full-batch training loss = 0.060245, test loss = 0.290329
  Training set accuracy = 0.990500, Test set accuracy = 0.913400
 epoch 22/30. Took 0.042896 seconds. 
  Full-batch training loss = 0.053138, test loss = 0.287056
  Training set accuracy = 0.992000, Test set accuracy = 0.916300
 epoch 23/30. Took 0.040126 seconds. 
  Full-batch training loss = 0.053309, test loss = 0.292008
  Training set accuracy = 0.992500, Test set accuracy = 0.915200
 epoch 24/30. Took 0.04416 seconds. 
  Full-batch training loss = 0.043639, test loss = 0.289010
  Training set accuracy = 0.995500, Test set accuracy = 0.915600
 epoch 25/30. Took 0.03871 seconds. 
  Full-batch training loss = 0.043322, test loss = 0.285925
  Training set accuracy = 0.994000, Test set accuracy = 0.917000
 epoch 26/30. Took 0.043977 seconds. 
  Full-batch training loss = 0.040345, test loss = 0.287821
  Training set accuracy = 0.994500, Test set accuracy = 0.916700
 epoch 27/30. Took 0.04404 seconds. 
  Full-batch training loss = 0.039974, test loss = 0.297995
  Training set accuracy = 0.994500, Test set accuracy = 0.914700
 epoch 28/30. Took 0.043839 seconds. 
  Full-batch training loss = 0.033718, test loss = 0.286045
  Training set accuracy = 0.996500, Test set accuracy = 0.917700
 epoch 29/30. Took 0.039253 seconds. 
  Full-batch training loss = 0.031670, test loss = 0.284275
  Training set accuracy = 0.997500, Test set accuracy = 0.918600
 epoch 30/30. Took 0.038256 seconds. 
  Full-batch training loss = 0.028998, test loss = 0.283844
  Training set accuracy = 0.998000, Test set accuracy = 0.918000
Elapsed time is 5.232266 seconds.
End Training
-----
Params 2000 0.100 0.30 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.079182 seconds. 
  Full-batch training loss = 0.771795, test loss = 0.788324
  Training set accuracy = 0.810000, Test set accuracy = 0.802800
 epoch 2/30. Took 0.064 seconds. 
  Full-batch training loss = 0.446487, test loss = 0.500712
  Training set accuracy = 0.884500, Test set accuracy = 0.861300
 epoch 3/30. Took 0.06434 seconds. 
  Full-batch training loss = 0.357875, test loss = 0.436956
  Training set accuracy = 0.909500, Test set accuracy = 0.873900
 epoch 4/30. Took 0.064908 seconds. 
  Full-batch training loss = 0.293500, test loss = 0.392132
  Training set accuracy = 0.922500, Test set accuracy = 0.890300
 epoch 5/30. Took 0.06625 seconds. 
  Full-batch training loss = 0.250945, test loss = 0.366852
  Training set accuracy = 0.931000, Test set accuracy = 0.895900
 epoch 6/30. Took 0.064397 seconds. 
  Full-batch training loss = 0.217438, test loss = 0.342990
  Training set accuracy = 0.940000, Test set accuracy = 0.900700
 epoch 7/30. Took 0.065226 seconds. 
  Full-batch training loss = 0.204509, test loss = 0.351945
  Training set accuracy = 0.946500, Test set accuracy = 0.895500
 epoch 8/30. Took 0.065506 seconds. 
  Full-batch training loss = 0.164025, test loss = 0.324886
  Training set accuracy = 0.959500, Test set accuracy = 0.906500
 epoch 9/30. Took 0.069381 seconds. 
  Full-batch training loss = 0.149652, test loss = 0.327697
  Training set accuracy = 0.964500, Test set accuracy = 0.904600
 epoch 10/30. Took 0.062891 seconds. 
  Full-batch training loss = 0.128665, test loss = 0.311584
  Training set accuracy = 0.967000, Test set accuracy = 0.907200
 epoch 11/30. Took 0.063053 seconds. 
  Full-batch training loss = 0.120410, test loss = 0.313359
  Training set accuracy = 0.971500, Test set accuracy = 0.908400
 epoch 12/30. Took 0.074532 seconds. 
  Full-batch training loss = 0.101937, test loss = 0.297334
  Training set accuracy = 0.976000, Test set accuracy = 0.914700
 epoch 13/30. Took 0.063557 seconds. 
  Full-batch training loss = 0.089875, test loss = 0.300726
  Training set accuracy = 0.982000, Test set accuracy = 0.912500
 epoch 14/30. Took 0.068887 seconds. 
  Full-batch training loss = 0.081563, test loss = 0.304432
  Training set accuracy = 0.981500, Test set accuracy = 0.912100
 epoch 15/30. Took 0.062302 seconds. 
  Full-batch training loss = 0.080852, test loss = 0.310818
  Training set accuracy = 0.982000, Test set accuracy = 0.909800
 epoch 16/30. Took 0.063251 seconds. 
  Full-batch training loss = 0.065046, test loss = 0.288897
  Training set accuracy = 0.988000, Test set accuracy = 0.918900
 epoch 17/30. Took 0.073313 seconds. 
  Full-batch training loss = 0.060395, test loss = 0.295391
  Training set accuracy = 0.991000, Test set accuracy = 0.917900
 epoch 18/30. Took 0.063587 seconds. 
  Full-batch training loss = 0.054141, test loss = 0.295941
  Training set accuracy = 0.993500, Test set accuracy = 0.915700
 epoch 19/30. Took 0.06602 seconds. 
  Full-batch training loss = 0.051501, test loss = 0.294346
  Training set accuracy = 0.993500, Test set accuracy = 0.917300
 epoch 20/30. Took 0.072936 seconds. 
  Full-batch training loss = 0.045018, test loss = 0.289249
  Training set accuracy = 0.995000, Test set accuracy = 0.918800
 epoch 21/30. Took 0.07229 seconds. 
  Full-batch training loss = 0.042371, test loss = 0.298455
  Training set accuracy = 0.996000, Test set accuracy = 0.917800
 epoch 22/30. Took 0.072923 seconds. 
  Full-batch training loss = 0.037180, test loss = 0.298432
  Training set accuracy = 0.997000, Test set accuracy = 0.917100
 epoch 23/30. Took 0.06462 seconds. 
  Full-batch training loss = 0.037548, test loss = 0.293459
  Training set accuracy = 0.996000, Test set accuracy = 0.918300
 epoch 24/30. Took 0.064262 seconds. 
  Full-batch training loss = 0.030804, test loss = 0.290149
  Training set accuracy = 0.998000, Test set accuracy = 0.921100
 epoch 25/30. Took 0.065399 seconds. 
  Full-batch training loss = 0.028955, test loss = 0.291259
  Training set accuracy = 0.999000, Test set accuracy = 0.921200
 epoch 26/30. Took 0.063789 seconds. 
  Full-batch training loss = 0.026117, test loss = 0.287335
  Training set accuracy = 0.998500, Test set accuracy = 0.921100
 epoch 27/30. Took 0.065024 seconds. 
  Full-batch training loss = 0.025171, test loss = 0.288988
  Training set accuracy = 0.999000, Test set accuracy = 0.920100
 epoch 28/30. Took 0.075435 seconds. 
  Full-batch training loss = 0.023569, test loss = 0.293045
  Training set accuracy = 1.000000, Test set accuracy = 0.922700
 epoch 29/30. Took 0.071647 seconds. 
  Full-batch training loss = 0.021207, test loss = 0.287204
  Training set accuracy = 0.999500, Test set accuracy = 0.923600
 epoch 30/30. Took 0.062676 seconds. 
  Full-batch training loss = 0.021028, test loss = 0.292472
  Training set accuracy = 0.999500, Test set accuracy = 0.920300
Elapsed time is 7.417842 seconds.
End Training
-----
Params 2000 0.100 0.30 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.1607 seconds. 
  Full-batch training loss = 0.664909, test loss = 0.693274
  Training set accuracy = 0.832500, Test set accuracy = 0.822900
 epoch 2/30. Took 0.13915 seconds. 
  Full-batch training loss = 0.417694, test loss = 0.476993
  Training set accuracy = 0.875500, Test set accuracy = 0.858500
 epoch 3/30. Took 0.13933 seconds. 
  Full-batch training loss = 0.339549, test loss = 0.413931
  Training set accuracy = 0.899000, Test set accuracy = 0.878400
 epoch 4/30. Took 0.15344 seconds. 
  Full-batch training loss = 0.271412, test loss = 0.369593
  Training set accuracy = 0.936000, Test set accuracy = 0.894500
 epoch 5/30. Took 0.15641 seconds. 
  Full-batch training loss = 0.228761, test loss = 0.338622
  Training set accuracy = 0.946000, Test set accuracy = 0.903200
 epoch 6/30. Took 0.1408 seconds. 
  Full-batch training loss = 0.198070, test loss = 0.331240
  Training set accuracy = 0.953500, Test set accuracy = 0.904600
 epoch 7/30. Took 0.13927 seconds. 
  Full-batch training loss = 0.174942, test loss = 0.325172
  Training set accuracy = 0.961500, Test set accuracy = 0.906100
 epoch 8/30. Took 0.13551 seconds. 
  Full-batch training loss = 0.151791, test loss = 0.317371
  Training set accuracy = 0.965500, Test set accuracy = 0.907200
 epoch 9/30. Took 0.16204 seconds. 
  Full-batch training loss = 0.139530, test loss = 0.315188
  Training set accuracy = 0.970500, Test set accuracy = 0.907300
 epoch 10/30. Took 0.1385 seconds. 
  Full-batch training loss = 0.121217, test loss = 0.304790
  Training set accuracy = 0.974000, Test set accuracy = 0.912200
 epoch 11/30. Took 0.16307 seconds. 
  Full-batch training loss = 0.108779, test loss = 0.296479
  Training set accuracy = 0.978500, Test set accuracy = 0.913700
 epoch 12/30. Took 0.14239 seconds. 
  Full-batch training loss = 0.095609, test loss = 0.291231
  Training set accuracy = 0.985000, Test set accuracy = 0.917000
 epoch 13/30. Took 0.15004 seconds. 
  Full-batch training loss = 0.087743, test loss = 0.300282
  Training set accuracy = 0.986000, Test set accuracy = 0.911900
 epoch 14/30. Took 0.1411 seconds. 
  Full-batch training loss = 0.081433, test loss = 0.295792
  Training set accuracy = 0.990000, Test set accuracy = 0.912900
 epoch 15/30. Took 0.15627 seconds. 
  Full-batch training loss = 0.069159, test loss = 0.285073
  Training set accuracy = 0.989500, Test set accuracy = 0.917500
 epoch 16/30. Took 0.13668 seconds. 
  Full-batch training loss = 0.059111, test loss = 0.286463
  Training set accuracy = 0.993500, Test set accuracy = 0.918000
 epoch 17/30. Took 0.14395 seconds. 
  Full-batch training loss = 0.054715, test loss = 0.285450
  Training set accuracy = 0.994500, Test set accuracy = 0.916600
 epoch 18/30. Took 0.13952 seconds. 
  Full-batch training loss = 0.045835, test loss = 0.280100
  Training set accuracy = 0.996000, Test set accuracy = 0.920700
 epoch 19/30. Took 0.14015 seconds. 
  Full-batch training loss = 0.041999, test loss = 0.285004
  Training set accuracy = 0.995500, Test set accuracy = 0.917900
 epoch 20/30. Took 0.13975 seconds. 
  Full-batch training loss = 0.041859, test loss = 0.286791
  Training set accuracy = 0.997500, Test set accuracy = 0.917600
 epoch 21/30. Took 0.13921 seconds. 
  Full-batch training loss = 0.033936, test loss = 0.276314
  Training set accuracy = 0.997500, Test set accuracy = 0.921500
 epoch 22/30. Took 0.13903 seconds. 
  Full-batch training loss = 0.031136, test loss = 0.282093
  Training set accuracy = 0.999000, Test set accuracy = 0.919100
 epoch 23/30. Took 0.14629 seconds. 
  Full-batch training loss = 0.029033, test loss = 0.279809
  Training set accuracy = 1.000000, Test set accuracy = 0.921500
 epoch 24/30. Took 0.14819 seconds. 
  Full-batch training loss = 0.025404, test loss = 0.280663
  Training set accuracy = 1.000000, Test set accuracy = 0.922600
 epoch 25/30. Took 0.1439 seconds. 
  Full-batch training loss = 0.024828, test loss = 0.273907
  Training set accuracy = 1.000000, Test set accuracy = 0.921900
 epoch 26/30. Took 0.14914 seconds. 
  Full-batch training loss = 0.021447, test loss = 0.276377
  Training set accuracy = 1.000000, Test set accuracy = 0.922000
 epoch 27/30. Took 0.15759 seconds. 
  Full-batch training loss = 0.019047, test loss = 0.277359
  Training set accuracy = 1.000000, Test set accuracy = 0.923900
 epoch 28/30. Took 0.15793 seconds. 
  Full-batch training loss = 0.018408, test loss = 0.278846
  Training set accuracy = 1.000000, Test set accuracy = 0.922200
 epoch 29/30. Took 0.13714 seconds. 
  Full-batch training loss = 0.017158, test loss = 0.281429
  Training set accuracy = 1.000000, Test set accuracy = 0.922200
 epoch 30/30. Took 0.15818 seconds. 
  Full-batch training loss = 0.015994, test loss = 0.279195
  Training set accuracy = 1.000000, Test set accuracy = 0.922100
Elapsed time is 14.697898 seconds.
End Training
-----
Params 2000 0.100 0.30 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.063212 seconds. 
  Full-batch training loss = 1.627665, test loss = 1.650140
  Training set accuracy = 0.588500, Test set accuracy = 0.569500
 epoch 2/30. Took 0.049517 seconds. 
  Full-batch training loss = 0.628112, test loss = 0.668782
  Training set accuracy = 0.839000, Test set accuracy = 0.810400
 epoch 3/30. Took 0.050396 seconds. 
  Full-batch training loss = 0.422818, test loss = 0.496920
  Training set accuracy = 0.893500, Test set accuracy = 0.856800
 epoch 4/30. Took 0.048134 seconds. 
  Full-batch training loss = 0.348015, test loss = 0.439379
  Training set accuracy = 0.905000, Test set accuracy = 0.863600
 epoch 5/30. Took 0.054643 seconds. 
  Full-batch training loss = 0.290163, test loss = 0.406025
  Training set accuracy = 0.919000, Test set accuracy = 0.878700
 epoch 6/30. Took 0.05522 seconds. 
  Full-batch training loss = 0.243882, test loss = 0.362064
  Training set accuracy = 0.936000, Test set accuracy = 0.893100
 epoch 7/30. Took 0.049814 seconds. 
  Full-batch training loss = 0.216022, test loss = 0.365884
  Training set accuracy = 0.939500, Test set accuracy = 0.888700
 epoch 8/30. Took 0.049947 seconds. 
  Full-batch training loss = 0.185534, test loss = 0.351948
  Training set accuracy = 0.951000, Test set accuracy = 0.893000
 epoch 9/30. Took 0.051016 seconds. 
  Full-batch training loss = 0.172671, test loss = 0.358960
  Training set accuracy = 0.953500, Test set accuracy = 0.890400
 epoch 10/30. Took 0.05539 seconds. 
  Full-batch training loss = 0.136525, test loss = 0.316758
  Training set accuracy = 0.964000, Test set accuracy = 0.900900
 epoch 11/30. Took 0.056914 seconds. 
  Full-batch training loss = 0.130544, test loss = 0.323632
  Training set accuracy = 0.967500, Test set accuracy = 0.902900
 epoch 12/30. Took 0.05383 seconds. 
  Full-batch training loss = 0.129153, test loss = 0.334181
  Training set accuracy = 0.965500, Test set accuracy = 0.897700
 epoch 13/30. Took 0.04988 seconds. 
  Full-batch training loss = 0.104122, test loss = 0.323053
  Training set accuracy = 0.970500, Test set accuracy = 0.901000
 epoch 14/30. Took 0.049718 seconds. 
  Full-batch training loss = 0.083946, test loss = 0.304512
  Training set accuracy = 0.981000, Test set accuracy = 0.909300
 epoch 15/30. Took 0.050407 seconds. 
  Full-batch training loss = 0.079242, test loss = 0.307344
  Training set accuracy = 0.982000, Test set accuracy = 0.908000
 epoch 16/30. Took 0.054652 seconds. 
  Full-batch training loss = 0.074144, test loss = 0.315131
  Training set accuracy = 0.986500, Test set accuracy = 0.906000
 epoch 17/30. Took 0.051095 seconds. 
  Full-batch training loss = 0.065462, test loss = 0.306593
  Training set accuracy = 0.983500, Test set accuracy = 0.907700
 epoch 18/30. Took 0.053488 seconds. 
  Full-batch training loss = 0.053542, test loss = 0.298553
  Training set accuracy = 0.987500, Test set accuracy = 0.912400
 epoch 19/30. Took 0.047762 seconds. 
  Full-batch training loss = 0.046477, test loss = 0.297079
  Training set accuracy = 0.991500, Test set accuracy = 0.912200
 epoch 20/30. Took 0.050211 seconds. 
  Full-batch training loss = 0.039868, test loss = 0.296791
  Training set accuracy = 0.992500, Test set accuracy = 0.913300
 epoch 21/30. Took 0.047522 seconds. 
  Full-batch training loss = 0.045768, test loss = 0.345407
  Training set accuracy = 0.990500, Test set accuracy = 0.903800
 epoch 22/30. Took 0.052468 seconds. 
  Full-batch training loss = 0.029619, test loss = 0.294275
  Training set accuracy = 0.994500, Test set accuracy = 0.916900
 epoch 23/30. Took 0.054865 seconds. 
  Full-batch training loss = 0.027384, test loss = 0.305525
  Training set accuracy = 0.996000, Test set accuracy = 0.913800
 epoch 24/30. Took 0.049668 seconds. 
  Full-batch training loss = 0.030052, test loss = 0.299227
  Training set accuracy = 0.994000, Test set accuracy = 0.912300
 epoch 25/30. Took 0.054418 seconds. 
  Full-batch training loss = 0.023181, test loss = 0.299851
  Training set accuracy = 0.996000, Test set accuracy = 0.916400
 epoch 26/30. Took 0.050225 seconds. 
  Full-batch training loss = 0.019804, test loss = 0.306471
  Training set accuracy = 0.996500, Test set accuracy = 0.916500
 epoch 27/30. Took 0.05063 seconds. 
  Full-batch training loss = 0.017269, test loss = 0.313003
  Training set accuracy = 0.997500, Test set accuracy = 0.917500
 epoch 28/30. Took 0.052416 seconds. 
  Full-batch training loss = 0.019959, test loss = 0.301254
  Training set accuracy = 0.997000, Test set accuracy = 0.919300
 epoch 29/30. Took 0.046824 seconds. 
  Full-batch training loss = 0.013449, test loss = 0.318548
  Training set accuracy = 0.997500, Test set accuracy = 0.918100
 epoch 30/30. Took 0.053778 seconds. 
  Full-batch training loss = 0.014088, test loss = 0.301916
  Training set accuracy = 0.997500, Test set accuracy = 0.921400
Elapsed time is 5.921844 seconds.
End Training
-----
Params 2000 0.100 0.30 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.10117 seconds. 
  Full-batch training loss = 1.482090, test loss = 1.488246
  Training set accuracy = 0.644500, Test set accuracy = 0.630600
 epoch 2/30. Took 0.10003 seconds. 
  Full-batch training loss = 0.582978, test loss = 0.601933
  Training set accuracy = 0.831500, Test set accuracy = 0.824100
 epoch 3/30. Took 0.095218 seconds. 
  Full-batch training loss = 0.444583, test loss = 0.481459
  Training set accuracy = 0.878000, Test set accuracy = 0.856900
 epoch 4/30. Took 0.10191 seconds. 
  Full-batch training loss = 0.360131, test loss = 0.425856
  Training set accuracy = 0.889000, Test set accuracy = 0.863100
 epoch 5/30. Took 0.088517 seconds. 
  Full-batch training loss = 0.290110, test loss = 0.366245
  Training set accuracy = 0.918000, Test set accuracy = 0.889900
 epoch 6/30. Took 0.085914 seconds. 
  Full-batch training loss = 0.269183, test loss = 0.363505
  Training set accuracy = 0.924000, Test set accuracy = 0.890800
 epoch 7/30. Took 0.089434 seconds. 
  Full-batch training loss = 0.217800, test loss = 0.323504
  Training set accuracy = 0.936000, Test set accuracy = 0.904600
 epoch 8/30. Took 0.10109 seconds. 
  Full-batch training loss = 0.192434, test loss = 0.320054
  Training set accuracy = 0.946000, Test set accuracy = 0.903900
 epoch 9/30. Took 0.085615 seconds. 
  Full-batch training loss = 0.176128, test loss = 0.306670
  Training set accuracy = 0.949500, Test set accuracy = 0.907000
 epoch 10/30. Took 0.10118 seconds. 
  Full-batch training loss = 0.138641, test loss = 0.291932
  Training set accuracy = 0.962000, Test set accuracy = 0.910100
 epoch 11/30. Took 0.098164 seconds. 
  Full-batch training loss = 0.124048, test loss = 0.281152
  Training set accuracy = 0.965000, Test set accuracy = 0.913500
 epoch 12/30. Took 0.088556 seconds. 
  Full-batch training loss = 0.119126, test loss = 0.301556
  Training set accuracy = 0.966000, Test set accuracy = 0.909300
 epoch 13/30. Took 0.088514 seconds. 
  Full-batch training loss = 0.085642, test loss = 0.267587
  Training set accuracy = 0.981000, Test set accuracy = 0.919700
 epoch 14/30. Took 0.09894 seconds. 
  Full-batch training loss = 0.071466, test loss = 0.267512
  Training set accuracy = 0.981000, Test set accuracy = 0.919800
 epoch 15/30. Took 0.088506 seconds. 
  Full-batch training loss = 0.059125, test loss = 0.259842
  Training set accuracy = 0.987500, Test set accuracy = 0.921700
 epoch 16/30. Took 0.08921 seconds. 
  Full-batch training loss = 0.056311, test loss = 0.278494
  Training set accuracy = 0.984500, Test set accuracy = 0.916200
 epoch 17/30. Took 0.10215 seconds. 
  Full-batch training loss = 0.041812, test loss = 0.265303
  Training set accuracy = 0.992000, Test set accuracy = 0.921100
 epoch 18/30. Took 0.10143 seconds. 
  Full-batch training loss = 0.038706, test loss = 0.259680
  Training set accuracy = 0.993500, Test set accuracy = 0.921400
 epoch 19/30. Took 0.088468 seconds. 
  Full-batch training loss = 0.035593, test loss = 0.272024
  Training set accuracy = 0.994500, Test set accuracy = 0.920100
 epoch 20/30. Took 0.085278 seconds. 
  Full-batch training loss = 0.028779, test loss = 0.269496
  Training set accuracy = 0.994500, Test set accuracy = 0.924800
 epoch 21/30. Took 0.084641 seconds. 
  Full-batch training loss = 0.031946, test loss = 0.279627
  Training set accuracy = 0.995000, Test set accuracy = 0.918500
 epoch 22/30. Took 0.084855 seconds. 
  Full-batch training loss = 0.020516, test loss = 0.266181
  Training set accuracy = 0.998000, Test set accuracy = 0.924600
 epoch 23/30. Took 0.088145 seconds. 
  Full-batch training loss = 0.022919, test loss = 0.268103
  Training set accuracy = 0.998000, Test set accuracy = 0.924800
 epoch 24/30. Took 0.088317 seconds. 
  Full-batch training loss = 0.018087, test loss = 0.272478
  Training set accuracy = 0.998000, Test set accuracy = 0.924600
 epoch 25/30. Took 0.08533 seconds. 
  Full-batch training loss = 0.016471, test loss = 0.254922
  Training set accuracy = 0.999500, Test set accuracy = 0.926900
 epoch 26/30. Took 0.096049 seconds. 
  Full-batch training loss = 0.013757, test loss = 0.261438
  Training set accuracy = 0.999500, Test set accuracy = 0.923800
 epoch 27/30. Took 0.095039 seconds. 
  Full-batch training loss = 0.012405, test loss = 0.263816
  Training set accuracy = 0.999500, Test set accuracy = 0.925700
 epoch 28/30. Took 0.099769 seconds. 
  Full-batch training loss = 0.011250, test loss = 0.273340
  Training set accuracy = 1.000000, Test set accuracy = 0.924200
 epoch 29/30. Took 0.098847 seconds. 
  Full-batch training loss = 0.009186, test loss = 0.278292
  Training set accuracy = 1.000000, Test set accuracy = 0.925700
 epoch 30/30. Took 0.087334 seconds. 
  Full-batch training loss = 0.007709, test loss = 0.264516
  Training set accuracy = 1.000000, Test set accuracy = 0.929800
Elapsed time is 9.749579 seconds.
End Training
-----
Params 2000 0.100 0.30 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23645 seconds. 
  Full-batch training loss = 1.150137, test loss = 1.150863
  Training set accuracy = 0.754000, Test set accuracy = 0.749800
 epoch 2/30. Took 0.26318 seconds. 
  Full-batch training loss = 0.483843, test loss = 0.525866
  Training set accuracy = 0.858000, Test set accuracy = 0.847300
 epoch 3/30. Took 0.23279 seconds. 
  Full-batch training loss = 0.358913, test loss = 0.436776
  Training set accuracy = 0.895500, Test set accuracy = 0.872800
 epoch 4/30. Took 0.23707 seconds. 
  Full-batch training loss = 0.275726, test loss = 0.373829
  Training set accuracy = 0.917500, Test set accuracy = 0.889600
 epoch 5/30. Took 0.27397 seconds. 
  Full-batch training loss = 0.215024, test loss = 0.337768
  Training set accuracy = 0.939000, Test set accuracy = 0.901100
 epoch 6/30. Took 0.25372 seconds. 
  Full-batch training loss = 0.179212, test loss = 0.324319
  Training set accuracy = 0.952500, Test set accuracy = 0.901900
 epoch 7/30. Took 0.23359 seconds. 
  Full-batch training loss = 0.180608, test loss = 0.359816
  Training set accuracy = 0.938500, Test set accuracy = 0.888300
 epoch 8/30. Took 0.24706 seconds. 
  Full-batch training loss = 0.139964, test loss = 0.321460
  Training set accuracy = 0.959000, Test set accuracy = 0.901500
 epoch 9/30. Took 0.2757 seconds. 
  Full-batch training loss = 0.105096, test loss = 0.296180
  Training set accuracy = 0.972500, Test set accuracy = 0.911500
 epoch 10/30. Took 0.25205 seconds. 
  Full-batch training loss = 0.120904, test loss = 0.355976
  Training set accuracy = 0.966000, Test set accuracy = 0.892100
 epoch 11/30. Took 0.23244 seconds. 
  Full-batch training loss = 0.072957, test loss = 0.284869
  Training set accuracy = 0.982500, Test set accuracy = 0.919600
 epoch 12/30. Took 0.23377 seconds. 
  Full-batch training loss = 0.070967, test loss = 0.302938
  Training set accuracy = 0.984000, Test set accuracy = 0.911100
 epoch 13/30. Took 0.22939 seconds. 
  Full-batch training loss = 0.057468, test loss = 0.289761
  Training set accuracy = 0.989500, Test set accuracy = 0.917600
 epoch 14/30. Took 0.2526 seconds. 
  Full-batch training loss = 0.039614, test loss = 0.278160
  Training set accuracy = 0.992500, Test set accuracy = 0.920900
 epoch 15/30. Took 0.25563 seconds. 
  Full-batch training loss = 0.033154, test loss = 0.273978
  Training set accuracy = 0.995500, Test set accuracy = 0.922200
 epoch 16/30. Took 0.23777 seconds. 
  Full-batch training loss = 0.026014, test loss = 0.282281
  Training set accuracy = 0.997000, Test set accuracy = 0.921000
 epoch 17/30. Took 0.23171 seconds. 
  Full-batch training loss = 0.023915, test loss = 0.278882
  Training set accuracy = 0.998000, Test set accuracy = 0.922100
 epoch 18/30. Took 0.23261 seconds. 
  Full-batch training loss = 0.020168, test loss = 0.280802
  Training set accuracy = 0.997500, Test set accuracy = 0.921700
 epoch 19/30. Took 0.26728 seconds. 
  Full-batch training loss = 0.016728, test loss = 0.283455
  Training set accuracy = 0.997500, Test set accuracy = 0.921600
 epoch 20/30. Took 0.26941 seconds. 
  Full-batch training loss = 0.015229, test loss = 0.283787
  Training set accuracy = 1.000000, Test set accuracy = 0.922000
 epoch 21/30. Took 0.25565 seconds. 
  Full-batch training loss = 0.015954, test loss = 0.295999
  Training set accuracy = 0.999000, Test set accuracy = 0.920600
 epoch 22/30. Took 0.25319 seconds. 
  Full-batch training loss = 0.014608, test loss = 0.296781
  Training set accuracy = 0.999500, Test set accuracy = 0.922100
 epoch 23/30. Took 0.28125 seconds. 
  Full-batch training loss = 0.010204, test loss = 0.285841
  Training set accuracy = 0.999000, Test set accuracy = 0.924700
 epoch 24/30. Took 0.23907 seconds. 
  Full-batch training loss = 0.007056, test loss = 0.281825
  Training set accuracy = 1.000000, Test set accuracy = 0.928000
 epoch 25/30. Took 0.22848 seconds. 
  Full-batch training loss = 0.006424, test loss = 0.286073
  Training set accuracy = 0.999500, Test set accuracy = 0.925600
 epoch 26/30. Took 0.24754 seconds. 
  Full-batch training loss = 0.007002, test loss = 0.305220
  Training set accuracy = 1.000000, Test set accuracy = 0.923200
 epoch 27/30. Took 0.23788 seconds. 
  Full-batch training loss = 0.005219, test loss = 0.298080
  Training set accuracy = 1.000000, Test set accuracy = 0.925800
 epoch 28/30. Took 0.24134 seconds. 
  Full-batch training loss = 0.005080, test loss = 0.292679
  Training set accuracy = 1.000000, Test set accuracy = 0.930000
 epoch 29/30. Took 0.22847 seconds. 
  Full-batch training loss = 0.004060, test loss = 0.289519
  Training set accuracy = 1.000000, Test set accuracy = 0.926800
 epoch 30/30. Took 0.24684 seconds. 
  Full-batch training loss = 0.004333, test loss = 0.285989
  Training set accuracy = 1.000000, Test set accuracy = 0.927100
Elapsed time is 23.696776 seconds.
End Training
-----
Params 2000 0.100 0.30 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.070673 seconds. 
  Full-batch training loss = 2.153082, test loss = 2.150406
  Training set accuracy = 0.398500, Test set accuracy = 0.400800
 epoch 2/30. Took 0.060979 seconds. 
  Full-batch training loss = 1.367489, test loss = 1.352620
  Training set accuracy = 0.660000, Test set accuracy = 0.676800
 epoch 3/30. Took 0.062238 seconds. 
  Full-batch training loss = 0.795981, test loss = 0.798141
  Training set accuracy = 0.762000, Test set accuracy = 0.749500
 epoch 4/30. Took 0.061547 seconds. 
  Full-batch training loss = 0.512916, test loss = 0.566968
  Training set accuracy = 0.858000, Test set accuracy = 0.832400
 epoch 5/30. Took 0.060756 seconds. 
  Full-batch training loss = 0.408839, test loss = 0.498773
  Training set accuracy = 0.871500, Test set accuracy = 0.838900
 epoch 6/30. Took 0.066125 seconds. 
  Full-batch training loss = 0.342481, test loss = 0.443187
  Training set accuracy = 0.896500, Test set accuracy = 0.865200
 epoch 7/30. Took 0.066138 seconds. 
  Full-batch training loss = 0.285158, test loss = 0.426958
  Training set accuracy = 0.911500, Test set accuracy = 0.867900
 epoch 8/30. Took 0.054836 seconds. 
  Full-batch training loss = 0.235145, test loss = 0.398927
  Training set accuracy = 0.930000, Test set accuracy = 0.881100
 epoch 9/30. Took 0.064212 seconds. 
  Full-batch training loss = 0.205248, test loss = 0.392781
  Training set accuracy = 0.937500, Test set accuracy = 0.883600
 epoch 10/30. Took 0.065671 seconds. 
  Full-batch training loss = 0.177313, test loss = 0.403673
  Training set accuracy = 0.944000, Test set accuracy = 0.883800
 epoch 11/30. Took 0.062046 seconds. 
  Full-batch training loss = 0.139856, test loss = 0.345965
  Training set accuracy = 0.957000, Test set accuracy = 0.896500
 epoch 12/30. Took 0.056857 seconds. 
  Full-batch training loss = 0.132405, test loss = 0.365611
  Training set accuracy = 0.960000, Test set accuracy = 0.896500
 epoch 13/30. Took 0.057397 seconds. 
  Full-batch training loss = 0.113088, test loss = 0.353034
  Training set accuracy = 0.966000, Test set accuracy = 0.898700
 epoch 14/30. Took 0.056737 seconds. 
  Full-batch training loss = 0.111245, test loss = 0.377506
  Training set accuracy = 0.970000, Test set accuracy = 0.894600
 epoch 15/30. Took 0.076191 seconds. 
  Full-batch training loss = 0.064374, test loss = 0.346476
  Training set accuracy = 0.985000, Test set accuracy = 0.908000
 epoch 16/30. Took 0.068908 seconds. 
  Full-batch training loss = 0.072220, test loss = 0.370909
  Training set accuracy = 0.981500, Test set accuracy = 0.901200
 epoch 17/30. Took 0.057339 seconds. 
  Full-batch training loss = 0.046281, test loss = 0.345625
  Training set accuracy = 0.988500, Test set accuracy = 0.908200
 epoch 18/30. Took 0.061925 seconds. 
  Full-batch training loss = 0.047906, test loss = 0.334645
  Training set accuracy = 0.988500, Test set accuracy = 0.913600
 epoch 19/30. Took 0.057658 seconds. 
  Full-batch training loss = 0.035567, test loss = 0.370975
  Training set accuracy = 0.989000, Test set accuracy = 0.910600
 epoch 20/30. Took 0.061487 seconds. 
  Full-batch training loss = 0.039378, test loss = 0.344937
  Training set accuracy = 0.992500, Test set accuracy = 0.910200
 epoch 21/30. Took 0.065505 seconds. 
  Full-batch training loss = 0.029369, test loss = 0.353593
  Training set accuracy = 0.992000, Test set accuracy = 0.915300
 epoch 22/30. Took 0.06254 seconds. 
  Full-batch training loss = 0.026308, test loss = 0.332496
  Training set accuracy = 0.994500, Test set accuracy = 0.919500
 epoch 23/30. Took 0.064766 seconds. 
  Full-batch training loss = 0.020995, test loss = 0.366735
  Training set accuracy = 0.995000, Test set accuracy = 0.913600
 epoch 24/30. Took 0.061654 seconds. 
  Full-batch training loss = 0.030982, test loss = 0.394329
  Training set accuracy = 0.992500, Test set accuracy = 0.907000
 epoch 25/30. Took 0.064888 seconds. 
  Full-batch training loss = 0.024085, test loss = 0.364800
  Training set accuracy = 0.996000, Test set accuracy = 0.911700
 epoch 26/30. Took 0.057572 seconds. 
  Full-batch training loss = 0.022425, test loss = 0.408355
  Training set accuracy = 0.995500, Test set accuracy = 0.911400
 epoch 27/30. Took 0.056951 seconds. 
  Full-batch training loss = 0.023526, test loss = 0.376512
  Training set accuracy = 0.992500, Test set accuracy = 0.913500
 epoch 28/30. Took 0.061512 seconds. 
  Full-batch training loss = 0.012815, test loss = 0.358500
  Training set accuracy = 0.998000, Test set accuracy = 0.920100
 epoch 29/30. Took 0.061881 seconds. 
  Full-batch training loss = 0.009224, test loss = 0.377815
  Training set accuracy = 0.998500, Test set accuracy = 0.920900
 epoch 30/30. Took 0.060292 seconds. 
  Full-batch training loss = 0.010951, test loss = 0.388605
  Training set accuracy = 0.998000, Test set accuracy = 0.917000
Elapsed time is 6.944786 seconds.
End Training
-----
Params 2000 0.100 0.30 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.12622 seconds. 
  Full-batch training loss = 2.114344, test loss = 2.115825
  Training set accuracy = 0.424500, Test set accuracy = 0.409100
 epoch 2/30. Took 0.10311 seconds. 
  Full-batch training loss = 1.129620, test loss = 1.148456
  Training set accuracy = 0.640000, Test set accuracy = 0.625300
 epoch 3/30. Took 0.1256 seconds. 
  Full-batch training loss = 0.621471, test loss = 0.657306
  Training set accuracy = 0.822500, Test set accuracy = 0.801400
 epoch 4/30. Took 0.10843 seconds. 
  Full-batch training loss = 0.440849, test loss = 0.491824
  Training set accuracy = 0.871000, Test set accuracy = 0.840700
 epoch 5/30. Took 0.12327 seconds. 
  Full-batch training loss = 0.380499, test loss = 0.435858
  Training set accuracy = 0.889000, Test set accuracy = 0.868700
 epoch 6/30. Took 0.12432 seconds. 
  Full-batch training loss = 0.337336, test loss = 0.425795
  Training set accuracy = 0.890000, Test set accuracy = 0.861800
 epoch 7/30. Took 0.10952 seconds. 
  Full-batch training loss = 0.234651, test loss = 0.333367
  Training set accuracy = 0.932000, Test set accuracy = 0.896000
 epoch 8/30. Took 0.11149 seconds. 
  Full-batch training loss = 0.234343, test loss = 0.351546
  Training set accuracy = 0.933500, Test set accuracy = 0.885200
 epoch 9/30. Took 0.12751 seconds. 
  Full-batch training loss = 0.174903, test loss = 0.321102
  Training set accuracy = 0.950500, Test set accuracy = 0.898400
 epoch 10/30. Took 0.12538 seconds. 
  Full-batch training loss = 0.161995, test loss = 0.324795
  Training set accuracy = 0.959000, Test set accuracy = 0.901500
 epoch 11/30. Took 0.12623 seconds. 
  Full-batch training loss = 0.134049, test loss = 0.313267
  Training set accuracy = 0.960500, Test set accuracy = 0.899900
 epoch 12/30. Took 0.12162 seconds. 
  Full-batch training loss = 0.109490, test loss = 0.300410
  Training set accuracy = 0.972000, Test set accuracy = 0.905800
 epoch 13/30. Took 0.12341 seconds. 
  Full-batch training loss = 0.098582, test loss = 0.294049
  Training set accuracy = 0.972500, Test set accuracy = 0.906700
 epoch 14/30. Took 0.12244 seconds. 
  Full-batch training loss = 0.082704, test loss = 0.287366
  Training set accuracy = 0.980500, Test set accuracy = 0.912500
 epoch 15/30. Took 0.11926 seconds. 
  Full-batch training loss = 0.068575, test loss = 0.296808
  Training set accuracy = 0.981500, Test set accuracy = 0.910700
 epoch 16/30. Took 0.10966 seconds. 
  Full-batch training loss = 0.054832, test loss = 0.295986
  Training set accuracy = 0.986500, Test set accuracy = 0.910900
 epoch 17/30. Took 0.12526 seconds. 
  Full-batch training loss = 0.049105, test loss = 0.284713
  Training set accuracy = 0.987000, Test set accuracy = 0.916000
 epoch 18/30. Took 0.12803 seconds. 
  Full-batch training loss = 0.040703, test loss = 0.282084
  Training set accuracy = 0.991000, Test set accuracy = 0.917900
 epoch 19/30. Took 0.12798 seconds. 
  Full-batch training loss = 0.042756, test loss = 0.275799
  Training set accuracy = 0.989000, Test set accuracy = 0.919300
 epoch 20/30. Took 0.12626 seconds. 
  Full-batch training loss = 0.047990, test loss = 0.317500
  Training set accuracy = 0.985500, Test set accuracy = 0.911500
 epoch 21/30. Took 0.12628 seconds. 
  Full-batch training loss = 0.021843, test loss = 0.300604
  Training set accuracy = 0.994500, Test set accuracy = 0.917000
 epoch 22/30. Took 0.11839 seconds. 
  Full-batch training loss = 0.022610, test loss = 0.283055
  Training set accuracy = 0.996000, Test set accuracy = 0.922200
 epoch 23/30. Took 0.12187 seconds. 
  Full-batch training loss = 0.023766, test loss = 0.296564
  Training set accuracy = 0.995000, Test set accuracy = 0.920000
 epoch 24/30. Took 0.12599 seconds. 
  Full-batch training loss = 0.017346, test loss = 0.299912
  Training set accuracy = 0.994000, Test set accuracy = 0.921300
 epoch 25/30. Took 0.12983 seconds. 
  Full-batch training loss = 0.020010, test loss = 0.300999
  Training set accuracy = 0.994500, Test set accuracy = 0.922000
 epoch 26/30. Took 0.12061 seconds. 
  Full-batch training loss = 0.010774, test loss = 0.295634
  Training set accuracy = 0.998000, Test set accuracy = 0.923700
 epoch 27/30. Took 0.10825 seconds. 
  Full-batch training loss = 0.013070, test loss = 0.297790
  Training set accuracy = 0.999000, Test set accuracy = 0.921200
 epoch 28/30. Took 0.12777 seconds. 
  Full-batch training loss = 0.013372, test loss = 0.320132
  Training set accuracy = 0.996500, Test set accuracy = 0.918000
 epoch 29/30. Took 0.12821 seconds. 
  Full-batch training loss = 0.011926, test loss = 0.305797
  Training set accuracy = 0.997000, Test set accuracy = 0.923400
 epoch 30/30. Took 0.12715 seconds. 
  Full-batch training loss = 0.006489, test loss = 0.290164
  Training set accuracy = 0.999000, Test set accuracy = 0.925500
Elapsed time is 12.014484 seconds.
End Training
-----
Params 2000 0.100 0.30 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.38225 seconds. 
  Full-batch training loss = 1.979238, test loss = 1.981871
  Training set accuracy = 0.516000, Test set accuracy = 0.516000
 epoch 2/30. Took 0.40229 seconds. 
  Full-batch training loss = 0.821795, test loss = 0.858777
  Training set accuracy = 0.693000, Test set accuracy = 0.691200
 epoch 3/30. Took 0.33058 seconds. 
  Full-batch training loss = 0.436298, test loss = 0.487468
  Training set accuracy = 0.872000, Test set accuracy = 0.852600
 epoch 4/30. Took 0.3298 seconds. 
  Full-batch training loss = 0.363144, test loss = 0.463427
  Training set accuracy = 0.892500, Test set accuracy = 0.858300
 epoch 5/30. Took 0.36823 seconds. 
  Full-batch training loss = 0.254303, test loss = 0.374435
  Training set accuracy = 0.922500, Test set accuracy = 0.890700
 epoch 6/30. Took 0.33861 seconds. 
  Full-batch training loss = 0.198138, test loss = 0.359514
  Training set accuracy = 0.941500, Test set accuracy = 0.891100
 epoch 7/30. Took 0.33848 seconds. 
  Full-batch training loss = 0.170688, test loss = 0.341178
  Training set accuracy = 0.949000, Test set accuracy = 0.899600
 epoch 8/30. Took 0.32613 seconds. 
  Full-batch training loss = 0.132594, test loss = 0.331850
  Training set accuracy = 0.957500, Test set accuracy = 0.902300
 epoch 9/30. Took 0.3908 seconds. 
  Full-batch training loss = 0.136137, test loss = 0.353313
  Training set accuracy = 0.960500, Test set accuracy = 0.902900
 epoch 10/30. Took 0.32969 seconds. 
  Full-batch training loss = 0.098618, test loss = 0.328998
  Training set accuracy = 0.971000, Test set accuracy = 0.904000
 epoch 11/30. Took 0.39059 seconds. 
  Full-batch training loss = 0.064554, test loss = 0.292450
  Training set accuracy = 0.983000, Test set accuracy = 0.919500
 epoch 12/30. Took 0.34923 seconds. 
  Full-batch training loss = 0.054643, test loss = 0.308674
  Training set accuracy = 0.986000, Test set accuracy = 0.913800
 epoch 13/30. Took 0.32701 seconds. 
  Full-batch training loss = 0.048840, test loss = 0.306444
  Training set accuracy = 0.987000, Test set accuracy = 0.916100
 epoch 14/30. Took 0.3436 seconds. 
  Full-batch training loss = 0.036036, test loss = 0.282430
  Training set accuracy = 0.990500, Test set accuracy = 0.919500
 epoch 15/30. Took 0.32598 seconds. 
  Full-batch training loss = 0.024814, test loss = 0.302492
  Training set accuracy = 0.996500, Test set accuracy = 0.920200
 epoch 16/30. Took 0.35996 seconds. 
  Full-batch training loss = 0.020553, test loss = 0.295405
  Training set accuracy = 0.995000, Test set accuracy = 0.922400
 epoch 17/30. Took 0.33949 seconds. 
  Full-batch training loss = 0.025232, test loss = 0.309327
  Training set accuracy = 0.994500, Test set accuracy = 0.921700
 epoch 18/30. Took 0.35434 seconds. 
  Full-batch training loss = 0.019727, test loss = 0.315743
  Training set accuracy = 0.996500, Test set accuracy = 0.919900
 epoch 19/30. Took 0.32966 seconds. 
  Full-batch training loss = 0.011549, test loss = 0.300869
  Training set accuracy = 0.999000, Test set accuracy = 0.923900
 epoch 20/30. Took 0.34596 seconds. 
  Full-batch training loss = 0.012803, test loss = 0.305345
  Training set accuracy = 0.997000, Test set accuracy = 0.925100
 epoch 21/30. Took 0.33955 seconds. 
  Full-batch training loss = 0.010052, test loss = 0.298178
  Training set accuracy = 0.999000, Test set accuracy = 0.924400
 epoch 22/30. Took 0.32546 seconds. 
  Full-batch training loss = 0.010453, test loss = 0.328254
  Training set accuracy = 0.999500, Test set accuracy = 0.918600
 epoch 23/30. Took 0.36283 seconds. 
  Full-batch training loss = 0.007215, test loss = 0.318075
  Training set accuracy = 0.999500, Test set accuracy = 0.922200
 epoch 24/30. Took 0.32773 seconds. 
  Full-batch training loss = 0.010815, test loss = 0.358661
  Training set accuracy = 0.998500, Test set accuracy = 0.914900
 epoch 25/30. Took 0.33553 seconds. 
  Full-batch training loss = 0.004747, test loss = 0.331734
  Training set accuracy = 0.999500, Test set accuracy = 0.924100
 epoch 26/30. Took 0.32511 seconds. 
  Full-batch training loss = 0.004284, test loss = 0.308409
  Training set accuracy = 1.000000, Test set accuracy = 0.928500
 epoch 27/30. Took 0.32449 seconds. 
  Full-batch training loss = 0.004483, test loss = 0.333740
  Training set accuracy = 1.000000, Test set accuracy = 0.923700
 epoch 28/30. Took 0.3253 seconds. 
  Full-batch training loss = 0.004316, test loss = 0.318946
  Training set accuracy = 0.999500, Test set accuracy = 0.925400
 epoch 29/30. Took 0.361 seconds. 
  Full-batch training loss = 0.002837, test loss = 0.336246
  Training set accuracy = 1.000000, Test set accuracy = 0.925000
 epoch 30/30. Took 0.33253 seconds. 
  Full-batch training loss = 0.002121, test loss = 0.346179
  Training set accuracy = 1.000000, Test set accuracy = 0.922300
Elapsed time is 32.559402 seconds.
End Training
-----
Params 2000 0.100 0.40 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.044167 seconds. 
  Full-batch training loss = 1.005751, test loss = 1.021802
  Training set accuracy = 0.802000, Test set accuracy = 0.792500
 epoch 2/30. Took 0.040535 seconds. 
  Full-batch training loss = 0.526026, test loss = 0.568530
  Training set accuracy = 0.874000, Test set accuracy = 0.856700
 epoch 3/30. Took 0.039331 seconds. 
  Full-batch training loss = 0.413367, test loss = 0.468976
  Training set accuracy = 0.895500, Test set accuracy = 0.871300
 epoch 4/30. Took 0.038777 seconds. 
  Full-batch training loss = 0.348151, test loss = 0.419541
  Training set accuracy = 0.912500, Test set accuracy = 0.880800
 epoch 5/30. Took 0.040442 seconds. 
  Full-batch training loss = 0.296370, test loss = 0.385896
  Training set accuracy = 0.920000, Test set accuracy = 0.891400
 epoch 6/30. Took 0.039931 seconds. 
  Full-batch training loss = 0.272344, test loss = 0.378113
  Training set accuracy = 0.928500, Test set accuracy = 0.889600
 epoch 7/30. Took 0.04431 seconds. 
  Full-batch training loss = 0.241603, test loss = 0.349008
  Training set accuracy = 0.940000, Test set accuracy = 0.899800
 epoch 8/30. Took 0.043328 seconds. 
  Full-batch training loss = 0.223761, test loss = 0.353681
  Training set accuracy = 0.945000, Test set accuracy = 0.895400
 epoch 9/30. Took 0.040035 seconds. 
  Full-batch training loss = 0.203874, test loss = 0.332163
  Training set accuracy = 0.953500, Test set accuracy = 0.904800
 epoch 10/30. Took 0.044219 seconds. 
  Full-batch training loss = 0.179548, test loss = 0.321565
  Training set accuracy = 0.956500, Test set accuracy = 0.903200
 epoch 11/30. Took 0.044239 seconds. 
  Full-batch training loss = 0.166789, test loss = 0.310415
  Training set accuracy = 0.964500, Test set accuracy = 0.907800
 epoch 12/30. Took 0.043472 seconds. 
  Full-batch training loss = 0.152426, test loss = 0.306117
  Training set accuracy = 0.971500, Test set accuracy = 0.909700
 epoch 13/30. Took 0.042387 seconds. 
  Full-batch training loss = 0.139145, test loss = 0.306621
  Training set accuracy = 0.970500, Test set accuracy = 0.908900
 epoch 14/30. Took 0.038117 seconds. 
  Full-batch training loss = 0.130860, test loss = 0.304691
  Training set accuracy = 0.971000, Test set accuracy = 0.908500
 epoch 15/30. Took 0.038342 seconds. 
  Full-batch training loss = 0.121197, test loss = 0.294250
  Training set accuracy = 0.975500, Test set accuracy = 0.911500
 epoch 16/30. Took 0.040138 seconds. 
  Full-batch training loss = 0.118385, test loss = 0.307022
  Training set accuracy = 0.976500, Test set accuracy = 0.906900
 epoch 17/30. Took 0.043329 seconds. 
  Full-batch training loss = 0.103184, test loss = 0.295880
  Training set accuracy = 0.978500, Test set accuracy = 0.912500
 epoch 18/30. Took 0.03936 seconds. 
  Full-batch training loss = 0.092405, test loss = 0.282277
  Training set accuracy = 0.986500, Test set accuracy = 0.915200
 epoch 19/30. Took 0.040062 seconds. 
  Full-batch training loss = 0.088811, test loss = 0.283554
  Training set accuracy = 0.984000, Test set accuracy = 0.916000
 epoch 20/30. Took 0.041851 seconds. 
  Full-batch training loss = 0.083441, test loss = 0.289375
  Training set accuracy = 0.987000, Test set accuracy = 0.914800
 epoch 21/30. Took 0.040681 seconds. 
  Full-batch training loss = 0.077554, test loss = 0.282937
  Training set accuracy = 0.989000, Test set accuracy = 0.914200
 epoch 22/30. Took 0.039873 seconds. 
  Full-batch training loss = 0.070643, test loss = 0.282114
  Training set accuracy = 0.988500, Test set accuracy = 0.914900
 epoch 23/30. Took 0.039472 seconds. 
  Full-batch training loss = 0.069224, test loss = 0.281749
  Training set accuracy = 0.989500, Test set accuracy = 0.917800
 epoch 24/30. Took 0.040909 seconds. 
  Full-batch training loss = 0.061375, test loss = 0.284349
  Training set accuracy = 0.992500, Test set accuracy = 0.916000
 epoch 25/30. Took 0.040846 seconds. 
  Full-batch training loss = 0.056083, test loss = 0.275313
  Training set accuracy = 0.992500, Test set accuracy = 0.918800
 epoch 26/30. Took 0.045045 seconds. 
  Full-batch training loss = 0.053793, test loss = 0.282489
  Training set accuracy = 0.993000, Test set accuracy = 0.916800
 epoch 27/30. Took 0.045015 seconds. 
  Full-batch training loss = 0.051142, test loss = 0.281909
  Training set accuracy = 0.993000, Test set accuracy = 0.917000
 epoch 28/30. Took 0.037277 seconds. 
  Full-batch training loss = 0.047420, test loss = 0.279012
  Training set accuracy = 0.995500, Test set accuracy = 0.917600
 epoch 29/30. Took 0.038257 seconds. 
  Full-batch training loss = 0.044028, test loss = 0.280372
  Training set accuracy = 0.995000, Test set accuracy = 0.918400
 epoch 30/30. Took 0.039893 seconds. 
  Full-batch training loss = 0.041420, test loss = 0.274688
  Training set accuracy = 0.995000, Test set accuracy = 0.918200
Elapsed time is 5.198288 seconds.
End Training
-----
Params 2000 0.100 0.40 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.073482 seconds. 
  Full-batch training loss = 0.900313, test loss = 0.911698
  Training set accuracy = 0.802500, Test set accuracy = 0.793400
 epoch 2/30. Took 0.066368 seconds. 
  Full-batch training loss = 0.480665, test loss = 0.529205
  Training set accuracy = 0.877000, Test set accuracy = 0.856000
 epoch 3/30. Took 0.072858 seconds. 
  Full-batch training loss = 0.381505, test loss = 0.450837
  Training set accuracy = 0.905000, Test set accuracy = 0.874800
 epoch 4/30. Took 0.067432 seconds. 
  Full-batch training loss = 0.329440, test loss = 0.416646
  Training set accuracy = 0.912000, Test set accuracy = 0.874600
 epoch 5/30. Took 0.071575 seconds. 
  Full-batch training loss = 0.278062, test loss = 0.378411
  Training set accuracy = 0.931500, Test set accuracy = 0.890500
 epoch 6/30. Took 0.070159 seconds. 
  Full-batch training loss = 0.255026, test loss = 0.367608
  Training set accuracy = 0.935500, Test set accuracy = 0.892700
 epoch 7/30. Took 0.074074 seconds. 
  Full-batch training loss = 0.223082, test loss = 0.345252
  Training set accuracy = 0.942500, Test set accuracy = 0.900200
 epoch 8/30. Took 0.0726 seconds. 
  Full-batch training loss = 0.209827, test loss = 0.345502
  Training set accuracy = 0.946000, Test set accuracy = 0.899700
 epoch 9/30. Took 0.063782 seconds. 
  Full-batch training loss = 0.187723, test loss = 0.329398
  Training set accuracy = 0.960500, Test set accuracy = 0.903900
 epoch 10/30. Took 0.066655 seconds. 
  Full-batch training loss = 0.172060, test loss = 0.325495
  Training set accuracy = 0.962000, Test set accuracy = 0.903400
 epoch 11/30. Took 0.073494 seconds. 
  Full-batch training loss = 0.151325, test loss = 0.310972
  Training set accuracy = 0.967000, Test set accuracy = 0.908600
 epoch 12/30. Took 0.071311 seconds. 
  Full-batch training loss = 0.141579, test loss = 0.311868
  Training set accuracy = 0.970000, Test set accuracy = 0.908600
 epoch 13/30. Took 0.068201 seconds. 
  Full-batch training loss = 0.129537, test loss = 0.310574
  Training set accuracy = 0.974000, Test set accuracy = 0.910200
 epoch 14/30. Took 0.069515 seconds. 
  Full-batch training loss = 0.127136, test loss = 0.320033
  Training set accuracy = 0.971000, Test set accuracy = 0.904100
 epoch 15/30. Took 0.06917 seconds. 
  Full-batch training loss = 0.109183, test loss = 0.299312
  Training set accuracy = 0.979000, Test set accuracy = 0.910400
 epoch 16/30. Took 0.068449 seconds. 
  Full-batch training loss = 0.102059, test loss = 0.294246
  Training set accuracy = 0.976000, Test set accuracy = 0.910900
 epoch 17/30. Took 0.064667 seconds. 
  Full-batch training loss = 0.095901, test loss = 0.299907
  Training set accuracy = 0.981500, Test set accuracy = 0.910200
 epoch 18/30. Took 0.070945 seconds. 
  Full-batch training loss = 0.086751, test loss = 0.308922
  Training set accuracy = 0.983000, Test set accuracy = 0.908700
 epoch 19/30. Took 0.071752 seconds. 
  Full-batch training loss = 0.080300, test loss = 0.299721
  Training set accuracy = 0.986000, Test set accuracy = 0.911300
 epoch 20/30. Took 0.071815 seconds. 
  Full-batch training loss = 0.070180, test loss = 0.289969
  Training set accuracy = 0.989000, Test set accuracy = 0.914300
 epoch 21/30. Took 0.062918 seconds. 
  Full-batch training loss = 0.065854, test loss = 0.287957
  Training set accuracy = 0.988000, Test set accuracy = 0.915000
 epoch 22/30. Took 0.063717 seconds. 
  Full-batch training loss = 0.062084, test loss = 0.293942
  Training set accuracy = 0.989500, Test set accuracy = 0.911300
 epoch 23/30. Took 0.069253 seconds. 
  Full-batch training loss = 0.054769, test loss = 0.294578
  Training set accuracy = 0.993000, Test set accuracy = 0.913600
 epoch 24/30. Took 0.070217 seconds. 
  Full-batch training loss = 0.052742, test loss = 0.295738
  Training set accuracy = 0.992500, Test set accuracy = 0.912700
 epoch 25/30. Took 0.073145 seconds. 
  Full-batch training loss = 0.050130, test loss = 0.290031
  Training set accuracy = 0.994000, Test set accuracy = 0.915000
 epoch 26/30. Took 0.073285 seconds. 
  Full-batch training loss = 0.047394, test loss = 0.293286
  Training set accuracy = 0.993500, Test set accuracy = 0.914500
 epoch 27/30. Took 0.064084 seconds. 
  Full-batch training loss = 0.041958, test loss = 0.291796
  Training set accuracy = 0.996000, Test set accuracy = 0.913600
 epoch 28/30. Took 0.070401 seconds. 
  Full-batch training loss = 0.040678, test loss = 0.295232
  Training set accuracy = 0.994500, Test set accuracy = 0.915700
 epoch 29/30. Took 0.071453 seconds. 
  Full-batch training loss = 0.037137, test loss = 0.294495
  Training set accuracy = 0.996500, Test set accuracy = 0.916200
 epoch 30/30. Took 0.063984 seconds. 
  Full-batch training loss = 0.035220, test loss = 0.295094
  Training set accuracy = 0.996500, Test set accuracy = 0.915700
Elapsed time is 7.677363 seconds.
End Training
-----
Params 2000 0.100 0.40 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.16987 seconds. 
  Full-batch training loss = 0.856842, test loss = 0.847647
  Training set accuracy = 0.807000, Test set accuracy = 0.800700
 epoch 2/30. Took 0.15661 seconds. 
  Full-batch training loss = 0.489740, test loss = 0.495485
  Training set accuracy = 0.879500, Test set accuracy = 0.868800
 epoch 3/30. Took 0.15333 seconds. 
  Full-batch training loss = 0.398674, test loss = 0.422924
  Training set accuracy = 0.895000, Test set accuracy = 0.882100
 epoch 4/30. Took 0.14294 seconds. 
  Full-batch training loss = 0.345654, test loss = 0.388522
  Training set accuracy = 0.910000, Test set accuracy = 0.888600
 epoch 5/30. Took 0.15527 seconds. 
  Full-batch training loss = 0.301672, test loss = 0.361589
  Training set accuracy = 0.920000, Test set accuracy = 0.894100
 epoch 6/30. Took 0.14069 seconds. 
  Full-batch training loss = 0.273502, test loss = 0.351566
  Training set accuracy = 0.932500, Test set accuracy = 0.896700
 epoch 7/30. Took 0.13956 seconds. 
  Full-batch training loss = 0.248532, test loss = 0.345606
  Training set accuracy = 0.931500, Test set accuracy = 0.896100
 epoch 8/30. Took 0.13902 seconds. 
  Full-batch training loss = 0.219950, test loss = 0.323023
  Training set accuracy = 0.947000, Test set accuracy = 0.904200
 epoch 9/30. Took 0.15171 seconds. 
  Full-batch training loss = 0.198531, test loss = 0.319175
  Training set accuracy = 0.954500, Test set accuracy = 0.900800
 epoch 10/30. Took 0.13882 seconds. 
  Full-batch training loss = 0.184835, test loss = 0.311051
  Training set accuracy = 0.953000, Test set accuracy = 0.905700
 epoch 11/30. Took 0.13979 seconds. 
  Full-batch training loss = 0.161635, test loss = 0.294122
  Training set accuracy = 0.959000, Test set accuracy = 0.910900
 epoch 12/30. Took 0.13935 seconds. 
  Full-batch training loss = 0.146130, test loss = 0.291559
  Training set accuracy = 0.966000, Test set accuracy = 0.911300
 epoch 13/30. Took 0.15667 seconds. 
  Full-batch training loss = 0.130607, test loss = 0.290273
  Training set accuracy = 0.968000, Test set accuracy = 0.912500
 epoch 14/30. Took 0.13831 seconds. 
  Full-batch training loss = 0.118055, test loss = 0.284108
  Training set accuracy = 0.975500, Test set accuracy = 0.912300
 epoch 15/30. Took 0.13756 seconds. 
  Full-batch training loss = 0.107466, test loss = 0.284975
  Training set accuracy = 0.979000, Test set accuracy = 0.913200
 epoch 16/30. Took 0.13976 seconds. 
  Full-batch training loss = 0.096014, test loss = 0.277173
  Training set accuracy = 0.982500, Test set accuracy = 0.913400
 epoch 17/30. Took 0.13789 seconds. 
  Full-batch training loss = 0.094738, test loss = 0.286737
  Training set accuracy = 0.982500, Test set accuracy = 0.913600
 epoch 18/30. Took 0.16425 seconds. 
  Full-batch training loss = 0.078621, test loss = 0.269775
  Training set accuracy = 0.987500, Test set accuracy = 0.918900
 epoch 19/30. Took 0.13859 seconds. 
  Full-batch training loss = 0.072867, test loss = 0.270183
  Training set accuracy = 0.988000, Test set accuracy = 0.917200
 epoch 20/30. Took 0.14199 seconds. 
  Full-batch training loss = 0.068216, test loss = 0.272445
  Training set accuracy = 0.990500, Test set accuracy = 0.919800
 epoch 21/30. Took 0.15688 seconds. 
  Full-batch training loss = 0.061185, test loss = 0.267232
  Training set accuracy = 0.991500, Test set accuracy = 0.918900
 epoch 22/30. Took 0.13525 seconds. 
  Full-batch training loss = 0.055828, test loss = 0.269553
  Training set accuracy = 0.992500, Test set accuracy = 0.919200
 epoch 23/30. Took 0.16508 seconds. 
  Full-batch training loss = 0.052991, test loss = 0.269200
  Training set accuracy = 0.994000, Test set accuracy = 0.918300
 epoch 24/30. Took 0.14736 seconds. 
  Full-batch training loss = 0.046643, test loss = 0.267022
  Training set accuracy = 0.997500, Test set accuracy = 0.920000
 epoch 25/30. Took 0.14688 seconds. 
  Full-batch training loss = 0.042938, test loss = 0.268784
  Training set accuracy = 0.997000, Test set accuracy = 0.919000
 epoch 26/30. Took 0.14025 seconds. 
  Full-batch training loss = 0.038489, test loss = 0.261662
  Training set accuracy = 0.997500, Test set accuracy = 0.921800
 epoch 27/30. Took 0.15763 seconds. 
  Full-batch training loss = 0.039174, test loss = 0.273761
  Training set accuracy = 0.997500, Test set accuracy = 0.916500
 epoch 28/30. Took 0.14062 seconds. 
  Full-batch training loss = 0.034602, test loss = 0.265607
  Training set accuracy = 0.998000, Test set accuracy = 0.920900
 epoch 29/30. Took 0.14448 seconds. 
  Full-batch training loss = 0.031358, test loss = 0.260988
  Training set accuracy = 0.999000, Test set accuracy = 0.923500
 epoch 30/30. Took 0.13696 seconds. 
  Full-batch training loss = 0.029861, test loss = 0.260617
  Training set accuracy = 0.999000, Test set accuracy = 0.923500
Elapsed time is 14.763853 seconds.
End Training
-----
Params 2000 0.100 0.40 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.054076 seconds. 
  Full-batch training loss = 1.837032, test loss = 1.847259
  Training set accuracy = 0.597000, Test set accuracy = 0.573500
 epoch 2/30. Took 0.051412 seconds. 
  Full-batch training loss = 1.022775, test loss = 1.026117
  Training set accuracy = 0.723500, Test set accuracy = 0.725500
 epoch 3/30. Took 0.047832 seconds. 
  Full-batch training loss = 0.611397, test loss = 0.644432
  Training set accuracy = 0.848500, Test set accuracy = 0.833700
 epoch 4/30. Took 0.050174 seconds. 
  Full-batch training loss = 0.487232, test loss = 0.538102
  Training set accuracy = 0.860500, Test set accuracy = 0.847500
 epoch 5/30. Took 0.049697 seconds. 
  Full-batch training loss = 0.405919, test loss = 0.468926
  Training set accuracy = 0.889500, Test set accuracy = 0.865900
 epoch 6/30. Took 0.055611 seconds. 
  Full-batch training loss = 0.332349, test loss = 0.412548
  Training set accuracy = 0.914500, Test set accuracy = 0.881000
 epoch 7/30. Took 0.052889 seconds. 
  Full-batch training loss = 0.289970, test loss = 0.391990
  Training set accuracy = 0.923500, Test set accuracy = 0.888500
 epoch 8/30. Took 0.050056 seconds. 
  Full-batch training loss = 0.244528, test loss = 0.358522
  Training set accuracy = 0.935500, Test set accuracy = 0.899000
 epoch 9/30. Took 0.050401 seconds. 
  Full-batch training loss = 0.220566, test loss = 0.353589
  Training set accuracy = 0.939500, Test set accuracy = 0.898500
 epoch 10/30. Took 0.050507 seconds. 
  Full-batch training loss = 0.198906, test loss = 0.344115
  Training set accuracy = 0.945500, Test set accuracy = 0.899400
 epoch 11/30. Took 0.056407 seconds. 
  Full-batch training loss = 0.188082, test loss = 0.352550
  Training set accuracy = 0.946000, Test set accuracy = 0.895300
 epoch 12/30. Took 0.049707 seconds. 
  Full-batch training loss = 0.167194, test loss = 0.331964
  Training set accuracy = 0.954000, Test set accuracy = 0.903900
 epoch 13/30. Took 0.053504 seconds. 
  Full-batch training loss = 0.157066, test loss = 0.324680
  Training set accuracy = 0.957500, Test set accuracy = 0.903700
 epoch 14/30. Took 0.049103 seconds. 
  Full-batch training loss = 0.136422, test loss = 0.322295
  Training set accuracy = 0.964500, Test set accuracy = 0.906300
 epoch 15/30. Took 0.049559 seconds. 
  Full-batch training loss = 0.118528, test loss = 0.318129
  Training set accuracy = 0.966500, Test set accuracy = 0.908400
 epoch 16/30. Took 0.051051 seconds. 
  Full-batch training loss = 0.114331, test loss = 0.318904
  Training set accuracy = 0.968500, Test set accuracy = 0.910100
 epoch 17/30. Took 0.055632 seconds. 
  Full-batch training loss = 0.101506, test loss = 0.308876
  Training set accuracy = 0.971000, Test set accuracy = 0.912000
 epoch 18/30. Took 0.054456 seconds. 
  Full-batch training loss = 0.089171, test loss = 0.307096
  Training set accuracy = 0.979500, Test set accuracy = 0.913700
 epoch 19/30. Took 0.053531 seconds. 
  Full-batch training loss = 0.078208, test loss = 0.309581
  Training set accuracy = 0.979000, Test set accuracy = 0.915000
 epoch 20/30. Took 0.054259 seconds. 
  Full-batch training loss = 0.084765, test loss = 0.326141
  Training set accuracy = 0.974000, Test set accuracy = 0.908100
 epoch 21/30. Took 0.055105 seconds. 
  Full-batch training loss = 0.065035, test loss = 0.307381
  Training set accuracy = 0.985500, Test set accuracy = 0.917000
 epoch 22/30. Took 0.049861 seconds. 
  Full-batch training loss = 0.070649, test loss = 0.319824
  Training set accuracy = 0.982500, Test set accuracy = 0.912000
 epoch 23/30. Took 0.050132 seconds. 
  Full-batch training loss = 0.057373, test loss = 0.314911
  Training set accuracy = 0.984000, Test set accuracy = 0.916000
 epoch 24/30. Took 0.051268 seconds. 
  Full-batch training loss = 0.048116, test loss = 0.306784
  Training set accuracy = 0.991500, Test set accuracy = 0.917200
 epoch 25/30. Took 0.04881 seconds. 
  Full-batch training loss = 0.045882, test loss = 0.311491
  Training set accuracy = 0.990500, Test set accuracy = 0.916200
 epoch 26/30. Took 0.051244 seconds. 
  Full-batch training loss = 0.042683, test loss = 0.299255
  Training set accuracy = 0.994000, Test set accuracy = 0.918500
 epoch 27/30. Took 0.047999 seconds. 
  Full-batch training loss = 0.037817, test loss = 0.313529
  Training set accuracy = 0.991000, Test set accuracy = 0.917100
 epoch 28/30. Took 0.048414 seconds. 
  Full-batch training loss = 0.035068, test loss = 0.317074
  Training set accuracy = 0.994500, Test set accuracy = 0.917400
 epoch 29/30. Took 0.056118 seconds. 
  Full-batch training loss = 0.036661, test loss = 0.310838
  Training set accuracy = 0.993500, Test set accuracy = 0.919500
 epoch 30/30. Took 0.054112 seconds. 
  Full-batch training loss = 0.027556, test loss = 0.297469
  Training set accuracy = 0.995000, Test set accuracy = 0.922600
Elapsed time is 5.888855 seconds.
End Training
-----
Params 2000 0.100 0.40 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.093499 seconds. 
  Full-batch training loss = 1.867569, test loss = 1.864296
  Training set accuracy = 0.629000, Test set accuracy = 0.644200
 epoch 2/30. Took 0.089042 seconds. 
  Full-batch training loss = 0.851958, test loss = 0.847560
  Training set accuracy = 0.789000, Test set accuracy = 0.790500
 epoch 3/30. Took 0.1016 seconds. 
  Full-batch training loss = 0.557205, test loss = 0.587555
  Training set accuracy = 0.850000, Test set accuracy = 0.838300
 epoch 4/30. Took 0.0888 seconds. 
  Full-batch training loss = 0.417631, test loss = 0.467943
  Training set accuracy = 0.882000, Test set accuracy = 0.869300
 epoch 5/30. Took 0.099726 seconds. 
  Full-batch training loss = 0.348272, test loss = 0.421678
  Training set accuracy = 0.897500, Test set accuracy = 0.872700
 epoch 6/30. Took 0.095798 seconds. 
  Full-batch training loss = 0.279159, test loss = 0.372744
  Training set accuracy = 0.916000, Test set accuracy = 0.893700
 epoch 7/30. Took 0.088878 seconds. 
  Full-batch training loss = 0.238500, test loss = 0.345934
  Training set accuracy = 0.930500, Test set accuracy = 0.900500
 epoch 8/30. Took 0.10138 seconds. 
  Full-batch training loss = 0.223467, test loss = 0.346800
  Training set accuracy = 0.938500, Test set accuracy = 0.898800
 epoch 9/30. Took 0.098853 seconds. 
  Full-batch training loss = 0.185772, test loss = 0.339479
  Training set accuracy = 0.944000, Test set accuracy = 0.897800
 epoch 10/30. Took 0.087932 seconds. 
  Full-batch training loss = 0.162159, test loss = 0.307123
  Training set accuracy = 0.956500, Test set accuracy = 0.911800
 epoch 11/30. Took 0.087417 seconds. 
  Full-batch training loss = 0.154773, test loss = 0.335949
  Training set accuracy = 0.950000, Test set accuracy = 0.900900
 epoch 12/30. Took 0.10413 seconds. 
  Full-batch training loss = 0.123902, test loss = 0.298320
  Training set accuracy = 0.967500, Test set accuracy = 0.913200
 epoch 13/30. Took 0.087036 seconds. 
  Full-batch training loss = 0.110354, test loss = 0.298519
  Training set accuracy = 0.970000, Test set accuracy = 0.914000
 epoch 14/30. Took 0.089584 seconds. 
  Full-batch training loss = 0.093763, test loss = 0.284298
  Training set accuracy = 0.976000, Test set accuracy = 0.918300
 epoch 15/30. Took 0.095142 seconds. 
  Full-batch training loss = 0.098113, test loss = 0.308504
  Training set accuracy = 0.974500, Test set accuracy = 0.911200
 epoch 16/30. Took 0.092611 seconds. 
  Full-batch training loss = 0.073771, test loss = 0.284003
  Training set accuracy = 0.982000, Test set accuracy = 0.916500
 epoch 17/30. Took 0.09848 seconds. 
  Full-batch training loss = 0.070744, test loss = 0.295709
  Training set accuracy = 0.983000, Test set accuracy = 0.914100
 epoch 18/30. Took 0.08742 seconds. 
  Full-batch training loss = 0.060278, test loss = 0.289277
  Training set accuracy = 0.990000, Test set accuracy = 0.917300
 epoch 19/30. Took 0.099705 seconds. 
  Full-batch training loss = 0.055082, test loss = 0.293636
  Training set accuracy = 0.987500, Test set accuracy = 0.916300
 epoch 20/30. Took 0.093444 seconds. 
  Full-batch training loss = 0.046842, test loss = 0.280904
  Training set accuracy = 0.991000, Test set accuracy = 0.920900
 epoch 21/30. Took 0.098679 seconds. 
  Full-batch training loss = 0.043105, test loss = 0.275767
  Training set accuracy = 0.993500, Test set accuracy = 0.922300
 epoch 22/30. Took 0.097699 seconds. 
  Full-batch training loss = 0.037073, test loss = 0.286874
  Training set accuracy = 0.994000, Test set accuracy = 0.923200
 epoch 23/30. Took 0.091126 seconds. 
  Full-batch training loss = 0.032206, test loss = 0.283754
  Training set accuracy = 0.995000, Test set accuracy = 0.922800
 epoch 24/30. Took 0.089919 seconds. 
  Full-batch training loss = 0.029754, test loss = 0.284793
  Training set accuracy = 0.995500, Test set accuracy = 0.923700
 epoch 25/30. Took 0.091137 seconds. 
  Full-batch training loss = 0.029566, test loss = 0.294634
  Training set accuracy = 0.993500, Test set accuracy = 0.922200
 epoch 26/30. Took 0.096752 seconds. 
  Full-batch training loss = 0.024959, test loss = 0.287532
  Training set accuracy = 0.995500, Test set accuracy = 0.923600
 epoch 27/30. Took 0.09488 seconds. 
  Full-batch training loss = 0.023090, test loss = 0.296178
  Training set accuracy = 0.995000, Test set accuracy = 0.923100
 epoch 28/30. Took 0.098969 seconds. 
  Full-batch training loss = 0.018760, test loss = 0.289210
  Training set accuracy = 0.996000, Test set accuracy = 0.924500
 epoch 29/30. Took 0.090422 seconds. 
  Full-batch training loss = 0.017329, test loss = 0.294277
  Training set accuracy = 0.999000, Test set accuracy = 0.922900
 epoch 30/30. Took 0.090493 seconds. 
  Full-batch training loss = 0.013905, test loss = 0.287033
  Training set accuracy = 0.999000, Test set accuracy = 0.925100
Elapsed time is 9.652965 seconds.
End Training
-----
Params 2000 0.100 0.40 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.24576 seconds. 
  Full-batch training loss = 1.701961, test loss = 1.700923
  Training set accuracy = 0.669500, Test set accuracy = 0.665800
 epoch 2/30. Took 0.23531 seconds. 
  Full-batch training loss = 0.683076, test loss = 0.686686
  Training set accuracy = 0.804000, Test set accuracy = 0.795300
 epoch 3/30. Took 0.23434 seconds. 
  Full-batch training loss = 0.467230, test loss = 0.492175
  Training set accuracy = 0.860500, Test set accuracy = 0.847100
 epoch 4/30. Took 0.27227 seconds. 
  Full-batch training loss = 0.381629, test loss = 0.429946
  Training set accuracy = 0.889500, Test set accuracy = 0.871800
 epoch 5/30. Took 0.26273 seconds. 
  Full-batch training loss = 0.363452, test loss = 0.425468
  Training set accuracy = 0.892500, Test set accuracy = 0.870500
 epoch 6/30. Took 0.23391 seconds. 
  Full-batch training loss = 0.274478, test loss = 0.364878
  Training set accuracy = 0.923000, Test set accuracy = 0.894400
 epoch 7/30. Took 0.23481 seconds. 
  Full-batch training loss = 0.258698, test loss = 0.354049
  Training set accuracy = 0.922000, Test set accuracy = 0.895500
 epoch 8/30. Took 0.24112 seconds. 
  Full-batch training loss = 0.206238, test loss = 0.327210
  Training set accuracy = 0.945500, Test set accuracy = 0.904000
 epoch 9/30. Took 0.24951 seconds. 
  Full-batch training loss = 0.185820, test loss = 0.322713
  Training set accuracy = 0.952000, Test set accuracy = 0.909500
 epoch 10/30. Took 0.24069 seconds. 
  Full-batch training loss = 0.157079, test loss = 0.316895
  Training set accuracy = 0.958000, Test set accuracy = 0.908100
 epoch 11/30. Took 0.26994 seconds. 
  Full-batch training loss = 0.145620, test loss = 0.306772
  Training set accuracy = 0.959500, Test set accuracy = 0.909400
 epoch 12/30. Took 0.27457 seconds. 
  Full-batch training loss = 0.128935, test loss = 0.304279
  Training set accuracy = 0.969000, Test set accuracy = 0.911200
 epoch 13/30. Took 0.27099 seconds. 
  Full-batch training loss = 0.109513, test loss = 0.293216
  Training set accuracy = 0.973000, Test set accuracy = 0.913200
 epoch 14/30. Took 0.23479 seconds. 
  Full-batch training loss = 0.100115, test loss = 0.294204
  Training set accuracy = 0.979500, Test set accuracy = 0.911500
 epoch 15/30. Took 0.27538 seconds. 
  Full-batch training loss = 0.082256, test loss = 0.289909
  Training set accuracy = 0.984500, Test set accuracy = 0.915100
 epoch 16/30. Took 0.23243 seconds. 
  Full-batch training loss = 0.075913, test loss = 0.290160
  Training set accuracy = 0.983500, Test set accuracy = 0.914700
 epoch 17/30. Took 0.24965 seconds. 
  Full-batch training loss = 0.064382, test loss = 0.284710
  Training set accuracy = 0.987500, Test set accuracy = 0.916000
 epoch 18/30. Took 0.23089 seconds. 
  Full-batch training loss = 0.058314, test loss = 0.282671
  Training set accuracy = 0.991500, Test set accuracy = 0.916800
 epoch 19/30. Took 0.23116 seconds. 
  Full-batch training loss = 0.048945, test loss = 0.279882
  Training set accuracy = 0.990500, Test set accuracy = 0.919500
 epoch 20/30. Took 0.25519 seconds. 
  Full-batch training loss = 0.046498, test loss = 0.302063
  Training set accuracy = 0.992000, Test set accuracy = 0.914700
 epoch 21/30. Took 0.28165 seconds. 
  Full-batch training loss = 0.034566, test loss = 0.285763
  Training set accuracy = 0.995500, Test set accuracy = 0.920800
 epoch 22/30. Took 0.25836 seconds. 
  Full-batch training loss = 0.032801, test loss = 0.281624
  Training set accuracy = 0.995500, Test set accuracy = 0.920600
 epoch 23/30. Took 0.23462 seconds. 
  Full-batch training loss = 0.029446, test loss = 0.290917
  Training set accuracy = 0.996000, Test set accuracy = 0.918900
 epoch 24/30. Took 0.23565 seconds. 
  Full-batch training loss = 0.026860, test loss = 0.284112
  Training set accuracy = 0.996000, Test set accuracy = 0.921800
 epoch 25/30. Took 0.27736 seconds. 
  Full-batch training loss = 0.020856, test loss = 0.282927
  Training set accuracy = 0.998000, Test set accuracy = 0.923000
 epoch 26/30. Took 0.23641 seconds. 
  Full-batch training loss = 0.021970, test loss = 0.298120
  Training set accuracy = 0.997000, Test set accuracy = 0.920300
 epoch 27/30. Took 0.23071 seconds. 
  Full-batch training loss = 0.016760, test loss = 0.289309
  Training set accuracy = 0.999000, Test set accuracy = 0.921800
 epoch 28/30. Took 0.24974 seconds. 
  Full-batch training loss = 0.014832, test loss = 0.287961
  Training set accuracy = 0.998500, Test set accuracy = 0.922100
 epoch 29/30. Took 0.2338 seconds. 
  Full-batch training loss = 0.013933, test loss = 0.285348
  Training set accuracy = 0.999000, Test set accuracy = 0.923400
 epoch 30/30. Took 0.2405 seconds. 
  Full-batch training loss = 0.011589, test loss = 0.292145
  Training set accuracy = 1.000000, Test set accuracy = 0.922500
Elapsed time is 23.717377 seconds.
End Training
-----
Params 2000 0.100 0.40 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.059607 seconds. 
  Full-batch training loss = 2.246274, test loss = 2.250412
  Training set accuracy = 0.266500, Test set accuracy = 0.267100
 epoch 2/30. Took 0.055138 seconds. 
  Full-batch training loss = 2.006811, test loss = 2.011385
  Training set accuracy = 0.483500, Test set accuracy = 0.476700
 epoch 3/30. Took 0.056366 seconds. 
  Full-batch training loss = 1.377815, test loss = 1.377700
  Training set accuracy = 0.646500, Test set accuracy = 0.637400
 epoch 4/30. Took 0.062616 seconds. 
  Full-batch training loss = 0.900853, test loss = 0.911618
  Training set accuracy = 0.759500, Test set accuracy = 0.749700
 epoch 5/30. Took 0.062496 seconds. 
  Full-batch training loss = 0.702385, test loss = 0.738959
  Training set accuracy = 0.757500, Test set accuracy = 0.738100
 epoch 6/30. Took 0.061755 seconds. 
  Full-batch training loss = 0.545521, test loss = 0.595861
  Training set accuracy = 0.834500, Test set accuracy = 0.814700
 epoch 7/30. Took 0.066256 seconds. 
  Full-batch training loss = 0.463602, test loss = 0.531941
  Training set accuracy = 0.876000, Test set accuracy = 0.845000
 epoch 8/30. Took 0.066002 seconds. 
  Full-batch training loss = 0.417625, test loss = 0.497670
  Training set accuracy = 0.884000, Test set accuracy = 0.851400
 epoch 9/30. Took 0.066546 seconds. 
  Full-batch training loss = 0.372862, test loss = 0.465528
  Training set accuracy = 0.894500, Test set accuracy = 0.863300
 epoch 10/30. Took 0.060581 seconds. 
  Full-batch training loss = 0.301112, test loss = 0.415990
  Training set accuracy = 0.924000, Test set accuracy = 0.880300
 epoch 11/30. Took 0.061397 seconds. 
  Full-batch training loss = 0.275769, test loss = 0.395883
  Training set accuracy = 0.930500, Test set accuracy = 0.883900
 epoch 12/30. Took 0.066201 seconds. 
  Full-batch training loss = 0.240438, test loss = 0.378065
  Training set accuracy = 0.938000, Test set accuracy = 0.889700
 epoch 13/30. Took 0.065464 seconds. 
  Full-batch training loss = 0.229736, test loss = 0.369719
  Training set accuracy = 0.940000, Test set accuracy = 0.891400
 epoch 14/30. Took 0.059876 seconds. 
  Full-batch training loss = 0.211310, test loss = 0.386243
  Training set accuracy = 0.939000, Test set accuracy = 0.886500
 epoch 15/30. Took 0.060359 seconds. 
  Full-batch training loss = 0.193214, test loss = 0.354848
  Training set accuracy = 0.948500, Test set accuracy = 0.895300
 epoch 16/30. Took 0.067151 seconds. 
  Full-batch training loss = 0.177862, test loss = 0.379481
  Training set accuracy = 0.945000, Test set accuracy = 0.891000
 epoch 17/30. Took 0.056772 seconds. 
  Full-batch training loss = 0.200232, test loss = 0.390058
  Training set accuracy = 0.950000, Test set accuracy = 0.884700
 epoch 18/30. Took 0.061307 seconds. 
  Full-batch training loss = 0.126970, test loss = 0.344679
  Training set accuracy = 0.966000, Test set accuracy = 0.903000
 epoch 19/30. Took 0.061363 seconds. 
  Full-batch training loss = 0.146569, test loss = 0.361092
  Training set accuracy = 0.960500, Test set accuracy = 0.898300
 epoch 20/30. Took 0.06634 seconds. 
  Full-batch training loss = 0.110420, test loss = 0.341157
  Training set accuracy = 0.974000, Test set accuracy = 0.904700
 epoch 21/30. Took 0.059912 seconds. 
  Full-batch training loss = 0.107865, test loss = 0.332719
  Training set accuracy = 0.972500, Test set accuracy = 0.905100
 epoch 22/30. Took 0.061009 seconds. 
  Full-batch training loss = 0.108189, test loss = 0.370416
  Training set accuracy = 0.972500, Test set accuracy = 0.900000
 epoch 23/30. Took 0.060604 seconds. 
  Full-batch training loss = 0.082224, test loss = 0.332760
  Training set accuracy = 0.979000, Test set accuracy = 0.908100
 epoch 24/30. Took 0.05975 seconds. 
  Full-batch training loss = 0.079704, test loss = 0.343780
  Training set accuracy = 0.977000, Test set accuracy = 0.907700
 epoch 25/30. Took 0.058463 seconds. 
  Full-batch training loss = 0.075107, test loss = 0.348446
  Training set accuracy = 0.981500, Test set accuracy = 0.906800
 epoch 26/30. Took 0.061335 seconds. 
  Full-batch training loss = 0.068065, test loss = 0.347613
  Training set accuracy = 0.985000, Test set accuracy = 0.909800
 epoch 27/30. Took 0.062733 seconds. 
  Full-batch training loss = 0.070005, test loss = 0.350707
  Training set accuracy = 0.982500, Test set accuracy = 0.907300
 epoch 28/30. Took 0.064589 seconds. 
  Full-batch training loss = 0.061876, test loss = 0.348421
  Training set accuracy = 0.984500, Test set accuracy = 0.909100
 epoch 29/30. Took 0.063183 seconds. 
  Full-batch training loss = 0.049584, test loss = 0.349904
  Training set accuracy = 0.988000, Test set accuracy = 0.911700
 epoch 30/30. Took 0.061117 seconds. 
  Full-batch training loss = 0.053501, test loss = 0.335163
  Training set accuracy = 0.986500, Test set accuracy = 0.913500
Elapsed time is 6.884085 seconds.
End Training
-----
Params 2000 0.100 0.40 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.12457 seconds. 
  Full-batch training loss = 2.241055, test loss = 2.249306
  Training set accuracy = 0.235000, Test set accuracy = 0.205900
 epoch 2/30. Took 0.12044 seconds. 
  Full-batch training loss = 1.922256, test loss = 1.937715
  Training set accuracy = 0.513500, Test set accuracy = 0.484700
 epoch 3/30. Took 0.10661 seconds. 
  Full-batch training loss = 1.064635, test loss = 1.103592
  Training set accuracy = 0.680500, Test set accuracy = 0.659200
 epoch 4/30. Took 0.10833 seconds. 
  Full-batch training loss = 0.687608, test loss = 0.737019
  Training set accuracy = 0.784500, Test set accuracy = 0.765300
 epoch 5/30. Took 0.11843 seconds. 
  Full-batch training loss = 0.576833, test loss = 0.644829
  Training set accuracy = 0.811000, Test set accuracy = 0.790600
 epoch 6/30. Took 0.10597 seconds. 
  Full-batch training loss = 0.407278, test loss = 0.493928
  Training set accuracy = 0.881000, Test set accuracy = 0.854400
 epoch 7/30. Took 0.11166 seconds. 
  Full-batch training loss = 0.378903, test loss = 0.483839
  Training set accuracy = 0.870000, Test set accuracy = 0.837900
 epoch 8/30. Took 0.1031 seconds. 
  Full-batch training loss = 0.313446, test loss = 0.431980
  Training set accuracy = 0.898000, Test set accuracy = 0.868800
 epoch 9/30. Took 0.11944 seconds. 
  Full-batch training loss = 0.250813, test loss = 0.394216
  Training set accuracy = 0.921000, Test set accuracy = 0.880600
 epoch 10/30. Took 0.10677 seconds. 
  Full-batch training loss = 0.214490, test loss = 0.371987
  Training set accuracy = 0.938500, Test set accuracy = 0.888900
 epoch 11/30. Took 0.10941 seconds. 
  Full-batch training loss = 0.195595, test loss = 0.370402
  Training set accuracy = 0.938000, Test set accuracy = 0.889400
 epoch 12/30. Took 0.10821 seconds. 
  Full-batch training loss = 0.156822, test loss = 0.345809
  Training set accuracy = 0.958500, Test set accuracy = 0.896500
 epoch 13/30. Took 0.10422 seconds. 
  Full-batch training loss = 0.134939, test loss = 0.339349
  Training set accuracy = 0.963500, Test set accuracy = 0.898100
 epoch 14/30. Took 0.12755 seconds. 
  Full-batch training loss = 0.124759, test loss = 0.347743
  Training set accuracy = 0.960500, Test set accuracy = 0.897200
 epoch 15/30. Took 0.12141 seconds. 
  Full-batch training loss = 0.102589, test loss = 0.335626
  Training set accuracy = 0.975000, Test set accuracy = 0.901500
 epoch 16/30. Took 0.11947 seconds. 
  Full-batch training loss = 0.082190, test loss = 0.331108
  Training set accuracy = 0.977000, Test set accuracy = 0.906300
 epoch 17/30. Took 0.12311 seconds. 
  Full-batch training loss = 0.083758, test loss = 0.347749
  Training set accuracy = 0.977000, Test set accuracy = 0.904600
 epoch 18/30. Took 0.12163 seconds. 
  Full-batch training loss = 0.082810, test loss = 0.357221
  Training set accuracy = 0.980500, Test set accuracy = 0.900400
 epoch 19/30. Took 0.10711 seconds. 
  Full-batch training loss = 0.058892, test loss = 0.324219
  Training set accuracy = 0.985000, Test set accuracy = 0.912100
 epoch 20/30. Took 0.10693 seconds. 
  Full-batch training loss = 0.053537, test loss = 0.326107
  Training set accuracy = 0.988000, Test set accuracy = 0.913400
 epoch 21/30. Took 0.10704 seconds. 
  Full-batch training loss = 0.045326, test loss = 0.320323
  Training set accuracy = 0.992000, Test set accuracy = 0.915800
 epoch 22/30. Took 0.10887 seconds. 
  Full-batch training loss = 0.041671, test loss = 0.334725
  Training set accuracy = 0.991000, Test set accuracy = 0.909100
 epoch 23/30. Took 0.10848 seconds. 
  Full-batch training loss = 0.032484, test loss = 0.340125
  Training set accuracy = 0.992500, Test set accuracy = 0.913900
 epoch 24/30. Took 0.12123 seconds. 
  Full-batch training loss = 0.027607, test loss = 0.342394
  Training set accuracy = 0.996500, Test set accuracy = 0.912700
 epoch 25/30. Took 0.12037 seconds. 
  Full-batch training loss = 0.023943, test loss = 0.333737
  Training set accuracy = 0.996500, Test set accuracy = 0.914700
 epoch 26/30. Took 0.1072 seconds. 
  Full-batch training loss = 0.026184, test loss = 0.346096
  Training set accuracy = 0.994000, Test set accuracy = 0.915500
 epoch 27/30. Took 0.1088 seconds. 
  Full-batch training loss = 0.023739, test loss = 0.350088
  Training set accuracy = 0.996500, Test set accuracy = 0.913000
 epoch 28/30. Took 0.12305 seconds. 
  Full-batch training loss = 0.015889, test loss = 0.347128
  Training set accuracy = 0.997500, Test set accuracy = 0.915700
 epoch 29/30. Took 0.12084 seconds. 
  Full-batch training loss = 0.025752, test loss = 0.367797
  Training set accuracy = 0.995500, Test set accuracy = 0.912100
 epoch 30/30. Took 0.10738 seconds. 
  Full-batch training loss = 0.013174, test loss = 0.344209
  Training set accuracy = 0.997500, Test set accuracy = 0.916000
Elapsed time is 12.143829 seconds.
End Training
-----
Params 2000 0.100 0.40 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35916 seconds. 
  Full-batch training loss = 2.207330, test loss = 2.219617
  Training set accuracy = 0.172500, Test set accuracy = 0.154000
 epoch 2/30. Took 0.33367 seconds. 
  Full-batch training loss = 1.697512, test loss = 1.724455
  Training set accuracy = 0.567000, Test set accuracy = 0.556100
 epoch 3/30. Took 0.32394 seconds. 
  Full-batch training loss = 0.788047, test loss = 0.832969
  Training set accuracy = 0.761500, Test set accuracy = 0.744900
 epoch 4/30. Took 0.34119 seconds. 
  Full-batch training loss = 0.562899, test loss = 0.624070
  Training set accuracy = 0.810000, Test set accuracy = 0.788600
 epoch 5/30. Took 0.32427 seconds. 
  Full-batch training loss = 0.412086, test loss = 0.500622
  Training set accuracy = 0.881500, Test set accuracy = 0.850800
 epoch 6/30. Took 0.32667 seconds. 
  Full-batch training loss = 0.323744, test loss = 0.422226
  Training set accuracy = 0.901000, Test set accuracy = 0.877100
 epoch 7/30. Took 0.37105 seconds. 
  Full-batch training loss = 0.296202, test loss = 0.425505
  Training set accuracy = 0.903500, Test set accuracy = 0.868500
 epoch 8/30. Took 0.33305 seconds. 
  Full-batch training loss = 0.221772, test loss = 0.362355
  Training set accuracy = 0.935000, Test set accuracy = 0.892500
 epoch 9/30. Took 0.39831 seconds. 
  Full-batch training loss = 0.242377, test loss = 0.396397
  Training set accuracy = 0.928000, Test set accuracy = 0.883500
 epoch 10/30. Took 0.32435 seconds. 
  Full-batch training loss = 0.159810, test loss = 0.323806
  Training set accuracy = 0.953000, Test set accuracy = 0.903100
 epoch 11/30. Took 0.33961 seconds. 
  Full-batch training loss = 0.136827, test loss = 0.313238
  Training set accuracy = 0.966000, Test set accuracy = 0.906900
 epoch 12/30. Took 0.3427 seconds. 
  Full-batch training loss = 0.111453, test loss = 0.303372
  Training set accuracy = 0.970500, Test set accuracy = 0.909800
 epoch 13/30. Took 0.36896 seconds. 
  Full-batch training loss = 0.098967, test loss = 0.301613
  Training set accuracy = 0.975500, Test set accuracy = 0.909900
 epoch 14/30. Took 0.32727 seconds. 
  Full-batch training loss = 0.071375, test loss = 0.293191
  Training set accuracy = 0.983000, Test set accuracy = 0.914100
 epoch 15/30. Took 0.34061 seconds. 
  Full-batch training loss = 0.065518, test loss = 0.288023
  Training set accuracy = 0.983500, Test set accuracy = 0.913800
 epoch 16/30. Took 0.38033 seconds. 
  Full-batch training loss = 0.057721, test loss = 0.288106
  Training set accuracy = 0.986000, Test set accuracy = 0.918000
 epoch 17/30. Took 0.33832 seconds. 
  Full-batch training loss = 0.045789, test loss = 0.273944
  Training set accuracy = 0.988500, Test set accuracy = 0.919800
 epoch 18/30. Took 0.32472 seconds. 
  Full-batch training loss = 0.044668, test loss = 0.312038
  Training set accuracy = 0.989000, Test set accuracy = 0.914000
 epoch 19/30. Took 0.37057 seconds. 
  Full-batch training loss = 0.025672, test loss = 0.273540
  Training set accuracy = 0.996000, Test set accuracy = 0.924000
 epoch 20/30. Took 0.32297 seconds. 
  Full-batch training loss = 0.020996, test loss = 0.280186
  Training set accuracy = 0.998500, Test set accuracy = 0.922500
 epoch 21/30. Took 0.33772 seconds. 
  Full-batch training loss = 0.017711, test loss = 0.268904
  Training set accuracy = 0.996000, Test set accuracy = 0.926500
 epoch 22/30. Took 0.32971 seconds. 
  Full-batch training loss = 0.014544, test loss = 0.277928
  Training set accuracy = 0.999000, Test set accuracy = 0.925500
 epoch 23/30. Took 0.32745 seconds. 
  Full-batch training loss = 0.012751, test loss = 0.294223
  Training set accuracy = 0.997500, Test set accuracy = 0.925400
 epoch 24/30. Took 0.32609 seconds. 
  Full-batch training loss = 0.009319, test loss = 0.276108
  Training set accuracy = 0.999500, Test set accuracy = 0.928100
 epoch 25/30. Took 0.32296 seconds. 
  Full-batch training loss = 0.012296, test loss = 0.296080
  Training set accuracy = 0.998000, Test set accuracy = 0.924700
 epoch 26/30. Took 0.38253 seconds. 
  Full-batch training loss = 0.006663, test loss = 0.282179
  Training set accuracy = 0.999500, Test set accuracy = 0.929200
 epoch 27/30. Took 0.31948 seconds. 
  Full-batch training loss = 0.011744, test loss = 0.304246
  Training set accuracy = 0.997000, Test set accuracy = 0.923500
 epoch 28/30. Took 0.31947 seconds. 
  Full-batch training loss = 0.005865, test loss = 0.296992
  Training set accuracy = 1.000000, Test set accuracy = 0.928200
 epoch 29/30. Took 0.35186 seconds. 
  Full-batch training loss = 0.005026, test loss = 0.298824
  Training set accuracy = 0.999000, Test set accuracy = 0.928200
 epoch 30/30. Took 0.38227 seconds. 
  Full-batch training loss = 0.009586, test loss = 0.309468
  Training set accuracy = 0.998000, Test set accuracy = 0.922900
Elapsed time is 32.576033 seconds.
End Training
-----
Params 2000 0.100 0.50 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.044456 seconds. 
  Full-batch training loss = 1.327682, test loss = 1.325135
  Training set accuracy = 0.760500, Test set accuracy = 0.757400
 epoch 2/30. Took 0.040588 seconds. 
  Full-batch training loss = 0.693769, test loss = 0.701569
  Training set accuracy = 0.843000, Test set accuracy = 0.831200
 epoch 3/30. Took 0.044588 seconds. 
  Full-batch training loss = 0.513097, test loss = 0.542792
  Training set accuracy = 0.875500, Test set accuracy = 0.861800
 epoch 4/30. Took 0.04424 seconds. 
  Full-batch training loss = 0.442162, test loss = 0.493220
  Training set accuracy = 0.882500, Test set accuracy = 0.855300
 epoch 5/30. Took 0.040206 seconds. 
  Full-batch training loss = 0.371940, test loss = 0.432305
  Training set accuracy = 0.910500, Test set accuracy = 0.880200
 epoch 6/30. Took 0.038474 seconds. 
  Full-batch training loss = 0.325124, test loss = 0.408940
  Training set accuracy = 0.921500, Test set accuracy = 0.881600
 epoch 7/30. Took 0.040434 seconds. 
  Full-batch training loss = 0.286040, test loss = 0.374050
  Training set accuracy = 0.933500, Test set accuracy = 0.894100
 epoch 8/30. Took 0.04438 seconds. 
  Full-batch training loss = 0.261535, test loss = 0.359107
  Training set accuracy = 0.942500, Test set accuracy = 0.897600
 epoch 9/30. Took 0.044247 seconds. 
  Full-batch training loss = 0.236619, test loss = 0.350353
  Training set accuracy = 0.944000, Test set accuracy = 0.896400
 epoch 10/30. Took 0.043448 seconds. 
  Full-batch training loss = 0.232598, test loss = 0.345980
  Training set accuracy = 0.947500, Test set accuracy = 0.900000
 epoch 11/30. Took 0.043718 seconds. 
  Full-batch training loss = 0.208334, test loss = 0.337731
  Training set accuracy = 0.953000, Test set accuracy = 0.899100
 epoch 12/30. Took 0.038457 seconds. 
  Full-batch training loss = 0.193911, test loss = 0.334769
  Training set accuracy = 0.959500, Test set accuracy = 0.899900
 epoch 13/30. Took 0.038741 seconds. 
  Full-batch training loss = 0.180426, test loss = 0.322702
  Training set accuracy = 0.961500, Test set accuracy = 0.904800
 epoch 14/30. Took 0.042846 seconds. 
  Full-batch training loss = 0.168070, test loss = 0.317151
  Training set accuracy = 0.963500, Test set accuracy = 0.906400
 epoch 15/30. Took 0.041598 seconds. 
  Full-batch training loss = 0.154363, test loss = 0.321049
  Training set accuracy = 0.964000, Test set accuracy = 0.904300
 epoch 16/30. Took 0.044155 seconds. 
  Full-batch training loss = 0.145320, test loss = 0.315865
  Training set accuracy = 0.969000, Test set accuracy = 0.905200
 epoch 17/30. Took 0.039755 seconds. 
  Full-batch training loss = 0.135408, test loss = 0.305278
  Training set accuracy = 0.973500, Test set accuracy = 0.909600
 epoch 18/30. Took 0.040039 seconds. 
  Full-batch training loss = 0.124482, test loss = 0.301703
  Training set accuracy = 0.975500, Test set accuracy = 0.910600
 epoch 19/30. Took 0.039601 seconds. 
  Full-batch training loss = 0.118828, test loss = 0.306125
  Training set accuracy = 0.978000, Test set accuracy = 0.909100
 epoch 20/30. Took 0.039857 seconds. 
  Full-batch training loss = 0.109262, test loss = 0.299933
  Training set accuracy = 0.980000, Test set accuracy = 0.911200
 epoch 21/30. Took 0.044502 seconds. 
  Full-batch training loss = 0.105334, test loss = 0.302688
  Training set accuracy = 0.981500, Test set accuracy = 0.909400
 epoch 22/30. Took 0.044282 seconds. 
  Full-batch training loss = 0.096975, test loss = 0.293817
  Training set accuracy = 0.981500, Test set accuracy = 0.913900
 epoch 23/30. Took 0.04349 seconds. 
  Full-batch training loss = 0.091836, test loss = 0.288896
  Training set accuracy = 0.983500, Test set accuracy = 0.914800
 epoch 24/30. Took 0.043434 seconds. 
  Full-batch training loss = 0.088362, test loss = 0.290992
  Training set accuracy = 0.986500, Test set accuracy = 0.915300
 epoch 25/30. Took 0.043522 seconds. 
  Full-batch training loss = 0.083510, test loss = 0.291185
  Training set accuracy = 0.984000, Test set accuracy = 0.914100
 epoch 26/30. Took 0.043703 seconds. 
  Full-batch training loss = 0.077886, test loss = 0.295007
  Training set accuracy = 0.985500, Test set accuracy = 0.913400
 epoch 27/30. Took 0.039211 seconds. 
  Full-batch training loss = 0.073655, test loss = 0.292640
  Training set accuracy = 0.987000, Test set accuracy = 0.915700
 epoch 28/30. Took 0.044947 seconds. 
  Full-batch training loss = 0.069616, test loss = 0.294831
  Training set accuracy = 0.988500, Test set accuracy = 0.915500
 epoch 29/30. Took 0.040353 seconds. 
  Full-batch training loss = 0.064910, test loss = 0.290435
  Training set accuracy = 0.988000, Test set accuracy = 0.913200
 epoch 30/30. Took 0.044273 seconds. 
  Full-batch training loss = 0.061011, test loss = 0.287170
  Training set accuracy = 0.992500, Test set accuracy = 0.914400
Elapsed time is 5.313449 seconds.
End Training
-----
Params 2000 0.100 0.50 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.068236 seconds. 
  Full-batch training loss = 1.210711, test loss = 1.209759
  Training set accuracy = 0.757000, Test set accuracy = 0.742200
 epoch 2/30. Took 0.06548 seconds. 
  Full-batch training loss = 0.615723, test loss = 0.631692
  Training set accuracy = 0.849000, Test set accuracy = 0.840800
 epoch 3/30. Took 0.072972 seconds. 
  Full-batch training loss = 0.467476, test loss = 0.494500
  Training set accuracy = 0.888500, Test set accuracy = 0.874000
 epoch 4/30. Took 0.072076 seconds. 
  Full-batch training loss = 0.387313, test loss = 0.428321
  Training set accuracy = 0.909000, Test set accuracy = 0.887800
 epoch 5/30. Took 0.072932 seconds. 
  Full-batch training loss = 0.343432, test loss = 0.395207
  Training set accuracy = 0.914500, Test set accuracy = 0.891000
 epoch 6/30. Took 0.072526 seconds. 
  Full-batch training loss = 0.304866, test loss = 0.369609
  Training set accuracy = 0.923000, Test set accuracy = 0.896600
 epoch 7/30. Took 0.069867 seconds. 
  Full-batch training loss = 0.288119, test loss = 0.368261
  Training set accuracy = 0.917500, Test set accuracy = 0.893200
 epoch 8/30. Took 0.064796 seconds. 
  Full-batch training loss = 0.252032, test loss = 0.339230
  Training set accuracy = 0.941000, Test set accuracy = 0.905800
 epoch 9/30. Took 0.064583 seconds. 
  Full-batch training loss = 0.232712, test loss = 0.328657
  Training set accuracy = 0.940000, Test set accuracy = 0.904700
 epoch 10/30. Took 0.064426 seconds. 
  Full-batch training loss = 0.213199, test loss = 0.317989
  Training set accuracy = 0.948500, Test set accuracy = 0.908000
 epoch 11/30. Took 0.064879 seconds. 
  Full-batch training loss = 0.194275, test loss = 0.310464
  Training set accuracy = 0.953000, Test set accuracy = 0.909100
 epoch 12/30. Took 0.070478 seconds. 
  Full-batch training loss = 0.180884, test loss = 0.302203
  Training set accuracy = 0.955000, Test set accuracy = 0.911500
 epoch 13/30. Took 0.06849 seconds. 
  Full-batch training loss = 0.165611, test loss = 0.294845
  Training set accuracy = 0.961000, Test set accuracy = 0.914500
 epoch 14/30. Took 0.064146 seconds. 
  Full-batch training loss = 0.148336, test loss = 0.284353
  Training set accuracy = 0.968000, Test set accuracy = 0.916700
 epoch 15/30. Took 0.063725 seconds. 
  Full-batch training loss = 0.138925, test loss = 0.282148
  Training set accuracy = 0.969000, Test set accuracy = 0.918300
 epoch 16/30. Took 0.064566 seconds. 
  Full-batch training loss = 0.129006, test loss = 0.277874
  Training set accuracy = 0.971500, Test set accuracy = 0.917700
 epoch 17/30. Took 0.072288 seconds. 
  Full-batch training loss = 0.123483, test loss = 0.278659
  Training set accuracy = 0.969000, Test set accuracy = 0.916100
 epoch 18/30. Took 0.07549 seconds. 
  Full-batch training loss = 0.113432, test loss = 0.274759
  Training set accuracy = 0.976000, Test set accuracy = 0.918900
 epoch 19/30. Took 0.073378 seconds. 
  Full-batch training loss = 0.104732, test loss = 0.270094
  Training set accuracy = 0.979500, Test set accuracy = 0.920600
 epoch 20/30. Took 0.06999 seconds. 
  Full-batch training loss = 0.099513, test loss = 0.269154
  Training set accuracy = 0.980000, Test set accuracy = 0.919400
 epoch 21/30. Took 0.072013 seconds. 
  Full-batch training loss = 0.089575, test loss = 0.265661
  Training set accuracy = 0.982500, Test set accuracy = 0.921900
 epoch 22/30. Took 0.062596 seconds. 
  Full-batch training loss = 0.089447, test loss = 0.271536
  Training set accuracy = 0.978000, Test set accuracy = 0.919400
 epoch 23/30. Took 0.073795 seconds. 
  Full-batch training loss = 0.078831, test loss = 0.264188
  Training set accuracy = 0.984500, Test set accuracy = 0.922000
 epoch 24/30. Took 0.063843 seconds. 
  Full-batch training loss = 0.073056, test loss = 0.261393
  Training set accuracy = 0.988500, Test set accuracy = 0.923100
 epoch 25/30. Took 0.063476 seconds. 
  Full-batch training loss = 0.069247, test loss = 0.261044
  Training set accuracy = 0.987500, Test set accuracy = 0.922600
 epoch 26/30. Took 0.071355 seconds. 
  Full-batch training loss = 0.066415, test loss = 0.260112
  Training set accuracy = 0.988500, Test set accuracy = 0.924900
 epoch 27/30. Took 0.074186 seconds. 
  Full-batch training loss = 0.061420, test loss = 0.260172
  Training set accuracy = 0.990500, Test set accuracy = 0.924300
 epoch 28/30. Took 0.07002 seconds. 
  Full-batch training loss = 0.059761, test loss = 0.263206
  Training set accuracy = 0.991000, Test set accuracy = 0.922800
 epoch 29/30. Took 0.06969 seconds. 
  Full-batch training loss = 0.052944, test loss = 0.257875
  Training set accuracy = 0.993000, Test set accuracy = 0.923400
 epoch 30/30. Took 0.063772 seconds. 
  Full-batch training loss = 0.049331, test loss = 0.255665
  Training set accuracy = 0.993000, Test set accuracy = 0.925400
Elapsed time is 7.562337 seconds.
End Training
-----
Params 2000 0.100 0.50 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14477 seconds. 
  Full-batch training loss = 1.038053, test loss = 1.038576
  Training set accuracy = 0.795000, Test set accuracy = 0.789400
 epoch 2/30. Took 0.14971 seconds. 
  Full-batch training loss = 0.538126, test loss = 0.568342
  Training set accuracy = 0.874000, Test set accuracy = 0.851000
 epoch 3/30. Took 0.15943 seconds. 
  Full-batch training loss = 0.398643, test loss = 0.449504
  Training set accuracy = 0.902500, Test set accuracy = 0.880000
 epoch 4/30. Took 0.16516 seconds. 
  Full-batch training loss = 0.333713, test loss = 0.397655
  Training set accuracy = 0.915500, Test set accuracy = 0.891400
 epoch 5/30. Took 0.16303 seconds. 
  Full-batch training loss = 0.296126, test loss = 0.384880
  Training set accuracy = 0.918000, Test set accuracy = 0.889000
 epoch 6/30. Took 0.14792 seconds. 
  Full-batch training loss = 0.262082, test loss = 0.362729
  Training set accuracy = 0.933000, Test set accuracy = 0.896900
 epoch 7/30. Took 0.15851 seconds. 
  Full-batch training loss = 0.237609, test loss = 0.354363
  Training set accuracy = 0.937000, Test set accuracy = 0.895800
 epoch 8/30. Took 0.15258 seconds. 
  Full-batch training loss = 0.216997, test loss = 0.333802
  Training set accuracy = 0.945500, Test set accuracy = 0.903100
 epoch 9/30. Took 0.14078 seconds. 
  Full-batch training loss = 0.198343, test loss = 0.328949
  Training set accuracy = 0.947000, Test set accuracy = 0.903400
 epoch 10/30. Took 0.14015 seconds. 
  Full-batch training loss = 0.181549, test loss = 0.319281
  Training set accuracy = 0.955500, Test set accuracy = 0.905200
 epoch 11/30. Took 0.14009 seconds. 
  Full-batch training loss = 0.166114, test loss = 0.324704
  Training set accuracy = 0.961500, Test set accuracy = 0.904500
 epoch 12/30. Took 0.14802 seconds. 
  Full-batch training loss = 0.150528, test loss = 0.315128
  Training set accuracy = 0.965000, Test set accuracy = 0.907000
 epoch 13/30. Took 0.13975 seconds. 
  Full-batch training loss = 0.142521, test loss = 0.323746
  Training set accuracy = 0.968000, Test set accuracy = 0.902900
 epoch 14/30. Took 0.16128 seconds. 
  Full-batch training loss = 0.124183, test loss = 0.308599
  Training set accuracy = 0.973000, Test set accuracy = 0.908600
 epoch 15/30. Took 0.15235 seconds. 
  Full-batch training loss = 0.117182, test loss = 0.301078
  Training set accuracy = 0.973500, Test set accuracy = 0.909100
 epoch 16/30. Took 0.13794 seconds. 
  Full-batch training loss = 0.107537, test loss = 0.309837
  Training set accuracy = 0.977500, Test set accuracy = 0.907400
 epoch 17/30. Took 0.16141 seconds. 
  Full-batch training loss = 0.101894, test loss = 0.296872
  Training set accuracy = 0.976000, Test set accuracy = 0.912900
 epoch 18/30. Took 0.15173 seconds. 
  Full-batch training loss = 0.098503, test loss = 0.310759
  Training set accuracy = 0.981000, Test set accuracy = 0.906700
 epoch 19/30. Took 0.1445 seconds. 
  Full-batch training loss = 0.085697, test loss = 0.298328
  Training set accuracy = 0.984500, Test set accuracy = 0.911000
 epoch 20/30. Took 0.16017 seconds. 
  Full-batch training loss = 0.076380, test loss = 0.294322
  Training set accuracy = 0.989000, Test set accuracy = 0.912600
 epoch 21/30. Took 0.14736 seconds. 
  Full-batch training loss = 0.075475, test loss = 0.298787
  Training set accuracy = 0.988000, Test set accuracy = 0.911100
 epoch 22/30. Took 0.14126 seconds. 
  Full-batch training loss = 0.069438, test loss = 0.294452
  Training set accuracy = 0.989000, Test set accuracy = 0.912600
 epoch 23/30. Took 0.14021 seconds. 
  Full-batch training loss = 0.063277, test loss = 0.291762
  Training set accuracy = 0.993000, Test set accuracy = 0.913800
 epoch 24/30. Took 0.14948 seconds. 
  Full-batch training loss = 0.062123, test loss = 0.296470
  Training set accuracy = 0.988500, Test set accuracy = 0.912700
 epoch 25/30. Took 0.13853 seconds. 
  Full-batch training loss = 0.055615, test loss = 0.295808
  Training set accuracy = 0.992500, Test set accuracy = 0.913000
 epoch 26/30. Took 0.14685 seconds. 
  Full-batch training loss = 0.051236, test loss = 0.287732
  Training set accuracy = 0.996000, Test set accuracy = 0.915000
 epoch 27/30. Took 0.15258 seconds. 
  Full-batch training loss = 0.048494, test loss = 0.289566
  Training set accuracy = 0.996000, Test set accuracy = 0.916100
 epoch 28/30. Took 0.15314 seconds. 
  Full-batch training loss = 0.043794, test loss = 0.286904
  Training set accuracy = 0.996500, Test set accuracy = 0.917100
 epoch 29/30. Took 0.15528 seconds. 
  Full-batch training loss = 0.041003, test loss = 0.289049
  Training set accuracy = 0.997000, Test set accuracy = 0.916300
 epoch 30/30. Took 0.13856 seconds. 
  Full-batch training loss = 0.038678, test loss = 0.290194
  Training set accuracy = 0.996500, Test set accuracy = 0.916400
Elapsed time is 14.765444 seconds.
End Training
-----
Params 2000 0.100 0.50 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.055655 seconds. 
  Full-batch training loss = 2.165013, test loss = 2.176383
  Training set accuracy = 0.451500, Test set accuracy = 0.424200
 epoch 2/30. Took 0.051872 seconds. 
  Full-batch training loss = 1.582027, test loss = 1.611676
  Training set accuracy = 0.560000, Test set accuracy = 0.534400
 epoch 3/30. Took 0.056295 seconds. 
  Full-batch training loss = 0.980133, test loss = 1.019661
  Training set accuracy = 0.681500, Test set accuracy = 0.666500
 epoch 4/30. Took 0.050611 seconds. 
  Full-batch training loss = 0.743443, test loss = 0.782438
  Training set accuracy = 0.811000, Test set accuracy = 0.782400
 epoch 5/30. Took 0.051108 seconds. 
  Full-batch training loss = 0.596231, test loss = 0.641212
  Training set accuracy = 0.844000, Test set accuracy = 0.826000
 epoch 6/30. Took 0.05708 seconds. 
  Full-batch training loss = 0.503293, test loss = 0.554017
  Training set accuracy = 0.863000, Test set accuracy = 0.846400
 epoch 7/30. Took 0.051578 seconds. 
  Full-batch training loss = 0.451564, test loss = 0.518964
  Training set accuracy = 0.877000, Test set accuracy = 0.856800
 epoch 8/30. Took 0.04699 seconds. 
  Full-batch training loss = 0.400213, test loss = 0.470196
  Training set accuracy = 0.893500, Test set accuracy = 0.872800
 epoch 9/30. Took 0.049729 seconds. 
  Full-batch training loss = 0.354390, test loss = 0.438018
  Training set accuracy = 0.903000, Test set accuracy = 0.878200
 epoch 10/30. Took 0.057353 seconds. 
  Full-batch training loss = 0.325407, test loss = 0.413145
  Training set accuracy = 0.912000, Test set accuracy = 0.885600
 epoch 11/30. Took 0.056071 seconds. 
  Full-batch training loss = 0.281287, test loss = 0.382136
  Training set accuracy = 0.918000, Test set accuracy = 0.892600
 epoch 12/30. Took 0.057182 seconds. 
  Full-batch training loss = 0.257179, test loss = 0.365140
  Training set accuracy = 0.928000, Test set accuracy = 0.898200
 epoch 13/30. Took 0.054802 seconds. 
  Full-batch training loss = 0.241430, test loss = 0.351860
  Training set accuracy = 0.931000, Test set accuracy = 0.897400
 epoch 14/30. Took 0.05585 seconds. 
  Full-batch training loss = 0.230192, test loss = 0.350544
  Training set accuracy = 0.934000, Test set accuracy = 0.900800
 epoch 15/30. Took 0.051449 seconds. 
  Full-batch training loss = 0.212660, test loss = 0.347900
  Training set accuracy = 0.945000, Test set accuracy = 0.899100
 epoch 16/30. Took 0.056103 seconds. 
  Full-batch training loss = 0.192193, test loss = 0.336278
  Training set accuracy = 0.945000, Test set accuracy = 0.902900
 epoch 17/30. Took 0.057497 seconds. 
  Full-batch training loss = 0.174202, test loss = 0.324430
  Training set accuracy = 0.955000, Test set accuracy = 0.904700
 epoch 18/30. Took 0.055592 seconds. 
  Full-batch training loss = 0.166335, test loss = 0.323407
  Training set accuracy = 0.955000, Test set accuracy = 0.906500
 epoch 19/30. Took 0.055374 seconds. 
  Full-batch training loss = 0.153381, test loss = 0.320645
  Training set accuracy = 0.958500, Test set accuracy = 0.906000
 epoch 20/30. Took 0.055456 seconds. 
  Full-batch training loss = 0.141770, test loss = 0.318354
  Training set accuracy = 0.958000, Test set accuracy = 0.908000
 epoch 21/30. Took 0.050451 seconds. 
  Full-batch training loss = 0.129338, test loss = 0.312271
  Training set accuracy = 0.965000, Test set accuracy = 0.911300
 epoch 22/30. Took 0.055839 seconds. 
  Full-batch training loss = 0.117440, test loss = 0.316015
  Training set accuracy = 0.969000, Test set accuracy = 0.907900
 epoch 23/30. Took 0.055557 seconds. 
  Full-batch training loss = 0.110879, test loss = 0.311800
  Training set accuracy = 0.970000, Test set accuracy = 0.909900
 epoch 24/30. Took 0.054404 seconds. 
  Full-batch training loss = 0.109280, test loss = 0.315713
  Training set accuracy = 0.973500, Test set accuracy = 0.907900
 epoch 25/30. Took 0.055358 seconds. 
  Full-batch training loss = 0.088973, test loss = 0.312649
  Training set accuracy = 0.976500, Test set accuracy = 0.910900
 epoch 26/30. Took 0.056159 seconds. 
  Full-batch training loss = 0.097035, test loss = 0.320439
  Training set accuracy = 0.974000, Test set accuracy = 0.906600
 epoch 27/30. Took 0.050676 seconds. 
  Full-batch training loss = 0.082497, test loss = 0.302166
  Training set accuracy = 0.982500, Test set accuracy = 0.910600
 epoch 28/30. Took 0.051167 seconds. 
  Full-batch training loss = 0.077694, test loss = 0.306206
  Training set accuracy = 0.983500, Test set accuracy = 0.911300
 epoch 29/30. Took 0.051579 seconds. 
  Full-batch training loss = 0.070667, test loss = 0.304567
  Training set accuracy = 0.983500, Test set accuracy = 0.913200
 epoch 30/30. Took 0.053922 seconds. 
  Full-batch training loss = 0.074226, test loss = 0.323715
  Training set accuracy = 0.982500, Test set accuracy = 0.909800
Elapsed time is 5.868547 seconds.
End Training
-----
Params 2000 0.100 0.50 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.097076 seconds. 
  Full-batch training loss = 2.113041, test loss = 2.114195
  Training set accuracy = 0.574500, Test set accuracy = 0.555100
 epoch 2/30. Took 0.097411 seconds. 
  Full-batch training loss = 1.343914, test loss = 1.352090
  Training set accuracy = 0.745000, Test set accuracy = 0.728300
 epoch 3/30. Took 0.090503 seconds. 
  Full-batch training loss = 0.764455, test loss = 0.785290
  Training set accuracy = 0.805000, Test set accuracy = 0.789000
 epoch 4/30. Took 0.085085 seconds. 
  Full-batch training loss = 0.578655, test loss = 0.630068
  Training set accuracy = 0.844500, Test set accuracy = 0.823500
 epoch 5/30. Took 0.094801 seconds. 
  Full-batch training loss = 0.494982, test loss = 0.554798
  Training set accuracy = 0.864500, Test set accuracy = 0.837300
 epoch 6/30. Took 0.099885 seconds. 
  Full-batch training loss = 0.413312, test loss = 0.481960
  Training set accuracy = 0.890000, Test set accuracy = 0.861900
 epoch 7/30. Took 0.1019 seconds. 
  Full-batch training loss = 0.349502, test loss = 0.422522
  Training set accuracy = 0.904000, Test set accuracy = 0.875200
 epoch 8/30. Took 0.094644 seconds. 
  Full-batch training loss = 0.305691, test loss = 0.388476
  Training set accuracy = 0.909500, Test set accuracy = 0.883000
 epoch 9/30. Took 0.086741 seconds. 
  Full-batch training loss = 0.295079, test loss = 0.382655
  Training set accuracy = 0.917000, Test set accuracy = 0.882700
 epoch 10/30. Took 0.088966 seconds. 
  Full-batch training loss = 0.255649, test loss = 0.370396
  Training set accuracy = 0.928000, Test set accuracy = 0.889700
 epoch 11/30. Took 0.088959 seconds. 
  Full-batch training loss = 0.243165, test loss = 0.364513
  Training set accuracy = 0.935000, Test set accuracy = 0.888100
 epoch 12/30. Took 0.089481 seconds. 
  Full-batch training loss = 0.226651, test loss = 0.346309
  Training set accuracy = 0.937000, Test set accuracy = 0.891500
 epoch 13/30. Took 0.08641 seconds. 
  Full-batch training loss = 0.196168, test loss = 0.331764
  Training set accuracy = 0.947000, Test set accuracy = 0.898700
 epoch 14/30. Took 0.090054 seconds. 
  Full-batch training loss = 0.173864, test loss = 0.326477
  Training set accuracy = 0.955500, Test set accuracy = 0.901300
 epoch 15/30. Took 0.10038 seconds. 
  Full-batch training loss = 0.159263, test loss = 0.314216
  Training set accuracy = 0.960000, Test set accuracy = 0.905900
 epoch 16/30. Took 0.097515 seconds. 
  Full-batch training loss = 0.149189, test loss = 0.321449
  Training set accuracy = 0.963000, Test set accuracy = 0.901800
 epoch 17/30. Took 0.083458 seconds. 
  Full-batch training loss = 0.150309, test loss = 0.322849
  Training set accuracy = 0.959500, Test set accuracy = 0.904600
 epoch 18/30. Took 0.099243 seconds. 
  Full-batch training loss = 0.127288, test loss = 0.304707
  Training set accuracy = 0.968500, Test set accuracy = 0.909000
 epoch 19/30. Took 0.099665 seconds. 
  Full-batch training loss = 0.127256, test loss = 0.319663
  Training set accuracy = 0.967500, Test set accuracy = 0.903600
 epoch 20/30. Took 0.10158 seconds. 
  Full-batch training loss = 0.100120, test loss = 0.304083
  Training set accuracy = 0.975000, Test set accuracy = 0.909400
 epoch 21/30. Took 0.10171 seconds. 
  Full-batch training loss = 0.090712, test loss = 0.290866
  Training set accuracy = 0.978000, Test set accuracy = 0.911500
 epoch 22/30. Took 0.10052 seconds. 
  Full-batch training loss = 0.082926, test loss = 0.292296
  Training set accuracy = 0.982500, Test set accuracy = 0.911400
 epoch 23/30. Took 0.089645 seconds. 
  Full-batch training loss = 0.080123, test loss = 0.308231
  Training set accuracy = 0.980000, Test set accuracy = 0.908200
 epoch 24/30. Took 0.088782 seconds. 
  Full-batch training loss = 0.076013, test loss = 0.302167
  Training set accuracy = 0.981000, Test set accuracy = 0.910200
 epoch 25/30. Took 0.10036 seconds. 
  Full-batch training loss = 0.068291, test loss = 0.290852
  Training set accuracy = 0.983500, Test set accuracy = 0.913400
 epoch 26/30. Took 0.086005 seconds. 
  Full-batch training loss = 0.062077, test loss = 0.303858
  Training set accuracy = 0.985500, Test set accuracy = 0.911500
 epoch 27/30. Took 0.089012 seconds. 
  Full-batch training loss = 0.053924, test loss = 0.290008
  Training set accuracy = 0.987500, Test set accuracy = 0.915300
 epoch 28/30. Took 0.098927 seconds. 
  Full-batch training loss = 0.049849, test loss = 0.300346
  Training set accuracy = 0.990500, Test set accuracy = 0.912100
 epoch 29/30. Took 0.098641 seconds. 
  Full-batch training loss = 0.045115, test loss = 0.293240
  Training set accuracy = 0.991500, Test set accuracy = 0.914000
 epoch 30/30. Took 0.088149 seconds. 
  Full-batch training loss = 0.041467, test loss = 0.289831
  Training set accuracy = 0.992000, Test set accuracy = 0.914500
Elapsed time is 9.543825 seconds.
End Training
-----
Params 2000 0.100 0.50 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.24502 seconds. 
  Full-batch training loss = 2.071957, test loss = 2.079862
  Training set accuracy = 0.593500, Test set accuracy = 0.565900
 epoch 2/30. Took 0.23206 seconds. 
  Full-batch training loss = 1.141253, test loss = 1.156821
  Training set accuracy = 0.740500, Test set accuracy = 0.726300
 epoch 3/30. Took 0.23232 seconds. 
  Full-batch training loss = 0.638150, test loss = 0.665202
  Training set accuracy = 0.817500, Test set accuracy = 0.807900
 epoch 4/30. Took 0.25718 seconds. 
  Full-batch training loss = 0.482609, test loss = 0.508227
  Training set accuracy = 0.865500, Test set accuracy = 0.859800
 epoch 5/30. Took 0.28112 seconds. 
  Full-batch training loss = 0.389082, test loss = 0.435401
  Training set accuracy = 0.887000, Test set accuracy = 0.874500
 epoch 6/30. Took 0.23147 seconds. 
  Full-batch training loss = 0.332248, test loss = 0.399591
  Training set accuracy = 0.902000, Test set accuracy = 0.881100
 epoch 7/30. Took 0.24312 seconds. 
  Full-batch training loss = 0.302869, test loss = 0.376968
  Training set accuracy = 0.913500, Test set accuracy = 0.886300
 epoch 8/30. Took 0.25338 seconds. 
  Full-batch training loss = 0.288229, test loss = 0.363665
  Training set accuracy = 0.917000, Test set accuracy = 0.890200
 epoch 9/30. Took 0.25804 seconds. 
  Full-batch training loss = 0.240716, test loss = 0.344604
  Training set accuracy = 0.926000, Test set accuracy = 0.896500
 epoch 10/30. Took 0.27694 seconds. 
  Full-batch training loss = 0.219117, test loss = 0.324996
  Training set accuracy = 0.939500, Test set accuracy = 0.901800
 epoch 11/30. Took 0.23258 seconds. 
  Full-batch training loss = 0.198535, test loss = 0.324634
  Training set accuracy = 0.944000, Test set accuracy = 0.898900
 epoch 12/30. Took 0.24851 seconds. 
  Full-batch training loss = 0.175423, test loss = 0.303420
  Training set accuracy = 0.955500, Test set accuracy = 0.908600
 epoch 13/30. Took 0.24632 seconds. 
  Full-batch training loss = 0.146854, test loss = 0.283581
  Training set accuracy = 0.961500, Test set accuracy = 0.913000
 epoch 14/30. Took 0.25675 seconds. 
  Full-batch training loss = 0.138962, test loss = 0.289831
  Training set accuracy = 0.959000, Test set accuracy = 0.910200
 epoch 15/30. Took 0.23816 seconds. 
  Full-batch training loss = 0.124278, test loss = 0.283365
  Training set accuracy = 0.968000, Test set accuracy = 0.911600
 epoch 16/30. Took 0.23443 seconds. 
  Full-batch training loss = 0.111321, test loss = 0.285872
  Training set accuracy = 0.971000, Test set accuracy = 0.911500
 epoch 17/30. Took 0.23356 seconds. 
  Full-batch training loss = 0.103973, test loss = 0.279699
  Training set accuracy = 0.973500, Test set accuracy = 0.916700
 epoch 18/30. Took 0.2722 seconds. 
  Full-batch training loss = 0.096211, test loss = 0.271551
  Training set accuracy = 0.978500, Test set accuracy = 0.916100
 epoch 19/30. Took 0.25709 seconds. 
  Full-batch training loss = 0.080435, test loss = 0.267495
  Training set accuracy = 0.983000, Test set accuracy = 0.917400
 epoch 20/30. Took 0.2331 seconds. 
  Full-batch training loss = 0.082864, test loss = 0.276424
  Training set accuracy = 0.978500, Test set accuracy = 0.915100
 epoch 21/30. Took 0.23371 seconds. 
  Full-batch training loss = 0.067701, test loss = 0.262285
  Training set accuracy = 0.984500, Test set accuracy = 0.920700
 epoch 22/30. Took 0.244 seconds. 
  Full-batch training loss = 0.058911, test loss = 0.252222
  Training set accuracy = 0.988000, Test set accuracy = 0.923400
 epoch 23/30. Took 0.27799 seconds. 
  Full-batch training loss = 0.053196, test loss = 0.248039
  Training set accuracy = 0.989000, Test set accuracy = 0.924400
 epoch 24/30. Took 0.23705 seconds. 
  Full-batch training loss = 0.047158, test loss = 0.251065
  Training set accuracy = 0.993500, Test set accuracy = 0.923200
 epoch 25/30. Took 0.22952 seconds. 
  Full-batch training loss = 0.042838, test loss = 0.258966
  Training set accuracy = 0.992000, Test set accuracy = 0.923600
 epoch 26/30. Took 0.23768 seconds. 
  Full-batch training loss = 0.038654, test loss = 0.258025
  Training set accuracy = 0.994500, Test set accuracy = 0.923000
 epoch 27/30. Took 0.28132 seconds. 
  Full-batch training loss = 0.033690, test loss = 0.247350
  Training set accuracy = 0.996000, Test set accuracy = 0.925300
 epoch 28/30. Took 0.24426 seconds. 
  Full-batch training loss = 0.028760, test loss = 0.246678
  Training set accuracy = 0.997000, Test set accuracy = 0.926000
 epoch 29/30. Took 0.23214 seconds. 
  Full-batch training loss = 0.030239, test loss = 0.265980
  Training set accuracy = 0.996000, Test set accuracy = 0.923500
 epoch 30/30. Took 0.26113 seconds. 
  Full-batch training loss = 0.025432, test loss = 0.256810
  Training set accuracy = 0.997500, Test set accuracy = 0.925900
Elapsed time is 23.635455 seconds.
End Training
-----
Params 2000 0.100 0.50 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.064624 seconds. 
  Full-batch training loss = 2.288887, test loss = 2.291140
  Training set accuracy = 0.240000, Test set accuracy = 0.229400
 epoch 2/30. Took 0.060789 seconds. 
  Full-batch training loss = 2.258935, test loss = 2.261561
  Training set accuracy = 0.281500, Test set accuracy = 0.265600
 epoch 3/30. Took 0.061147 seconds. 
  Full-batch training loss = 2.170490, test loss = 2.175841
  Training set accuracy = 0.320000, Test set accuracy = 0.312000
 epoch 4/30. Took 0.06143 seconds. 
  Full-batch training loss = 1.856960, test loss = 1.869447
  Training set accuracy = 0.405500, Test set accuracy = 0.391400
 epoch 5/30. Took 0.062261 seconds. 
  Full-batch training loss = 1.414070, test loss = 1.433226
  Training set accuracy = 0.552500, Test set accuracy = 0.536200
 epoch 6/30. Took 0.065276 seconds. 
  Full-batch training loss = 1.133924, test loss = 1.166786
  Training set accuracy = 0.642500, Test set accuracy = 0.626700
 epoch 7/30. Took 0.065617 seconds. 
  Full-batch training loss = 0.936547, test loss = 0.990433
  Training set accuracy = 0.697500, Test set accuracy = 0.669600
 epoch 8/30. Took 0.064002 seconds. 
  Full-batch training loss = 0.804917, test loss = 0.859660
  Training set accuracy = 0.757000, Test set accuracy = 0.746400
 epoch 9/30. Took 0.064395 seconds. 
  Full-batch training loss = 0.702630, test loss = 0.769790
  Training set accuracy = 0.784500, Test set accuracy = 0.770700
 epoch 10/30. Took 0.064804 seconds. 
  Full-batch training loss = 0.648943, test loss = 0.722702
  Training set accuracy = 0.801000, Test set accuracy = 0.779000
 epoch 11/30. Took 0.059243 seconds. 
  Full-batch training loss = 0.588126, test loss = 0.685462
  Training set accuracy = 0.838500, Test set accuracy = 0.814800
 epoch 12/30. Took 0.065402 seconds. 
  Full-batch training loss = 0.529759, test loss = 0.622959
  Training set accuracy = 0.872500, Test set accuracy = 0.840900
 epoch 13/30. Took 0.06594 seconds. 
  Full-batch training loss = 0.456137, test loss = 0.572364
  Training set accuracy = 0.884500, Test set accuracy = 0.852500
 epoch 14/30. Took 0.060349 seconds. 
  Full-batch training loss = 0.417541, test loss = 0.535482
  Training set accuracy = 0.891500, Test set accuracy = 0.857900
 epoch 15/30. Took 0.060008 seconds. 
  Full-batch training loss = 0.382822, test loss = 0.522122
  Training set accuracy = 0.904000, Test set accuracy = 0.862500
 epoch 16/30. Took 0.060697 seconds. 
  Full-batch training loss = 0.355578, test loss = 0.503470
  Training set accuracy = 0.889000, Test set accuracy = 0.847500
 epoch 17/30. Took 0.060255 seconds. 
  Full-batch training loss = 0.297953, test loss = 0.457042
  Training set accuracy = 0.924000, Test set accuracy = 0.879600
 epoch 18/30. Took 0.060351 seconds. 
  Full-batch training loss = 0.278186, test loss = 0.433079
  Training set accuracy = 0.925500, Test set accuracy = 0.879700
 epoch 19/30. Took 0.061381 seconds. 
  Full-batch training loss = 0.249703, test loss = 0.420505
  Training set accuracy = 0.942000, Test set accuracy = 0.891100
 epoch 20/30. Took 0.065987 seconds. 
  Full-batch training loss = 0.224016, test loss = 0.415239
  Training set accuracy = 0.943000, Test set accuracy = 0.889000
 epoch 21/30. Took 0.070462 seconds. 
  Full-batch training loss = 0.209321, test loss = 0.419934
  Training set accuracy = 0.944500, Test set accuracy = 0.887300
 epoch 22/30. Took 0.057453 seconds. 
  Full-batch training loss = 0.184403, test loss = 0.387067
  Training set accuracy = 0.953000, Test set accuracy = 0.896300
 epoch 23/30. Took 0.062148 seconds. 
  Full-batch training loss = 0.172125, test loss = 0.401691
  Training set accuracy = 0.957500, Test set accuracy = 0.894000
 epoch 24/30. Took 0.060259 seconds. 
  Full-batch training loss = 0.172441, test loss = 0.392524
  Training set accuracy = 0.957000, Test set accuracy = 0.891600
 epoch 25/30. Took 0.060561 seconds. 
  Full-batch training loss = 0.149901, test loss = 0.375608
  Training set accuracy = 0.965500, Test set accuracy = 0.900900
 epoch 26/30. Took 0.065829 seconds. 
  Full-batch training loss = 0.139153, test loss = 0.363998
  Training set accuracy = 0.969500, Test set accuracy = 0.902300
 epoch 27/30. Took 0.066588 seconds. 
  Full-batch training loss = 0.131468, test loss = 0.389785
  Training set accuracy = 0.969000, Test set accuracy = 0.897500
 epoch 28/30. Took 0.064474 seconds. 
  Full-batch training loss = 0.129931, test loss = 0.373224
  Training set accuracy = 0.971500, Test set accuracy = 0.901300
 epoch 29/30. Took 0.063996 seconds. 
  Full-batch training loss = 0.128748, test loss = 0.417538
  Training set accuracy = 0.968500, Test set accuracy = 0.893600
 epoch 30/30. Took 0.062138 seconds. 
  Full-batch training loss = 0.111860, test loss = 0.384388
  Training set accuracy = 0.972500, Test set accuracy = 0.901600
Elapsed time is 6.883030 seconds.
End Training
-----
Params 2000 0.100 0.50 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11232 seconds. 
  Full-batch training loss = 2.286546, test loss = 2.288475
  Training set accuracy = 0.123500, Test set accuracy = 0.113500
 epoch 2/30. Took 0.12524 seconds. 
  Full-batch training loss = 2.253600, test loss = 2.256046
  Training set accuracy = 0.211000, Test set accuracy = 0.199700
 epoch 3/30. Took 0.11033 seconds. 
  Full-batch training loss = 2.141811, test loss = 2.143623
  Training set accuracy = 0.398500, Test set accuracy = 0.404400
 epoch 4/30. Took 0.11655 seconds. 
  Full-batch training loss = 1.776747, test loss = 1.777665
  Training set accuracy = 0.514000, Test set accuracy = 0.492000
 epoch 5/30. Took 0.1202 seconds. 
  Full-batch training loss = 1.281377, test loss = 1.293382
  Training set accuracy = 0.650500, Test set accuracy = 0.640200
 epoch 6/30. Took 0.11275 seconds. 
  Full-batch training loss = 0.972264, test loss = 0.996747
  Training set accuracy = 0.731500, Test set accuracy = 0.712500
 epoch 7/30. Took 0.12513 seconds. 
  Full-batch training loss = 0.773323, test loss = 0.818612
  Training set accuracy = 0.763000, Test set accuracy = 0.734000
 epoch 8/30. Took 0.12324 seconds. 
  Full-batch training loss = 0.641588, test loss = 0.700773
  Training set accuracy = 0.794000, Test set accuracy = 0.779100
 epoch 9/30. Took 0.11058 seconds. 
  Full-batch training loss = 0.529044, test loss = 0.611245
  Training set accuracy = 0.846500, Test set accuracy = 0.820000
 epoch 10/30. Took 0.11789 seconds. 
  Full-batch training loss = 0.471304, test loss = 0.570613
  Training set accuracy = 0.858000, Test set accuracy = 0.828100
 epoch 11/30. Took 0.1216 seconds. 
  Full-batch training loss = 0.393100, test loss = 0.496062
  Training set accuracy = 0.896500, Test set accuracy = 0.859600
 epoch 12/30. Took 0.11419 seconds. 
  Full-batch training loss = 0.358947, test loss = 0.475637
  Training set accuracy = 0.907500, Test set accuracy = 0.867700
 epoch 13/30. Took 0.11093 seconds. 
  Full-batch training loss = 0.319675, test loss = 0.448841
  Training set accuracy = 0.905500, Test set accuracy = 0.873400
 epoch 14/30. Took 0.11048 seconds. 
  Full-batch training loss = 0.278478, test loss = 0.420862
  Training set accuracy = 0.927500, Test set accuracy = 0.883000
 epoch 15/30. Took 0.11091 seconds. 
  Full-batch training loss = 0.263159, test loss = 0.415284
  Training set accuracy = 0.925500, Test set accuracy = 0.883600
 epoch 16/30. Took 0.1117 seconds. 
  Full-batch training loss = 0.234057, test loss = 0.402562
  Training set accuracy = 0.938000, Test set accuracy = 0.888300
 epoch 17/30. Took 0.12679 seconds. 
  Full-batch training loss = 0.218321, test loss = 0.399008
  Training set accuracy = 0.940000, Test set accuracy = 0.892700
 epoch 18/30. Took 0.10855 seconds. 
  Full-batch training loss = 0.189482, test loss = 0.370525
  Training set accuracy = 0.949000, Test set accuracy = 0.897300
 epoch 19/30. Took 0.12651 seconds. 
  Full-batch training loss = 0.175303, test loss = 0.373931
  Training set accuracy = 0.953500, Test set accuracy = 0.894900
 epoch 20/30. Took 0.12208 seconds. 
  Full-batch training loss = 0.158631, test loss = 0.357954
  Training set accuracy = 0.958500, Test set accuracy = 0.899300
 epoch 21/30. Took 0.1183 seconds. 
  Full-batch training loss = 0.148847, test loss = 0.363603
  Training set accuracy = 0.960000, Test set accuracy = 0.898600
 epoch 22/30. Took 0.1118 seconds. 
  Full-batch training loss = 0.126958, test loss = 0.353976
  Training set accuracy = 0.964000, Test set accuracy = 0.905400
 epoch 23/30. Took 0.12865 seconds. 
  Full-batch training loss = 0.126730, test loss = 0.351867
  Training set accuracy = 0.962000, Test set accuracy = 0.903000
 epoch 24/30. Took 0.11615 seconds. 
  Full-batch training loss = 0.116417, test loss = 0.355833
  Training set accuracy = 0.970500, Test set accuracy = 0.901900
 epoch 25/30. Took 0.10993 seconds. 
  Full-batch training loss = 0.123908, test loss = 0.396126
  Training set accuracy = 0.964500, Test set accuracy = 0.894700
 epoch 26/30. Took 0.12789 seconds. 
  Full-batch training loss = 0.091641, test loss = 0.335853
  Training set accuracy = 0.975000, Test set accuracy = 0.908800
 epoch 27/30. Took 0.11595 seconds. 
  Full-batch training loss = 0.080127, test loss = 0.353678
  Training set accuracy = 0.976500, Test set accuracy = 0.905600
 epoch 28/30. Took 0.1046 seconds. 
  Full-batch training loss = 0.075884, test loss = 0.334160
  Training set accuracy = 0.978500, Test set accuracy = 0.911300
 epoch 29/30. Took 0.10611 seconds. 
  Full-batch training loss = 0.064170, test loss = 0.345652
  Training set accuracy = 0.983000, Test set accuracy = 0.911700
 epoch 30/30. Took 0.10613 seconds. 
  Full-batch training loss = 0.067629, test loss = 0.359987
  Training set accuracy = 0.982500, Test set accuracy = 0.908400
Elapsed time is 11.706086 seconds.
End Training
-----
Params 2000 0.100 0.50 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.34146 seconds. 
  Full-batch training loss = 2.274474, test loss = 2.277324
  Training set accuracy = 0.279500, Test set accuracy = 0.271500
 epoch 2/30. Took 0.35093 seconds. 
  Full-batch training loss = 2.204768, test loss = 2.207197
  Training set accuracy = 0.388000, Test set accuracy = 0.374200
 epoch 3/30. Took 0.32247 seconds. 
  Full-batch training loss = 1.946462, test loss = 1.947213
  Training set accuracy = 0.527000, Test set accuracy = 0.523200
 epoch 4/30. Took 0.32305 seconds. 
  Full-batch training loss = 1.314743, test loss = 1.315324
  Training set accuracy = 0.656000, Test set accuracy = 0.650400
 epoch 5/30. Took 0.32329 seconds. 
  Full-batch training loss = 0.864450, test loss = 0.872691
  Training set accuracy = 0.703500, Test set accuracy = 0.703600
 epoch 6/30. Took 0.35713 seconds. 
  Full-batch training loss = 0.677466, test loss = 0.685393
  Training set accuracy = 0.776000, Test set accuracy = 0.784800
 epoch 7/30. Took 0.32588 seconds. 
  Full-batch training loss = 0.536911, test loss = 0.574479
  Training set accuracy = 0.839000, Test set accuracy = 0.825000
 epoch 8/30. Took 0.35415 seconds. 
  Full-batch training loss = 0.492382, test loss = 0.539017
  Training set accuracy = 0.841000, Test set accuracy = 0.825100
 epoch 9/30. Took 0.32484 seconds. 
  Full-batch training loss = 0.385029, test loss = 0.452769
  Training set accuracy = 0.888000, Test set accuracy = 0.865600
 epoch 10/30. Took 0.32364 seconds. 
  Full-batch training loss = 0.329959, test loss = 0.421468
  Training set accuracy = 0.898500, Test set accuracy = 0.872300
 epoch 11/30. Took 0.34386 seconds. 
  Full-batch training loss = 0.292344, test loss = 0.388469
  Training set accuracy = 0.919500, Test set accuracy = 0.885100
 epoch 12/30. Took 0.3916 seconds. 
  Full-batch training loss = 0.263946, test loss = 0.360439
  Training set accuracy = 0.920000, Test set accuracy = 0.894700
 epoch 13/30. Took 0.41569 seconds. 
  Full-batch training loss = 0.235396, test loss = 0.371093
  Training set accuracy = 0.931500, Test set accuracy = 0.888900
 epoch 14/30. Took 0.33668 seconds. 
  Full-batch training loss = 0.216888, test loss = 0.369361
  Training set accuracy = 0.928000, Test set accuracy = 0.883500
 epoch 15/30. Took 0.32787 seconds. 
  Full-batch training loss = 0.183822, test loss = 0.341209
  Training set accuracy = 0.946000, Test set accuracy = 0.898400
 epoch 16/30. Took 0.35876 seconds. 
  Full-batch training loss = 0.151277, test loss = 0.323113
  Training set accuracy = 0.956500, Test set accuracy = 0.901000
 epoch 17/30. Took 0.34234 seconds. 
  Full-batch training loss = 0.145295, test loss = 0.337318
  Training set accuracy = 0.957000, Test set accuracy = 0.900400
 epoch 18/30. Took 0.32417 seconds. 
  Full-batch training loss = 0.129654, test loss = 0.318483
  Training set accuracy = 0.963000, Test set accuracy = 0.904700
 epoch 19/30. Took 0.32537 seconds. 
  Full-batch training loss = 0.103548, test loss = 0.299265
  Training set accuracy = 0.973000, Test set accuracy = 0.912800
 epoch 20/30. Took 0.39977 seconds. 
  Full-batch training loss = 0.087028, test loss = 0.307820
  Training set accuracy = 0.979000, Test set accuracy = 0.913100
 epoch 21/30. Took 0.33199 seconds. 
  Full-batch training loss = 0.084006, test loss = 0.302666
  Training set accuracy = 0.980000, Test set accuracy = 0.908500
 epoch 22/30. Took 0.37573 seconds. 
  Full-batch training loss = 0.067922, test loss = 0.301794
  Training set accuracy = 0.983500, Test set accuracy = 0.913700
 epoch 23/30. Took 0.33511 seconds. 
  Full-batch training loss = 0.064671, test loss = 0.314092
  Training set accuracy = 0.984500, Test set accuracy = 0.908500
 epoch 24/30. Took 0.35826 seconds. 
  Full-batch training loss = 0.052644, test loss = 0.278698
  Training set accuracy = 0.990000, Test set accuracy = 0.918000
 epoch 25/30. Took 0.32474 seconds. 
  Full-batch training loss = 0.042050, test loss = 0.298453
  Training set accuracy = 0.993500, Test set accuracy = 0.917200
 epoch 26/30. Took 0.3637 seconds. 
  Full-batch training loss = 0.035706, test loss = 0.285920
  Training set accuracy = 0.995000, Test set accuracy = 0.920300
 epoch 27/30. Took 0.33145 seconds. 
  Full-batch training loss = 0.035537, test loss = 0.309359
  Training set accuracy = 0.991000, Test set accuracy = 0.914700
 epoch 28/30. Took 0.33314 seconds. 
  Full-batch training loss = 0.028376, test loss = 0.304609
  Training set accuracy = 0.996000, Test set accuracy = 0.915800
 epoch 29/30. Took 0.32272 seconds. 
  Full-batch training loss = 0.020333, test loss = 0.299059
  Training set accuracy = 0.997000, Test set accuracy = 0.923000
 epoch 30/30. Took 0.32739 seconds. 
  Full-batch training loss = 0.020817, test loss = 0.308162
  Training set accuracy = 0.995500, Test set accuracy = 0.920100
Elapsed time is 32.502895 seconds.
End Training
-----
Params 2000 0.010 0.00 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.039403 seconds. 
  Full-batch training loss = 1.952134, test loss = 1.963414
  Training set accuracy = 0.602000, Test set accuracy = 0.578300
 epoch 2/30. Took 0.034803 seconds. 
  Full-batch training loss = 1.506690, test loss = 1.527789
  Training set accuracy = 0.725500, Test set accuracy = 0.691900
 epoch 3/30. Took 0.041796 seconds. 
  Full-batch training loss = 1.148689, test loss = 1.175858
  Training set accuracy = 0.787500, Test set accuracy = 0.755500
 epoch 4/30. Took 0.038771 seconds. 
  Full-batch training loss = 0.909115, test loss = 0.941433
  Training set accuracy = 0.820000, Test set accuracy = 0.794000
 epoch 5/30. Took 0.04229 seconds. 
  Full-batch training loss = 0.755906, test loss = 0.795491
  Training set accuracy = 0.844500, Test set accuracy = 0.819100
 epoch 6/30. Took 0.04515 seconds. 
  Full-batch training loss = 0.653637, test loss = 0.693326
  Training set accuracy = 0.863500, Test set accuracy = 0.839100
 epoch 7/30. Took 0.035638 seconds. 
  Full-batch training loss = 0.580002, test loss = 0.628850
  Training set accuracy = 0.868500, Test set accuracy = 0.848700
 epoch 8/30. Took 0.034288 seconds. 
  Full-batch training loss = 0.526280, test loss = 0.576946
  Training set accuracy = 0.879000, Test set accuracy = 0.860700
 epoch 9/30. Took 0.038661 seconds. 
  Full-batch training loss = 0.483193, test loss = 0.540546
  Training set accuracy = 0.885500, Test set accuracy = 0.862800
 epoch 10/30. Took 0.03414 seconds. 
  Full-batch training loss = 0.451210, test loss = 0.514264
  Training set accuracy = 0.893500, Test set accuracy = 0.867400
 epoch 11/30. Took 0.038174 seconds. 
  Full-batch training loss = 0.424713, test loss = 0.489641
  Training set accuracy = 0.891500, Test set accuracy = 0.871600
 epoch 12/30. Took 0.03797 seconds. 
  Full-batch training loss = 0.399623, test loss = 0.468063
  Training set accuracy = 0.901500, Test set accuracy = 0.877500
 epoch 13/30. Took 0.03757 seconds. 
  Full-batch training loss = 0.379682, test loss = 0.452068
  Training set accuracy = 0.903500, Test set accuracy = 0.878500
 epoch 14/30. Took 0.033989 seconds. 
  Full-batch training loss = 0.361340, test loss = 0.440257
  Training set accuracy = 0.910500, Test set accuracy = 0.878800
 epoch 15/30. Took 0.034265 seconds. 
  Full-batch training loss = 0.346607, test loss = 0.426517
  Training set accuracy = 0.913500, Test set accuracy = 0.885800
 epoch 16/30. Took 0.035305 seconds. 
  Full-batch training loss = 0.333786, test loss = 0.416921
  Training set accuracy = 0.918000, Test set accuracy = 0.885800
 epoch 17/30. Took 0.03856 seconds. 
  Full-batch training loss = 0.319379, test loss = 0.409037
  Training set accuracy = 0.921500, Test set accuracy = 0.885900
 epoch 18/30. Took 0.037724 seconds. 
  Full-batch training loss = 0.308368, test loss = 0.400920
  Training set accuracy = 0.923500, Test set accuracy = 0.888900
 epoch 19/30. Took 0.038835 seconds. 
  Full-batch training loss = 0.299720, test loss = 0.399307
  Training set accuracy = 0.924500, Test set accuracy = 0.887000
 epoch 20/30. Took 0.037518 seconds. 
  Full-batch training loss = 0.289106, test loss = 0.390149
  Training set accuracy = 0.929000, Test set accuracy = 0.890700
 epoch 21/30. Took 0.037211 seconds. 
  Full-batch training loss = 0.281996, test loss = 0.386535
  Training set accuracy = 0.932500, Test set accuracy = 0.890600
 epoch 22/30. Took 0.034097 seconds. 
  Full-batch training loss = 0.272741, test loss = 0.379031
  Training set accuracy = 0.933000, Test set accuracy = 0.893000
 epoch 23/30. Took 0.033311 seconds. 
  Full-batch training loss = 0.265164, test loss = 0.375628
  Training set accuracy = 0.936500, Test set accuracy = 0.894300
 epoch 24/30. Took 0.038474 seconds. 
  Full-batch training loss = 0.258427, test loss = 0.374830
  Training set accuracy = 0.938000, Test set accuracy = 0.892600
 epoch 25/30. Took 0.038087 seconds. 
  Full-batch training loss = 0.251545, test loss = 0.370030
  Training set accuracy = 0.939000, Test set accuracy = 0.893300
 epoch 26/30. Took 0.039298 seconds. 
  Full-batch training loss = 0.244943, test loss = 0.368048
  Training set accuracy = 0.943500, Test set accuracy = 0.894000
 epoch 27/30. Took 0.036217 seconds. 
  Full-batch training loss = 0.239385, test loss = 0.361893
  Training set accuracy = 0.946500, Test set accuracy = 0.896200
 epoch 28/30. Took 0.0349 seconds. 
  Full-batch training loss = 0.233871, test loss = 0.360051
  Training set accuracy = 0.946500, Test set accuracy = 0.896100
 epoch 29/30. Took 0.036749 seconds. 
  Full-batch training loss = 0.228073, test loss = 0.359334
  Training set accuracy = 0.946000, Test set accuracy = 0.897400
 epoch 30/30. Took 0.036135 seconds. 
  Full-batch training loss = 0.223207, test loss = 0.356212
  Training set accuracy = 0.949500, Test set accuracy = 0.897500
Elapsed time is 5.164217 seconds.
End Training
-----
Params 2000 0.010 0.00 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.061207 seconds. 
  Full-batch training loss = 1.886920, test loss = 1.891720
  Training set accuracy = 0.654000, Test set accuracy = 0.622400
 epoch 2/30. Took 0.061578 seconds. 
  Full-batch training loss = 1.401168, test loss = 1.416081
  Training set accuracy = 0.761000, Test set accuracy = 0.744300
 epoch 3/30. Took 0.057042 seconds. 
  Full-batch training loss = 1.041440, test loss = 1.061607
  Training set accuracy = 0.803500, Test set accuracy = 0.795500
 epoch 4/30. Took 0.057434 seconds. 
  Full-batch training loss = 0.829666, test loss = 0.853862
  Training set accuracy = 0.835000, Test set accuracy = 0.823800
 epoch 5/30. Took 0.05561 seconds. 
  Full-batch training loss = 0.702104, test loss = 0.733656
  Training set accuracy = 0.844000, Test set accuracy = 0.835300
 epoch 6/30. Took 0.062704 seconds. 
  Full-batch training loss = 0.616879, test loss = 0.648832
  Training set accuracy = 0.868500, Test set accuracy = 0.852000
 epoch 7/30. Took 0.055975 seconds. 
  Full-batch training loss = 0.556395, test loss = 0.592991
  Training set accuracy = 0.872000, Test set accuracy = 0.858800
 epoch 8/30. Took 0.055569 seconds. 
  Full-batch training loss = 0.510925, test loss = 0.552270
  Training set accuracy = 0.877000, Test set accuracy = 0.863500
 epoch 9/30. Took 0.062985 seconds. 
  Full-batch training loss = 0.473438, test loss = 0.519463
  Training set accuracy = 0.885500, Test set accuracy = 0.870200
 epoch 10/30. Took 0.064279 seconds. 
  Full-batch training loss = 0.445902, test loss = 0.494088
  Training set accuracy = 0.885500, Test set accuracy = 0.872900
 epoch 11/30. Took 0.056109 seconds. 
  Full-batch training loss = 0.421692, test loss = 0.473329
  Training set accuracy = 0.891500, Test set accuracy = 0.877300
 epoch 12/30. Took 0.058079 seconds. 
  Full-batch training loss = 0.401978, test loss = 0.458905
  Training set accuracy = 0.897500, Test set accuracy = 0.881500
 epoch 13/30. Took 0.056025 seconds. 
  Full-batch training loss = 0.382853, test loss = 0.443050
  Training set accuracy = 0.902000, Test set accuracy = 0.884100
 epoch 14/30. Took 0.055743 seconds. 
  Full-batch training loss = 0.370291, test loss = 0.434106
  Training set accuracy = 0.903500, Test set accuracy = 0.883100
 epoch 15/30. Took 0.055883 seconds. 
  Full-batch training loss = 0.352904, test loss = 0.420019
  Training set accuracy = 0.909000, Test set accuracy = 0.886000
 epoch 16/30. Took 0.055581 seconds. 
  Full-batch training loss = 0.340849, test loss = 0.413190
  Training set accuracy = 0.912000, Test set accuracy = 0.888900
 epoch 17/30. Took 0.055801 seconds. 
  Full-batch training loss = 0.329745, test loss = 0.404539
  Training set accuracy = 0.915000, Test set accuracy = 0.889400
 epoch 18/30. Took 0.063113 seconds. 
  Full-batch training loss = 0.319018, test loss = 0.397136
  Training set accuracy = 0.917000, Test set accuracy = 0.893500
 epoch 19/30. Took 0.06323 seconds. 
  Full-batch training loss = 0.309597, test loss = 0.389733
  Training set accuracy = 0.920000, Test set accuracy = 0.893100
 epoch 20/30. Took 0.05459 seconds. 
  Full-batch training loss = 0.301614, test loss = 0.387177
  Training set accuracy = 0.923500, Test set accuracy = 0.893200
 epoch 21/30. Took 0.055061 seconds. 
  Full-batch training loss = 0.292892, test loss = 0.380306
  Training set accuracy = 0.920500, Test set accuracy = 0.894400
 epoch 22/30. Took 0.054439 seconds. 
  Full-batch training loss = 0.284181, test loss = 0.377269
  Training set accuracy = 0.926500, Test set accuracy = 0.894900
 epoch 23/30. Took 0.059505 seconds. 
  Full-batch training loss = 0.278065, test loss = 0.372494
  Training set accuracy = 0.925000, Test set accuracy = 0.895700
 epoch 24/30. Took 0.056458 seconds. 
  Full-batch training loss = 0.270161, test loss = 0.370275
  Training set accuracy = 0.930500, Test set accuracy = 0.896900
 epoch 25/30. Took 0.055732 seconds. 
  Full-batch training loss = 0.262718, test loss = 0.364885
  Training set accuracy = 0.932000, Test set accuracy = 0.899800
 epoch 26/30. Took 0.056411 seconds. 
  Full-batch training loss = 0.256454, test loss = 0.362338
  Training set accuracy = 0.936500, Test set accuracy = 0.900100
 epoch 27/30. Took 0.064343 seconds. 
  Full-batch training loss = 0.250574, test loss = 0.359533
  Training set accuracy = 0.936500, Test set accuracy = 0.900200
 epoch 28/30. Took 0.073826 seconds. 
  Full-batch training loss = 0.246306, test loss = 0.358823
  Training set accuracy = 0.941000, Test set accuracy = 0.899500
 epoch 29/30. Took 0.062207 seconds. 
  Full-batch training loss = 0.239669, test loss = 0.354026
  Training set accuracy = 0.942500, Test set accuracy = 0.901600
 epoch 30/30. Took 0.055753 seconds. 
  Full-batch training loss = 0.234271, test loss = 0.353613
  Training set accuracy = 0.942500, Test set accuracy = 0.901300
Elapsed time is 7.112887 seconds.
End Training
-----
Params 2000 0.010 0.00 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.12896 seconds. 
  Full-batch training loss = 1.852140, test loss = 1.846110
  Training set accuracy = 0.661500, Test set accuracy = 0.662400
 epoch 2/30. Took 0.14336 seconds. 
  Full-batch training loss = 1.372286, test loss = 1.362179
  Training set accuracy = 0.737500, Test set accuracy = 0.742800
 epoch 3/30. Took 0.14307 seconds. 
  Full-batch training loss = 1.035459, test loss = 1.025774
  Training set accuracy = 0.811000, Test set accuracy = 0.807300
 epoch 4/30. Took 0.1531 seconds. 
  Full-batch training loss = 0.840105, test loss = 0.831140
  Training set accuracy = 0.830000, Test set accuracy = 0.829000
 epoch 5/30. Took 0.13685 seconds. 
  Full-batch training loss = 0.714582, test loss = 0.710604
  Training set accuracy = 0.835000, Test set accuracy = 0.837400
 epoch 6/30. Took 0.13595 seconds. 
  Full-batch training loss = 0.633878, test loss = 0.634357
  Training set accuracy = 0.853500, Test set accuracy = 0.850100
 epoch 7/30. Took 0.13248 seconds. 
  Full-batch training loss = 0.576677, test loss = 0.582816
  Training set accuracy = 0.867000, Test set accuracy = 0.861500
 epoch 8/30. Took 0.13249 seconds. 
  Full-batch training loss = 0.531951, test loss = 0.541409
  Training set accuracy = 0.875000, Test set accuracy = 0.867700
 epoch 9/30. Took 0.11942 seconds. 
  Full-batch training loss = 0.499371, test loss = 0.511572
  Training set accuracy = 0.883000, Test set accuracy = 0.874300
 epoch 10/30. Took 0.12765 seconds. 
  Full-batch training loss = 0.471469, test loss = 0.488014
  Training set accuracy = 0.885500, Test set accuracy = 0.875100
 epoch 11/30. Took 0.14361 seconds. 
  Full-batch training loss = 0.448411, test loss = 0.473922
  Training set accuracy = 0.888000, Test set accuracy = 0.877900
 epoch 12/30. Took 0.12136 seconds. 
  Full-batch training loss = 0.425525, test loss = 0.457221
  Training set accuracy = 0.895500, Test set accuracy = 0.882000
 epoch 13/30. Took 0.1411 seconds. 
  Full-batch training loss = 0.406958, test loss = 0.438819
  Training set accuracy = 0.896500, Test set accuracy = 0.885100
 epoch 14/30. Took 0.12234 seconds. 
  Full-batch training loss = 0.393132, test loss = 0.432853
  Training set accuracy = 0.900500, Test set accuracy = 0.885100
 epoch 15/30. Took 0.14012 seconds. 
  Full-batch training loss = 0.379439, test loss = 0.419999
  Training set accuracy = 0.904000, Test set accuracy = 0.888000
 epoch 16/30. Took 0.1351 seconds. 
  Full-batch training loss = 0.366170, test loss = 0.406486
  Training set accuracy = 0.910000, Test set accuracy = 0.892000
 epoch 17/30. Took 0.11989 seconds. 
  Full-batch training loss = 0.353064, test loss = 0.400927
  Training set accuracy = 0.912000, Test set accuracy = 0.890800
 epoch 18/30. Took 0.12887 seconds. 
  Full-batch training loss = 0.342799, test loss = 0.397123
  Training set accuracy = 0.916000, Test set accuracy = 0.891400
 epoch 19/30. Took 0.14287 seconds. 
  Full-batch training loss = 0.333123, test loss = 0.390468
  Training set accuracy = 0.914000, Test set accuracy = 0.891600
 epoch 20/30. Took 0.1252 seconds. 
  Full-batch training loss = 0.325459, test loss = 0.388271
  Training set accuracy = 0.921000, Test set accuracy = 0.892000
 epoch 21/30. Took 0.13589 seconds. 
  Full-batch training loss = 0.317052, test loss = 0.380351
  Training set accuracy = 0.922000, Test set accuracy = 0.895100
 epoch 22/30. Took 0.12538 seconds. 
  Full-batch training loss = 0.306868, test loss = 0.374735
  Training set accuracy = 0.925500, Test set accuracy = 0.895300
 epoch 23/30. Took 0.14523 seconds. 
  Full-batch training loss = 0.298603, test loss = 0.368230
  Training set accuracy = 0.928000, Test set accuracy = 0.897100
 epoch 24/30. Took 0.1425 seconds. 
  Full-batch training loss = 0.294596, test loss = 0.367838
  Training set accuracy = 0.927000, Test set accuracy = 0.896400
 epoch 25/30. Took 0.12977 seconds. 
  Full-batch training loss = 0.285869, test loss = 0.366018
  Training set accuracy = 0.930500, Test set accuracy = 0.897600
 epoch 26/30. Took 0.11934 seconds. 
  Full-batch training loss = 0.279351, test loss = 0.364894
  Training set accuracy = 0.930000, Test set accuracy = 0.897900
 epoch 27/30. Took 0.13643 seconds. 
  Full-batch training loss = 0.272685, test loss = 0.359453
  Training set accuracy = 0.934000, Test set accuracy = 0.897800
 epoch 28/30. Took 0.14461 seconds. 
  Full-batch training loss = 0.265913, test loss = 0.353972
  Training set accuracy = 0.934500, Test set accuracy = 0.899600
 epoch 29/30. Took 0.13876 seconds. 
  Full-batch training loss = 0.259669, test loss = 0.353083
  Training set accuracy = 0.938500, Test set accuracy = 0.900500
 epoch 30/30. Took 0.12126 seconds. 
  Full-batch training loss = 0.256867, test loss = 0.353324
  Training set accuracy = 0.938000, Test set accuracy = 0.900800
Elapsed time is 14.095421 seconds.
End Training
-----
Params 2000 0.010 0.00 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.048324 seconds. 
  Full-batch training loss = 2.155865, test loss = 2.159567
  Training set accuracy = 0.309000, Test set accuracy = 0.300500
 epoch 2/30. Took 0.039957 seconds. 
  Full-batch training loss = 1.900033, test loss = 1.906119
  Training set accuracy = 0.615000, Test set accuracy = 0.613300
 epoch 3/30. Took 0.042066 seconds. 
  Full-batch training loss = 1.511525, test loss = 1.516810
  Training set accuracy = 0.721000, Test set accuracy = 0.704100
 epoch 4/30. Took 0.040771 seconds. 
  Full-batch training loss = 1.110190, test loss = 1.106281
  Training set accuracy = 0.789500, Test set accuracy = 0.784800
 epoch 5/30. Took 0.044746 seconds. 
  Full-batch training loss = 0.834402, test loss = 0.824508
  Training set accuracy = 0.822500, Test set accuracy = 0.810800
 epoch 6/30. Took 0.045115 seconds. 
  Full-batch training loss = 0.678755, test loss = 0.668967
  Training set accuracy = 0.833000, Test set accuracy = 0.834900
 epoch 7/30. Took 0.041466 seconds. 
  Full-batch training loss = 0.584700, test loss = 0.583257
  Training set accuracy = 0.865500, Test set accuracy = 0.851800
 epoch 8/30. Took 0.039724 seconds. 
  Full-batch training loss = 0.525679, test loss = 0.532445
  Training set accuracy = 0.872500, Test set accuracy = 0.855900
 epoch 9/30. Took 0.040806 seconds. 
  Full-batch training loss = 0.484573, test loss = 0.494102
  Training set accuracy = 0.881000, Test set accuracy = 0.864600
 epoch 10/30. Took 0.044436 seconds. 
  Full-batch training loss = 0.443444, test loss = 0.461903
  Training set accuracy = 0.895500, Test set accuracy = 0.871700
 epoch 11/30. Took 0.03988 seconds. 
  Full-batch training loss = 0.417940, test loss = 0.441051
  Training set accuracy = 0.896000, Test set accuracy = 0.874800
 epoch 12/30. Took 0.04728 seconds. 
  Full-batch training loss = 0.391989, test loss = 0.423581
  Training set accuracy = 0.902000, Test set accuracy = 0.878200
 epoch 13/30. Took 0.047097 seconds. 
  Full-batch training loss = 0.375378, test loss = 0.411527
  Training set accuracy = 0.907000, Test set accuracy = 0.881700
 epoch 14/30. Took 0.044639 seconds. 
  Full-batch training loss = 0.358891, test loss = 0.405340
  Training set accuracy = 0.904000, Test set accuracy = 0.879500
 epoch 15/30. Took 0.045484 seconds. 
  Full-batch training loss = 0.342363, test loss = 0.390909
  Training set accuracy = 0.913000, Test set accuracy = 0.885600
 epoch 16/30. Took 0.040661 seconds. 
  Full-batch training loss = 0.325835, test loss = 0.383935
  Training set accuracy = 0.914500, Test set accuracy = 0.887700
 epoch 17/30. Took 0.046255 seconds. 
  Full-batch training loss = 0.315807, test loss = 0.383591
  Training set accuracy = 0.917500, Test set accuracy = 0.886600
 epoch 18/30. Took 0.044302 seconds. 
  Full-batch training loss = 0.311953, test loss = 0.386277
  Training set accuracy = 0.914500, Test set accuracy = 0.881000
 epoch 19/30. Took 0.044284 seconds. 
  Full-batch training loss = 0.289165, test loss = 0.366232
  Training set accuracy = 0.927000, Test set accuracy = 0.890100
 epoch 20/30. Took 0.043828 seconds. 
  Full-batch training loss = 0.278414, test loss = 0.359884
  Training set accuracy = 0.933000, Test set accuracy = 0.894700
 epoch 21/30. Took 0.040598 seconds. 
  Full-batch training loss = 0.268996, test loss = 0.356282
  Training set accuracy = 0.931500, Test set accuracy = 0.893800
 epoch 22/30. Took 0.044003 seconds. 
  Full-batch training loss = 0.257032, test loss = 0.350877
  Training set accuracy = 0.937500, Test set accuracy = 0.895500
 epoch 23/30. Took 0.039283 seconds. 
  Full-batch training loss = 0.253015, test loss = 0.354376
  Training set accuracy = 0.935500, Test set accuracy = 0.893600
 epoch 24/30. Took 0.044392 seconds. 
  Full-batch training loss = 0.243931, test loss = 0.347591
  Training set accuracy = 0.940000, Test set accuracy = 0.895800
 epoch 25/30. Took 0.041313 seconds. 
  Full-batch training loss = 0.242129, test loss = 0.353864
  Training set accuracy = 0.940500, Test set accuracy = 0.893000
 epoch 26/30. Took 0.040311 seconds. 
  Full-batch training loss = 0.225649, test loss = 0.342669
  Training set accuracy = 0.942000, Test set accuracy = 0.897300
 epoch 27/30. Took 0.043705 seconds. 
  Full-batch training loss = 0.224005, test loss = 0.345844
  Training set accuracy = 0.945000, Test set accuracy = 0.895000
 epoch 28/30. Took 0.048078 seconds. 
  Full-batch training loss = 0.213230, test loss = 0.342579
  Training set accuracy = 0.947000, Test set accuracy = 0.896400
 epoch 29/30. Took 0.046021 seconds. 
  Full-batch training loss = 0.210351, test loss = 0.343753
  Training set accuracy = 0.949500, Test set accuracy = 0.896000
 epoch 30/30. Took 0.044702 seconds. 
  Full-batch training loss = 0.203487, test loss = 0.347024
  Training set accuracy = 0.947500, Test set accuracy = 0.894600
Elapsed time is 5.653220 seconds.
End Training
-----
Params 2000 0.010 0.00 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.087817 seconds. 
  Full-batch training loss = 2.123514, test loss = 2.119937
  Training set accuracy = 0.461000, Test set accuracy = 0.475600
 epoch 2/30. Took 0.082926 seconds. 
  Full-batch training loss = 1.804392, test loss = 1.798760
  Training set accuracy = 0.683000, Test set accuracy = 0.685600
 epoch 3/30. Took 0.082273 seconds. 
  Full-batch training loss = 1.352916, test loss = 1.344917
  Training set accuracy = 0.750500, Test set accuracy = 0.756300
 epoch 4/30. Took 0.071473 seconds. 
  Full-batch training loss = 0.966784, test loss = 0.963136
  Training set accuracy = 0.799500, Test set accuracy = 0.801600
 epoch 5/30. Took 0.082926 seconds. 
  Full-batch training loss = 0.749723, test loss = 0.750870
  Training set accuracy = 0.826000, Test set accuracy = 0.820500
 epoch 6/30. Took 0.071388 seconds. 
  Full-batch training loss = 0.622813, test loss = 0.628701
  Training set accuracy = 0.846000, Test set accuracy = 0.844400
 epoch 7/30. Took 0.080921 seconds. 
  Full-batch training loss = 0.545414, test loss = 0.559248
  Training set accuracy = 0.864500, Test set accuracy = 0.858600
 epoch 8/30. Took 0.080463 seconds. 
  Full-batch training loss = 0.491485, test loss = 0.513427
  Training set accuracy = 0.868000, Test set accuracy = 0.861100
 epoch 9/30. Took 0.078113 seconds. 
  Full-batch training loss = 0.447312, test loss = 0.474967
  Training set accuracy = 0.884000, Test set accuracy = 0.872100
 epoch 10/30. Took 0.080003 seconds. 
  Full-batch training loss = 0.418493, test loss = 0.452356
  Training set accuracy = 0.884000, Test set accuracy = 0.875000
 epoch 11/30. Took 0.079952 seconds. 
  Full-batch training loss = 0.387817, test loss = 0.429490
  Training set accuracy = 0.895500, Test set accuracy = 0.883600
 epoch 12/30. Took 0.082428 seconds. 
  Full-batch training loss = 0.370915, test loss = 0.421368
  Training set accuracy = 0.900000, Test set accuracy = 0.881100
 epoch 13/30. Took 0.07128 seconds. 
  Full-batch training loss = 0.351904, test loss = 0.404147
  Training set accuracy = 0.905000, Test set accuracy = 0.886900
 epoch 14/30. Took 0.079963 seconds. 
  Full-batch training loss = 0.330744, test loss = 0.391857
  Training set accuracy = 0.914000, Test set accuracy = 0.888600
 epoch 15/30. Took 0.077967 seconds. 
  Full-batch training loss = 0.319847, test loss = 0.387489
  Training set accuracy = 0.913500, Test set accuracy = 0.890100
 epoch 16/30. Took 0.079611 seconds. 
  Full-batch training loss = 0.301109, test loss = 0.373294
  Training set accuracy = 0.919000, Test set accuracy = 0.894500
 epoch 17/30. Took 0.071425 seconds. 
  Full-batch training loss = 0.292119, test loss = 0.370002
  Training set accuracy = 0.924000, Test set accuracy = 0.895800
 epoch 18/30. Took 0.08345 seconds. 
  Full-batch training loss = 0.279680, test loss = 0.363460
  Training set accuracy = 0.932500, Test set accuracy = 0.895600
 epoch 19/30. Took 0.081321 seconds. 
  Full-batch training loss = 0.274669, test loss = 0.362958
  Training set accuracy = 0.930000, Test set accuracy = 0.895600
 epoch 20/30. Took 0.082135 seconds. 
  Full-batch training loss = 0.255438, test loss = 0.351926
  Training set accuracy = 0.938500, Test set accuracy = 0.896600
 epoch 21/30. Took 0.069436 seconds. 
  Full-batch training loss = 0.246461, test loss = 0.348759
  Training set accuracy = 0.941000, Test set accuracy = 0.898700
 epoch 22/30. Took 0.082695 seconds. 
  Full-batch training loss = 0.240450, test loss = 0.346524
  Training set accuracy = 0.940000, Test set accuracy = 0.898700
 epoch 23/30. Took 0.070293 seconds. 
  Full-batch training loss = 0.233651, test loss = 0.349323
  Training set accuracy = 0.946500, Test set accuracy = 0.900000
 epoch 24/30. Took 0.070766 seconds. 
  Full-batch training loss = 0.221419, test loss = 0.341317
  Training set accuracy = 0.946000, Test set accuracy = 0.900400
 epoch 25/30. Took 0.0721 seconds. 
  Full-batch training loss = 0.216107, test loss = 0.338535
  Training set accuracy = 0.947500, Test set accuracy = 0.901100
 epoch 26/30. Took 0.082362 seconds. 
  Full-batch training loss = 0.211371, test loss = 0.345726
  Training set accuracy = 0.948500, Test set accuracy = 0.899400
 epoch 27/30. Took 0.080848 seconds. 
  Full-batch training loss = 0.201347, test loss = 0.339675
  Training set accuracy = 0.954000, Test set accuracy = 0.900500
 epoch 28/30. Took 0.081057 seconds. 
  Full-batch training loss = 0.193034, test loss = 0.336459
  Training set accuracy = 0.957000, Test set accuracy = 0.903700
 epoch 29/30. Took 0.069604 seconds. 
  Full-batch training loss = 0.187522, test loss = 0.331963
  Training set accuracy = 0.952000, Test set accuracy = 0.902600
 epoch 30/30. Took 0.084184 seconds. 
  Full-batch training loss = 0.183069, test loss = 0.332386
  Training set accuracy = 0.958000, Test set accuracy = 0.903600
Elapsed time is 9.220152 seconds.
End Training
-----
Params 2000 0.010 0.00 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.21218 seconds. 
  Full-batch training loss = 1.989745, test loss = 1.998474
  Training set accuracy = 0.555000, Test set accuracy = 0.543700
 epoch 2/30. Took 0.23544 seconds. 
  Full-batch training loss = 1.532990, test loss = 1.539233
  Training set accuracy = 0.725000, Test set accuracy = 0.721900
 epoch 3/30. Took 0.19831 seconds. 
  Full-batch training loss = 1.072260, test loss = 1.077331
  Training set accuracy = 0.768500, Test set accuracy = 0.774500
 epoch 4/30. Took 0.20989 seconds. 
  Full-batch training loss = 0.791750, test loss = 0.800183
  Training set accuracy = 0.819500, Test set accuracy = 0.818400
 epoch 5/30. Took 0.20647 seconds. 
  Full-batch training loss = 0.636199, test loss = 0.653374
  Training set accuracy = 0.844000, Test set accuracy = 0.836300
 epoch 6/30. Took 0.19976 seconds. 
  Full-batch training loss = 0.549804, test loss = 0.572159
  Training set accuracy = 0.866000, Test set accuracy = 0.853600
 epoch 7/30. Took 0.24154 seconds. 
  Full-batch training loss = 0.486751, test loss = 0.515868
  Training set accuracy = 0.877500, Test set accuracy = 0.861900
 epoch 8/30. Took 0.23644 seconds. 
  Full-batch training loss = 0.446674, test loss = 0.482633
  Training set accuracy = 0.886000, Test set accuracy = 0.866900
 epoch 9/30. Took 0.20756 seconds. 
  Full-batch training loss = 0.412452, test loss = 0.454114
  Training set accuracy = 0.896500, Test set accuracy = 0.875400
 epoch 10/30. Took 0.21383 seconds. 
  Full-batch training loss = 0.383354, test loss = 0.432101
  Training set accuracy = 0.903000, Test set accuracy = 0.876900
 epoch 11/30. Took 0.21329 seconds. 
  Full-batch training loss = 0.361662, test loss = 0.417221
  Training set accuracy = 0.907500, Test set accuracy = 0.881300
 epoch 12/30. Took 0.21538 seconds. 
  Full-batch training loss = 0.343143, test loss = 0.400250
  Training set accuracy = 0.908000, Test set accuracy = 0.886800
 epoch 13/30. Took 0.2074 seconds. 
  Full-batch training loss = 0.325520, test loss = 0.389774
  Training set accuracy = 0.920000, Test set accuracy = 0.885600
 epoch 14/30. Took 0.20481 seconds. 
  Full-batch training loss = 0.305553, test loss = 0.376939
  Training set accuracy = 0.922500, Test set accuracy = 0.889500
 epoch 15/30. Took 0.23033 seconds. 
  Full-batch training loss = 0.296182, test loss = 0.376542
  Training set accuracy = 0.925000, Test set accuracy = 0.890300
 epoch 16/30. Took 0.19793 seconds. 
  Full-batch training loss = 0.279747, test loss = 0.364705
  Training set accuracy = 0.930500, Test set accuracy = 0.894500
 epoch 17/30. Took 0.21244 seconds. 
  Full-batch training loss = 0.271520, test loss = 0.358647
  Training set accuracy = 0.932000, Test set accuracy = 0.894300
 epoch 18/30. Took 0.24615 seconds. 
  Full-batch training loss = 0.260541, test loss = 0.360117
  Training set accuracy = 0.934000, Test set accuracy = 0.894100
 epoch 19/30. Took 0.21918 seconds. 
  Full-batch training loss = 0.248381, test loss = 0.350896
  Training set accuracy = 0.938000, Test set accuracy = 0.895100
 epoch 20/30. Took 0.24701 seconds. 
  Full-batch training loss = 0.236991, test loss = 0.345770
  Training set accuracy = 0.940500, Test set accuracy = 0.897700
 epoch 21/30. Took 0.23384 seconds. 
  Full-batch training loss = 0.228156, test loss = 0.343327
  Training set accuracy = 0.943000, Test set accuracy = 0.895800
 epoch 22/30. Took 0.19752 seconds. 
  Full-batch training loss = 0.219666, test loss = 0.340127
  Training set accuracy = 0.946500, Test set accuracy = 0.899500
 epoch 23/30. Took 0.22784 seconds. 
  Full-batch training loss = 0.214564, test loss = 0.340711
  Training set accuracy = 0.950000, Test set accuracy = 0.897500
 epoch 24/30. Took 0.24541 seconds. 
  Full-batch training loss = 0.202988, test loss = 0.333080
  Training set accuracy = 0.950500, Test set accuracy = 0.900300
 epoch 25/30. Took 0.20942 seconds. 
  Full-batch training loss = 0.197150, test loss = 0.327480
  Training set accuracy = 0.956000, Test set accuracy = 0.901600
 epoch 26/30. Took 0.21222 seconds. 
  Full-batch training loss = 0.193513, test loss = 0.334527
  Training set accuracy = 0.949500, Test set accuracy = 0.897600
 epoch 27/30. Took 0.22336 seconds. 
  Full-batch training loss = 0.181391, test loss = 0.326560
  Training set accuracy = 0.956000, Test set accuracy = 0.901300
 epoch 28/30. Took 0.25029 seconds. 
  Full-batch training loss = 0.178569, test loss = 0.330492
  Training set accuracy = 0.955500, Test set accuracy = 0.900300
 epoch 29/30. Took 0.20204 seconds. 
  Full-batch training loss = 0.168508, test loss = 0.323625
  Training set accuracy = 0.964000, Test set accuracy = 0.902200
 epoch 30/30. Took 0.22222 seconds. 
  Full-batch training loss = 0.165253, test loss = 0.323776
  Training set accuracy = 0.967000, Test set accuracy = 0.904300
Elapsed time is 22.395728 seconds.
End Training
-----
Params 2000 0.010 0.00 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.058905 seconds. 
  Full-batch training loss = 2.213198, test loss = 2.212416
  Training set accuracy = 0.319000, Test set accuracy = 0.331200
 epoch 2/30. Took 0.044695 seconds. 
  Full-batch training loss = 2.038598, test loss = 2.039324
  Training set accuracy = 0.539000, Test set accuracy = 0.532200
 epoch 3/30. Took 0.047539 seconds. 
  Full-batch training loss = 1.699899, test loss = 1.699613
  Training set accuracy = 0.612500, Test set accuracy = 0.602700
 epoch 4/30. Took 0.052995 seconds. 
  Full-batch training loss = 1.255362, test loss = 1.254552
  Training set accuracy = 0.707000, Test set accuracy = 0.689700
 epoch 5/30. Took 0.047044 seconds. 
  Full-batch training loss = 0.904811, test loss = 0.913494
  Training set accuracy = 0.768000, Test set accuracy = 0.757800
 epoch 6/30. Took 0.044745 seconds. 
  Full-batch training loss = 0.699807, test loss = 0.728639
  Training set accuracy = 0.817500, Test set accuracy = 0.803400
 epoch 7/30. Took 0.044811 seconds. 
  Full-batch training loss = 0.594890, test loss = 0.641256
  Training set accuracy = 0.841500, Test set accuracy = 0.809800
 epoch 8/30. Took 0.043093 seconds. 
  Full-batch training loss = 0.507144, test loss = 0.550636
  Training set accuracy = 0.860500, Test set accuracy = 0.833700
 epoch 9/30. Took 0.042544 seconds. 
  Full-batch training loss = 0.452043, test loss = 0.503484
  Training set accuracy = 0.877500, Test set accuracy = 0.849500
 epoch 10/30. Took 0.043298 seconds. 
  Full-batch training loss = 0.413387, test loss = 0.479801
  Training set accuracy = 0.885500, Test set accuracy = 0.857800
 epoch 11/30. Took 0.044674 seconds. 
  Full-batch training loss = 0.378113, test loss = 0.447317
  Training set accuracy = 0.895500, Test set accuracy = 0.867700
 epoch 12/30. Took 0.047302 seconds. 
  Full-batch training loss = 0.372097, test loss = 0.446578
  Training set accuracy = 0.884500, Test set accuracy = 0.863600
 epoch 13/30. Took 0.044033 seconds. 
  Full-batch training loss = 0.331162, test loss = 0.418817
  Training set accuracy = 0.910500, Test set accuracy = 0.876700
 epoch 14/30. Took 0.044861 seconds. 
  Full-batch training loss = 0.310913, test loss = 0.417473
  Training set accuracy = 0.916500, Test set accuracy = 0.876500
 epoch 15/30. Took 0.045218 seconds. 
  Full-batch training loss = 0.295837, test loss = 0.405268
  Training set accuracy = 0.914500, Test set accuracy = 0.881300
 epoch 16/30. Took 0.042297 seconds. 
  Full-batch training loss = 0.277913, test loss = 0.387206
  Training set accuracy = 0.921500, Test set accuracy = 0.884600
 epoch 17/30. Took 0.044713 seconds. 
  Full-batch training loss = 0.281797, test loss = 0.413493
  Training set accuracy = 0.920500, Test set accuracy = 0.868400
 epoch 18/30. Took 0.045693 seconds. 
  Full-batch training loss = 0.267283, test loss = 0.405393
  Training set accuracy = 0.916000, Test set accuracy = 0.877000
 epoch 19/30. Took 0.044727 seconds. 
  Full-batch training loss = 0.251103, test loss = 0.385049
  Training set accuracy = 0.928500, Test set accuracy = 0.885700
 epoch 20/30. Took 0.046214 seconds. 
  Full-batch training loss = 0.227830, test loss = 0.372008
  Training set accuracy = 0.935500, Test set accuracy = 0.888900
 epoch 21/30. Took 0.045649 seconds. 
  Full-batch training loss = 0.236546, test loss = 0.390906
  Training set accuracy = 0.930500, Test set accuracy = 0.882200
 epoch 22/30. Took 0.045769 seconds. 
  Full-batch training loss = 0.212429, test loss = 0.380026
  Training set accuracy = 0.936000, Test set accuracy = 0.886400
 epoch 23/30. Took 0.046194 seconds. 
  Full-batch training loss = 0.209598, test loss = 0.383244
  Training set accuracy = 0.939500, Test set accuracy = 0.885900
 epoch 24/30. Took 0.045509 seconds. 
  Full-batch training loss = 0.192017, test loss = 0.361876
  Training set accuracy = 0.943000, Test set accuracy = 0.892600
 epoch 25/30. Took 0.046094 seconds. 
  Full-batch training loss = 0.183448, test loss = 0.366794
  Training set accuracy = 0.951000, Test set accuracy = 0.892000
 epoch 26/30. Took 0.044422 seconds. 
  Full-batch training loss = 0.171771, test loss = 0.357887
  Training set accuracy = 0.950000, Test set accuracy = 0.894200
 epoch 27/30. Took 0.044341 seconds. 
  Full-batch training loss = 0.164266, test loss = 0.363038
  Training set accuracy = 0.958000, Test set accuracy = 0.894700
 epoch 28/30. Took 0.044278 seconds. 
  Full-batch training loss = 0.157967, test loss = 0.361681
  Training set accuracy = 0.952000, Test set accuracy = 0.892000
 epoch 29/30. Took 0.044682 seconds. 
  Full-batch training loss = 0.152409, test loss = 0.373380
  Training set accuracy = 0.961000, Test set accuracy = 0.892100
 epoch 30/30. Took 0.04432 seconds. 
  Full-batch training loss = 0.144303, test loss = 0.368251
  Training set accuracy = 0.966000, Test set accuracy = 0.894200
Elapsed time is 6.226552 seconds.
End Training
-----
Params 2000 0.010 0.00 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.088173 seconds. 
  Full-batch training loss = 2.206112, test loss = 2.208953
  Training set accuracy = 0.187500, Test set accuracy = 0.182700
 epoch 2/30. Took 0.095324 seconds. 
  Full-batch training loss = 2.024112, test loss = 2.027669
  Training set accuracy = 0.528500, Test set accuracy = 0.508200
 epoch 3/30. Took 0.081781 seconds. 
  Full-batch training loss = 1.663938, test loss = 1.668237
  Training set accuracy = 0.662500, Test set accuracy = 0.653400
 epoch 4/30. Took 0.08391 seconds. 
  Full-batch training loss = 1.180212, test loss = 1.187952
  Training set accuracy = 0.745500, Test set accuracy = 0.732600
 epoch 5/30. Took 0.084441 seconds. 
  Full-batch training loss = 0.843313, test loss = 0.860082
  Training set accuracy = 0.795000, Test set accuracy = 0.773900
 epoch 6/30. Took 0.082344 seconds. 
  Full-batch training loss = 0.646966, test loss = 0.673339
  Training set accuracy = 0.845000, Test set accuracy = 0.828700
 epoch 7/30. Took 0.084004 seconds. 
  Full-batch training loss = 0.530963, test loss = 0.565542
  Training set accuracy = 0.872000, Test set accuracy = 0.852000
 epoch 8/30. Took 0.082547 seconds. 
  Full-batch training loss = 0.469436, test loss = 0.513162
  Training set accuracy = 0.887500, Test set accuracy = 0.864200
 epoch 9/30. Took 0.080256 seconds. 
  Full-batch training loss = 0.442351, test loss = 0.497699
  Training set accuracy = 0.876500, Test set accuracy = 0.862800
 epoch 10/30. Took 0.079332 seconds. 
  Full-batch training loss = 0.390626, test loss = 0.448904
  Training set accuracy = 0.894000, Test set accuracy = 0.875500
 epoch 11/30. Took 0.081406 seconds. 
  Full-batch training loss = 0.346772, test loss = 0.414152
  Training set accuracy = 0.909500, Test set accuracy = 0.885600
 epoch 12/30. Took 0.091737 seconds. 
  Full-batch training loss = 0.322174, test loss = 0.393641
  Training set accuracy = 0.914000, Test set accuracy = 0.888600
 epoch 13/30. Took 0.080626 seconds. 
  Full-batch training loss = 0.316775, test loss = 0.394456
  Training set accuracy = 0.917000, Test set accuracy = 0.889900
 epoch 14/30. Took 0.090357 seconds. 
  Full-batch training loss = 0.281661, test loss = 0.368993
  Training set accuracy = 0.924500, Test set accuracy = 0.893600
 epoch 15/30. Took 0.082021 seconds. 
  Full-batch training loss = 0.278346, test loss = 0.377744
  Training set accuracy = 0.922000, Test set accuracy = 0.891800
 epoch 16/30. Took 0.081391 seconds. 
  Full-batch training loss = 0.250501, test loss = 0.353234
  Training set accuracy = 0.932000, Test set accuracy = 0.897800
 epoch 17/30. Took 0.081882 seconds. 
  Full-batch training loss = 0.251031, test loss = 0.360817
  Training set accuracy = 0.933000, Test set accuracy = 0.895400
 epoch 18/30. Took 0.083225 seconds. 
  Full-batch training loss = 0.228622, test loss = 0.344166
  Training set accuracy = 0.937000, Test set accuracy = 0.898400
 epoch 19/30. Took 0.082224 seconds. 
  Full-batch training loss = 0.209913, test loss = 0.331265
  Training set accuracy = 0.943000, Test set accuracy = 0.905200
 epoch 20/30. Took 0.084341 seconds. 
  Full-batch training loss = 0.203019, test loss = 0.328777
  Training set accuracy = 0.945500, Test set accuracy = 0.903100
 epoch 21/30. Took 0.082767 seconds. 
  Full-batch training loss = 0.197418, test loss = 0.332218
  Training set accuracy = 0.945500, Test set accuracy = 0.902200
 epoch 22/30. Took 0.082148 seconds. 
  Full-batch training loss = 0.180415, test loss = 0.327729
  Training set accuracy = 0.954000, Test set accuracy = 0.906500
 epoch 23/30. Took 0.08001 seconds. 
  Full-batch training loss = 0.176220, test loss = 0.328863
  Training set accuracy = 0.952500, Test set accuracy = 0.901800
 epoch 24/30. Took 0.079845 seconds. 
  Full-batch training loss = 0.165339, test loss = 0.320824
  Training set accuracy = 0.956500, Test set accuracy = 0.907600
 epoch 25/30. Took 0.079661 seconds. 
  Full-batch training loss = 0.153595, test loss = 0.317646
  Training set accuracy = 0.963500, Test set accuracy = 0.908600
 epoch 26/30. Took 0.088277 seconds. 
  Full-batch training loss = 0.148622, test loss = 0.316429
  Training set accuracy = 0.962000, Test set accuracy = 0.908900
 epoch 27/30. Took 0.081202 seconds. 
  Full-batch training loss = 0.141777, test loss = 0.315932
  Training set accuracy = 0.966500, Test set accuracy = 0.907100
 epoch 28/30. Took 0.095627 seconds. 
  Full-batch training loss = 0.135204, test loss = 0.322780
  Training set accuracy = 0.970500, Test set accuracy = 0.905900
 epoch 29/30. Took 0.084933 seconds. 
  Full-batch training loss = 0.129132, test loss = 0.322572
  Training set accuracy = 0.971000, Test set accuracy = 0.910400
 epoch 30/30. Took 0.081174 seconds. 
  Full-batch training loss = 0.121397, test loss = 0.319576
  Training set accuracy = 0.974500, Test set accuracy = 0.907500
Elapsed time is 10.720651 seconds.
End Training
-----
Params 2000 0.010 0.00 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.30844 seconds. 
  Full-batch training loss = 2.134078, test loss = 2.137352
  Training set accuracy = 0.495500, Test set accuracy = 0.484100
 epoch 2/30. Took 0.27249 seconds. 
  Full-batch training loss = 1.806452, test loss = 1.807076
  Training set accuracy = 0.656500, Test set accuracy = 0.661500
 epoch 3/30. Took 0.27369 seconds. 
  Full-batch training loss = 1.270165, test loss = 1.271630
  Training set accuracy = 0.751500, Test set accuracy = 0.748500
 epoch 4/30. Took 0.27351 seconds. 
  Full-batch training loss = 0.850768, test loss = 0.855681
  Training set accuracy = 0.803000, Test set accuracy = 0.792600
 epoch 5/30. Took 0.27189 seconds. 
  Full-batch training loss = 0.631190, test loss = 0.655580
  Training set accuracy = 0.848500, Test set accuracy = 0.835000
 epoch 6/30. Took 0.27352 seconds. 
  Full-batch training loss = 0.503249, test loss = 0.545260
  Training set accuracy = 0.873500, Test set accuracy = 0.856600
 epoch 7/30. Took 0.27471 seconds. 
  Full-batch training loss = 0.421975, test loss = 0.476255
  Training set accuracy = 0.892500, Test set accuracy = 0.872400
 epoch 8/30. Took 0.27131 seconds. 
  Full-batch training loss = 0.375461, test loss = 0.439520
  Training set accuracy = 0.905000, Test set accuracy = 0.879500
 epoch 9/30. Took 0.27297 seconds. 
  Full-batch training loss = 0.346202, test loss = 0.420808
  Training set accuracy = 0.903500, Test set accuracy = 0.877900
 epoch 10/30. Took 0.27276 seconds. 
  Full-batch training loss = 0.295345, test loss = 0.387098
  Training set accuracy = 0.921000, Test set accuracy = 0.890200
 epoch 11/30. Took 0.2734 seconds. 
  Full-batch training loss = 0.282719, test loss = 0.391625
  Training set accuracy = 0.924500, Test set accuracy = 0.885700
 epoch 12/30. Took 0.27216 seconds. 
  Full-batch training loss = 0.266490, test loss = 0.379284
  Training set accuracy = 0.927500, Test set accuracy = 0.887700
 epoch 13/30. Took 0.27309 seconds. 
  Full-batch training loss = 0.236243, test loss = 0.365458
  Training set accuracy = 0.936500, Test set accuracy = 0.889100
 epoch 14/30. Took 0.27712 seconds. 
  Full-batch training loss = 0.211660, test loss = 0.350141
  Training set accuracy = 0.948000, Test set accuracy = 0.895900
 epoch 15/30. Took 0.27636 seconds. 
  Full-batch training loss = 0.208851, test loss = 0.348626
  Training set accuracy = 0.940500, Test set accuracy = 0.896400
 epoch 16/30. Took 0.27459 seconds. 
  Full-batch training loss = 0.188089, test loss = 0.338419
  Training set accuracy = 0.952500, Test set accuracy = 0.899500
 epoch 17/30. Took 0.27222 seconds. 
  Full-batch training loss = 0.181308, test loss = 0.345035
  Training set accuracy = 0.955000, Test set accuracy = 0.895200
 epoch 18/30. Took 0.27307 seconds. 
  Full-batch training loss = 0.166198, test loss = 0.339509
  Training set accuracy = 0.956000, Test set accuracy = 0.898800
 epoch 19/30. Took 0.27327 seconds. 
  Full-batch training loss = 0.146578, test loss = 0.331806
  Training set accuracy = 0.962000, Test set accuracy = 0.900800
 epoch 20/30. Took 0.27123 seconds. 
  Full-batch training loss = 0.148379, test loss = 0.342309
  Training set accuracy = 0.967000, Test set accuracy = 0.896900
 epoch 21/30. Took 0.27065 seconds. 
  Full-batch training loss = 0.126589, test loss = 0.324618
  Training set accuracy = 0.971500, Test set accuracy = 0.903200
 epoch 22/30. Took 0.27805 seconds. 
  Full-batch training loss = 0.123608, test loss = 0.333513
  Training set accuracy = 0.972000, Test set accuracy = 0.900700
 epoch 23/30. Took 0.30457 seconds. 
  Full-batch training loss = 0.118240, test loss = 0.328970
  Training set accuracy = 0.970000, Test set accuracy = 0.901700
 epoch 24/30. Took 0.32566 seconds. 
  Full-batch training loss = 0.113566, test loss = 0.336632
  Training set accuracy = 0.978000, Test set accuracy = 0.900900
 epoch 25/30. Took 0.3063 seconds. 
  Full-batch training loss = 0.105651, test loss = 0.328683
  Training set accuracy = 0.976000, Test set accuracy = 0.903600
 epoch 26/30. Took 0.3218 seconds. 
  Full-batch training loss = 0.091344, test loss = 0.321492
  Training set accuracy = 0.983500, Test set accuracy = 0.905900
 epoch 27/30. Took 0.32778 seconds. 
  Full-batch training loss = 0.093461, test loss = 0.327033
  Training set accuracy = 0.979500, Test set accuracy = 0.904500
 epoch 28/30. Took 0.29494 seconds. 
  Full-batch training loss = 0.083216, test loss = 0.325577
  Training set accuracy = 0.987500, Test set accuracy = 0.905900
 epoch 29/30. Took 0.27762 seconds. 
  Full-batch training loss = 0.076662, test loss = 0.326069
  Training set accuracy = 0.989000, Test set accuracy = 0.906400
 epoch 30/30. Took 0.27703 seconds. 
  Full-batch training loss = 0.070550, test loss = 0.327164
  Training set accuracy = 0.991000, Test set accuracy = 0.905700
Elapsed time is 29.533329 seconds.
End Training
-----
Params 2000 0.010 0.10 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.039364 seconds. 
  Full-batch training loss = 2.002474, test loss = 2.005060
  Training set accuracy = 0.504000, Test set accuracy = 0.502500
 epoch 2/30. Took 0.039881 seconds. 
  Full-batch training loss = 1.609793, test loss = 1.612098
  Training set accuracy = 0.655000, Test set accuracy = 0.649300
 epoch 3/30. Took 0.036444 seconds. 
  Full-batch training loss = 1.261362, test loss = 1.264243
  Training set accuracy = 0.742500, Test set accuracy = 0.736700
 epoch 4/30. Took 0.037949 seconds. 
  Full-batch training loss = 1.007821, test loss = 1.014085
  Training set accuracy = 0.824500, Test set accuracy = 0.816600
 epoch 5/30. Took 0.036384 seconds. 
  Full-batch training loss = 0.837882, test loss = 0.846191
  Training set accuracy = 0.837000, Test set accuracy = 0.828300
 epoch 6/30. Took 0.03716 seconds. 
  Full-batch training loss = 0.726628, test loss = 0.736358
  Training set accuracy = 0.854500, Test set accuracy = 0.848500
 epoch 7/30. Took 0.038545 seconds. 
  Full-batch training loss = 0.646858, test loss = 0.661602
  Training set accuracy = 0.870500, Test set accuracy = 0.859500
 epoch 8/30. Took 0.035868 seconds. 
  Full-batch training loss = 0.591328, test loss = 0.609191
  Training set accuracy = 0.874500, Test set accuracy = 0.862000
 epoch 9/30. Took 0.036108 seconds. 
  Full-batch training loss = 0.545976, test loss = 0.567731
  Training set accuracy = 0.884500, Test set accuracy = 0.868200
 epoch 10/30. Took 0.0385 seconds. 
  Full-batch training loss = 0.511806, test loss = 0.538133
  Training set accuracy = 0.889500, Test set accuracy = 0.871800
 epoch 11/30. Took 0.036032 seconds. 
  Full-batch training loss = 0.482528, test loss = 0.510169
  Training set accuracy = 0.895000, Test set accuracy = 0.875800
 epoch 12/30. Took 0.037145 seconds. 
  Full-batch training loss = 0.459132, test loss = 0.490389
  Training set accuracy = 0.895000, Test set accuracy = 0.877900
 epoch 13/30. Took 0.03818 seconds. 
  Full-batch training loss = 0.438620, test loss = 0.474932
  Training set accuracy = 0.897000, Test set accuracy = 0.881100
 epoch 14/30. Took 0.047015 seconds. 
  Full-batch training loss = 0.419503, test loss = 0.457971
  Training set accuracy = 0.903500, Test set accuracy = 0.882700
 epoch 15/30. Took 0.037257 seconds. 
  Full-batch training loss = 0.404435, test loss = 0.446601
  Training set accuracy = 0.906000, Test set accuracy = 0.883400
 epoch 16/30. Took 0.037673 seconds. 
  Full-batch training loss = 0.391221, test loss = 0.437344
  Training set accuracy = 0.906500, Test set accuracy = 0.884900
 epoch 17/30. Took 0.039099 seconds. 
  Full-batch training loss = 0.377524, test loss = 0.426515
  Training set accuracy = 0.914500, Test set accuracy = 0.887200
 epoch 18/30. Took 0.038256 seconds. 
  Full-batch training loss = 0.365950, test loss = 0.418423
  Training set accuracy = 0.914500, Test set accuracy = 0.887500
 epoch 19/30. Took 0.038077 seconds. 
  Full-batch training loss = 0.356205, test loss = 0.409720
  Training set accuracy = 0.916500, Test set accuracy = 0.889400
 epoch 20/30. Took 0.040255 seconds. 
  Full-batch training loss = 0.345755, test loss = 0.403774
  Training set accuracy = 0.919500, Test set accuracy = 0.891500
 epoch 21/30. Took 0.037745 seconds. 
  Full-batch training loss = 0.336859, test loss = 0.397502
  Training set accuracy = 0.921500, Test set accuracy = 0.892400
 epoch 22/30. Took 0.038185 seconds. 
  Full-batch training loss = 0.329488, test loss = 0.393852
  Training set accuracy = 0.922500, Test set accuracy = 0.894400
 epoch 23/30. Took 0.038058 seconds. 
  Full-batch training loss = 0.321683, test loss = 0.386799
  Training set accuracy = 0.922500, Test set accuracy = 0.893100
 epoch 24/30. Took 0.03916 seconds. 
  Full-batch training loss = 0.314336, test loss = 0.384517
  Training set accuracy = 0.925000, Test set accuracy = 0.894400
 epoch 25/30. Took 0.043887 seconds. 
  Full-batch training loss = 0.308329, test loss = 0.378730
  Training set accuracy = 0.926000, Test set accuracy = 0.895200
 epoch 26/30. Took 0.042204 seconds. 
  Full-batch training loss = 0.300746, test loss = 0.376139
  Training set accuracy = 0.927500, Test set accuracy = 0.895200
 epoch 27/30. Took 0.03848 seconds. 
  Full-batch training loss = 0.295075, test loss = 0.372773
  Training set accuracy = 0.928000, Test set accuracy = 0.896200
 epoch 28/30. Took 0.037721 seconds. 
  Full-batch training loss = 0.288856, test loss = 0.369622
  Training set accuracy = 0.930500, Test set accuracy = 0.896700
 epoch 29/30. Took 0.037771 seconds. 
  Full-batch training loss = 0.284345, test loss = 0.365265
  Training set accuracy = 0.931000, Test set accuracy = 0.897900
 epoch 30/30. Took 0.037908 seconds. 
  Full-batch training loss = 0.280990, test loss = 0.365829
  Training set accuracy = 0.933500, Test set accuracy = 0.897100
Elapsed time is 5.096742 seconds.
End Training
-----
Params 2000 0.010 0.10 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.068591 seconds. 
  Full-batch training loss = 1.937754, test loss = 1.953048
  Training set accuracy = 0.553000, Test set accuracy = 0.518100
 epoch 2/30. Took 0.062451 seconds. 
  Full-batch training loss = 1.523848, test loss = 1.543836
  Training set accuracy = 0.702500, Test set accuracy = 0.689500
 epoch 3/30. Took 0.064376 seconds. 
  Full-batch training loss = 1.183973, test loss = 1.205554
  Training set accuracy = 0.768500, Test set accuracy = 0.755900
 epoch 4/30. Took 0.062797 seconds. 
  Full-batch training loss = 0.947900, test loss = 0.970418
  Training set accuracy = 0.814000, Test set accuracy = 0.799200
 epoch 5/30. Took 0.063702 seconds. 
  Full-batch training loss = 0.795571, test loss = 0.819811
  Training set accuracy = 0.845500, Test set accuracy = 0.824800
 epoch 6/30. Took 0.062823 seconds. 
  Full-batch training loss = 0.694260, test loss = 0.723853
  Training set accuracy = 0.855500, Test set accuracy = 0.835100
 epoch 7/30. Took 0.060772 seconds. 
  Full-batch training loss = 0.622411, test loss = 0.653633
  Training set accuracy = 0.866000, Test set accuracy = 0.846700
 epoch 8/30. Took 0.063531 seconds. 
  Full-batch training loss = 0.568869, test loss = 0.603838
  Training set accuracy = 0.875000, Test set accuracy = 0.856400
 epoch 9/30. Took 0.062532 seconds. 
  Full-batch training loss = 0.527726, test loss = 0.568726
  Training set accuracy = 0.876000, Test set accuracy = 0.857300
 epoch 10/30. Took 0.065016 seconds. 
  Full-batch training loss = 0.493947, test loss = 0.536347
  Training set accuracy = 0.880500, Test set accuracy = 0.862800
 epoch 11/30. Took 0.062543 seconds. 
  Full-batch training loss = 0.466222, test loss = 0.509919
  Training set accuracy = 0.886000, Test set accuracy = 0.871500
 epoch 12/30. Took 0.062853 seconds. 
  Full-batch training loss = 0.441949, test loss = 0.491960
  Training set accuracy = 0.891500, Test set accuracy = 0.873500
 epoch 13/30. Took 0.066382 seconds. 
  Full-batch training loss = 0.422988, test loss = 0.473128
  Training set accuracy = 0.894500, Test set accuracy = 0.876900
 epoch 14/30. Took 0.072126 seconds. 
  Full-batch training loss = 0.406578, test loss = 0.463764
  Training set accuracy = 0.896500, Test set accuracy = 0.875900
 epoch 15/30. Took 0.062575 seconds. 
  Full-batch training loss = 0.390684, test loss = 0.450943
  Training set accuracy = 0.902000, Test set accuracy = 0.877900
 epoch 16/30. Took 0.064046 seconds. 
  Full-batch training loss = 0.376578, test loss = 0.439088
  Training set accuracy = 0.906000, Test set accuracy = 0.882900
 epoch 17/30. Took 0.063921 seconds. 
  Full-batch training loss = 0.363834, test loss = 0.431165
  Training set accuracy = 0.908000, Test set accuracy = 0.883400
 epoch 18/30. Took 0.068349 seconds. 
  Full-batch training loss = 0.352917, test loss = 0.421224
  Training set accuracy = 0.911500, Test set accuracy = 0.885600
 epoch 19/30. Took 0.064319 seconds. 
  Full-batch training loss = 0.341969, test loss = 0.412960
  Training set accuracy = 0.917500, Test set accuracy = 0.888300
 epoch 20/30. Took 0.061191 seconds. 
  Full-batch training loss = 0.333491, test loss = 0.408328
  Training set accuracy = 0.919000, Test set accuracy = 0.889900
 epoch 21/30. Took 0.065044 seconds. 
  Full-batch training loss = 0.324244, test loss = 0.403863
  Training set accuracy = 0.920500, Test set accuracy = 0.889700
 epoch 22/30. Took 0.061325 seconds. 
  Full-batch training loss = 0.315306, test loss = 0.397386
  Training set accuracy = 0.923500, Test set accuracy = 0.890300
 epoch 23/30. Took 0.065055 seconds. 
  Full-batch training loss = 0.307652, test loss = 0.391536
  Training set accuracy = 0.922000, Test set accuracy = 0.892700
 epoch 24/30. Took 0.062544 seconds. 
  Full-batch training loss = 0.300900, test loss = 0.389100
  Training set accuracy = 0.926000, Test set accuracy = 0.893100
 epoch 25/30. Took 0.061146 seconds. 
  Full-batch training loss = 0.294131, test loss = 0.387060
  Training set accuracy = 0.928000, Test set accuracy = 0.890800
 epoch 26/30. Took 0.066482 seconds. 
  Full-batch training loss = 0.286981, test loss = 0.382861
  Training set accuracy = 0.930000, Test set accuracy = 0.892400
 epoch 27/30. Took 0.064886 seconds. 
  Full-batch training loss = 0.279930, test loss = 0.377441
  Training set accuracy = 0.932000, Test set accuracy = 0.895300
 epoch 28/30. Took 0.065411 seconds. 
  Full-batch training loss = 0.274032, test loss = 0.372436
  Training set accuracy = 0.933500, Test set accuracy = 0.894400
 epoch 29/30. Took 0.064839 seconds. 
  Full-batch training loss = 0.268363, test loss = 0.369768
  Training set accuracy = 0.933500, Test set accuracy = 0.896200
 epoch 30/30. Took 0.06433 seconds. 
  Full-batch training loss = 0.262664, test loss = 0.368618
  Training set accuracy = 0.935000, Test set accuracy = 0.896200
Elapsed time is 7.326279 seconds.
End Training
-----
Params 2000 0.010 0.10 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.15502 seconds. 
  Full-batch training loss = 1.954212, test loss = 1.949550
  Training set accuracy = 0.593000, Test set accuracy = 0.603900
 epoch 2/30. Took 0.13788 seconds. 
  Full-batch training loss = 1.534610, test loss = 1.520684
  Training set accuracy = 0.740500, Test set accuracy = 0.744400
 epoch 3/30. Took 0.13809 seconds. 
  Full-batch training loss = 1.187868, test loss = 1.168498
  Training set accuracy = 0.791000, Test set accuracy = 0.801400
 epoch 4/30. Took 0.14703 seconds. 
  Full-batch training loss = 0.955224, test loss = 0.938075
  Training set accuracy = 0.814500, Test set accuracy = 0.817700
 epoch 5/30. Took 0.13731 seconds. 
  Full-batch training loss = 0.806769, test loss = 0.789545
  Training set accuracy = 0.836000, Test set accuracy = 0.838700
 epoch 6/30. Took 0.13862 seconds. 
  Full-batch training loss = 0.712538, test loss = 0.701367
  Training set accuracy = 0.843500, Test set accuracy = 0.843200
 epoch 7/30. Took 0.13689 seconds. 
  Full-batch training loss = 0.642845, test loss = 0.635285
  Training set accuracy = 0.858000, Test set accuracy = 0.858200
 epoch 8/30. Took 0.14247 seconds. 
  Full-batch training loss = 0.590405, test loss = 0.585846
  Training set accuracy = 0.861000, Test set accuracy = 0.863200
 epoch 9/30. Took 0.1349 seconds. 
  Full-batch training loss = 0.549562, test loss = 0.549694
  Training set accuracy = 0.870500, Test set accuracy = 0.867100
 epoch 10/30. Took 0.13764 seconds. 
  Full-batch training loss = 0.516641, test loss = 0.520565
  Training set accuracy = 0.873000, Test set accuracy = 0.873500
 epoch 11/30. Took 0.13787 seconds. 
  Full-batch training loss = 0.491211, test loss = 0.499431
  Training set accuracy = 0.876500, Test set accuracy = 0.875500
 epoch 12/30. Took 0.13603 seconds. 
  Full-batch training loss = 0.467405, test loss = 0.479558
  Training set accuracy = 0.881500, Test set accuracy = 0.877900
 epoch 13/30. Took 0.13832 seconds. 
  Full-batch training loss = 0.449803, test loss = 0.466007
  Training set accuracy = 0.886500, Test set accuracy = 0.876500
 epoch 14/30. Took 0.1358 seconds. 
  Full-batch training loss = 0.431178, test loss = 0.450423
  Training set accuracy = 0.890500, Test set accuracy = 0.879200
 epoch 15/30. Took 0.13676 seconds. 
  Full-batch training loss = 0.414882, test loss = 0.437719
  Training set accuracy = 0.897000, Test set accuracy = 0.883100
 epoch 16/30. Took 0.13756 seconds. 
  Full-batch training loss = 0.401583, test loss = 0.429748
  Training set accuracy = 0.897000, Test set accuracy = 0.884000
 epoch 17/30. Took 0.13632 seconds. 
  Full-batch training loss = 0.388656, test loss = 0.418526
  Training set accuracy = 0.902500, Test set accuracy = 0.886100
 epoch 18/30. Took 0.14685 seconds. 
  Full-batch training loss = 0.377478, test loss = 0.411521
  Training set accuracy = 0.907500, Test set accuracy = 0.886100
 epoch 19/30. Took 0.13711 seconds. 
  Full-batch training loss = 0.366771, test loss = 0.404739
  Training set accuracy = 0.906500, Test set accuracy = 0.887000
 epoch 20/30. Took 0.13448 seconds. 
  Full-batch training loss = 0.356788, test loss = 0.398238
  Training set accuracy = 0.910000, Test set accuracy = 0.888400
 epoch 21/30. Took 0.13512 seconds. 
  Full-batch training loss = 0.346626, test loss = 0.391162
  Training set accuracy = 0.911500, Test set accuracy = 0.890200
 epoch 22/30. Took 0.13557 seconds. 
  Full-batch training loss = 0.337574, test loss = 0.386043
  Training set accuracy = 0.916500, Test set accuracy = 0.891600
 epoch 23/30. Took 0.13457 seconds. 
  Full-batch training loss = 0.329349, test loss = 0.380589
  Training set accuracy = 0.917500, Test set accuracy = 0.892800
 epoch 24/30. Took 0.13915 seconds. 
  Full-batch training loss = 0.321651, test loss = 0.376557
  Training set accuracy = 0.919000, Test set accuracy = 0.892800
 epoch 25/30. Took 0.14199 seconds. 
  Full-batch training loss = 0.314064, test loss = 0.372379
  Training set accuracy = 0.921500, Test set accuracy = 0.893900
 epoch 26/30. Took 0.1389 seconds. 
  Full-batch training loss = 0.308070, test loss = 0.370770
  Training set accuracy = 0.920500, Test set accuracy = 0.893600
 epoch 27/30. Took 0.13568 seconds. 
  Full-batch training loss = 0.300440, test loss = 0.365408
  Training set accuracy = 0.921500, Test set accuracy = 0.895900
 epoch 28/30. Took 0.15306 seconds. 
  Full-batch training loss = 0.293605, test loss = 0.362809
  Training set accuracy = 0.926000, Test set accuracy = 0.895200
 epoch 29/30. Took 0.13484 seconds. 
  Full-batch training loss = 0.288178, test loss = 0.359742
  Training set accuracy = 0.926000, Test set accuracy = 0.896600
 epoch 30/30. Took 0.14451 seconds. 
  Full-batch training loss = 0.282096, test loss = 0.355786
  Training set accuracy = 0.930500, Test set accuracy = 0.897800
Elapsed time is 14.478409 seconds.
End Training
-----
Params 2000 0.010 0.10 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.053925 seconds. 
  Full-batch training loss = 2.180556, test loss = 2.181312
  Training set accuracy = 0.426000, Test set accuracy = 0.400600
 epoch 2/30. Took 0.055811 seconds. 
  Full-batch training loss = 1.987711, test loss = 1.990369
  Training set accuracy = 0.558000, Test set accuracy = 0.537000
 epoch 3/30. Took 0.053063 seconds. 
  Full-batch training loss = 1.708306, test loss = 1.711032
  Training set accuracy = 0.641000, Test set accuracy = 0.631700
 epoch 4/30. Took 0.052954 seconds. 
  Full-batch training loss = 1.369415, test loss = 1.371760
  Training set accuracy = 0.713500, Test set accuracy = 0.709200
 epoch 5/30. Took 0.047934 seconds. 
  Full-batch training loss = 1.060168, test loss = 1.062661
  Training set accuracy = 0.788000, Test set accuracy = 0.791800
 epoch 6/30. Took 0.048649 seconds. 
  Full-batch training loss = 0.839846, test loss = 0.848283
  Training set accuracy = 0.833500, Test set accuracy = 0.826200
 epoch 7/30. Took 0.048896 seconds. 
  Full-batch training loss = 0.699402, test loss = 0.717544
  Training set accuracy = 0.857000, Test set accuracy = 0.845300
 epoch 8/30. Took 0.048879 seconds. 
  Full-batch training loss = 0.605323, test loss = 0.628283
  Training set accuracy = 0.869500, Test set accuracy = 0.850800
 epoch 9/30. Took 0.050322 seconds. 
  Full-batch training loss = 0.542473, test loss = 0.576354
  Training set accuracy = 0.878000, Test set accuracy = 0.856900
 epoch 10/30. Took 0.050339 seconds. 
  Full-batch training loss = 0.488758, test loss = 0.526867
  Training set accuracy = 0.888000, Test set accuracy = 0.867700
 epoch 11/30. Took 0.049317 seconds. 
  Full-batch training loss = 0.450747, test loss = 0.496227
  Training set accuracy = 0.888500, Test set accuracy = 0.869900
 epoch 12/30. Took 0.050347 seconds. 
  Full-batch training loss = 0.422104, test loss = 0.474472
  Training set accuracy = 0.897000, Test set accuracy = 0.871800
 epoch 13/30. Took 0.049557 seconds. 
  Full-batch training loss = 0.393861, test loss = 0.453200
  Training set accuracy = 0.902500, Test set accuracy = 0.876500
 epoch 14/30. Took 0.047486 seconds. 
  Full-batch training loss = 0.372672, test loss = 0.436179
  Training set accuracy = 0.907000, Test set accuracy = 0.879600
 epoch 15/30. Took 0.046372 seconds. 
  Full-batch training loss = 0.358600, test loss = 0.426318
  Training set accuracy = 0.904000, Test set accuracy = 0.880300
 epoch 16/30. Took 0.047645 seconds. 
  Full-batch training loss = 0.340055, test loss = 0.414104
  Training set accuracy = 0.913500, Test set accuracy = 0.882900
 epoch 17/30. Took 0.048883 seconds. 
  Full-batch training loss = 0.324286, test loss = 0.406583
  Training set accuracy = 0.913000, Test set accuracy = 0.884400
 epoch 18/30. Took 0.046047 seconds. 
  Full-batch training loss = 0.311982, test loss = 0.398818
  Training set accuracy = 0.918000, Test set accuracy = 0.885100
 epoch 19/30. Took 0.049322 seconds. 
  Full-batch training loss = 0.300897, test loss = 0.390372
  Training set accuracy = 0.919500, Test set accuracy = 0.886200
 epoch 20/30. Took 0.049222 seconds. 
  Full-batch training loss = 0.288733, test loss = 0.384204
  Training set accuracy = 0.921500, Test set accuracy = 0.888800
 epoch 21/30. Took 0.04918 seconds. 
  Full-batch training loss = 0.280047, test loss = 0.378815
  Training set accuracy = 0.921500, Test set accuracy = 0.888500
 epoch 22/30. Took 0.048978 seconds. 
  Full-batch training loss = 0.270272, test loss = 0.374919
  Training set accuracy = 0.928000, Test set accuracy = 0.889800
 epoch 23/30. Took 0.0481 seconds. 
  Full-batch training loss = 0.263210, test loss = 0.373607
  Training set accuracy = 0.930500, Test set accuracy = 0.888700
 epoch 24/30. Took 0.049876 seconds. 
  Full-batch training loss = 0.250750, test loss = 0.364036
  Training set accuracy = 0.933500, Test set accuracy = 0.893000
 epoch 25/30. Took 0.049197 seconds. 
  Full-batch training loss = 0.243753, test loss = 0.358632
  Training set accuracy = 0.931000, Test set accuracy = 0.892900
 epoch 26/30. Took 0.049169 seconds. 
  Full-batch training loss = 0.236677, test loss = 0.356612
  Training set accuracy = 0.935000, Test set accuracy = 0.895000
 epoch 27/30. Took 0.046465 seconds. 
  Full-batch training loss = 0.231407, test loss = 0.354189
  Training set accuracy = 0.937500, Test set accuracy = 0.893900
 epoch 28/30. Took 0.047761 seconds. 
  Full-batch training loss = 0.222844, test loss = 0.350787
  Training set accuracy = 0.939500, Test set accuracy = 0.894900
 epoch 29/30. Took 0.055579 seconds. 
  Full-batch training loss = 0.219674, test loss = 0.348798
  Training set accuracy = 0.939500, Test set accuracy = 0.896700
 epoch 30/30. Took 0.0504 seconds. 
  Full-batch training loss = 0.210611, test loss = 0.346140
  Training set accuracy = 0.944000, Test set accuracy = 0.896300
Elapsed time is 5.713106 seconds.
End Training
-----
Params 2000 0.010 0.10 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.09372 seconds. 
  Full-batch training loss = 2.182484, test loss = 2.180480
  Training set accuracy = 0.232000, Test set accuracy = 0.233500
 epoch 2/30. Took 0.086976 seconds. 
  Full-batch training loss = 1.995170, test loss = 1.991911
  Training set accuracy = 0.514000, Test set accuracy = 0.502000
 epoch 3/30. Took 0.087519 seconds. 
  Full-batch training loss = 1.711346, test loss = 1.703394
  Training set accuracy = 0.666500, Test set accuracy = 0.660800
 epoch 4/30. Took 0.084901 seconds. 
  Full-batch training loss = 1.349261, test loss = 1.331881
  Training set accuracy = 0.738000, Test set accuracy = 0.743800
 epoch 5/30. Took 0.085765 seconds. 
  Full-batch training loss = 1.038574, test loss = 1.015178
  Training set accuracy = 0.772000, Test set accuracy = 0.780800
 epoch 6/30. Took 0.084165 seconds. 
  Full-batch training loss = 0.835124, test loss = 0.812982
  Training set accuracy = 0.796500, Test set accuracy = 0.806100
 epoch 7/30. Took 0.082659 seconds. 
  Full-batch training loss = 0.704512, test loss = 0.684843
  Training set accuracy = 0.833500, Test set accuracy = 0.831500
 epoch 8/30. Took 0.085934 seconds. 
  Full-batch training loss = 0.617005, test loss = 0.602446
  Training set accuracy = 0.851000, Test set accuracy = 0.842900
 epoch 9/30. Took 0.1061 seconds. 
  Full-batch training loss = 0.552907, test loss = 0.543635
  Training set accuracy = 0.866500, Test set accuracy = 0.858700
 epoch 10/30. Took 0.092879 seconds. 
  Full-batch training loss = 0.505133, test loss = 0.501919
  Training set accuracy = 0.875000, Test set accuracy = 0.867200
 epoch 11/30. Took 0.087551 seconds. 
  Full-batch training loss = 0.470240, test loss = 0.474824
  Training set accuracy = 0.879500, Test set accuracy = 0.871600
 epoch 12/30. Took 0.088852 seconds. 
  Full-batch training loss = 0.440120, test loss = 0.451904
  Training set accuracy = 0.889000, Test set accuracy = 0.873100
 epoch 13/30. Took 0.087315 seconds. 
  Full-batch training loss = 0.416094, test loss = 0.432344
  Training set accuracy = 0.895000, Test set accuracy = 0.880000
 epoch 14/30. Took 0.083456 seconds. 
  Full-batch training loss = 0.396910, test loss = 0.421371
  Training set accuracy = 0.900000, Test set accuracy = 0.881800
 epoch 15/30. Took 0.088133 seconds. 
  Full-batch training loss = 0.373385, test loss = 0.404563
  Training set accuracy = 0.904500, Test set accuracy = 0.888400
 epoch 16/30. Took 0.084388 seconds. 
  Full-batch training loss = 0.361205, test loss = 0.399651
  Training set accuracy = 0.903500, Test set accuracy = 0.886700
 epoch 17/30. Took 0.083613 seconds. 
  Full-batch training loss = 0.342688, test loss = 0.387100
  Training set accuracy = 0.906500, Test set accuracy = 0.890700
 epoch 18/30. Took 0.086805 seconds. 
  Full-batch training loss = 0.326627, test loss = 0.376448
  Training set accuracy = 0.914000, Test set accuracy = 0.893500
 epoch 19/30. Took 0.085427 seconds. 
  Full-batch training loss = 0.311411, test loss = 0.364673
  Training set accuracy = 0.919000, Test set accuracy = 0.895600
 epoch 20/30. Took 0.083091 seconds. 
  Full-batch training loss = 0.305950, test loss = 0.361376
  Training set accuracy = 0.920500, Test set accuracy = 0.895900
 epoch 21/30. Took 0.084548 seconds. 
  Full-batch training loss = 0.290515, test loss = 0.351123
  Training set accuracy = 0.927500, Test set accuracy = 0.898300
 epoch 22/30. Took 0.082722 seconds. 
  Full-batch training loss = 0.281090, test loss = 0.347693
  Training set accuracy = 0.931000, Test set accuracy = 0.899200
 epoch 23/30. Took 0.084212 seconds. 
  Full-batch training loss = 0.271581, test loss = 0.344847
  Training set accuracy = 0.930000, Test set accuracy = 0.901000
 epoch 24/30. Took 0.082332 seconds. 
  Full-batch training loss = 0.260953, test loss = 0.338006
  Training set accuracy = 0.932500, Test set accuracy = 0.900700
 epoch 25/30. Took 0.087321 seconds. 
  Full-batch training loss = 0.253994, test loss = 0.336853
  Training set accuracy = 0.934000, Test set accuracy = 0.902500
 epoch 26/30. Took 0.088005 seconds. 
  Full-batch training loss = 0.246802, test loss = 0.335122
  Training set accuracy = 0.932500, Test set accuracy = 0.901900
 epoch 27/30. Took 0.088531 seconds. 
  Full-batch training loss = 0.238142, test loss = 0.330682
  Training set accuracy = 0.936500, Test set accuracy = 0.903200
 epoch 28/30. Took 0.088153 seconds. 
  Full-batch training loss = 0.229293, test loss = 0.324690
  Training set accuracy = 0.944500, Test set accuracy = 0.906400
 epoch 29/30. Took 0.086941 seconds. 
  Full-batch training loss = 0.222266, test loss = 0.320312
  Training set accuracy = 0.944000, Test set accuracy = 0.905900
 epoch 30/30. Took 0.088562 seconds. 
  Full-batch training loss = 0.215018, test loss = 0.318377
  Training set accuracy = 0.946500, Test set accuracy = 0.906300
Elapsed time is 9.283393 seconds.
End Training
-----
Params 2000 0.010 0.10 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23578 seconds. 
  Full-batch training loss = 2.116914, test loss = 2.122811
  Training set accuracy = 0.553500, Test set accuracy = 0.539000
 epoch 2/30. Took 0.2402 seconds. 
  Full-batch training loss = 1.815768, test loss = 1.828546
  Training set accuracy = 0.680500, Test set accuracy = 0.666100
 epoch 3/30. Took 0.23212 seconds. 
  Full-batch training loss = 1.415237, test loss = 1.431333
  Training set accuracy = 0.751500, Test set accuracy = 0.738200
 epoch 4/30. Took 0.2553 seconds. 
  Full-batch training loss = 1.048518, test loss = 1.067183
  Training set accuracy = 0.824000, Test set accuracy = 0.806200
 epoch 5/30. Took 0.2446 seconds. 
  Full-batch training loss = 0.813193, test loss = 0.831396
  Training set accuracy = 0.821500, Test set accuracy = 0.810600
 epoch 6/30. Took 0.24135 seconds. 
  Full-batch training loss = 0.670419, test loss = 0.693698
  Training set accuracy = 0.857500, Test set accuracy = 0.842500
 epoch 7/30. Took 0.22857 seconds. 
  Full-batch training loss = 0.580966, test loss = 0.612125
  Training set accuracy = 0.869000, Test set accuracy = 0.850700
 epoch 8/30. Took 0.22965 seconds. 
  Full-batch training loss = 0.515499, test loss = 0.552802
  Training set accuracy = 0.882000, Test set accuracy = 0.861100
 epoch 9/30. Took 0.22603 seconds. 
  Full-batch training loss = 0.467394, test loss = 0.505090
  Training set accuracy = 0.890500, Test set accuracy = 0.868900
 epoch 10/30. Took 0.22763 seconds. 
  Full-batch training loss = 0.429477, test loss = 0.475543
  Training set accuracy = 0.897500, Test set accuracy = 0.874000
 epoch 11/30. Took 0.27144 seconds. 
  Full-batch training loss = 0.396953, test loss = 0.445247
  Training set accuracy = 0.900000, Test set accuracy = 0.880400
 epoch 12/30. Took 0.22821 seconds. 
  Full-batch training loss = 0.373990, test loss = 0.426723
  Training set accuracy = 0.906000, Test set accuracy = 0.883000
 epoch 13/30. Took 0.23099 seconds. 
  Full-batch training loss = 0.348854, test loss = 0.409972
  Training set accuracy = 0.909500, Test set accuracy = 0.887800
 epoch 14/30. Took 0.22927 seconds. 
  Full-batch training loss = 0.330399, test loss = 0.400552
  Training set accuracy = 0.915500, Test set accuracy = 0.888300
 epoch 15/30. Took 0.23172 seconds. 
  Full-batch training loss = 0.311256, test loss = 0.388761
  Training set accuracy = 0.917500, Test set accuracy = 0.891100
 epoch 16/30. Took 0.22721 seconds. 
  Full-batch training loss = 0.296041, test loss = 0.375893
  Training set accuracy = 0.921500, Test set accuracy = 0.894600
 epoch 17/30. Took 0.23803 seconds. 
  Full-batch training loss = 0.283573, test loss = 0.369796
  Training set accuracy = 0.929500, Test set accuracy = 0.894300
 epoch 18/30. Took 0.22731 seconds. 
  Full-batch training loss = 0.268999, test loss = 0.361776
  Training set accuracy = 0.932500, Test set accuracy = 0.899700
 epoch 19/30. Took 0.233 seconds. 
  Full-batch training loss = 0.259168, test loss = 0.360939
  Training set accuracy = 0.935500, Test set accuracy = 0.898800
 epoch 20/30. Took 0.22819 seconds. 
  Full-batch training loss = 0.248676, test loss = 0.352775
  Training set accuracy = 0.943000, Test set accuracy = 0.901600
 epoch 21/30. Took 0.25718 seconds. 
  Full-batch training loss = 0.239523, test loss = 0.349549
  Training set accuracy = 0.944000, Test set accuracy = 0.900700
 epoch 22/30. Took 0.2314 seconds. 
  Full-batch training loss = 0.234553, test loss = 0.350100
  Training set accuracy = 0.940500, Test set accuracy = 0.899500
 epoch 23/30. Took 0.23579 seconds. 
  Full-batch training loss = 0.227559, test loss = 0.345624
  Training set accuracy = 0.945000, Test set accuracy = 0.899300
 epoch 24/30. Took 0.22659 seconds. 
  Full-batch training loss = 0.212543, test loss = 0.335865
  Training set accuracy = 0.952000, Test set accuracy = 0.902300
 epoch 25/30. Took 0.23566 seconds. 
  Full-batch training loss = 0.207017, test loss = 0.334168
  Training set accuracy = 0.953500, Test set accuracy = 0.903200
 epoch 26/30. Took 0.22819 seconds. 
  Full-batch training loss = 0.199380, test loss = 0.330002
  Training set accuracy = 0.955000, Test set accuracy = 0.904600
 epoch 27/30. Took 0.2632 seconds. 
  Full-batch training loss = 0.192048, test loss = 0.328852
  Training set accuracy = 0.955500, Test set accuracy = 0.904100
 epoch 28/30. Took 0.23242 seconds. 
  Full-batch training loss = 0.185289, test loss = 0.326280
  Training set accuracy = 0.960500, Test set accuracy = 0.905000
 epoch 29/30. Took 0.2388 seconds. 
  Full-batch training loss = 0.180811, test loss = 0.326062
  Training set accuracy = 0.959500, Test set accuracy = 0.904700
 epoch 30/30. Took 0.24032 seconds. 
  Full-batch training loss = 0.175451, test loss = 0.322898
  Training set accuracy = 0.956500, Test set accuracy = 0.905000
Elapsed time is 23.293563 seconds.
End Training
-----
Params 2000 0.010 0.10 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.059982 seconds. 
  Full-batch training loss = 2.257118, test loss = 2.259807
  Training set accuracy = 0.160000, Test set accuracy = 0.153600
 epoch 2/30. Took 0.061061 seconds. 
  Full-batch training loss = 2.188994, test loss = 2.193923
  Training set accuracy = 0.298500, Test set accuracy = 0.289100
 epoch 3/30. Took 0.061696 seconds. 
  Full-batch training loss = 2.083634, test loss = 2.091205
  Training set accuracy = 0.433500, Test set accuracy = 0.405900
 epoch 4/30. Took 0.060997 seconds. 
  Full-batch training loss = 1.914274, test loss = 1.922630
  Training set accuracy = 0.554000, Test set accuracy = 0.533800
 epoch 5/30. Took 0.05908 seconds. 
  Full-batch training loss = 1.661429, test loss = 1.672829
  Training set accuracy = 0.593500, Test set accuracy = 0.584100
 epoch 6/30. Took 0.060398 seconds. 
  Full-batch training loss = 1.346386, test loss = 1.360560
  Training set accuracy = 0.668000, Test set accuracy = 0.660500
 epoch 7/30. Took 0.059972 seconds. 
  Full-batch training loss = 1.064399, test loss = 1.083024
  Training set accuracy = 0.737000, Test set accuracy = 0.733400
 epoch 8/30. Took 0.059524 seconds. 
  Full-batch training loss = 0.869591, test loss = 0.892363
  Training set accuracy = 0.785000, Test set accuracy = 0.781400
 epoch 9/30. Took 0.059187 seconds. 
  Full-batch training loss = 0.745735, test loss = 0.772569
  Training set accuracy = 0.803000, Test set accuracy = 0.794200
 epoch 10/30. Took 0.059158 seconds. 
  Full-batch training loss = 0.656948, test loss = 0.683337
  Training set accuracy = 0.817500, Test set accuracy = 0.806300
 epoch 11/30. Took 0.06085 seconds. 
  Full-batch training loss = 0.584434, test loss = 0.619990
  Training set accuracy = 0.844500, Test set accuracy = 0.827100
 epoch 12/30. Took 0.059727 seconds. 
  Full-batch training loss = 0.532130, test loss = 0.574574
  Training set accuracy = 0.857000, Test set accuracy = 0.835700
 epoch 13/30. Took 0.059652 seconds. 
  Full-batch training loss = 0.488375, test loss = 0.537179
  Training set accuracy = 0.874500, Test set accuracy = 0.846100
 epoch 14/30. Took 0.059801 seconds. 
  Full-batch training loss = 0.454159, test loss = 0.505645
  Training set accuracy = 0.871000, Test set accuracy = 0.852800
 epoch 15/30. Took 0.060635 seconds. 
  Full-batch training loss = 0.422957, test loss = 0.480885
  Training set accuracy = 0.888500, Test set accuracy = 0.860600
 epoch 16/30. Took 0.060555 seconds. 
  Full-batch training loss = 0.400077, test loss = 0.466100
  Training set accuracy = 0.891000, Test set accuracy = 0.862900
 epoch 17/30. Took 0.059749 seconds. 
  Full-batch training loss = 0.385097, test loss = 0.460777
  Training set accuracy = 0.896500, Test set accuracy = 0.864600
 epoch 18/30. Took 0.059683 seconds. 
  Full-batch training loss = 0.353854, test loss = 0.432102
  Training set accuracy = 0.902000, Test set accuracy = 0.873100
 epoch 19/30. Took 0.061593 seconds. 
  Full-batch training loss = 0.340113, test loss = 0.423716
  Training set accuracy = 0.903000, Test set accuracy = 0.873800
 epoch 20/30. Took 0.060861 seconds. 
  Full-batch training loss = 0.321608, test loss = 0.407238
  Training set accuracy = 0.912000, Test set accuracy = 0.880100
 epoch 21/30. Took 0.059857 seconds. 
  Full-batch training loss = 0.307461, test loss = 0.396990
  Training set accuracy = 0.919000, Test set accuracy = 0.882200
 epoch 22/30. Took 0.056709 seconds. 
  Full-batch training loss = 0.300586, test loss = 0.397894
  Training set accuracy = 0.920500, Test set accuracy = 0.882800
 epoch 23/30. Took 0.055076 seconds. 
  Full-batch training loss = 0.286030, test loss = 0.384383
  Training set accuracy = 0.919500, Test set accuracy = 0.886400
 epoch 24/30. Took 0.058139 seconds. 
  Full-batch training loss = 0.272036, test loss = 0.377007
  Training set accuracy = 0.920500, Test set accuracy = 0.888100
 epoch 25/30. Took 0.06103 seconds. 
  Full-batch training loss = 0.262227, test loss = 0.368705
  Training set accuracy = 0.925500, Test set accuracy = 0.890600
 epoch 26/30. Took 0.058974 seconds. 
  Full-batch training loss = 0.253613, test loss = 0.361098
  Training set accuracy = 0.929000, Test set accuracy = 0.890800
 epoch 27/30. Took 0.060409 seconds. 
  Full-batch training loss = 0.244117, test loss = 0.359505
  Training set accuracy = 0.930000, Test set accuracy = 0.892900
 epoch 28/30. Took 0.056766 seconds. 
  Full-batch training loss = 0.237934, test loss = 0.352095
  Training set accuracy = 0.937000, Test set accuracy = 0.893900
 epoch 29/30. Took 0.061699 seconds. 
  Full-batch training loss = 0.229423, test loss = 0.349841
  Training set accuracy = 0.939500, Test set accuracy = 0.897600
 epoch 30/30. Took 0.0616 seconds. 
  Full-batch training loss = 0.219781, test loss = 0.347727
  Training set accuracy = 0.940000, Test set accuracy = 0.896600
Elapsed time is 6.687469 seconds.
End Training
-----
Params 2000 0.010 0.10 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.10659 seconds. 
  Full-batch training loss = 2.235144, test loss = 2.235022
  Training set accuracy = 0.227500, Test set accuracy = 0.223800
 epoch 2/30. Took 0.1042 seconds. 
  Full-batch training loss = 2.119075, test loss = 2.116411
  Training set accuracy = 0.463500, Test set accuracy = 0.459400
 epoch 3/30. Took 0.10053 seconds. 
  Full-batch training loss = 1.923978, test loss = 1.915143
  Training set accuracy = 0.582500, Test set accuracy = 0.583800
 epoch 4/30. Took 0.10551 seconds. 
  Full-batch training loss = 1.599384, test loss = 1.583860
  Training set accuracy = 0.637000, Test set accuracy = 0.642900
 epoch 5/30. Took 0.12001 seconds. 
  Full-batch training loss = 1.229818, test loss = 1.215426
  Training set accuracy = 0.737500, Test set accuracy = 0.734000
 epoch 6/30. Took 0.10282 seconds. 
  Full-batch training loss = 0.943797, test loss = 0.933168
  Training set accuracy = 0.782000, Test set accuracy = 0.782300
 epoch 7/30. Took 0.10753 seconds. 
  Full-batch training loss = 0.765933, test loss = 0.763051
  Training set accuracy = 0.813000, Test set accuracy = 0.812300
 epoch 8/30. Took 0.10415 seconds. 
  Full-batch training loss = 0.657442, test loss = 0.664670
  Training set accuracy = 0.821000, Test set accuracy = 0.816400
 epoch 9/30. Took 0.10703 seconds. 
  Full-batch training loss = 0.576337, test loss = 0.590290
  Training set accuracy = 0.846000, Test set accuracy = 0.832300
 epoch 10/30. Took 0.10617 seconds. 
  Full-batch training loss = 0.523865, test loss = 0.549247
  Training set accuracy = 0.862500, Test set accuracy = 0.849100
 epoch 11/30. Took 0.10389 seconds. 
  Full-batch training loss = 0.487835, test loss = 0.517486
  Training set accuracy = 0.867500, Test set accuracy = 0.848100
 epoch 12/30. Took 0.10354 seconds. 
  Full-batch training loss = 0.444910, test loss = 0.487946
  Training set accuracy = 0.877500, Test set accuracy = 0.859000
 epoch 13/30. Took 0.10712 seconds. 
  Full-batch training loss = 0.412167, test loss = 0.459463
  Training set accuracy = 0.897500, Test set accuracy = 0.870600
 epoch 14/30. Took 0.099457 seconds. 
  Full-batch training loss = 0.393974, test loss = 0.456063
  Training set accuracy = 0.894500, Test set accuracy = 0.871400
 epoch 15/30. Took 0.10966 seconds. 
  Full-batch training loss = 0.369893, test loss = 0.437882
  Training set accuracy = 0.901000, Test set accuracy = 0.873900
 epoch 16/30. Took 0.10816 seconds. 
  Full-batch training loss = 0.352160, test loss = 0.428260
  Training set accuracy = 0.901500, Test set accuracy = 0.874300
 epoch 17/30. Took 0.1081 seconds. 
  Full-batch training loss = 0.330255, test loss = 0.406124
  Training set accuracy = 0.915000, Test set accuracy = 0.884200
 epoch 18/30. Took 0.10777 seconds. 
  Full-batch training loss = 0.316524, test loss = 0.407588
  Training set accuracy = 0.914000, Test set accuracy = 0.882100
 epoch 19/30. Took 0.10237 seconds. 
  Full-batch training loss = 0.303833, test loss = 0.387662
  Training set accuracy = 0.919500, Test set accuracy = 0.888000
 epoch 20/30. Took 0.10296 seconds. 
  Full-batch training loss = 0.288179, test loss = 0.387579
  Training set accuracy = 0.925000, Test set accuracy = 0.887700
 epoch 21/30. Took 0.10654 seconds. 
  Full-batch training loss = 0.274061, test loss = 0.371745
  Training set accuracy = 0.926500, Test set accuracy = 0.891200
 epoch 22/30. Took 0.10237 seconds. 
  Full-batch training loss = 0.261695, test loss = 0.365140
  Training set accuracy = 0.931500, Test set accuracy = 0.893100
 epoch 23/30. Took 0.10086 seconds. 
  Full-batch training loss = 0.256227, test loss = 0.366882
  Training set accuracy = 0.928500, Test set accuracy = 0.892100
 epoch 24/30. Took 0.10222 seconds. 
  Full-batch training loss = 0.243214, test loss = 0.361588
  Training set accuracy = 0.929000, Test set accuracy = 0.895000
 epoch 25/30. Took 0.10817 seconds. 
  Full-batch training loss = 0.230552, test loss = 0.349235
  Training set accuracy = 0.935000, Test set accuracy = 0.898000
 epoch 26/30. Took 0.10815 seconds. 
  Full-batch training loss = 0.222049, test loss = 0.346716
  Training set accuracy = 0.938500, Test set accuracy = 0.898000
 epoch 27/30. Took 0.1078 seconds. 
  Full-batch training loss = 0.216764, test loss = 0.346291
  Training set accuracy = 0.941500, Test set accuracy = 0.896800
 epoch 28/30. Took 0.10457 seconds. 
  Full-batch training loss = 0.211991, test loss = 0.340751
  Training set accuracy = 0.937500, Test set accuracy = 0.897200
 epoch 29/30. Took 0.103 seconds. 
  Full-batch training loss = 0.200610, test loss = 0.335454
  Training set accuracy = 0.945000, Test set accuracy = 0.900900
 epoch 30/30. Took 0.10254 seconds. 
  Full-batch training loss = 0.191853, test loss = 0.331736
  Training set accuracy = 0.946000, Test set accuracy = 0.900900
Elapsed time is 11.704145 seconds.
End Training
-----
Params 2000 0.010 0.10 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32784 seconds. 
  Full-batch training loss = 2.226950, test loss = 2.228988
  Training set accuracy = 0.379500, Test set accuracy = 0.371500
 epoch 2/30. Took 0.35704 seconds. 
  Full-batch training loss = 2.098634, test loss = 2.103847
  Training set accuracy = 0.525500, Test set accuracy = 0.507100
 epoch 3/30. Took 0.32416 seconds. 
  Full-batch training loss = 1.877145, test loss = 1.885345
  Training set accuracy = 0.582500, Test set accuracy = 0.564600
 epoch 4/30. Took 0.32147 seconds. 
  Full-batch training loss = 1.502618, test loss = 1.514276
  Training set accuracy = 0.677500, Test set accuracy = 0.653500
 epoch 5/30. Took 0.32106 seconds. 
  Full-batch training loss = 1.099007, test loss = 1.113784
  Training set accuracy = 0.773000, Test set accuracy = 0.752400
 epoch 6/30. Took 0.33112 seconds. 
  Full-batch training loss = 0.831502, test loss = 0.850739
  Training set accuracy = 0.827500, Test set accuracy = 0.807900
 epoch 7/30. Took 0.32384 seconds. 
  Full-batch training loss = 0.668084, test loss = 0.696317
  Training set accuracy = 0.846000, Test set accuracy = 0.821800
 epoch 8/30. Took 0.36424 seconds. 
  Full-batch training loss = 0.567912, test loss = 0.603538
  Training set accuracy = 0.866500, Test set accuracy = 0.842300
 epoch 9/30. Took 0.325 seconds. 
  Full-batch training loss = 0.498889, test loss = 0.543564
  Training set accuracy = 0.877000, Test set accuracy = 0.850200
 epoch 10/30. Took 0.33725 seconds. 
  Full-batch training loss = 0.447655, test loss = 0.501612
  Training set accuracy = 0.890500, Test set accuracy = 0.860900
 epoch 11/30. Took 0.32498 seconds. 
  Full-batch training loss = 0.406420, test loss = 0.467929
  Training set accuracy = 0.893500, Test set accuracy = 0.870900
 epoch 12/30. Took 0.33458 seconds. 
  Full-batch training loss = 0.382502, test loss = 0.455669
  Training set accuracy = 0.895500, Test set accuracy = 0.866800
 epoch 13/30. Took 0.354 seconds. 
  Full-batch training loss = 0.346665, test loss = 0.417784
  Training set accuracy = 0.904500, Test set accuracy = 0.884300
 epoch 14/30. Took 0.32807 seconds. 
  Full-batch training loss = 0.335314, test loss = 0.418359
  Training set accuracy = 0.902000, Test set accuracy = 0.878000
 epoch 15/30. Took 0.33042 seconds. 
  Full-batch training loss = 0.307257, test loss = 0.389711
  Training set accuracy = 0.911500, Test set accuracy = 0.890000
 epoch 16/30. Took 0.3276 seconds. 
  Full-batch training loss = 0.289846, test loss = 0.383662
  Training set accuracy = 0.917500, Test set accuracy = 0.889000
 epoch 17/30. Took 0.33486 seconds. 
  Full-batch training loss = 0.276475, test loss = 0.384664
  Training set accuracy = 0.920000, Test set accuracy = 0.886400
 epoch 18/30. Took 0.32419 seconds. 
  Full-batch training loss = 0.268275, test loss = 0.378973
  Training set accuracy = 0.926000, Test set accuracy = 0.886100
 epoch 19/30. Took 0.33044 seconds. 
  Full-batch training loss = 0.252323, test loss = 0.366346
  Training set accuracy = 0.926500, Test set accuracy = 0.893700
 epoch 20/30. Took 0.35416 seconds. 
  Full-batch training loss = 0.234336, test loss = 0.355047
  Training set accuracy = 0.931500, Test set accuracy = 0.897300
 epoch 21/30. Took 0.32433 seconds. 
  Full-batch training loss = 0.226069, test loss = 0.353280
  Training set accuracy = 0.939000, Test set accuracy = 0.897300
 epoch 22/30. Took 0.32083 seconds. 
  Full-batch training loss = 0.210523, test loss = 0.341258
  Training set accuracy = 0.940500, Test set accuracy = 0.904000
 epoch 23/30. Took 0.33263 seconds. 
  Full-batch training loss = 0.206742, test loss = 0.347862
  Training set accuracy = 0.944500, Test set accuracy = 0.899700
 epoch 24/30. Took 0.32116 seconds. 
  Full-batch training loss = 0.191508, test loss = 0.331411
  Training set accuracy = 0.946500, Test set accuracy = 0.905200
 epoch 25/30. Took 0.34801 seconds. 
  Full-batch training loss = 0.181273, test loss = 0.327446
  Training set accuracy = 0.952000, Test set accuracy = 0.906400
 epoch 26/30. Took 0.32291 seconds. 
  Full-batch training loss = 0.177732, test loss = 0.331126
  Training set accuracy = 0.952500, Test set accuracy = 0.906800
 epoch 27/30. Took 0.33819 seconds. 
  Full-batch training loss = 0.168240, test loss = 0.328348
  Training set accuracy = 0.956000, Test set accuracy = 0.906300
 epoch 28/30. Took 0.32374 seconds. 
  Full-batch training loss = 0.159265, test loss = 0.320672
  Training set accuracy = 0.958500, Test set accuracy = 0.910300
 epoch 29/30. Took 0.33083 seconds. 
  Full-batch training loss = 0.150941, test loss = 0.319101
  Training set accuracy = 0.964000, Test set accuracy = 0.907600
 epoch 30/30. Took 0.32337 seconds. 
  Full-batch training loss = 0.144269, test loss = 0.317843
  Training set accuracy = 0.962000, Test set accuracy = 0.908700
Elapsed time is 32.200069 seconds.
End Training
-----
Params 2000 0.010 0.20 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.040549 seconds. 
  Full-batch training loss = 2.089793, test loss = 2.090909
  Training set accuracy = 0.428000, Test set accuracy = 0.426500
 epoch 2/30. Took 0.040202 seconds. 
  Full-batch training loss = 1.797279, test loss = 1.795678
  Training set accuracy = 0.626500, Test set accuracy = 0.633800
 epoch 3/30. Took 0.040067 seconds. 
  Full-batch training loss = 1.485237, test loss = 1.478752
  Training set accuracy = 0.749500, Test set accuracy = 0.749100
 epoch 4/30. Took 0.04235 seconds. 
  Full-batch training loss = 1.217422, test loss = 1.208734
  Training set accuracy = 0.798500, Test set accuracy = 0.797200
 epoch 5/30. Took 0.03823 seconds. 
  Full-batch training loss = 1.017166, test loss = 1.009707
  Training set accuracy = 0.832500, Test set accuracy = 0.828400
 epoch 6/30. Took 0.039368 seconds. 
  Full-batch training loss = 0.875062, test loss = 0.870229
  Training set accuracy = 0.839500, Test set accuracy = 0.839900
 epoch 7/30. Took 0.038309 seconds. 
  Full-batch training loss = 0.774161, test loss = 0.772397
  Training set accuracy = 0.855000, Test set accuracy = 0.849600
 epoch 8/30. Took 0.038108 seconds. 
  Full-batch training loss = 0.696505, test loss = 0.699527
  Training set accuracy = 0.865500, Test set accuracy = 0.856300
 epoch 9/30. Took 0.039372 seconds. 
  Full-batch training loss = 0.637892, test loss = 0.642920
  Training set accuracy = 0.870000, Test set accuracy = 0.861700
 epoch 10/30. Took 0.038171 seconds. 
  Full-batch training loss = 0.591586, test loss = 0.600123
  Training set accuracy = 0.876500, Test set accuracy = 0.866800
 epoch 11/30. Took 0.038159 seconds. 
  Full-batch training loss = 0.553912, test loss = 0.567653
  Training set accuracy = 0.879000, Test set accuracy = 0.872100
 epoch 12/30. Took 0.039332 seconds. 
  Full-batch training loss = 0.523005, test loss = 0.540014
  Training set accuracy = 0.884500, Test set accuracy = 0.873400
 epoch 13/30. Took 0.036329 seconds. 
  Full-batch training loss = 0.498625, test loss = 0.518778
  Training set accuracy = 0.889000, Test set accuracy = 0.877100
 epoch 14/30. Took 0.037029 seconds. 
  Full-batch training loss = 0.474501, test loss = 0.497469
  Training set accuracy = 0.890000, Test set accuracy = 0.880300
 epoch 15/30. Took 0.039485 seconds. 
  Full-batch training loss = 0.454919, test loss = 0.481160
  Training set accuracy = 0.893000, Test set accuracy = 0.880000
 epoch 16/30. Took 0.038054 seconds. 
  Full-batch training loss = 0.436952, test loss = 0.468969
  Training set accuracy = 0.896500, Test set accuracy = 0.882300
 epoch 17/30. Took 0.038245 seconds. 
  Full-batch training loss = 0.422034, test loss = 0.454968
  Training set accuracy = 0.899500, Test set accuracy = 0.883300
 epoch 18/30. Took 0.039876 seconds. 
  Full-batch training loss = 0.406852, test loss = 0.442677
  Training set accuracy = 0.904500, Test set accuracy = 0.887400
 epoch 19/30. Took 0.038046 seconds. 
  Full-batch training loss = 0.393490, test loss = 0.433251
  Training set accuracy = 0.902500, Test set accuracy = 0.889000
 epoch 20/30. Took 0.038798 seconds. 
  Full-batch training loss = 0.382105, test loss = 0.425470
  Training set accuracy = 0.910000, Test set accuracy = 0.892000
 epoch 21/30. Took 0.039434 seconds. 
  Full-batch training loss = 0.371211, test loss = 0.417448
  Training set accuracy = 0.905500, Test set accuracy = 0.891400
 epoch 22/30. Took 0.038229 seconds. 
  Full-batch training loss = 0.361012, test loss = 0.410592
  Training set accuracy = 0.910500, Test set accuracy = 0.894100
 epoch 23/30. Took 0.038474 seconds. 
  Full-batch training loss = 0.352602, test loss = 0.402811
  Training set accuracy = 0.915500, Test set accuracy = 0.894400
 epoch 24/30. Took 0.038135 seconds. 
  Full-batch training loss = 0.342224, test loss = 0.397541
  Training set accuracy = 0.911500, Test set accuracy = 0.894700
 epoch 25/30. Took 0.036733 seconds. 
  Full-batch training loss = 0.334173, test loss = 0.391934
  Training set accuracy = 0.920000, Test set accuracy = 0.897300
 epoch 26/30. Took 0.037672 seconds. 
  Full-batch training loss = 0.326843, test loss = 0.387503
  Training set accuracy = 0.922000, Test set accuracy = 0.895000
 epoch 27/30. Took 0.039738 seconds. 
  Full-batch training loss = 0.318713, test loss = 0.383112
  Training set accuracy = 0.922500, Test set accuracy = 0.897400
 epoch 28/30. Took 0.038104 seconds. 
  Full-batch training loss = 0.312373, test loss = 0.378132
  Training set accuracy = 0.922500, Test set accuracy = 0.897400
 epoch 29/30. Took 0.038029 seconds. 
  Full-batch training loss = 0.304671, test loss = 0.373398
  Training set accuracy = 0.925000, Test set accuracy = 0.900200
 epoch 30/30. Took 0.040179 seconds. 
  Full-batch training loss = 0.298748, test loss = 0.368938
  Training set accuracy = 0.928000, Test set accuracy = 0.902000
Elapsed time is 5.048173 seconds.
End Training
-----
Params 2000 0.010 0.20 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.06739 seconds. 
  Full-batch training loss = 2.065279, test loss = 2.077756
  Training set accuracy = 0.507500, Test set accuracy = 0.470900
 epoch 2/30. Took 0.059532 seconds. 
  Full-batch training loss = 1.750436, test loss = 1.771354
  Training set accuracy = 0.671000, Test set accuracy = 0.645400
 epoch 3/30. Took 0.060725 seconds. 
  Full-batch training loss = 1.422337, test loss = 1.449301
  Training set accuracy = 0.759500, Test set accuracy = 0.737600
 epoch 4/30. Took 0.062973 seconds. 
  Full-batch training loss = 1.151697, test loss = 1.182728
  Training set accuracy = 0.800000, Test set accuracy = 0.778200
 epoch 5/30. Took 0.063508 seconds. 
  Full-batch training loss = 0.956104, test loss = 0.986823
  Training set accuracy = 0.833000, Test set accuracy = 0.816400
 epoch 6/30. Took 0.073645 seconds. 
  Full-batch training loss = 0.822038, test loss = 0.855820
  Training set accuracy = 0.838000, Test set accuracy = 0.822500
 epoch 7/30. Took 0.063597 seconds. 
  Full-batch training loss = 0.726838, test loss = 0.761627
  Training set accuracy = 0.850000, Test set accuracy = 0.834100
 epoch 8/30. Took 0.061603 seconds. 
  Full-batch training loss = 0.656682, test loss = 0.694506
  Training set accuracy = 0.860000, Test set accuracy = 0.844100
 epoch 9/30. Took 0.066876 seconds. 
  Full-batch training loss = 0.605079, test loss = 0.646669
  Training set accuracy = 0.861500, Test set accuracy = 0.847600
 epoch 10/30. Took 0.061553 seconds. 
  Full-batch training loss = 0.563346, test loss = 0.605454
  Training set accuracy = 0.866500, Test set accuracy = 0.853300
 epoch 11/30. Took 0.06139 seconds. 
  Full-batch training loss = 0.529216, test loss = 0.574808
  Training set accuracy = 0.872500, Test set accuracy = 0.858000
 epoch 12/30. Took 0.070411 seconds. 
  Full-batch training loss = 0.499921, test loss = 0.547722
  Training set accuracy = 0.878500, Test set accuracy = 0.864100
 epoch 13/30. Took 0.060367 seconds. 
  Full-batch training loss = 0.477269, test loss = 0.529012
  Training set accuracy = 0.881500, Test set accuracy = 0.863200
 epoch 14/30. Took 0.06291 seconds. 
  Full-batch training loss = 0.455464, test loss = 0.507910
  Training set accuracy = 0.883500, Test set accuracy = 0.870600
 epoch 15/30. Took 0.062862 seconds. 
  Full-batch training loss = 0.437233, test loss = 0.492207
  Training set accuracy = 0.888000, Test set accuracy = 0.870700
 epoch 16/30. Took 0.061814 seconds. 
  Full-batch training loss = 0.421091, test loss = 0.477902
  Training set accuracy = 0.887000, Test set accuracy = 0.872300
 epoch 17/30. Took 0.063607 seconds. 
  Full-batch training loss = 0.406689, test loss = 0.466344
  Training set accuracy = 0.892000, Test set accuracy = 0.876000
 epoch 18/30. Took 0.06902 seconds. 
  Full-batch training loss = 0.393506, test loss = 0.455756
  Training set accuracy = 0.896000, Test set accuracy = 0.877700
 epoch 19/30. Took 0.061181 seconds. 
  Full-batch training loss = 0.383863, test loss = 0.448203
  Training set accuracy = 0.894500, Test set accuracy = 0.877400
 epoch 20/30. Took 0.062334 seconds. 
  Full-batch training loss = 0.371809, test loss = 0.437303
  Training set accuracy = 0.898000, Test set accuracy = 0.881500
 epoch 21/30. Took 0.06889 seconds. 
  Full-batch training loss = 0.362429, test loss = 0.431832
  Training set accuracy = 0.906500, Test set accuracy = 0.884100
 epoch 22/30. Took 0.061582 seconds. 
  Full-batch training loss = 0.352936, test loss = 0.422210
  Training set accuracy = 0.899500, Test set accuracy = 0.883200
 epoch 23/30. Took 0.063373 seconds. 
  Full-batch training loss = 0.344711, test loss = 0.416818
  Training set accuracy = 0.912000, Test set accuracy = 0.886100
 epoch 24/30. Took 0.061988 seconds. 
  Full-batch training loss = 0.336121, test loss = 0.410142
  Training set accuracy = 0.908000, Test set accuracy = 0.884700
 epoch 25/30. Took 0.060633 seconds. 
  Full-batch training loss = 0.328428, test loss = 0.406204
  Training set accuracy = 0.909500, Test set accuracy = 0.885900
 epoch 26/30. Took 0.07172 seconds. 
  Full-batch training loss = 0.321519, test loss = 0.400455
  Training set accuracy = 0.909500, Test set accuracy = 0.887900
 epoch 27/30. Took 0.062376 seconds. 
  Full-batch training loss = 0.314661, test loss = 0.394758
  Training set accuracy = 0.914000, Test set accuracy = 0.889200
 epoch 28/30. Took 0.059519 seconds. 
  Full-batch training loss = 0.308372, test loss = 0.389722
  Training set accuracy = 0.914000, Test set accuracy = 0.891200
 epoch 29/30. Took 0.060363 seconds. 
  Full-batch training loss = 0.302865, test loss = 0.387587
  Training set accuracy = 0.914000, Test set accuracy = 0.889800
 epoch 30/30. Took 0.062802 seconds. 
  Full-batch training loss = 0.296986, test loss = 0.382383
  Training set accuracy = 0.917000, Test set accuracy = 0.892200
Elapsed time is 7.345602 seconds.
End Training
-----
Params 2000 0.010 0.20 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14133 seconds. 
  Full-batch training loss = 1.960355, test loss = 1.974502
  Training set accuracy = 0.556000, Test set accuracy = 0.532000
 epoch 2/30. Took 0.13526 seconds. 
  Full-batch training loss = 1.585495, test loss = 1.602776
  Training set accuracy = 0.738000, Test set accuracy = 0.706700
 epoch 3/30. Took 0.1361 seconds. 
  Full-batch training loss = 1.259189, test loss = 1.280592
  Training set accuracy = 0.786000, Test set accuracy = 0.763900
 epoch 4/30. Took 0.13668 seconds. 
  Full-batch training loss = 1.015227, test loss = 1.040288
  Training set accuracy = 0.810500, Test set accuracy = 0.791500
 epoch 5/30. Took 0.13355 seconds. 
  Full-batch training loss = 0.849641, test loss = 0.880596
  Training set accuracy = 0.827000, Test set accuracy = 0.807000
 epoch 6/30. Took 0.13731 seconds. 
  Full-batch training loss = 0.734158, test loss = 0.768836
  Training set accuracy = 0.850000, Test set accuracy = 0.827000
 epoch 7/30. Took 0.13328 seconds. 
  Full-batch training loss = 0.652623, test loss = 0.691643
  Training set accuracy = 0.860000, Test set accuracy = 0.836900
 epoch 8/30. Took 0.13531 seconds. 
  Full-batch training loss = 0.592823, test loss = 0.637892
  Training set accuracy = 0.865500, Test set accuracy = 0.847000
 epoch 9/30. Took 0.13758 seconds. 
  Full-batch training loss = 0.544835, test loss = 0.593931
  Training set accuracy = 0.879000, Test set accuracy = 0.852000
 epoch 10/30. Took 0.13527 seconds. 
  Full-batch training loss = 0.508130, test loss = 0.561103
  Training set accuracy = 0.883500, Test set accuracy = 0.860400
 epoch 11/30. Took 0.14584 seconds. 
  Full-batch training loss = 0.476206, test loss = 0.532296
  Training set accuracy = 0.888500, Test set accuracy = 0.864900
 epoch 12/30. Took 0.13307 seconds. 
  Full-batch training loss = 0.452359, test loss = 0.513304
  Training set accuracy = 0.897000, Test set accuracy = 0.867700
 epoch 13/30. Took 0.13941 seconds. 
  Full-batch training loss = 0.428900, test loss = 0.492893
  Training set accuracy = 0.899000, Test set accuracy = 0.873200
 epoch 14/30. Took 0.13846 seconds. 
  Full-batch training loss = 0.410185, test loss = 0.478319
  Training set accuracy = 0.904500, Test set accuracy = 0.876600
 epoch 15/30. Took 0.14535 seconds. 
  Full-batch training loss = 0.394346, test loss = 0.464411
  Training set accuracy = 0.907000, Test set accuracy = 0.878100
 epoch 16/30. Took 0.14019 seconds. 
  Full-batch training loss = 0.382554, test loss = 0.457544
  Training set accuracy = 0.905500, Test set accuracy = 0.876000
 epoch 17/30. Took 0.13678 seconds. 
  Full-batch training loss = 0.365754, test loss = 0.441434
  Training set accuracy = 0.911000, Test set accuracy = 0.883700
 epoch 18/30. Took 0.14402 seconds. 
  Full-batch training loss = 0.354818, test loss = 0.434839
  Training set accuracy = 0.910000, Test set accuracy = 0.882700
 epoch 19/30. Took 0.13575 seconds. 
  Full-batch training loss = 0.342898, test loss = 0.426854
  Training set accuracy = 0.914500, Test set accuracy = 0.883700
 epoch 20/30. Took 0.13754 seconds. 
  Full-batch training loss = 0.333872, test loss = 0.421939
  Training set accuracy = 0.918500, Test set accuracy = 0.886600
 epoch 21/30. Took 0.13593 seconds. 
  Full-batch training loss = 0.323638, test loss = 0.412199
  Training set accuracy = 0.921000, Test set accuracy = 0.889400
 epoch 22/30. Took 0.13679 seconds. 
  Full-batch training loss = 0.315449, test loss = 0.408050
  Training set accuracy = 0.921000, Test set accuracy = 0.888300
 epoch 23/30. Took 0.13863 seconds. 
  Full-batch training loss = 0.307276, test loss = 0.400950
  Training set accuracy = 0.923000, Test set accuracy = 0.890800
 epoch 24/30. Took 0.13581 seconds. 
  Full-batch training loss = 0.300061, test loss = 0.396300
  Training set accuracy = 0.924500, Test set accuracy = 0.891100
 epoch 25/30. Took 0.14107 seconds. 
  Full-batch training loss = 0.292912, test loss = 0.391646
  Training set accuracy = 0.926500, Test set accuracy = 0.892500
 epoch 26/30. Took 0.14318 seconds. 
  Full-batch training loss = 0.286031, test loss = 0.388051
  Training set accuracy = 0.928500, Test set accuracy = 0.893600
 epoch 27/30. Took 0.13418 seconds. 
  Full-batch training loss = 0.280101, test loss = 0.384467
  Training set accuracy = 0.927000, Test set accuracy = 0.893800
 epoch 28/30. Took 0.13624 seconds. 
  Full-batch training loss = 0.273956, test loss = 0.380312
  Training set accuracy = 0.932500, Test set accuracy = 0.895400
 epoch 29/30. Took 0.13951 seconds. 
  Full-batch training loss = 0.268912, test loss = 0.377255
  Training set accuracy = 0.932000, Test set accuracy = 0.896700
 epoch 30/30. Took 0.13849 seconds. 
  Full-batch training loss = 0.263780, test loss = 0.375641
  Training set accuracy = 0.932000, Test set accuracy = 0.895900
Elapsed time is 14.517503 seconds.
End Training
-----
Params 2000 0.010 0.20 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.053554 seconds. 
  Full-batch training loss = 2.249328, test loss = 2.248175
  Training set accuracy = 0.203000, Test set accuracy = 0.181900
 epoch 2/30. Took 0.049599 seconds. 
  Full-batch training loss = 2.160845, test loss = 2.159806
  Training set accuracy = 0.469000, Test set accuracy = 0.470000
 epoch 3/30. Took 0.049808 seconds. 
  Full-batch training loss = 2.036942, test loss = 2.036326
  Training set accuracy = 0.607500, Test set accuracy = 0.597000
 epoch 4/30. Took 0.051669 seconds. 
  Full-batch training loss = 1.853262, test loss = 1.850246
  Training set accuracy = 0.660000, Test set accuracy = 0.668300
 epoch 5/30. Took 0.048409 seconds. 
  Full-batch training loss = 1.617869, test loss = 1.612492
  Training set accuracy = 0.701500, Test set accuracy = 0.706600
 epoch 6/30. Took 0.048376 seconds. 
  Full-batch training loss = 1.365817, test loss = 1.357573
  Training set accuracy = 0.750000, Test set accuracy = 0.750500
 epoch 7/30. Took 0.049061 seconds. 
  Full-batch training loss = 1.142577, test loss = 1.133967
  Training set accuracy = 0.777500, Test set accuracy = 0.785900
 epoch 8/30. Took 0.049177 seconds. 
  Full-batch training loss = 0.962342, test loss = 0.957160
  Training set accuracy = 0.802500, Test set accuracy = 0.802800
 epoch 9/30. Took 0.049169 seconds. 
  Full-batch training loss = 0.834053, test loss = 0.832574
  Training set accuracy = 0.825000, Test set accuracy = 0.815800
 epoch 10/30. Took 0.047881 seconds. 
  Full-batch training loss = 0.740513, test loss = 0.744717
  Training set accuracy = 0.834000, Test set accuracy = 0.828000
 epoch 11/30. Took 0.05165 seconds. 
  Full-batch training loss = 0.664807, test loss = 0.675446
  Training set accuracy = 0.850500, Test set accuracy = 0.839500
 epoch 12/30. Took 0.049696 seconds. 
  Full-batch training loss = 0.609991, test loss = 0.625903
  Training set accuracy = 0.861500, Test set accuracy = 0.843300
 epoch 13/30. Took 0.050518 seconds. 
  Full-batch training loss = 0.562476, test loss = 0.584677
  Training set accuracy = 0.867000, Test set accuracy = 0.851100
 epoch 14/30. Took 0.048496 seconds. 
  Full-batch training loss = 0.526036, test loss = 0.550373
  Training set accuracy = 0.871500, Test set accuracy = 0.859900
 epoch 15/30. Took 0.049269 seconds. 
  Full-batch training loss = 0.497558, test loss = 0.529825
  Training set accuracy = 0.873000, Test set accuracy = 0.859000
 epoch 16/30. Took 0.04995 seconds. 
  Full-batch training loss = 0.469990, test loss = 0.506199
  Training set accuracy = 0.886500, Test set accuracy = 0.865800
 epoch 17/30. Took 0.048923 seconds. 
  Full-batch training loss = 0.446549, test loss = 0.490645
  Training set accuracy = 0.887000, Test set accuracy = 0.870500
 epoch 18/30. Took 0.056967 seconds. 
  Full-batch training loss = 0.424866, test loss = 0.469133
  Training set accuracy = 0.891500, Test set accuracy = 0.871200
 epoch 19/30. Took 0.048544 seconds. 
  Full-batch training loss = 0.404911, test loss = 0.458482
  Training set accuracy = 0.897500, Test set accuracy = 0.874900
 epoch 20/30. Took 0.05136 seconds. 
  Full-batch training loss = 0.389199, test loss = 0.448289
  Training set accuracy = 0.898000, Test set accuracy = 0.878400
 epoch 21/30. Took 0.051441 seconds. 
  Full-batch training loss = 0.373929, test loss = 0.435064
  Training set accuracy = 0.908500, Test set accuracy = 0.877700
 epoch 22/30. Took 0.0506 seconds. 
  Full-batch training loss = 0.361479, test loss = 0.423791
  Training set accuracy = 0.906000, Test set accuracy = 0.882000
 epoch 23/30. Took 0.050382 seconds. 
  Full-batch training loss = 0.351048, test loss = 0.418470
  Training set accuracy = 0.908000, Test set accuracy = 0.881600
 epoch 24/30. Took 0.049138 seconds. 
  Full-batch training loss = 0.339992, test loss = 0.411893
  Training set accuracy = 0.913500, Test set accuracy = 0.884500
 epoch 25/30. Took 0.04911 seconds. 
  Full-batch training loss = 0.327189, test loss = 0.404506
  Training set accuracy = 0.916500, Test set accuracy = 0.883800
 epoch 26/30. Took 0.049326 seconds. 
  Full-batch training loss = 0.317023, test loss = 0.395353
  Training set accuracy = 0.918500, Test set accuracy = 0.887700
 epoch 27/30. Took 0.048899 seconds. 
  Full-batch training loss = 0.307088, test loss = 0.393842
  Training set accuracy = 0.922500, Test set accuracy = 0.885500
 epoch 28/30. Took 0.046065 seconds. 
  Full-batch training loss = 0.299618, test loss = 0.384525
  Training set accuracy = 0.920000, Test set accuracy = 0.888200
 epoch 29/30. Took 0.04614 seconds. 
  Full-batch training loss = 0.293593, test loss = 0.386028
  Training set accuracy = 0.926000, Test set accuracy = 0.886800
 epoch 30/30. Took 0.046003 seconds. 
  Full-batch training loss = 0.285085, test loss = 0.381941
  Training set accuracy = 0.926500, Test set accuracy = 0.889200
Elapsed time is 5.733203 seconds.
End Training
-----
Params 2000 0.010 0.20 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.089731 seconds. 
  Full-batch training loss = 2.215625, test loss = 2.221003
  Training set accuracy = 0.300000, Test set accuracy = 0.285000
 epoch 2/30. Took 0.098415 seconds. 
  Full-batch training loss = 2.069586, test loss = 2.078667
  Training set accuracy = 0.525000, Test set accuracy = 0.486600
 epoch 3/30. Took 0.088152 seconds. 
  Full-batch training loss = 1.865242, test loss = 1.876129
  Training set accuracy = 0.623000, Test set accuracy = 0.591900
 epoch 4/30. Took 0.088052 seconds. 
  Full-batch training loss = 1.597555, test loss = 1.606822
  Training set accuracy = 0.674500, Test set accuracy = 0.659100
 epoch 5/30. Took 0.088563 seconds. 
  Full-batch training loss = 1.309889, test loss = 1.315588
  Training set accuracy = 0.718500, Test set accuracy = 0.722900
 epoch 6/30. Took 0.086561 seconds. 
  Full-batch training loss = 1.065664, test loss = 1.071466
  Training set accuracy = 0.754500, Test set accuracy = 0.763900
 epoch 7/30. Took 0.086713 seconds. 
  Full-batch training loss = 0.887427, test loss = 0.891031
  Training set accuracy = 0.792500, Test set accuracy = 0.792700
 epoch 8/30. Took 0.086647 seconds. 
  Full-batch training loss = 0.763827, test loss = 0.771397
  Training set accuracy = 0.811500, Test set accuracy = 0.812300
 epoch 9/30. Took 0.086345 seconds. 
  Full-batch training loss = 0.679133, test loss = 0.688508
  Training set accuracy = 0.824500, Test set accuracy = 0.829500
 epoch 10/30. Took 0.08191 seconds. 
  Full-batch training loss = 0.617232, test loss = 0.632166
  Training set accuracy = 0.840000, Test set accuracy = 0.837900
 epoch 11/30. Took 0.087643 seconds. 
  Full-batch training loss = 0.568223, test loss = 0.588554
  Training set accuracy = 0.848500, Test set accuracy = 0.845100
 epoch 12/30. Took 0.094014 seconds. 
  Full-batch training loss = 0.531932, test loss = 0.558257
  Training set accuracy = 0.851500, Test set accuracy = 0.851100
 epoch 13/30. Took 0.099417 seconds. 
  Full-batch training loss = 0.501385, test loss = 0.529624
  Training set accuracy = 0.859000, Test set accuracy = 0.858200
 epoch 14/30. Took 0.085315 seconds. 
  Full-batch training loss = 0.472228, test loss = 0.508803
  Training set accuracy = 0.873500, Test set accuracy = 0.862700
 epoch 15/30. Took 0.08808 seconds. 
  Full-batch training loss = 0.448317, test loss = 0.486222
  Training set accuracy = 0.876500, Test set accuracy = 0.868600
 epoch 16/30. Took 0.081557 seconds. 
  Full-batch training loss = 0.429555, test loss = 0.476182
  Training set accuracy = 0.881000, Test set accuracy = 0.869600
 epoch 17/30. Took 0.098211 seconds. 
  Full-batch training loss = 0.409691, test loss = 0.458862
  Training set accuracy = 0.885500, Test set accuracy = 0.874400
 epoch 18/30. Took 0.093184 seconds. 
  Full-batch training loss = 0.393073, test loss = 0.444982
  Training set accuracy = 0.887500, Test set accuracy = 0.875800
 epoch 19/30. Took 0.084999 seconds. 
  Full-batch training loss = 0.376607, test loss = 0.433126
  Training set accuracy = 0.895000, Test set accuracy = 0.881000
 epoch 20/30. Took 0.087526 seconds. 
  Full-batch training loss = 0.361898, test loss = 0.425349
  Training set accuracy = 0.897500, Test set accuracy = 0.884600
 epoch 21/30. Took 0.086502 seconds. 
  Full-batch training loss = 0.349730, test loss = 0.413154
  Training set accuracy = 0.901500, Test set accuracy = 0.887600
 epoch 22/30. Took 0.096915 seconds. 
  Full-batch training loss = 0.336661, test loss = 0.407253
  Training set accuracy = 0.905500, Test set accuracy = 0.886100
 epoch 23/30. Took 0.087007 seconds. 
  Full-batch training loss = 0.331500, test loss = 0.406530
  Training set accuracy = 0.901000, Test set accuracy = 0.886900
 epoch 24/30. Took 0.084353 seconds. 
  Full-batch training loss = 0.314588, test loss = 0.392168
  Training set accuracy = 0.909000, Test set accuracy = 0.892500
 epoch 25/30. Took 0.087941 seconds. 
  Full-batch training loss = 0.306926, test loss = 0.391362
  Training set accuracy = 0.913000, Test set accuracy = 0.887900
 epoch 26/30. Took 0.08708 seconds. 
  Full-batch training loss = 0.293827, test loss = 0.380805
  Training set accuracy = 0.917500, Test set accuracy = 0.894700
 epoch 27/30. Took 0.088463 seconds. 
  Full-batch training loss = 0.288356, test loss = 0.378700
  Training set accuracy = 0.916000, Test set accuracy = 0.892900
 epoch 28/30. Took 0.086608 seconds. 
  Full-batch training loss = 0.276609, test loss = 0.372011
  Training set accuracy = 0.924500, Test set accuracy = 0.896000
 epoch 29/30. Took 0.086183 seconds. 
  Full-batch training loss = 0.271958, test loss = 0.372239
  Training set accuracy = 0.924500, Test set accuracy = 0.896400
 epoch 30/30. Took 0.086456 seconds. 
  Full-batch training loss = 0.263093, test loss = 0.367286
  Training set accuracy = 0.925500, Test set accuracy = 0.895400
Elapsed time is 9.412735 seconds.
End Training
-----
Params 2000 0.010 0.20 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.232 seconds. 
  Full-batch training loss = 2.150105, test loss = 2.156983
  Training set accuracy = 0.491000, Test set accuracy = 0.475500
 epoch 2/30. Took 0.23401 seconds. 
  Full-batch training loss = 1.942456, test loss = 1.954111
  Training set accuracy = 0.676000, Test set accuracy = 0.637400
 epoch 3/30. Took 0.22999 seconds. 
  Full-batch training loss = 1.666044, test loss = 1.680517
  Training set accuracy = 0.740000, Test set accuracy = 0.715000
 epoch 4/30. Took 0.23232 seconds. 
  Full-batch training loss = 1.342300, test loss = 1.356953
  Training set accuracy = 0.793000, Test set accuracy = 0.768400
 epoch 5/30. Took 0.25316 seconds. 
  Full-batch training loss = 1.057784, test loss = 1.072930
  Training set accuracy = 0.807500, Test set accuracy = 0.785300
 epoch 6/30. Took 0.26234 seconds. 
  Full-batch training loss = 0.857394, test loss = 0.871475
  Training set accuracy = 0.823000, Test set accuracy = 0.808800
 epoch 7/30. Took 0.23338 seconds. 
  Full-batch training loss = 0.726485, test loss = 0.746269
  Training set accuracy = 0.832500, Test set accuracy = 0.819900
 epoch 8/30. Took 0.24404 seconds. 
  Full-batch training loss = 0.638122, test loss = 0.659358
  Training set accuracy = 0.848500, Test set accuracy = 0.829200
 epoch 9/30. Took 0.23182 seconds. 
  Full-batch training loss = 0.570484, test loss = 0.596501
  Training set accuracy = 0.866000, Test set accuracy = 0.844600
 epoch 10/30. Took 0.23252 seconds. 
  Full-batch training loss = 0.523026, test loss = 0.553329
  Training set accuracy = 0.875500, Test set accuracy = 0.854100
 epoch 11/30. Took 0.23603 seconds. 
  Full-batch training loss = 0.483499, test loss = 0.519475
  Training set accuracy = 0.885000, Test set accuracy = 0.857300
 epoch 12/30. Took 0.23731 seconds. 
  Full-batch training loss = 0.452326, test loss = 0.492743
  Training set accuracy = 0.888500, Test set accuracy = 0.865300
 epoch 13/30. Took 0.23975 seconds. 
  Full-batch training loss = 0.425485, test loss = 0.468338
  Training set accuracy = 0.894000, Test set accuracy = 0.871000
 epoch 14/30. Took 0.23211 seconds. 
  Full-batch training loss = 0.401328, test loss = 0.447940
  Training set accuracy = 0.900000, Test set accuracy = 0.875900
 epoch 15/30. Took 0.23256 seconds. 
  Full-batch training loss = 0.385847, test loss = 0.436124
  Training set accuracy = 0.899500, Test set accuracy = 0.878200
 epoch 16/30. Took 0.23131 seconds. 
  Full-batch training loss = 0.367457, test loss = 0.423892
  Training set accuracy = 0.903000, Test set accuracy = 0.879800
 epoch 17/30. Took 0.2322 seconds. 
  Full-batch training loss = 0.358446, test loss = 0.415868
  Training set accuracy = 0.902500, Test set accuracy = 0.880800
 epoch 18/30. Took 0.23302 seconds. 
  Full-batch training loss = 0.338130, test loss = 0.401248
  Training set accuracy = 0.909500, Test set accuracy = 0.884000
 epoch 19/30. Took 0.23036 seconds. 
  Full-batch training loss = 0.328402, test loss = 0.394067
  Training set accuracy = 0.910500, Test set accuracy = 0.886700
 epoch 20/30. Took 0.2315 seconds. 
  Full-batch training loss = 0.315017, test loss = 0.383582
  Training set accuracy = 0.913500, Test set accuracy = 0.888800
 epoch 21/30. Took 0.26504 seconds. 
  Full-batch training loss = 0.303316, test loss = 0.378609
  Training set accuracy = 0.919000, Test set accuracy = 0.889700
 epoch 22/30. Took 0.24839 seconds. 
  Full-batch training loss = 0.300474, test loss = 0.377711
  Training set accuracy = 0.920000, Test set accuracy = 0.888900
 epoch 23/30. Took 0.23523 seconds. 
  Full-batch training loss = 0.284052, test loss = 0.366081
  Training set accuracy = 0.921500, Test set accuracy = 0.894100
 epoch 24/30. Took 0.24837 seconds. 
  Full-batch training loss = 0.275876, test loss = 0.361887
  Training set accuracy = 0.925500, Test set accuracy = 0.895200
 epoch 25/30. Took 0.23231 seconds. 
  Full-batch training loss = 0.272109, test loss = 0.362245
  Training set accuracy = 0.926000, Test set accuracy = 0.893000
 epoch 26/30. Took 0.2283 seconds. 
  Full-batch training loss = 0.263308, test loss = 0.357418
  Training set accuracy = 0.928000, Test set accuracy = 0.894000
 epoch 27/30. Took 0.22877 seconds. 
  Full-batch training loss = 0.251849, test loss = 0.349669
  Training set accuracy = 0.934000, Test set accuracy = 0.895100
 epoch 28/30. Took 0.22827 seconds. 
  Full-batch training loss = 0.246474, test loss = 0.345978
  Training set accuracy = 0.935500, Test set accuracy = 0.896800
 epoch 29/30. Took 0.23209 seconds. 
  Full-batch training loss = 0.238155, test loss = 0.344098
  Training set accuracy = 0.937000, Test set accuracy = 0.898700
 epoch 30/30. Took 0.23175 seconds. 
  Full-batch training loss = 0.233680, test loss = 0.341855
  Training set accuracy = 0.937000, Test set accuracy = 0.895900
Elapsed time is 23.340015 seconds.
End Training
-----
Params 2000 0.010 0.20 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.066048 seconds. 
  Full-batch training loss = 2.274693, test loss = 2.276282
  Training set accuracy = 0.206500, Test set accuracy = 0.210200
 epoch 2/30. Took 0.06189 seconds. 
  Full-batch training loss = 2.222104, test loss = 2.225577
  Training set accuracy = 0.345500, Test set accuracy = 0.326600
 epoch 3/30. Took 0.059904 seconds. 
  Full-batch training loss = 2.148142, test loss = 2.153266
  Training set accuracy = 0.407000, Test set accuracy = 0.387400
 epoch 4/30. Took 0.06027 seconds. 
  Full-batch training loss = 2.041692, test loss = 2.049135
  Training set accuracy = 0.442500, Test set accuracy = 0.422600
 epoch 5/30. Took 0.05776 seconds. 
  Full-batch training loss = 1.902300, test loss = 1.911913
  Training set accuracy = 0.494000, Test set accuracy = 0.473600
 epoch 6/30. Took 0.060619 seconds. 
  Full-batch training loss = 1.732331, test loss = 1.745388
  Training set accuracy = 0.536000, Test set accuracy = 0.517300
 epoch 7/30. Took 0.059427 seconds. 
  Full-batch training loss = 1.524049, test loss = 1.540820
  Training set accuracy = 0.597000, Test set accuracy = 0.570700
 epoch 8/30. Took 0.055286 seconds. 
  Full-batch training loss = 1.300821, test loss = 1.321909
  Training set accuracy = 0.624500, Test set accuracy = 0.608600
 epoch 9/30. Took 0.060964 seconds. 
  Full-batch training loss = 1.109700, test loss = 1.132964
  Training set accuracy = 0.681000, Test set accuracy = 0.658400
 epoch 10/30. Took 0.060484 seconds. 
  Full-batch training loss = 0.968154, test loss = 0.997191
  Training set accuracy = 0.743500, Test set accuracy = 0.719300
 epoch 11/30. Took 0.059913 seconds. 
  Full-batch training loss = 0.847635, test loss = 0.878496
  Training set accuracy = 0.763000, Test set accuracy = 0.751700
 epoch 12/30. Took 0.057929 seconds. 
  Full-batch training loss = 0.766435, test loss = 0.796791
  Training set accuracy = 0.794500, Test set accuracy = 0.779600
 epoch 13/30. Took 0.059448 seconds. 
  Full-batch training loss = 0.706945, test loss = 0.742330
  Training set accuracy = 0.813500, Test set accuracy = 0.806300
 epoch 14/30. Took 0.060805 seconds. 
  Full-batch training loss = 0.659193, test loss = 0.693920
  Training set accuracy = 0.825000, Test set accuracy = 0.813900
 epoch 15/30. Took 0.060823 seconds. 
  Full-batch training loss = 0.612289, test loss = 0.649313
  Training set accuracy = 0.847000, Test set accuracy = 0.827600
 epoch 16/30. Took 0.060538 seconds. 
  Full-batch training loss = 0.575365, test loss = 0.611603
  Training set accuracy = 0.855000, Test set accuracy = 0.837000
 epoch 17/30. Took 0.062 seconds. 
  Full-batch training loss = 0.549973, test loss = 0.588813
  Training set accuracy = 0.869500, Test set accuracy = 0.848700
 epoch 18/30. Took 0.061091 seconds. 
  Full-batch training loss = 0.517671, test loss = 0.562002
  Training set accuracy = 0.871500, Test set accuracy = 0.848300
 epoch 19/30. Took 0.061863 seconds. 
  Full-batch training loss = 0.492885, test loss = 0.539502
  Training set accuracy = 0.877500, Test set accuracy = 0.856300
 epoch 20/30. Took 0.063039 seconds. 
  Full-batch training loss = 0.466823, test loss = 0.513667
  Training set accuracy = 0.887500, Test set accuracy = 0.864200
 epoch 21/30. Took 0.062486 seconds. 
  Full-batch training loss = 0.451777, test loss = 0.500582
  Training set accuracy = 0.889500, Test set accuracy = 0.867100
 epoch 22/30. Took 0.065431 seconds. 
  Full-batch training loss = 0.439437, test loss = 0.491980
  Training set accuracy = 0.891500, Test set accuracy = 0.868200
 epoch 23/30. Took 0.060361 seconds. 
  Full-batch training loss = 0.416627, test loss = 0.470883
  Training set accuracy = 0.894500, Test set accuracy = 0.871000
 epoch 24/30. Took 0.059686 seconds. 
  Full-batch training loss = 0.400539, test loss = 0.459874
  Training set accuracy = 0.902000, Test set accuracy = 0.874400
 epoch 25/30. Took 0.058456 seconds. 
  Full-batch training loss = 0.383442, test loss = 0.443711
  Training set accuracy = 0.908000, Test set accuracy = 0.881200
 epoch 26/30. Took 0.058517 seconds. 
  Full-batch training loss = 0.382165, test loss = 0.450858
  Training set accuracy = 0.901500, Test set accuracy = 0.874800
 epoch 27/30. Took 0.0617 seconds. 
  Full-batch training loss = 0.362123, test loss = 0.428241
  Training set accuracy = 0.909000, Test set accuracy = 0.883900
 epoch 28/30. Took 0.059834 seconds. 
  Full-batch training loss = 0.349214, test loss = 0.420901
  Training set accuracy = 0.912500, Test set accuracy = 0.883800
 epoch 29/30. Took 0.060122 seconds. 
  Full-batch training loss = 0.337094, test loss = 0.413826
  Training set accuracy = 0.914000, Test set accuracy = 0.883800
 epoch 30/30. Took 0.059694 seconds. 
  Full-batch training loss = 0.324347, test loss = 0.402338
  Training set accuracy = 0.917500, Test set accuracy = 0.888200
Elapsed time is 6.730390 seconds.
End Training
-----
Params 2000 0.010 0.20 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.10809 seconds. 
  Full-batch training loss = 2.289760, test loss = 2.286347
  Training set accuracy = 0.131000, Test set accuracy = 0.134000
 epoch 2/30. Took 0.10549 seconds. 
  Full-batch training loss = 2.256822, test loss = 2.255098
  Training set accuracy = 0.256000, Test set accuracy = 0.273100
 epoch 3/30. Took 0.10902 seconds. 
  Full-batch training loss = 2.216931, test loss = 2.215888
  Training set accuracy = 0.549500, Test set accuracy = 0.553000
 epoch 4/30. Took 0.10857 seconds. 
  Full-batch training loss = 2.159633, test loss = 2.159346
  Training set accuracy = 0.622000, Test set accuracy = 0.603100
 epoch 5/30. Took 0.10891 seconds. 
  Full-batch training loss = 2.068725, test loss = 2.068842
  Training set accuracy = 0.616500, Test set accuracy = 0.607700
 epoch 6/30. Took 0.11008 seconds. 
  Full-batch training loss = 1.927101, test loss = 1.926965
  Training set accuracy = 0.647000, Test set accuracy = 0.629800
 epoch 7/30. Took 0.11098 seconds. 
  Full-batch training loss = 1.709409, test loss = 1.707488
  Training set accuracy = 0.684500, Test set accuracy = 0.670200
 epoch 8/30. Took 0.12309 seconds. 
  Full-batch training loss = 1.432182, test loss = 1.427600
  Training set accuracy = 0.724000, Test set accuracy = 0.714200
 epoch 9/30. Took 0.11812 seconds. 
  Full-batch training loss = 1.160184, test loss = 1.155676
  Training set accuracy = 0.762000, Test set accuracy = 0.746500
 epoch 10/30. Took 0.10997 seconds. 
  Full-batch training loss = 0.955123, test loss = 0.958826
  Training set accuracy = 0.787000, Test set accuracy = 0.767600
 epoch 11/30. Took 0.12648 seconds. 
  Full-batch training loss = 0.815364, test loss = 0.824357
  Training set accuracy = 0.796500, Test set accuracy = 0.782000
 epoch 12/30. Took 0.10881 seconds. 
  Full-batch training loss = 0.711089, test loss = 0.730641
  Training set accuracy = 0.824000, Test set accuracy = 0.803100
 epoch 13/30. Took 0.11108 seconds. 
  Full-batch training loss = 0.638348, test loss = 0.664330
  Training set accuracy = 0.838000, Test set accuracy = 0.813300
 epoch 14/30. Took 0.10908 seconds. 
  Full-batch training loss = 0.583042, test loss = 0.618456
  Training set accuracy = 0.841500, Test set accuracy = 0.820600
 epoch 15/30. Took 0.10843 seconds. 
  Full-batch training loss = 0.545032, test loss = 0.590419
  Training set accuracy = 0.856500, Test set accuracy = 0.829000
 epoch 16/30. Took 0.10955 seconds. 
  Full-batch training loss = 0.506878, test loss = 0.555395
  Training set accuracy = 0.864500, Test set accuracy = 0.836600
 epoch 17/30. Took 0.10866 seconds. 
  Full-batch training loss = 0.473560, test loss = 0.519575
  Training set accuracy = 0.874000, Test set accuracy = 0.848700
 epoch 18/30. Took 0.10868 seconds. 
  Full-batch training loss = 0.447456, test loss = 0.509141
  Training set accuracy = 0.881500, Test set accuracy = 0.851400
 epoch 19/30. Took 0.105 seconds. 
  Full-batch training loss = 0.426842, test loss = 0.486379
  Training set accuracy = 0.883500, Test set accuracy = 0.853400
 epoch 20/30. Took 0.11007 seconds. 
  Full-batch training loss = 0.403326, test loss = 0.467865
  Training set accuracy = 0.892000, Test set accuracy = 0.862400
 epoch 21/30. Took 0.10814 seconds. 
  Full-batch training loss = 0.385598, test loss = 0.456078
  Training set accuracy = 0.897000, Test set accuracy = 0.868900
 epoch 22/30. Took 0.10987 seconds. 
  Full-batch training loss = 0.376251, test loss = 0.442505
  Training set accuracy = 0.896500, Test set accuracy = 0.870200
 epoch 23/30. Took 0.10868 seconds. 
  Full-batch training loss = 0.356287, test loss = 0.429771
  Training set accuracy = 0.903000, Test set accuracy = 0.875300
 epoch 24/30. Took 0.10875 seconds. 
  Full-batch training loss = 0.344448, test loss = 0.419478
  Training set accuracy = 0.906000, Test set accuracy = 0.877400
 epoch 25/30. Took 0.10872 seconds. 
  Full-batch training loss = 0.329196, test loss = 0.414732
  Training set accuracy = 0.907500, Test set accuracy = 0.878400
 epoch 26/30. Took 0.10931 seconds. 
  Full-batch training loss = 0.318860, test loss = 0.407312
  Training set accuracy = 0.913000, Test set accuracy = 0.880300
 epoch 27/30. Took 0.10884 seconds. 
  Full-batch training loss = 0.307274, test loss = 0.397611
  Training set accuracy = 0.916500, Test set accuracy = 0.882900
 epoch 28/30. Took 0.10657 seconds. 
  Full-batch training loss = 0.295742, test loss = 0.389103
  Training set accuracy = 0.920000, Test set accuracy = 0.886500
 epoch 29/30. Took 0.11779 seconds. 
  Full-batch training loss = 0.284717, test loss = 0.383719
  Training set accuracy = 0.923000, Test set accuracy = 0.887700
 epoch 30/30. Took 0.10801 seconds. 
  Full-batch training loss = 0.277754, test loss = 0.379476
  Training set accuracy = 0.924000, Test set accuracy = 0.888300
Elapsed time is 11.439309 seconds.
End Training
-----
Params 2000 0.010 0.20 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.36849 seconds. 
  Full-batch training loss = 2.265454, test loss = 2.265149
  Training set accuracy = 0.341000, Test set accuracy = 0.345700
 epoch 2/30. Took 0.34414 seconds. 
  Full-batch training loss = 2.213844, test loss = 2.215916
  Training set accuracy = 0.449500, Test set accuracy = 0.416500
 epoch 3/30. Took 0.34492 seconds. 
  Full-batch training loss = 2.144790, test loss = 2.148279
  Training set accuracy = 0.491000, Test set accuracy = 0.467400
 epoch 4/30. Took 0.37653 seconds. 
  Full-batch training loss = 2.037066, test loss = 2.041194
  Training set accuracy = 0.600500, Test set accuracy = 0.573200
 epoch 5/30. Took 0.3661 seconds. 
  Full-batch training loss = 1.856835, test loss = 1.860465
  Training set accuracy = 0.663000, Test set accuracy = 0.644800
 epoch 6/30. Took 0.3225 seconds. 
  Full-batch training loss = 1.588341, test loss = 1.590271
  Training set accuracy = 0.696000, Test set accuracy = 0.683100
 epoch 7/30. Took 0.33108 seconds. 
  Full-batch training loss = 1.257705, test loss = 1.259731
  Training set accuracy = 0.768500, Test set accuracy = 0.766100
 epoch 8/30. Took 0.32485 seconds. 
  Full-batch training loss = 0.972349, test loss = 0.982793
  Training set accuracy = 0.809000, Test set accuracy = 0.792300
 epoch 9/30. Took 0.32399 seconds. 
  Full-batch training loss = 0.779530, test loss = 0.798162
  Training set accuracy = 0.823500, Test set accuracy = 0.815600
 epoch 10/30. Took 0.32641 seconds. 
  Full-batch training loss = 0.653357, test loss = 0.678982
  Training set accuracy = 0.839500, Test set accuracy = 0.831200
 epoch 11/30. Took 0.32515 seconds. 
  Full-batch training loss = 0.570506, test loss = 0.603813
  Training set accuracy = 0.861500, Test set accuracy = 0.841200
 epoch 12/30. Took 0.32189 seconds. 
  Full-batch training loss = 0.505486, test loss = 0.540481
  Training set accuracy = 0.868500, Test set accuracy = 0.851200
 epoch 13/30. Took 0.33139 seconds. 
  Full-batch training loss = 0.460490, test loss = 0.505343
  Training set accuracy = 0.885500, Test set accuracy = 0.859300
 epoch 14/30. Took 0.3628 seconds. 
  Full-batch training loss = 0.428173, test loss = 0.478019
  Training set accuracy = 0.893500, Test set accuracy = 0.863600
 epoch 15/30. Took 0.32402 seconds. 
  Full-batch training loss = 0.403363, test loss = 0.461619
  Training set accuracy = 0.892000, Test set accuracy = 0.864100
 epoch 16/30. Took 0.32666 seconds. 
  Full-batch training loss = 0.377033, test loss = 0.447613
  Training set accuracy = 0.901000, Test set accuracy = 0.867000
 epoch 17/30. Took 0.32668 seconds. 
  Full-batch training loss = 0.354313, test loss = 0.427860
  Training set accuracy = 0.908500, Test set accuracy = 0.871600
 epoch 18/30. Took 0.33349 seconds. 
  Full-batch training loss = 0.338423, test loss = 0.414576
  Training set accuracy = 0.907000, Test set accuracy = 0.876200
 epoch 19/30. Took 0.32509 seconds. 
  Full-batch training loss = 0.322142, test loss = 0.402022
  Training set accuracy = 0.922000, Test set accuracy = 0.879900
 epoch 20/30. Took 0.32366 seconds. 
  Full-batch training loss = 0.307244, test loss = 0.392896
  Training set accuracy = 0.918500, Test set accuracy = 0.880100
 epoch 21/30. Took 0.3452 seconds. 
  Full-batch training loss = 0.290748, test loss = 0.386782
  Training set accuracy = 0.926000, Test set accuracy = 0.881500
 epoch 22/30. Took 0.32032 seconds. 
  Full-batch training loss = 0.281266, test loss = 0.386260
  Training set accuracy = 0.926000, Test set accuracy = 0.882700
 epoch 23/30. Took 0.32349 seconds. 
  Full-batch training loss = 0.279524, test loss = 0.389104
  Training set accuracy = 0.926000, Test set accuracy = 0.880600
 epoch 24/30. Took 0.35983 seconds. 
  Full-batch training loss = 0.259984, test loss = 0.363275
  Training set accuracy = 0.933500, Test set accuracy = 0.888900
 epoch 25/30. Took 0.38995 seconds. 
  Full-batch training loss = 0.257227, test loss = 0.371946
  Training set accuracy = 0.933000, Test set accuracy = 0.887500
 epoch 26/30. Took 0.32308 seconds. 
  Full-batch training loss = 0.243300, test loss = 0.359052
  Training set accuracy = 0.934500, Test set accuracy = 0.889600
 epoch 27/30. Took 0.32535 seconds. 
  Full-batch training loss = 0.234587, test loss = 0.354627
  Training set accuracy = 0.938500, Test set accuracy = 0.891500
 epoch 28/30. Took 0.3191 seconds. 
  Full-batch training loss = 0.223486, test loss = 0.349615
  Training set accuracy = 0.941500, Test set accuracy = 0.891400
 epoch 29/30. Took 0.31903 seconds. 
  Full-batch training loss = 0.217180, test loss = 0.344270
  Training set accuracy = 0.944500, Test set accuracy = 0.893900
 epoch 30/30. Took 0.3449 seconds. 
  Full-batch training loss = 0.208143, test loss = 0.343116
  Training set accuracy = 0.946500, Test set accuracy = 0.894500
Elapsed time is 32.320836 seconds.
End Training
-----
Params 2000 0.010 0.30 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.042844 seconds. 
  Full-batch training loss = 2.160229, test loss = 2.161735
  Training set accuracy = 0.412000, Test set accuracy = 0.427900
 epoch 2/30. Took 0.043809 seconds. 
  Full-batch training loss = 1.931925, test loss = 1.937324
  Training set accuracy = 0.678000, Test set accuracy = 0.658100
 epoch 3/30. Took 0.041047 seconds. 
  Full-batch training loss = 1.663476, test loss = 1.672443
  Training set accuracy = 0.734000, Test set accuracy = 0.719500
 epoch 4/30. Took 0.039659 seconds. 
  Full-batch training loss = 1.403124, test loss = 1.418303
  Training set accuracy = 0.750500, Test set accuracy = 0.733400
 epoch 5/30. Took 0.039559 seconds. 
  Full-batch training loss = 1.189751, test loss = 1.207124
  Training set accuracy = 0.773000, Test set accuracy = 0.757200
 epoch 6/30. Took 0.038043 seconds. 
  Full-batch training loss = 1.027623, test loss = 1.047389
  Training set accuracy = 0.800500, Test set accuracy = 0.782200
 epoch 7/30. Took 0.039135 seconds. 
  Full-batch training loss = 0.908891, test loss = 0.931806
  Training set accuracy = 0.817500, Test set accuracy = 0.797800
 epoch 8/30. Took 0.038145 seconds. 
  Full-batch training loss = 0.818273, test loss = 0.843222
  Training set accuracy = 0.830500, Test set accuracy = 0.812000
 epoch 9/30. Took 0.038436 seconds. 
  Full-batch training loss = 0.749347, test loss = 0.774707
  Training set accuracy = 0.851000, Test set accuracy = 0.827400
 epoch 10/30. Took 0.039307 seconds. 
  Full-batch training loss = 0.693667, test loss = 0.721599
  Training set accuracy = 0.858000, Test set accuracy = 0.834200
 epoch 11/30. Took 0.038018 seconds. 
  Full-batch training loss = 0.648971, test loss = 0.678605
  Training set accuracy = 0.865500, Test set accuracy = 0.839900
 epoch 12/30. Took 0.038433 seconds. 
  Full-batch training loss = 0.612908, test loss = 0.645666
  Training set accuracy = 0.869000, Test set accuracy = 0.843900
 epoch 13/30. Took 0.039439 seconds. 
  Full-batch training loss = 0.580848, test loss = 0.615314
  Training set accuracy = 0.876000, Test set accuracy = 0.848800
 epoch 14/30. Took 0.036908 seconds. 
  Full-batch training loss = 0.554536, test loss = 0.590400
  Training set accuracy = 0.875500, Test set accuracy = 0.854100
 epoch 15/30. Took 0.037716 seconds. 
  Full-batch training loss = 0.530298, test loss = 0.568222
  Training set accuracy = 0.884500, Test set accuracy = 0.859400
 epoch 16/30. Took 0.039284 seconds. 
  Full-batch training loss = 0.509258, test loss = 0.550596
  Training set accuracy = 0.887000, Test set accuracy = 0.860600
 epoch 17/30. Took 0.038167 seconds. 
  Full-batch training loss = 0.492098, test loss = 0.533606
  Training set accuracy = 0.892500, Test set accuracy = 0.864300
 epoch 18/30. Took 0.038744 seconds. 
  Full-batch training loss = 0.475309, test loss = 0.518818
  Training set accuracy = 0.894500, Test set accuracy = 0.866200
 epoch 19/30. Took 0.039542 seconds. 
  Full-batch training loss = 0.460496, test loss = 0.506544
  Training set accuracy = 0.897500, Test set accuracy = 0.869300
 epoch 20/30. Took 0.038611 seconds. 
  Full-batch training loss = 0.447099, test loss = 0.495764
  Training set accuracy = 0.897000, Test set accuracy = 0.870300
 epoch 21/30. Took 0.036436 seconds. 
  Full-batch training loss = 0.434512, test loss = 0.486316
  Training set accuracy = 0.900500, Test set accuracy = 0.870400
 epoch 22/30. Took 0.042215 seconds. 
  Full-batch training loss = 0.423074, test loss = 0.476335
  Training set accuracy = 0.900500, Test set accuracy = 0.872800
 epoch 23/30. Took 0.039722 seconds. 
  Full-batch training loss = 0.413866, test loss = 0.468080
  Training set accuracy = 0.904000, Test set accuracy = 0.875300
 epoch 24/30. Took 0.038564 seconds. 
  Full-batch training loss = 0.404528, test loss = 0.460135
  Training set accuracy = 0.905000, Test set accuracy = 0.875000
 epoch 25/30. Took 0.038261 seconds. 
  Full-batch training loss = 0.395872, test loss = 0.452762
  Training set accuracy = 0.905500, Test set accuracy = 0.877600
 epoch 26/30. Took 0.045334 seconds. 
  Full-batch training loss = 0.386955, test loss = 0.446162
  Training set accuracy = 0.907000, Test set accuracy = 0.876500
 epoch 27/30. Took 0.038853 seconds. 
  Full-batch training loss = 0.379068, test loss = 0.439369
  Training set accuracy = 0.910000, Test set accuracy = 0.879400
 epoch 28/30. Took 0.036006 seconds. 
  Full-batch training loss = 0.371468, test loss = 0.434538
  Training set accuracy = 0.910000, Test set accuracy = 0.881700
 epoch 29/30. Took 0.03649 seconds. 
  Full-batch training loss = 0.363794, test loss = 0.428462
  Training set accuracy = 0.913500, Test set accuracy = 0.882700
 epoch 30/30. Took 0.042645 seconds. 
  Full-batch training loss = 0.357656, test loss = 0.424276
  Training set accuracy = 0.916500, Test set accuracy = 0.885700
Elapsed time is 5.130405 seconds.
End Training
-----
Params 2000 0.010 0.30 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.078823 seconds. 
  Full-batch training loss = 2.084683, test loss = 2.089364
  Training set accuracy = 0.532500, Test set accuracy = 0.523600
 epoch 2/30. Took 0.062187 seconds. 
  Full-batch training loss = 1.807752, test loss = 1.818629
  Training set accuracy = 0.688000, Test set accuracy = 0.661700
 epoch 3/30. Took 0.063267 seconds. 
  Full-batch training loss = 1.525717, test loss = 1.538023
  Training set accuracy = 0.734000, Test set accuracy = 0.713300
 epoch 4/30. Took 0.064212 seconds. 
  Full-batch training loss = 1.275701, test loss = 1.286954
  Training set accuracy = 0.763000, Test set accuracy = 0.754900
 epoch 5/30. Took 0.063425 seconds. 
  Full-batch training loss = 1.083277, test loss = 1.091464
  Training set accuracy = 0.795500, Test set accuracy = 0.788700
 epoch 6/30. Took 0.064899 seconds. 
  Full-batch training loss = 0.940663, test loss = 0.948548
  Training set accuracy = 0.804000, Test set accuracy = 0.802900
 epoch 7/30. Took 0.061146 seconds. 
  Full-batch training loss = 0.836728, test loss = 0.843317
  Training set accuracy = 0.827000, Test set accuracy = 0.824200
 epoch 8/30. Took 0.061089 seconds. 
  Full-batch training loss = 0.757227, test loss = 0.764783
  Training set accuracy = 0.841500, Test set accuracy = 0.839600
 epoch 9/30. Took 0.062927 seconds. 
  Full-batch training loss = 0.696269, test loss = 0.705014
  Training set accuracy = 0.850500, Test set accuracy = 0.846600
 epoch 10/30. Took 0.071846 seconds. 
  Full-batch training loss = 0.647489, test loss = 0.660712
  Training set accuracy = 0.854000, Test set accuracy = 0.848700
 epoch 11/30. Took 0.070376 seconds. 
  Full-batch training loss = 0.609083, test loss = 0.622448
  Training set accuracy = 0.861500, Test set accuracy = 0.861400
 epoch 12/30. Took 0.061997 seconds. 
  Full-batch training loss = 0.573596, test loss = 0.590242
  Training set accuracy = 0.873000, Test set accuracy = 0.863400
 epoch 13/30. Took 0.06417 seconds. 
  Full-batch training loss = 0.545430, test loss = 0.564403
  Training set accuracy = 0.875500, Test set accuracy = 0.865500
 epoch 14/30. Took 0.072955 seconds. 
  Full-batch training loss = 0.520061, test loss = 0.540700
  Training set accuracy = 0.881500, Test set accuracy = 0.871200
 epoch 15/30. Took 0.063571 seconds. 
  Full-batch training loss = 0.498977, test loss = 0.522843
  Training set accuracy = 0.884000, Test set accuracy = 0.872700
 epoch 16/30. Took 0.063344 seconds. 
  Full-batch training loss = 0.479781, test loss = 0.505984
  Training set accuracy = 0.882500, Test set accuracy = 0.874200
 epoch 17/30. Took 0.063446 seconds. 
  Full-batch training loss = 0.462412, test loss = 0.489807
  Training set accuracy = 0.888000, Test set accuracy = 0.879100
 epoch 18/30. Took 0.064514 seconds. 
  Full-batch training loss = 0.446217, test loss = 0.477595
  Training set accuracy = 0.890000, Test set accuracy = 0.878500
 epoch 19/30. Took 0.06518 seconds. 
  Full-batch training loss = 0.432466, test loss = 0.465511
  Training set accuracy = 0.890500, Test set accuracy = 0.882400
 epoch 20/30. Took 0.061962 seconds. 
  Full-batch training loss = 0.420690, test loss = 0.456245
  Training set accuracy = 0.893500, Test set accuracy = 0.882700
 epoch 21/30. Took 0.072992 seconds. 
  Full-batch training loss = 0.410181, test loss = 0.449779
  Training set accuracy = 0.896000, Test set accuracy = 0.881600
 epoch 22/30. Took 0.062558 seconds. 
  Full-batch training loss = 0.399544, test loss = 0.441069
  Training set accuracy = 0.899500, Test set accuracy = 0.885300
 epoch 23/30. Took 0.067576 seconds. 
  Full-batch training loss = 0.389563, test loss = 0.432384
  Training set accuracy = 0.899000, Test set accuracy = 0.888200
 epoch 24/30. Took 0.062683 seconds. 
  Full-batch training loss = 0.380307, test loss = 0.426166
  Training set accuracy = 0.904500, Test set accuracy = 0.888200
 epoch 25/30. Took 0.064787 seconds. 
  Full-batch training loss = 0.371836, test loss = 0.420198
  Training set accuracy = 0.905000, Test set accuracy = 0.889600
 epoch 26/30. Took 0.061396 seconds. 
  Full-batch training loss = 0.363641, test loss = 0.413329
  Training set accuracy = 0.905500, Test set accuracy = 0.890900
 epoch 27/30. Took 0.061159 seconds. 
  Full-batch training loss = 0.356671, test loss = 0.409594
  Training set accuracy = 0.906000, Test set accuracy = 0.890700
 epoch 28/30. Took 0.0661 seconds. 
  Full-batch training loss = 0.350231, test loss = 0.405704
  Training set accuracy = 0.910500, Test set accuracy = 0.891100
 epoch 29/30. Took 0.063528 seconds. 
  Full-batch training loss = 0.343304, test loss = 0.400903
  Training set accuracy = 0.912500, Test set accuracy = 0.893000
 epoch 30/30. Took 0.064706 seconds. 
  Full-batch training loss = 0.336639, test loss = 0.395740
  Training set accuracy = 0.913500, Test set accuracy = 0.893500
Elapsed time is 7.243604 seconds.
End Training
-----
Params 2000 0.010 0.30 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14485 seconds. 
  Full-batch training loss = 2.036695, test loss = 2.042709
  Training set accuracy = 0.563500, Test set accuracy = 0.552300
 epoch 2/30. Took 0.14391 seconds. 
  Full-batch training loss = 1.723361, test loss = 1.731144
  Training set accuracy = 0.698000, Test set accuracy = 0.677800
 epoch 3/30. Took 0.13879 seconds. 
  Full-batch training loss = 1.421273, test loss = 1.430132
  Training set accuracy = 0.763500, Test set accuracy = 0.746900
 epoch 4/30. Took 0.15674 seconds. 
  Full-batch training loss = 1.170715, test loss = 1.180928
  Training set accuracy = 0.800000, Test set accuracy = 0.788400
 epoch 5/30. Took 0.1406 seconds. 
  Full-batch training loss = 0.984920, test loss = 0.998391
  Training set accuracy = 0.823500, Test set accuracy = 0.815200
 epoch 6/30. Took 0.13612 seconds. 
  Full-batch training loss = 0.854508, test loss = 0.870354
  Training set accuracy = 0.827000, Test set accuracy = 0.816100
 epoch 7/30. Took 0.13255 seconds. 
  Full-batch training loss = 0.757032, test loss = 0.775789
  Training set accuracy = 0.852000, Test set accuracy = 0.834800
 epoch 8/30. Took 0.13851 seconds. 
  Full-batch training loss = 0.684923, test loss = 0.707045
  Training set accuracy = 0.858000, Test set accuracy = 0.848000
 epoch 9/30. Took 0.13522 seconds. 
  Full-batch training loss = 0.629833, test loss = 0.653631
  Training set accuracy = 0.865500, Test set accuracy = 0.855000
 epoch 10/30. Took 0.13237 seconds. 
  Full-batch training loss = 0.585504, test loss = 0.614571
  Training set accuracy = 0.870500, Test set accuracy = 0.857100
 epoch 11/30. Took 0.1483 seconds. 
  Full-batch training loss = 0.548915, test loss = 0.578267
  Training set accuracy = 0.876500, Test set accuracy = 0.864000
 epoch 12/30. Took 0.13396 seconds. 
  Full-batch training loss = 0.519102, test loss = 0.554482
  Training set accuracy = 0.884000, Test set accuracy = 0.866100
 epoch 13/30. Took 0.13476 seconds. 
  Full-batch training loss = 0.492956, test loss = 0.529597
  Training set accuracy = 0.884000, Test set accuracy = 0.871300
 epoch 14/30. Took 0.13491 seconds. 
  Full-batch training loss = 0.470276, test loss = 0.510204
  Training set accuracy = 0.891500, Test set accuracy = 0.874600
 epoch 15/30. Took 0.13555 seconds. 
  Full-batch training loss = 0.450858, test loss = 0.493706
  Training set accuracy = 0.894500, Test set accuracy = 0.876300
 epoch 16/30. Took 0.13666 seconds. 
  Full-batch training loss = 0.433045, test loss = 0.479081
  Training set accuracy = 0.898500, Test set accuracy = 0.879300
 epoch 17/30. Took 0.13389 seconds. 
  Full-batch training loss = 0.417740, test loss = 0.466866
  Training set accuracy = 0.897000, Test set accuracy = 0.879200
 epoch 18/30. Took 0.13541 seconds. 
  Full-batch training loss = 0.403752, test loss = 0.454718
  Training set accuracy = 0.897000, Test set accuracy = 0.882700
 epoch 19/30. Took 0.1427 seconds. 
  Full-batch training loss = 0.393067, test loss = 0.446532
  Training set accuracy = 0.904500, Test set accuracy = 0.883100
 epoch 20/30. Took 0.13226 seconds. 
  Full-batch training loss = 0.379561, test loss = 0.436433
  Training set accuracy = 0.906500, Test set accuracy = 0.887800
 epoch 21/30. Took 0.14022 seconds. 
  Full-batch training loss = 0.369217, test loss = 0.429034
  Training set accuracy = 0.904500, Test set accuracy = 0.886400
 epoch 22/30. Took 0.1324 seconds. 
  Full-batch training loss = 0.358236, test loss = 0.420787
  Training set accuracy = 0.909500, Test set accuracy = 0.887400
 epoch 23/30. Took 0.13916 seconds. 
  Full-batch training loss = 0.349571, test loss = 0.415803
  Training set accuracy = 0.913000, Test set accuracy = 0.888800
 epoch 24/30. Took 0.13439 seconds. 
  Full-batch training loss = 0.340220, test loss = 0.407554
  Training set accuracy = 0.915000, Test set accuracy = 0.890200
 epoch 25/30. Took 0.13766 seconds. 
  Full-batch training loss = 0.333508, test loss = 0.403445
  Training set accuracy = 0.918500, Test set accuracy = 0.891800
 epoch 26/30. Took 0.14669 seconds. 
  Full-batch training loss = 0.326510, test loss = 0.398475
  Training set accuracy = 0.915000, Test set accuracy = 0.889400
 epoch 27/30. Took 0.1388 seconds. 
  Full-batch training loss = 0.317802, test loss = 0.391967
  Training set accuracy = 0.916500, Test set accuracy = 0.893400
 epoch 28/30. Took 0.15571 seconds. 
  Full-batch training loss = 0.310880, test loss = 0.388494
  Training set accuracy = 0.919500, Test set accuracy = 0.893100
 epoch 29/30. Took 0.15012 seconds. 
  Full-batch training loss = 0.304363, test loss = 0.382994
  Training set accuracy = 0.922000, Test set accuracy = 0.894400
 epoch 30/30. Took 0.1514 seconds. 
  Full-batch training loss = 0.298835, test loss = 0.379046
  Training set accuracy = 0.923500, Test set accuracy = 0.894500
Elapsed time is 14.603441 seconds.
End Training
-----
Params 2000 0.010 0.30 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.051161 seconds. 
  Full-batch training loss = 2.268436, test loss = 2.269587
  Training set accuracy = 0.256000, Test set accuracy = 0.251500
 epoch 2/30. Took 0.053866 seconds. 
  Full-batch training loss = 2.208273, test loss = 2.210418
  Training set accuracy = 0.374000, Test set accuracy = 0.368800
 epoch 3/30. Took 0.048603 seconds. 
  Full-batch training loss = 2.133067, test loss = 2.135624
  Training set accuracy = 0.469500, Test set accuracy = 0.470000
 epoch 4/30. Took 0.049818 seconds. 
  Full-batch training loss = 2.036758, test loss = 2.038414
  Training set accuracy = 0.531500, Test set accuracy = 0.523400
 epoch 5/30. Took 0.049014 seconds. 
  Full-batch training loss = 1.912376, test loss = 1.912335
  Training set accuracy = 0.580500, Test set accuracy = 0.565500
 epoch 6/30. Took 0.050938 seconds. 
  Full-batch training loss = 1.758703, test loss = 1.756619
  Training set accuracy = 0.606000, Test set accuracy = 0.595400
 epoch 7/30. Took 0.050891 seconds. 
  Full-batch training loss = 1.584363, test loss = 1.580611
  Training set accuracy = 0.644500, Test set accuracy = 0.635800
 epoch 8/30. Took 0.050521 seconds. 
  Full-batch training loss = 1.397900, test loss = 1.395271
  Training set accuracy = 0.681000, Test set accuracy = 0.673100
 epoch 9/30. Took 0.050524 seconds. 
  Full-batch training loss = 1.231893, test loss = 1.230542
  Training set accuracy = 0.723500, Test set accuracy = 0.718600
 epoch 10/30. Took 0.049565 seconds. 
  Full-batch training loss = 1.092294, test loss = 1.091730
  Training set accuracy = 0.739000, Test set accuracy = 0.733500
 epoch 11/30. Took 0.050157 seconds. 
  Full-batch training loss = 0.977295, test loss = 0.982796
  Training set accuracy = 0.771000, Test set accuracy = 0.758100
 epoch 12/30. Took 0.048836 seconds. 
  Full-batch training loss = 0.886337, test loss = 0.893802
  Training set accuracy = 0.792000, Test set accuracy = 0.789600
 epoch 13/30. Took 0.050906 seconds. 
  Full-batch training loss = 0.815122, test loss = 0.824336
  Training set accuracy = 0.820000, Test set accuracy = 0.814200
 epoch 14/30. Took 0.049395 seconds. 
  Full-batch training loss = 0.756566, test loss = 0.773834
  Training set accuracy = 0.814000, Test set accuracy = 0.803100
 epoch 15/30. Took 0.049267 seconds. 
  Full-batch training loss = 0.699943, test loss = 0.715804
  Training set accuracy = 0.835000, Test set accuracy = 0.829700
 epoch 16/30. Took 0.050336 seconds. 
  Full-batch training loss = 0.654628, test loss = 0.673560
  Training set accuracy = 0.850500, Test set accuracy = 0.836900
 epoch 17/30. Took 0.050201 seconds. 
  Full-batch training loss = 0.617013, test loss = 0.639524
  Training set accuracy = 0.862000, Test set accuracy = 0.847600
 epoch 18/30. Took 0.048152 seconds. 
  Full-batch training loss = 0.584394, test loss = 0.615106
  Training set accuracy = 0.865000, Test set accuracy = 0.846300
 epoch 19/30. Took 0.046055 seconds. 
  Full-batch training loss = 0.554919, test loss = 0.588985
  Training set accuracy = 0.867000, Test set accuracy = 0.850600
 epoch 20/30. Took 0.04971 seconds. 
  Full-batch training loss = 0.530973, test loss = 0.568049
  Training set accuracy = 0.871000, Test set accuracy = 0.854800
 epoch 21/30. Took 0.049296 seconds. 
  Full-batch training loss = 0.504601, test loss = 0.543955
  Training set accuracy = 0.882000, Test set accuracy = 0.863400
 epoch 22/30. Took 0.050469 seconds. 
  Full-batch training loss = 0.486015, test loss = 0.525659
  Training set accuracy = 0.884500, Test set accuracy = 0.865900
 epoch 23/30. Took 0.051101 seconds. 
  Full-batch training loss = 0.468092, test loss = 0.516024
  Training set accuracy = 0.888500, Test set accuracy = 0.865400
 epoch 24/30. Took 0.046576 seconds. 
  Full-batch training loss = 0.446819, test loss = 0.494837
  Training set accuracy = 0.890500, Test set accuracy = 0.871100
 epoch 25/30. Took 0.049398 seconds. 
  Full-batch training loss = 0.432215, test loss = 0.485428
  Training set accuracy = 0.892500, Test set accuracy = 0.871600
 epoch 26/30. Took 0.054835 seconds. 
  Full-batch training loss = 0.418911, test loss = 0.473427
  Training set accuracy = 0.894500, Test set accuracy = 0.876300
 epoch 27/30. Took 0.045345 seconds. 
  Full-batch training loss = 0.407229, test loss = 0.465361
  Training set accuracy = 0.894000, Test set accuracy = 0.875100
 epoch 28/30. Took 0.050517 seconds. 
  Full-batch training loss = 0.395593, test loss = 0.454930
  Training set accuracy = 0.897000, Test set accuracy = 0.879800
 epoch 29/30. Took 0.049806 seconds. 
  Full-batch training loss = 0.382131, test loss = 0.446191
  Training set accuracy = 0.897500, Test set accuracy = 0.879900
 epoch 30/30. Took 0.0494 seconds. 
  Full-batch training loss = 0.372094, test loss = 0.440341
  Training set accuracy = 0.903000, Test set accuracy = 0.881800
Elapsed time is 5.717622 seconds.
End Training
-----
Params 2000 0.010 0.30 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.090062 seconds. 
  Full-batch training loss = 2.266038, test loss = 2.269514
  Training set accuracy = 0.177000, Test set accuracy = 0.172600
 epoch 2/30. Took 0.087206 seconds. 
  Full-batch training loss = 2.199210, test loss = 2.207415
  Training set accuracy = 0.392000, Test set accuracy = 0.343900
 epoch 3/30. Took 0.08865 seconds. 
  Full-batch training loss = 2.117165, test loss = 2.129453
  Training set accuracy = 0.468500, Test set accuracy = 0.446600
 epoch 4/30. Took 0.088269 seconds. 
  Full-batch training loss = 2.005654, test loss = 2.022612
  Training set accuracy = 0.507000, Test set accuracy = 0.482000
 epoch 5/30. Took 0.087957 seconds. 
  Full-batch training loss = 1.857380, test loss = 1.878611
  Training set accuracy = 0.566000, Test set accuracy = 0.539600
 epoch 6/30. Took 0.087515 seconds. 
  Full-batch training loss = 1.669513, test loss = 1.690980
  Training set accuracy = 0.644500, Test set accuracy = 0.626300
 epoch 7/30. Took 0.086959 seconds. 
  Full-batch training loss = 1.455957, test loss = 1.480570
  Training set accuracy = 0.687500, Test set accuracy = 0.662000
 epoch 8/30. Took 0.095158 seconds. 
  Full-batch training loss = 1.243771, test loss = 1.269577
  Training set accuracy = 0.740500, Test set accuracy = 0.704900
 epoch 9/30. Took 0.085176 seconds. 
  Full-batch training loss = 1.066823, test loss = 1.092811
  Training set accuracy = 0.786000, Test set accuracy = 0.752000
 epoch 10/30. Took 0.088218 seconds. 
  Full-batch training loss = 0.930664, test loss = 0.960037
  Training set accuracy = 0.802500, Test set accuracy = 0.778000
 epoch 11/30. Took 0.086999 seconds. 
  Full-batch training loss = 0.825695, test loss = 0.856584
  Training set accuracy = 0.823000, Test set accuracy = 0.798300
 epoch 12/30. Took 0.087991 seconds. 
  Full-batch training loss = 0.742334, test loss = 0.777873
  Training set accuracy = 0.834000, Test set accuracy = 0.810200
 epoch 13/30. Took 0.086858 seconds. 
  Full-batch training loss = 0.675177, test loss = 0.714909
  Training set accuracy = 0.851000, Test set accuracy = 0.818000
 epoch 14/30. Took 0.08534 seconds. 
  Full-batch training loss = 0.626026, test loss = 0.666474
  Training set accuracy = 0.852000, Test set accuracy = 0.828200
 epoch 15/30. Took 0.09228 seconds. 
  Full-batch training loss = 0.582678, test loss = 0.625244
  Training set accuracy = 0.860000, Test set accuracy = 0.836300
 epoch 16/30. Took 0.089369 seconds. 
  Full-batch training loss = 0.547422, test loss = 0.592932
  Training set accuracy = 0.869500, Test set accuracy = 0.842900
 epoch 17/30. Took 0.089291 seconds. 
  Full-batch training loss = 0.516765, test loss = 0.565616
  Training set accuracy = 0.880500, Test set accuracy = 0.851000
 epoch 18/30. Took 0.086736 seconds. 
  Full-batch training loss = 0.490836, test loss = 0.541318
  Training set accuracy = 0.886000, Test set accuracy = 0.856400
 epoch 19/30. Took 0.088097 seconds. 
  Full-batch training loss = 0.468376, test loss = 0.524034
  Training set accuracy = 0.890500, Test set accuracy = 0.857500
 epoch 20/30. Took 0.087131 seconds. 
  Full-batch training loss = 0.447847, test loss = 0.503297
  Training set accuracy = 0.895000, Test set accuracy = 0.863000
 epoch 21/30. Took 0.086133 seconds. 
  Full-batch training loss = 0.433232, test loss = 0.492213
  Training set accuracy = 0.894000, Test set accuracy = 0.866200
 epoch 22/30. Took 0.08674 seconds. 
  Full-batch training loss = 0.419036, test loss = 0.484028
  Training set accuracy = 0.891000, Test set accuracy = 0.863000
 epoch 23/30. Took 0.086266 seconds. 
  Full-batch training loss = 0.399445, test loss = 0.465362
  Training set accuracy = 0.902000, Test set accuracy = 0.871700
 epoch 24/30. Took 0.087464 seconds. 
  Full-batch training loss = 0.384739, test loss = 0.453042
  Training set accuracy = 0.908500, Test set accuracy = 0.873000
 epoch 25/30. Took 0.085282 seconds. 
  Full-batch training loss = 0.371923, test loss = 0.443237
  Training set accuracy = 0.906500, Test set accuracy = 0.877500
 epoch 26/30. Took 0.085363 seconds. 
  Full-batch training loss = 0.361936, test loss = 0.437447
  Training set accuracy = 0.913500, Test set accuracy = 0.877300
 epoch 27/30. Took 0.083283 seconds. 
  Full-batch training loss = 0.350023, test loss = 0.426240
  Training set accuracy = 0.913000, Test set accuracy = 0.881400
 epoch 28/30. Took 0.08706 seconds. 
  Full-batch training loss = 0.341246, test loss = 0.420680
  Training set accuracy = 0.917000, Test set accuracy = 0.881400
 epoch 29/30. Took 0.086468 seconds. 
  Full-batch training loss = 0.331044, test loss = 0.413344
  Training set accuracy = 0.918000, Test set accuracy = 0.883600
 epoch 30/30. Took 0.084645 seconds. 
  Full-batch training loss = 0.322959, test loss = 0.405068
  Training set accuracy = 0.918000, Test set accuracy = 0.885200
Elapsed time is 9.288488 seconds.
End Training
-----
Params 2000 0.010 0.30 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23643 seconds. 
  Full-batch training loss = 2.220498, test loss = 2.221395
  Training set accuracy = 0.408000, Test set accuracy = 0.402800
 epoch 2/30. Took 0.23152 seconds. 
  Full-batch training loss = 2.120246, test loss = 2.121717
  Training set accuracy = 0.620500, Test set accuracy = 0.595200
 epoch 3/30. Took 0.22655 seconds. 
  Full-batch training loss = 1.987485, test loss = 1.989160
  Training set accuracy = 0.670500, Test set accuracy = 0.643100
 epoch 4/30. Took 0.23159 seconds. 
  Full-batch training loss = 1.802519, test loss = 1.804744
  Training set accuracy = 0.696000, Test set accuracy = 0.677400
 epoch 5/30. Took 0.22897 seconds. 
  Full-batch training loss = 1.563960, test loss = 1.566158
  Training set accuracy = 0.730500, Test set accuracy = 0.717300
 epoch 6/30. Took 0.25414 seconds. 
  Full-batch training loss = 1.307482, test loss = 1.311884
  Training set accuracy = 0.759000, Test set accuracy = 0.741500
 epoch 7/30. Took 0.24204 seconds. 
  Full-batch training loss = 1.083797, test loss = 1.089020
  Training set accuracy = 0.788000, Test set accuracy = 0.773700
 epoch 8/30. Took 0.23056 seconds. 
  Full-batch training loss = 0.916449, test loss = 0.925682
  Training set accuracy = 0.804500, Test set accuracy = 0.791600
 epoch 9/30. Took 0.23249 seconds. 
  Full-batch training loss = 0.794859, test loss = 0.809351
  Training set accuracy = 0.830500, Test set accuracy = 0.809800
 epoch 10/30. Took 0.2313 seconds. 
  Full-batch training loss = 0.706782, test loss = 0.721918
  Training set accuracy = 0.845500, Test set accuracy = 0.827200
 epoch 11/30. Took 0.24752 seconds. 
  Full-batch training loss = 0.640526, test loss = 0.660029
  Training set accuracy = 0.854000, Test set accuracy = 0.834500
 epoch 12/30. Took 0.23216 seconds. 
  Full-batch training loss = 0.591478, test loss = 0.615166
  Training set accuracy = 0.853000, Test set accuracy = 0.836400
 epoch 13/30. Took 0.22941 seconds. 
  Full-batch training loss = 0.550046, test loss = 0.577468
  Training set accuracy = 0.859500, Test set accuracy = 0.844400
 epoch 14/30. Took 0.23067 seconds. 
  Full-batch training loss = 0.517660, test loss = 0.546000
  Training set accuracy = 0.866000, Test set accuracy = 0.851500
 epoch 15/30. Took 0.25619 seconds. 
  Full-batch training loss = 0.492122, test loss = 0.525199
  Training set accuracy = 0.860000, Test set accuracy = 0.853000
 epoch 16/30. Took 0.23251 seconds. 
  Full-batch training loss = 0.465110, test loss = 0.503545
  Training set accuracy = 0.879500, Test set accuracy = 0.861500
 epoch 17/30. Took 0.23227 seconds. 
  Full-batch training loss = 0.442306, test loss = 0.481735
  Training set accuracy = 0.880000, Test set accuracy = 0.865200
 epoch 18/30. Took 0.23103 seconds. 
  Full-batch training loss = 0.424776, test loss = 0.466017
  Training set accuracy = 0.884000, Test set accuracy = 0.868300
 epoch 19/30. Took 0.23717 seconds. 
  Full-batch training loss = 0.408796, test loss = 0.453832
  Training set accuracy = 0.888500, Test set accuracy = 0.871000
 epoch 20/30. Took 0.23181 seconds. 
  Full-batch training loss = 0.393098, test loss = 0.439817
  Training set accuracy = 0.889500, Test set accuracy = 0.873300
 epoch 21/30. Took 0.22929 seconds. 
  Full-batch training loss = 0.380521, test loss = 0.432066
  Training set accuracy = 0.893000, Test set accuracy = 0.874000
 epoch 22/30. Took 0.22746 seconds. 
  Full-batch training loss = 0.367434, test loss = 0.420920
  Training set accuracy = 0.896000, Test set accuracy = 0.879500
 epoch 23/30. Took 0.23082 seconds. 
  Full-batch training loss = 0.358048, test loss = 0.416586
  Training set accuracy = 0.901000, Test set accuracy = 0.878400
 epoch 24/30. Took 0.22708 seconds. 
  Full-batch training loss = 0.347750, test loss = 0.407252
  Training set accuracy = 0.902000, Test set accuracy = 0.881000
 epoch 25/30. Took 0.2303 seconds. 
  Full-batch training loss = 0.336582, test loss = 0.399173
  Training set accuracy = 0.905500, Test set accuracy = 0.884000
 epoch 26/30. Took 0.23944 seconds. 
  Full-batch training loss = 0.327981, test loss = 0.392455
  Training set accuracy = 0.910000, Test set accuracy = 0.886300
 epoch 27/30. Took 0.23141 seconds. 
  Full-batch training loss = 0.317280, test loss = 0.385023
  Training set accuracy = 0.913500, Test set accuracy = 0.887900
 epoch 28/30. Took 0.26451 seconds. 
  Full-batch training loss = 0.312374, test loss = 0.384387
  Training set accuracy = 0.914500, Test set accuracy = 0.885900
 epoch 29/30. Took 0.23135 seconds. 
  Full-batch training loss = 0.302083, test loss = 0.374106
  Training set accuracy = 0.918500, Test set accuracy = 0.890500
 epoch 30/30. Took 0.24116 seconds. 
  Full-batch training loss = 0.295447, test loss = 0.370970
  Training set accuracy = 0.921500, Test set accuracy = 0.890700
Elapsed time is 23.300624 seconds.
End Training
-----
Params 2000 0.010 0.30 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.063207 seconds. 
  Full-batch training loss = 2.291519, test loss = 2.292384
  Training set accuracy = 0.118000, Test set accuracy = 0.121000
 epoch 2/30. Took 0.061168 seconds. 
  Full-batch training loss = 2.274666, test loss = 2.276285
  Training set accuracy = 0.184500, Test set accuracy = 0.188500
 epoch 3/30. Took 0.060058 seconds. 
  Full-batch training loss = 2.255467, test loss = 2.257981
  Training set accuracy = 0.275000, Test set accuracy = 0.274700
 epoch 4/30. Took 0.060599 seconds. 
  Full-batch training loss = 2.231651, test loss = 2.234822
  Training set accuracy = 0.296000, Test set accuracy = 0.283300
 epoch 5/30. Took 0.059618 seconds. 
  Full-batch training loss = 2.200038, test loss = 2.204085
  Training set accuracy = 0.276000, Test set accuracy = 0.259900
 epoch 6/30. Took 0.059773 seconds. 
  Full-batch training loss = 2.160720, test loss = 2.165787
  Training set accuracy = 0.305500, Test set accuracy = 0.281000
 epoch 7/30. Took 0.060687 seconds. 
  Full-batch training loss = 2.108341, test loss = 2.114714
  Training set accuracy = 0.322000, Test set accuracy = 0.301000
 epoch 8/30. Took 0.060593 seconds. 
  Full-batch training loss = 2.050606, test loss = 2.057309
  Training set accuracy = 0.381500, Test set accuracy = 0.367100
 epoch 9/30. Took 0.066435 seconds. 
  Full-batch training loss = 1.984218, test loss = 1.991255
  Training set accuracy = 0.443000, Test set accuracy = 0.431200
 epoch 10/30. Took 0.058517 seconds. 
  Full-batch training loss = 1.912351, test loss = 1.918804
  Training set accuracy = 0.520000, Test set accuracy = 0.495600
 epoch 11/30. Took 0.060212 seconds. 
  Full-batch training loss = 1.829881, test loss = 1.835246
  Training set accuracy = 0.553000, Test set accuracy = 0.536700
 epoch 12/30. Took 0.060664 seconds. 
  Full-batch training loss = 1.733764, test loss = 1.737709
  Training set accuracy = 0.590000, Test set accuracy = 0.576800
 epoch 13/30. Took 0.059948 seconds. 
  Full-batch training loss = 1.623195, test loss = 1.627896
  Training set accuracy = 0.613000, Test set accuracy = 0.604600
 epoch 14/30. Took 0.060438 seconds. 
  Full-batch training loss = 1.503993, test loss = 1.509053
  Training set accuracy = 0.641500, Test set accuracy = 0.650400
 epoch 15/30. Took 0.059163 seconds. 
  Full-batch training loss = 1.380607, test loss = 1.387069
  Training set accuracy = 0.679500, Test set accuracy = 0.684000
 epoch 16/30. Took 0.061013 seconds. 
  Full-batch training loss = 1.256031, test loss = 1.265331
  Training set accuracy = 0.706000, Test set accuracy = 0.703800
 epoch 17/30. Took 0.060536 seconds. 
  Full-batch training loss = 1.139622, test loss = 1.150403
  Training set accuracy = 0.737500, Test set accuracy = 0.726200
 epoch 18/30. Took 0.060816 seconds. 
  Full-batch training loss = 1.036432, test loss = 1.047516
  Training set accuracy = 0.752000, Test set accuracy = 0.742000
 epoch 19/30. Took 0.059611 seconds. 
  Full-batch training loss = 0.946363, test loss = 0.961238
  Training set accuracy = 0.768000, Test set accuracy = 0.756600
 epoch 20/30. Took 0.055326 seconds. 
  Full-batch training loss = 0.860291, test loss = 0.880478
  Training set accuracy = 0.790000, Test set accuracy = 0.772600
 epoch 21/30. Took 0.055055 seconds. 
  Full-batch training loss = 0.801971, test loss = 0.824397
  Training set accuracy = 0.792000, Test set accuracy = 0.778000
 epoch 22/30. Took 0.055465 seconds. 
  Full-batch training loss = 0.748791, test loss = 0.770473
  Training set accuracy = 0.800500, Test set accuracy = 0.792700
 epoch 23/30. Took 0.059745 seconds. 
  Full-batch training loss = 0.709256, test loss = 0.744732
  Training set accuracy = 0.818000, Test set accuracy = 0.795500
 epoch 24/30. Took 0.060868 seconds. 
  Full-batch training loss = 0.663780, test loss = 0.698726
  Training set accuracy = 0.823500, Test set accuracy = 0.802600
 epoch 25/30. Took 0.060149 seconds. 
  Full-batch training loss = 0.632719, test loss = 0.672805
  Training set accuracy = 0.833500, Test set accuracy = 0.812700
 epoch 26/30. Took 0.060661 seconds. 
  Full-batch training loss = 0.602673, test loss = 0.641771
  Training set accuracy = 0.837000, Test set accuracy = 0.818300
 epoch 27/30. Took 0.060941 seconds. 
  Full-batch training loss = 0.573083, test loss = 0.613940
  Training set accuracy = 0.840500, Test set accuracy = 0.825100
 epoch 28/30. Took 0.060908 seconds. 
  Full-batch training loss = 0.544925, test loss = 0.594538
  Training set accuracy = 0.847500, Test set accuracy = 0.828800
 epoch 29/30. Took 0.059689 seconds. 
  Full-batch training loss = 0.523337, test loss = 0.577420
  Training set accuracy = 0.856000, Test set accuracy = 0.834700
 epoch 30/30. Took 0.060371 seconds. 
  Full-batch training loss = 0.503950, test loss = 0.559961
  Training set accuracy = 0.860000, Test set accuracy = 0.836200
Elapsed time is 6.704178 seconds.
End Training
-----
Params 2000 0.010 0.30 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11107 seconds. 
  Full-batch training loss = 2.290091, test loss = 2.290521
  Training set accuracy = 0.123500, Test set accuracy = 0.118500
 epoch 2/30. Took 0.10706 seconds. 
  Full-batch training loss = 2.275894, test loss = 2.276424
  Training set accuracy = 0.193500, Test set accuracy = 0.177600
 epoch 3/30. Took 0.10605 seconds. 
  Full-batch training loss = 2.259457, test loss = 2.260193
  Training set accuracy = 0.285500, Test set accuracy = 0.258500
 epoch 4/30. Took 0.10687 seconds. 
  Full-batch training loss = 2.240272, test loss = 2.241076
  Training set accuracy = 0.422000, Test set accuracy = 0.399300
 epoch 5/30. Took 0.10283 seconds. 
  Full-batch training loss = 2.214600, test loss = 2.215325
  Training set accuracy = 0.505500, Test set accuracy = 0.489100
 epoch 6/30. Took 0.10325 seconds. 
  Full-batch training loss = 2.179274, test loss = 2.179964
  Training set accuracy = 0.577500, Test set accuracy = 0.562000
 epoch 7/30. Took 0.10551 seconds. 
  Full-batch training loss = 2.130222, test loss = 2.130824
  Training set accuracy = 0.657500, Test set accuracy = 0.646500
 epoch 8/30. Took 0.10827 seconds. 
  Full-batch training loss = 2.060671, test loss = 2.060576
  Training set accuracy = 0.705000, Test set accuracy = 0.702700
 epoch 9/30. Took 0.11218 seconds. 
  Full-batch training loss = 1.960617, test loss = 1.960256
  Training set accuracy = 0.732000, Test set accuracy = 0.717800
 epoch 10/30. Took 0.10761 seconds. 
  Full-batch training loss = 1.817913, test loss = 1.817271
  Training set accuracy = 0.739000, Test set accuracy = 0.718000
 epoch 11/30. Took 0.12316 seconds. 
  Full-batch training loss = 1.633381, test loss = 1.632144
  Training set accuracy = 0.731500, Test set accuracy = 0.716600
 epoch 12/30. Took 0.10893 seconds. 
  Full-batch training loss = 1.423751, test loss = 1.423343
  Training set accuracy = 0.722500, Test set accuracy = 0.708700
 epoch 13/30. Took 0.11205 seconds. 
  Full-batch training loss = 1.223563, test loss = 1.224409
  Training set accuracy = 0.742500, Test set accuracy = 0.734900
 epoch 14/30. Took 0.10791 seconds. 
  Full-batch training loss = 1.058761, test loss = 1.062779
  Training set accuracy = 0.753500, Test set accuracy = 0.745100
 epoch 15/30. Took 0.10724 seconds. 
  Full-batch training loss = 0.939870, test loss = 0.947646
  Training set accuracy = 0.773000, Test set accuracy = 0.766600
 epoch 16/30. Took 0.10276 seconds. 
  Full-batch training loss = 0.858498, test loss = 0.869761
  Training set accuracy = 0.786000, Test set accuracy = 0.764400
 epoch 17/30. Took 0.1055 seconds. 
  Full-batch training loss = 0.785245, test loss = 0.798166
  Training set accuracy = 0.800500, Test set accuracy = 0.782000
 epoch 18/30. Took 0.10288 seconds. 
  Full-batch training loss = 0.728657, test loss = 0.746819
  Training set accuracy = 0.815000, Test set accuracy = 0.804800
 epoch 19/30. Took 0.12995 seconds. 
  Full-batch training loss = 0.683579, test loss = 0.703693
  Training set accuracy = 0.815000, Test set accuracy = 0.803800
 epoch 20/30. Took 0.11012 seconds. 
  Full-batch training loss = 0.643248, test loss = 0.664411
  Training set accuracy = 0.827500, Test set accuracy = 0.816600
 epoch 21/30. Took 0.10644 seconds. 
  Full-batch training loss = 0.606953, test loss = 0.633975
  Training set accuracy = 0.830500, Test set accuracy = 0.822900
 epoch 22/30. Took 0.10908 seconds. 
  Full-batch training loss = 0.577127, test loss = 0.605930
  Training set accuracy = 0.844000, Test set accuracy = 0.827300
 epoch 23/30. Took 0.10784 seconds. 
  Full-batch training loss = 0.549370, test loss = 0.580897
  Training set accuracy = 0.845500, Test set accuracy = 0.834100
 epoch 24/30. Took 0.10612 seconds. 
  Full-batch training loss = 0.528461, test loss = 0.562421
  Training set accuracy = 0.855000, Test set accuracy = 0.838300
 epoch 25/30. Took 0.10812 seconds. 
  Full-batch training loss = 0.506337, test loss = 0.545104
  Training set accuracy = 0.860000, Test set accuracy = 0.846200
 epoch 26/30. Took 0.11923 seconds. 
  Full-batch training loss = 0.496974, test loss = 0.535043
  Training set accuracy = 0.864500, Test set accuracy = 0.847400
 epoch 27/30. Took 0.10767 seconds. 
  Full-batch training loss = 0.479975, test loss = 0.519829
  Training set accuracy = 0.869000, Test set accuracy = 0.853800
 epoch 28/30. Took 0.10779 seconds. 
  Full-batch training loss = 0.460353, test loss = 0.505166
  Training set accuracy = 0.874000, Test set accuracy = 0.854700
 epoch 29/30. Took 0.1092 seconds. 
  Full-batch training loss = 0.447255, test loss = 0.494246
  Training set accuracy = 0.876500, Test set accuracy = 0.860900
 epoch 30/30. Took 0.10694 seconds. 
  Full-batch training loss = 0.433454, test loss = 0.483181
  Training set accuracy = 0.877500, Test set accuracy = 0.860100
Elapsed time is 11.864930 seconds.
End Training
-----
Params 2000 0.010 0.30 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32783 seconds. 
  Full-batch training loss = 2.288088, test loss = 2.288387
  Training set accuracy = 0.137500, Test set accuracy = 0.142700
 epoch 2/30. Took 0.3523 seconds. 
  Full-batch training loss = 2.264681, test loss = 2.265958
  Training set accuracy = 0.312500, Test set accuracy = 0.291100
 epoch 3/30. Took 0.32384 seconds. 
  Full-batch training loss = 2.236476, test loss = 2.238751
  Training set accuracy = 0.283500, Test set accuracy = 0.265400
 epoch 4/30. Took 0.32123 seconds. 
  Full-batch training loss = 2.200330, test loss = 2.203498
  Training set accuracy = 0.323500, Test set accuracy = 0.309800
 epoch 5/30. Took 0.34943 seconds. 
  Full-batch training loss = 2.150136, test loss = 2.154549
  Training set accuracy = 0.368500, Test set accuracy = 0.357500
 epoch 6/30. Took 0.34974 seconds. 
  Full-batch training loss = 2.077159, test loss = 2.082548
  Training set accuracy = 0.455500, Test set accuracy = 0.433000
 epoch 7/30. Took 0.31918 seconds. 
  Full-batch training loss = 1.971840, test loss = 1.979840
  Training set accuracy = 0.466000, Test set accuracy = 0.443100
 epoch 8/30. Took 0.32047 seconds. 
  Full-batch training loss = 1.826023, test loss = 1.834893
  Training set accuracy = 0.539500, Test set accuracy = 0.518300
 epoch 9/30. Took 0.32205 seconds. 
  Full-batch training loss = 1.638300, test loss = 1.647328
  Training set accuracy = 0.589500, Test set accuracy = 0.570300
 epoch 10/30. Took 0.3225 seconds. 
  Full-batch training loss = 1.425799, test loss = 1.434514
  Training set accuracy = 0.643500, Test set accuracy = 0.633600
 epoch 11/30. Took 0.33623 seconds. 
  Full-batch training loss = 1.220887, test loss = 1.227049
  Training set accuracy = 0.689000, Test set accuracy = 0.686600
 epoch 12/30. Took 0.38444 seconds. 
  Full-batch training loss = 1.048514, test loss = 1.053057
  Training set accuracy = 0.752500, Test set accuracy = 0.746500
 epoch 13/30. Took 0.32381 seconds. 
  Full-batch training loss = 0.914520, test loss = 0.916905
  Training set accuracy = 0.785500, Test set accuracy = 0.779300
 epoch 14/30. Took 0.38078 seconds. 
  Full-batch training loss = 0.817246, test loss = 0.831150
  Training set accuracy = 0.766000, Test set accuracy = 0.765100
 epoch 15/30. Took 0.32176 seconds. 
  Full-batch training loss = 0.724055, test loss = 0.734783
  Training set accuracy = 0.821500, Test set accuracy = 0.810500
 epoch 16/30. Took 0.33875 seconds. 
  Full-batch training loss = 0.663918, test loss = 0.678898
  Training set accuracy = 0.822000, Test set accuracy = 0.812700
 epoch 17/30. Took 0.31997 seconds. 
  Full-batch training loss = 0.610268, test loss = 0.636688
  Training set accuracy = 0.838000, Test set accuracy = 0.823400
 epoch 18/30. Took 0.32413 seconds. 
  Full-batch training loss = 0.564444, test loss = 0.594264
  Training set accuracy = 0.852000, Test set accuracy = 0.832400
 epoch 19/30. Took 0.31829 seconds. 
  Full-batch training loss = 0.521460, test loss = 0.549427
  Training set accuracy = 0.872500, Test set accuracy = 0.846500
 epoch 20/30. Took 0.32126 seconds. 
  Full-batch training loss = 0.490652, test loss = 0.524284
  Training set accuracy = 0.872000, Test set accuracy = 0.849200
 epoch 21/30. Took 0.34553 seconds. 
  Full-batch training loss = 0.466829, test loss = 0.508646
  Training set accuracy = 0.874000, Test set accuracy = 0.850700
 epoch 22/30. Took 0.33049 seconds. 
  Full-batch training loss = 0.440144, test loss = 0.482917
  Training set accuracy = 0.884000, Test set accuracy = 0.861000
 epoch 23/30. Took 0.31943 seconds. 
  Full-batch training loss = 0.417904, test loss = 0.468341
  Training set accuracy = 0.889500, Test set accuracy = 0.863000
 epoch 24/30. Took 0.32122 seconds. 
  Full-batch training loss = 0.398551, test loss = 0.455480
  Training set accuracy = 0.891000, Test set accuracy = 0.865700
 epoch 25/30. Took 0.34265 seconds. 
  Full-batch training loss = 0.383728, test loss = 0.445605
  Training set accuracy = 0.897000, Test set accuracy = 0.866600
 epoch 26/30. Took 0.33847 seconds. 
  Full-batch training loss = 0.367156, test loss = 0.433879
  Training set accuracy = 0.901000, Test set accuracy = 0.872000
 epoch 27/30. Took 0.34156 seconds. 
  Full-batch training loss = 0.351130, test loss = 0.419146
  Training set accuracy = 0.904500, Test set accuracy = 0.877100
 epoch 28/30. Took 0.35984 seconds. 
  Full-batch training loss = 0.341819, test loss = 0.416223
  Training set accuracy = 0.908000, Test set accuracy = 0.877100
 epoch 29/30. Took 0.31992 seconds. 
  Full-batch training loss = 0.325997, test loss = 0.401067
  Training set accuracy = 0.910500, Test set accuracy = 0.881100
 epoch 30/30. Took 0.33293 seconds. 
  Full-batch training loss = 0.317620, test loss = 0.400341
  Training set accuracy = 0.916000, Test set accuracy = 0.881200
Elapsed time is 32.275683 seconds.
End Training
-----
Params 2000 0.010 0.40 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.044724 seconds. 
  Full-batch training loss = 2.170536, test loss = 2.175764
  Training set accuracy = 0.388000, Test set accuracy = 0.383100
 epoch 2/30. Took 0.039488 seconds. 
  Full-batch training loss = 1.991760, test loss = 1.996227
  Training set accuracy = 0.592500, Test set accuracy = 0.580200
 epoch 3/30. Took 0.038959 seconds. 
  Full-batch training loss = 1.780369, test loss = 1.783470
  Training set accuracy = 0.675500, Test set accuracy = 0.668100
 epoch 4/30. Took 0.036676 seconds. 
  Full-batch training loss = 1.566947, test loss = 1.571733
  Training set accuracy = 0.712000, Test set accuracy = 0.705700
 epoch 5/30. Took 0.03663 seconds. 
  Full-batch training loss = 1.368061, test loss = 1.373089
  Training set accuracy = 0.757500, Test set accuracy = 0.744100
 epoch 6/30. Took 0.036845 seconds. 
  Full-batch training loss = 1.199165, test loss = 1.205354
  Training set accuracy = 0.772500, Test set accuracy = 0.768200
 epoch 7/30. Took 0.036316 seconds. 
  Full-batch training loss = 1.066386, test loss = 1.074401
  Training set accuracy = 0.803500, Test set accuracy = 0.789200
 epoch 8/30. Took 0.037792 seconds. 
  Full-batch training loss = 0.959968, test loss = 0.969817
  Training set accuracy = 0.824000, Test set accuracy = 0.804400
 epoch 9/30. Took 0.038058 seconds. 
  Full-batch training loss = 0.875772, test loss = 0.888721
  Training set accuracy = 0.831000, Test set accuracy = 0.808900
 epoch 10/30. Took 0.038473 seconds. 
  Full-batch training loss = 0.804922, test loss = 0.820646
  Training set accuracy = 0.847500, Test set accuracy = 0.822400
 epoch 11/30. Took 0.0386 seconds. 
  Full-batch training loss = 0.748023, test loss = 0.766255
  Training set accuracy = 0.855000, Test set accuracy = 0.830000
 epoch 12/30. Took 0.04835 seconds. 
  Full-batch training loss = 0.700913, test loss = 0.721130
  Training set accuracy = 0.866500, Test set accuracy = 0.839000
 epoch 13/30. Took 0.039733 seconds. 
  Full-batch training loss = 0.663066, test loss = 0.685474
  Training set accuracy = 0.864500, Test set accuracy = 0.843600
 epoch 14/30. Took 0.036637 seconds. 
  Full-batch training loss = 0.628286, test loss = 0.654658
  Training set accuracy = 0.876000, Test set accuracy = 0.849500
 epoch 15/30. Took 0.040062 seconds. 
  Full-batch training loss = 0.598235, test loss = 0.627112
  Training set accuracy = 0.878500, Test set accuracy = 0.852300
 epoch 16/30. Took 0.041735 seconds. 
  Full-batch training loss = 0.572720, test loss = 0.603198
  Training set accuracy = 0.883500, Test set accuracy = 0.856100
 epoch 17/30. Took 0.037902 seconds. 
  Full-batch training loss = 0.548155, test loss = 0.582507
  Training set accuracy = 0.884500, Test set accuracy = 0.858200
 epoch 18/30. Took 0.039323 seconds. 
  Full-batch training loss = 0.527590, test loss = 0.562817
  Training set accuracy = 0.887000, Test set accuracy = 0.863200
 epoch 19/30. Took 0.038138 seconds. 
  Full-batch training loss = 0.508388, test loss = 0.546212
  Training set accuracy = 0.891500, Test set accuracy = 0.865200
 epoch 20/30. Took 0.03832 seconds. 
  Full-batch training loss = 0.490704, test loss = 0.531308
  Training set accuracy = 0.893500, Test set accuracy = 0.868000
 epoch 21/30. Took 0.039134 seconds. 
  Full-batch training loss = 0.476083, test loss = 0.518733
  Training set accuracy = 0.892000, Test set accuracy = 0.869200
 epoch 22/30. Took 0.038422 seconds. 
  Full-batch training loss = 0.462387, test loss = 0.505740
  Training set accuracy = 0.897500, Test set accuracy = 0.870600
 epoch 23/30. Took 0.038063 seconds. 
  Full-batch training loss = 0.449590, test loss = 0.496450
  Training set accuracy = 0.899500, Test set accuracy = 0.872800
 epoch 24/30. Took 0.039238 seconds. 
  Full-batch training loss = 0.438172, test loss = 0.486781
  Training set accuracy = 0.900000, Test set accuracy = 0.873200
 epoch 25/30. Took 0.038465 seconds. 
  Full-batch training loss = 0.427115, test loss = 0.477951
  Training set accuracy = 0.904000, Test set accuracy = 0.875200
 epoch 26/30. Took 0.038022 seconds. 
  Full-batch training loss = 0.417452, test loss = 0.470600
  Training set accuracy = 0.902500, Test set accuracy = 0.876400
 epoch 27/30. Took 0.0397 seconds. 
  Full-batch training loss = 0.407611, test loss = 0.462213
  Training set accuracy = 0.905000, Test set accuracy = 0.879200
 epoch 28/30. Took 0.038498 seconds. 
  Full-batch training loss = 0.398580, test loss = 0.455212
  Training set accuracy = 0.909000, Test set accuracy = 0.877300
 epoch 29/30. Took 0.038078 seconds. 
  Full-batch training loss = 0.391063, test loss = 0.448529
  Training set accuracy = 0.910000, Test set accuracy = 0.880400
 epoch 30/30. Took 0.040964 seconds. 
  Full-batch training loss = 0.383390, test loss = 0.444738
  Training set accuracy = 0.911000, Test set accuracy = 0.879900
Elapsed time is 5.080653 seconds.
End Training
-----
Params 2000 0.010 0.40 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.068117 seconds. 
  Full-batch training loss = 2.167128, test loss = 2.167760
  Training set accuracy = 0.477000, Test set accuracy = 0.470300
 epoch 2/30. Took 0.061405 seconds. 
  Full-batch training loss = 1.982575, test loss = 1.981305
  Training set accuracy = 0.684500, Test set accuracy = 0.670000
 epoch 3/30. Took 0.063007 seconds. 
  Full-batch training loss = 1.773438, test loss = 1.769580
  Training set accuracy = 0.724000, Test set accuracy = 0.720500
 epoch 4/30. Took 0.060108 seconds. 
  Full-batch training loss = 1.555664, test loss = 1.549411
  Training set accuracy = 0.760000, Test set accuracy = 0.754900
 epoch 5/30. Took 0.060696 seconds. 
  Full-batch training loss = 1.351393, test loss = 1.343659
  Training set accuracy = 0.781500, Test set accuracy = 0.778100
 epoch 6/30. Took 0.062654 seconds. 
  Full-batch training loss = 1.177929, test loss = 1.170733
  Training set accuracy = 0.800000, Test set accuracy = 0.797000
 epoch 7/30. Took 0.061714 seconds. 
  Full-batch training loss = 1.036754, test loss = 1.030177
  Training set accuracy = 0.813000, Test set accuracy = 0.811800
 epoch 8/30. Took 0.063144 seconds. 
  Full-batch training loss = 0.928139, test loss = 0.923349
  Training set accuracy = 0.822000, Test set accuracy = 0.818900
 epoch 9/30. Took 0.062065 seconds. 
  Full-batch training loss = 0.843177, test loss = 0.840425
  Training set accuracy = 0.834500, Test set accuracy = 0.830800
 epoch 10/30. Took 0.060836 seconds. 
  Full-batch training loss = 0.775429, test loss = 0.775277
  Training set accuracy = 0.844500, Test set accuracy = 0.842300
 epoch 11/30. Took 0.063511 seconds. 
  Full-batch training loss = 0.720699, test loss = 0.721371
  Training set accuracy = 0.850000, Test set accuracy = 0.845300
 epoch 12/30. Took 0.064588 seconds. 
  Full-batch training loss = 0.676119, test loss = 0.679934
  Training set accuracy = 0.853500, Test set accuracy = 0.853100
 epoch 13/30. Took 0.059848 seconds. 
  Full-batch training loss = 0.637874, test loss = 0.643941
  Training set accuracy = 0.858000, Test set accuracy = 0.857000
 epoch 14/30. Took 0.060742 seconds. 
  Full-batch training loss = 0.605469, test loss = 0.613697
  Training set accuracy = 0.866500, Test set accuracy = 0.861600
 epoch 15/30. Took 0.061591 seconds. 
  Full-batch training loss = 0.578385, test loss = 0.589353
  Training set accuracy = 0.868500, Test set accuracy = 0.864700
 epoch 16/30. Took 0.061038 seconds. 
  Full-batch training loss = 0.553852, test loss = 0.566085
  Training set accuracy = 0.871000, Test set accuracy = 0.868400
 epoch 17/30. Took 0.063374 seconds. 
  Full-batch training loss = 0.532397, test loss = 0.547122
  Training set accuracy = 0.874500, Test set accuracy = 0.871500
 epoch 18/30. Took 0.060885 seconds. 
  Full-batch training loss = 0.514045, test loss = 0.530176
  Training set accuracy = 0.879000, Test set accuracy = 0.874300
 epoch 19/30. Took 0.060913 seconds. 
  Full-batch training loss = 0.495771, test loss = 0.515524
  Training set accuracy = 0.881000, Test set accuracy = 0.876100
 epoch 20/30. Took 0.069547 seconds. 
  Full-batch training loss = 0.480003, test loss = 0.502657
  Training set accuracy = 0.882000, Test set accuracy = 0.878600
 epoch 21/30. Took 0.060767 seconds. 
  Full-batch training loss = 0.465471, test loss = 0.489432
  Training set accuracy = 0.885000, Test set accuracy = 0.879400
 epoch 22/30. Took 0.063616 seconds. 
  Full-batch training loss = 0.452391, test loss = 0.478458
  Training set accuracy = 0.891500, Test set accuracy = 0.880300
 epoch 23/30. Took 0.060734 seconds. 
  Full-batch training loss = 0.440180, test loss = 0.468757
  Training set accuracy = 0.894000, Test set accuracy = 0.882600
 epoch 24/30. Took 0.064855 seconds. 
  Full-batch training loss = 0.429141, test loss = 0.461088
  Training set accuracy = 0.897500, Test set accuracy = 0.882500
 epoch 25/30. Took 0.076284 seconds. 
  Full-batch training loss = 0.418252, test loss = 0.451043
  Training set accuracy = 0.897500, Test set accuracy = 0.884200
 epoch 26/30. Took 0.061561 seconds. 
  Full-batch training loss = 0.409069, test loss = 0.443042
  Training set accuracy = 0.901500, Test set accuracy = 0.883900
 epoch 27/30. Took 0.063348 seconds. 
  Full-batch training loss = 0.399365, test loss = 0.436883
  Training set accuracy = 0.902000, Test set accuracy = 0.887500
 epoch 28/30. Took 0.064417 seconds. 
  Full-batch training loss = 0.391611, test loss = 0.431198
  Training set accuracy = 0.905000, Test set accuracy = 0.886800
 epoch 29/30. Took 0.063071 seconds. 
  Full-batch training loss = 0.383362, test loss = 0.425278
  Training set accuracy = 0.906000, Test set accuracy = 0.889100
 epoch 30/30. Took 0.064319 seconds. 
  Full-batch training loss = 0.376317, test loss = 0.420245
  Training set accuracy = 0.906500, Test set accuracy = 0.891400
Elapsed time is 7.344151 seconds.
End Training
-----
Params 2000 0.010 0.40 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14051 seconds. 
  Full-batch training loss = 2.096592, test loss = 2.107320
  Training set accuracy = 0.513500, Test set accuracy = 0.499400
 epoch 2/30. Took 0.14437 seconds. 
  Full-batch training loss = 1.861472, test loss = 1.878188
  Training set accuracy = 0.674000, Test set accuracy = 0.647500
 epoch 3/30. Took 0.13898 seconds. 
  Full-batch training loss = 1.622223, test loss = 1.641046
  Training set accuracy = 0.740500, Test set accuracy = 0.714000
 epoch 4/30. Took 0.13855 seconds. 
  Full-batch training loss = 1.395700, test loss = 1.415844
  Training set accuracy = 0.774000, Test set accuracy = 0.748200
 epoch 5/30. Took 0.13818 seconds. 
  Full-batch training loss = 1.199448, test loss = 1.219436
  Training set accuracy = 0.803500, Test set accuracy = 0.779300
 epoch 6/30. Took 0.13884 seconds. 
  Full-batch training loss = 1.042928, test loss = 1.062330
  Training set accuracy = 0.820500, Test set accuracy = 0.802400
 epoch 7/30. Took 0.14661 seconds. 
  Full-batch training loss = 0.921277, test loss = 0.944308
  Training set accuracy = 0.829500, Test set accuracy = 0.810500
 epoch 8/30. Took 0.13571 seconds. 
  Full-batch training loss = 0.827497, test loss = 0.852656
  Training set accuracy = 0.842500, Test set accuracy = 0.820300
 epoch 9/30. Took 0.13742 seconds. 
  Full-batch training loss = 0.754092, test loss = 0.781760
  Training set accuracy = 0.845500, Test set accuracy = 0.826200
 epoch 10/30. Took 0.13641 seconds. 
  Full-batch training loss = 0.695789, test loss = 0.725406
  Training set accuracy = 0.855000, Test set accuracy = 0.836300
 epoch 11/30. Took 0.1357 seconds. 
  Full-batch training loss = 0.649302, test loss = 0.683572
  Training set accuracy = 0.866000, Test set accuracy = 0.838000
 epoch 12/30. Took 0.13625 seconds. 
  Full-batch training loss = 0.609461, test loss = 0.644937
  Training set accuracy = 0.869500, Test set accuracy = 0.845500
 epoch 13/30. Took 0.13249 seconds. 
  Full-batch training loss = 0.576595, test loss = 0.614239
  Training set accuracy = 0.875000, Test set accuracy = 0.847900
 epoch 14/30. Took 0.13818 seconds. 
  Full-batch training loss = 0.547808, test loss = 0.589267
  Training set accuracy = 0.875500, Test set accuracy = 0.852700
 epoch 15/30. Took 0.13761 seconds. 
  Full-batch training loss = 0.523348, test loss = 0.567606
  Training set accuracy = 0.881000, Test set accuracy = 0.857300
 epoch 16/30. Took 0.13872 seconds. 
  Full-batch training loss = 0.502028, test loss = 0.548622
  Training set accuracy = 0.886000, Test set accuracy = 0.862100
 epoch 17/30. Took 0.15563 seconds. 
  Full-batch training loss = 0.483251, test loss = 0.531689
  Training set accuracy = 0.892000, Test set accuracy = 0.863800
 epoch 18/30. Took 0.14579 seconds. 
  Full-batch training loss = 0.465951, test loss = 0.516212
  Training set accuracy = 0.893000, Test set accuracy = 0.869700
 epoch 19/30. Took 0.13789 seconds. 
  Full-batch training loss = 0.451424, test loss = 0.506086
  Training set accuracy = 0.896500, Test set accuracy = 0.867000
 epoch 20/30. Took 0.13568 seconds. 
  Full-batch training loss = 0.437307, test loss = 0.492845
  Training set accuracy = 0.900500, Test set accuracy = 0.871900
 epoch 21/30. Took 0.13689 seconds. 
  Full-batch training loss = 0.424041, test loss = 0.482653
  Training set accuracy = 0.900000, Test set accuracy = 0.873500
 epoch 22/30. Took 0.14253 seconds. 
  Full-batch training loss = 0.412650, test loss = 0.473145
  Training set accuracy = 0.902000, Test set accuracy = 0.874100
 epoch 23/30. Took 0.1335 seconds. 
  Full-batch training loss = 0.402018, test loss = 0.465442
  Training set accuracy = 0.903000, Test set accuracy = 0.876800
 epoch 24/30. Took 0.15179 seconds. 
  Full-batch training loss = 0.391790, test loss = 0.457737
  Training set accuracy = 0.903000, Test set accuracy = 0.876300
 epoch 25/30. Took 0.15514 seconds. 
  Full-batch training loss = 0.382569, test loss = 0.449762
  Training set accuracy = 0.906500, Test set accuracy = 0.879700
 epoch 26/30. Took 0.13784 seconds. 
  Full-batch training loss = 0.373860, test loss = 0.444469
  Training set accuracy = 0.905000, Test set accuracy = 0.878900
 epoch 27/30. Took 0.13201 seconds. 
  Full-batch training loss = 0.365720, test loss = 0.437813
  Training set accuracy = 0.912500, Test set accuracy = 0.880500
 epoch 28/30. Took 0.13593 seconds. 
  Full-batch training loss = 0.358082, test loss = 0.431279
  Training set accuracy = 0.915000, Test set accuracy = 0.881800
 epoch 29/30. Took 0.13673 seconds. 
  Full-batch training loss = 0.351124, test loss = 0.426899
  Training set accuracy = 0.916000, Test set accuracy = 0.881600
 epoch 30/30. Took 0.13266 seconds. 
  Full-batch training loss = 0.344142, test loss = 0.422137
  Training set accuracy = 0.918500, Test set accuracy = 0.882600
Elapsed time is 14.499684 seconds.
End Training
-----
Params 2000 0.010 0.40 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.050168 seconds. 
  Full-batch training loss = 2.276500, test loss = 2.277391
  Training set accuracy = 0.137500, Test set accuracy = 0.138800
 epoch 2/30. Took 0.049636 seconds. 
  Full-batch training loss = 2.241836, test loss = 2.243927
  Training set accuracy = 0.278500, Test set accuracy = 0.269500
 epoch 3/30. Took 0.046141 seconds. 
  Full-batch training loss = 2.198707, test loss = 2.201916
  Training set accuracy = 0.464500, Test set accuracy = 0.435800
 epoch 4/30. Took 0.046091 seconds. 
  Full-batch training loss = 2.141272, test loss = 2.145349
  Training set accuracy = 0.555000, Test set accuracy = 0.531400
 epoch 5/30. Took 0.046352 seconds. 
  Full-batch training loss = 2.071641, test loss = 2.076393
  Training set accuracy = 0.616000, Test set accuracy = 0.592500
 epoch 6/30. Took 0.048863 seconds. 
  Full-batch training loss = 1.980891, test loss = 1.986358
  Training set accuracy = 0.623000, Test set accuracy = 0.600500
 epoch 7/30. Took 0.046042 seconds. 
  Full-batch training loss = 1.876490, test loss = 1.882507
  Training set accuracy = 0.650000, Test set accuracy = 0.630400
 epoch 8/30. Took 0.045565 seconds. 
  Full-batch training loss = 1.754967, test loss = 1.762898
  Training set accuracy = 0.655500, Test set accuracy = 0.636900
 epoch 9/30. Took 0.046112 seconds. 
  Full-batch training loss = 1.616832, test loss = 1.626586
  Training set accuracy = 0.665500, Test set accuracy = 0.646900
 epoch 10/30. Took 0.046482 seconds. 
  Full-batch training loss = 1.478965, test loss = 1.490939
  Training set accuracy = 0.678500, Test set accuracy = 0.657600
 epoch 11/30. Took 0.056075 seconds. 
  Full-batch training loss = 1.343561, test loss = 1.357160
  Training set accuracy = 0.690000, Test set accuracy = 0.672700
 epoch 12/30. Took 0.045578 seconds. 
  Full-batch training loss = 1.217704, test loss = 1.233266
  Training set accuracy = 0.712500, Test set accuracy = 0.694700
 epoch 13/30. Took 0.05136 seconds. 
  Full-batch training loss = 1.111930, test loss = 1.130983
  Training set accuracy = 0.732000, Test set accuracy = 0.710300
 epoch 14/30. Took 0.047612 seconds. 
  Full-batch training loss = 1.019274, test loss = 1.039553
  Training set accuracy = 0.763500, Test set accuracy = 0.737300
 epoch 15/30. Took 0.048577 seconds. 
  Full-batch training loss = 0.946156, test loss = 0.971083
  Training set accuracy = 0.779000, Test set accuracy = 0.756800
 epoch 16/30. Took 0.0508 seconds. 
  Full-batch training loss = 0.887088, test loss = 0.916167
  Training set accuracy = 0.785000, Test set accuracy = 0.762400
 epoch 17/30. Took 0.046176 seconds. 
  Full-batch training loss = 0.834395, test loss = 0.864952
  Training set accuracy = 0.795500, Test set accuracy = 0.775200
 epoch 18/30. Took 0.045928 seconds. 
  Full-batch training loss = 0.786205, test loss = 0.818551
  Training set accuracy = 0.812500, Test set accuracy = 0.791200
 epoch 19/30. Took 0.048164 seconds. 
  Full-batch training loss = 0.747204, test loss = 0.781866
  Training set accuracy = 0.824500, Test set accuracy = 0.802400
 epoch 20/30. Took 0.045769 seconds. 
  Full-batch training loss = 0.713804, test loss = 0.751186
  Training set accuracy = 0.829500, Test set accuracy = 0.808900
 epoch 21/30. Took 0.045765 seconds. 
  Full-batch training loss = 0.683866, test loss = 0.724216
  Training set accuracy = 0.831500, Test set accuracy = 0.807200
 epoch 22/30. Took 0.048653 seconds. 
  Full-batch training loss = 0.656210, test loss = 0.698501
  Training set accuracy = 0.833000, Test set accuracy = 0.816500
 epoch 23/30. Took 0.048956 seconds. 
  Full-batch training loss = 0.634550, test loss = 0.680612
  Training set accuracy = 0.846000, Test set accuracy = 0.823200
 epoch 24/30. Took 0.046469 seconds. 
  Full-batch training loss = 0.613982, test loss = 0.660377
  Training set accuracy = 0.846000, Test set accuracy = 0.823700
 epoch 25/30. Took 0.046488 seconds. 
  Full-batch training loss = 0.592330, test loss = 0.642535
  Training set accuracy = 0.852000, Test set accuracy = 0.830600
 epoch 26/30. Took 0.046326 seconds. 
  Full-batch training loss = 0.576032, test loss = 0.626587
  Training set accuracy = 0.853500, Test set accuracy = 0.831600
 epoch 27/30. Took 0.049267 seconds. 
  Full-batch training loss = 0.556962, test loss = 0.610952
  Training set accuracy = 0.858000, Test set accuracy = 0.837200
 epoch 28/30. Took 0.050451 seconds. 
  Full-batch training loss = 0.540743, test loss = 0.595281
  Training set accuracy = 0.865000, Test set accuracy = 0.838500
 epoch 29/30. Took 0.045966 seconds. 
  Full-batch training loss = 0.526047, test loss = 0.582593
  Training set accuracy = 0.866000, Test set accuracy = 0.844400
 epoch 30/30. Took 0.048211 seconds. 
  Full-batch training loss = 0.512398, test loss = 0.572043
  Training set accuracy = 0.871000, Test set accuracy = 0.846600
Elapsed time is 5.624685 seconds.
End Training
-----
Params 2000 0.010 0.40 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.10127 seconds. 
  Full-batch training loss = 2.275012, test loss = 2.276362
  Training set accuracy = 0.148000, Test set accuracy = 0.147600
 epoch 2/30. Took 0.096254 seconds. 
  Full-batch training loss = 2.235351, test loss = 2.237101
  Training set accuracy = 0.408500, Test set accuracy = 0.404400
 epoch 3/30. Took 0.085948 seconds. 
  Full-batch training loss = 2.188570, test loss = 2.191089
  Training set accuracy = 0.449500, Test set accuracy = 0.455700
 epoch 4/30. Took 0.090694 seconds. 
  Full-batch training loss = 2.129434, test loss = 2.132377
  Training set accuracy = 0.498500, Test set accuracy = 0.498000
 epoch 5/30. Took 0.083368 seconds. 
  Full-batch training loss = 2.053036, test loss = 2.057168
  Training set accuracy = 0.509000, Test set accuracy = 0.504900
 epoch 6/30. Took 0.08781 seconds. 
  Full-batch training loss = 1.957377, test loss = 1.962583
  Training set accuracy = 0.573000, Test set accuracy = 0.578000
 epoch 7/30. Took 0.087056 seconds. 
  Full-batch training loss = 1.837890, test loss = 1.843466
  Training set accuracy = 0.631000, Test set accuracy = 0.632900
 epoch 8/30. Took 0.091794 seconds. 
  Full-batch training loss = 1.693903, test loss = 1.700488
  Training set accuracy = 0.661000, Test set accuracy = 0.667200
 epoch 9/30. Took 0.088609 seconds. 
  Full-batch training loss = 1.535851, test loss = 1.541607
  Training set accuracy = 0.687000, Test set accuracy = 0.699400
 epoch 10/30. Took 0.088647 seconds. 
  Full-batch training loss = 1.379556, test loss = 1.385324
  Training set accuracy = 0.720500, Test set accuracy = 0.722000
 epoch 11/30. Took 0.088965 seconds. 
  Full-batch training loss = 1.237078, test loss = 1.242722
  Training set accuracy = 0.744500, Test set accuracy = 0.746500
 epoch 12/30. Took 0.086634 seconds. 
  Full-batch training loss = 1.111144, test loss = 1.118332
  Training set accuracy = 0.769000, Test set accuracy = 0.766300
 epoch 13/30. Took 0.086418 seconds. 
  Full-batch training loss = 1.006025, test loss = 1.015265
  Training set accuracy = 0.782000, Test set accuracy = 0.780200
 epoch 14/30. Took 0.087262 seconds. 
  Full-batch training loss = 0.920169, test loss = 0.930286
  Training set accuracy = 0.801500, Test set accuracy = 0.791300
 epoch 15/30. Took 0.087032 seconds. 
  Full-batch training loss = 0.848411, test loss = 0.862184
  Training set accuracy = 0.801000, Test set accuracy = 0.798400
 epoch 16/30. Took 0.087613 seconds. 
  Full-batch training loss = 0.791558, test loss = 0.808458
  Training set accuracy = 0.820000, Test set accuracy = 0.808900
 epoch 17/30. Took 0.089642 seconds. 
  Full-batch training loss = 0.739480, test loss = 0.757806
  Training set accuracy = 0.834500, Test set accuracy = 0.818400
 epoch 18/30. Took 0.087509 seconds. 
  Full-batch training loss = 0.695422, test loss = 0.717522
  Training set accuracy = 0.841000, Test set accuracy = 0.826700
 epoch 19/30. Took 0.086161 seconds. 
  Full-batch training loss = 0.659919, test loss = 0.685926
  Training set accuracy = 0.845500, Test set accuracy = 0.828300
 epoch 20/30. Took 0.08829 seconds. 
  Full-batch training loss = 0.625867, test loss = 0.655237
  Training set accuracy = 0.862000, Test set accuracy = 0.836200
 epoch 21/30. Took 0.087685 seconds. 
  Full-batch training loss = 0.594652, test loss = 0.626752
  Training set accuracy = 0.869000, Test set accuracy = 0.841700
 epoch 22/30. Took 0.083306 seconds. 
  Full-batch training loss = 0.568501, test loss = 0.604950
  Training set accuracy = 0.862500, Test set accuracy = 0.843200
 epoch 23/30. Took 0.084428 seconds. 
  Full-batch training loss = 0.546482, test loss = 0.584124
  Training set accuracy = 0.870500, Test set accuracy = 0.846700
 epoch 24/30. Took 0.088094 seconds. 
  Full-batch training loss = 0.524875, test loss = 0.564962
  Training set accuracy = 0.877000, Test set accuracy = 0.852800
 epoch 25/30. Took 0.087425 seconds. 
  Full-batch training loss = 0.504020, test loss = 0.547728
  Training set accuracy = 0.885000, Test set accuracy = 0.856600
 epoch 26/30. Took 0.086475 seconds. 
  Full-batch training loss = 0.488434, test loss = 0.534435
  Training set accuracy = 0.884000, Test set accuracy = 0.856800
 epoch 27/30. Took 0.088711 seconds. 
  Full-batch training loss = 0.474113, test loss = 0.523176
  Training set accuracy = 0.886500, Test set accuracy = 0.858700
 epoch 28/30. Took 0.084068 seconds. 
  Full-batch training loss = 0.458772, test loss = 0.509373
  Training set accuracy = 0.896500, Test set accuracy = 0.862900
 epoch 29/30. Took 0.088105 seconds. 
  Full-batch training loss = 0.448556, test loss = 0.502998
  Training set accuracy = 0.888500, Test set accuracy = 0.860100
 epoch 30/30. Took 0.086722 seconds. 
  Full-batch training loss = 0.433653, test loss = 0.489837
  Training set accuracy = 0.895000, Test set accuracy = 0.865800
Elapsed time is 9.374217 seconds.
End Training
-----
Params 2000 0.010 0.40 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23526 seconds. 
  Full-batch training loss = 2.262237, test loss = 2.261969
  Training set accuracy = 0.144000, Test set accuracy = 0.143600
 epoch 2/30. Took 0.23503 seconds. 
  Full-batch training loss = 2.208487, test loss = 2.209378
  Training set accuracy = 0.492000, Test set accuracy = 0.490700
 epoch 3/30. Took 0.23058 seconds. 
  Full-batch training loss = 2.144971, test loss = 2.146892
  Training set accuracy = 0.588500, Test set accuracy = 0.574400
 epoch 4/30. Took 0.25275 seconds. 
  Full-batch training loss = 2.063487, test loss = 2.066609
  Training set accuracy = 0.633500, Test set accuracy = 0.620900
 epoch 5/30. Took 0.22916 seconds. 
  Full-batch training loss = 1.956965, test loss = 1.960935
  Training set accuracy = 0.663500, Test set accuracy = 0.655100
 epoch 6/30. Took 0.23387 seconds. 
  Full-batch training loss = 1.820038, test loss = 1.824093
  Training set accuracy = 0.706500, Test set accuracy = 0.700500
 epoch 7/30. Took 0.26677 seconds. 
  Full-batch training loss = 1.653024, test loss = 1.658216
  Training set accuracy = 0.704000, Test set accuracy = 0.701200
 epoch 8/30. Took 0.23199 seconds. 
  Full-batch training loss = 1.468259, test loss = 1.472601
  Training set accuracy = 0.735500, Test set accuracy = 0.739000
 epoch 9/30. Took 0.23059 seconds. 
  Full-batch training loss = 1.288495, test loss = 1.291401
  Training set accuracy = 0.762000, Test set accuracy = 0.771300
 epoch 10/30. Took 0.23294 seconds. 
  Full-batch training loss = 1.127998, test loss = 1.130793
  Training set accuracy = 0.770000, Test set accuracy = 0.775900
 epoch 11/30. Took 0.22937 seconds. 
  Full-batch training loss = 0.998386, test loss = 0.999407
  Training set accuracy = 0.787500, Test set accuracy = 0.799700
 epoch 12/30. Took 0.23232 seconds. 
  Full-batch training loss = 0.892256, test loss = 0.896805
  Training set accuracy = 0.798000, Test set accuracy = 0.805900
 epoch 13/30. Took 0.2447 seconds. 
  Full-batch training loss = 0.808711, test loss = 0.812905
  Training set accuracy = 0.817500, Test set accuracy = 0.816700
 epoch 14/30. Took 0.23251 seconds. 
  Full-batch training loss = 0.742263, test loss = 0.746939
  Training set accuracy = 0.829500, Test set accuracy = 0.827900
 epoch 15/30. Took 0.22844 seconds. 
  Full-batch training loss = 0.689963, test loss = 0.696988
  Training set accuracy = 0.833500, Test set accuracy = 0.831200
 epoch 16/30. Took 0.231 seconds. 
  Full-batch training loss = 0.646933, test loss = 0.655239
  Training set accuracy = 0.842000, Test set accuracy = 0.836900
 epoch 17/30. Took 0.22905 seconds. 
  Full-batch training loss = 0.608379, test loss = 0.619411
  Training set accuracy = 0.849500, Test set accuracy = 0.846700
 epoch 18/30. Took 0.23221 seconds. 
  Full-batch training loss = 0.578034, test loss = 0.592486
  Training set accuracy = 0.852500, Test set accuracy = 0.846300
 epoch 19/30. Took 0.23174 seconds. 
  Full-batch training loss = 0.551969, test loss = 0.567169
  Training set accuracy = 0.863000, Test set accuracy = 0.856900
 epoch 20/30. Took 0.23181 seconds. 
  Full-batch training loss = 0.528490, test loss = 0.545254
  Training set accuracy = 0.864500, Test set accuracy = 0.854500
 epoch 21/30. Took 0.22858 seconds. 
  Full-batch training loss = 0.506675, test loss = 0.528455
  Training set accuracy = 0.867500, Test set accuracy = 0.863500
 epoch 22/30. Took 0.23071 seconds. 
  Full-batch training loss = 0.485306, test loss = 0.507959
  Training set accuracy = 0.872500, Test set accuracy = 0.867700
 epoch 23/30. Took 0.23258 seconds. 
  Full-batch training loss = 0.468002, test loss = 0.493136
  Training set accuracy = 0.875000, Test set accuracy = 0.869000
 epoch 24/30. Took 0.26542 seconds. 
  Full-batch training loss = 0.454065, test loss = 0.481816
  Training set accuracy = 0.879000, Test set accuracy = 0.870900
 epoch 25/30. Took 0.24926 seconds. 
  Full-batch training loss = 0.439009, test loss = 0.468574
  Training set accuracy = 0.882500, Test set accuracy = 0.873400
 epoch 26/30. Took 0.23272 seconds. 
  Full-batch training loss = 0.424949, test loss = 0.456828
  Training set accuracy = 0.890500, Test set accuracy = 0.876800
 epoch 27/30. Took 0.23055 seconds. 
  Full-batch training loss = 0.416331, test loss = 0.455683
  Training set accuracy = 0.891000, Test set accuracy = 0.876900
 epoch 28/30. Took 0.2305 seconds. 
  Full-batch training loss = 0.404490, test loss = 0.442763
  Training set accuracy = 0.894000, Test set accuracy = 0.877600
 epoch 29/30. Took 0.23201 seconds. 
  Full-batch training loss = 0.394787, test loss = 0.434607
  Training set accuracy = 0.894500, Test set accuracy = 0.879500
 epoch 30/30. Took 0.22845 seconds. 
  Full-batch training loss = 0.384221, test loss = 0.426913
  Training set accuracy = 0.895500, Test set accuracy = 0.880800
Elapsed time is 23.287579 seconds.
End Training
-----
Params 2000 0.010 0.40 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.06408 seconds. 
  Full-batch training loss = 2.301828, test loss = 2.305535
  Training set accuracy = 0.106500, Test set accuracy = 0.095800
 epoch 2/30. Took 0.065687 seconds. 
  Full-batch training loss = 2.296141, test loss = 2.299651
  Training set accuracy = 0.106500, Test set accuracy = 0.095800
 epoch 3/30. Took 0.063808 seconds. 
  Full-batch training loss = 2.290810, test loss = 2.294048
  Training set accuracy = 0.106500, Test set accuracy = 0.095800
 epoch 4/30. Took 0.060228 seconds. 
  Full-batch training loss = 2.285845, test loss = 2.288959
  Training set accuracy = 0.106500, Test set accuracy = 0.095800
 epoch 5/30. Took 0.061206 seconds. 
  Full-batch training loss = 2.280547, test loss = 2.283407
  Training set accuracy = 0.107000, Test set accuracy = 0.095900
 epoch 6/30. Took 0.056327 seconds. 
  Full-batch training loss = 2.274649, test loss = 2.277267
  Training set accuracy = 0.169000, Test set accuracy = 0.158200
 epoch 7/30. Took 0.059048 seconds. 
  Full-batch training loss = 2.268231, test loss = 2.270832
  Training set accuracy = 0.213500, Test set accuracy = 0.204000
 epoch 8/30. Took 0.059478 seconds. 
  Full-batch training loss = 2.260858, test loss = 2.263328
  Training set accuracy = 0.231500, Test set accuracy = 0.219100
 epoch 9/30. Took 0.060485 seconds. 
  Full-batch training loss = 2.251908, test loss = 2.254297
  Training set accuracy = 0.266000, Test set accuracy = 0.255000
 epoch 10/30. Took 0.058618 seconds. 
  Full-batch training loss = 2.241257, test loss = 2.243524
  Training set accuracy = 0.305000, Test set accuracy = 0.284500
 epoch 11/30. Took 0.054699 seconds. 
  Full-batch training loss = 2.229076, test loss = 2.231213
  Training set accuracy = 0.341500, Test set accuracy = 0.318800
 epoch 12/30. Took 0.058689 seconds. 
  Full-batch training loss = 2.213935, test loss = 2.216011
  Training set accuracy = 0.374000, Test set accuracy = 0.352300
 epoch 13/30. Took 0.057682 seconds. 
  Full-batch training loss = 2.194974, test loss = 2.196863
  Training set accuracy = 0.410000, Test set accuracy = 0.390600
 epoch 14/30. Took 0.056641 seconds. 
  Full-batch training loss = 2.171933, test loss = 2.173606
  Training set accuracy = 0.438000, Test set accuracy = 0.416200
 epoch 15/30. Took 0.05675 seconds. 
  Full-batch training loss = 2.143387, test loss = 2.144723
  Training set accuracy = 0.453000, Test set accuracy = 0.436500
 epoch 16/30. Took 0.05762 seconds. 
  Full-batch training loss = 2.108791, test loss = 2.109770
  Training set accuracy = 0.483500, Test set accuracy = 0.468300
 epoch 17/30. Took 0.059589 seconds. 
  Full-batch training loss = 2.065107, test loss = 2.066035
  Training set accuracy = 0.501500, Test set accuracy = 0.489900
 epoch 18/30. Took 0.060061 seconds. 
  Full-batch training loss = 2.010077, test loss = 2.010985
  Training set accuracy = 0.510500, Test set accuracy = 0.502400
 epoch 19/30. Took 0.058023 seconds. 
  Full-batch training loss = 1.951206, test loss = 1.952494
  Training set accuracy = 0.531500, Test set accuracy = 0.530200
 epoch 20/30. Took 0.059462 seconds. 
  Full-batch training loss = 1.882479, test loss = 1.884018
  Training set accuracy = 0.537000, Test set accuracy = 0.537300
 epoch 21/30. Took 0.066171 seconds. 
  Full-batch training loss = 1.809092, test loss = 1.810893
  Training set accuracy = 0.568500, Test set accuracy = 0.570700
 epoch 22/30. Took 0.060723 seconds. 
  Full-batch training loss = 1.727521, test loss = 1.730411
  Training set accuracy = 0.578000, Test set accuracy = 0.581700
 epoch 23/30. Took 0.06101 seconds. 
  Full-batch training loss = 1.640075, test loss = 1.643965
  Training set accuracy = 0.590500, Test set accuracy = 0.596500
 epoch 24/30. Took 0.061047 seconds. 
  Full-batch training loss = 1.552510, test loss = 1.556924
  Training set accuracy = 0.615000, Test set accuracy = 0.619300
 epoch 25/30. Took 0.062818 seconds. 
  Full-batch training loss = 1.463732, test loss = 1.468875
  Training set accuracy = 0.630000, Test set accuracy = 0.642200
 epoch 26/30. Took 0.066982 seconds. 
  Full-batch training loss = 1.373606, test loss = 1.378335
  Training set accuracy = 0.656500, Test set accuracy = 0.668500
 epoch 27/30. Took 0.060421 seconds. 
  Full-batch training loss = 1.294295, test loss = 1.298796
  Training set accuracy = 0.679000, Test set accuracy = 0.686200
 epoch 28/30. Took 0.059912 seconds. 
  Full-batch training loss = 1.217171, test loss = 1.223207
  Training set accuracy = 0.697500, Test set accuracy = 0.703700
 epoch 29/30. Took 0.060976 seconds. 
  Full-batch training loss = 1.144639, test loss = 1.149359
  Training set accuracy = 0.717500, Test set accuracy = 0.725800
 epoch 30/30. Took 0.060455 seconds. 
  Full-batch training loss = 1.076629, test loss = 1.082446
  Training set accuracy = 0.729500, Test set accuracy = 0.739300
Elapsed time is 6.718291 seconds.
End Training
-----
Params 2000 0.010 0.40 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.1117 seconds. 
  Full-batch training loss = 2.299303, test loss = 2.298077
  Training set accuracy = 0.110500, Test set accuracy = 0.120400
 epoch 2/30. Took 0.1079 seconds. 
  Full-batch training loss = 2.293077, test loss = 2.293007
  Training set accuracy = 0.140500, Test set accuracy = 0.162600
 epoch 3/30. Took 0.11735 seconds. 
  Full-batch training loss = 2.287155, test loss = 2.287851
  Training set accuracy = 0.190000, Test set accuracy = 0.197700
 epoch 4/30. Took 0.10596 seconds. 
  Full-batch training loss = 2.281191, test loss = 2.282574
  Training set accuracy = 0.236500, Test set accuracy = 0.221500
 epoch 5/30. Took 0.1065 seconds. 
  Full-batch training loss = 2.274515, test loss = 2.276591
  Training set accuracy = 0.294000, Test set accuracy = 0.268200
 epoch 6/30. Took 0.10647 seconds. 
  Full-batch training loss = 2.267253, test loss = 2.269956
  Training set accuracy = 0.307500, Test set accuracy = 0.285100
 epoch 7/30. Took 0.10836 seconds. 
  Full-batch training loss = 2.258712, test loss = 2.262026
  Training set accuracy = 0.328000, Test set accuracy = 0.314200
 epoch 8/30. Took 0.10744 seconds. 
  Full-batch training loss = 2.248623, test loss = 2.252552
  Training set accuracy = 0.358000, Test set accuracy = 0.339300
 epoch 9/30. Took 0.12107 seconds. 
  Full-batch training loss = 2.236495, test loss = 2.240866
  Training set accuracy = 0.360000, Test set accuracy = 0.344200
 epoch 10/30. Took 0.10726 seconds. 
  Full-batch training loss = 2.221391, test loss = 2.226349
  Training set accuracy = 0.368500, Test set accuracy = 0.356600
 epoch 11/30. Took 0.12209 seconds. 
  Full-batch training loss = 2.203346, test loss = 2.208912
  Training set accuracy = 0.398500, Test set accuracy = 0.378500
 epoch 12/30. Took 0.12093 seconds. 
  Full-batch training loss = 2.179637, test loss = 2.186212
  Training set accuracy = 0.387500, Test set accuracy = 0.373300
 epoch 13/30. Took 0.12562 seconds. 
  Full-batch training loss = 2.149510, test loss = 2.156785
  Training set accuracy = 0.419500, Test set accuracy = 0.410600
 epoch 14/30. Took 0.10199 seconds. 
  Full-batch training loss = 2.110276, test loss = 2.118608
  Training set accuracy = 0.434000, Test set accuracy = 0.428200
 epoch 15/30. Took 0.10851 seconds. 
  Full-batch training loss = 2.061742, test loss = 2.070918
  Training set accuracy = 0.479000, Test set accuracy = 0.469600
 epoch 16/30. Took 0.1081 seconds. 
  Full-batch training loss = 2.002217, test loss = 2.012296
  Training set accuracy = 0.514500, Test set accuracy = 0.499100
 epoch 17/30. Took 0.10448 seconds. 
  Full-batch training loss = 1.931339, test loss = 1.942496
  Training set accuracy = 0.556000, Test set accuracy = 0.533800
 epoch 18/30. Took 0.10275 seconds. 
  Full-batch training loss = 1.849682, test loss = 1.862401
  Training set accuracy = 0.582000, Test set accuracy = 0.557900
 epoch 19/30. Took 0.10154 seconds. 
  Full-batch training loss = 1.756342, test loss = 1.770329
  Training set accuracy = 0.615500, Test set accuracy = 0.591900
 epoch 20/30. Took 0.10391 seconds. 
  Full-batch training loss = 1.653192, test loss = 1.668096
  Training set accuracy = 0.632500, Test set accuracy = 0.610100
 epoch 21/30. Took 0.10615 seconds. 
  Full-batch training loss = 1.537952, test loss = 1.554556
  Training set accuracy = 0.649000, Test set accuracy = 0.630000
 epoch 22/30. Took 0.10808 seconds. 
  Full-batch training loss = 1.419379, test loss = 1.437668
  Training set accuracy = 0.662000, Test set accuracy = 0.648400
 epoch 23/30. Took 0.10825 seconds. 
  Full-batch training loss = 1.313296, test loss = 1.332544
  Training set accuracy = 0.670000, Test set accuracy = 0.656400
 epoch 24/30. Took 0.10823 seconds. 
  Full-batch training loss = 1.208477, test loss = 1.231330
  Training set accuracy = 0.673500, Test set accuracy = 0.663000
 epoch 25/30. Took 0.10816 seconds. 
  Full-batch training loss = 1.119037, test loss = 1.145364
  Training set accuracy = 0.679000, Test set accuracy = 0.669500
 epoch 26/30. Took 0.10855 seconds. 
  Full-batch training loss = 1.038822, test loss = 1.066318
  Training set accuracy = 0.707500, Test set accuracy = 0.696200
 epoch 27/30. Took 0.10854 seconds. 
  Full-batch training loss = 0.980771, test loss = 1.013098
  Training set accuracy = 0.710500, Test set accuracy = 0.694800
 epoch 28/30. Took 0.10866 seconds. 
  Full-batch training loss = 0.916936, test loss = 0.950808
  Training set accuracy = 0.724500, Test set accuracy = 0.711800
 epoch 29/30. Took 0.11965 seconds. 
  Full-batch training loss = 0.864196, test loss = 0.900946
  Training set accuracy = 0.737000, Test set accuracy = 0.727500
 epoch 30/30. Took 0.10766 seconds. 
  Full-batch training loss = 0.820985, test loss = 0.859273
  Training set accuracy = 0.760000, Test set accuracy = 0.750100
Elapsed time is 11.993855 seconds.
End Training
-----
Params 2000 0.010 0.40 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.37058 seconds. 
  Full-batch training loss = 2.294008, test loss = 2.295128
  Training set accuracy = 0.100000, Test set accuracy = 0.103200
 epoch 2/30. Took 0.32261 seconds. 
  Full-batch training loss = 2.286071, test loss = 2.287615
  Training set accuracy = 0.187500, Test set accuracy = 0.176000
 epoch 3/30. Took 0.323 seconds. 
  Full-batch training loss = 2.277709, test loss = 2.279707
  Training set accuracy = 0.265000, Test set accuracy = 0.236200
 epoch 4/30. Took 0.32644 seconds. 
  Full-batch training loss = 2.268532, test loss = 2.270970
  Training set accuracy = 0.239500, Test set accuracy = 0.223100
 epoch 5/30. Took 0.32306 seconds. 
  Full-batch training loss = 2.257801, test loss = 2.260610
  Training set accuracy = 0.248000, Test set accuracy = 0.239000
 epoch 6/30. Took 0.32089 seconds. 
  Full-batch training loss = 2.244904, test loss = 2.247961
  Training set accuracy = 0.263000, Test set accuracy = 0.258900
 epoch 7/30. Took 0.32529 seconds. 
  Full-batch training loss = 2.229477, test loss = 2.232998
  Training set accuracy = 0.274000, Test set accuracy = 0.268900
 epoch 8/30. Took 0.33577 seconds. 
  Full-batch training loss = 2.210205, test loss = 2.214460
  Training set accuracy = 0.272000, Test set accuracy = 0.266600
 epoch 9/30. Took 0.34644 seconds. 
  Full-batch training loss = 2.185269, test loss = 2.190331
  Training set accuracy = 0.300000, Test set accuracy = 0.296900
 epoch 10/30. Took 0.3233 seconds. 
  Full-batch training loss = 2.152797, test loss = 2.159098
  Training set accuracy = 0.323500, Test set accuracy = 0.317700
 epoch 11/30. Took 0.33 seconds. 
  Full-batch training loss = 2.110809, test loss = 2.118322
  Training set accuracy = 0.364500, Test set accuracy = 0.369400
 epoch 12/30. Took 0.32067 seconds. 
  Full-batch training loss = 2.058129, test loss = 2.066865
  Training set accuracy = 0.466000, Test set accuracy = 0.470800
 epoch 13/30. Took 0.34517 seconds. 
  Full-batch training loss = 1.989322, test loss = 1.999024
  Training set accuracy = 0.532500, Test set accuracy = 0.530800
 epoch 14/30. Took 0.32356 seconds. 
  Full-batch training loss = 1.904983, test loss = 1.915580
  Training set accuracy = 0.617500, Test set accuracy = 0.606400
 epoch 15/30. Took 0.32541 seconds. 
  Full-batch training loss = 1.804079, test loss = 1.814468
  Training set accuracy = 0.677000, Test set accuracy = 0.672300
 epoch 16/30. Took 0.32231 seconds. 
  Full-batch training loss = 1.682199, test loss = 1.693953
  Training set accuracy = 0.691000, Test set accuracy = 0.686400
 epoch 17/30. Took 0.34595 seconds. 
  Full-batch training loss = 1.539875, test loss = 1.551296
  Training set accuracy = 0.710500, Test set accuracy = 0.707800
 epoch 18/30. Took 0.33938 seconds. 
  Full-batch training loss = 1.382694, test loss = 1.394954
  Training set accuracy = 0.736500, Test set accuracy = 0.733400
 epoch 19/30. Took 0.33224 seconds. 
  Full-batch training loss = 1.227952, test loss = 1.241748
  Training set accuracy = 0.750000, Test set accuracy = 0.741800
 epoch 20/30. Took 0.32881 seconds. 
  Full-batch training loss = 1.089721, test loss = 1.106842
  Training set accuracy = 0.762000, Test set accuracy = 0.754600
 epoch 21/30. Took 0.32168 seconds. 
  Full-batch training loss = 0.971303, test loss = 0.993634
  Training set accuracy = 0.782000, Test set accuracy = 0.766700
 epoch 22/30. Took 0.3208 seconds. 
  Full-batch training loss = 0.881885, test loss = 0.910164
  Training set accuracy = 0.787000, Test set accuracy = 0.771800
 epoch 23/30. Took 0.32336 seconds. 
  Full-batch training loss = 0.813834, test loss = 0.841960
  Training set accuracy = 0.801000, Test set accuracy = 0.786900
 epoch 24/30. Took 0.32182 seconds. 
  Full-batch training loss = 0.757944, test loss = 0.794393
  Training set accuracy = 0.812000, Test set accuracy = 0.790700
 epoch 25/30. Took 0.36718 seconds. 
  Full-batch training loss = 0.706991, test loss = 0.746962
  Training set accuracy = 0.823500, Test set accuracy = 0.804000
 epoch 26/30. Took 0.32487 seconds. 
  Full-batch training loss = 0.664073, test loss = 0.709537
  Training set accuracy = 0.824500, Test set accuracy = 0.803800
 epoch 27/30. Took 0.32331 seconds. 
  Full-batch training loss = 0.626075, test loss = 0.677228
  Training set accuracy = 0.841000, Test set accuracy = 0.812100
 epoch 28/30. Took 0.33871 seconds. 
  Full-batch training loss = 0.592760, test loss = 0.642513
  Training set accuracy = 0.845500, Test set accuracy = 0.819600
 epoch 29/30. Took 0.32583 seconds. 
  Full-batch training loss = 0.569769, test loss = 0.620517
  Training set accuracy = 0.842000, Test set accuracy = 0.821300
 epoch 30/30. Took 0.32025 seconds. 
  Full-batch training loss = 0.537708, test loss = 0.593926
  Training set accuracy = 0.858000, Test set accuracy = 0.830200
Elapsed time is 32.162596 seconds.
End Training
-----
Params 2000 0.010 0.50 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.043029 seconds. 
  Full-batch training loss = 2.197466, test loss = 2.203440
  Training set accuracy = 0.276500, Test set accuracy = 0.262000
 epoch 2/30. Took 0.038581 seconds. 
  Full-batch training loss = 2.061689, test loss = 2.068528
  Training set accuracy = 0.572500, Test set accuracy = 0.565100
 epoch 3/30. Took 0.039846 seconds. 
  Full-batch training loss = 1.911428, test loss = 1.918458
  Training set accuracy = 0.656000, Test set accuracy = 0.659100
 epoch 4/30. Took 0.037762 seconds. 
  Full-batch training loss = 1.746737, test loss = 1.754137
  Training set accuracy = 0.686500, Test set accuracy = 0.686700
 epoch 5/30. Took 0.037986 seconds. 
  Full-batch training loss = 1.581985, test loss = 1.588625
  Training set accuracy = 0.718500, Test set accuracy = 0.719000
 epoch 6/30. Took 0.039135 seconds. 
  Full-batch training loss = 1.429218, test loss = 1.435788
  Training set accuracy = 0.737000, Test set accuracy = 0.741100
 epoch 7/30. Took 0.038894 seconds. 
  Full-batch training loss = 1.295791, test loss = 1.300591
  Training set accuracy = 0.773000, Test set accuracy = 0.774900
 epoch 8/30. Took 0.039294 seconds. 
  Full-batch training loss = 1.182198, test loss = 1.187356
  Training set accuracy = 0.779500, Test set accuracy = 0.783700
 epoch 9/30. Took 0.040164 seconds. 
  Full-batch training loss = 1.086374, test loss = 1.091856
  Training set accuracy = 0.793000, Test set accuracy = 0.794700
 epoch 10/30. Took 0.039026 seconds. 
  Full-batch training loss = 1.003762, test loss = 1.009388
  Training set accuracy = 0.807500, Test set accuracy = 0.808200
 epoch 11/30. Took 0.03775 seconds. 
  Full-batch training loss = 0.934359, test loss = 0.940387
  Training set accuracy = 0.820000, Test set accuracy = 0.819600
 epoch 12/30. Took 0.039109 seconds. 
  Full-batch training loss = 0.876047, test loss = 0.882863
  Training set accuracy = 0.825000, Test set accuracy = 0.825200
 epoch 13/30. Took 0.038926 seconds. 
  Full-batch training loss = 0.826522, test loss = 0.834030
  Training set accuracy = 0.834000, Test set accuracy = 0.831700
 epoch 14/30. Took 0.037931 seconds. 
  Full-batch training loss = 0.782709, test loss = 0.790211
  Training set accuracy = 0.840000, Test set accuracy = 0.837400
 epoch 15/30. Took 0.04342 seconds. 
  Full-batch training loss = 0.746241, test loss = 0.754874
  Training set accuracy = 0.845500, Test set accuracy = 0.842000
 epoch 16/30. Took 0.037646 seconds. 
  Full-batch training loss = 0.714285, test loss = 0.724634
  Training set accuracy = 0.852000, Test set accuracy = 0.847400
 epoch 17/30. Took 0.038821 seconds. 
  Full-batch training loss = 0.683793, test loss = 0.694894
  Training set accuracy = 0.858000, Test set accuracy = 0.851300
 epoch 18/30. Took 0.037697 seconds. 
  Full-batch training loss = 0.660184, test loss = 0.672245
  Training set accuracy = 0.864000, Test set accuracy = 0.856400
 epoch 19/30. Took 0.037745 seconds. 
  Full-batch training loss = 0.638566, test loss = 0.650906
  Training set accuracy = 0.866000, Test set accuracy = 0.859900
 epoch 20/30. Took 0.039266 seconds. 
  Full-batch training loss = 0.616957, test loss = 0.631105
  Training set accuracy = 0.868000, Test set accuracy = 0.860300
 epoch 21/30. Took 0.039267 seconds. 
  Full-batch training loss = 0.597403, test loss = 0.612482
  Training set accuracy = 0.870500, Test set accuracy = 0.862100
 epoch 22/30. Took 0.041899 seconds. 
  Full-batch training loss = 0.581514, test loss = 0.597582
  Training set accuracy = 0.871500, Test set accuracy = 0.864800
 epoch 23/30. Took 0.037665 seconds. 
  Full-batch training loss = 0.565488, test loss = 0.583530
  Training set accuracy = 0.871500, Test set accuracy = 0.865600
 epoch 24/30. Took 0.039153 seconds. 
  Full-batch training loss = 0.550594, test loss = 0.569029
  Training set accuracy = 0.874500, Test set accuracy = 0.870900
 epoch 25/30. Took 0.037811 seconds. 
  Full-batch training loss = 0.536849, test loss = 0.557094
  Training set accuracy = 0.879500, Test set accuracy = 0.871000
 epoch 26/30. Took 0.037802 seconds. 
  Full-batch training loss = 0.524209, test loss = 0.545749
  Training set accuracy = 0.880000, Test set accuracy = 0.874000
 epoch 27/30. Took 0.039358 seconds. 
  Full-batch training loss = 0.513259, test loss = 0.535638
  Training set accuracy = 0.886000, Test set accuracy = 0.875200
 epoch 28/30. Took 0.038611 seconds. 
  Full-batch training loss = 0.502575, test loss = 0.526020
  Training set accuracy = 0.883000, Test set accuracy = 0.876600
 epoch 29/30. Took 0.038823 seconds. 
  Full-batch training loss = 0.490471, test loss = 0.515894
  Training set accuracy = 0.889500, Test set accuracy = 0.876600
 epoch 30/30. Took 0.03793 seconds. 
  Full-batch training loss = 0.481173, test loss = 0.507372
  Training set accuracy = 0.893500, Test set accuracy = 0.878500
Elapsed time is 5.176335 seconds.
End Training
-----
Params 2000 0.010 0.50 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.077289 seconds. 
  Full-batch training loss = 2.189534, test loss = 2.193042
  Training set accuracy = 0.386500, Test set accuracy = 0.378600
 epoch 2/30. Took 0.068273 seconds. 
  Full-batch training loss = 2.043115, test loss = 2.049412
  Training set accuracy = 0.577500, Test set accuracy = 0.553400
 epoch 3/30. Took 0.063395 seconds. 
  Full-batch training loss = 1.884958, test loss = 1.892454
  Training set accuracy = 0.667500, Test set accuracy = 0.657100
 epoch 4/30. Took 0.064696 seconds. 
  Full-batch training loss = 1.715377, test loss = 1.722772
  Training set accuracy = 0.722000, Test set accuracy = 0.711200
 epoch 5/30. Took 0.063537 seconds. 
  Full-batch training loss = 1.544207, test loss = 1.551982
  Training set accuracy = 0.755000, Test set accuracy = 0.749200
 epoch 6/30. Took 0.067194 seconds. 
  Full-batch training loss = 1.384875, test loss = 1.393352
  Training set accuracy = 0.786500, Test set accuracy = 0.777800
 epoch 7/30. Took 0.062554 seconds. 
  Full-batch training loss = 1.243237, test loss = 1.252469
  Training set accuracy = 0.806000, Test set accuracy = 0.797200
 epoch 8/30. Took 0.06354 seconds. 
  Full-batch training loss = 1.122140, test loss = 1.132597
  Training set accuracy = 0.823500, Test set accuracy = 0.810700
 epoch 9/30. Took 0.06309 seconds. 
  Full-batch training loss = 1.021385, test loss = 1.033802
  Training set accuracy = 0.833000, Test set accuracy = 0.818300
 epoch 10/30. Took 0.064142 seconds. 
  Full-batch training loss = 0.937096, test loss = 0.951030
  Training set accuracy = 0.840000, Test set accuracy = 0.826100
 epoch 11/30. Took 0.064741 seconds. 
  Full-batch training loss = 0.867076, test loss = 0.882140
  Training set accuracy = 0.843500, Test set accuracy = 0.831600
 epoch 12/30. Took 0.063222 seconds. 
  Full-batch training loss = 0.810211, test loss = 0.826763
  Training set accuracy = 0.848500, Test set accuracy = 0.836700
 epoch 13/30. Took 0.063458 seconds. 
  Full-batch training loss = 0.761249, test loss = 0.779661
  Training set accuracy = 0.853500, Test set accuracy = 0.841700
 epoch 14/30. Took 0.063606 seconds. 
  Full-batch training loss = 0.719397, test loss = 0.738586
  Training set accuracy = 0.856500, Test set accuracy = 0.844800
 epoch 15/30. Took 0.065523 seconds. 
  Full-batch training loss = 0.683168, test loss = 0.705229
  Training set accuracy = 0.861000, Test set accuracy = 0.848300
 epoch 16/30. Took 0.066335 seconds. 
  Full-batch training loss = 0.651976, test loss = 0.675502
  Training set accuracy = 0.862500, Test set accuracy = 0.851200
 epoch 17/30. Took 0.063512 seconds. 
  Full-batch training loss = 0.624093, test loss = 0.649451
  Training set accuracy = 0.867000, Test set accuracy = 0.853500
 epoch 18/30. Took 0.06453 seconds. 
  Full-batch training loss = 0.600519, test loss = 0.627251
  Training set accuracy = 0.868000, Test set accuracy = 0.856500
 epoch 19/30. Took 0.065044 seconds. 
  Full-batch training loss = 0.579562, test loss = 0.608410
  Training set accuracy = 0.870000, Test set accuracy = 0.859800
 epoch 20/30. Took 0.063848 seconds. 
  Full-batch training loss = 0.559889, test loss = 0.589664
  Training set accuracy = 0.873000, Test set accuracy = 0.861400
 epoch 21/30. Took 0.065197 seconds. 
  Full-batch training loss = 0.543141, test loss = 0.574547
  Training set accuracy = 0.875000, Test set accuracy = 0.862900
 epoch 22/30. Took 0.067064 seconds. 
  Full-batch training loss = 0.527231, test loss = 0.560184
  Training set accuracy = 0.877500, Test set accuracy = 0.864900
 epoch 23/30. Took 0.071175 seconds. 
  Full-batch training loss = 0.512697, test loss = 0.547220
  Training set accuracy = 0.882500, Test set accuracy = 0.868500
 epoch 24/30. Took 0.063488 seconds. 
  Full-batch training loss = 0.498713, test loss = 0.534261
  Training set accuracy = 0.880500, Test set accuracy = 0.869100
 epoch 25/30. Took 0.065452 seconds. 
  Full-batch training loss = 0.487197, test loss = 0.525145
  Training set accuracy = 0.884500, Test set accuracy = 0.869400
 epoch 26/30. Took 0.062199 seconds. 
  Full-batch training loss = 0.476160, test loss = 0.515610
  Training set accuracy = 0.885500, Test set accuracy = 0.871400
 epoch 27/30. Took 0.063088 seconds. 
  Full-batch training loss = 0.465733, test loss = 0.505863
  Training set accuracy = 0.885000, Test set accuracy = 0.872900
 epoch 28/30. Took 0.063562 seconds. 
  Full-batch training loss = 0.454742, test loss = 0.496966
  Training set accuracy = 0.888500, Test set accuracy = 0.873500
 epoch 29/30. Took 0.063626 seconds. 
  Full-batch training loss = 0.445922, test loss = 0.489332
  Training set accuracy = 0.889000, Test set accuracy = 0.874900
 epoch 30/30. Took 0.063274 seconds. 
  Full-batch training loss = 0.437067, test loss = 0.482160
  Training set accuracy = 0.889500, Test set accuracy = 0.877000
Elapsed time is 7.330094 seconds.
End Training
-----
Params 2000 0.010 0.50 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14135 seconds. 
  Full-batch training loss = 2.166689, test loss = 2.165386
  Training set accuracy = 0.422000, Test set accuracy = 0.430800
 epoch 2/30. Took 0.13775 seconds. 
  Full-batch training loss = 2.005121, test loss = 2.003062
  Training set accuracy = 0.618500, Test set accuracy = 0.634200
 epoch 3/30. Took 0.14529 seconds. 
  Full-batch training loss = 1.832745, test loss = 1.829240
  Training set accuracy = 0.676000, Test set accuracy = 0.684000
 epoch 4/30. Took 0.14158 seconds. 
  Full-batch training loss = 1.650887, test loss = 1.645221
  Training set accuracy = 0.716500, Test set accuracy = 0.728900
 epoch 5/30. Took 0.13527 seconds. 
  Full-batch training loss = 1.470843, test loss = 1.463211
  Training set accuracy = 0.741500, Test set accuracy = 0.749600
 epoch 6/30. Took 0.13656 seconds. 
  Full-batch training loss = 1.306355, test loss = 1.296848
  Training set accuracy = 0.769500, Test set accuracy = 0.773100
 epoch 7/30. Took 0.13714 seconds. 
  Full-batch training loss = 1.164634, test loss = 1.153598
  Training set accuracy = 0.795500, Test set accuracy = 0.793200
 epoch 8/30. Took 0.13772 seconds. 
  Full-batch training loss = 1.048545, test loss = 1.037195
  Training set accuracy = 0.811500, Test set accuracy = 0.809500
 epoch 9/30. Took 0.13613 seconds. 
  Full-batch training loss = 0.954021, test loss = 0.943969
  Training set accuracy = 0.823500, Test set accuracy = 0.823400
 epoch 10/30. Took 0.13563 seconds. 
  Full-batch training loss = 0.876904, test loss = 0.867631
  Training set accuracy = 0.832500, Test set accuracy = 0.831900
 epoch 11/30. Took 0.1511 seconds. 
  Full-batch training loss = 0.813292, test loss = 0.805853
  Training set accuracy = 0.846500, Test set accuracy = 0.838300
 epoch 12/30. Took 0.1384 seconds. 
  Full-batch training loss = 0.760875, test loss = 0.753741
  Training set accuracy = 0.848500, Test set accuracy = 0.845000
 epoch 13/30. Took 0.15231 seconds. 
  Full-batch training loss = 0.715464, test loss = 0.711478
  Training set accuracy = 0.853000, Test set accuracy = 0.847100
 epoch 14/30. Took 0.13237 seconds. 
  Full-batch training loss = 0.677592, test loss = 0.675353
  Training set accuracy = 0.863000, Test set accuracy = 0.852300
 epoch 15/30. Took 0.13503 seconds. 
  Full-batch training loss = 0.644708, test loss = 0.645283
  Training set accuracy = 0.864500, Test set accuracy = 0.854600
 epoch 16/30. Took 0.13222 seconds. 
  Full-batch training loss = 0.615827, test loss = 0.618421
  Training set accuracy = 0.872000, Test set accuracy = 0.862600
 epoch 17/30. Took 0.13556 seconds. 
  Full-batch training loss = 0.592411, test loss = 0.597115
  Training set accuracy = 0.870500, Test set accuracy = 0.860200
 epoch 18/30. Took 0.14798 seconds. 
  Full-batch training loss = 0.568578, test loss = 0.575549
  Training set accuracy = 0.873500, Test set accuracy = 0.865100
 epoch 19/30. Took 0.13295 seconds. 
  Full-batch training loss = 0.549208, test loss = 0.559297
  Training set accuracy = 0.875000, Test set accuracy = 0.867400
 epoch 20/30. Took 0.13838 seconds. 
  Full-batch training loss = 0.532069, test loss = 0.543012
  Training set accuracy = 0.878000, Test set accuracy = 0.869600
 epoch 21/30. Took 0.13253 seconds. 
  Full-batch training loss = 0.515706, test loss = 0.528460
  Training set accuracy = 0.881500, Test set accuracy = 0.871800
 epoch 22/30. Took 0.13429 seconds. 
  Full-batch training loss = 0.500320, test loss = 0.515791
  Training set accuracy = 0.883500, Test set accuracy = 0.875000
 epoch 23/30. Took 0.13422 seconds. 
  Full-batch training loss = 0.486736, test loss = 0.504671
  Training set accuracy = 0.883500, Test set accuracy = 0.875700
 epoch 24/30. Took 0.13263 seconds. 
  Full-batch training loss = 0.474113, test loss = 0.495226
  Training set accuracy = 0.886000, Test set accuracy = 0.876600
 epoch 25/30. Took 0.13791 seconds. 
  Full-batch training loss = 0.462799, test loss = 0.485155
  Training set accuracy = 0.887500, Test set accuracy = 0.877800
 epoch 26/30. Took 0.13409 seconds. 
  Full-batch training loss = 0.452643, test loss = 0.477589
  Training set accuracy = 0.891000, Test set accuracy = 0.878700
 epoch 27/30. Took 0.13362 seconds. 
  Full-batch training loss = 0.442744, test loss = 0.469151
  Training set accuracy = 0.890000, Test set accuracy = 0.879800
 epoch 28/30. Took 0.14524 seconds. 
  Full-batch training loss = 0.433458, test loss = 0.461806
  Training set accuracy = 0.895500, Test set accuracy = 0.879200
 epoch 29/30. Took 0.13179 seconds. 
  Full-batch training loss = 0.424488, test loss = 0.455603
  Training set accuracy = 0.893500, Test set accuracy = 0.881100
 epoch 30/30. Took 0.13554 seconds. 
  Full-batch training loss = 0.416803, test loss = 0.448397
  Training set accuracy = 0.899500, Test set accuracy = 0.881700
Elapsed time is 14.546867 seconds.
End Training
-----
Params 2000 0.010 0.50 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.051866 seconds. 
  Full-batch training loss = 2.292019, test loss = 2.291856
  Training set accuracy = 0.139500, Test set accuracy = 0.142100
 epoch 2/30. Took 0.055385 seconds. 
  Full-batch training loss = 2.277376, test loss = 2.278844
  Training set accuracy = 0.277000, Test set accuracy = 0.276100
 epoch 3/30. Took 0.049161 seconds. 
  Full-batch training loss = 2.262192, test loss = 2.264803
  Training set accuracy = 0.366500, Test set accuracy = 0.359200
 epoch 4/30. Took 0.050235 seconds. 
  Full-batch training loss = 2.245308, test loss = 2.248942
  Training set accuracy = 0.431000, Test set accuracy = 0.419100
 epoch 5/30. Took 0.056203 seconds. 
  Full-batch training loss = 2.226017, test loss = 2.230403
  Training set accuracy = 0.485000, Test set accuracy = 0.473600
 epoch 6/30. Took 0.04702 seconds. 
  Full-batch training loss = 2.202408, test loss = 2.207421
  Training set accuracy = 0.528500, Test set accuracy = 0.513600
 epoch 7/30. Took 0.054895 seconds. 
  Full-batch training loss = 2.175299, test loss = 2.180933
  Training set accuracy = 0.554500, Test set accuracy = 0.544900
 epoch 8/30. Took 0.048717 seconds. 
  Full-batch training loss = 2.142776, test loss = 2.148940
  Training set accuracy = 0.582500, Test set accuracy = 0.570900
 epoch 9/30. Took 0.050234 seconds. 
  Full-batch training loss = 2.103499, test loss = 2.110194
  Training set accuracy = 0.613500, Test set accuracy = 0.597200
 epoch 10/30. Took 0.049574 seconds. 
  Full-batch training loss = 2.054508, test loss = 2.061814
  Training set accuracy = 0.622500, Test set accuracy = 0.606400
 epoch 11/30. Took 0.049027 seconds. 
  Full-batch training loss = 2.000908, test loss = 2.008870
  Training set accuracy = 0.642000, Test set accuracy = 0.620300
 epoch 12/30. Took 0.048894 seconds. 
  Full-batch training loss = 1.935580, test loss = 1.943691
  Training set accuracy = 0.647500, Test set accuracy = 0.627400
 epoch 13/30. Took 0.05008 seconds. 
  Full-batch training loss = 1.861537, test loss = 1.870902
  Training set accuracy = 0.652500, Test set accuracy = 0.632400
 epoch 14/30. Took 0.0518 seconds. 
  Full-batch training loss = 1.781149, test loss = 1.791703
  Training set accuracy = 0.654000, Test set accuracy = 0.631900
 epoch 15/30. Took 0.050773 seconds. 
  Full-batch training loss = 1.699630, test loss = 1.711536
  Training set accuracy = 0.663000, Test set accuracy = 0.640300
 epoch 16/30. Took 0.048975 seconds. 
  Full-batch training loss = 1.616585, test loss = 1.629021
  Training set accuracy = 0.669500, Test set accuracy = 0.653500
 epoch 17/30. Took 0.047609 seconds. 
  Full-batch training loss = 1.536977, test loss = 1.550813
  Training set accuracy = 0.672000, Test set accuracy = 0.656700
 epoch 18/30. Took 0.054855 seconds. 
  Full-batch training loss = 1.457724, test loss = 1.472081
  Training set accuracy = 0.691000, Test set accuracy = 0.673800
 epoch 19/30. Took 0.048724 seconds. 
  Full-batch training loss = 1.382011, test loss = 1.397637
  Training set accuracy = 0.705500, Test set accuracy = 0.686200
 epoch 20/30. Took 0.048738 seconds. 
  Full-batch training loss = 1.307307, test loss = 1.322991
  Training set accuracy = 0.719000, Test set accuracy = 0.703400
 epoch 21/30. Took 0.0528 seconds. 
  Full-batch training loss = 1.241543, test loss = 1.258686
  Training set accuracy = 0.731000, Test set accuracy = 0.714500
 epoch 22/30. Took 0.045145 seconds. 
  Full-batch training loss = 1.182890, test loss = 1.200242
  Training set accuracy = 0.741500, Test set accuracy = 0.723500
 epoch 23/30. Took 0.048338 seconds. 
  Full-batch training loss = 1.122362, test loss = 1.139252
  Training set accuracy = 0.757500, Test set accuracy = 0.740800
 epoch 24/30. Took 0.045897 seconds. 
  Full-batch training loss = 1.067202, test loss = 1.085340
  Training set accuracy = 0.768000, Test set accuracy = 0.752600
 epoch 25/30. Took 0.046143 seconds. 
  Full-batch training loss = 1.025609, test loss = 1.044332
  Training set accuracy = 0.769500, Test set accuracy = 0.753800
 epoch 26/30. Took 0.048847 seconds. 
  Full-batch training loss = 0.981049, test loss = 1.000317
  Training set accuracy = 0.776000, Test set accuracy = 0.765300
 epoch 27/30. Took 0.047289 seconds. 
  Full-batch training loss = 0.942578, test loss = 0.962380
  Training set accuracy = 0.788000, Test set accuracy = 0.769000
 epoch 28/30. Took 0.049834 seconds. 
  Full-batch training loss = 0.908513, test loss = 0.930050
  Training set accuracy = 0.790000, Test set accuracy = 0.776200
 epoch 29/30. Took 0.051232 seconds. 
  Full-batch training loss = 0.875721, test loss = 0.897749
  Training set accuracy = 0.795000, Test set accuracy = 0.780200
 epoch 30/30. Took 0.056509 seconds. 
  Full-batch training loss = 0.845213, test loss = 0.869078
  Training set accuracy = 0.803000, Test set accuracy = 0.785600
Elapsed time is 5.760884 seconds.
End Training
-----
Params 2000 0.010 0.50 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.09422 seconds. 
  Full-batch training loss = 2.299881, test loss = 2.298415
  Training set accuracy = 0.096500, Test set accuracy = 0.102100
 epoch 2/30. Took 0.086067 seconds. 
  Full-batch training loss = 2.284114, test loss = 2.283672
  Training set accuracy = 0.174500, Test set accuracy = 0.181300
 epoch 3/30. Took 0.086972 seconds. 
  Full-batch training loss = 2.268562, test loss = 2.268820
  Training set accuracy = 0.263000, Test set accuracy = 0.271900
 epoch 4/30. Took 0.087288 seconds. 
  Full-batch training loss = 2.250903, test loss = 2.251976
  Training set accuracy = 0.426000, Test set accuracy = 0.414800
 epoch 5/30. Took 0.085988 seconds. 
  Full-batch training loss = 2.230994, test loss = 2.232789
  Training set accuracy = 0.526500, Test set accuracy = 0.511600
 epoch 6/30. Took 0.088945 seconds. 
  Full-batch training loss = 2.208089, test loss = 2.210631
  Training set accuracy = 0.557500, Test set accuracy = 0.533900
 epoch 7/30. Took 0.086858 seconds. 
  Full-batch training loss = 2.180029, test loss = 2.183605
  Training set accuracy = 0.557500, Test set accuracy = 0.542900
 epoch 8/30. Took 0.087632 seconds. 
  Full-batch training loss = 2.146327, test loss = 2.150889
  Training set accuracy = 0.565000, Test set accuracy = 0.545100
 epoch 9/30. Took 0.086785 seconds. 
  Full-batch training loss = 2.104214, test loss = 2.110203
  Training set accuracy = 0.558000, Test set accuracy = 0.548400
 epoch 10/30. Took 0.088506 seconds. 
  Full-batch training loss = 2.054376, test loss = 2.061698
  Training set accuracy = 0.555500, Test set accuracy = 0.545600
 epoch 11/30. Took 0.085486 seconds. 
  Full-batch training loss = 1.993824, test loss = 2.002395
  Training set accuracy = 0.575500, Test set accuracy = 0.563600
 epoch 12/30. Took 0.087303 seconds. 
  Full-batch training loss = 1.921869, test loss = 1.931247
  Training set accuracy = 0.608000, Test set accuracy = 0.587000
 epoch 13/30. Took 0.091193 seconds. 
  Full-batch training loss = 1.839563, test loss = 1.850011
  Training set accuracy = 0.635000, Test set accuracy = 0.615900
 epoch 14/30. Took 0.08668 seconds. 
  Full-batch training loss = 1.749285, test loss = 1.760277
  Training set accuracy = 0.669000, Test set accuracy = 0.647500
 epoch 15/30. Took 0.088587 seconds. 
  Full-batch training loss = 1.648874, test loss = 1.659798
  Training set accuracy = 0.695000, Test set accuracy = 0.678600
 epoch 16/30. Took 0.086525 seconds. 
  Full-batch training loss = 1.544049, test loss = 1.554768
  Training set accuracy = 0.712500, Test set accuracy = 0.694000
 epoch 17/30. Took 0.084526 seconds. 
  Full-batch training loss = 1.438482, test loss = 1.448281
  Training set accuracy = 0.730500, Test set accuracy = 0.718400
 epoch 18/30. Took 0.083805 seconds. 
  Full-batch training loss = 1.331993, test loss = 1.341158
  Training set accuracy = 0.758500, Test set accuracy = 0.742600
 epoch 19/30. Took 0.090449 seconds. 
  Full-batch training loss = 1.232111, test loss = 1.240140
  Training set accuracy = 0.772000, Test set accuracy = 0.762700
 epoch 20/30. Took 0.088736 seconds. 
  Full-batch training loss = 1.140925, test loss = 1.148738
  Training set accuracy = 0.777500, Test set accuracy = 0.771700
 epoch 21/30. Took 0.089522 seconds. 
  Full-batch training loss = 1.062391, test loss = 1.069209
  Training set accuracy = 0.787500, Test set accuracy = 0.787200
 epoch 22/30. Took 0.087914 seconds. 
  Full-batch training loss = 0.991410, test loss = 0.998016
  Training set accuracy = 0.795500, Test set accuracy = 0.793700
 epoch 23/30. Took 0.087615 seconds. 
  Full-batch training loss = 0.931717, test loss = 0.938788
  Training set accuracy = 0.801000, Test set accuracy = 0.801000
 epoch 24/30. Took 0.086962 seconds. 
  Full-batch training loss = 0.878566, test loss = 0.886492
  Training set accuracy = 0.812500, Test set accuracy = 0.809600
 epoch 25/30. Took 0.086605 seconds. 
  Full-batch training loss = 0.835538, test loss = 0.843556
  Training set accuracy = 0.814500, Test set accuracy = 0.810000
 epoch 26/30. Took 0.0875 seconds. 
  Full-batch training loss = 0.794237, test loss = 0.802315
  Training set accuracy = 0.822500, Test set accuracy = 0.817600
 epoch 27/30. Took 0.087458 seconds. 
  Full-batch training loss = 0.760788, test loss = 0.769782
  Training set accuracy = 0.830000, Test set accuracy = 0.822700
 epoch 28/30. Took 0.086468 seconds. 
  Full-batch training loss = 0.729613, test loss = 0.738635
  Training set accuracy = 0.836500, Test set accuracy = 0.824700
 epoch 29/30. Took 0.10012 seconds. 
  Full-batch training loss = 0.704152, test loss = 0.714235
  Training set accuracy = 0.840000, Test set accuracy = 0.828300
 epoch 30/30. Took 0.08773 seconds. 
  Full-batch training loss = 0.680722, test loss = 0.691592
  Training set accuracy = 0.843500, Test set accuracy = 0.834400
Elapsed time is 9.404013 seconds.
End Training
-----
Params 2000 0.010 0.50 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23753 seconds. 
  Full-batch training loss = 2.285350, test loss = 2.287076
  Training set accuracy = 0.202000, Test set accuracy = 0.181500
 epoch 2/30. Took 0.23951 seconds. 
  Full-batch training loss = 2.261897, test loss = 2.264257
  Training set accuracy = 0.371000, Test set accuracy = 0.337000
 epoch 3/30. Took 0.23244 seconds. 
  Full-batch training loss = 2.236903, test loss = 2.240420
  Training set accuracy = 0.421000, Test set accuracy = 0.402200
 epoch 4/30. Took 0.2359 seconds. 
  Full-batch training loss = 2.208694, test loss = 2.213014
  Training set accuracy = 0.446000, Test set accuracy = 0.430900
 epoch 5/30. Took 0.23231 seconds. 
  Full-batch training loss = 2.175174, test loss = 2.180205
  Training set accuracy = 0.479500, Test set accuracy = 0.466500
 epoch 6/30. Took 0.24173 seconds. 
  Full-batch training loss = 2.135093, test loss = 2.140525
  Training set accuracy = 0.533500, Test set accuracy = 0.509300
 epoch 7/30. Took 0.23245 seconds. 
  Full-batch training loss = 2.084899, test loss = 2.091030
  Training set accuracy = 0.568500, Test set accuracy = 0.541100
 epoch 8/30. Took 0.24011 seconds. 
  Full-batch training loss = 2.023751, test loss = 2.030364
  Training set accuracy = 0.606500, Test set accuracy = 0.577500
 epoch 9/30. Took 0.23094 seconds. 
  Full-batch training loss = 1.948692, test loss = 1.955584
  Training set accuracy = 0.629000, Test set accuracy = 0.602800
 epoch 10/30. Took 0.23204 seconds. 
  Full-batch training loss = 1.857665, test loss = 1.865608
  Training set accuracy = 0.641000, Test set accuracy = 0.620000
 epoch 11/30. Took 0.23256 seconds. 
  Full-batch training loss = 1.749295, test loss = 1.757750
  Training set accuracy = 0.663000, Test set accuracy = 0.651000
 epoch 12/30. Took 0.23546 seconds. 
  Full-batch training loss = 1.628863, test loss = 1.637215
  Training set accuracy = 0.693000, Test set accuracy = 0.684200
 epoch 13/30. Took 0.23649 seconds. 
  Full-batch training loss = 1.500076, test loss = 1.508839
  Training set accuracy = 0.693500, Test set accuracy = 0.691200
 epoch 14/30. Took 0.23258 seconds. 
  Full-batch training loss = 1.371881, test loss = 1.379721
  Training set accuracy = 0.727000, Test set accuracy = 0.720800
 epoch 15/30. Took 0.23158 seconds. 
  Full-batch training loss = 1.250584, test loss = 1.258117
  Training set accuracy = 0.750500, Test set accuracy = 0.743500
 epoch 16/30. Took 0.23082 seconds. 
  Full-batch training loss = 1.141228, test loss = 1.148880
  Training set accuracy = 0.763500, Test set accuracy = 0.758400
 epoch 17/30. Took 0.23136 seconds. 
  Full-batch training loss = 1.047493, test loss = 1.055553
  Training set accuracy = 0.771500, Test set accuracy = 0.770000
 epoch 18/30. Took 0.23292 seconds. 
  Full-batch training loss = 0.964331, test loss = 0.973929
  Training set accuracy = 0.793500, Test set accuracy = 0.786900
 epoch 19/30. Took 0.24181 seconds. 
  Full-batch training loss = 0.895728, test loss = 0.905791
  Training set accuracy = 0.802500, Test set accuracy = 0.798200
 epoch 20/30. Took 0.23274 seconds. 
  Full-batch training loss = 0.834622, test loss = 0.846699
  Training set accuracy = 0.811500, Test set accuracy = 0.806400
 epoch 21/30. Took 0.23111 seconds. 
  Full-batch training loss = 0.783181, test loss = 0.795939
  Training set accuracy = 0.818500, Test set accuracy = 0.815300
 epoch 22/30. Took 0.22873 seconds. 
  Full-batch training loss = 0.738297, test loss = 0.752520
  Training set accuracy = 0.830000, Test set accuracy = 0.826800
 epoch 23/30. Took 0.23173 seconds. 
  Full-batch training loss = 0.699556, test loss = 0.715751
  Training set accuracy = 0.839500, Test set accuracy = 0.833300
 epoch 24/30. Took 0.22797 seconds. 
  Full-batch training loss = 0.666323, test loss = 0.684365
  Training set accuracy = 0.845000, Test set accuracy = 0.839100
 epoch 25/30. Took 0.22996 seconds. 
  Full-batch training loss = 0.637508, test loss = 0.659788
  Training set accuracy = 0.848000, Test set accuracy = 0.839600
 epoch 26/30. Took 0.23239 seconds. 
  Full-batch training loss = 0.609460, test loss = 0.633329
  Training set accuracy = 0.857000, Test set accuracy = 0.849000
 epoch 27/30. Took 0.23173 seconds. 
  Full-batch training loss = 0.584148, test loss = 0.607613
  Training set accuracy = 0.857500, Test set accuracy = 0.852200
 epoch 28/30. Took 0.2312 seconds. 
  Full-batch training loss = 0.562456, test loss = 0.589738
  Training set accuracy = 0.861000, Test set accuracy = 0.853500
 epoch 29/30. Took 0.23289 seconds. 
  Full-batch training loss = 0.541755, test loss = 0.570574
  Training set accuracy = 0.868000, Test set accuracy = 0.858700
 epoch 30/30. Took 0.22874 seconds. 
  Full-batch training loss = 0.523028, test loss = 0.553893
  Training set accuracy = 0.874500, Test set accuracy = 0.862500
Elapsed time is 23.210224 seconds.
End Training
-----
Params 2000 0.010 0.50 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.065582 seconds. 
  Full-batch training loss = 2.304426, test loss = 2.306126
  Training set accuracy = 0.099000, Test set accuracy = 0.098100
 epoch 2/30. Took 0.059285 seconds. 
  Full-batch training loss = 2.302111, test loss = 2.304214
  Training set accuracy = 0.099000, Test set accuracy = 0.098200
 epoch 3/30. Took 0.059343 seconds. 
  Full-batch training loss = 2.299986, test loss = 2.302298
  Training set accuracy = 0.095500, Test set accuracy = 0.096600
 epoch 4/30. Took 0.059765 seconds. 
  Full-batch training loss = 2.298063, test loss = 2.300713
  Training set accuracy = 0.136500, Test set accuracy = 0.129800
 epoch 5/30. Took 0.059896 seconds. 
  Full-batch training loss = 2.296327, test loss = 2.299188
  Training set accuracy = 0.126500, Test set accuracy = 0.118900
 epoch 6/30. Took 0.066057 seconds. 
  Full-batch training loss = 2.294608, test loss = 2.297669
  Training set accuracy = 0.122500, Test set accuracy = 0.116200
 epoch 7/30. Took 0.059071 seconds. 
  Full-batch training loss = 2.292854, test loss = 2.296081
  Training set accuracy = 0.122000, Test set accuracy = 0.114900
 epoch 8/30. Took 0.057675 seconds. 
  Full-batch training loss = 2.291231, test loss = 2.294562
  Training set accuracy = 0.122000, Test set accuracy = 0.115200
 epoch 9/30. Took 0.060454 seconds. 
  Full-batch training loss = 2.289414, test loss = 2.292896
  Training set accuracy = 0.122500, Test set accuracy = 0.117000
 epoch 10/30. Took 0.059329 seconds. 
  Full-batch training loss = 2.287328, test loss = 2.291057
  Training set accuracy = 0.124500, Test set accuracy = 0.118500
 epoch 11/30. Took 0.059175 seconds. 
  Full-batch training loss = 2.285294, test loss = 2.289187
  Training set accuracy = 0.135000, Test set accuracy = 0.124500
 epoch 12/30. Took 0.059173 seconds. 
  Full-batch training loss = 2.282951, test loss = 2.286866
  Training set accuracy = 0.143000, Test set accuracy = 0.132800
 epoch 13/30. Took 0.059986 seconds. 
  Full-batch training loss = 2.280412, test loss = 2.284461
  Training set accuracy = 0.155000, Test set accuracy = 0.146800
 epoch 14/30. Took 0.061555 seconds. 
  Full-batch training loss = 2.277688, test loss = 2.281858
  Training set accuracy = 0.165000, Test set accuracy = 0.154200
 epoch 15/30. Took 0.061592 seconds. 
  Full-batch training loss = 2.274331, test loss = 2.278651
  Training set accuracy = 0.171000, Test set accuracy = 0.162100
 epoch 16/30. Took 0.06176 seconds. 
  Full-batch training loss = 2.270732, test loss = 2.275063
  Training set accuracy = 0.182000, Test set accuracy = 0.172100
 epoch 17/30. Took 0.061684 seconds. 
  Full-batch training loss = 2.266490, test loss = 2.271150
  Training set accuracy = 0.196000, Test set accuracy = 0.186500
 epoch 18/30. Took 0.059862 seconds. 
  Full-batch training loss = 2.262010, test loss = 2.266814
  Training set accuracy = 0.216500, Test set accuracy = 0.197600
 epoch 19/30. Took 0.059328 seconds. 
  Full-batch training loss = 2.256269, test loss = 2.261194
  Training set accuracy = 0.234000, Test set accuracy = 0.215100
 epoch 20/30. Took 0.055648 seconds. 
  Full-batch training loss = 2.249493, test loss = 2.254636
  Training set accuracy = 0.246000, Test set accuracy = 0.225500
 epoch 21/30. Took 0.059862 seconds. 
  Full-batch training loss = 2.241611, test loss = 2.246975
  Training set accuracy = 0.257500, Test set accuracy = 0.235000
 epoch 22/30. Took 0.061057 seconds. 
  Full-batch training loss = 2.232779, test loss = 2.238202
  Training set accuracy = 0.269000, Test set accuracy = 0.244100
 epoch 23/30. Took 0.062951 seconds. 
  Full-batch training loss = 2.222059, test loss = 2.227786
  Training set accuracy = 0.281000, Test set accuracy = 0.256500
 epoch 24/30. Took 0.060287 seconds. 
  Full-batch training loss = 2.208917, test loss = 2.214938
  Training set accuracy = 0.288500, Test set accuracy = 0.264000
 epoch 25/30. Took 0.060697 seconds. 
  Full-batch training loss = 2.193821, test loss = 2.200262
  Training set accuracy = 0.300500, Test set accuracy = 0.273200
 epoch 26/30. Took 0.054264 seconds. 
  Full-batch training loss = 2.176440, test loss = 2.183360
  Training set accuracy = 0.305000, Test set accuracy = 0.281000
 epoch 27/30. Took 0.05679 seconds. 
  Full-batch training loss = 2.156441, test loss = 2.163957
  Training set accuracy = 0.308500, Test set accuracy = 0.287200
 epoch 28/30. Took 0.06006 seconds. 
  Full-batch training loss = 2.133593, test loss = 2.141586
  Training set accuracy = 0.314000, Test set accuracy = 0.291600
 epoch 29/30. Took 0.059814 seconds. 
  Full-batch training loss = 2.108765, test loss = 2.117076
  Training set accuracy = 0.318500, Test set accuracy = 0.295800
 epoch 30/30. Took 0.060608 seconds. 
  Full-batch training loss = 2.082187, test loss = 2.090592
  Training set accuracy = 0.325500, Test set accuracy = 0.301800
Elapsed time is 6.706047 seconds.
End Training
-----
Params 2000 0.010 0.50 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.10698 seconds. 
  Full-batch training loss = 2.301268, test loss = 2.302420
  Training set accuracy = 0.101500, Test set accuracy = 0.104100
 epoch 2/30. Took 0.10332 seconds. 
  Full-batch training loss = 2.297871, test loss = 2.299478
  Training set accuracy = 0.114000, Test set accuracy = 0.112000
 epoch 3/30. Took 0.1097 seconds. 
  Full-batch training loss = 2.294885, test loss = 2.296900
  Training set accuracy = 0.126500, Test set accuracy = 0.122900
 epoch 4/30. Took 0.10888 seconds. 
  Full-batch training loss = 2.292086, test loss = 2.294422
  Training set accuracy = 0.147500, Test set accuracy = 0.142700
 epoch 5/30. Took 0.10315 seconds. 
  Full-batch training loss = 2.289468, test loss = 2.292094
  Training set accuracy = 0.216500, Test set accuracy = 0.202600
 epoch 6/30. Took 0.10482 seconds. 
  Full-batch training loss = 2.286793, test loss = 2.289675
  Training set accuracy = 0.249000, Test set accuracy = 0.235500
 epoch 7/30. Took 0.13266 seconds. 
  Full-batch training loss = 2.283945, test loss = 2.287190
  Training set accuracy = 0.261000, Test set accuracy = 0.247700
 epoch 8/30. Took 0.10657 seconds. 
  Full-batch training loss = 2.281008, test loss = 2.284476
  Training set accuracy = 0.230000, Test set accuracy = 0.211300
 epoch 9/30. Took 0.11431 seconds. 
  Full-batch training loss = 2.277941, test loss = 2.281534
  Training set accuracy = 0.236000, Test set accuracy = 0.221300
 epoch 10/30. Took 0.10477 seconds. 
  Full-batch training loss = 2.274679, test loss = 2.278618
  Training set accuracy = 0.253500, Test set accuracy = 0.239200
 epoch 11/30. Took 0.10618 seconds. 
  Full-batch training loss = 2.270950, test loss = 2.274952
  Training set accuracy = 0.227000, Test set accuracy = 0.217100
 epoch 12/30. Took 0.10648 seconds. 
  Full-batch training loss = 2.266866, test loss = 2.271077
  Training set accuracy = 0.245000, Test set accuracy = 0.231700
 epoch 13/30. Took 0.10889 seconds. 
  Full-batch training loss = 2.262424, test loss = 2.266869
  Training set accuracy = 0.262000, Test set accuracy = 0.243400
 epoch 14/30. Took 0.10819 seconds. 
  Full-batch training loss = 2.257249, test loss = 2.261865
  Training set accuracy = 0.266000, Test set accuracy = 0.247100
 epoch 15/30. Took 0.10942 seconds. 
  Full-batch training loss = 2.251425, test loss = 2.256285
  Training set accuracy = 0.286000, Test set accuracy = 0.263200
 epoch 16/30. Took 0.10398 seconds. 
  Full-batch training loss = 2.244457, test loss = 2.249580
  Training set accuracy = 0.301500, Test set accuracy = 0.277000
 epoch 17/30. Took 0.11889 seconds. 
  Full-batch training loss = 2.236590, test loss = 2.241973
  Training set accuracy = 0.310000, Test set accuracy = 0.292800
 epoch 18/30. Took 0.10993 seconds. 
  Full-batch training loss = 2.227566, test loss = 2.233364
  Training set accuracy = 0.328500, Test set accuracy = 0.310300
 epoch 19/30. Took 0.1059 seconds. 
  Full-batch training loss = 2.217180, test loss = 2.223261
  Training set accuracy = 0.344500, Test set accuracy = 0.326600
 epoch 20/30. Took 0.1087 seconds. 
  Full-batch training loss = 2.204711, test loss = 2.211185
  Training set accuracy = 0.363000, Test set accuracy = 0.343100
 epoch 21/30. Took 0.10844 seconds. 
  Full-batch training loss = 2.189969, test loss = 2.196939
  Training set accuracy = 0.389000, Test set accuracy = 0.363000
 epoch 22/30. Took 0.10262 seconds. 
  Full-batch training loss = 2.172768, test loss = 2.180296
  Training set accuracy = 0.392500, Test set accuracy = 0.370300
 epoch 23/30. Took 0.11529 seconds. 
  Full-batch training loss = 2.151970, test loss = 2.160245
  Training set accuracy = 0.405500, Test set accuracy = 0.385600
 epoch 24/30. Took 0.10819 seconds. 
  Full-batch training loss = 2.128414, test loss = 2.137620
  Training set accuracy = 0.402500, Test set accuracy = 0.380600
 epoch 25/30. Took 0.11004 seconds. 
  Full-batch training loss = 2.100650, test loss = 2.110713
  Training set accuracy = 0.408500, Test set accuracy = 0.387100
 epoch 26/30. Took 0.11041 seconds. 
  Full-batch training loss = 2.068695, test loss = 2.079694
  Training set accuracy = 0.413500, Test set accuracy = 0.390700
 epoch 27/30. Took 0.10856 seconds. 
  Full-batch training loss = 2.031091, test loss = 2.043245
  Training set accuracy = 0.416500, Test set accuracy = 0.396000
 epoch 28/30. Took 0.11382 seconds. 
  Full-batch training loss = 1.989734, test loss = 2.002836
  Training set accuracy = 0.431500, Test set accuracy = 0.411900
 epoch 29/30. Took 0.11668 seconds. 
  Full-batch training loss = 1.943425, test loss = 1.957935
  Training set accuracy = 0.438500, Test set accuracy = 0.420900
 epoch 30/30. Took 0.10788 seconds. 
  Full-batch training loss = 1.891357, test loss = 1.906909
  Training set accuracy = 0.454500, Test set accuracy = 0.437600
Elapsed time is 11.399295 seconds.
End Training
-----
Params 2000 0.010 0.50 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32267 seconds. 
  Full-batch training loss = 2.302492, test loss = 2.303816
  Training set accuracy = 0.082000, Test set accuracy = 0.082100
 epoch 2/30. Took 0.3444 seconds. 
  Full-batch training loss = 2.298494, test loss = 2.299731
  Training set accuracy = 0.122000, Test set accuracy = 0.116600
 epoch 3/30. Took 0.32142 seconds. 
  Full-batch training loss = 2.294690, test loss = 2.295813
  Training set accuracy = 0.183000, Test set accuracy = 0.168400
 epoch 4/30. Took 0.34939 seconds. 
  Full-batch training loss = 2.290878, test loss = 2.291975
  Training set accuracy = 0.189500, Test set accuracy = 0.176900
 epoch 5/30. Took 0.3557 seconds. 
  Full-batch training loss = 2.286995, test loss = 2.288041
  Training set accuracy = 0.210500, Test set accuracy = 0.198700
 epoch 6/30. Took 0.32235 seconds. 
  Full-batch training loss = 2.282991, test loss = 2.283978
  Training set accuracy = 0.263000, Test set accuracy = 0.246300
 epoch 7/30. Took 0.33254 seconds. 
  Full-batch training loss = 2.278592, test loss = 2.279617
  Training set accuracy = 0.263500, Test set accuracy = 0.248300
 epoch 8/30. Took 0.32253 seconds. 
  Full-batch training loss = 2.273885, test loss = 2.274841
  Training set accuracy = 0.403500, Test set accuracy = 0.388100
 epoch 9/30. Took 0.36294 seconds. 
  Full-batch training loss = 2.268568, test loss = 2.269568
  Training set accuracy = 0.432000, Test set accuracy = 0.418300
 epoch 10/30. Took 0.34484 seconds. 
  Full-batch training loss = 2.262692, test loss = 2.263719
  Training set accuracy = 0.465500, Test set accuracy = 0.452000
 epoch 11/30. Took 0.32177 seconds. 
  Full-batch training loss = 2.256073, test loss = 2.257093
  Training set accuracy = 0.494000, Test set accuracy = 0.478700
 epoch 12/30. Took 0.3226 seconds. 
  Full-batch training loss = 2.248368, test loss = 2.249419
  Training set accuracy = 0.536500, Test set accuracy = 0.518600
 epoch 13/30. Took 0.35137 seconds. 
  Full-batch training loss = 2.239303, test loss = 2.240356
  Training set accuracy = 0.522500, Test set accuracy = 0.512700
 epoch 14/30. Took 0.31923 seconds. 
  Full-batch training loss = 2.228850, test loss = 2.229966
  Training set accuracy = 0.514000, Test set accuracy = 0.512600
 epoch 15/30. Took 0.3234 seconds. 
  Full-batch training loss = 2.216399, test loss = 2.217500
  Training set accuracy = 0.532000, Test set accuracy = 0.520500
 epoch 16/30. Took 0.35092 seconds. 
  Full-batch training loss = 2.201755, test loss = 2.202812
  Training set accuracy = 0.550000, Test set accuracy = 0.537200
 epoch 17/30. Took 0.32427 seconds. 
  Full-batch training loss = 2.183746, test loss = 2.184898
  Training set accuracy = 0.532000, Test set accuracy = 0.521400
 epoch 18/30. Took 0.33306 seconds. 
  Full-batch training loss = 2.163133, test loss = 2.164234
  Training set accuracy = 0.549500, Test set accuracy = 0.533200
 epoch 19/30. Took 0.32179 seconds. 
  Full-batch training loss = 2.138707, test loss = 2.139799
  Training set accuracy = 0.525500, Test set accuracy = 0.515500
 epoch 20/30. Took 0.32091 seconds. 
  Full-batch training loss = 2.109265, test loss = 2.110310
  Training set accuracy = 0.529500, Test set accuracy = 0.515500
 epoch 21/30. Took 0.3241 seconds. 
  Full-batch training loss = 2.073629, test loss = 2.074567
  Training set accuracy = 0.529500, Test set accuracy = 0.513500
 epoch 22/30. Took 0.32489 seconds. 
  Full-batch training loss = 2.033004, test loss = 2.033843
  Training set accuracy = 0.547000, Test set accuracy = 0.528500
 epoch 23/30. Took 0.32605 seconds. 
  Full-batch training loss = 1.985006, test loss = 1.985538
  Training set accuracy = 0.559000, Test set accuracy = 0.551700
 epoch 24/30. Took 0.33923 seconds. 
  Full-batch training loss = 1.929792, test loss = 1.929973
  Training set accuracy = 0.564000, Test set accuracy = 0.557700
 epoch 25/30. Took 0.35316 seconds. 
  Full-batch training loss = 1.867260, test loss = 1.867216
  Training set accuracy = 0.589500, Test set accuracy = 0.581900
 epoch 26/30. Took 0.32783 seconds. 
  Full-batch training loss = 1.796688, test loss = 1.796447
  Training set accuracy = 0.596500, Test set accuracy = 0.593800
 epoch 27/30. Took 0.32154 seconds. 
  Full-batch training loss = 1.717144, test loss = 1.716802
  Training set accuracy = 0.610500, Test set accuracy = 0.611300
 epoch 28/30. Took 0.32046 seconds. 
  Full-batch training loss = 1.628002, test loss = 1.626863
  Training set accuracy = 0.630000, Test set accuracy = 0.632900
 epoch 29/30. Took 0.32372 seconds. 
  Full-batch training loss = 1.532559, test loss = 1.531660
  Training set accuracy = 0.643000, Test set accuracy = 0.646400
 epoch 30/30. Took 0.33372 seconds. 
  Full-batch training loss = 1.433984, test loss = 1.433289
  Training set accuracy = 0.674000, Test set accuracy = 0.670400
Elapsed time is 32.152270 seconds.
End Training
-----
Params 2000 0.001 0.00 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.037259 seconds. 
  Full-batch training loss = 2.307326, test loss = 2.309118
  Training set accuracy = 0.106000, Test set accuracy = 0.101000
 epoch 2/30. Took 0.034195 seconds. 
  Full-batch training loss = 2.250793, test loss = 2.251157
  Training set accuracy = 0.171000, Test set accuracy = 0.160100
 epoch 3/30. Took 0.034306 seconds. 
  Full-batch training loss = 2.200038, test loss = 2.199441
  Training set accuracy = 0.237500, Test set accuracy = 0.232300
 epoch 4/30. Took 0.032663 seconds. 
  Full-batch training loss = 2.151479, test loss = 2.150491
  Training set accuracy = 0.316000, Test set accuracy = 0.311400
 epoch 5/30. Took 0.032146 seconds. 
  Full-batch training loss = 2.103946, test loss = 2.102688
  Training set accuracy = 0.394000, Test set accuracy = 0.386500
 epoch 6/30. Took 0.033135 seconds. 
  Full-batch training loss = 2.056517, test loss = 2.055214
  Training set accuracy = 0.455000, Test set accuracy = 0.456800
 epoch 7/30. Took 0.032792 seconds. 
  Full-batch training loss = 2.008230, test loss = 2.006801
  Training set accuracy = 0.512000, Test set accuracy = 0.512600
 epoch 8/30. Took 0.033571 seconds. 
  Full-batch training loss = 1.959855, test loss = 1.958123
  Training set accuracy = 0.560500, Test set accuracy = 0.560200
 epoch 9/30. Took 0.03286 seconds. 
  Full-batch training loss = 1.910931, test loss = 1.908850
  Training set accuracy = 0.598000, Test set accuracy = 0.599400
 epoch 10/30. Took 0.033244 seconds. 
  Full-batch training loss = 1.861729, test loss = 1.859248
  Training set accuracy = 0.628500, Test set accuracy = 0.628100
 epoch 11/30. Took 0.034359 seconds. 
  Full-batch training loss = 1.811831, test loss = 1.808800
  Training set accuracy = 0.650500, Test set accuracy = 0.657300
 epoch 12/30. Took 0.031417 seconds. 
  Full-batch training loss = 1.762198, test loss = 1.758832
  Training set accuracy = 0.674500, Test set accuracy = 0.679900
 epoch 13/30. Took 0.031933 seconds. 
  Full-batch training loss = 1.712637, test loss = 1.708808
  Training set accuracy = 0.691000, Test set accuracy = 0.699500
 epoch 14/30. Took 0.031467 seconds. 
  Full-batch training loss = 1.663454, test loss = 1.659098
  Training set accuracy = 0.713000, Test set accuracy = 0.716500
 epoch 15/30. Took 0.033693 seconds. 
  Full-batch training loss = 1.614714, test loss = 1.610069
  Training set accuracy = 0.732000, Test set accuracy = 0.732000
 epoch 16/30. Took 0.034561 seconds. 
  Full-batch training loss = 1.566898, test loss = 1.562041
  Training set accuracy = 0.748000, Test set accuracy = 0.745600
 epoch 17/30. Took 0.031053 seconds. 
  Full-batch training loss = 1.520236, test loss = 1.514821
  Training set accuracy = 0.758500, Test set accuracy = 0.760700
 epoch 18/30. Took 0.031186 seconds. 
  Full-batch training loss = 1.474476, test loss = 1.468822
  Training set accuracy = 0.769000, Test set accuracy = 0.770500
 epoch 19/30. Took 0.031917 seconds. 
  Full-batch training loss = 1.430153, test loss = 1.424356
  Training set accuracy = 0.780500, Test set accuracy = 0.781900
 epoch 20/30. Took 0.032392 seconds. 
  Full-batch training loss = 1.387064, test loss = 1.380948
  Training set accuracy = 0.784500, Test set accuracy = 0.790000
 epoch 21/30. Took 0.033386 seconds. 
  Full-batch training loss = 1.345745, test loss = 1.339369
  Training set accuracy = 0.794500, Test set accuracy = 0.797400
 epoch 22/30. Took 0.037161 seconds. 
  Full-batch training loss = 1.306036, test loss = 1.299406
  Training set accuracy = 0.796500, Test set accuracy = 0.801400
 epoch 23/30. Took 0.0325 seconds. 
  Full-batch training loss = 1.267847, test loss = 1.260978
  Training set accuracy = 0.803500, Test set accuracy = 0.808200
 epoch 24/30. Took 0.036864 seconds. 
  Full-batch training loss = 1.231454, test loss = 1.224525
  Training set accuracy = 0.806000, Test set accuracy = 0.810700
 epoch 25/30. Took 0.03438 seconds. 
  Full-batch training loss = 1.196593, test loss = 1.189587
  Training set accuracy = 0.807000, Test set accuracy = 0.815700
 epoch 26/30. Took 0.032331 seconds. 
  Full-batch training loss = 1.163402, test loss = 1.156453
  Training set accuracy = 0.812000, Test set accuracy = 0.819100
 epoch 27/30. Took 0.033062 seconds. 
  Full-batch training loss = 1.131775, test loss = 1.124639
  Training set accuracy = 0.815500, Test set accuracy = 0.821700
 epoch 28/30. Took 0.031213 seconds. 
  Full-batch training loss = 1.101919, test loss = 1.094838
  Training set accuracy = 0.819500, Test set accuracy = 0.823100
 epoch 29/30. Took 0.033352 seconds. 
  Full-batch training loss = 1.073383, test loss = 1.066491
  Training set accuracy = 0.822000, Test set accuracy = 0.825700
 epoch 30/30. Took 0.03238 seconds. 
  Full-batch training loss = 1.046534, test loss = 1.039919
  Training set accuracy = 0.825000, Test set accuracy = 0.828000
Elapsed time is 4.854942 seconds.
End Training
-----
Params 2000 0.001 0.00 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.059311 seconds. 
  Full-batch training loss = 2.275991, test loss = 2.272850
  Training set accuracy = 0.133500, Test set accuracy = 0.135700
 epoch 2/30. Took 0.054478 seconds. 
  Full-batch training loss = 2.214501, test loss = 2.212124
  Training set accuracy = 0.196500, Test set accuracy = 0.203300
 epoch 3/30. Took 0.054403 seconds. 
  Full-batch training loss = 2.156771, test loss = 2.154963
  Training set accuracy = 0.292000, Test set accuracy = 0.296700
 epoch 4/30. Took 0.060898 seconds. 
  Full-batch training loss = 2.101801, test loss = 2.100654
  Training set accuracy = 0.376000, Test set accuracy = 0.384000
 epoch 5/30. Took 0.054589 seconds. 
  Full-batch training loss = 2.047788, test loss = 2.047244
  Training set accuracy = 0.465500, Test set accuracy = 0.461200
 epoch 6/30. Took 0.056333 seconds. 
  Full-batch training loss = 1.995370, test loss = 1.995387
  Training set accuracy = 0.525500, Test set accuracy = 0.517200
 epoch 7/30. Took 0.05413 seconds. 
  Full-batch training loss = 1.943612, test loss = 1.944272
  Training set accuracy = 0.571500, Test set accuracy = 0.562800
 epoch 8/30. Took 0.055738 seconds. 
  Full-batch training loss = 1.892034, test loss = 1.893096
  Training set accuracy = 0.611500, Test set accuracy = 0.600300
 epoch 9/30. Took 0.058234 seconds. 
  Full-batch training loss = 1.841191, test loss = 1.842495
  Training set accuracy = 0.641500, Test set accuracy = 0.633100
 epoch 10/30. Took 0.056059 seconds. 
  Full-batch training loss = 1.790655, test loss = 1.792108
  Training set accuracy = 0.669500, Test set accuracy = 0.656700
 epoch 11/30. Took 0.056722 seconds. 
  Full-batch training loss = 1.740811, test loss = 1.742613
  Training set accuracy = 0.685000, Test set accuracy = 0.676600
 epoch 12/30. Took 0.056009 seconds. 
  Full-batch training loss = 1.691522, test loss = 1.693473
  Training set accuracy = 0.700500, Test set accuracy = 0.693800
 epoch 13/30. Took 0.055407 seconds. 
  Full-batch training loss = 1.643328, test loss = 1.645303
  Training set accuracy = 0.719000, Test set accuracy = 0.712100
 epoch 14/30. Took 0.061032 seconds. 
  Full-batch training loss = 1.595600, test loss = 1.597896
  Training set accuracy = 0.730000, Test set accuracy = 0.724200
 epoch 15/30. Took 0.054088 seconds. 
  Full-batch training loss = 1.549610, test loss = 1.551918
  Training set accuracy = 0.742500, Test set accuracy = 0.732100
 epoch 16/30. Took 0.053826 seconds. 
  Full-batch training loss = 1.504242, test loss = 1.506626
  Training set accuracy = 0.749000, Test set accuracy = 0.739100
 epoch 17/30. Took 0.055765 seconds. 
  Full-batch training loss = 1.460759, test loss = 1.463068
  Training set accuracy = 0.759500, Test set accuracy = 0.747000
 epoch 18/30. Took 0.053888 seconds. 
  Full-batch training loss = 1.418311, test loss = 1.420680
  Training set accuracy = 0.766500, Test set accuracy = 0.755100
 epoch 19/30. Took 0.054947 seconds. 
  Full-batch training loss = 1.377535, test loss = 1.379956
  Training set accuracy = 0.770000, Test set accuracy = 0.761600
 epoch 20/30. Took 0.055657 seconds. 
  Full-batch training loss = 1.338197, test loss = 1.340432
  Training set accuracy = 0.775000, Test set accuracy = 0.768900
 epoch 21/30. Took 0.054135 seconds. 
  Full-batch training loss = 1.300396, test loss = 1.302557
  Training set accuracy = 0.778500, Test set accuracy = 0.774400
 epoch 22/30. Took 0.053985 seconds. 
  Full-batch training loss = 1.264125, test loss = 1.266003
  Training set accuracy = 0.786000, Test set accuracy = 0.779900
 epoch 23/30. Took 0.055425 seconds. 
  Full-batch training loss = 1.229352, test loss = 1.231354
  Training set accuracy = 0.789000, Test set accuracy = 0.783000
 epoch 24/30. Took 0.054281 seconds. 
  Full-batch training loss = 1.196227, test loss = 1.198146
  Training set accuracy = 0.793500, Test set accuracy = 0.787700
 epoch 25/30. Took 0.055658 seconds. 
  Full-batch training loss = 1.164724, test loss = 1.166400
  Training set accuracy = 0.800500, Test set accuracy = 0.792400
 epoch 26/30. Took 0.061449 seconds. 
  Full-batch training loss = 1.134446, test loss = 1.136128
  Training set accuracy = 0.802500, Test set accuracy = 0.795300
 epoch 27/30. Took 0.052634 seconds. 
  Full-batch training loss = 1.105681, test loss = 1.107379
  Training set accuracy = 0.805500, Test set accuracy = 0.797900
 epoch 28/30. Took 0.055141 seconds. 
  Full-batch training loss = 1.078512, test loss = 1.080205
  Training set accuracy = 0.807500, Test set accuracy = 0.801300
 epoch 29/30. Took 0.05411 seconds. 
  Full-batch training loss = 1.052466, test loss = 1.054072
  Training set accuracy = 0.808000, Test set accuracy = 0.804000
 epoch 30/30. Took 0.054859 seconds. 
  Full-batch training loss = 1.027728, test loss = 1.029220
  Training set accuracy = 0.811500, Test set accuracy = 0.806800
Elapsed time is 7.065187 seconds.
End Training
-----
Params 2000 0.001 0.00 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.12678 seconds. 
  Full-batch training loss = 2.278321, test loss = 2.269497
  Training set accuracy = 0.125500, Test set accuracy = 0.128500
 epoch 2/30. Took 0.11881 seconds. 
  Full-batch training loss = 2.205158, test loss = 2.201188
  Training set accuracy = 0.234500, Test set accuracy = 0.239400
 epoch 3/30. Took 0.1205 seconds. 
  Full-batch training loss = 2.136928, test loss = 2.137489
  Training set accuracy = 0.365500, Test set accuracy = 0.377700
 epoch 4/30. Took 0.12201 seconds. 
  Full-batch training loss = 2.073386, test loss = 2.076625
  Training set accuracy = 0.483500, Test set accuracy = 0.476500
 epoch 5/30. Took 0.12018 seconds. 
  Full-batch training loss = 2.011446, test loss = 2.017618
  Training set accuracy = 0.560500, Test set accuracy = 0.553500
 epoch 6/30. Took 0.11636 seconds. 
  Full-batch training loss = 1.951192, test loss = 1.959750
  Training set accuracy = 0.605500, Test set accuracy = 0.597600
 epoch 7/30. Took 0.11727 seconds. 
  Full-batch training loss = 1.892200, test loss = 1.902372
  Training set accuracy = 0.642500, Test set accuracy = 0.631700
 epoch 8/30. Took 0.12962 seconds. 
  Full-batch training loss = 1.834262, test loss = 1.846486
  Training set accuracy = 0.667500, Test set accuracy = 0.649100
 epoch 9/30. Took 0.12415 seconds. 
  Full-batch training loss = 1.777520, test loss = 1.790956
  Training set accuracy = 0.687500, Test set accuracy = 0.667100
 epoch 10/30. Took 0.1172 seconds. 
  Full-batch training loss = 1.721822, test loss = 1.736796
  Training set accuracy = 0.702500, Test set accuracy = 0.680100
 epoch 11/30. Took 0.11608 seconds. 
  Full-batch training loss = 1.667264, test loss = 1.683538
  Training set accuracy = 0.716000, Test set accuracy = 0.690900
 epoch 12/30. Took 0.16289 seconds. 
  Full-batch training loss = 1.614015, test loss = 1.631288
  Training set accuracy = 0.727500, Test set accuracy = 0.700200
 epoch 13/30. Took 0.14774 seconds. 
  Full-batch training loss = 1.562018, test loss = 1.580546
  Training set accuracy = 0.738000, Test set accuracy = 0.707900
 epoch 14/30. Took 0.14139 seconds. 
  Full-batch training loss = 1.511758, test loss = 1.530517
  Training set accuracy = 0.748500, Test set accuracy = 0.719400
 epoch 15/30. Took 0.14121 seconds. 
  Full-batch training loss = 1.462752, test loss = 1.482554
  Training set accuracy = 0.754500, Test set accuracy = 0.727200
 epoch 16/30. Took 0.13943 seconds. 
  Full-batch training loss = 1.415818, test loss = 1.436471
  Training set accuracy = 0.759000, Test set accuracy = 0.735100
 epoch 17/30. Took 0.15416 seconds. 
  Full-batch training loss = 1.370562, test loss = 1.391914
  Training set accuracy = 0.771000, Test set accuracy = 0.742200
 epoch 18/30. Took 0.13477 seconds. 
  Full-batch training loss = 1.327007, test loss = 1.349093
  Training set accuracy = 0.775500, Test set accuracy = 0.749600
 epoch 19/30. Took 0.15927 seconds. 
  Full-batch training loss = 1.285345, test loss = 1.307594
  Training set accuracy = 0.781500, Test set accuracy = 0.756600
 epoch 20/30. Took 0.13996 seconds. 
  Full-batch training loss = 1.245627, test loss = 1.268841
  Training set accuracy = 0.789500, Test set accuracy = 0.762600
 epoch 21/30. Took 0.13806 seconds. 
  Full-batch training loss = 1.207764, test loss = 1.231778
  Training set accuracy = 0.795500, Test set accuracy = 0.766500
 epoch 22/30. Took 0.13225 seconds. 
  Full-batch training loss = 1.171639, test loss = 1.196371
  Training set accuracy = 0.798500, Test set accuracy = 0.770300
 epoch 23/30. Took 0.13444 seconds. 
  Full-batch training loss = 1.137412, test loss = 1.162368
  Training set accuracy = 0.807500, Test set accuracy = 0.776600
 epoch 24/30. Took 0.14254 seconds. 
  Full-batch training loss = 1.104868, test loss = 1.130548
  Training set accuracy = 0.808500, Test set accuracy = 0.781800
 epoch 25/30. Took 0.12639 seconds. 
  Full-batch training loss = 1.073757, test loss = 1.100172
  Training set accuracy = 0.813000, Test set accuracy = 0.784600
 epoch 26/30. Took 0.1262 seconds. 
  Full-batch training loss = 1.044594, test loss = 1.071938
  Training set accuracy = 0.817000, Test set accuracy = 0.788900
 epoch 27/30. Took 0.126 seconds. 
  Full-batch training loss = 1.016937, test loss = 1.044985
  Training set accuracy = 0.820500, Test set accuracy = 0.793200
 epoch 28/30. Took 0.12274 seconds. 
  Full-batch training loss = 0.990690, test loss = 1.019059
  Training set accuracy = 0.825500, Test set accuracy = 0.797300
 epoch 29/30. Took 0.12141 seconds. 
  Full-batch training loss = 0.965845, test loss = 0.994817
  Training set accuracy = 0.829000, Test set accuracy = 0.800400
 epoch 30/30. Took 0.13408 seconds. 
  Full-batch training loss = 0.942077, test loss = 0.971904
  Training set accuracy = 0.832000, Test set accuracy = 0.803300
Elapsed time is 14.389480 seconds.
End Training
-----
Params 2000 0.001 0.00 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.046349 seconds. 
  Full-batch training loss = 2.278435, test loss = 2.277483
  Training set accuracy = 0.137000, Test set accuracy = 0.140500
 epoch 2/30. Took 0.047367 seconds. 
  Full-batch training loss = 2.249676, test loss = 2.249133
  Training set accuracy = 0.164500, Test set accuracy = 0.169700
 epoch 3/30. Took 0.050651 seconds. 
  Full-batch training loss = 2.222097, test loss = 2.221738
  Training set accuracy = 0.207500, Test set accuracy = 0.210200
 epoch 4/30. Took 0.044436 seconds. 
  Full-batch training loss = 2.194429, test loss = 2.194000
  Training set accuracy = 0.258000, Test set accuracy = 0.271400
 epoch 5/30. Took 0.039358 seconds. 
  Full-batch training loss = 2.166161, test loss = 2.165508
  Training set accuracy = 0.327500, Test set accuracy = 0.337000
 epoch 6/30. Took 0.045614 seconds. 
  Full-batch training loss = 2.136478, test loss = 2.135615
  Training set accuracy = 0.402500, Test set accuracy = 0.405800
 epoch 7/30. Took 0.040317 seconds. 
  Full-batch training loss = 2.105353, test loss = 2.104366
  Training set accuracy = 0.459500, Test set accuracy = 0.458000
 epoch 8/30. Took 0.039816 seconds. 
  Full-batch training loss = 2.073029, test loss = 2.071678
  Training set accuracy = 0.501000, Test set accuracy = 0.500500
 epoch 9/30. Took 0.04037 seconds. 
  Full-batch training loss = 2.039570, test loss = 2.037785
  Training set accuracy = 0.535500, Test set accuracy = 0.530000
 epoch 10/30. Took 0.038999 seconds. 
  Full-batch training loss = 2.004825, test loss = 2.002466
  Training set accuracy = 0.552000, Test set accuracy = 0.553200
 epoch 11/30. Took 0.03903 seconds. 
  Full-batch training loss = 1.968738, test loss = 1.965671
  Training set accuracy = 0.570500, Test set accuracy = 0.572500
 epoch 12/30. Took 0.039815 seconds. 
  Full-batch training loss = 1.930871, test loss = 1.927262
  Training set accuracy = 0.579000, Test set accuracy = 0.587500
 epoch 13/30. Took 0.038404 seconds. 
  Full-batch training loss = 1.891936, test loss = 1.887595
  Training set accuracy = 0.598000, Test set accuracy = 0.604900
 epoch 14/30. Took 0.038903 seconds. 
  Full-batch training loss = 1.851451, test loss = 1.846289
  Training set accuracy = 0.610500, Test set accuracy = 0.620500
 epoch 15/30. Took 0.038877 seconds. 
  Full-batch training loss = 1.810048, test loss = 1.803978
  Training set accuracy = 0.625500, Test set accuracy = 0.635100
 epoch 16/30. Took 0.040046 seconds. 
  Full-batch training loss = 1.767740, test loss = 1.760674
  Training set accuracy = 0.640000, Test set accuracy = 0.647800
 epoch 17/30. Took 0.039476 seconds. 
  Full-batch training loss = 1.724325, test loss = 1.716359
  Training set accuracy = 0.653500, Test set accuracy = 0.660800
 epoch 18/30. Took 0.040315 seconds. 
  Full-batch training loss = 1.680062, test loss = 1.671173
  Training set accuracy = 0.666500, Test set accuracy = 0.669000
 epoch 19/30. Took 0.039055 seconds. 
  Full-batch training loss = 1.635175, test loss = 1.625634
  Training set accuracy = 0.682500, Test set accuracy = 0.683100
 epoch 20/30. Took 0.039925 seconds. 
  Full-batch training loss = 1.590513, test loss = 1.580186
  Training set accuracy = 0.694000, Test set accuracy = 0.690700
 epoch 21/30. Took 0.039711 seconds. 
  Full-batch training loss = 1.545271, test loss = 1.534376
  Training set accuracy = 0.708000, Test set accuracy = 0.703900
 epoch 22/30. Took 0.039447 seconds. 
  Full-batch training loss = 1.500353, test loss = 1.488937
  Training set accuracy = 0.714500, Test set accuracy = 0.711600
 epoch 23/30. Took 0.037282 seconds. 
  Full-batch training loss = 1.455793, test loss = 1.443796
  Training set accuracy = 0.717000, Test set accuracy = 0.721600
 epoch 24/30. Took 0.038959 seconds. 
  Full-batch training loss = 1.411816, test loss = 1.399559
  Training set accuracy = 0.730000, Test set accuracy = 0.728400
 epoch 25/30. Took 0.047338 seconds. 
  Full-batch training loss = 1.368376, test loss = 1.355325
  Training set accuracy = 0.734500, Test set accuracy = 0.732500
 epoch 26/30. Took 0.03882 seconds. 
  Full-batch training loss = 1.325969, test loss = 1.312647
  Training set accuracy = 0.738000, Test set accuracy = 0.743100
 epoch 27/30. Took 0.039945 seconds. 
  Full-batch training loss = 1.284612, test loss = 1.271476
  Training set accuracy = 0.746000, Test set accuracy = 0.750800
 epoch 28/30. Took 0.039424 seconds. 
  Full-batch training loss = 1.244418, test loss = 1.231096
  Training set accuracy = 0.752500, Test set accuracy = 0.756000
 epoch 29/30. Took 0.039664 seconds. 
  Full-batch training loss = 1.205527, test loss = 1.192435
  Training set accuracy = 0.755500, Test set accuracy = 0.760400
 epoch 30/30. Took 0.042121 seconds. 
  Full-batch training loss = 1.168518, test loss = 1.155463
  Training set accuracy = 0.760000, Test set accuracy = 0.764500
Elapsed time is 5.456733 seconds.
End Training
-----
Params 2000 0.001 0.00 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.073514 seconds. 
  Full-batch training loss = 2.292645, test loss = 2.291173
  Training set accuracy = 0.095500, Test set accuracy = 0.109400
 epoch 2/30. Took 0.068579 seconds. 
  Full-batch training loss = 2.260357, test loss = 2.259657
  Training set accuracy = 0.164000, Test set accuracy = 0.168800
 epoch 3/30. Took 0.067973 seconds. 
  Full-batch training loss = 2.229901, test loss = 2.229530
  Training set accuracy = 0.231000, Test set accuracy = 0.238700
 epoch 4/30. Took 0.076198 seconds. 
  Full-batch training loss = 2.199925, test loss = 2.200031
  Training set accuracy = 0.287000, Test set accuracy = 0.297500
 epoch 5/30. Took 0.068242 seconds. 
  Full-batch training loss = 2.169770, test loss = 2.170081
  Training set accuracy = 0.340500, Test set accuracy = 0.357600
 epoch 6/30. Took 0.068485 seconds. 
  Full-batch training loss = 2.139018, test loss = 2.139656
  Training set accuracy = 0.409500, Test set accuracy = 0.428200
 epoch 7/30. Took 0.081428 seconds. 
  Full-batch training loss = 2.107123, test loss = 2.107899
  Training set accuracy = 0.481500, Test set accuracy = 0.496400
 epoch 8/30. Took 0.069223 seconds. 
  Full-batch training loss = 2.074058, test loss = 2.075206
  Training set accuracy = 0.544000, Test set accuracy = 0.548200
 epoch 9/30. Took 0.068367 seconds. 
  Full-batch training loss = 2.039424, test loss = 2.040953
  Training set accuracy = 0.584000, Test set accuracy = 0.588400
 epoch 10/30. Took 0.067859 seconds. 
  Full-batch training loss = 2.003385, test loss = 2.005235
  Training set accuracy = 0.618000, Test set accuracy = 0.618000
 epoch 11/30. Took 0.073852 seconds. 
  Full-batch training loss = 1.965674, test loss = 1.968056
  Training set accuracy = 0.641500, Test set accuracy = 0.639800
 epoch 12/30. Took 0.06703 seconds. 
  Full-batch training loss = 1.925768, test loss = 1.928334
  Training set accuracy = 0.663000, Test set accuracy = 0.659000
 epoch 13/30. Took 0.068792 seconds. 
  Full-batch training loss = 1.884332, test loss = 1.887313
  Training set accuracy = 0.684500, Test set accuracy = 0.674400
 epoch 14/30. Took 0.072408 seconds. 
  Full-batch training loss = 1.840490, test loss = 1.843865
  Training set accuracy = 0.698000, Test set accuracy = 0.686000
 epoch 15/30. Took 0.066958 seconds. 
  Full-batch training loss = 1.795242, test loss = 1.798743
  Training set accuracy = 0.710500, Test set accuracy = 0.698700
 epoch 16/30. Took 0.067135 seconds. 
  Full-batch training loss = 1.748491, test loss = 1.752402
  Training set accuracy = 0.722000, Test set accuracy = 0.707800
 epoch 17/30. Took 0.072993 seconds. 
  Full-batch training loss = 1.699612, test loss = 1.703607
  Training set accuracy = 0.732500, Test set accuracy = 0.716100
 epoch 18/30. Took 0.067623 seconds. 
  Full-batch training loss = 1.649484, test loss = 1.653631
  Training set accuracy = 0.738000, Test set accuracy = 0.724100
 epoch 19/30. Took 0.068787 seconds. 
  Full-batch training loss = 1.598762, test loss = 1.603039
  Training set accuracy = 0.747000, Test set accuracy = 0.731600
 epoch 20/30. Took 0.06886 seconds. 
  Full-batch training loss = 1.546831, test loss = 1.551198
  Training set accuracy = 0.750000, Test set accuracy = 0.736700
 epoch 21/30. Took 0.06795 seconds. 
  Full-batch training loss = 1.494895, test loss = 1.499506
  Training set accuracy = 0.757000, Test set accuracy = 0.746000
 epoch 22/30. Took 0.066308 seconds. 
  Full-batch training loss = 1.443537, test loss = 1.448517
  Training set accuracy = 0.761500, Test set accuracy = 0.749500
 epoch 23/30. Took 0.068797 seconds. 
  Full-batch training loss = 1.392695, test loss = 1.397467
  Training set accuracy = 0.767500, Test set accuracy = 0.757000
 epoch 24/30. Took 0.068162 seconds. 
  Full-batch training loss = 1.342759, test loss = 1.347826
  Training set accuracy = 0.773000, Test set accuracy = 0.762100
 epoch 25/30. Took 0.068793 seconds. 
  Full-batch training loss = 1.294586, test loss = 1.299495
  Training set accuracy = 0.778500, Test set accuracy = 0.768500
 epoch 26/30. Took 0.068601 seconds. 
  Full-batch training loss = 1.247658, test loss = 1.252796
  Training set accuracy = 0.781500, Test set accuracy = 0.777200
 epoch 27/30. Took 0.068462 seconds. 
  Full-batch training loss = 1.202903, test loss = 1.208214
  Training set accuracy = 0.782000, Test set accuracy = 0.782000
 epoch 28/30. Took 0.069149 seconds. 
  Full-batch training loss = 1.160177, test loss = 1.165904
  Training set accuracy = 0.788500, Test set accuracy = 0.785600
 epoch 29/30. Took 0.067911 seconds. 
  Full-batch training loss = 1.119401, test loss = 1.125043
  Training set accuracy = 0.794000, Test set accuracy = 0.792200
 epoch 30/30. Took 0.067389 seconds. 
  Full-batch training loss = 1.080862, test loss = 1.086578
  Training set accuracy = 0.798000, Test set accuracy = 0.795900
Elapsed time is 8.788011 seconds.
End Training
-----
Params 2000 0.001 0.00 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.21142 seconds. 
  Full-batch training loss = 2.275461, test loss = 2.279428
  Training set accuracy = 0.191000, Test set accuracy = 0.166700
 epoch 2/30. Took 0.19492 seconds. 
  Full-batch training loss = 2.232665, test loss = 2.237750
  Training set accuracy = 0.255000, Test set accuracy = 0.232100
 epoch 3/30. Took 0.19406 seconds. 
  Full-batch training loss = 2.191429, test loss = 2.197475
  Training set accuracy = 0.342500, Test set accuracy = 0.317300
 epoch 4/30. Took 0.20813 seconds. 
  Full-batch training loss = 2.149665, test loss = 2.156823
  Training set accuracy = 0.411000, Test set accuracy = 0.393900
 epoch 5/30. Took 0.19709 seconds. 
  Full-batch training loss = 2.108034, test loss = 2.116183
  Training set accuracy = 0.485000, Test set accuracy = 0.467500
 epoch 6/30. Took 0.19481 seconds. 
  Full-batch training loss = 2.065040, test loss = 2.074289
  Training set accuracy = 0.538000, Test set accuracy = 0.522600
 epoch 7/30. Took 0.19639 seconds. 
  Full-batch training loss = 2.020385, test loss = 2.030759
  Training set accuracy = 0.583000, Test set accuracy = 0.565900
 epoch 8/30. Took 0.23653 seconds. 
  Full-batch training loss = 1.974626, test loss = 1.986008
  Training set accuracy = 0.620000, Test set accuracy = 0.603900
 epoch 9/30. Took 0.1977 seconds. 
  Full-batch training loss = 1.926374, test loss = 1.938762
  Training set accuracy = 0.649500, Test set accuracy = 0.636500
 epoch 10/30. Took 0.20337 seconds. 
  Full-batch training loss = 1.877103, test loss = 1.890529
  Training set accuracy = 0.670000, Test set accuracy = 0.661100
 epoch 11/30. Took 0.19464 seconds. 
  Full-batch training loss = 1.825513, test loss = 1.839931
  Training set accuracy = 0.684500, Test set accuracy = 0.679700
 epoch 12/30. Took 0.19575 seconds. 
  Full-batch training loss = 1.772559, test loss = 1.788011
  Training set accuracy = 0.704000, Test set accuracy = 0.696600
 epoch 13/30. Took 0.19537 seconds. 
  Full-batch training loss = 1.718542, test loss = 1.735063
  Training set accuracy = 0.716000, Test set accuracy = 0.710700
 epoch 14/30. Took 0.19474 seconds. 
  Full-batch training loss = 1.663276, test loss = 1.680855
  Training set accuracy = 0.730000, Test set accuracy = 0.720200
 epoch 15/30. Took 0.20128 seconds. 
  Full-batch training loss = 1.607724, test loss = 1.626097
  Training set accuracy = 0.741500, Test set accuracy = 0.734900
 epoch 16/30. Took 0.19392 seconds. 
  Full-batch training loss = 1.551702, test loss = 1.571023
  Training set accuracy = 0.747500, Test set accuracy = 0.745900
 epoch 17/30. Took 0.19413 seconds. 
  Full-batch training loss = 1.496166, test loss = 1.516463
  Training set accuracy = 0.753000, Test set accuracy = 0.751400
 epoch 18/30. Took 0.19395 seconds. 
  Full-batch training loss = 1.441304, test loss = 1.462083
  Training set accuracy = 0.763000, Test set accuracy = 0.761700
 epoch 19/30. Took 0.19438 seconds. 
  Full-batch training loss = 1.387146, test loss = 1.408735
  Training set accuracy = 0.774000, Test set accuracy = 0.768200
 epoch 20/30. Took 0.19457 seconds. 
  Full-batch training loss = 1.334117, test loss = 1.356392
  Training set accuracy = 0.779000, Test set accuracy = 0.775800
 epoch 21/30. Took 0.19535 seconds. 
  Full-batch training loss = 1.282915, test loss = 1.306105
  Training set accuracy = 0.789000, Test set accuracy = 0.781100
 epoch 22/30. Took 0.19605 seconds. 
  Full-batch training loss = 1.233718, test loss = 1.257368
  Training set accuracy = 0.797000, Test set accuracy = 0.793200
 epoch 23/30. Took 0.19357 seconds. 
  Full-batch training loss = 1.186493, test loss = 1.210838
  Training set accuracy = 0.799500, Test set accuracy = 0.797100
 epoch 24/30. Took 0.1938 seconds. 
  Full-batch training loss = 1.141561, test loss = 1.166756
  Training set accuracy = 0.803500, Test set accuracy = 0.801900
 epoch 25/30. Took 0.20354 seconds. 
  Full-batch training loss = 1.099003, test loss = 1.125093
  Training set accuracy = 0.813000, Test set accuracy = 0.806000
 epoch 26/30. Took 0.19556 seconds. 
  Full-batch training loss = 1.058454, test loss = 1.084973
  Training set accuracy = 0.820500, Test set accuracy = 0.810400
 epoch 27/30. Took 0.194 seconds. 
  Full-batch training loss = 1.020519, test loss = 1.048051
  Training set accuracy = 0.823500, Test set accuracy = 0.814100
 epoch 28/30. Took 0.19363 seconds. 
  Full-batch training loss = 0.984662, test loss = 1.012667
  Training set accuracy = 0.831000, Test set accuracy = 0.817400
 epoch 29/30. Took 0.23537 seconds. 
  Full-batch training loss = 0.951024, test loss = 0.979860
  Training set accuracy = 0.832000, Test set accuracy = 0.820400
 epoch 30/30. Took 0.1948 seconds. 
  Full-batch training loss = 0.919674, test loss = 0.949367
  Training set accuracy = 0.836000, Test set accuracy = 0.823300
Elapsed time is 21.253327 seconds.
End Training
-----
Params 2000 0.001 0.00 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.049635 seconds. 
  Full-batch training loss = 2.306895, test loss = 2.301418
  Training set accuracy = 0.188000, Test set accuracy = 0.203900
 epoch 2/30. Took 0.04639 seconds. 
  Full-batch training loss = 2.296413, test loss = 2.291462
  Training set accuracy = 0.210500, Test set accuracy = 0.225600
 epoch 3/30. Took 0.042587 seconds. 
  Full-batch training loss = 2.286413, test loss = 2.281860
  Training set accuracy = 0.228500, Test set accuracy = 0.244700
 epoch 4/30. Took 0.0421 seconds. 
  Full-batch training loss = 2.276829, test loss = 2.272564
  Training set accuracy = 0.240000, Test set accuracy = 0.256600
 epoch 5/30. Took 0.044841 seconds. 
  Full-batch training loss = 2.267286, test loss = 2.263325
  Training set accuracy = 0.252500, Test set accuracy = 0.265700
 epoch 6/30. Took 0.045036 seconds. 
  Full-batch training loss = 2.257577, test loss = 2.253884
  Training set accuracy = 0.258000, Test set accuracy = 0.272900
 epoch 7/30. Took 0.044727 seconds. 
  Full-batch training loss = 2.247453, test loss = 2.243880
  Training set accuracy = 0.265000, Test set accuracy = 0.278100
 epoch 8/30. Took 0.04478 seconds. 
  Full-batch training loss = 2.237047, test loss = 2.233647
  Training set accuracy = 0.270000, Test set accuracy = 0.282800
 epoch 9/30. Took 0.045259 seconds. 
  Full-batch training loss = 2.226006, test loss = 2.222601
  Training set accuracy = 0.274500, Test set accuracy = 0.286800
 epoch 10/30. Took 0.044933 seconds. 
  Full-batch training loss = 2.214170, test loss = 2.210819
  Training set accuracy = 0.278500, Test set accuracy = 0.292000
 epoch 11/30. Took 0.045143 seconds. 
  Full-batch training loss = 2.201536, test loss = 2.198226
  Training set accuracy = 0.285500, Test set accuracy = 0.298300
 epoch 12/30. Took 0.045608 seconds. 
  Full-batch training loss = 2.188029, test loss = 2.184668
  Training set accuracy = 0.296000, Test set accuracy = 0.307100
 epoch 13/30. Took 0.044624 seconds. 
  Full-batch training loss = 2.173510, test loss = 2.169961
  Training set accuracy = 0.311500, Test set accuracy = 0.323200
 epoch 14/30. Took 0.044838 seconds. 
  Full-batch training loss = 2.157954, test loss = 2.154271
  Training set accuracy = 0.325500, Test set accuracy = 0.344200
 epoch 15/30. Took 0.045079 seconds. 
  Full-batch training loss = 2.141142, test loss = 2.137105
  Training set accuracy = 0.351500, Test set accuracy = 0.367000
 epoch 16/30. Took 0.044891 seconds. 
  Full-batch training loss = 2.123067, test loss = 2.118795
  Training set accuracy = 0.372500, Test set accuracy = 0.387200
 epoch 17/30. Took 0.044345 seconds. 
  Full-batch training loss = 2.103281, test loss = 2.098815
  Training set accuracy = 0.401000, Test set accuracy = 0.408700
 epoch 18/30. Took 0.044338 seconds. 
  Full-batch training loss = 2.082019, test loss = 2.077383
  Training set accuracy = 0.423000, Test set accuracy = 0.430400
 epoch 19/30. Took 0.046185 seconds. 
  Full-batch training loss = 2.059016, test loss = 2.054176
  Training set accuracy = 0.442000, Test set accuracy = 0.447600
 epoch 20/30. Took 0.044343 seconds. 
  Full-batch training loss = 2.034300, test loss = 2.029239
  Training set accuracy = 0.459500, Test set accuracy = 0.463100
 epoch 21/30. Took 0.044316 seconds. 
  Full-batch training loss = 2.007763, test loss = 2.002306
  Training set accuracy = 0.468000, Test set accuracy = 0.475000
 epoch 22/30. Took 0.046777 seconds. 
  Full-batch training loss = 1.978968, test loss = 1.973486
  Training set accuracy = 0.480000, Test set accuracy = 0.487200
 epoch 23/30. Took 0.044606 seconds. 
  Full-batch training loss = 1.948203, test loss = 1.942550
  Training set accuracy = 0.489500, Test set accuracy = 0.496200
 epoch 24/30. Took 0.044889 seconds. 
  Full-batch training loss = 1.915495, test loss = 1.909585
  Training set accuracy = 0.497000, Test set accuracy = 0.505000
 epoch 25/30. Took 0.043474 seconds. 
  Full-batch training loss = 1.880252, test loss = 1.874260
  Training set accuracy = 0.507500, Test set accuracy = 0.513200
 epoch 26/30. Took 0.04248 seconds. 
  Full-batch training loss = 1.842850, test loss = 1.836728
  Training set accuracy = 0.521500, Test set accuracy = 0.521900
 epoch 27/30. Took 0.042687 seconds. 
  Full-batch training loss = 1.803177, test loss = 1.796933
  Training set accuracy = 0.529000, Test set accuracy = 0.533300
 epoch 28/30. Took 0.04272 seconds. 
  Full-batch training loss = 1.761543, test loss = 1.755282
  Training set accuracy = 0.542000, Test set accuracy = 0.544600
 epoch 29/30. Took 0.044554 seconds. 
  Full-batch training loss = 1.717942, test loss = 1.711945
  Training set accuracy = 0.560000, Test set accuracy = 0.559700
 epoch 30/30. Took 0.044076 seconds. 
  Full-batch training loss = 1.672289, test loss = 1.666203
  Training set accuracy = 0.577000, Test set accuracy = 0.574300
Elapsed time is 6.127900 seconds.
End Training
-----
Params 2000 0.001 0.00 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.085247 seconds. 
  Full-batch training loss = 2.299341, test loss = 2.297675
  Training set accuracy = 0.125500, Test set accuracy = 0.122900
 epoch 2/30. Took 0.078016 seconds. 
  Full-batch training loss = 2.281901, test loss = 2.280307
  Training set accuracy = 0.145000, Test set accuracy = 0.143800
 epoch 3/30. Took 0.078856 seconds. 
  Full-batch training loss = 2.264968, test loss = 2.263404
  Training set accuracy = 0.166000, Test set accuracy = 0.165800
 epoch 4/30. Took 0.079356 seconds. 
  Full-batch training loss = 2.248554, test loss = 2.247051
  Training set accuracy = 0.197000, Test set accuracy = 0.195200
 epoch 5/30. Took 0.079808 seconds. 
  Full-batch training loss = 2.231964, test loss = 2.230469
  Training set accuracy = 0.246500, Test set accuracy = 0.235300
 epoch 6/30. Took 0.081864 seconds. 
  Full-batch training loss = 2.215073, test loss = 2.213616
  Training set accuracy = 0.296500, Test set accuracy = 0.279200
 epoch 7/30. Took 0.081948 seconds. 
  Full-batch training loss = 2.197354, test loss = 2.195935
  Training set accuracy = 0.338500, Test set accuracy = 0.327300
 epoch 8/30. Took 0.082005 seconds. 
  Full-batch training loss = 2.178887, test loss = 2.177377
  Training set accuracy = 0.376500, Test set accuracy = 0.370600
 epoch 9/30. Took 0.08106 seconds. 
  Full-batch training loss = 2.159364, test loss = 2.157916
  Training set accuracy = 0.407500, Test set accuracy = 0.399800
 epoch 10/30. Took 0.081352 seconds. 
  Full-batch training loss = 2.138663, test loss = 2.137226
  Training set accuracy = 0.436500, Test set accuracy = 0.426900
 epoch 11/30. Took 0.082369 seconds. 
  Full-batch training loss = 2.116718, test loss = 2.115242
  Training set accuracy = 0.454500, Test set accuracy = 0.455700
 epoch 12/30. Took 0.084657 seconds. 
  Full-batch training loss = 2.093283, test loss = 2.091727
  Training set accuracy = 0.475500, Test set accuracy = 0.479700
 epoch 13/30. Took 0.078648 seconds. 
  Full-batch training loss = 2.067899, test loss = 2.066202
  Training set accuracy = 0.501000, Test set accuracy = 0.504100
 epoch 14/30. Took 0.095783 seconds. 
  Full-batch training loss = 2.041374, test loss = 2.039532
  Training set accuracy = 0.522500, Test set accuracy = 0.530200
 epoch 15/30. Took 0.080566 seconds. 
  Full-batch training loss = 2.012281, test loss = 2.010359
  Training set accuracy = 0.540500, Test set accuracy = 0.548500
 epoch 16/30. Took 0.081818 seconds. 
  Full-batch training loss = 1.981268, test loss = 1.978941
  Training set accuracy = 0.564000, Test set accuracy = 0.573100
 epoch 17/30. Took 0.07979 seconds. 
  Full-batch training loss = 1.947927, test loss = 1.945440
  Training set accuracy = 0.594000, Test set accuracy = 0.595100
 epoch 18/30. Took 0.079548 seconds. 
  Full-batch training loss = 1.912376, test loss = 1.909414
  Training set accuracy = 0.625500, Test set accuracy = 0.627100
 epoch 19/30. Took 0.078995 seconds. 
  Full-batch training loss = 1.874519, test loss = 1.871145
  Training set accuracy = 0.651000, Test set accuracy = 0.652600
 epoch 20/30. Took 0.080602 seconds. 
  Full-batch training loss = 1.834115, test loss = 1.830265
  Training set accuracy = 0.674000, Test set accuracy = 0.674200
 epoch 21/30. Took 0.080054 seconds. 
  Full-batch training loss = 1.791151, test loss = 1.786921
  Training set accuracy = 0.694500, Test set accuracy = 0.691300
 epoch 22/30. Took 0.081479 seconds. 
  Full-batch training loss = 1.745976, test loss = 1.741138
  Training set accuracy = 0.712000, Test set accuracy = 0.704600
 epoch 23/30. Took 0.079768 seconds. 
  Full-batch training loss = 1.698463, test loss = 1.693063
  Training set accuracy = 0.729500, Test set accuracy = 0.718700
 epoch 24/30. Took 0.080127 seconds. 
  Full-batch training loss = 1.648624, test loss = 1.642804
  Training set accuracy = 0.735000, Test set accuracy = 0.732100
 epoch 25/30. Took 0.080523 seconds. 
  Full-batch training loss = 1.596824, test loss = 1.590553
  Training set accuracy = 0.746000, Test set accuracy = 0.741100
 epoch 26/30. Took 0.078651 seconds. 
  Full-batch training loss = 1.543661, test loss = 1.536896
  Training set accuracy = 0.752500, Test set accuracy = 0.746100
 epoch 27/30. Took 0.082179 seconds. 
  Full-batch training loss = 1.489351, test loss = 1.482552
  Training set accuracy = 0.759500, Test set accuracy = 0.757800
 epoch 28/30. Took 0.090861 seconds. 
  Full-batch training loss = 1.434948, test loss = 1.427920
  Training set accuracy = 0.764500, Test set accuracy = 0.763000
 epoch 29/30. Took 0.081796 seconds. 
  Full-batch training loss = 1.380292, test loss = 1.373351
  Training set accuracy = 0.763500, Test set accuracy = 0.765200
 epoch 30/30. Took 0.081239 seconds. 
  Full-batch training loss = 1.326150, test loss = 1.319288
  Training set accuracy = 0.779000, Test set accuracy = 0.777000
Elapsed time is 10.557226 seconds.
End Training
-----
Params 2000 0.001 0.00 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27303 seconds. 
  Full-batch training loss = 2.311539, test loss = 2.306499
  Training set accuracy = 0.076500, Test set accuracy = 0.070000
 epoch 2/30. Took 0.26903 seconds. 
  Full-batch training loss = 2.285290, test loss = 2.281504
  Training set accuracy = 0.125000, Test set accuracy = 0.120500
 epoch 3/30. Took 0.27002 seconds. 
  Full-batch training loss = 2.260745, test loss = 2.257846
  Training set accuracy = 0.185000, Test set accuracy = 0.173700
 epoch 4/30. Took 0.269 seconds. 
  Full-batch training loss = 2.236967, test loss = 2.235218
  Training set accuracy = 0.229500, Test set accuracy = 0.220800
 epoch 5/30. Took 0.2707 seconds. 
  Full-batch training loss = 2.213897, test loss = 2.212825
  Training set accuracy = 0.305500, Test set accuracy = 0.294900
 epoch 6/30. Took 0.27467 seconds. 
  Full-batch training loss = 2.190231, test loss = 2.189887
  Training set accuracy = 0.383000, Test set accuracy = 0.380000
 epoch 7/30. Took 0.27431 seconds. 
  Full-batch training loss = 2.165898, test loss = 2.166122
  Training set accuracy = 0.463500, Test set accuracy = 0.454600
 epoch 8/30. Took 0.26845 seconds. 
  Full-batch training loss = 2.140418, test loss = 2.141339
  Training set accuracy = 0.504000, Test set accuracy = 0.496600
 epoch 9/30. Took 0.27054 seconds. 
  Full-batch training loss = 2.113495, test loss = 2.114874
  Training set accuracy = 0.536500, Test set accuracy = 0.534600
 epoch 10/30. Took 0.27003 seconds. 
  Full-batch training loss = 2.084617, test loss = 2.086506
  Training set accuracy = 0.577000, Test set accuracy = 0.563400
 epoch 11/30. Took 0.26968 seconds. 
  Full-batch training loss = 2.053915, test loss = 2.056034
  Training set accuracy = 0.605500, Test set accuracy = 0.596800
 epoch 12/30. Took 0.26946 seconds. 
  Full-batch training loss = 2.020840, test loss = 2.023173
  Training set accuracy = 0.633000, Test set accuracy = 0.628500
 epoch 13/30. Took 0.26849 seconds. 
  Full-batch training loss = 1.985033, test loss = 1.987768
  Training set accuracy = 0.649000, Test set accuracy = 0.643300
 epoch 14/30. Took 0.27056 seconds. 
  Full-batch training loss = 1.946029, test loss = 1.948966
  Training set accuracy = 0.658500, Test set accuracy = 0.654400
 epoch 15/30. Took 0.27151 seconds. 
  Full-batch training loss = 1.904115, test loss = 1.907346
  Training set accuracy = 0.664500, Test set accuracy = 0.661900
 epoch 16/30. Took 0.28934 seconds. 
  Full-batch training loss = 1.859191, test loss = 1.862407
  Training set accuracy = 0.681500, Test set accuracy = 0.671700
 epoch 17/30. Took 0.27118 seconds. 
  Full-batch training loss = 1.811335, test loss = 1.814341
  Training set accuracy = 0.687000, Test set accuracy = 0.680000
 epoch 18/30. Took 0.26904 seconds. 
  Full-batch training loss = 1.759966, test loss = 1.762778
  Training set accuracy = 0.695000, Test set accuracy = 0.685600
 epoch 19/30. Took 0.26901 seconds. 
  Full-batch training loss = 1.706193, test loss = 1.708770
  Training set accuracy = 0.702000, Test set accuracy = 0.695200
 epoch 20/30. Took 0.27138 seconds. 
  Full-batch training loss = 1.650104, test loss = 1.652097
  Training set accuracy = 0.706500, Test set accuracy = 0.703600
 epoch 21/30. Took 0.26983 seconds. 
  Full-batch training loss = 1.591719, test loss = 1.593394
  Training set accuracy = 0.713000, Test set accuracy = 0.708800
 epoch 22/30. Took 0.28087 seconds. 
  Full-batch training loss = 1.532161, test loss = 1.533323
  Training set accuracy = 0.724500, Test set accuracy = 0.718100
 epoch 23/30. Took 0.27128 seconds. 
  Full-batch training loss = 1.471676, test loss = 1.471996
  Training set accuracy = 0.730000, Test set accuracy = 0.725800
 epoch 24/30. Took 0.2804 seconds. 
  Full-batch training loss = 1.410937, test loss = 1.411173
  Training set accuracy = 0.734000, Test set accuracy = 0.730100
 epoch 25/30. Took 0.27013 seconds. 
  Full-batch training loss = 1.351691, test loss = 1.351039
  Training set accuracy = 0.738500, Test set accuracy = 0.738000
 epoch 26/30. Took 0.27043 seconds. 
  Full-batch training loss = 1.293363, test loss = 1.291879
  Training set accuracy = 0.746000, Test set accuracy = 0.746200
 epoch 27/30. Took 0.27001 seconds. 
  Full-batch training loss = 1.237481, test loss = 1.234775
  Training set accuracy = 0.753500, Test set accuracy = 0.756300
 epoch 28/30. Took 0.28623 seconds. 
  Full-batch training loss = 1.184418, test loss = 1.181560
  Training set accuracy = 0.765000, Test set accuracy = 0.765400
 epoch 29/30. Took 0.30618 seconds. 
  Full-batch training loss = 1.133458, test loss = 1.129360
  Training set accuracy = 0.770000, Test set accuracy = 0.771200
 epoch 30/30. Took 0.26974 seconds. 
  Full-batch training loss = 1.085961, test loss = 1.081500
  Training set accuracy = 0.779500, Test set accuracy = 0.779500
Elapsed time is 28.914061 seconds.
End Training
-----
Params 2000 0.001 0.10 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.042436 seconds. 
  Full-batch training loss = 2.257030, test loss = 2.257613
  Training set accuracy = 0.176000, Test set accuracy = 0.164800
 epoch 2/30. Took 0.039442 seconds. 
  Full-batch training loss = 2.215693, test loss = 2.217687
  Training set accuracy = 0.232000, Test set accuracy = 0.224000
 epoch 3/30. Took 0.039047 seconds. 
  Full-batch training loss = 2.175033, test loss = 2.178062
  Training set accuracy = 0.315500, Test set accuracy = 0.290100
 epoch 4/30. Took 0.038119 seconds. 
  Full-batch training loss = 2.134095, test loss = 2.138362
  Training set accuracy = 0.393500, Test set accuracy = 0.359500
 epoch 5/30. Took 0.038064 seconds. 
  Full-batch training loss = 2.092783, test loss = 2.098288
  Training set accuracy = 0.454500, Test set accuracy = 0.425800
 epoch 6/30. Took 0.040379 seconds. 
  Full-batch training loss = 2.051289, test loss = 2.057793
  Training set accuracy = 0.504500, Test set accuracy = 0.486700
 epoch 7/30. Took 0.03984 seconds. 
  Full-batch training loss = 2.008586, test loss = 2.016056
  Training set accuracy = 0.543500, Test set accuracy = 0.528500
 epoch 8/30. Took 0.036947 seconds. 
  Full-batch training loss = 1.965792, test loss = 1.974047
  Training set accuracy = 0.566500, Test set accuracy = 0.559600
 epoch 9/30. Took 0.038672 seconds. 
  Full-batch training loss = 1.923143, test loss = 1.932133
  Training set accuracy = 0.593500, Test set accuracy = 0.584000
 epoch 10/30. Took 0.038305 seconds. 
  Full-batch training loss = 1.880465, test loss = 1.889952
  Training set accuracy = 0.612500, Test set accuracy = 0.600800
 epoch 11/30. Took 0.036683 seconds. 
  Full-batch training loss = 1.837830, test loss = 1.847844
  Training set accuracy = 0.630500, Test set accuracy = 0.615300
 epoch 12/30. Took 0.036133 seconds. 
  Full-batch training loss = 1.795608, test loss = 1.805996
  Training set accuracy = 0.644000, Test set accuracy = 0.632200
 epoch 13/30. Took 0.039679 seconds. 
  Full-batch training loss = 1.754032, test loss = 1.764926
  Training set accuracy = 0.658000, Test set accuracy = 0.641700
 epoch 14/30. Took 0.036536 seconds. 
  Full-batch training loss = 1.713295, test loss = 1.724582
  Training set accuracy = 0.668000, Test set accuracy = 0.651800
 epoch 15/30. Took 0.035768 seconds. 
  Full-batch training loss = 1.672615, test loss = 1.684194
  Training set accuracy = 0.677000, Test set accuracy = 0.659200
 epoch 16/30. Took 0.037644 seconds. 
  Full-batch training loss = 1.632959, test loss = 1.644755
  Training set accuracy = 0.688500, Test set accuracy = 0.669000
 epoch 17/30. Took 0.036002 seconds. 
  Full-batch training loss = 1.593883, test loss = 1.605921
  Training set accuracy = 0.697500, Test set accuracy = 0.680500
 epoch 18/30. Took 0.035687 seconds. 
  Full-batch training loss = 1.555679, test loss = 1.567986
  Training set accuracy = 0.702500, Test set accuracy = 0.686400
 epoch 19/30. Took 0.036593 seconds. 
  Full-batch training loss = 1.518289, test loss = 1.530668
  Training set accuracy = 0.710000, Test set accuracy = 0.694100
 epoch 20/30. Took 0.036707 seconds. 
  Full-batch training loss = 1.481842, test loss = 1.494660
  Training set accuracy = 0.719500, Test set accuracy = 0.701200
 epoch 21/30. Took 0.035694 seconds. 
  Full-batch training loss = 1.446323, test loss = 1.459195
  Training set accuracy = 0.726500, Test set accuracy = 0.710400
 epoch 22/30. Took 0.036697 seconds. 
  Full-batch training loss = 1.411618, test loss = 1.424605
  Training set accuracy = 0.729000, Test set accuracy = 0.719000
 epoch 23/30. Took 0.035942 seconds. 
  Full-batch training loss = 1.377969, test loss = 1.391252
  Training set accuracy = 0.735000, Test set accuracy = 0.725200
 epoch 24/30. Took 0.037548 seconds. 
  Full-batch training loss = 1.345419, test loss = 1.358786
  Training set accuracy = 0.743500, Test set accuracy = 0.734000
 epoch 25/30. Took 0.040709 seconds. 
  Full-batch training loss = 1.313882, test loss = 1.327445
  Training set accuracy = 0.751000, Test set accuracy = 0.741500
 epoch 26/30. Took 0.038004 seconds. 
  Full-batch training loss = 1.283333, test loss = 1.296957
  Training set accuracy = 0.756500, Test set accuracy = 0.750100
 epoch 27/30. Took 0.037792 seconds. 
  Full-batch training loss = 1.254023, test loss = 1.268049
  Training set accuracy = 0.756500, Test set accuracy = 0.752700
 epoch 28/30. Took 0.038018 seconds. 
  Full-batch training loss = 1.225697, test loss = 1.239770
  Training set accuracy = 0.764500, Test set accuracy = 0.762700
 epoch 29/30. Took 0.038347 seconds. 
  Full-batch training loss = 1.198353, test loss = 1.212600
  Training set accuracy = 0.772000, Test set accuracy = 0.769500
 epoch 30/30. Took 0.039067 seconds. 
  Full-batch training loss = 1.172076, test loss = 1.186412
  Training set accuracy = 0.776000, Test set accuracy = 0.775200
Elapsed time is 5.068769 seconds.
End Training
-----
Params 2000 0.001 0.10 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.066216 seconds. 
  Full-batch training loss = 2.282455, test loss = 2.282556
  Training set accuracy = 0.153000, Test set accuracy = 0.151900
 epoch 2/30. Took 0.061371 seconds. 
  Full-batch training loss = 2.235570, test loss = 2.236069
  Training set accuracy = 0.211000, Test set accuracy = 0.213300
 epoch 3/30. Took 0.062229 seconds. 
  Full-batch training loss = 2.191429, test loss = 2.192213
  Training set accuracy = 0.299000, Test set accuracy = 0.294400
 epoch 4/30. Took 0.063129 seconds. 
  Full-batch training loss = 2.149950, test loss = 2.150764
  Training set accuracy = 0.370500, Test set accuracy = 0.380300
 epoch 5/30. Took 0.063185 seconds. 
  Full-batch training loss = 2.109017, test loss = 2.109875
  Training set accuracy = 0.454500, Test set accuracy = 0.463900
 epoch 6/30. Took 0.063145 seconds. 
  Full-batch training loss = 2.068341, test loss = 2.069135
  Training set accuracy = 0.517000, Test set accuracy = 0.533700
 epoch 7/30. Took 0.062539 seconds. 
  Full-batch training loss = 2.028560, test loss = 2.029256
  Training set accuracy = 0.575000, Test set accuracy = 0.582200
 epoch 8/30. Took 0.06273 seconds. 
  Full-batch training loss = 1.988715, test loss = 1.989396
  Training set accuracy = 0.608000, Test set accuracy = 0.618200
 epoch 9/30. Took 0.063061 seconds. 
  Full-batch training loss = 1.949063, test loss = 1.949204
  Training set accuracy = 0.634000, Test set accuracy = 0.642500
 epoch 10/30. Took 0.063695 seconds. 
  Full-batch training loss = 1.909248, test loss = 1.909068
  Training set accuracy = 0.662500, Test set accuracy = 0.663600
 epoch 11/30. Took 0.060942 seconds. 
  Full-batch training loss = 1.868930, test loss = 1.868399
  Training set accuracy = 0.674000, Test set accuracy = 0.675900
 epoch 12/30. Took 0.061342 seconds. 
  Full-batch training loss = 1.828916, test loss = 1.827915
  Training set accuracy = 0.688500, Test set accuracy = 0.689300
 epoch 13/30. Took 0.062897 seconds. 
  Full-batch training loss = 1.788872, test loss = 1.787366
  Training set accuracy = 0.698000, Test set accuracy = 0.697600
 epoch 14/30. Took 0.063283 seconds. 
  Full-batch training loss = 1.748936, test loss = 1.746729
  Training set accuracy = 0.709500, Test set accuracy = 0.705700
 epoch 15/30. Took 0.06332 seconds. 
  Full-batch training loss = 1.709244, test loss = 1.706416
  Training set accuracy = 0.719000, Test set accuracy = 0.713500
 epoch 16/30. Took 0.062735 seconds. 
  Full-batch training loss = 1.669679, test loss = 1.666207
  Training set accuracy = 0.727000, Test set accuracy = 0.720900
 epoch 17/30. Took 0.06314 seconds. 
  Full-batch training loss = 1.630627, test loss = 1.626673
  Training set accuracy = 0.735000, Test set accuracy = 0.726800
 epoch 18/30. Took 0.062902 seconds. 
  Full-batch training loss = 1.592478, test loss = 1.587730
  Training set accuracy = 0.738000, Test set accuracy = 0.732100
 epoch 19/30. Took 0.062723 seconds. 
  Full-batch training loss = 1.554497, test loss = 1.549240
  Training set accuracy = 0.744500, Test set accuracy = 0.734400
 epoch 20/30. Took 0.062962 seconds. 
  Full-batch training loss = 1.517469, test loss = 1.511157
  Training set accuracy = 0.750500, Test set accuracy = 0.738200
 epoch 21/30. Took 0.061127 seconds. 
  Full-batch training loss = 1.481453, test loss = 1.474491
  Training set accuracy = 0.751000, Test set accuracy = 0.742900
 epoch 22/30. Took 0.069201 seconds. 
  Full-batch training loss = 1.446332, test loss = 1.438719
  Training set accuracy = 0.753000, Test set accuracy = 0.744500
 epoch 23/30. Took 0.063174 seconds. 
  Full-batch training loss = 1.411790, test loss = 1.403312
  Training set accuracy = 0.757500, Test set accuracy = 0.748400
 epoch 24/30. Took 0.071404 seconds. 
  Full-batch training loss = 1.378515, test loss = 1.369164
  Training set accuracy = 0.760000, Test set accuracy = 0.751600
 epoch 25/30. Took 0.062288 seconds. 
  Full-batch training loss = 1.346309, test loss = 1.336189
  Training set accuracy = 0.763000, Test set accuracy = 0.755000
 epoch 26/30. Took 0.0631 seconds. 
  Full-batch training loss = 1.315120, test loss = 1.304340
  Training set accuracy = 0.769500, Test set accuracy = 0.757900
 epoch 27/30. Took 0.061049 seconds. 
  Full-batch training loss = 1.285023, test loss = 1.273411
  Training set accuracy = 0.772500, Test set accuracy = 0.761100
 epoch 28/30. Took 0.061654 seconds. 
  Full-batch training loss = 1.255824, test loss = 1.243509
  Training set accuracy = 0.778500, Test set accuracy = 0.764900
 epoch 29/30. Took 0.062898 seconds. 
  Full-batch training loss = 1.227815, test loss = 1.214918
  Training set accuracy = 0.780500, Test set accuracy = 0.768400
 epoch 30/30. Took 0.065595 seconds. 
  Full-batch training loss = 1.201025, test loss = 1.187350
  Training set accuracy = 0.783500, Test set accuracy = 0.771600
Elapsed time is 7.122963 seconds.
End Training
-----
Params 2000 0.001 0.10 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.15159 seconds. 
  Full-batch training loss = 2.246367, test loss = 2.248261
  Training set accuracy = 0.196000, Test set accuracy = 0.198600
 epoch 2/30. Took 0.14227 seconds. 
  Full-batch training loss = 2.188157, test loss = 2.191761
  Training set accuracy = 0.317000, Test set accuracy = 0.303300
 epoch 3/30. Took 0.13931 seconds. 
  Full-batch training loss = 2.133206, test loss = 2.138115
  Training set accuracy = 0.417500, Test set accuracy = 0.400300
 epoch 4/30. Took 0.13274 seconds. 
  Full-batch training loss = 2.079291, test loss = 2.085433
  Training set accuracy = 0.498500, Test set accuracy = 0.474400
 epoch 5/30. Took 0.13552 seconds. 
  Full-batch training loss = 2.027501, test loss = 2.034562
  Training set accuracy = 0.555500, Test set accuracy = 0.533300
 epoch 6/30. Took 0.15994 seconds. 
  Full-batch training loss = 1.976309, test loss = 1.984240
  Training set accuracy = 0.601000, Test set accuracy = 0.575600
 epoch 7/30. Took 0.13338 seconds. 
  Full-batch training loss = 1.925790, test loss = 1.934267
  Training set accuracy = 0.646000, Test set accuracy = 0.617500
 epoch 8/30. Took 0.13237 seconds. 
  Full-batch training loss = 1.876369, test loss = 1.885460
  Training set accuracy = 0.671500, Test set accuracy = 0.644600
 epoch 9/30. Took 0.13239 seconds. 
  Full-batch training loss = 1.826921, test loss = 1.836203
  Training set accuracy = 0.708500, Test set accuracy = 0.675300
 epoch 10/30. Took 0.13361 seconds. 
  Full-batch training loss = 1.778318, test loss = 1.788101
  Training set accuracy = 0.731500, Test set accuracy = 0.695500
 epoch 11/30. Took 0.13477 seconds. 
  Full-batch training loss = 1.729925, test loss = 1.740056
  Training set accuracy = 0.749500, Test set accuracy = 0.709100
 epoch 12/30. Took 0.14496 seconds. 
  Full-batch training loss = 1.682408, test loss = 1.692694
  Training set accuracy = 0.764500, Test set accuracy = 0.727800
 epoch 13/30. Took 0.14251 seconds. 
  Full-batch training loss = 1.635617, test loss = 1.646133
  Training set accuracy = 0.772500, Test set accuracy = 0.742400
 epoch 14/30. Took 0.13565 seconds. 
  Full-batch training loss = 1.589607, test loss = 1.600110
  Training set accuracy = 0.782500, Test set accuracy = 0.753400
 epoch 15/30. Took 0.15257 seconds. 
  Full-batch training loss = 1.544611, test loss = 1.555629
  Training set accuracy = 0.792000, Test set accuracy = 0.763100
 epoch 16/30. Took 0.13563 seconds. 
  Full-batch training loss = 1.500850, test loss = 1.512103
  Training set accuracy = 0.797500, Test set accuracy = 0.771000
 epoch 17/30. Took 0.13659 seconds. 
  Full-batch training loss = 1.458000, test loss = 1.469886
  Training set accuracy = 0.801000, Test set accuracy = 0.774500
 epoch 18/30. Took 0.13734 seconds. 
  Full-batch training loss = 1.416272, test loss = 1.428165
  Training set accuracy = 0.809000, Test set accuracy = 0.781700
 epoch 19/30. Took 0.1336 seconds. 
  Full-batch training loss = 1.376055, test loss = 1.388513
  Training set accuracy = 0.811000, Test set accuracy = 0.784800
 epoch 20/30. Took 0.1327 seconds. 
  Full-batch training loss = 1.337005, test loss = 1.350057
  Training set accuracy = 0.821000, Test set accuracy = 0.790900
 epoch 21/30. Took 0.13277 seconds. 
  Full-batch training loss = 1.299491, test loss = 1.312888
  Training set accuracy = 0.824000, Test set accuracy = 0.795000
 epoch 22/30. Took 0.13509 seconds. 
  Full-batch training loss = 1.263102, test loss = 1.276963
  Training set accuracy = 0.827000, Test set accuracy = 0.799500
 epoch 23/30. Took 0.15358 seconds. 
  Full-batch training loss = 1.228488, test loss = 1.243052
  Training set accuracy = 0.832000, Test set accuracy = 0.802000
 epoch 24/30. Took 0.13588 seconds. 
  Full-batch training loss = 1.195365, test loss = 1.210539
  Training set accuracy = 0.834000, Test set accuracy = 0.804500
 epoch 25/30. Took 0.1346 seconds. 
  Full-batch training loss = 1.163254, test loss = 1.178975
  Training set accuracy = 0.837000, Test set accuracy = 0.808600
 epoch 26/30. Took 0.13333 seconds. 
  Full-batch training loss = 1.132785, test loss = 1.149265
  Training set accuracy = 0.837500, Test set accuracy = 0.809400
 epoch 27/30. Took 0.14071 seconds. 
  Full-batch training loss = 1.103632, test loss = 1.120866
  Training set accuracy = 0.842500, Test set accuracy = 0.812600
 epoch 28/30. Took 0.13329 seconds. 
  Full-batch training loss = 1.075763, test loss = 1.093752
  Training set accuracy = 0.845000, Test set accuracy = 0.814400
 epoch 29/30. Took 0.13513 seconds. 
  Full-batch training loss = 1.049221, test loss = 1.067660
  Training set accuracy = 0.846500, Test set accuracy = 0.817500
 epoch 30/30. Took 0.13401 seconds. 
  Full-batch training loss = 1.023918, test loss = 1.043366
  Training set accuracy = 0.845500, Test set accuracy = 0.818600
Elapsed time is 14.475991 seconds.
End Training
-----
Params 2000 0.001 0.10 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.05114 seconds. 
  Full-batch training loss = 2.318264, test loss = 2.320060
  Training set accuracy = 0.110000, Test set accuracy = 0.098300
 epoch 2/30. Took 0.049492 seconds. 
  Full-batch training loss = 2.299390, test loss = 2.301570
  Training set accuracy = 0.124000, Test set accuracy = 0.114700
 epoch 3/30. Took 0.049434 seconds. 
  Full-batch training loss = 2.282353, test loss = 2.284782
  Training set accuracy = 0.139000, Test set accuracy = 0.130100
 epoch 4/30. Took 0.049688 seconds. 
  Full-batch training loss = 2.266043, test loss = 2.268728
  Training set accuracy = 0.152500, Test set accuracy = 0.147300
 epoch 5/30. Took 0.050907 seconds. 
  Full-batch training loss = 2.250155, test loss = 2.253154
  Training set accuracy = 0.172000, Test set accuracy = 0.164900
 epoch 6/30. Took 0.046268 seconds. 
  Full-batch training loss = 2.234216, test loss = 2.237391
  Training set accuracy = 0.203000, Test set accuracy = 0.189300
 epoch 7/30. Took 0.04919 seconds. 
  Full-batch training loss = 2.218321, test loss = 2.221769
  Training set accuracy = 0.233000, Test set accuracy = 0.221100
 epoch 8/30. Took 0.052491 seconds. 
  Full-batch training loss = 2.201782, test loss = 2.205540
  Training set accuracy = 0.275000, Test set accuracy = 0.262700
 epoch 9/30. Took 0.048686 seconds. 
  Full-batch training loss = 2.184504, test loss = 2.188630
  Training set accuracy = 0.314000, Test set accuracy = 0.304400
 epoch 10/30. Took 0.046978 seconds. 
  Full-batch training loss = 2.166758, test loss = 2.171132
  Training set accuracy = 0.353500, Test set accuracy = 0.350400
 epoch 11/30. Took 0.04586 seconds. 
  Full-batch training loss = 2.148209, test loss = 2.152819
  Training set accuracy = 0.395000, Test set accuracy = 0.393900
 epoch 12/30. Took 0.048127 seconds. 
  Full-batch training loss = 2.128547, test loss = 2.133411
  Training set accuracy = 0.438000, Test set accuracy = 0.432100
 epoch 13/30. Took 0.050217 seconds. 
  Full-batch training loss = 2.107972, test loss = 2.113123
  Training set accuracy = 0.477500, Test set accuracy = 0.465100
 epoch 14/30. Took 0.049433 seconds. 
  Full-batch training loss = 2.086244, test loss = 2.091628
  Training set accuracy = 0.512000, Test set accuracy = 0.495300
 epoch 15/30. Took 0.048757 seconds. 
  Full-batch training loss = 2.063609, test loss = 2.069268
  Training set accuracy = 0.532500, Test set accuracy = 0.521000
 epoch 16/30. Took 0.049432 seconds. 
  Full-batch training loss = 2.039593, test loss = 2.045541
  Training set accuracy = 0.562000, Test set accuracy = 0.542300
 epoch 17/30. Took 0.049384 seconds. 
  Full-batch training loss = 2.014080, test loss = 2.020267
  Training set accuracy = 0.588500, Test set accuracy = 0.562600
 epoch 18/30. Took 0.050023 seconds. 
  Full-batch training loss = 1.987661, test loss = 1.994317
  Training set accuracy = 0.607000, Test set accuracy = 0.574700
 epoch 19/30. Took 0.048996 seconds. 
  Full-batch training loss = 1.959860, test loss = 1.966678
  Training set accuracy = 0.621000, Test set accuracy = 0.588500
 epoch 20/30. Took 0.046487 seconds. 
  Full-batch training loss = 1.930850, test loss = 1.938248
  Training set accuracy = 0.628000, Test set accuracy = 0.599900
 epoch 21/30. Took 0.045986 seconds. 
  Full-batch training loss = 1.900611, test loss = 1.908349
  Training set accuracy = 0.636500, Test set accuracy = 0.612100
 epoch 22/30. Took 0.046235 seconds. 
  Full-batch training loss = 1.868812, test loss = 1.877067
  Training set accuracy = 0.645000, Test set accuracy = 0.620300
 epoch 23/30. Took 0.046905 seconds. 
  Full-batch training loss = 1.836417, test loss = 1.845031
  Training set accuracy = 0.648500, Test set accuracy = 0.626400
 epoch 24/30. Took 0.047241 seconds. 
  Full-batch training loss = 1.802763, test loss = 1.811983
  Training set accuracy = 0.657000, Test set accuracy = 0.636200
 epoch 25/30. Took 0.049321 seconds. 
  Full-batch training loss = 1.767931, test loss = 1.777603
  Training set accuracy = 0.664500, Test set accuracy = 0.642700
 epoch 26/30. Took 0.049154 seconds. 
  Full-batch training loss = 1.732445, test loss = 1.742725
  Training set accuracy = 0.668500, Test set accuracy = 0.648700
 epoch 27/30. Took 0.049 seconds. 
  Full-batch training loss = 1.696204, test loss = 1.706945
  Training set accuracy = 0.674500, Test set accuracy = 0.654300
 epoch 28/30. Took 0.049236 seconds. 
  Full-batch training loss = 1.659223, test loss = 1.670774
  Training set accuracy = 0.678500, Test set accuracy = 0.656100
 epoch 29/30. Took 0.046309 seconds. 
  Full-batch training loss = 1.621566, test loss = 1.633568
  Training set accuracy = 0.686000, Test set accuracy = 0.667500
 epoch 30/30. Took 0.04831 seconds. 
  Full-batch training loss = 1.583474, test loss = 1.596087
  Training set accuracy = 0.693000, Test set accuracy = 0.673600
Elapsed time is 5.538368 seconds.
End Training
-----
Params 2000 0.001 0.10 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.089582 seconds. 
  Full-batch training loss = 2.306676, test loss = 2.308989
  Training set accuracy = 0.086500, Test set accuracy = 0.087800
 epoch 2/30. Took 0.085048 seconds. 
  Full-batch training loss = 2.288940, test loss = 2.291328
  Training set accuracy = 0.102000, Test set accuracy = 0.101300
 epoch 3/30. Took 0.086663 seconds. 
  Full-batch training loss = 2.271476, test loss = 2.274064
  Training set accuracy = 0.121000, Test set accuracy = 0.119900
 epoch 4/30. Took 0.086616 seconds. 
  Full-batch training loss = 2.254785, test loss = 2.257655
  Training set accuracy = 0.145000, Test set accuracy = 0.142300
 epoch 5/30. Took 0.086806 seconds. 
  Full-batch training loss = 2.238137, test loss = 2.241073
  Training set accuracy = 0.177000, Test set accuracy = 0.168500
 epoch 6/30. Took 0.097295 seconds. 
  Full-batch training loss = 2.221488, test loss = 2.224535
  Training set accuracy = 0.218500, Test set accuracy = 0.204800
 epoch 7/30. Took 0.099739 seconds. 
  Full-batch training loss = 2.204615, test loss = 2.207913
  Training set accuracy = 0.265500, Test set accuracy = 0.242600
 epoch 8/30. Took 0.087229 seconds. 
  Full-batch training loss = 2.187076, test loss = 2.190492
  Training set accuracy = 0.314500, Test set accuracy = 0.300900
 epoch 9/30. Took 0.086872 seconds. 
  Full-batch training loss = 2.169325, test loss = 2.172866
  Training set accuracy = 0.372500, Test set accuracy = 0.357900
 epoch 10/30. Took 0.086806 seconds. 
  Full-batch training loss = 2.150822, test loss = 2.154531
  Training set accuracy = 0.435500, Test set accuracy = 0.409200
 epoch 11/30. Took 0.084924 seconds. 
  Full-batch training loss = 2.131400, test loss = 2.135222
  Training set accuracy = 0.481000, Test set accuracy = 0.456600
 epoch 12/30. Took 0.081954 seconds. 
  Full-batch training loss = 2.111133, test loss = 2.115114
  Training set accuracy = 0.527500, Test set accuracy = 0.495800
 epoch 13/30. Took 0.085571 seconds. 
  Full-batch training loss = 2.089846, test loss = 2.093955
  Training set accuracy = 0.565500, Test set accuracy = 0.529900
 epoch 14/30. Took 0.087536 seconds. 
  Full-batch training loss = 2.067987, test loss = 2.072152
  Training set accuracy = 0.591000, Test set accuracy = 0.555700
 epoch 15/30. Took 0.08721 seconds. 
  Full-batch training loss = 2.044698, test loss = 2.048985
  Training set accuracy = 0.608500, Test set accuracy = 0.575800
 epoch 16/30. Took 0.08649 seconds. 
  Full-batch training loss = 2.020185, test loss = 2.024631
  Training set accuracy = 0.631000, Test set accuracy = 0.595600
 epoch 17/30. Took 0.082781 seconds. 
  Full-batch training loss = 1.994545, test loss = 1.999179
  Training set accuracy = 0.650000, Test set accuracy = 0.612700
 epoch 18/30. Took 0.084759 seconds. 
  Full-batch training loss = 1.967594, test loss = 1.972473
  Training set accuracy = 0.661000, Test set accuracy = 0.624000
 epoch 19/30. Took 0.092969 seconds. 
  Full-batch training loss = 1.939449, test loss = 1.944466
  Training set accuracy = 0.676500, Test set accuracy = 0.639700
 epoch 20/30. Took 0.085086 seconds. 
  Full-batch training loss = 1.909766, test loss = 1.915060
  Training set accuracy = 0.687500, Test set accuracy = 0.652700
 epoch 21/30. Took 0.087031 seconds. 
  Full-batch training loss = 1.879070, test loss = 1.884522
  Training set accuracy = 0.699500, Test set accuracy = 0.663200
 epoch 22/30. Took 0.086953 seconds. 
  Full-batch training loss = 1.846835, test loss = 1.852582
  Training set accuracy = 0.710000, Test set accuracy = 0.675000
 epoch 23/30. Took 0.083849 seconds. 
  Full-batch training loss = 1.813301, test loss = 1.819477
  Training set accuracy = 0.714500, Test set accuracy = 0.680700
 epoch 24/30. Took 0.098921 seconds. 
  Full-batch training loss = 1.778794, test loss = 1.785240
  Training set accuracy = 0.718500, Test set accuracy = 0.689500
 epoch 25/30. Took 0.082174 seconds. 
  Full-batch training loss = 1.743171, test loss = 1.749968
  Training set accuracy = 0.728000, Test set accuracy = 0.694000
 epoch 26/30. Took 0.090165 seconds. 
  Full-batch training loss = 1.706392, test loss = 1.713387
  Training set accuracy = 0.739500, Test set accuracy = 0.703600
 epoch 27/30. Took 0.083377 seconds. 
  Full-batch training loss = 1.668740, test loss = 1.676154
  Training set accuracy = 0.745500, Test set accuracy = 0.712200
 epoch 28/30. Took 0.086216 seconds. 
  Full-batch training loss = 1.630007, test loss = 1.637946
  Training set accuracy = 0.750500, Test set accuracy = 0.717800
 epoch 29/30. Took 0.085627 seconds. 
  Full-batch training loss = 1.591304, test loss = 1.599555
  Training set accuracy = 0.755000, Test set accuracy = 0.724700
 epoch 30/30. Took 0.08656 seconds. 
  Full-batch training loss = 1.551548, test loss = 1.560359
  Training set accuracy = 0.757500, Test set accuracy = 0.729600
Elapsed time is 9.368710 seconds.
End Training
-----
Params 2000 0.001 0.10 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23414 seconds. 
  Full-batch training loss = 2.315080, test loss = 2.309716
  Training set accuracy = 0.077500, Test set accuracy = 0.088700
 epoch 2/30. Took 0.27849 seconds. 
  Full-batch training loss = 2.286741, test loss = 2.282947
  Training set accuracy = 0.151500, Test set accuracy = 0.146600
 epoch 3/30. Took 0.22641 seconds. 
  Full-batch training loss = 2.259754, test loss = 2.257507
  Training set accuracy = 0.218500, Test set accuracy = 0.202900
 epoch 4/30. Took 0.22878 seconds. 
  Full-batch training loss = 2.233687, test loss = 2.232628
  Training set accuracy = 0.253500, Test set accuracy = 0.237400
 epoch 5/30. Took 0.24912 seconds. 
  Full-batch training loss = 2.207830, test loss = 2.207926
  Training set accuracy = 0.290500, Test set accuracy = 0.280600
 epoch 6/30. Took 0.22955 seconds. 
  Full-batch training loss = 2.182188, test loss = 2.183091
  Training set accuracy = 0.338000, Test set accuracy = 0.333200
 epoch 7/30. Took 0.24157 seconds. 
  Full-batch training loss = 2.156170, test loss = 2.157981
  Training set accuracy = 0.396000, Test set accuracy = 0.388000
 epoch 8/30. Took 0.24294 seconds. 
  Full-batch training loss = 2.129921, test loss = 2.132532
  Training set accuracy = 0.446500, Test set accuracy = 0.427200
 epoch 9/30. Took 0.23912 seconds. 
  Full-batch training loss = 2.102937, test loss = 2.106285
  Training set accuracy = 0.479000, Test set accuracy = 0.460300
 epoch 10/30. Took 0.23217 seconds. 
  Full-batch training loss = 2.074905, test loss = 2.079056
  Training set accuracy = 0.514000, Test set accuracy = 0.495800
 epoch 11/30. Took 0.22748 seconds. 
  Full-batch training loss = 2.046116, test loss = 2.050804
  Training set accuracy = 0.545500, Test set accuracy = 0.519900
 epoch 12/30. Took 0.22783 seconds. 
  Full-batch training loss = 2.016221, test loss = 2.021362
  Training set accuracy = 0.567500, Test set accuracy = 0.545700
 epoch 13/30. Took 0.22896 seconds. 
  Full-batch training loss = 1.985420, test loss = 1.990878
  Training set accuracy = 0.590500, Test set accuracy = 0.567900
 epoch 14/30. Took 0.22951 seconds. 
  Full-batch training loss = 1.953259, test loss = 1.959197
  Training set accuracy = 0.604000, Test set accuracy = 0.588600
 epoch 15/30. Took 0.22911 seconds. 
  Full-batch training loss = 1.919941, test loss = 1.926222
  Training set accuracy = 0.620500, Test set accuracy = 0.607300
 epoch 16/30. Took 0.23086 seconds. 
  Full-batch training loss = 1.885317, test loss = 1.892046
  Training set accuracy = 0.633000, Test set accuracy = 0.622300
 epoch 17/30. Took 0.23018 seconds. 
  Full-batch training loss = 1.849799, test loss = 1.856660
  Training set accuracy = 0.653000, Test set accuracy = 0.637800
 epoch 18/30. Took 0.24393 seconds. 
  Full-batch training loss = 1.812939, test loss = 1.820222
  Training set accuracy = 0.665500, Test set accuracy = 0.651300
 epoch 19/30. Took 0.22792 seconds. 
  Full-batch training loss = 1.774614, test loss = 1.782004
  Training set accuracy = 0.679500, Test set accuracy = 0.664000
 epoch 20/30. Took 0.23141 seconds. 
  Full-batch training loss = 1.735278, test loss = 1.742818
  Training set accuracy = 0.697000, Test set accuracy = 0.677100
 epoch 21/30. Took 0.23086 seconds. 
  Full-batch training loss = 1.695058, test loss = 1.702726
  Training set accuracy = 0.704500, Test set accuracy = 0.687100
 epoch 22/30. Took 0.2305 seconds. 
  Full-batch training loss = 1.654134, test loss = 1.662154
  Training set accuracy = 0.714000, Test set accuracy = 0.697800
 epoch 23/30. Took 0.22991 seconds. 
  Full-batch training loss = 1.612481, test loss = 1.620663
  Training set accuracy = 0.716500, Test set accuracy = 0.705500
 epoch 24/30. Took 0.22801 seconds. 
  Full-batch training loss = 1.570328, test loss = 1.578728
  Training set accuracy = 0.732500, Test set accuracy = 0.717600
 epoch 25/30. Took 0.2286 seconds. 
  Full-batch training loss = 1.527650, test loss = 1.536521
  Training set accuracy = 0.736000, Test set accuracy = 0.723500
 epoch 26/30. Took 0.23038 seconds. 
  Full-batch training loss = 1.485063, test loss = 1.493824
  Training set accuracy = 0.747000, Test set accuracy = 0.734700
 epoch 27/30. Took 0.22777 seconds. 
  Full-batch training loss = 1.442351, test loss = 1.451528
  Training set accuracy = 0.749000, Test set accuracy = 0.737500
 epoch 28/30. Took 0.22698 seconds. 
  Full-batch training loss = 1.400194, test loss = 1.409597
  Training set accuracy = 0.758500, Test set accuracy = 0.744000
 epoch 29/30. Took 0.22927 seconds. 
  Full-batch training loss = 1.358350, test loss = 1.368405
  Training set accuracy = 0.760500, Test set accuracy = 0.748200
 epoch 30/30. Took 0.24355 seconds. 
  Full-batch training loss = 1.317270, test loss = 1.327438
  Training set accuracy = 0.768500, Test set accuracy = 0.754800
Elapsed time is 23.307925 seconds.
End Training
-----
Params 2000 0.001 0.10 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.063963 seconds. 
  Full-batch training loss = 2.311875, test loss = 2.309293
  Training set accuracy = 0.108000, Test set accuracy = 0.096300
 epoch 2/30. Took 0.059451 seconds. 
  Full-batch training loss = 2.306789, test loss = 2.304402
  Training set accuracy = 0.112000, Test set accuracy = 0.103400
 epoch 3/30. Took 0.059182 seconds. 
  Full-batch training loss = 2.301525, test loss = 2.299348
  Training set accuracy = 0.117500, Test set accuracy = 0.109100
 epoch 4/30. Took 0.059801 seconds. 
  Full-batch training loss = 2.296228, test loss = 2.294285
  Training set accuracy = 0.123500, Test set accuracy = 0.115800
 epoch 5/30. Took 0.059631 seconds. 
  Full-batch training loss = 2.290722, test loss = 2.289074
  Training set accuracy = 0.130000, Test set accuracy = 0.122900
 epoch 6/30. Took 0.058041 seconds. 
  Full-batch training loss = 2.284952, test loss = 2.283647
  Training set accuracy = 0.139000, Test set accuracy = 0.130000
 epoch 7/30. Took 0.055054 seconds. 
  Full-batch training loss = 2.279233, test loss = 2.278202
  Training set accuracy = 0.144000, Test set accuracy = 0.139900
 epoch 8/30. Took 0.054815 seconds. 
  Full-batch training loss = 2.273393, test loss = 2.272648
  Training set accuracy = 0.156000, Test set accuracy = 0.148400
 epoch 9/30. Took 0.054863 seconds. 
  Full-batch training loss = 2.267135, test loss = 2.266664
  Training set accuracy = 0.165500, Test set accuracy = 0.161800
 epoch 10/30. Took 0.0549 seconds. 
  Full-batch training loss = 2.260853, test loss = 2.260651
  Training set accuracy = 0.182500, Test set accuracy = 0.179100
 epoch 11/30. Took 0.06058 seconds. 
  Full-batch training loss = 2.254350, test loss = 2.254443
  Training set accuracy = 0.205500, Test set accuracy = 0.202300
 epoch 12/30. Took 0.059839 seconds. 
  Full-batch training loss = 2.247538, test loss = 2.247905
  Training set accuracy = 0.241000, Test set accuracy = 0.240900
 epoch 13/30. Took 0.059437 seconds. 
  Full-batch training loss = 2.240586, test loss = 2.241224
  Training set accuracy = 0.288000, Test set accuracy = 0.281600
 epoch 14/30. Took 0.059328 seconds. 
  Full-batch training loss = 2.233389, test loss = 2.234339
  Training set accuracy = 0.323500, Test set accuracy = 0.319200
 epoch 15/30. Took 0.059384 seconds. 
  Full-batch training loss = 2.225832, test loss = 2.227063
  Training set accuracy = 0.360000, Test set accuracy = 0.353100
 epoch 16/30. Took 0.059326 seconds. 
  Full-batch training loss = 2.218198, test loss = 2.219712
  Training set accuracy = 0.379500, Test set accuracy = 0.376100
 epoch 17/30. Took 0.059505 seconds. 
  Full-batch training loss = 2.210307, test loss = 2.212115
  Training set accuracy = 0.405000, Test set accuracy = 0.393800
 epoch 18/30. Took 0.057532 seconds. 
  Full-batch training loss = 2.202084, test loss = 2.204240
  Training set accuracy = 0.415500, Test set accuracy = 0.403400
 epoch 19/30. Took 0.0598 seconds. 
  Full-batch training loss = 2.193390, test loss = 2.195858
  Training set accuracy = 0.419500, Test set accuracy = 0.409700
 epoch 20/30. Took 0.059594 seconds. 
  Full-batch training loss = 2.184189, test loss = 2.187023
  Training set accuracy = 0.425000, Test set accuracy = 0.412600
 epoch 21/30. Took 0.058953 seconds. 
  Full-batch training loss = 2.174831, test loss = 2.177933
  Training set accuracy = 0.425500, Test set accuracy = 0.417500
 epoch 22/30. Took 0.059639 seconds. 
  Full-batch training loss = 2.165163, test loss = 2.168619
  Training set accuracy = 0.422500, Test set accuracy = 0.416000
 epoch 23/30. Took 0.059399 seconds. 
  Full-batch training loss = 2.154803, test loss = 2.158663
  Training set accuracy = 0.420500, Test set accuracy = 0.413900
 epoch 24/30. Took 0.060997 seconds. 
  Full-batch training loss = 2.143795, test loss = 2.148071
  Training set accuracy = 0.413500, Test set accuracy = 0.411900
 epoch 25/30. Took 0.058934 seconds. 
  Full-batch training loss = 2.132601, test loss = 2.137188
  Training set accuracy = 0.416000, Test set accuracy = 0.412200
 epoch 26/30. Took 0.06007 seconds. 
  Full-batch training loss = 2.120719, test loss = 2.125754
  Training set accuracy = 0.415000, Test set accuracy = 0.409400
 epoch 27/30. Took 0.057645 seconds. 
  Full-batch training loss = 2.108340, test loss = 2.113756
  Training set accuracy = 0.409500, Test set accuracy = 0.406800
 epoch 28/30. Took 0.055783 seconds. 
  Full-batch training loss = 2.095274, test loss = 2.101072
  Training set accuracy = 0.405500, Test set accuracy = 0.401600
 epoch 29/30. Took 0.059376 seconds. 
  Full-batch training loss = 2.081999, test loss = 2.088212
  Training set accuracy = 0.403000, Test set accuracy = 0.400300
 epoch 30/30. Took 0.058885 seconds. 
  Full-batch training loss = 2.068413, test loss = 2.075041
  Training set accuracy = 0.401500, Test set accuracy = 0.401400
Elapsed time is 6.569396 seconds.
End Training
-----
Params 2000 0.001 0.10 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11025 seconds. 
  Full-batch training loss = 2.301340, test loss = 2.304466
  Training set accuracy = 0.115000, Test set accuracy = 0.102400
 epoch 2/30. Took 0.10632 seconds. 
  Full-batch training loss = 2.293081, test loss = 2.296343
  Training set accuracy = 0.129000, Test set accuracy = 0.113500
 epoch 3/30. Took 0.106 seconds. 
  Full-batch training loss = 2.284957, test loss = 2.288418
  Training set accuracy = 0.141000, Test set accuracy = 0.121200
 epoch 4/30. Took 0.10678 seconds. 
  Full-batch training loss = 2.276883, test loss = 2.280430
  Training set accuracy = 0.154000, Test set accuracy = 0.127800
 epoch 5/30. Took 0.11765 seconds. 
  Full-batch training loss = 2.268816, test loss = 2.272571
  Training set accuracy = 0.160000, Test set accuracy = 0.137000
 epoch 6/30. Took 0.10599 seconds. 
  Full-batch training loss = 2.260877, test loss = 2.264789
  Training set accuracy = 0.173500, Test set accuracy = 0.154600
 epoch 7/30. Took 0.10293 seconds. 
  Full-batch training loss = 2.252824, test loss = 2.256888
  Training set accuracy = 0.190000, Test set accuracy = 0.171900
 epoch 8/30. Took 0.12227 seconds. 
  Full-batch training loss = 2.244607, test loss = 2.248872
  Training set accuracy = 0.214000, Test set accuracy = 0.194800
 epoch 9/30. Took 0.10606 seconds. 
  Full-batch training loss = 2.236121, test loss = 2.240596
  Training set accuracy = 0.247000, Test set accuracy = 0.224100
 epoch 10/30. Took 0.10641 seconds. 
  Full-batch training loss = 2.227525, test loss = 2.232171
  Training set accuracy = 0.284500, Test set accuracy = 0.264100
 epoch 11/30. Took 0.10619 seconds. 
  Full-batch training loss = 2.218581, test loss = 2.223439
  Training set accuracy = 0.330500, Test set accuracy = 0.300500
 epoch 12/30. Took 0.1165 seconds. 
  Full-batch training loss = 2.209397, test loss = 2.214477
  Training set accuracy = 0.358500, Test set accuracy = 0.334000
 epoch 13/30. Took 0.10494 seconds. 
  Full-batch training loss = 2.199653, test loss = 2.204883
  Training set accuracy = 0.401000, Test set accuracy = 0.372400
 epoch 14/30. Took 0.10622 seconds. 
  Full-batch training loss = 2.189421, test loss = 2.194924
  Training set accuracy = 0.444000, Test set accuracy = 0.399000
 epoch 15/30. Took 0.10799 seconds. 
  Full-batch training loss = 2.178576, test loss = 2.184257
  Training set accuracy = 0.472000, Test set accuracy = 0.428200
 epoch 16/30. Took 0.10301 seconds. 
  Full-batch training loss = 2.167403, test loss = 2.173400
  Training set accuracy = 0.491000, Test set accuracy = 0.442400
 epoch 17/30. Took 0.10718 seconds. 
  Full-batch training loss = 2.155431, test loss = 2.161617
  Training set accuracy = 0.517500, Test set accuracy = 0.469200
 epoch 18/30. Took 0.1024 seconds. 
  Full-batch training loss = 2.142821, test loss = 2.149303
  Training set accuracy = 0.529500, Test set accuracy = 0.486100
 epoch 19/30. Took 0.10693 seconds. 
  Full-batch training loss = 2.129098, test loss = 2.135944
  Training set accuracy = 0.540500, Test set accuracy = 0.499700
 epoch 20/30. Took 0.10778 seconds. 
  Full-batch training loss = 2.114695, test loss = 2.121894
  Training set accuracy = 0.555500, Test set accuracy = 0.510200
 epoch 21/30. Took 0.10701 seconds. 
  Full-batch training loss = 2.099333, test loss = 2.106869
  Training set accuracy = 0.563000, Test set accuracy = 0.523100
 epoch 22/30. Took 0.10797 seconds. 
  Full-batch training loss = 2.082729, test loss = 2.090695
  Training set accuracy = 0.564500, Test set accuracy = 0.529700
 epoch 23/30. Took 0.107 seconds. 
  Full-batch training loss = 2.065320, test loss = 2.073603
  Training set accuracy = 0.570000, Test set accuracy = 0.538300
 epoch 24/30. Took 0.10706 seconds. 
  Full-batch training loss = 2.046657, test loss = 2.055447
  Training set accuracy = 0.575500, Test set accuracy = 0.543700
 epoch 25/30. Took 0.1022 seconds. 
  Full-batch training loss = 2.026653, test loss = 2.035754
  Training set accuracy = 0.581500, Test set accuracy = 0.554000
 epoch 26/30. Took 0.10181 seconds. 
  Full-batch training loss = 2.005250, test loss = 2.014990
  Training set accuracy = 0.586000, Test set accuracy = 0.555700
 epoch 27/30. Took 0.10393 seconds. 
  Full-batch training loss = 1.982404, test loss = 1.992522
  Training set accuracy = 0.597500, Test set accuracy = 0.562700
 epoch 28/30. Took 0.10425 seconds. 
  Full-batch training loss = 1.958170, test loss = 1.968831
  Training set accuracy = 0.602000, Test set accuracy = 0.568300
 epoch 29/30. Took 0.10765 seconds. 
  Full-batch training loss = 1.932299, test loss = 1.943496
  Training set accuracy = 0.609500, Test set accuracy = 0.577200
 epoch 30/30. Took 0.10708 seconds. 
  Full-batch training loss = 1.904774, test loss = 1.916417
  Training set accuracy = 0.615000, Test set accuracy = 0.583400
Elapsed time is 11.687719 seconds.
End Training
-----
Params 2000 0.001 0.10 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.3234 seconds. 
  Full-batch training loss = 2.296907, test loss = 2.296220
  Training set accuracy = 0.112000, Test set accuracy = 0.116300
 epoch 2/30. Took 0.32013 seconds. 
  Full-batch training loss = 2.287035, test loss = 2.286508
  Training set accuracy = 0.122500, Test set accuracy = 0.125400
 epoch 3/30. Took 0.32127 seconds. 
  Full-batch training loss = 2.277189, test loss = 2.276883
  Training set accuracy = 0.129000, Test set accuracy = 0.134400
 epoch 4/30. Took 0.31946 seconds. 
  Full-batch training loss = 2.267548, test loss = 2.267444
  Training set accuracy = 0.147500, Test set accuracy = 0.146900
 epoch 5/30. Took 0.32122 seconds. 
  Full-batch training loss = 2.257732, test loss = 2.257761
  Training set accuracy = 0.164500, Test set accuracy = 0.162200
 epoch 6/30. Took 0.32063 seconds. 
  Full-batch training loss = 2.247833, test loss = 2.247835
  Training set accuracy = 0.192500, Test set accuracy = 0.188000
 epoch 7/30. Took 0.32165 seconds. 
  Full-batch training loss = 2.237800, test loss = 2.237808
  Training set accuracy = 0.219000, Test set accuracy = 0.212900
 epoch 8/30. Took 0.32 seconds. 
  Full-batch training loss = 2.227456, test loss = 2.227615
  Training set accuracy = 0.236000, Test set accuracy = 0.231700
 epoch 9/30. Took 0.33358 seconds. 
  Full-batch training loss = 2.216710, test loss = 2.216857
  Training set accuracy = 0.268000, Test set accuracy = 0.260300
 epoch 10/30. Took 0.33393 seconds. 
  Full-batch training loss = 2.205509, test loss = 2.205724
  Training set accuracy = 0.294000, Test set accuracy = 0.281600
 epoch 11/30. Took 0.34271 seconds. 
  Full-batch training loss = 2.193885, test loss = 2.194116
  Training set accuracy = 0.316000, Test set accuracy = 0.304800
 epoch 12/30. Took 0.31819 seconds. 
  Full-batch training loss = 2.181890, test loss = 2.182117
  Training set accuracy = 0.345000, Test set accuracy = 0.328400
 epoch 13/30. Took 0.33072 seconds. 
  Full-batch training loss = 2.169155, test loss = 2.169397
  Training set accuracy = 0.363000, Test set accuracy = 0.352100
 epoch 14/30. Took 0.32302 seconds. 
  Full-batch training loss = 2.155859, test loss = 2.155997
  Training set accuracy = 0.396500, Test set accuracy = 0.385600
 epoch 15/30. Took 0.32151 seconds. 
  Full-batch training loss = 2.141692, test loss = 2.141891
  Training set accuracy = 0.419500, Test set accuracy = 0.411700
 epoch 16/30. Took 0.3212 seconds. 
  Full-batch training loss = 2.126544, test loss = 2.126572
  Training set accuracy = 0.441000, Test set accuracy = 0.436700
 epoch 17/30. Took 0.32194 seconds. 
  Full-batch training loss = 2.110470, test loss = 2.110408
  Training set accuracy = 0.465500, Test set accuracy = 0.467400
 epoch 18/30. Took 0.32221 seconds. 
  Full-batch training loss = 2.093543, test loss = 2.093331
  Training set accuracy = 0.494500, Test set accuracy = 0.501500
 epoch 19/30. Took 0.31766 seconds. 
  Full-batch training loss = 2.075652, test loss = 2.075269
  Training set accuracy = 0.519500, Test set accuracy = 0.529600
 epoch 20/30. Took 0.32289 seconds. 
  Full-batch training loss = 2.056484, test loss = 2.055779
  Training set accuracy = 0.545500, Test set accuracy = 0.549100
 epoch 21/30. Took 0.32065 seconds. 
  Full-batch training loss = 2.035818, test loss = 2.034691
  Training set accuracy = 0.575500, Test set accuracy = 0.578200
 epoch 22/30. Took 0.32037 seconds. 
  Full-batch training loss = 2.013861, test loss = 2.012419
  Training set accuracy = 0.591000, Test set accuracy = 0.595600
 epoch 23/30. Took 0.35914 seconds. 
  Full-batch training loss = 1.990697, test loss = 1.989011
  Training set accuracy = 0.608500, Test set accuracy = 0.614100
 epoch 24/30. Took 0.34364 seconds. 
  Full-batch training loss = 1.965843, test loss = 1.963767
  Training set accuracy = 0.622000, Test set accuracy = 0.630800
 epoch 25/30. Took 0.34806 seconds. 
  Full-batch training loss = 1.939379, test loss = 1.936847
  Training set accuracy = 0.639500, Test set accuracy = 0.649100
 epoch 26/30. Took 0.31988 seconds. 
  Full-batch training loss = 1.910926, test loss = 1.908133
  Training set accuracy = 0.651500, Test set accuracy = 0.660000
 epoch 27/30. Took 0.33886 seconds. 
  Full-batch training loss = 1.881080, test loss = 1.877925
  Training set accuracy = 0.666000, Test set accuracy = 0.671600
 epoch 28/30. Took 0.31956 seconds. 
  Full-batch training loss = 1.849404, test loss = 1.846036
  Training set accuracy = 0.675500, Test set accuracy = 0.681800
 epoch 29/30. Took 0.36897 seconds. 
  Full-batch training loss = 1.815836, test loss = 1.812118
  Training set accuracy = 0.692500, Test set accuracy = 0.696500
 epoch 30/30. Took 0.31641 seconds. 
  Full-batch training loss = 1.780566, test loss = 1.776402
  Training set accuracy = 0.700500, Test set accuracy = 0.706200
Elapsed time is 31.983144 seconds.
End Training
-----
Params 2000 0.001 0.20 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.042793 seconds. 
  Full-batch training loss = 2.296740, test loss = 2.292945
  Training set accuracy = 0.129000, Test set accuracy = 0.134900
 epoch 2/30. Took 0.039311 seconds. 
  Full-batch training loss = 2.262831, test loss = 2.259829
  Training set accuracy = 0.158000, Test set accuracy = 0.160900
 epoch 3/30. Took 0.038675 seconds. 
  Full-batch training loss = 2.231426, test loss = 2.229067
  Training set accuracy = 0.188500, Test set accuracy = 0.191700
 epoch 4/30. Took 0.038162 seconds. 
  Full-batch training loss = 2.201625, test loss = 2.200124
  Training set accuracy = 0.220500, Test set accuracy = 0.229500
 epoch 5/30. Took 0.038548 seconds. 
  Full-batch training loss = 2.172387, test loss = 2.171571
  Training set accuracy = 0.276000, Test set accuracy = 0.279600
 epoch 6/30. Took 0.037441 seconds. 
  Full-batch training loss = 2.143402, test loss = 2.143302
  Training set accuracy = 0.325000, Test set accuracy = 0.331300
 epoch 7/30. Took 0.038104 seconds. 
  Full-batch training loss = 2.114868, test loss = 2.115168
  Training set accuracy = 0.376000, Test set accuracy = 0.384100
 epoch 8/30. Took 0.038439 seconds. 
  Full-batch training loss = 2.085941, test loss = 2.086883
  Training set accuracy = 0.419500, Test set accuracy = 0.423200
 epoch 9/30. Took 0.038023 seconds. 
  Full-batch training loss = 2.056619, test loss = 2.058127
  Training set accuracy = 0.457000, Test set accuracy = 0.456400
 epoch 10/30. Took 0.037929 seconds. 
  Full-batch training loss = 2.026848, test loss = 2.028917
  Training set accuracy = 0.480500, Test set accuracy = 0.484400
 epoch 11/30. Took 0.037806 seconds. 
  Full-batch training loss = 1.997062, test loss = 1.999656
  Training set accuracy = 0.513000, Test set accuracy = 0.515700
 epoch 12/30. Took 0.038008 seconds. 
  Full-batch training loss = 1.966616, test loss = 1.969527
  Training set accuracy = 0.542000, Test set accuracy = 0.538000
 epoch 13/30. Took 0.038341 seconds. 
  Full-batch training loss = 1.935805, test loss = 1.939179
  Training set accuracy = 0.572500, Test set accuracy = 0.565000
 epoch 14/30. Took 0.038579 seconds. 
  Full-batch training loss = 1.904664, test loss = 1.908543
  Training set accuracy = 0.586000, Test set accuracy = 0.585000
 epoch 15/30. Took 0.038004 seconds. 
  Full-batch training loss = 1.873211, test loss = 1.877659
  Training set accuracy = 0.616000, Test set accuracy = 0.607100
 epoch 16/30. Took 0.038203 seconds. 
  Full-batch training loss = 1.841565, test loss = 1.846415
  Training set accuracy = 0.635000, Test set accuracy = 0.623000
 epoch 17/30. Took 0.037773 seconds. 
  Full-batch training loss = 1.809766, test loss = 1.815067
  Training set accuracy = 0.656000, Test set accuracy = 0.637000
 epoch 18/30. Took 0.03965 seconds. 
  Full-batch training loss = 1.778009, test loss = 1.783831
  Training set accuracy = 0.668500, Test set accuracy = 0.651100
 epoch 19/30. Took 0.037933 seconds. 
  Full-batch training loss = 1.745604, test loss = 1.751996
  Training set accuracy = 0.678000, Test set accuracy = 0.662700
 epoch 20/30. Took 0.040781 seconds. 
  Full-batch training loss = 1.713556, test loss = 1.720322
  Training set accuracy = 0.690000, Test set accuracy = 0.674100
 epoch 21/30. Took 0.038833 seconds. 
  Full-batch training loss = 1.681411, test loss = 1.688562
  Training set accuracy = 0.699500, Test set accuracy = 0.682400
 epoch 22/30. Took 0.042678 seconds. 
  Full-batch training loss = 1.649606, test loss = 1.657300
  Training set accuracy = 0.707500, Test set accuracy = 0.689900
 epoch 23/30. Took 0.036996 seconds. 
  Full-batch training loss = 1.617800, test loss = 1.626009
  Training set accuracy = 0.712500, Test set accuracy = 0.696200
 epoch 24/30. Took 0.038431 seconds. 
  Full-batch training loss = 1.586372, test loss = 1.595097
  Training set accuracy = 0.724500, Test set accuracy = 0.704000
 epoch 25/30. Took 0.037637 seconds. 
  Full-batch training loss = 1.555260, test loss = 1.564546
  Training set accuracy = 0.727000, Test set accuracy = 0.710300
 epoch 26/30. Took 0.037522 seconds. 
  Full-batch training loss = 1.524540, test loss = 1.534183
  Training set accuracy = 0.733500, Test set accuracy = 0.716700
 epoch 27/30. Took 0.038402 seconds. 
  Full-batch training loss = 1.494242, test loss = 1.504552
  Training set accuracy = 0.743500, Test set accuracy = 0.720600
 epoch 28/30. Took 0.038046 seconds. 
  Full-batch training loss = 1.464747, test loss = 1.475560
  Training set accuracy = 0.747500, Test set accuracy = 0.726500
 epoch 29/30. Took 0.038078 seconds. 
  Full-batch training loss = 1.435355, test loss = 1.446498
  Training set accuracy = 0.753000, Test set accuracy = 0.731200
 epoch 30/30. Took 0.03846 seconds. 
  Full-batch training loss = 1.406785, test loss = 1.418404
  Training set accuracy = 0.761000, Test set accuracy = 0.739100
Elapsed time is 5.045945 seconds.
End Training
-----
Params 2000 0.001 0.20 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.067784 seconds. 
  Full-batch training loss = 2.275957, test loss = 2.270197
  Training set accuracy = 0.124000, Test set accuracy = 0.135600
 epoch 2/30. Took 0.06188 seconds. 
  Full-batch training loss = 2.239543, test loss = 2.235729
  Training set accuracy = 0.170000, Test set accuracy = 0.179400
 epoch 3/30. Took 0.062555 seconds. 
  Full-batch training loss = 2.204860, test loss = 2.202651
  Training set accuracy = 0.232000, Test set accuracy = 0.234500
 epoch 4/30. Took 0.063697 seconds. 
  Full-batch training loss = 2.171937, test loss = 2.171147
  Training set accuracy = 0.298500, Test set accuracy = 0.301400
 epoch 5/30. Took 0.063003 seconds. 
  Full-batch training loss = 2.139484, test loss = 2.140125
  Training set accuracy = 0.369000, Test set accuracy = 0.359100
 epoch 6/30. Took 0.063942 seconds. 
  Full-batch training loss = 2.107413, test loss = 2.109295
  Training set accuracy = 0.430000, Test set accuracy = 0.409100
 epoch 7/30. Took 0.062707 seconds. 
  Full-batch training loss = 2.075050, test loss = 2.078042
  Training set accuracy = 0.472500, Test set accuracy = 0.455600
 epoch 8/30. Took 0.06358 seconds. 
  Full-batch training loss = 2.042390, test loss = 2.046507
  Training set accuracy = 0.516000, Test set accuracy = 0.495700
 epoch 9/30. Took 0.062404 seconds. 
  Full-batch training loss = 2.009598, test loss = 2.014739
  Training set accuracy = 0.555000, Test set accuracy = 0.529900
 epoch 10/30. Took 0.063595 seconds. 
  Full-batch training loss = 1.975897, test loss = 1.982062
  Training set accuracy = 0.585000, Test set accuracy = 0.561000
 epoch 11/30. Took 0.062102 seconds. 
  Full-batch training loss = 1.941863, test loss = 1.949027
  Training set accuracy = 0.618000, Test set accuracy = 0.590900
 epoch 12/30. Took 0.063648 seconds. 
  Full-batch training loss = 1.907578, test loss = 1.915741
  Training set accuracy = 0.648500, Test set accuracy = 0.617800
 epoch 13/30. Took 0.06323 seconds. 
  Full-batch training loss = 1.872689, test loss = 1.881794
  Training set accuracy = 0.666500, Test set accuracy = 0.641700
 epoch 14/30. Took 0.064415 seconds. 
  Full-batch training loss = 1.837096, test loss = 1.847108
  Training set accuracy = 0.677000, Test set accuracy = 0.653500
 epoch 15/30. Took 0.063277 seconds. 
  Full-batch training loss = 1.801227, test loss = 1.812070
  Training set accuracy = 0.689500, Test set accuracy = 0.665200
 epoch 16/30. Took 0.063143 seconds. 
  Full-batch training loss = 1.764848, test loss = 1.776710
  Training set accuracy = 0.700500, Test set accuracy = 0.676200
 epoch 17/30. Took 0.065605 seconds. 
  Full-batch training loss = 1.728638, test loss = 1.741333
  Training set accuracy = 0.707000, Test set accuracy = 0.685400
 epoch 18/30. Took 0.061101 seconds. 
  Full-batch training loss = 1.692724, test loss = 1.706190
  Training set accuracy = 0.711500, Test set accuracy = 0.692900
 epoch 19/30. Took 0.061361 seconds. 
  Full-batch training loss = 1.656742, test loss = 1.670898
  Training set accuracy = 0.717500, Test set accuracy = 0.701500
 epoch 20/30. Took 0.064782 seconds. 
  Full-batch training loss = 1.620738, test loss = 1.635449
  Training set accuracy = 0.722500, Test set accuracy = 0.708700
 epoch 21/30. Took 0.060972 seconds. 
  Full-batch training loss = 1.585052, test loss = 1.600706
  Training set accuracy = 0.731000, Test set accuracy = 0.712900
 epoch 22/30. Took 0.061905 seconds. 
  Full-batch training loss = 1.549947, test loss = 1.566196
  Training set accuracy = 0.739000, Test set accuracy = 0.721200
 epoch 23/30. Took 0.061642 seconds. 
  Full-batch training loss = 1.515542, test loss = 1.532423
  Training set accuracy = 0.745500, Test set accuracy = 0.726600
 epoch 24/30. Took 0.064172 seconds. 
  Full-batch training loss = 1.481237, test loss = 1.498882
  Training set accuracy = 0.752500, Test set accuracy = 0.732800
 epoch 25/30. Took 0.06425 seconds. 
  Full-batch training loss = 1.448034, test loss = 1.466546
  Training set accuracy = 0.758500, Test set accuracy = 0.736800
 epoch 26/30. Took 0.064841 seconds. 
  Full-batch training loss = 1.415288, test loss = 1.434142
  Training set accuracy = 0.764500, Test set accuracy = 0.742300
 epoch 27/30. Took 0.061222 seconds. 
  Full-batch training loss = 1.383442, test loss = 1.402896
  Training set accuracy = 0.770500, Test set accuracy = 0.748400
 epoch 28/30. Took 0.061568 seconds. 
  Full-batch training loss = 1.352542, test loss = 1.372515
  Training set accuracy = 0.778500, Test set accuracy = 0.754800
 epoch 29/30. Took 0.063159 seconds. 
  Full-batch training loss = 1.322447, test loss = 1.343083
  Training set accuracy = 0.782500, Test set accuracy = 0.757500
 epoch 30/30. Took 0.061084 seconds. 
  Full-batch training loss = 1.293312, test loss = 1.314207
  Training set accuracy = 0.783500, Test set accuracy = 0.761200
Elapsed time is 7.286819 seconds.
End Training
-----
Params 2000 0.001 0.20 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.13951 seconds. 
  Full-batch training loss = 2.259682, test loss = 2.259552
  Training set accuracy = 0.128000, Test set accuracy = 0.132900
 epoch 2/30. Took 0.13492 seconds. 
  Full-batch training loss = 2.211427, test loss = 2.211294
  Training set accuracy = 0.213000, Test set accuracy = 0.211100
 epoch 3/30. Took 0.133 seconds. 
  Full-batch training loss = 2.164987, test loss = 2.165065
  Training set accuracy = 0.317500, Test set accuracy = 0.313900
 epoch 4/30. Took 0.13571 seconds. 
  Full-batch training loss = 2.120628, test loss = 2.120684
  Training set accuracy = 0.409000, Test set accuracy = 0.406500
 epoch 5/30. Took 0.13543 seconds. 
  Full-batch training loss = 2.077545, test loss = 2.077314
  Training set accuracy = 0.488500, Test set accuracy = 0.487600
 epoch 6/30. Took 0.15061 seconds. 
  Full-batch training loss = 2.035510, test loss = 2.035264
  Training set accuracy = 0.548500, Test set accuracy = 0.539700
 epoch 7/30. Took 0.13608 seconds. 
  Full-batch training loss = 1.994087, test loss = 1.993776
  Training set accuracy = 0.584500, Test set accuracy = 0.578900
 epoch 8/30. Took 0.13469 seconds. 
  Full-batch training loss = 1.952828, test loss = 1.952413
  Training set accuracy = 0.616000, Test set accuracy = 0.609600
 epoch 9/30. Took 0.13562 seconds. 
  Full-batch training loss = 1.912084, test loss = 1.911404
  Training set accuracy = 0.646500, Test set accuracy = 0.638600
 epoch 10/30. Took 0.13544 seconds. 
  Full-batch training loss = 1.871769, test loss = 1.870854
  Training set accuracy = 0.669000, Test set accuracy = 0.660100
 epoch 11/30. Took 0.13615 seconds. 
  Full-batch training loss = 1.831768, test loss = 1.830764
  Training set accuracy = 0.684000, Test set accuracy = 0.674600
 epoch 12/30. Took 0.13598 seconds. 
  Full-batch training loss = 1.792141, test loss = 1.791014
  Training set accuracy = 0.697000, Test set accuracy = 0.689400
 epoch 13/30. Took 0.13559 seconds. 
  Full-batch training loss = 1.752727, test loss = 1.751364
  Training set accuracy = 0.708000, Test set accuracy = 0.705000
 epoch 14/30. Took 0.13722 seconds. 
  Full-batch training loss = 1.713747, test loss = 1.712178
  Training set accuracy = 0.718500, Test set accuracy = 0.715800
 epoch 15/30. Took 0.13539 seconds. 
  Full-batch training loss = 1.675146, test loss = 1.673459
  Training set accuracy = 0.725000, Test set accuracy = 0.723400
 epoch 16/30. Took 0.13515 seconds. 
  Full-batch training loss = 1.636929, test loss = 1.635296
  Training set accuracy = 0.731000, Test set accuracy = 0.731100
 epoch 17/30. Took 0.1458 seconds. 
  Full-batch training loss = 1.599340, test loss = 1.597655
  Training set accuracy = 0.743000, Test set accuracy = 0.737000
 epoch 18/30. Took 0.13538 seconds. 
  Full-batch training loss = 1.562240, test loss = 1.560337
  Training set accuracy = 0.752500, Test set accuracy = 0.745500
 epoch 19/30. Took 0.14083 seconds. 
  Full-batch training loss = 1.525960, test loss = 1.524179
  Training set accuracy = 0.761000, Test set accuracy = 0.749100
 epoch 20/30. Took 0.14467 seconds. 
  Full-batch training loss = 1.490294, test loss = 1.488209
  Training set accuracy = 0.767000, Test set accuracy = 0.755400
 epoch 21/30. Took 0.13531 seconds. 
  Full-batch training loss = 1.455536, test loss = 1.453411
  Training set accuracy = 0.770000, Test set accuracy = 0.760000
 epoch 22/30. Took 0.1353 seconds. 
  Full-batch training loss = 1.421765, test loss = 1.419798
  Training set accuracy = 0.772500, Test set accuracy = 0.764300
 epoch 23/30. Took 0.13597 seconds. 
  Full-batch training loss = 1.388783, test loss = 1.386871
  Training set accuracy = 0.773500, Test set accuracy = 0.767500
 epoch 24/30. Took 0.13557 seconds. 
  Full-batch training loss = 1.356728, test loss = 1.354958
  Training set accuracy = 0.780000, Test set accuracy = 0.773900
 epoch 25/30. Took 0.13557 seconds. 
  Full-batch training loss = 1.325778, test loss = 1.324095
  Training set accuracy = 0.785000, Test set accuracy = 0.777700
 epoch 26/30. Took 0.13488 seconds. 
  Full-batch training loss = 1.295607, test loss = 1.294030
  Training set accuracy = 0.790000, Test set accuracy = 0.782900
 epoch 27/30. Took 0.1414 seconds. 
  Full-batch training loss = 1.266498, test loss = 1.265191
  Training set accuracy = 0.788500, Test set accuracy = 0.784200
 epoch 28/30. Took 0.13271 seconds. 
  Full-batch training loss = 1.238420, test loss = 1.237241
  Training set accuracy = 0.793500, Test set accuracy = 0.789000
 epoch 29/30. Took 0.1374 seconds. 
  Full-batch training loss = 1.211317, test loss = 1.210378
  Training set accuracy = 0.796000, Test set accuracy = 0.791900
 epoch 30/30. Took 0.13642 seconds. 
  Full-batch training loss = 1.185260, test loss = 1.184599
  Training set accuracy = 0.801000, Test set accuracy = 0.795200
Elapsed time is 14.407458 seconds.
End Training
-----
Params 2000 0.001 0.20 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.049928 seconds. 
  Full-batch training loss = 2.310415, test loss = 2.312429
  Training set accuracy = 0.135000, Test set accuracy = 0.137300
 epoch 2/30. Took 0.047807 seconds. 
  Full-batch training loss = 2.298646, test loss = 2.301146
  Training set accuracy = 0.166000, Test set accuracy = 0.162600
 epoch 3/30. Took 0.048222 seconds. 
  Full-batch training loss = 2.287357, test loss = 2.290402
  Training set accuracy = 0.188500, Test set accuracy = 0.189900
 epoch 4/30. Took 0.048565 seconds. 
  Full-batch training loss = 2.276236, test loss = 2.279734
  Training set accuracy = 0.213000, Test set accuracy = 0.214600
 epoch 5/30. Took 0.04952 seconds. 
  Full-batch training loss = 2.265457, test loss = 2.269393
  Training set accuracy = 0.233000, Test set accuracy = 0.234400
 epoch 6/30. Took 0.050001 seconds. 
  Full-batch training loss = 2.254654, test loss = 2.258962
  Training set accuracy = 0.254000, Test set accuracy = 0.251200
 epoch 7/30. Took 0.049588 seconds. 
  Full-batch training loss = 2.243780, test loss = 2.248474
  Training set accuracy = 0.270500, Test set accuracy = 0.267200
 epoch 8/30. Took 0.049471 seconds. 
  Full-batch training loss = 2.233000, test loss = 2.238047
  Training set accuracy = 0.287000, Test set accuracy = 0.285600
 epoch 9/30. Took 0.049434 seconds. 
  Full-batch training loss = 2.222150, test loss = 2.227430
  Training set accuracy = 0.309500, Test set accuracy = 0.301700
 epoch 10/30. Took 0.049071 seconds. 
  Full-batch training loss = 2.211191, test loss = 2.216703
  Training set accuracy = 0.326500, Test set accuracy = 0.315200
 epoch 11/30. Took 0.049341 seconds. 
  Full-batch training loss = 2.200032, test loss = 2.205706
  Training set accuracy = 0.341000, Test set accuracy = 0.332300
 epoch 12/30. Took 0.049661 seconds. 
  Full-batch training loss = 2.188685, test loss = 2.194606
  Training set accuracy = 0.359500, Test set accuracy = 0.346600
 epoch 13/30. Took 0.048234 seconds. 
  Full-batch training loss = 2.177057, test loss = 2.183207
  Training set accuracy = 0.377500, Test set accuracy = 0.359500
 epoch 14/30. Took 0.047181 seconds. 
  Full-batch training loss = 2.164600, test loss = 2.170911
  Training set accuracy = 0.391500, Test set accuracy = 0.373200
 epoch 15/30. Took 0.046296 seconds. 
  Full-batch training loss = 2.151857, test loss = 2.158317
  Training set accuracy = 0.404500, Test set accuracy = 0.388800
 epoch 16/30. Took 0.046372 seconds. 
  Full-batch training loss = 2.138746, test loss = 2.145308
  Training set accuracy = 0.418000, Test set accuracy = 0.406000
 epoch 17/30. Took 0.046119 seconds. 
  Full-batch training loss = 2.124808, test loss = 2.131405
  Training set accuracy = 0.437500, Test set accuracy = 0.424100
 epoch 18/30. Took 0.046551 seconds. 
  Full-batch training loss = 2.110568, test loss = 2.117257
  Training set accuracy = 0.454000, Test set accuracy = 0.442400
 epoch 19/30. Took 0.049776 seconds. 
  Full-batch training loss = 2.095589, test loss = 2.102359
  Training set accuracy = 0.468000, Test set accuracy = 0.454900
 epoch 20/30. Took 0.046423 seconds. 
  Full-batch training loss = 2.079929, test loss = 2.086675
  Training set accuracy = 0.481500, Test set accuracy = 0.473100
 epoch 21/30. Took 0.046978 seconds. 
  Full-batch training loss = 2.063484, test loss = 2.070229
  Training set accuracy = 0.498500, Test set accuracy = 0.491400
 epoch 22/30. Took 0.047039 seconds. 
  Full-batch training loss = 2.046222, test loss = 2.052989
  Training set accuracy = 0.512500, Test set accuracy = 0.502000
 epoch 23/30. Took 0.0464 seconds. 
  Full-batch training loss = 2.028192, test loss = 2.034954
  Training set accuracy = 0.526000, Test set accuracy = 0.513800
 epoch 24/30. Took 0.045958 seconds. 
  Full-batch training loss = 2.009394, test loss = 2.016087
  Training set accuracy = 0.541500, Test set accuracy = 0.528500
 epoch 25/30. Took 0.049947 seconds. 
  Full-batch training loss = 1.989894, test loss = 1.996550
  Training set accuracy = 0.549500, Test set accuracy = 0.540700
 epoch 26/30. Took 0.04954 seconds. 
  Full-batch training loss = 1.969838, test loss = 1.976530
  Training set accuracy = 0.563000, Test set accuracy = 0.553300
 epoch 27/30. Took 0.049388 seconds. 
  Full-batch training loss = 1.948670, test loss = 1.955318
  Training set accuracy = 0.576000, Test set accuracy = 0.564000
 epoch 28/30. Took 0.049238 seconds. 
  Full-batch training loss = 1.926778, test loss = 1.933366
  Training set accuracy = 0.586500, Test set accuracy = 0.579200
 epoch 29/30. Took 0.049174 seconds. 
  Full-batch training loss = 1.904358, test loss = 1.910776
  Training set accuracy = 0.597000, Test set accuracy = 0.589600
 epoch 30/30. Took 0.049508 seconds. 
  Full-batch training loss = 1.881656, test loss = 1.887892
  Training set accuracy = 0.611500, Test set accuracy = 0.604100
Elapsed time is 5.543463 seconds.
End Training
-----
Params 2000 0.001 0.20 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.090153 seconds. 
  Full-batch training loss = 2.289090, test loss = 2.292572
  Training set accuracy = 0.101000, Test set accuracy = 0.100100
 epoch 2/30. Took 0.09933 seconds. 
  Full-batch training loss = 2.277314, test loss = 2.280635
  Training set accuracy = 0.106500, Test set accuracy = 0.103100
 epoch 3/30. Took 0.086312 seconds. 
  Full-batch training loss = 2.265340, test loss = 2.268447
  Training set accuracy = 0.122500, Test set accuracy = 0.114200
 epoch 4/30. Took 0.086876 seconds. 
  Full-batch training loss = 2.253634, test loss = 2.256614
  Training set accuracy = 0.141000, Test set accuracy = 0.133600
 epoch 5/30. Took 0.086761 seconds. 
  Full-batch training loss = 2.241851, test loss = 2.244723
  Training set accuracy = 0.169500, Test set accuracy = 0.156600
 epoch 6/30. Took 0.086807 seconds. 
  Full-batch training loss = 2.229750, test loss = 2.232523
  Training set accuracy = 0.200500, Test set accuracy = 0.189300
 epoch 7/30. Took 0.086851 seconds. 
  Full-batch training loss = 2.217534, test loss = 2.220171
  Training set accuracy = 0.235000, Test set accuracy = 0.224000
 epoch 8/30. Took 0.08643 seconds. 
  Full-batch training loss = 2.204943, test loss = 2.207358
  Training set accuracy = 0.268000, Test set accuracy = 0.252900
 epoch 9/30. Took 0.08661 seconds. 
  Full-batch training loss = 2.192330, test loss = 2.194634
  Training set accuracy = 0.301500, Test set accuracy = 0.289700
 epoch 10/30. Took 0.086133 seconds. 
  Full-batch training loss = 2.179085, test loss = 2.181242
  Training set accuracy = 0.329500, Test set accuracy = 0.320900
 epoch 11/30. Took 0.087195 seconds. 
  Full-batch training loss = 2.165585, test loss = 2.167563
  Training set accuracy = 0.348000, Test set accuracy = 0.345700
 epoch 12/30. Took 0.096067 seconds. 
  Full-batch training loss = 2.151580, test loss = 2.153446
  Training set accuracy = 0.369000, Test set accuracy = 0.369400
 epoch 13/30. Took 0.095199 seconds. 
  Full-batch training loss = 2.136855, test loss = 2.138615
  Training set accuracy = 0.390000, Test set accuracy = 0.385000
 epoch 14/30. Took 0.087673 seconds. 
  Full-batch training loss = 2.121752, test loss = 2.123470
  Training set accuracy = 0.408500, Test set accuracy = 0.398400
 epoch 15/30. Took 0.08553 seconds. 
  Full-batch training loss = 2.106085, test loss = 2.107728
  Training set accuracy = 0.419500, Test set accuracy = 0.410300
 epoch 16/30. Took 0.087203 seconds. 
  Full-batch training loss = 2.089591, test loss = 2.091139
  Training set accuracy = 0.432500, Test set accuracy = 0.424900
 epoch 17/30. Took 0.087529 seconds. 
  Full-batch training loss = 2.072699, test loss = 2.074188
  Training set accuracy = 0.447000, Test set accuracy = 0.444200
 epoch 18/30. Took 0.087654 seconds. 
  Full-batch training loss = 2.055127, test loss = 2.056528
  Training set accuracy = 0.467000, Test set accuracy = 0.467200
 epoch 19/30. Took 0.087033 seconds. 
  Full-batch training loss = 2.036817, test loss = 2.038050
  Training set accuracy = 0.498000, Test set accuracy = 0.495400
 epoch 20/30. Took 0.0876 seconds. 
  Full-batch training loss = 2.017841, test loss = 2.018876
  Training set accuracy = 0.530000, Test set accuracy = 0.529200
 epoch 21/30. Took 0.08696 seconds. 
  Full-batch training loss = 1.998191, test loss = 1.999115
  Training set accuracy = 0.551000, Test set accuracy = 0.550000
 epoch 22/30. Took 0.10309 seconds. 
  Full-batch training loss = 1.977717, test loss = 1.978528
  Training set accuracy = 0.574000, Test set accuracy = 0.571400
 epoch 23/30. Took 0.083227 seconds. 
  Full-batch training loss = 1.956577, test loss = 1.957134
  Training set accuracy = 0.586500, Test set accuracy = 0.586000
 epoch 24/30. Took 0.084404 seconds. 
  Full-batch training loss = 1.934874, test loss = 1.935223
  Training set accuracy = 0.596500, Test set accuracy = 0.600500
 epoch 25/30. Took 0.085045 seconds. 
  Full-batch training loss = 1.912207, test loss = 1.912395
  Training set accuracy = 0.607000, Test set accuracy = 0.610300
 epoch 26/30. Took 0.085922 seconds. 
  Full-batch training loss = 1.889055, test loss = 1.888973
  Training set accuracy = 0.620000, Test set accuracy = 0.620700
 epoch 27/30. Took 0.085649 seconds. 
  Full-batch training loss = 1.865106, test loss = 1.864835
  Training set accuracy = 0.628000, Test set accuracy = 0.630500
 epoch 28/30. Took 0.083036 seconds. 
  Full-batch training loss = 1.840870, test loss = 1.840282
  Training set accuracy = 0.638500, Test set accuracy = 0.642700
 epoch 29/30. Took 0.082924 seconds. 
  Full-batch training loss = 1.815542, test loss = 1.814679
  Training set accuracy = 0.650000, Test set accuracy = 0.652700
 epoch 30/30. Took 0.08244 seconds. 
  Full-batch training loss = 1.789597, test loss = 1.788464
  Training set accuracy = 0.657500, Test set accuracy = 0.661200
Elapsed time is 9.354683 seconds.
End Training
-----
Params 2000 0.001 0.20 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23412 seconds. 
  Full-batch training loss = 2.300743, test loss = 2.297989
  Training set accuracy = 0.144500, Test set accuracy = 0.145900
 epoch 2/30. Took 0.23303 seconds. 
  Full-batch training loss = 2.283217, test loss = 2.281343
  Training set accuracy = 0.168000, Test set accuracy = 0.166100
 epoch 3/30. Took 0.22787 seconds. 
  Full-batch training loss = 2.266451, test loss = 2.265277
  Training set accuracy = 0.193000, Test set accuracy = 0.194300
 epoch 4/30. Took 0.23042 seconds. 
  Full-batch training loss = 2.250025, test loss = 2.249467
  Training set accuracy = 0.225000, Test set accuracy = 0.225200
 epoch 5/30. Took 0.23038 seconds. 
  Full-batch training loss = 2.233724, test loss = 2.233767
  Training set accuracy = 0.254500, Test set accuracy = 0.246700
 epoch 6/30. Took 0.24918 seconds. 
  Full-batch training loss = 2.217607, test loss = 2.218098
  Training set accuracy = 0.273000, Test set accuracy = 0.265000
 epoch 7/30. Took 0.22538 seconds. 
  Full-batch training loss = 2.201528, test loss = 2.202436
  Training set accuracy = 0.295000, Test set accuracy = 0.282100
 epoch 8/30. Took 0.22575 seconds. 
  Full-batch training loss = 2.185156, test loss = 2.186583
  Training set accuracy = 0.327500, Test set accuracy = 0.309600
 epoch 9/30. Took 0.26584 seconds. 
  Full-batch training loss = 2.168733, test loss = 2.170507
  Training set accuracy = 0.345500, Test set accuracy = 0.336200
 epoch 10/30. Took 0.24386 seconds. 
  Full-batch training loss = 2.151971, test loss = 2.154014
  Training set accuracy = 0.395000, Test set accuracy = 0.377200
 epoch 11/30. Took 0.22556 seconds. 
  Full-batch training loss = 2.134884, test loss = 2.137231
  Training set accuracy = 0.432500, Test set accuracy = 0.414700
 epoch 12/30. Took 0.23033 seconds. 
  Full-batch training loss = 2.117130, test loss = 2.119734
  Training set accuracy = 0.462000, Test set accuracy = 0.451800
 epoch 13/30. Took 0.23042 seconds. 
  Full-batch training loss = 2.098685, test loss = 2.101573
  Training set accuracy = 0.496000, Test set accuracy = 0.480200
 epoch 14/30. Took 0.23131 seconds. 
  Full-batch training loss = 2.079786, test loss = 2.082842
  Training set accuracy = 0.524500, Test set accuracy = 0.502700
 epoch 15/30. Took 0.24062 seconds. 
  Full-batch training loss = 2.060266, test loss = 2.063492
  Training set accuracy = 0.541000, Test set accuracy = 0.520200
 epoch 16/30. Took 0.22976 seconds. 
  Full-batch training loss = 2.040015, test loss = 2.043401
  Training set accuracy = 0.556500, Test set accuracy = 0.534600
 epoch 17/30. Took 0.22902 seconds. 
  Full-batch training loss = 2.018927, test loss = 2.022512
  Training set accuracy = 0.568500, Test set accuracy = 0.545000
 epoch 18/30. Took 0.23164 seconds. 
  Full-batch training loss = 1.996886, test loss = 2.000562
  Training set accuracy = 0.580000, Test set accuracy = 0.556700
 epoch 19/30. Took 0.23007 seconds. 
  Full-batch training loss = 1.974215, test loss = 1.977921
  Training set accuracy = 0.591000, Test set accuracy = 0.571200
 epoch 20/30. Took 0.22735 seconds. 
  Full-batch training loss = 1.950668, test loss = 1.954623
  Training set accuracy = 0.592000, Test set accuracy = 0.578500
 epoch 21/30. Took 0.22681 seconds. 
  Full-batch training loss = 1.926245, test loss = 1.930180
  Training set accuracy = 0.606500, Test set accuracy = 0.593600
 epoch 22/30. Took 0.24643 seconds. 
  Full-batch training loss = 1.901145, test loss = 1.905008
  Training set accuracy = 0.617500, Test set accuracy = 0.605900
 epoch 23/30. Took 0.23056 seconds. 
  Full-batch training loss = 1.875101, test loss = 1.878996
  Training set accuracy = 0.629000, Test set accuracy = 0.620100
 epoch 24/30. Took 0.23034 seconds. 
  Full-batch training loss = 1.847912, test loss = 1.851778
  Training set accuracy = 0.630000, Test set accuracy = 0.625300
 epoch 25/30. Took 0.23054 seconds. 
  Full-batch training loss = 1.820265, test loss = 1.824256
  Training set accuracy = 0.642500, Test set accuracy = 0.633300
 epoch 26/30. Took 0.22801 seconds. 
  Full-batch training loss = 1.791669, test loss = 1.795644
  Training set accuracy = 0.648000, Test set accuracy = 0.642500
 epoch 27/30. Took 0.24535 seconds. 
  Full-batch training loss = 1.762326, test loss = 1.766201
  Training set accuracy = 0.657000, Test set accuracy = 0.650400
 epoch 28/30. Took 0.26288 seconds. 
  Full-batch training loss = 1.732488, test loss = 1.736355
  Training set accuracy = 0.668000, Test set accuracy = 0.659200
 epoch 29/30. Took 0.23569 seconds. 
  Full-batch training loss = 1.701729, test loss = 1.705498
  Training set accuracy = 0.678500, Test set accuracy = 0.666900
 epoch 30/30. Took 0.23063 seconds. 
  Full-batch training loss = 1.670857, test loss = 1.674556
  Training set accuracy = 0.685000, Test set accuracy = 0.675800
Elapsed time is 23.194905 seconds.
End Training
-----
Params 2000 0.001 0.20 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.065872 seconds. 
  Full-batch training loss = 2.296980, test loss = 2.302143
  Training set accuracy = 0.101000, Test set accuracy = 0.098600
 epoch 2/30. Took 0.059231 seconds. 
  Full-batch training loss = 2.293033, test loss = 2.298367
  Training set accuracy = 0.101000, Test set accuracy = 0.099000
 epoch 3/30. Took 0.059528 seconds. 
  Full-batch training loss = 2.289209, test loss = 2.294644
  Training set accuracy = 0.101000, Test set accuracy = 0.099200
 epoch 4/30. Took 0.059657 seconds. 
  Full-batch training loss = 2.285325, test loss = 2.290914
  Training set accuracy = 0.101000, Test set accuracy = 0.099600
 epoch 5/30. Took 0.060127 seconds. 
  Full-batch training loss = 2.281377, test loss = 2.287089
  Training set accuracy = 0.103500, Test set accuracy = 0.100400
 epoch 6/30. Took 0.054984 seconds. 
  Full-batch training loss = 2.277320, test loss = 2.283255
  Training set accuracy = 0.105500, Test set accuracy = 0.104400
 epoch 7/30. Took 0.060252 seconds. 
  Full-batch training loss = 2.273048, test loss = 2.279187
  Training set accuracy = 0.115500, Test set accuracy = 0.113500
 epoch 8/30. Took 0.059874 seconds. 
  Full-batch training loss = 2.268825, test loss = 2.275120
  Training set accuracy = 0.131000, Test set accuracy = 0.128100
 epoch 9/30. Took 0.060587 seconds. 
  Full-batch training loss = 2.264401, test loss = 2.270886
  Training set accuracy = 0.155500, Test set accuracy = 0.145600
 epoch 10/30. Took 0.059517 seconds. 
  Full-batch training loss = 2.259883, test loss = 2.266587
  Training set accuracy = 0.183000, Test set accuracy = 0.172200
 epoch 11/30. Took 0.060149 seconds. 
  Full-batch training loss = 2.255101, test loss = 2.262018
  Training set accuracy = 0.212500, Test set accuracy = 0.197500
 epoch 12/30. Took 0.058819 seconds. 
  Full-batch training loss = 2.249933, test loss = 2.257097
  Training set accuracy = 0.237000, Test set accuracy = 0.221300
 epoch 13/30. Took 0.059349 seconds. 
  Full-batch training loss = 2.245035, test loss = 2.252397
  Training set accuracy = 0.254000, Test set accuracy = 0.237800
 epoch 14/30. Took 0.05942 seconds. 
  Full-batch training loss = 2.239556, test loss = 2.247220
  Training set accuracy = 0.270500, Test set accuracy = 0.253800
 epoch 15/30. Took 0.056398 seconds. 
  Full-batch training loss = 2.234284, test loss = 2.242196
  Training set accuracy = 0.282000, Test set accuracy = 0.262200
 epoch 16/30. Took 0.059579 seconds. 
  Full-batch training loss = 2.228582, test loss = 2.236835
  Training set accuracy = 0.287000, Test set accuracy = 0.270500
 epoch 17/30. Took 0.060058 seconds. 
  Full-batch training loss = 2.222552, test loss = 2.231165
  Training set accuracy = 0.300000, Test set accuracy = 0.276600
 epoch 18/30. Took 0.059847 seconds. 
  Full-batch training loss = 2.216533, test loss = 2.225480
  Training set accuracy = 0.302500, Test set accuracy = 0.278900
 epoch 19/30. Took 0.059479 seconds. 
  Full-batch training loss = 2.210182, test loss = 2.219490
  Training set accuracy = 0.309000, Test set accuracy = 0.281100
 epoch 20/30. Took 0.06012 seconds. 
  Full-batch training loss = 2.203652, test loss = 2.213372
  Training set accuracy = 0.307500, Test set accuracy = 0.282500
 epoch 21/30. Took 0.059037 seconds. 
  Full-batch training loss = 2.196628, test loss = 2.206818
  Training set accuracy = 0.312000, Test set accuracy = 0.282600
 epoch 22/30. Took 0.062981 seconds. 
  Full-batch training loss = 2.189690, test loss = 2.200279
  Training set accuracy = 0.313500, Test set accuracy = 0.282400
 epoch 23/30. Took 0.061525 seconds. 
  Full-batch training loss = 2.182373, test loss = 2.193346
  Training set accuracy = 0.315500, Test set accuracy = 0.283000
 epoch 24/30. Took 0.058075 seconds. 
  Full-batch training loss = 2.174833, test loss = 2.186211
  Training set accuracy = 0.318000, Test set accuracy = 0.283200
 epoch 25/30. Took 0.059698 seconds. 
  Full-batch training loss = 2.166900, test loss = 2.178791
  Training set accuracy = 0.318000, Test set accuracy = 0.282300
 epoch 26/30. Took 0.058949 seconds. 
  Full-batch training loss = 2.158652, test loss = 2.171066
  Training set accuracy = 0.320500, Test set accuracy = 0.283600
 epoch 27/30. Took 0.059465 seconds. 
  Full-batch training loss = 2.150163, test loss = 2.163116
  Training set accuracy = 0.321000, Test set accuracy = 0.285800
 epoch 28/30. Took 0.059568 seconds. 
  Full-batch training loss = 2.141301, test loss = 2.154778
  Training set accuracy = 0.318000, Test set accuracy = 0.289900
 epoch 29/30. Took 0.056479 seconds. 
  Full-batch training loss = 2.132303, test loss = 2.146350
  Training set accuracy = 0.323500, Test set accuracy = 0.295000
 epoch 30/30. Took 0.055584 seconds. 
  Full-batch training loss = 2.122883, test loss = 2.137431
  Training set accuracy = 0.336000, Test set accuracy = 0.304500
Elapsed time is 6.642108 seconds.
End Training
-----
Params 2000 0.001 0.20 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.10465 seconds. 
  Full-batch training loss = 2.299850, test loss = 2.304978
  Training set accuracy = 0.104000, Test set accuracy = 0.100900
 epoch 2/30. Took 0.11481 seconds. 
  Full-batch training loss = 2.295640, test loss = 2.301130
  Training set accuracy = 0.104500, Test set accuracy = 0.101000
 epoch 3/30. Took 0.10115 seconds. 
  Full-batch training loss = 2.291566, test loss = 2.297327
  Training set accuracy = 0.105000, Test set accuracy = 0.102600
 epoch 4/30. Took 0.10358 seconds. 
  Full-batch training loss = 2.287474, test loss = 2.293553
  Training set accuracy = 0.106500, Test set accuracy = 0.105600
 epoch 5/30. Took 0.10834 seconds. 
  Full-batch training loss = 2.283380, test loss = 2.289803
  Training set accuracy = 0.110000, Test set accuracy = 0.112400
 epoch 6/30. Took 0.10329 seconds. 
  Full-batch training loss = 2.279339, test loss = 2.286049
  Training set accuracy = 0.119000, Test set accuracy = 0.119700
 epoch 7/30. Took 0.10849 seconds. 
  Full-batch training loss = 2.275255, test loss = 2.282323
  Training set accuracy = 0.130500, Test set accuracy = 0.127900
 epoch 8/30. Took 0.10785 seconds. 
  Full-batch training loss = 2.271136, test loss = 2.278537
  Training set accuracy = 0.142000, Test set accuracy = 0.137700
 epoch 9/30. Took 0.1091 seconds. 
  Full-batch training loss = 2.266904, test loss = 2.274696
  Training set accuracy = 0.157500, Test set accuracy = 0.145500
 epoch 10/30. Took 0.10263 seconds. 
  Full-batch training loss = 2.262753, test loss = 2.270840
  Training set accuracy = 0.166000, Test set accuracy = 0.152400
 epoch 11/30. Took 0.10163 seconds. 
  Full-batch training loss = 2.258460, test loss = 2.266953
  Training set accuracy = 0.175500, Test set accuracy = 0.157400
 epoch 12/30. Took 0.10368 seconds. 
  Full-batch training loss = 2.254081, test loss = 2.262922
  Training set accuracy = 0.181000, Test set accuracy = 0.158400
 epoch 13/30. Took 0.10652 seconds. 
  Full-batch training loss = 2.249541, test loss = 2.258782
  Training set accuracy = 0.182000, Test set accuracy = 0.162100
 epoch 14/30. Took 0.10492 seconds. 
  Full-batch training loss = 2.244860, test loss = 2.254525
  Training set accuracy = 0.186000, Test set accuracy = 0.163000
 epoch 15/30. Took 0.10867 seconds. 
  Full-batch training loss = 2.240115, test loss = 2.250139
  Training set accuracy = 0.187000, Test set accuracy = 0.164400
 epoch 16/30. Took 0.10853 seconds. 
  Full-batch training loss = 2.235151, test loss = 2.245607
  Training set accuracy = 0.193000, Test set accuracy = 0.165500
 epoch 17/30. Took 0.10899 seconds. 
  Full-batch training loss = 2.230048, test loss = 2.240891
  Training set accuracy = 0.192000, Test set accuracy = 0.168200
 epoch 18/30. Took 0.10318 seconds. 
  Full-batch training loss = 2.224639, test loss = 2.235994
  Training set accuracy = 0.196500, Test set accuracy = 0.170100
 epoch 19/30. Took 0.10299 seconds. 
  Full-batch training loss = 2.219062, test loss = 2.230805
  Training set accuracy = 0.200000, Test set accuracy = 0.176800
 epoch 20/30. Took 0.10848 seconds. 
  Full-batch training loss = 2.213234, test loss = 2.225463
  Training set accuracy = 0.205500, Test set accuracy = 0.184700
 epoch 21/30. Took 0.10872 seconds. 
  Full-batch training loss = 2.207115, test loss = 2.219879
  Training set accuracy = 0.217000, Test set accuracy = 0.198500
 epoch 22/30. Took 0.10855 seconds. 
  Full-batch training loss = 2.200838, test loss = 2.214085
  Training set accuracy = 0.235000, Test set accuracy = 0.216400
 epoch 23/30. Took 0.10836 seconds. 
  Full-batch training loss = 2.194267, test loss = 2.208054
  Training set accuracy = 0.251500, Test set accuracy = 0.230300
 epoch 24/30. Took 0.1081 seconds. 
  Full-batch training loss = 2.187349, test loss = 2.201654
  Training set accuracy = 0.267000, Test set accuracy = 0.243000
 epoch 25/30. Took 0.10801 seconds. 
  Full-batch training loss = 2.180021, test loss = 2.194941
  Training set accuracy = 0.278000, Test set accuracy = 0.255300
 epoch 26/30. Took 0.10745 seconds. 
  Full-batch training loss = 2.172608, test loss = 2.187993
  Training set accuracy = 0.292500, Test set accuracy = 0.269900
 epoch 27/30. Took 0.11577 seconds. 
  Full-batch training loss = 2.164739, test loss = 2.180715
  Training set accuracy = 0.304000, Test set accuracy = 0.281200
 epoch 28/30. Took 0.10725 seconds. 
  Full-batch training loss = 2.156667, test loss = 2.173147
  Training set accuracy = 0.319000, Test set accuracy = 0.294300
 epoch 29/30. Took 0.10817 seconds. 
  Full-batch training loss = 2.147862, test loss = 2.165025
  Training set accuracy = 0.324000, Test set accuracy = 0.302700
 epoch 30/30. Took 0.10546 seconds. 
  Full-batch training loss = 2.138771, test loss = 2.156580
  Training set accuracy = 0.337000, Test set accuracy = 0.313400
Elapsed time is 11.251567 seconds.
End Training
-----
Params 2000 0.001 0.20 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32506 seconds. 
  Full-batch training loss = 2.301549, test loss = 2.299599
  Training set accuracy = 0.122000, Test set accuracy = 0.129600
 epoch 2/30. Took 0.35736 seconds. 
  Full-batch training loss = 2.296473, test loss = 2.294862
  Training set accuracy = 0.142000, Test set accuracy = 0.149600
 epoch 3/30. Took 0.32275 seconds. 
  Full-batch training loss = 2.291425, test loss = 2.290167
  Training set accuracy = 0.172000, Test set accuracy = 0.180500
 epoch 4/30. Took 0.32141 seconds. 
  Full-batch training loss = 2.286409, test loss = 2.285478
  Training set accuracy = 0.207000, Test set accuracy = 0.213800
 epoch 5/30. Took 0.32205 seconds. 
  Full-batch training loss = 2.281444, test loss = 2.280816
  Training set accuracy = 0.229500, Test set accuracy = 0.243500
 epoch 6/30. Took 0.31689 seconds. 
  Full-batch training loss = 2.276449, test loss = 2.276092
  Training set accuracy = 0.262500, Test set accuracy = 0.272300
 epoch 7/30. Took 0.32207 seconds. 
  Full-batch training loss = 2.271457, test loss = 2.271381
  Training set accuracy = 0.290000, Test set accuracy = 0.297400
 epoch 8/30. Took 0.3209 seconds. 
  Full-batch training loss = 2.266407, test loss = 2.266615
  Training set accuracy = 0.317500, Test set accuracy = 0.322800
 epoch 9/30. Took 0.36977 seconds. 
  Full-batch training loss = 2.261327, test loss = 2.261799
  Training set accuracy = 0.336000, Test set accuracy = 0.340600
 epoch 10/30. Took 0.3259 seconds. 
  Full-batch training loss = 2.256215, test loss = 2.256919
  Training set accuracy = 0.354000, Test set accuracy = 0.355600
 epoch 11/30. Took 0.32405 seconds. 
  Full-batch training loss = 2.250886, test loss = 2.251840
  Training set accuracy = 0.368500, Test set accuracy = 0.371300
 epoch 12/30. Took 0.32183 seconds. 
  Full-batch training loss = 2.245451, test loss = 2.246700
  Training set accuracy = 0.381500, Test set accuracy = 0.383700
 epoch 13/30. Took 0.34418 seconds. 
  Full-batch training loss = 2.239862, test loss = 2.241325
  Training set accuracy = 0.391500, Test set accuracy = 0.390500
 epoch 14/30. Took 0.32161 seconds. 
  Full-batch training loss = 2.234095, test loss = 2.235820
  Training set accuracy = 0.404000, Test set accuracy = 0.402800
 epoch 15/30. Took 0.3221 seconds. 
  Full-batch training loss = 2.228209, test loss = 2.230161
  Training set accuracy = 0.416000, Test set accuracy = 0.411500
 epoch 16/30. Took 0.32075 seconds. 
  Full-batch training loss = 2.222041, test loss = 2.224257
  Training set accuracy = 0.423000, Test set accuracy = 0.418900
 epoch 17/30. Took 0.32164 seconds. 
  Full-batch training loss = 2.215730, test loss = 2.218186
  Training set accuracy = 0.428500, Test set accuracy = 0.425700
 epoch 18/30. Took 0.34012 seconds. 
  Full-batch training loss = 2.209265, test loss = 2.211902
  Training set accuracy = 0.434000, Test set accuracy = 0.433400
 epoch 19/30. Took 0.32999 seconds. 
  Full-batch training loss = 2.202368, test loss = 2.205233
  Training set accuracy = 0.441500, Test set accuracy = 0.444400
 epoch 20/30. Took 0.3332 seconds. 
  Full-batch training loss = 2.195207, test loss = 2.198336
  Training set accuracy = 0.453500, Test set accuracy = 0.452000
 epoch 21/30. Took 0.33175 seconds. 
  Full-batch training loss = 2.187819, test loss = 2.191188
  Training set accuracy = 0.462000, Test set accuracy = 0.458300
 epoch 22/30. Took 0.31821 seconds. 
  Full-batch training loss = 2.179931, test loss = 2.183543
  Training set accuracy = 0.467000, Test set accuracy = 0.464100
 epoch 23/30. Took 0.3157 seconds. 
  Full-batch training loss = 2.171843, test loss = 2.175646
  Training set accuracy = 0.479000, Test set accuracy = 0.472800
 epoch 24/30. Took 0.31723 seconds. 
  Full-batch training loss = 2.163197, test loss = 2.167249
  Training set accuracy = 0.485500, Test set accuracy = 0.478200
 epoch 25/30. Took 0.32106 seconds. 
  Full-batch training loss = 2.154386, test loss = 2.158623
  Training set accuracy = 0.492000, Test set accuracy = 0.483900
 epoch 26/30. Took 0.32228 seconds. 
  Full-batch training loss = 2.145010, test loss = 2.149492
  Training set accuracy = 0.496500, Test set accuracy = 0.488900
 epoch 27/30. Took 0.33382 seconds. 
  Full-batch training loss = 2.135124, test loss = 2.139865
  Training set accuracy = 0.502000, Test set accuracy = 0.493300
 epoch 28/30. Took 0.32005 seconds. 
  Full-batch training loss = 2.124826, test loss = 2.129761
  Training set accuracy = 0.506000, Test set accuracy = 0.498200
 epoch 29/30. Took 0.31947 seconds. 
  Full-batch training loss = 2.114095, test loss = 2.119223
  Training set accuracy = 0.510000, Test set accuracy = 0.503100
 epoch 30/30. Took 0.33826 seconds. 
  Full-batch training loss = 2.102637, test loss = 2.108129
  Training set accuracy = 0.517500, Test set accuracy = 0.507300
Elapsed time is 31.870228 seconds.
End Training
-----
Params 2000 0.001 0.30 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.040298 seconds. 
  Full-batch training loss = 2.268895, test loss = 2.272144
  Training set accuracy = 0.154000, Test set accuracy = 0.142300
 epoch 2/30. Took 0.038263 seconds. 
  Full-batch training loss = 2.239914, test loss = 2.242636
  Training set accuracy = 0.202500, Test set accuracy = 0.183700
 epoch 3/30. Took 0.036133 seconds. 
  Full-batch training loss = 2.212101, test loss = 2.214495
  Training set accuracy = 0.268500, Test set accuracy = 0.251600
 epoch 4/30. Took 0.035445 seconds. 
  Full-batch training loss = 2.184889, test loss = 2.187145
  Training set accuracy = 0.354000, Test set accuracy = 0.325400
 epoch 5/30. Took 0.035456 seconds. 
  Full-batch training loss = 2.157785, test loss = 2.159707
  Training set accuracy = 0.417000, Test set accuracy = 0.390400
 epoch 6/30. Took 0.035803 seconds. 
  Full-batch training loss = 2.130700, test loss = 2.132569
  Training set accuracy = 0.464500, Test set accuracy = 0.441500
 epoch 7/30. Took 0.036128 seconds. 
  Full-batch training loss = 2.103613, test loss = 2.105351
  Training set accuracy = 0.502500, Test set accuracy = 0.487600
 epoch 8/30. Took 0.035314 seconds. 
  Full-batch training loss = 2.076517, test loss = 2.078205
  Training set accuracy = 0.537000, Test set accuracy = 0.525300
 epoch 9/30. Took 0.035388 seconds. 
  Full-batch training loss = 2.048697, test loss = 2.050447
  Training set accuracy = 0.557500, Test set accuracy = 0.553900
 epoch 10/30. Took 0.035478 seconds. 
  Full-batch training loss = 2.020967, test loss = 2.022770
  Training set accuracy = 0.585000, Test set accuracy = 0.576700
 epoch 11/30. Took 0.036159 seconds. 
  Full-batch training loss = 1.993086, test loss = 1.994833
  Training set accuracy = 0.606500, Test set accuracy = 0.591700
 epoch 12/30. Took 0.035825 seconds. 
  Full-batch training loss = 1.964774, test loss = 1.966628
  Training set accuracy = 0.628500, Test set accuracy = 0.607300
 epoch 13/30. Took 0.0398 seconds. 
  Full-batch training loss = 1.936191, test loss = 1.938114
  Training set accuracy = 0.641500, Test set accuracy = 0.621100
 epoch 14/30. Took 0.041049 seconds. 
  Full-batch training loss = 1.907484, test loss = 1.909675
  Training set accuracy = 0.652000, Test set accuracy = 0.630600
 epoch 15/30. Took 0.037467 seconds. 
  Full-batch training loss = 1.878821, test loss = 1.881084
  Training set accuracy = 0.658500, Test set accuracy = 0.640900
 epoch 16/30. Took 0.03554 seconds. 
  Full-batch training loss = 1.850725, test loss = 1.853283
  Training set accuracy = 0.664500, Test set accuracy = 0.647800
 epoch 17/30. Took 0.038283 seconds. 
  Full-batch training loss = 1.822281, test loss = 1.824884
  Training set accuracy = 0.673000, Test set accuracy = 0.657500
 epoch 18/30. Took 0.037687 seconds. 
  Full-batch training loss = 1.793839, test loss = 1.796363
  Training set accuracy = 0.677000, Test set accuracy = 0.663600
 epoch 19/30. Took 0.038034 seconds. 
  Full-batch training loss = 1.765677, test loss = 1.768320
  Training set accuracy = 0.682000, Test set accuracy = 0.670600
 epoch 20/30. Took 0.038075 seconds. 
  Full-batch training loss = 1.737802, test loss = 1.740289
  Training set accuracy = 0.687500, Test set accuracy = 0.679100
 epoch 21/30. Took 0.037625 seconds. 
  Full-batch training loss = 1.710154, test loss = 1.712416
  Training set accuracy = 0.694000, Test set accuracy = 0.683800
 epoch 22/30. Took 0.037535 seconds. 
  Full-batch training loss = 1.682999, test loss = 1.685315
  Training set accuracy = 0.704000, Test set accuracy = 0.692600
 epoch 23/30. Took 0.038344 seconds. 
  Full-batch training loss = 1.655783, test loss = 1.658007
  Training set accuracy = 0.710000, Test set accuracy = 0.699200
 epoch 24/30. Took 0.037703 seconds. 
  Full-batch training loss = 1.629074, test loss = 1.631311
  Training set accuracy = 0.716500, Test set accuracy = 0.706900
 epoch 25/30. Took 0.037181 seconds. 
  Full-batch training loss = 1.602442, test loss = 1.604587
  Training set accuracy = 0.722000, Test set accuracy = 0.712600
 epoch 26/30. Took 0.038454 seconds. 
  Full-batch training loss = 1.576045, test loss = 1.578074
  Training set accuracy = 0.726500, Test set accuracy = 0.718400
 epoch 27/30. Took 0.037522 seconds. 
  Full-batch training loss = 1.550098, test loss = 1.551887
  Training set accuracy = 0.731500, Test set accuracy = 0.723600
 epoch 28/30. Took 0.037194 seconds. 
  Full-batch training loss = 1.524651, test loss = 1.526459
  Training set accuracy = 0.742000, Test set accuracy = 0.729600
 epoch 29/30. Took 0.036112 seconds. 
  Full-batch training loss = 1.499605, test loss = 1.501052
  Training set accuracy = 0.748500, Test set accuracy = 0.737000
 epoch 30/30. Took 0.03806 seconds. 
  Full-batch training loss = 1.474771, test loss = 1.475979
  Training set accuracy = 0.753000, Test set accuracy = 0.741300
Elapsed time is 4.968525 seconds.
End Training
-----
Params 2000 0.001 0.30 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.066319 seconds. 
  Full-batch training loss = 2.306390, test loss = 2.299971
  Training set accuracy = 0.103500, Test set accuracy = 0.101000
 epoch 2/30. Took 0.059523 seconds. 
  Full-batch training loss = 2.273568, test loss = 2.268789
  Training set accuracy = 0.129500, Test set accuracy = 0.130500
 epoch 3/30. Took 0.062052 seconds. 
  Full-batch training loss = 2.242742, test loss = 2.239714
  Training set accuracy = 0.166000, Test set accuracy = 0.170600
 epoch 4/30. Took 0.062139 seconds. 
  Full-batch training loss = 2.213038, test loss = 2.211404
  Training set accuracy = 0.227000, Test set accuracy = 0.220100
 epoch 5/30. Took 0.06194 seconds. 
  Full-batch training loss = 2.184613, test loss = 2.184453
  Training set accuracy = 0.287500, Test set accuracy = 0.283500
 epoch 6/30. Took 0.062273 seconds. 
  Full-batch training loss = 2.156784, test loss = 2.157912
  Training set accuracy = 0.381000, Test set accuracy = 0.371300
 epoch 7/30. Took 0.062271 seconds. 
  Full-batch training loss = 2.129737, test loss = 2.132047
  Training set accuracy = 0.476500, Test set accuracy = 0.450400
 epoch 8/30. Took 0.06331 seconds. 
  Full-batch training loss = 2.102943, test loss = 2.106459
  Training set accuracy = 0.534000, Test set accuracy = 0.503400
 epoch 9/30. Took 0.061933 seconds. 
  Full-batch training loss = 2.075892, test loss = 2.080537
  Training set accuracy = 0.567000, Test set accuracy = 0.540200
 epoch 10/30. Took 0.062823 seconds. 
  Full-batch training loss = 2.049131, test loss = 2.054703
  Training set accuracy = 0.600500, Test set accuracy = 0.574500
 epoch 11/30. Took 0.062117 seconds. 
  Full-batch training loss = 2.021562, test loss = 2.028194
  Training set accuracy = 0.625000, Test set accuracy = 0.596400
 epoch 12/30. Took 0.069666 seconds. 
  Full-batch training loss = 1.994238, test loss = 2.001811
  Training set accuracy = 0.644000, Test set accuracy = 0.614100
 epoch 13/30. Took 0.062246 seconds. 
  Full-batch training loss = 1.966236, test loss = 1.974742
  Training set accuracy = 0.661500, Test set accuracy = 0.626400
 epoch 14/30. Took 0.063833 seconds. 
  Full-batch training loss = 1.937694, test loss = 1.947070
  Training set accuracy = 0.681500, Test set accuracy = 0.639700
 epoch 15/30. Took 0.063931 seconds. 
  Full-batch training loss = 1.908788, test loss = 1.919115
  Training set accuracy = 0.688000, Test set accuracy = 0.650900
 epoch 16/30. Took 0.064217 seconds. 
  Full-batch training loss = 1.879599, test loss = 1.890630
  Training set accuracy = 0.701500, Test set accuracy = 0.658400
 epoch 17/30. Took 0.062161 seconds. 
  Full-batch training loss = 1.850651, test loss = 1.862268
  Training set accuracy = 0.714000, Test set accuracy = 0.673400
 epoch 18/30. Took 0.062671 seconds. 
  Full-batch training loss = 1.821282, test loss = 1.833618
  Training set accuracy = 0.722500, Test set accuracy = 0.682700
 epoch 19/30. Took 0.062971 seconds. 
  Full-batch training loss = 1.791661, test loss = 1.804667
  Training set accuracy = 0.726500, Test set accuracy = 0.689100
 epoch 20/30. Took 0.062331 seconds. 
  Full-batch training loss = 1.761964, test loss = 1.775491
  Training set accuracy = 0.732000, Test set accuracy = 0.695400
 epoch 21/30. Took 0.063725 seconds. 
  Full-batch training loss = 1.731997, test loss = 1.746123
  Training set accuracy = 0.742000, Test set accuracy = 0.700900
 epoch 22/30. Took 0.062014 seconds. 
  Full-batch training loss = 1.702183, test loss = 1.716690
  Training set accuracy = 0.747000, Test set accuracy = 0.708200
 epoch 23/30. Took 0.063602 seconds. 
  Full-batch training loss = 1.672591, test loss = 1.687468
  Training set accuracy = 0.751000, Test set accuracy = 0.713500
 epoch 24/30. Took 0.062566 seconds. 
  Full-batch training loss = 1.643086, test loss = 1.658287
  Training set accuracy = 0.755000, Test set accuracy = 0.719800
 epoch 25/30. Took 0.063042 seconds. 
  Full-batch training loss = 1.613288, test loss = 1.629094
  Training set accuracy = 0.760000, Test set accuracy = 0.723200
 epoch 26/30. Took 0.065103 seconds. 
  Full-batch training loss = 1.584136, test loss = 1.600314
  Training set accuracy = 0.762000, Test set accuracy = 0.728800
 epoch 27/30. Took 0.062125 seconds. 
  Full-batch training loss = 1.555162, test loss = 1.571510
  Training set accuracy = 0.763500, Test set accuracy = 0.733600
 epoch 28/30. Took 0.062263 seconds. 
  Full-batch training loss = 1.526396, test loss = 1.543290
  Training set accuracy = 0.768000, Test set accuracy = 0.737300
 epoch 29/30. Took 0.06217 seconds. 
  Full-batch training loss = 1.498315, test loss = 1.515381
  Training set accuracy = 0.778000, Test set accuracy = 0.744000
 epoch 30/30. Took 0.063301 seconds. 
  Full-batch training loss = 1.470288, test loss = 1.487448
  Training set accuracy = 0.780500, Test set accuracy = 0.747600
Elapsed time is 7.158036 seconds.
End Training
-----
Params 2000 0.001 0.30 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14098 seconds. 
  Full-batch training loss = 2.289008, test loss = 2.286536
  Training set accuracy = 0.129000, Test set accuracy = 0.133300
 epoch 2/30. Took 0.13585 seconds. 
  Full-batch training loss = 2.253979, test loss = 2.252931
  Training set accuracy = 0.200500, Test set accuracy = 0.194500
 epoch 3/30. Took 0.13429 seconds. 
  Full-batch training loss = 2.220107, test loss = 2.220573
  Training set accuracy = 0.278000, Test set accuracy = 0.269600
 epoch 4/30. Took 0.13611 seconds. 
  Full-batch training loss = 2.187171, test loss = 2.188804
  Training set accuracy = 0.348000, Test set accuracy = 0.342900
 epoch 5/30. Took 0.13348 seconds. 
  Full-batch training loss = 2.154729, test loss = 2.157517
  Training set accuracy = 0.402500, Test set accuracy = 0.396500
 epoch 6/30. Took 0.13595 seconds. 
  Full-batch training loss = 2.122925, test loss = 2.126636
  Training set accuracy = 0.467000, Test set accuracy = 0.452400
 epoch 7/30. Took 0.13578 seconds. 
  Full-batch training loss = 2.091625, test loss = 2.096227
  Training set accuracy = 0.512000, Test set accuracy = 0.491200
 epoch 8/30. Took 0.13517 seconds. 
  Full-batch training loss = 2.060538, test loss = 2.065837
  Training set accuracy = 0.547500, Test set accuracy = 0.523300
 epoch 9/30. Took 0.1358 seconds. 
  Full-batch training loss = 2.029158, test loss = 2.035043
  Training set accuracy = 0.572500, Test set accuracy = 0.549900
 epoch 10/30. Took 0.13554 seconds. 
  Full-batch training loss = 1.998189, test loss = 2.004594
  Training set accuracy = 0.596000, Test set accuracy = 0.573800
 epoch 11/30. Took 0.13569 seconds. 
  Full-batch training loss = 1.967183, test loss = 1.974126
  Training set accuracy = 0.622000, Test set accuracy = 0.597400
 epoch 12/30. Took 0.13626 seconds. 
  Full-batch training loss = 1.935970, test loss = 1.943234
  Training set accuracy = 0.636500, Test set accuracy = 0.618000
 epoch 13/30. Took 0.1358 seconds. 
  Full-batch training loss = 1.904883, test loss = 1.912578
  Training set accuracy = 0.649000, Test set accuracy = 0.633400
 epoch 14/30. Took 0.13608 seconds. 
  Full-batch training loss = 1.873980, test loss = 1.881755
  Training set accuracy = 0.663500, Test set accuracy = 0.651600
 epoch 15/30. Took 0.136 seconds. 
  Full-batch training loss = 1.842800, test loss = 1.850662
  Training set accuracy = 0.678500, Test set accuracy = 0.665500
 epoch 16/30. Took 0.13825 seconds. 
  Full-batch training loss = 1.811515, test loss = 1.819504
  Training set accuracy = 0.691500, Test set accuracy = 0.675000
 epoch 17/30. Took 0.13597 seconds. 
  Full-batch training loss = 1.780317, test loss = 1.788407
  Training set accuracy = 0.704500, Test set accuracy = 0.687600
 epoch 18/30. Took 0.16242 seconds. 
  Full-batch training loss = 1.749292, test loss = 1.757387
  Training set accuracy = 0.713500, Test set accuracy = 0.696600
 epoch 19/30. Took 0.13306 seconds. 
  Full-batch training loss = 1.718336, test loss = 1.726433
  Training set accuracy = 0.720000, Test set accuracy = 0.707800
 epoch 20/30. Took 0.13638 seconds. 
  Full-batch training loss = 1.687574, test loss = 1.695636
  Training set accuracy = 0.725500, Test set accuracy = 0.717600
 epoch 21/30. Took 0.13513 seconds. 
  Full-batch training loss = 1.656935, test loss = 1.664932
  Training set accuracy = 0.734500, Test set accuracy = 0.725100
 epoch 22/30. Took 0.13609 seconds. 
  Full-batch training loss = 1.626486, test loss = 1.634266
  Training set accuracy = 0.740000, Test set accuracy = 0.733200
 epoch 23/30. Took 0.13506 seconds. 
  Full-batch training loss = 1.596225, test loss = 1.603803
  Training set accuracy = 0.752000, Test set accuracy = 0.741700
 epoch 24/30. Took 0.13637 seconds. 
  Full-batch training loss = 1.566530, test loss = 1.574102
  Training set accuracy = 0.756500, Test set accuracy = 0.747400
 epoch 25/30. Took 0.1343 seconds. 
  Full-batch training loss = 1.536851, test loss = 1.543889
  Training set accuracy = 0.765500, Test set accuracy = 0.751900
 epoch 26/30. Took 0.13226 seconds. 
  Full-batch training loss = 1.507772, test loss = 1.514672
  Training set accuracy = 0.768000, Test set accuracy = 0.758400
 epoch 27/30. Took 0.13393 seconds. 
  Full-batch training loss = 1.479116, test loss = 1.485872
  Training set accuracy = 0.771500, Test set accuracy = 0.763800
 epoch 28/30. Took 0.14103 seconds. 
  Full-batch training loss = 1.450920, test loss = 1.457316
  Training set accuracy = 0.775500, Test set accuracy = 0.769000
 epoch 29/30. Took 0.13604 seconds. 
  Full-batch training loss = 1.423313, test loss = 1.429552
  Training set accuracy = 0.783500, Test set accuracy = 0.774900
 epoch 30/30. Took 0.13571 seconds. 
  Full-batch training loss = 1.396140, test loss = 1.402016
  Training set accuracy = 0.785500, Test set accuracy = 0.780200
Elapsed time is 14.333496 seconds.
End Training
-----
Params 2000 0.001 0.30 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.053493 seconds. 
  Full-batch training loss = 2.320757, test loss = 2.315727
  Training set accuracy = 0.072000, Test set accuracy = 0.070400
 epoch 2/30. Took 0.050019 seconds. 
  Full-batch training loss = 2.313791, test loss = 2.309310
  Training set accuracy = 0.075000, Test set accuracy = 0.073700
 epoch 3/30. Took 0.049399 seconds. 
  Full-batch training loss = 2.307146, test loss = 2.303083
  Training set accuracy = 0.078000, Test set accuracy = 0.076100
 epoch 4/30. Took 0.0493 seconds. 
  Full-batch training loss = 2.300401, test loss = 2.296800
  Training set accuracy = 0.082000, Test set accuracy = 0.079400
 epoch 5/30. Took 0.049303 seconds. 
  Full-batch training loss = 2.293939, test loss = 2.290829
  Training set accuracy = 0.089000, Test set accuracy = 0.085400
 epoch 6/30. Took 0.049784 seconds. 
  Full-batch training loss = 2.287482, test loss = 2.284885
  Training set accuracy = 0.099500, Test set accuracy = 0.094100
 epoch 7/30. Took 0.049743 seconds. 
  Full-batch training loss = 2.280956, test loss = 2.278923
  Training set accuracy = 0.114000, Test set accuracy = 0.109200
 epoch 8/30. Took 0.049629 seconds. 
  Full-batch training loss = 2.274586, test loss = 2.273066
  Training set accuracy = 0.137500, Test set accuracy = 0.127500
 epoch 9/30. Took 0.054969 seconds. 
  Full-batch training loss = 2.268174, test loss = 2.267164
  Training set accuracy = 0.157000, Test set accuracy = 0.152400
 epoch 10/30. Took 0.053808 seconds. 
  Full-batch training loss = 2.261591, test loss = 2.261115
  Training set accuracy = 0.183500, Test set accuracy = 0.179600
 epoch 11/30. Took 0.048885 seconds. 
  Full-batch training loss = 2.254923, test loss = 2.255040
  Training set accuracy = 0.219500, Test set accuracy = 0.208500
 epoch 12/30. Took 0.049152 seconds. 
  Full-batch training loss = 2.248139, test loss = 2.248820
  Training set accuracy = 0.250500, Test set accuracy = 0.235700
 epoch 13/30. Took 0.048873 seconds. 
  Full-batch training loss = 2.241300, test loss = 2.242588
  Training set accuracy = 0.283500, Test set accuracy = 0.265500
 epoch 14/30. Took 0.047573 seconds. 
  Full-batch training loss = 2.234317, test loss = 2.236130
  Training set accuracy = 0.310500, Test set accuracy = 0.293300
 epoch 15/30. Took 0.047142 seconds. 
  Full-batch training loss = 2.227108, test loss = 2.229502
  Training set accuracy = 0.333500, Test set accuracy = 0.318600
 epoch 16/30. Took 0.054356 seconds. 
  Full-batch training loss = 2.219514, test loss = 2.222520
  Training set accuracy = 0.356000, Test set accuracy = 0.339000
 epoch 17/30. Took 0.048447 seconds. 
  Full-batch training loss = 2.212026, test loss = 2.215577
  Training set accuracy = 0.367500, Test set accuracy = 0.355800
 epoch 18/30. Took 0.046616 seconds. 
  Full-batch training loss = 2.204190, test loss = 2.208325
  Training set accuracy = 0.381000, Test set accuracy = 0.368800
 epoch 19/30. Took 0.04658 seconds. 
  Full-batch training loss = 2.196049, test loss = 2.200796
  Training set accuracy = 0.393000, Test set accuracy = 0.375200
 epoch 20/30. Took 0.046179 seconds. 
  Full-batch training loss = 2.187714, test loss = 2.193082
  Training set accuracy = 0.407000, Test set accuracy = 0.382500
 epoch 21/30. Took 0.053551 seconds. 
  Full-batch training loss = 2.179266, test loss = 2.185254
  Training set accuracy = 0.411500, Test set accuracy = 0.386300
 epoch 22/30. Took 0.045396 seconds. 
  Full-batch training loss = 2.170410, test loss = 2.177053
  Training set accuracy = 0.417000, Test set accuracy = 0.386800
 epoch 23/30. Took 0.046756 seconds. 
  Full-batch training loss = 2.161189, test loss = 2.168499
  Training set accuracy = 0.418500, Test set accuracy = 0.388400
 epoch 24/30. Took 0.048284 seconds. 
  Full-batch training loss = 2.151640, test loss = 2.159615
  Training set accuracy = 0.416000, Test set accuracy = 0.387300
 epoch 25/30. Took 0.046584 seconds. 
  Full-batch training loss = 2.141851, test loss = 2.150610
  Training set accuracy = 0.411000, Test set accuracy = 0.383900
 epoch 26/30. Took 0.045998 seconds. 
  Full-batch training loss = 2.131855, test loss = 2.141314
  Training set accuracy = 0.412500, Test set accuracy = 0.382700
 epoch 27/30. Took 0.048264 seconds. 
  Full-batch training loss = 2.121208, test loss = 2.131498
  Training set accuracy = 0.407500, Test set accuracy = 0.377800
 epoch 28/30. Took 0.049955 seconds. 
  Full-batch training loss = 2.110375, test loss = 2.121424
  Training set accuracy = 0.404000, Test set accuracy = 0.374400
 epoch 29/30. Took 0.04616 seconds. 
  Full-batch training loss = 2.099333, test loss = 2.111163
  Training set accuracy = 0.407000, Test set accuracy = 0.372800
 epoch 30/30. Took 0.047748 seconds. 
  Full-batch training loss = 2.088286, test loss = 2.100898
  Training set accuracy = 0.409500, Test set accuracy = 0.373600
Elapsed time is 5.607212 seconds.
End Training
-----
Params 2000 0.001 0.30 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.08798 seconds. 
  Full-batch training loss = 2.317464, test loss = 2.316900
  Training set accuracy = 0.067000, Test set accuracy = 0.062200
 epoch 2/30. Took 0.081701 seconds. 
  Full-batch training loss = 2.311578, test loss = 2.311001
  Training set accuracy = 0.073000, Test set accuracy = 0.071500
 epoch 3/30. Took 0.084148 seconds. 
  Full-batch training loss = 2.305811, test loss = 2.305207
  Training set accuracy = 0.085000, Test set accuracy = 0.084400
 epoch 4/30. Took 0.087343 seconds. 
  Full-batch training loss = 2.300086, test loss = 2.299461
  Training set accuracy = 0.103000, Test set accuracy = 0.098100
 epoch 5/30. Took 0.086811 seconds. 
  Full-batch training loss = 2.294535, test loss = 2.293846
  Training set accuracy = 0.112500, Test set accuracy = 0.114500
 epoch 6/30. Took 0.086656 seconds. 
  Full-batch training loss = 2.289061, test loss = 2.288345
  Training set accuracy = 0.132000, Test set accuracy = 0.130900
 epoch 7/30. Took 0.086747 seconds. 
  Full-batch training loss = 2.283547, test loss = 2.282786
  Training set accuracy = 0.144000, Test set accuracy = 0.148600
 epoch 8/30. Took 0.093682 seconds. 
  Full-batch training loss = 2.278077, test loss = 2.277268
  Training set accuracy = 0.166500, Test set accuracy = 0.168900
 epoch 9/30. Took 0.082423 seconds. 
  Full-batch training loss = 2.272628, test loss = 2.271780
  Training set accuracy = 0.190500, Test set accuracy = 0.194200
 epoch 10/30. Took 0.096702 seconds. 
  Full-batch training loss = 2.267257, test loss = 2.266385
  Training set accuracy = 0.213500, Test set accuracy = 0.221200
 epoch 11/30. Took 0.086424 seconds. 
  Full-batch training loss = 2.261715, test loss = 2.260823
  Training set accuracy = 0.235500, Test set accuracy = 0.250200
 epoch 12/30. Took 0.08345 seconds. 
  Full-batch training loss = 2.256104, test loss = 2.255186
  Training set accuracy = 0.267500, Test set accuracy = 0.276200
 epoch 13/30. Took 0.087089 seconds. 
  Full-batch training loss = 2.250400, test loss = 2.249457
  Training set accuracy = 0.294500, Test set accuracy = 0.301300
 epoch 14/30. Took 0.087052 seconds. 
  Full-batch training loss = 2.244632, test loss = 2.243668
  Training set accuracy = 0.319500, Test set accuracy = 0.326400
 epoch 15/30. Took 0.086953 seconds. 
  Full-batch training loss = 2.238795, test loss = 2.237814
  Training set accuracy = 0.342000, Test set accuracy = 0.346800
 epoch 16/30. Took 0.087425 seconds. 
  Full-batch training loss = 2.232704, test loss = 2.231716
  Training set accuracy = 0.365500, Test set accuracy = 0.366600
 epoch 17/30. Took 0.08709 seconds. 
  Full-batch training loss = 2.226660, test loss = 2.225664
  Training set accuracy = 0.387000, Test set accuracy = 0.385600
 epoch 18/30. Took 0.098803 seconds. 
  Full-batch training loss = 2.220389, test loss = 2.219371
  Training set accuracy = 0.406500, Test set accuracy = 0.401000
 epoch 19/30. Took 0.085157 seconds. 
  Full-batch training loss = 2.213934, test loss = 2.212875
  Training set accuracy = 0.421500, Test set accuracy = 0.418500
 epoch 20/30. Took 0.085898 seconds. 
  Full-batch training loss = 2.207304, test loss = 2.206252
  Training set accuracy = 0.433000, Test set accuracy = 0.430900
 epoch 21/30. Took 0.083987 seconds. 
  Full-batch training loss = 2.200408, test loss = 2.199311
  Training set accuracy = 0.440500, Test set accuracy = 0.446300
 epoch 22/30. Took 0.087263 seconds. 
  Full-batch training loss = 2.193333, test loss = 2.192189
  Training set accuracy = 0.447500, Test set accuracy = 0.455900
 epoch 23/30. Took 0.087646 seconds. 
  Full-batch training loss = 2.186017, test loss = 2.184866
  Training set accuracy = 0.462500, Test set accuracy = 0.463700
 epoch 24/30. Took 0.086926 seconds. 
  Full-batch training loss = 2.178366, test loss = 2.177192
  Training set accuracy = 0.471000, Test set accuracy = 0.472000
 epoch 25/30. Took 0.085133 seconds. 
  Full-batch training loss = 2.170431, test loss = 2.169237
  Training set accuracy = 0.479500, Test set accuracy = 0.481200
 epoch 26/30. Took 0.086412 seconds. 
  Full-batch training loss = 2.162476, test loss = 2.161254
  Training set accuracy = 0.490000, Test set accuracy = 0.491000
 epoch 27/30. Took 0.092681 seconds. 
  Full-batch training loss = 2.154167, test loss = 2.152928
  Training set accuracy = 0.501500, Test set accuracy = 0.497600
 epoch 28/30. Took 0.085255 seconds. 
  Full-batch training loss = 2.145420, test loss = 2.144170
  Training set accuracy = 0.510500, Test set accuracy = 0.502900
 epoch 29/30. Took 0.084706 seconds. 
  Full-batch training loss = 2.136141, test loss = 2.134876
  Training set accuracy = 0.519000, Test set accuracy = 0.509600
 epoch 30/30. Took 0.096379 seconds. 
  Full-batch training loss = 2.126791, test loss = 2.125495
  Training set accuracy = 0.527000, Test set accuracy = 0.517600
Elapsed time is 9.151422 seconds.
End Training
-----
Params 2000 0.001 0.30 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23001 seconds. 
  Full-batch training loss = 2.295630, test loss = 2.300224
  Training set accuracy = 0.146000, Test set accuracy = 0.146200
 epoch 2/30. Took 0.23052 seconds. 
  Full-batch training loss = 2.286314, test loss = 2.291388
  Training set accuracy = 0.181500, Test set accuracy = 0.172000
 epoch 3/30. Took 0.22961 seconds. 
  Full-batch training loss = 2.277086, test loss = 2.282560
  Training set accuracy = 0.219000, Test set accuracy = 0.203400
 epoch 4/30. Took 0.22998 seconds. 
  Full-batch training loss = 2.267878, test loss = 2.273737
  Training set accuracy = 0.259500, Test set accuracy = 0.237300
 epoch 5/30. Took 0.22921 seconds. 
  Full-batch training loss = 2.258677, test loss = 2.265011
  Training set accuracy = 0.297000, Test set accuracy = 0.268500
 epoch 6/30. Took 0.23022 seconds. 
  Full-batch training loss = 2.249470, test loss = 2.256187
  Training set accuracy = 0.324500, Test set accuracy = 0.300900
 epoch 7/30. Took 0.23095 seconds. 
  Full-batch training loss = 2.240185, test loss = 2.247375
  Training set accuracy = 0.355000, Test set accuracy = 0.330800
 epoch 8/30. Took 0.22517 seconds. 
  Full-batch training loss = 2.230838, test loss = 2.238529
  Training set accuracy = 0.390000, Test set accuracy = 0.356900
 epoch 9/30. Took 0.22754 seconds. 
  Full-batch training loss = 2.221486, test loss = 2.229530
  Training set accuracy = 0.413500, Test set accuracy = 0.379300
 epoch 10/30. Took 0.22857 seconds. 
  Full-batch training loss = 2.211888, test loss = 2.220367
  Training set accuracy = 0.437000, Test set accuracy = 0.402400
 epoch 11/30. Took 0.23026 seconds. 
  Full-batch training loss = 2.202260, test loss = 2.211088
  Training set accuracy = 0.456000, Test set accuracy = 0.427400
 epoch 12/30. Took 0.23103 seconds. 
  Full-batch training loss = 2.192203, test loss = 2.201507
  Training set accuracy = 0.480000, Test set accuracy = 0.445600
 epoch 13/30. Took 0.23002 seconds. 
  Full-batch training loss = 2.182327, test loss = 2.191914
  Training set accuracy = 0.494000, Test set accuracy = 0.464300
 epoch 14/30. Took 0.2295 seconds. 
  Full-batch training loss = 2.171952, test loss = 2.182034
  Training set accuracy = 0.506500, Test set accuracy = 0.476900
 epoch 15/30. Took 0.22948 seconds. 
  Full-batch training loss = 2.161445, test loss = 2.171825
  Training set accuracy = 0.519000, Test set accuracy = 0.492300
 epoch 16/30. Took 0.23928 seconds. 
  Full-batch training loss = 2.150536, test loss = 2.161261
  Training set accuracy = 0.528500, Test set accuracy = 0.503600
 epoch 17/30. Took 0.23066 seconds. 
  Full-batch training loss = 2.139495, test loss = 2.150549
  Training set accuracy = 0.540000, Test set accuracy = 0.514800
 epoch 18/30. Took 0.22635 seconds. 
  Full-batch training loss = 2.127961, test loss = 2.139409
  Training set accuracy = 0.544500, Test set accuracy = 0.520400
 epoch 19/30. Took 0.22625 seconds. 
  Full-batch training loss = 2.116401, test loss = 2.128145
  Training set accuracy = 0.551000, Test set accuracy = 0.530000
 epoch 20/30. Took 0.23081 seconds. 
  Full-batch training loss = 2.104276, test loss = 2.116337
  Training set accuracy = 0.559500, Test set accuracy = 0.536300
 epoch 21/30. Took 0.23044 seconds. 
  Full-batch training loss = 2.091917, test loss = 2.104325
  Training set accuracy = 0.566500, Test set accuracy = 0.544800
 epoch 22/30. Took 0.23044 seconds. 
  Full-batch training loss = 2.079047, test loss = 2.091833
  Training set accuracy = 0.573500, Test set accuracy = 0.552200
 epoch 23/30. Took 0.23782 seconds. 
  Full-batch training loss = 2.065957, test loss = 2.079047
  Training set accuracy = 0.578500, Test set accuracy = 0.558700
 epoch 24/30. Took 0.22856 seconds. 
  Full-batch training loss = 2.052324, test loss = 2.065605
  Training set accuracy = 0.582000, Test set accuracy = 0.566000
 epoch 25/30. Took 0.24173 seconds. 
  Full-batch training loss = 2.038246, test loss = 2.051823
  Training set accuracy = 0.586500, Test set accuracy = 0.571300
 epoch 26/30. Took 0.22407 seconds. 
  Full-batch training loss = 2.023739, test loss = 2.037671
  Training set accuracy = 0.589500, Test set accuracy = 0.576000
 epoch 27/30. Took 0.25753 seconds. 
  Full-batch training loss = 2.008563, test loss = 2.022821
  Training set accuracy = 0.594000, Test set accuracy = 0.579400
 epoch 28/30. Took 0.22917 seconds. 
  Full-batch training loss = 1.993196, test loss = 2.007671
  Training set accuracy = 0.599500, Test set accuracy = 0.585200
 epoch 29/30. Took 0.228 seconds. 
  Full-batch training loss = 1.977215, test loss = 1.991910
  Training set accuracy = 0.604000, Test set accuracy = 0.591300
 epoch 30/30. Took 0.22718 seconds. 
  Full-batch training loss = 1.960723, test loss = 1.975592
  Training set accuracy = 0.609000, Test set accuracy = 0.594400
Elapsed time is 23.099267 seconds.
End Training
-----
Params 2000 0.001 0.30 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.063804 seconds. 
  Full-batch training loss = 2.306798, test loss = 2.307290
  Training set accuracy = 0.124000, Test set accuracy = 0.121600
 epoch 2/30. Took 0.056613 seconds. 
  Full-batch training loss = 2.305357, test loss = 2.306012
  Training set accuracy = 0.127500, Test set accuracy = 0.123700
 epoch 3/30. Took 0.05597 seconds. 
  Full-batch training loss = 2.303950, test loss = 2.304764
  Training set accuracy = 0.127500, Test set accuracy = 0.125700
 epoch 4/30. Took 0.055804 seconds. 
  Full-batch training loss = 2.302543, test loss = 2.303522
  Training set accuracy = 0.130500, Test set accuracy = 0.126800
 epoch 5/30. Took 0.057552 seconds. 
  Full-batch training loss = 2.301080, test loss = 2.302223
  Training set accuracy = 0.132500, Test set accuracy = 0.127500
 epoch 6/30. Took 0.060248 seconds. 
  Full-batch training loss = 2.299657, test loss = 2.300982
  Training set accuracy = 0.133500, Test set accuracy = 0.126700
 epoch 7/30. Took 0.063335 seconds. 
  Full-batch training loss = 2.298266, test loss = 2.299770
  Training set accuracy = 0.134500, Test set accuracy = 0.128800
 epoch 8/30. Took 0.058527 seconds. 
  Full-batch training loss = 2.296835, test loss = 2.298511
  Training set accuracy = 0.134500, Test set accuracy = 0.127900
 epoch 9/30. Took 0.058905 seconds. 
  Full-batch training loss = 2.295502, test loss = 2.297352
  Training set accuracy = 0.136000, Test set accuracy = 0.127900
 epoch 10/30. Took 0.060305 seconds. 
  Full-batch training loss = 2.294104, test loss = 2.296115
  Training set accuracy = 0.137500, Test set accuracy = 0.129800
 epoch 11/30. Took 0.059636 seconds. 
  Full-batch training loss = 2.292722, test loss = 2.294898
  Training set accuracy = 0.138000, Test set accuracy = 0.128300
 epoch 12/30. Took 0.059756 seconds. 
  Full-batch training loss = 2.291327, test loss = 2.293674
  Training set accuracy = 0.138000, Test set accuracy = 0.128200
 epoch 13/30. Took 0.060227 seconds. 
  Full-batch training loss = 2.289961, test loss = 2.292465
  Training set accuracy = 0.138000, Test set accuracy = 0.129000
 epoch 14/30. Took 0.060018 seconds. 
  Full-batch training loss = 2.288547, test loss = 2.291203
  Training set accuracy = 0.137500, Test set accuracy = 0.128900
 epoch 15/30. Took 0.060005 seconds. 
  Full-batch training loss = 2.287127, test loss = 2.289953
  Training set accuracy = 0.136500, Test set accuracy = 0.128900
 epoch 16/30. Took 0.059739 seconds. 
  Full-batch training loss = 2.285708, test loss = 2.288647
  Training set accuracy = 0.137000, Test set accuracy = 0.129000
 epoch 17/30. Took 0.062519 seconds. 
  Full-batch training loss = 2.284291, test loss = 2.287394
  Training set accuracy = 0.137500, Test set accuracy = 0.129600
 epoch 18/30. Took 0.064704 seconds. 
  Full-batch training loss = 2.282875, test loss = 2.286115
  Training set accuracy = 0.139000, Test set accuracy = 0.130300
 epoch 19/30. Took 0.060867 seconds. 
  Full-batch training loss = 2.281355, test loss = 2.284744
  Training set accuracy = 0.139000, Test set accuracy = 0.131300
 epoch 20/30. Took 0.061882 seconds. 
  Full-batch training loss = 2.279906, test loss = 2.283420
  Training set accuracy = 0.139500, Test set accuracy = 0.131300
 epoch 21/30. Took 0.059681 seconds. 
  Full-batch training loss = 2.278373, test loss = 2.282054
  Training set accuracy = 0.140000, Test set accuracy = 0.132300
 epoch 22/30. Took 0.059621 seconds. 
  Full-batch training loss = 2.276798, test loss = 2.280619
  Training set accuracy = 0.139500, Test set accuracy = 0.133000
 epoch 23/30. Took 0.061971 seconds. 
  Full-batch training loss = 2.275246, test loss = 2.279197
  Training set accuracy = 0.140500, Test set accuracy = 0.133500
 epoch 24/30. Took 0.059827 seconds. 
  Full-batch training loss = 2.273614, test loss = 2.277688
  Training set accuracy = 0.142000, Test set accuracy = 0.136900
 epoch 25/30. Took 0.060432 seconds. 
  Full-batch training loss = 2.271962, test loss = 2.276181
  Training set accuracy = 0.142000, Test set accuracy = 0.136900
 epoch 26/30. Took 0.060647 seconds. 
  Full-batch training loss = 2.270231, test loss = 2.274612
  Training set accuracy = 0.146000, Test set accuracy = 0.143000
 epoch 27/30. Took 0.060131 seconds. 
  Full-batch training loss = 2.268412, test loss = 2.272945
  Training set accuracy = 0.148500, Test set accuracy = 0.146600
 epoch 28/30. Took 0.058435 seconds. 
  Full-batch training loss = 2.266582, test loss = 2.271261
  Training set accuracy = 0.154000, Test set accuracy = 0.149300
 epoch 29/30. Took 0.055072 seconds. 
  Full-batch training loss = 2.264782, test loss = 2.269614
  Training set accuracy = 0.156500, Test set accuracy = 0.152900
 epoch 30/30. Took 0.055553 seconds. 
  Full-batch training loss = 2.262952, test loss = 2.267934
  Training set accuracy = 0.163000, Test set accuracy = 0.159100
Elapsed time is 6.557677 seconds.
End Training
-----
Params 2000 0.001 0.30 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11544 seconds. 
  Full-batch training loss = 2.309223, test loss = 2.311280
  Training set accuracy = 0.099500, Test set accuracy = 0.099100
 epoch 2/30. Took 0.11354 seconds. 
  Full-batch training loss = 2.306880, test loss = 2.308933
  Training set accuracy = 0.100000, Test set accuracy = 0.098800
 epoch 3/30. Took 0.10675 seconds. 
  Full-batch training loss = 2.304546, test loss = 2.306576
  Training set accuracy = 0.100000, Test set accuracy = 0.099000
 epoch 4/30. Took 0.10888 seconds. 
  Full-batch training loss = 2.302348, test loss = 2.304317
  Training set accuracy = 0.101000, Test set accuracy = 0.099700
 epoch 5/30. Took 0.10809 seconds. 
  Full-batch training loss = 2.300052, test loss = 2.302019
  Training set accuracy = 0.101000, Test set accuracy = 0.101000
 epoch 6/30. Took 0.10753 seconds. 
  Full-batch training loss = 2.297834, test loss = 2.299785
  Training set accuracy = 0.103000, Test set accuracy = 0.102900
 epoch 7/30. Took 0.1083 seconds. 
  Full-batch training loss = 2.295559, test loss = 2.297499
  Training set accuracy = 0.105500, Test set accuracy = 0.105000
 epoch 8/30. Took 0.10766 seconds. 
  Full-batch training loss = 2.293342, test loss = 2.295268
  Training set accuracy = 0.107000, Test set accuracy = 0.107100
 epoch 9/30. Took 0.11099 seconds. 
  Full-batch training loss = 2.291159, test loss = 2.293043
  Training set accuracy = 0.113500, Test set accuracy = 0.111300
 epoch 10/30. Took 0.10334 seconds. 
  Full-batch training loss = 2.288977, test loss = 2.290872
  Training set accuracy = 0.118500, Test set accuracy = 0.116700
 epoch 11/30. Took 0.10443 seconds. 
  Full-batch training loss = 2.286808, test loss = 2.288662
  Training set accuracy = 0.127500, Test set accuracy = 0.124000
 epoch 12/30. Took 0.10933 seconds. 
  Full-batch training loss = 2.284601, test loss = 2.286459
  Training set accuracy = 0.131000, Test set accuracy = 0.130500
 epoch 13/30. Took 0.12267 seconds. 
  Full-batch training loss = 2.282436, test loss = 2.284268
  Training set accuracy = 0.141000, Test set accuracy = 0.140700
 epoch 14/30. Took 0.10703 seconds. 
  Full-batch training loss = 2.280207, test loss = 2.282038
  Training set accuracy = 0.149000, Test set accuracy = 0.147400
 epoch 15/30. Took 0.10315 seconds. 
  Full-batch training loss = 2.277946, test loss = 2.279760
  Training set accuracy = 0.163000, Test set accuracy = 0.155400
 epoch 16/30. Took 0.10369 seconds. 
  Full-batch training loss = 2.275707, test loss = 2.277524
  Training set accuracy = 0.169500, Test set accuracy = 0.161200
 epoch 17/30. Took 0.10344 seconds. 
  Full-batch training loss = 2.273387, test loss = 2.275156
  Training set accuracy = 0.173000, Test set accuracy = 0.166800
 epoch 18/30. Took 0.10866 seconds. 
  Full-batch training loss = 2.271070, test loss = 2.272840
  Training set accuracy = 0.180000, Test set accuracy = 0.175900
 epoch 19/30. Took 0.10886 seconds. 
  Full-batch training loss = 2.268706, test loss = 2.270445
  Training set accuracy = 0.187000, Test set accuracy = 0.182900
 epoch 20/30. Took 0.10824 seconds. 
  Full-batch training loss = 2.266276, test loss = 2.268026
  Training set accuracy = 0.193000, Test set accuracy = 0.189400
 epoch 21/30. Took 0.1088 seconds. 
  Full-batch training loss = 2.263891, test loss = 2.265605
  Training set accuracy = 0.197000, Test set accuracy = 0.194500
 epoch 22/30. Took 0.10674 seconds. 
  Full-batch training loss = 2.261473, test loss = 2.263186
  Training set accuracy = 0.206000, Test set accuracy = 0.200500
 epoch 23/30. Took 0.10811 seconds. 
  Full-batch training loss = 2.258986, test loss = 2.260652
  Training set accuracy = 0.221500, Test set accuracy = 0.207900
 epoch 24/30. Took 0.11021 seconds. 
  Full-batch training loss = 2.256470, test loss = 2.258127
  Training set accuracy = 0.231500, Test set accuracy = 0.216100
 epoch 25/30. Took 0.10801 seconds. 
  Full-batch training loss = 2.253813, test loss = 2.255461
  Training set accuracy = 0.241000, Test set accuracy = 0.224000
 epoch 26/30. Took 0.10887 seconds. 
  Full-batch training loss = 2.251156, test loss = 2.252797
  Training set accuracy = 0.250500, Test set accuracy = 0.232200
 epoch 27/30. Took 0.10888 seconds. 
  Full-batch training loss = 2.248430, test loss = 2.250034
  Training set accuracy = 0.262000, Test set accuracy = 0.242500
 epoch 28/30. Took 0.1078 seconds. 
  Full-batch training loss = 2.245652, test loss = 2.247259
  Training set accuracy = 0.275500, Test set accuracy = 0.251900
 epoch 29/30. Took 0.10741 seconds. 
  Full-batch training loss = 2.242775, test loss = 2.244362
  Training set accuracy = 0.283500, Test set accuracy = 0.258700
 epoch 30/30. Took 0.10652 seconds. 
  Full-batch training loss = 2.239864, test loss = 2.241452
  Training set accuracy = 0.291000, Test set accuracy = 0.267100
Elapsed time is 10.932408 seconds.
End Training
-----
Params 2000 0.001 0.30 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32303 seconds. 
  Full-batch training loss = 2.301859, test loss = 2.301528
  Training set accuracy = 0.104000, Test set accuracy = 0.099300
 epoch 2/30. Took 0.32308 seconds. 
  Full-batch training loss = 2.299771, test loss = 2.299473
  Training set accuracy = 0.109500, Test set accuracy = 0.102800
 epoch 3/30. Took 0.35359 seconds. 
  Full-batch training loss = 2.297675, test loss = 2.297417
  Training set accuracy = 0.115500, Test set accuracy = 0.106600
 epoch 4/30. Took 0.31648 seconds. 
  Full-batch training loss = 2.295548, test loss = 2.295334
  Training set accuracy = 0.118000, Test set accuracy = 0.112500
 epoch 5/30. Took 0.32061 seconds. 
  Full-batch training loss = 2.293467, test loss = 2.293282
  Training set accuracy = 0.123500, Test set accuracy = 0.120400
 epoch 6/30. Took 0.32003 seconds. 
  Full-batch training loss = 2.291400, test loss = 2.291237
  Training set accuracy = 0.133000, Test set accuracy = 0.129100
 epoch 7/30. Took 0.32632 seconds. 
  Full-batch training loss = 2.289357, test loss = 2.289233
  Training set accuracy = 0.144000, Test set accuracy = 0.140300
 epoch 8/30. Took 0.32205 seconds. 
  Full-batch training loss = 2.287286, test loss = 2.287206
  Training set accuracy = 0.150500, Test set accuracy = 0.155800
 epoch 9/30. Took 0.31994 seconds. 
  Full-batch training loss = 2.285208, test loss = 2.285172
  Training set accuracy = 0.163500, Test set accuracy = 0.167500
 epoch 10/30. Took 0.31762 seconds. 
  Full-batch training loss = 2.283109, test loss = 2.283088
  Training set accuracy = 0.187000, Test set accuracy = 0.189900
 epoch 11/30. Took 0.32089 seconds. 
  Full-batch training loss = 2.281028, test loss = 2.281033
  Training set accuracy = 0.209000, Test set accuracy = 0.211700
 epoch 12/30. Took 0.31894 seconds. 
  Full-batch training loss = 2.278914, test loss = 2.278949
  Training set accuracy = 0.239500, Test set accuracy = 0.237200
 epoch 13/30. Took 0.31787 seconds. 
  Full-batch training loss = 2.276787, test loss = 2.276838
  Training set accuracy = 0.269000, Test set accuracy = 0.266500
 epoch 14/30. Took 0.35885 seconds. 
  Full-batch training loss = 2.274626, test loss = 2.274709
  Training set accuracy = 0.295000, Test set accuracy = 0.299500
 epoch 15/30. Took 0.3217 seconds. 
  Full-batch training loss = 2.272418, test loss = 2.272526
  Training set accuracy = 0.336500, Test set accuracy = 0.339700
 epoch 16/30. Took 0.36226 seconds. 
  Full-batch training loss = 2.270223, test loss = 2.270351
  Training set accuracy = 0.369000, Test set accuracy = 0.373900
 epoch 17/30. Took 0.32429 seconds. 
  Full-batch training loss = 2.268039, test loss = 2.268200
  Training set accuracy = 0.393000, Test set accuracy = 0.401300
 epoch 18/30. Took 0.32237 seconds. 
  Full-batch training loss = 2.265806, test loss = 2.265981
  Training set accuracy = 0.420500, Test set accuracy = 0.426600
 epoch 19/30. Took 0.32123 seconds. 
  Full-batch training loss = 2.263540, test loss = 2.263742
  Training set accuracy = 0.440500, Test set accuracy = 0.447100
 epoch 20/30. Took 0.32105 seconds. 
  Full-batch training loss = 2.261201, test loss = 2.261433
  Training set accuracy = 0.460000, Test set accuracy = 0.463200
 epoch 21/30. Took 0.3236 seconds. 
  Full-batch training loss = 2.258849, test loss = 2.259093
  Training set accuracy = 0.487500, Test set accuracy = 0.481400
 epoch 22/30. Took 0.32079 seconds. 
  Full-batch training loss = 2.256455, test loss = 2.256698
  Training set accuracy = 0.507500, Test set accuracy = 0.498700
 epoch 23/30. Took 0.31873 seconds. 
  Full-batch training loss = 2.254000, test loss = 2.254267
  Training set accuracy = 0.513000, Test set accuracy = 0.505700
 epoch 24/30. Took 0.31882 seconds. 
  Full-batch training loss = 2.251491, test loss = 2.251744
  Training set accuracy = 0.524000, Test set accuracy = 0.518200
 epoch 25/30. Took 0.3367 seconds. 
  Full-batch training loss = 2.248925, test loss = 2.249198
  Training set accuracy = 0.528000, Test set accuracy = 0.522500
 epoch 26/30. Took 0.32044 seconds. 
  Full-batch training loss = 2.246336, test loss = 2.246618
  Training set accuracy = 0.537500, Test set accuracy = 0.531600
 epoch 27/30. Took 0.33897 seconds. 
  Full-batch training loss = 2.243678, test loss = 2.243979
  Training set accuracy = 0.542500, Test set accuracy = 0.531500
 epoch 28/30. Took 0.31761 seconds. 
  Full-batch training loss = 2.240953, test loss = 2.241226
  Training set accuracy = 0.558500, Test set accuracy = 0.544200
 epoch 29/30. Took 0.31981 seconds. 
  Full-batch training loss = 2.238159, test loss = 2.238433
  Training set accuracy = 0.566000, Test set accuracy = 0.549400
 epoch 30/30. Took 0.3207 seconds. 
  Full-batch training loss = 2.235242, test loss = 2.235540
  Training set accuracy = 0.567000, Test set accuracy = 0.552600
Elapsed time is 31.767712 seconds.
End Training
-----
Params 2000 0.001 0.40 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.043808 seconds. 
  Full-batch training loss = 2.291130, test loss = 2.287516
  Training set accuracy = 0.154500, Test set accuracy = 0.150200
 epoch 2/30. Took 0.039058 seconds. 
  Full-batch training loss = 2.270478, test loss = 2.266994
  Training set accuracy = 0.184000, Test set accuracy = 0.178600
 epoch 3/30. Took 0.038911 seconds. 
  Full-batch training loss = 2.249802, test loss = 2.246470
  Training set accuracy = 0.209000, Test set accuracy = 0.203400
 epoch 4/30. Took 0.038645 seconds. 
  Full-batch training loss = 2.229272, test loss = 2.226100
  Training set accuracy = 0.226500, Test set accuracy = 0.227300
 epoch 5/30. Took 0.039012 seconds. 
  Full-batch training loss = 2.208863, test loss = 2.205955
  Training set accuracy = 0.247000, Test set accuracy = 0.246100
 epoch 6/30. Took 0.03844 seconds. 
  Full-batch training loss = 2.188638, test loss = 2.185762
  Training set accuracy = 0.270500, Test set accuracy = 0.266600
 epoch 7/30. Took 0.038778 seconds. 
  Full-batch training loss = 2.167767, test loss = 2.165235
  Training set accuracy = 0.290000, Test set accuracy = 0.287700
 epoch 8/30. Took 0.038811 seconds. 
  Full-batch training loss = 2.147083, test loss = 2.144853
  Training set accuracy = 0.314000, Test set accuracy = 0.314600
 epoch 9/30. Took 0.03787 seconds. 
  Full-batch training loss = 2.126101, test loss = 2.124153
  Training set accuracy = 0.345000, Test set accuracy = 0.346500
 epoch 10/30. Took 0.039031 seconds. 
  Full-batch training loss = 2.104378, test loss = 2.102868
  Training set accuracy = 0.382000, Test set accuracy = 0.383900
 epoch 11/30. Took 0.038476 seconds. 
  Full-batch training loss = 2.082478, test loss = 2.081488
  Training set accuracy = 0.420000, Test set accuracy = 0.420700
 epoch 12/30. Took 0.038481 seconds. 
  Full-batch training loss = 2.060626, test loss = 2.060127
  Training set accuracy = 0.452000, Test set accuracy = 0.453600
 epoch 13/30. Took 0.038516 seconds. 
  Full-batch training loss = 2.038651, test loss = 2.038573
  Training set accuracy = 0.476000, Test set accuracy = 0.479100
 epoch 14/30. Took 0.038676 seconds. 
  Full-batch training loss = 2.016254, test loss = 2.016600
  Training set accuracy = 0.506500, Test set accuracy = 0.506800
 epoch 15/30. Took 0.039568 seconds. 
  Full-batch training loss = 1.993973, test loss = 1.994696
  Training set accuracy = 0.530500, Test set accuracy = 0.528300
 epoch 16/30. Took 0.038241 seconds. 
  Full-batch training loss = 1.971236, test loss = 1.972440
  Training set accuracy = 0.551000, Test set accuracy = 0.546200
 epoch 17/30. Took 0.038443 seconds. 
  Full-batch training loss = 1.948509, test loss = 1.950137
  Training set accuracy = 0.566000, Test set accuracy = 0.564800
 epoch 18/30. Took 0.038289 seconds. 
  Full-batch training loss = 1.926006, test loss = 1.927871
  Training set accuracy = 0.586000, Test set accuracy = 0.582700
 epoch 19/30. Took 0.038235 seconds. 
  Full-batch training loss = 1.902960, test loss = 1.905149
  Training set accuracy = 0.611000, Test set accuracy = 0.599300
 epoch 20/30. Took 0.038324 seconds. 
  Full-batch training loss = 1.880097, test loss = 1.882545
  Training set accuracy = 0.619500, Test set accuracy = 0.614000
 epoch 21/30. Took 0.038885 seconds. 
  Full-batch training loss = 1.856791, test loss = 1.859659
  Training set accuracy = 0.630500, Test set accuracy = 0.624200
 epoch 22/30. Took 0.038194 seconds. 
  Full-batch training loss = 1.833627, test loss = 1.836799
  Training set accuracy = 0.647500, Test set accuracy = 0.638000
 epoch 23/30. Took 0.038192 seconds. 
  Full-batch training loss = 1.810891, test loss = 1.814290
  Training set accuracy = 0.658500, Test set accuracy = 0.648200
 epoch 24/30. Took 0.03831 seconds. 
  Full-batch training loss = 1.787797, test loss = 1.791298
  Training set accuracy = 0.669000, Test set accuracy = 0.659700
 epoch 25/30. Took 0.038847 seconds. 
  Full-batch training loss = 1.765188, test loss = 1.768916
  Training set accuracy = 0.674500, Test set accuracy = 0.668900
 epoch 26/30. Took 0.038479 seconds. 
  Full-batch training loss = 1.742610, test loss = 1.746580
  Training set accuracy = 0.685500, Test set accuracy = 0.676100
 epoch 27/30. Took 0.038589 seconds. 
  Full-batch training loss = 1.720223, test loss = 1.724449
  Training set accuracy = 0.690000, Test set accuracy = 0.684000
 epoch 28/30. Took 0.038356 seconds. 
  Full-batch training loss = 1.697699, test loss = 1.702107
  Training set accuracy = 0.700000, Test set accuracy = 0.688700
 epoch 29/30. Took 0.039152 seconds. 
  Full-batch training loss = 1.675343, test loss = 1.680104
  Training set accuracy = 0.704000, Test set accuracy = 0.694300
 epoch 30/30. Took 0.038508 seconds. 
  Full-batch training loss = 1.653335, test loss = 1.658287
  Training set accuracy = 0.708500, Test set accuracy = 0.700600
Elapsed time is 4.753541 seconds.
End Training
-----
Params 2000 0.001 0.40 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.066882 seconds. 
  Full-batch training loss = 2.300758, test loss = 2.299765
  Training set accuracy = 0.105000, Test set accuracy = 0.116800
 epoch 2/30. Took 0.062177 seconds. 
  Full-batch training loss = 2.280074, test loss = 2.278860
  Training set accuracy = 0.146500, Test set accuracy = 0.157300
 epoch 3/30. Took 0.06368 seconds. 
  Full-batch training loss = 2.260132, test loss = 2.258729
  Training set accuracy = 0.201500, Test set accuracy = 0.210100
 epoch 4/30. Took 0.063358 seconds. 
  Full-batch training loss = 2.240370, test loss = 2.238854
  Training set accuracy = 0.255500, Test set accuracy = 0.264200
 epoch 5/30. Took 0.063401 seconds. 
  Full-batch training loss = 2.221069, test loss = 2.219357
  Training set accuracy = 0.313500, Test set accuracy = 0.318200
 epoch 6/30. Took 0.06341 seconds. 
  Full-batch training loss = 2.201968, test loss = 2.200030
  Training set accuracy = 0.356500, Test set accuracy = 0.367800
 epoch 7/30. Took 0.069994 seconds. 
  Full-batch training loss = 2.183130, test loss = 2.180981
  Training set accuracy = 0.403000, Test set accuracy = 0.409300
 epoch 8/30. Took 0.062202 seconds. 
  Full-batch training loss = 2.164268, test loss = 2.161771
  Training set accuracy = 0.432500, Test set accuracy = 0.446000
 epoch 9/30. Took 0.064939 seconds. 
  Full-batch training loss = 2.145484, test loss = 2.142743
  Training set accuracy = 0.468500, Test set accuracy = 0.477200
 epoch 10/30. Took 0.062673 seconds. 
  Full-batch training loss = 2.126516, test loss = 2.123412
  Training set accuracy = 0.501000, Test set accuracy = 0.511100
 epoch 11/30. Took 0.062167 seconds. 
  Full-batch training loss = 2.107452, test loss = 2.103970
  Training set accuracy = 0.523500, Test set accuracy = 0.537300
 epoch 12/30. Took 0.063229 seconds. 
  Full-batch training loss = 2.088492, test loss = 2.084669
  Training set accuracy = 0.547500, Test set accuracy = 0.559000
 epoch 13/30. Took 0.063608 seconds. 
  Full-batch training loss = 2.069578, test loss = 2.065510
  Training set accuracy = 0.570000, Test set accuracy = 0.577800
 epoch 14/30. Took 0.063509 seconds. 
  Full-batch training loss = 2.050147, test loss = 2.045649
  Training set accuracy = 0.589000, Test set accuracy = 0.596600
 epoch 15/30. Took 0.063342 seconds. 
  Full-batch training loss = 2.030271, test loss = 2.025374
  Training set accuracy = 0.613000, Test set accuracy = 0.611000
 epoch 16/30. Took 0.064433 seconds. 
  Full-batch training loss = 2.010419, test loss = 2.005200
  Training set accuracy = 0.623500, Test set accuracy = 0.621800
 epoch 17/30. Took 0.061491 seconds. 
  Full-batch training loss = 1.990077, test loss = 1.984545
  Training set accuracy = 0.639500, Test set accuracy = 0.635600
 epoch 18/30. Took 0.062966 seconds. 
  Full-batch training loss = 1.969765, test loss = 1.963843
  Training set accuracy = 0.650500, Test set accuracy = 0.645400
 epoch 19/30. Took 0.063324 seconds. 
  Full-batch training loss = 1.948986, test loss = 1.942639
  Training set accuracy = 0.661500, Test set accuracy = 0.653200
 epoch 20/30. Took 0.063804 seconds. 
  Full-batch training loss = 1.928382, test loss = 1.921554
  Training set accuracy = 0.671000, Test set accuracy = 0.662200
 epoch 21/30. Took 0.06864 seconds. 
  Full-batch training loss = 1.907727, test loss = 1.900523
  Training set accuracy = 0.684000, Test set accuracy = 0.670900
 epoch 22/30. Took 0.071257 seconds. 
  Full-batch training loss = 1.886665, test loss = 1.879040
  Training set accuracy = 0.687500, Test set accuracy = 0.678600
 epoch 23/30. Took 0.063976 seconds. 
  Full-batch training loss = 1.865178, test loss = 1.857054
  Training set accuracy = 0.693500, Test set accuracy = 0.684200
 epoch 24/30. Took 0.062961 seconds. 
  Full-batch training loss = 1.843824, test loss = 1.835175
  Training set accuracy = 0.697500, Test set accuracy = 0.691700
 epoch 25/30. Took 0.060592 seconds. 
  Full-batch training loss = 1.822432, test loss = 1.813383
  Training set accuracy = 0.705500, Test set accuracy = 0.696800
 epoch 26/30. Took 0.063339 seconds. 
  Full-batch training loss = 1.800733, test loss = 1.791304
  Training set accuracy = 0.710500, Test set accuracy = 0.704000
 epoch 27/30. Took 0.061843 seconds. 
  Full-batch training loss = 1.778845, test loss = 1.769004
  Training set accuracy = 0.712500, Test set accuracy = 0.707700
 epoch 28/30. Took 0.062607 seconds. 
  Full-batch training loss = 1.757430, test loss = 1.747118
  Training set accuracy = 0.719500, Test set accuracy = 0.714100
 epoch 29/30. Took 0.063277 seconds. 
  Full-batch training loss = 1.735720, test loss = 1.724951
  Training set accuracy = 0.727000, Test set accuracy = 0.719600
 epoch 30/30. Took 0.063228 seconds. 
  Full-batch training loss = 1.713682, test loss = 1.702553
  Training set accuracy = 0.728500, Test set accuracy = 0.722200
Elapsed time is 6.983042 seconds.
End Training
-----
Params 2000 0.001 0.40 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14076 seconds. 
  Full-batch training loss = 2.272772, test loss = 2.271863
  Training set accuracy = 0.149000, Test set accuracy = 0.138100
 epoch 2/30. Took 0.13433 seconds. 
  Full-batch training loss = 2.246233, test loss = 2.246478
  Training set accuracy = 0.216500, Test set accuracy = 0.202900
 epoch 3/30. Took 0.13517 seconds. 
  Full-batch training loss = 2.220698, test loss = 2.222041
  Training set accuracy = 0.285000, Test set accuracy = 0.272200
 epoch 4/30. Took 0.14997 seconds. 
  Full-batch training loss = 2.195498, test loss = 2.197832
  Training set accuracy = 0.359500, Test set accuracy = 0.346300
 epoch 5/30. Took 0.135 seconds. 
  Full-batch training loss = 2.171162, test loss = 2.174323
  Training set accuracy = 0.413500, Test set accuracy = 0.406700
 epoch 6/30. Took 0.13559 seconds. 
  Full-batch training loss = 2.146848, test loss = 2.150864
  Training set accuracy = 0.460500, Test set accuracy = 0.452700
 epoch 7/30. Took 0.14287 seconds. 
  Full-batch training loss = 2.122484, test loss = 2.127459
  Training set accuracy = 0.497500, Test set accuracy = 0.487100
 epoch 8/30. Took 0.13289 seconds. 
  Full-batch training loss = 2.098660, test loss = 2.104328
  Training set accuracy = 0.538000, Test set accuracy = 0.518900
 epoch 9/30. Took 0.14137 seconds. 
  Full-batch training loss = 2.074534, test loss = 2.080932
  Training set accuracy = 0.561000, Test set accuracy = 0.541300
 epoch 10/30. Took 0.13258 seconds. 
  Full-batch training loss = 2.050322, test loss = 2.057442
  Training set accuracy = 0.578000, Test set accuracy = 0.561100
 epoch 11/30. Took 0.14822 seconds. 
  Full-batch training loss = 2.026225, test loss = 2.033927
  Training set accuracy = 0.599500, Test set accuracy = 0.581200
 epoch 12/30. Took 0.14983 seconds. 
  Full-batch training loss = 2.002118, test loss = 2.010382
  Training set accuracy = 0.613000, Test set accuracy = 0.595500
 epoch 13/30. Took 0.1487 seconds. 
  Full-batch training loss = 1.977672, test loss = 1.986602
  Training set accuracy = 0.622500, Test set accuracy = 0.608000
 epoch 14/30. Took 0.13622 seconds. 
  Full-batch training loss = 1.953257, test loss = 1.962495
  Training set accuracy = 0.635000, Test set accuracy = 0.623500
 epoch 15/30. Took 0.13294 seconds. 
  Full-batch training loss = 1.928789, test loss = 1.938462
  Training set accuracy = 0.642500, Test set accuracy = 0.634300
 epoch 16/30. Took 0.13843 seconds. 
  Full-batch training loss = 1.904272, test loss = 1.914329
  Training set accuracy = 0.654500, Test set accuracy = 0.644500
 epoch 17/30. Took 0.13628 seconds. 
  Full-batch training loss = 1.879500, test loss = 1.889839
  Training set accuracy = 0.665500, Test set accuracy = 0.653600
 epoch 18/30. Took 0.13352 seconds. 
  Full-batch training loss = 1.854470, test loss = 1.865099
  Training set accuracy = 0.674000, Test set accuracy = 0.660200
 epoch 19/30. Took 0.13562 seconds. 
  Full-batch training loss = 1.829664, test loss = 1.840668
  Training set accuracy = 0.683000, Test set accuracy = 0.666600
 epoch 20/30. Took 0.13452 seconds. 
  Full-batch training loss = 1.804632, test loss = 1.815844
  Training set accuracy = 0.690000, Test set accuracy = 0.673000
 epoch 21/30. Took 0.13406 seconds. 
  Full-batch training loss = 1.779716, test loss = 1.791173
  Training set accuracy = 0.698000, Test set accuracy = 0.678500
 epoch 22/30. Took 0.13434 seconds. 
  Full-batch training loss = 1.754714, test loss = 1.766315
  Training set accuracy = 0.696500, Test set accuracy = 0.684500
 epoch 23/30. Took 0.14391 seconds. 
  Full-batch training loss = 1.729676, test loss = 1.741466
  Training set accuracy = 0.698000, Test set accuracy = 0.688600
 epoch 24/30. Took 0.13524 seconds. 
  Full-batch training loss = 1.704626, test loss = 1.716613
  Training set accuracy = 0.704000, Test set accuracy = 0.693000
 epoch 25/30. Took 0.14398 seconds. 
  Full-batch training loss = 1.679638, test loss = 1.691684
  Training set accuracy = 0.710000, Test set accuracy = 0.696900
 epoch 26/30. Took 0.14155 seconds. 
  Full-batch training loss = 1.654985, test loss = 1.667230
  Training set accuracy = 0.716000, Test set accuracy = 0.699200
 epoch 27/30. Took 0.16107 seconds. 
  Full-batch training loss = 1.630162, test loss = 1.642439
  Training set accuracy = 0.721000, Test set accuracy = 0.703900
 epoch 28/30. Took 0.15147 seconds. 
  Full-batch training loss = 1.605760, test loss = 1.618208
  Training set accuracy = 0.724000, Test set accuracy = 0.708200
 epoch 29/30. Took 0.13569 seconds. 
  Full-batch training loss = 1.581368, test loss = 1.593804
  Training set accuracy = 0.728000, Test set accuracy = 0.710000
 epoch 30/30. Took 0.1344 seconds. 
  Full-batch training loss = 1.557130, test loss = 1.569575
  Training set accuracy = 0.733000, Test set accuracy = 0.714600
Elapsed time is 14.268531 seconds.
End Training
-----
Params 2000 0.001 0.40 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.052763 seconds. 
  Full-batch training loss = 2.309430, test loss = 2.308935
  Training set accuracy = 0.157500, Test set accuracy = 0.159400
 epoch 2/30. Took 0.049461 seconds. 
  Full-batch training loss = 2.306080, test loss = 2.305705
  Training set accuracy = 0.162500, Test set accuracy = 0.165900
 epoch 3/30. Took 0.046966 seconds. 
  Full-batch training loss = 2.302739, test loss = 2.302526
  Training set accuracy = 0.174500, Test set accuracy = 0.174900
 epoch 4/30. Took 0.047256 seconds. 
  Full-batch training loss = 2.299562, test loss = 2.299485
  Training set accuracy = 0.178500, Test set accuracy = 0.181200
 epoch 5/30. Took 0.046976 seconds. 
  Full-batch training loss = 2.296451, test loss = 2.296502
  Training set accuracy = 0.185000, Test set accuracy = 0.188500
 epoch 6/30. Took 0.047525 seconds. 
  Full-batch training loss = 2.293312, test loss = 2.293526
  Training set accuracy = 0.193500, Test set accuracy = 0.196700
 epoch 7/30. Took 0.049975 seconds. 
  Full-batch training loss = 2.290276, test loss = 2.290660
  Training set accuracy = 0.200000, Test set accuracy = 0.202500
 epoch 8/30. Took 0.0468 seconds. 
  Full-batch training loss = 2.287228, test loss = 2.287767
  Training set accuracy = 0.205500, Test set accuracy = 0.211400
 epoch 9/30. Took 0.047068 seconds. 
  Full-batch training loss = 2.284180, test loss = 2.284850
  Training set accuracy = 0.217000, Test set accuracy = 0.219600
 epoch 10/30. Took 0.047091 seconds. 
  Full-batch training loss = 2.281130, test loss = 2.281942
  Training set accuracy = 0.224500, Test set accuracy = 0.226900
 epoch 11/30. Took 0.045929 seconds. 
  Full-batch training loss = 2.278065, test loss = 2.279027
  Training set accuracy = 0.230000, Test set accuracy = 0.235900
 epoch 12/30. Took 0.049941 seconds. 
  Full-batch training loss = 2.275002, test loss = 2.276118
  Training set accuracy = 0.238500, Test set accuracy = 0.245200
 epoch 13/30. Took 0.048855 seconds. 
  Full-batch training loss = 2.272027, test loss = 2.273280
  Training set accuracy = 0.248000, Test set accuracy = 0.251200
 epoch 14/30. Took 0.048805 seconds. 
  Full-batch training loss = 2.268900, test loss = 2.270318
  Training set accuracy = 0.259500, Test set accuracy = 0.258200
 epoch 15/30. Took 0.047093 seconds. 
  Full-batch training loss = 2.265751, test loss = 2.267314
  Training set accuracy = 0.269000, Test set accuracy = 0.265700
 epoch 16/30. Took 0.049298 seconds. 
  Full-batch training loss = 2.262539, test loss = 2.264265
  Training set accuracy = 0.277000, Test set accuracy = 0.273600
 epoch 17/30. Took 0.04969 seconds. 
  Full-batch training loss = 2.259301, test loss = 2.261189
  Training set accuracy = 0.287500, Test set accuracy = 0.282800
 epoch 18/30. Took 0.049329 seconds. 
  Full-batch training loss = 2.255968, test loss = 2.258070
  Training set accuracy = 0.291500, Test set accuracy = 0.287200
 epoch 19/30. Took 0.04892 seconds. 
  Full-batch training loss = 2.252530, test loss = 2.254838
  Training set accuracy = 0.299500, Test set accuracy = 0.293700
 epoch 20/30. Took 0.048836 seconds. 
  Full-batch training loss = 2.248959, test loss = 2.251474
  Training set accuracy = 0.304000, Test set accuracy = 0.299300
 epoch 21/30. Took 0.05016 seconds. 
  Full-batch training loss = 2.245544, test loss = 2.248221
  Training set accuracy = 0.313500, Test set accuracy = 0.306600
 epoch 22/30. Took 0.049893 seconds. 
  Full-batch training loss = 2.241908, test loss = 2.244788
  Training set accuracy = 0.325000, Test set accuracy = 0.314600
 epoch 23/30. Took 0.04638 seconds. 
  Full-batch training loss = 2.238281, test loss = 2.241361
  Training set accuracy = 0.330500, Test set accuracy = 0.321600
 epoch 24/30. Took 0.048823 seconds. 
  Full-batch training loss = 2.234349, test loss = 2.237663
  Training set accuracy = 0.340000, Test set accuracy = 0.329900
 epoch 25/30. Took 0.049682 seconds. 
  Full-batch training loss = 2.230449, test loss = 2.233974
  Training set accuracy = 0.348500, Test set accuracy = 0.337400
 epoch 26/30. Took 0.049075 seconds. 
  Full-batch training loss = 2.226441, test loss = 2.230182
  Training set accuracy = 0.358500, Test set accuracy = 0.345500
 epoch 27/30. Took 0.049276 seconds. 
  Full-batch training loss = 2.222311, test loss = 2.226297
  Training set accuracy = 0.364500, Test set accuracy = 0.352600
 epoch 28/30. Took 0.049315 seconds. 
  Full-batch training loss = 2.217956, test loss = 2.222157
  Training set accuracy = 0.370000, Test set accuracy = 0.357800
 epoch 29/30. Took 0.04821 seconds. 
  Full-batch training loss = 2.213684, test loss = 2.218094
  Training set accuracy = 0.376500, Test set accuracy = 0.362500
 epoch 30/30. Took 0.049137 seconds. 
  Full-batch training loss = 2.209230, test loss = 2.213877
  Training set accuracy = 0.383500, Test set accuracy = 0.369700
Elapsed time is 5.523661 seconds.
End Training
-----
Params 2000 0.001 0.40 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.090418 seconds. 
  Full-batch training loss = 2.299785, test loss = 2.304509
  Training set accuracy = 0.085500, Test set accuracy = 0.076000
 epoch 2/30. Took 0.085688 seconds. 
  Full-batch training loss = 2.296499, test loss = 2.301190
  Training set accuracy = 0.090000, Test set accuracy = 0.081200
 epoch 3/30. Took 0.086228 seconds. 
  Full-batch training loss = 2.293265, test loss = 2.297912
  Training set accuracy = 0.098500, Test set accuracy = 0.086400
 epoch 4/30. Took 0.091141 seconds. 
  Full-batch training loss = 2.290067, test loss = 2.294682
  Training set accuracy = 0.105000, Test set accuracy = 0.092300
 epoch 5/30. Took 0.085828 seconds. 
  Full-batch training loss = 2.286885, test loss = 2.291467
  Training set accuracy = 0.111500, Test set accuracy = 0.099200
 epoch 6/30. Took 0.086928 seconds. 
  Full-batch training loss = 2.283700, test loss = 2.288283
  Training set accuracy = 0.116500, Test set accuracy = 0.105500
 epoch 7/30. Took 0.087297 seconds. 
  Full-batch training loss = 2.280568, test loss = 2.285138
  Training set accuracy = 0.125500, Test set accuracy = 0.113700
 epoch 8/30. Took 0.086771 seconds. 
  Full-batch training loss = 2.277321, test loss = 2.281888
  Training set accuracy = 0.138000, Test set accuracy = 0.121600
 epoch 9/30. Took 0.086621 seconds. 
  Full-batch training loss = 2.274114, test loss = 2.278686
  Training set accuracy = 0.148500, Test set accuracy = 0.130400
 epoch 10/30. Took 0.089349 seconds. 
  Full-batch training loss = 2.270842, test loss = 2.275380
  Training set accuracy = 0.158000, Test set accuracy = 0.142500
 epoch 11/30. Took 0.086012 seconds. 
  Full-batch training loss = 2.267608, test loss = 2.272148
  Training set accuracy = 0.169500, Test set accuracy = 0.152300
 epoch 12/30. Took 0.084407 seconds. 
  Full-batch training loss = 2.264265, test loss = 2.268781
  Training set accuracy = 0.184500, Test set accuracy = 0.164500
 epoch 13/30. Took 0.086139 seconds. 
  Full-batch training loss = 2.260846, test loss = 2.265339
  Training set accuracy = 0.196000, Test set accuracy = 0.178300
 epoch 14/30. Took 0.087258 seconds. 
  Full-batch training loss = 2.257367, test loss = 2.261852
  Training set accuracy = 0.209500, Test set accuracy = 0.193100
 epoch 15/30. Took 0.086674 seconds. 
  Full-batch training loss = 2.253867, test loss = 2.258331
  Training set accuracy = 0.227500, Test set accuracy = 0.205900
 epoch 16/30. Took 0.0886 seconds. 
  Full-batch training loss = 2.250321, test loss = 2.254753
  Training set accuracy = 0.242000, Test set accuracy = 0.221400
 epoch 17/30. Took 0.086448 seconds. 
  Full-batch training loss = 2.246686, test loss = 2.251073
  Training set accuracy = 0.253500, Test set accuracy = 0.237700
 epoch 18/30. Took 0.087255 seconds. 
  Full-batch training loss = 2.243043, test loss = 2.247406
  Training set accuracy = 0.270000, Test set accuracy = 0.253800
 epoch 19/30. Took 0.086993 seconds. 
  Full-batch training loss = 2.239285, test loss = 2.243611
  Training set accuracy = 0.288500, Test set accuracy = 0.269000
 epoch 20/30. Took 0.086839 seconds. 
  Full-batch training loss = 2.235464, test loss = 2.239745
  Training set accuracy = 0.304000, Test set accuracy = 0.281900
 epoch 21/30. Took 0.086865 seconds. 
  Full-batch training loss = 2.231511, test loss = 2.235787
  Training set accuracy = 0.322000, Test set accuracy = 0.294700
 epoch 22/30. Took 0.097731 seconds. 
  Full-batch training loss = 2.227460, test loss = 2.231690
  Training set accuracy = 0.333500, Test set accuracy = 0.303700
 epoch 23/30. Took 0.087705 seconds. 
  Full-batch training loss = 2.223337, test loss = 2.227530
  Training set accuracy = 0.340000, Test set accuracy = 0.312300
 epoch 24/30. Took 0.087439 seconds. 
  Full-batch training loss = 2.219104, test loss = 2.223289
  Training set accuracy = 0.345500, Test set accuracy = 0.319900
 epoch 25/30. Took 0.087406 seconds. 
  Full-batch training loss = 2.214749, test loss = 2.218905
  Training set accuracy = 0.350500, Test set accuracy = 0.327300
 epoch 26/30. Took 0.087362 seconds. 
  Full-batch training loss = 2.210286, test loss = 2.214428
  Training set accuracy = 0.359000, Test set accuracy = 0.336500
 epoch 27/30. Took 0.096644 seconds. 
  Full-batch training loss = 2.205722, test loss = 2.209813
  Training set accuracy = 0.366500, Test set accuracy = 0.343800
 epoch 28/30. Took 0.08223 seconds. 
  Full-batch training loss = 2.200952, test loss = 2.205018
  Training set accuracy = 0.374000, Test set accuracy = 0.354100
 epoch 29/30. Took 0.082585 seconds. 
  Full-batch training loss = 2.196222, test loss = 2.200273
  Training set accuracy = 0.380500, Test set accuracy = 0.362500
 epoch 30/30. Took 0.084304 seconds. 
  Full-batch training loss = 2.191299, test loss = 2.195316
  Training set accuracy = 0.387000, Test set accuracy = 0.371200
Elapsed time is 9.148118 seconds.
End Training
-----
Params 2000 0.001 0.40 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23787 seconds. 
  Full-batch training loss = 2.306758, test loss = 2.305480
  Training set accuracy = 0.091500, Test set accuracy = 0.103900
 epoch 2/30. Took 0.24962 seconds. 
  Full-batch training loss = 2.301846, test loss = 2.300802
  Training set accuracy = 0.103500, Test set accuracy = 0.114200
 epoch 3/30. Took 0.22982 seconds. 
  Full-batch training loss = 2.297036, test loss = 2.296224
  Training set accuracy = 0.112000, Test set accuracy = 0.127600
 epoch 4/30. Took 0.22837 seconds. 
  Full-batch training loss = 2.292250, test loss = 2.291662
  Training set accuracy = 0.130500, Test set accuracy = 0.145800
 epoch 5/30. Took 0.23012 seconds. 
  Full-batch training loss = 2.287466, test loss = 2.287125
  Training set accuracy = 0.161500, Test set accuracy = 0.169800
 epoch 6/30. Took 0.23035 seconds. 
  Full-batch training loss = 2.282728, test loss = 2.282630
  Training set accuracy = 0.208000, Test set accuracy = 0.202700
 epoch 7/30. Took 0.22509 seconds. 
  Full-batch training loss = 2.278002, test loss = 2.278153
  Training set accuracy = 0.253000, Test set accuracy = 0.244200
 epoch 8/30. Took 0.24394 seconds. 
  Full-batch training loss = 2.273288, test loss = 2.273647
  Training set accuracy = 0.303000, Test set accuracy = 0.290300
 epoch 9/30. Took 0.22531 seconds. 
  Full-batch training loss = 2.268582, test loss = 2.269192
  Training set accuracy = 0.353000, Test set accuracy = 0.342400
 epoch 10/30. Took 0.2247 seconds. 
  Full-batch training loss = 2.263897, test loss = 2.264702
  Training set accuracy = 0.390500, Test set accuracy = 0.380600
 epoch 11/30. Took 0.2296 seconds. 
  Full-batch training loss = 2.259141, test loss = 2.260177
  Training set accuracy = 0.428000, Test set accuracy = 0.418700
 epoch 12/30. Took 0.25248 seconds. 
  Full-batch training loss = 2.254358, test loss = 2.255641
  Training set accuracy = 0.449500, Test set accuracy = 0.453100
 epoch 13/30. Took 0.23761 seconds. 
  Full-batch training loss = 2.249619, test loss = 2.251110
  Training set accuracy = 0.474500, Test set accuracy = 0.480200
 epoch 14/30. Took 0.23176 seconds. 
  Full-batch training loss = 2.244796, test loss = 2.246498
  Training set accuracy = 0.497500, Test set accuracy = 0.500300
 epoch 15/30. Took 0.23047 seconds. 
  Full-batch training loss = 2.239921, test loss = 2.241853
  Training set accuracy = 0.511500, Test set accuracy = 0.515400
 epoch 16/30. Took 0.22524 seconds. 
  Full-batch training loss = 2.234990, test loss = 2.237095
  Training set accuracy = 0.524500, Test set accuracy = 0.530100
 epoch 17/30. Took 0.22942 seconds. 
  Full-batch training loss = 2.229910, test loss = 2.232276
  Training set accuracy = 0.537000, Test set accuracy = 0.537600
 epoch 18/30. Took 0.2465 seconds. 
  Full-batch training loss = 2.224939, test loss = 2.227462
  Training set accuracy = 0.549500, Test set accuracy = 0.546700
 epoch 19/30. Took 0.22615 seconds. 
  Full-batch training loss = 2.219775, test loss = 2.222495
  Training set accuracy = 0.558000, Test set accuracy = 0.555500
 epoch 20/30. Took 0.22605 seconds. 
  Full-batch training loss = 2.214573, test loss = 2.217471
  Training set accuracy = 0.570500, Test set accuracy = 0.563300
 epoch 21/30. Took 0.23009 seconds. 
  Full-batch training loss = 2.209275, test loss = 2.212379
  Training set accuracy = 0.574500, Test set accuracy = 0.568900
 epoch 22/30. Took 0.22889 seconds. 
  Full-batch training loss = 2.203832, test loss = 2.207157
  Training set accuracy = 0.579000, Test set accuracy = 0.572800
 epoch 23/30. Took 0.23095 seconds. 
  Full-batch training loss = 2.198307, test loss = 2.201826
  Training set accuracy = 0.583000, Test set accuracy = 0.577000
 epoch 24/30. Took 0.23061 seconds. 
  Full-batch training loss = 2.192677, test loss = 2.196346
  Training set accuracy = 0.591500, Test set accuracy = 0.579900
 epoch 25/30. Took 0.23064 seconds. 
  Full-batch training loss = 2.186942, test loss = 2.190851
  Training set accuracy = 0.594000, Test set accuracy = 0.581700
 epoch 26/30. Took 0.22839 seconds. 
  Full-batch training loss = 2.181004, test loss = 2.185073
  Training set accuracy = 0.600500, Test set accuracy = 0.586400
 epoch 27/30. Took 0.22472 seconds. 
  Full-batch training loss = 2.174969, test loss = 2.179284
  Training set accuracy = 0.606000, Test set accuracy = 0.588600
 epoch 28/30. Took 0.2307 seconds. 
  Full-batch training loss = 2.168777, test loss = 2.173236
  Training set accuracy = 0.611000, Test set accuracy = 0.591600
 epoch 29/30. Took 0.2518 seconds. 
  Full-batch training loss = 2.162511, test loss = 2.167172
  Training set accuracy = 0.613000, Test set accuracy = 0.591400
 epoch 30/30. Took 0.24832 seconds. 
  Full-batch training loss = 2.156085, test loss = 2.160926
  Training set accuracy = 0.614000, Test set accuracy = 0.592400
Elapsed time is 23.288056 seconds.
End Training
-----
Params 2000 0.001 0.40 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.070167 seconds. 
  Full-batch training loss = 2.311475, test loss = 2.308670
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 2/30. Took 0.05647 seconds. 
  Full-batch training loss = 2.310643, test loss = 2.307953
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 3/30. Took 0.06094 seconds. 
  Full-batch training loss = 2.309806, test loss = 2.307236
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 4/30. Took 0.059923 seconds. 
  Full-batch training loss = 2.308987, test loss = 2.306531
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 5/30. Took 0.059401 seconds. 
  Full-batch training loss = 2.308200, test loss = 2.305861
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 6/30. Took 0.059556 seconds. 
  Full-batch training loss = 2.307420, test loss = 2.305196
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 7/30. Took 0.061695 seconds. 
  Full-batch training loss = 2.306640, test loss = 2.304548
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 8/30. Took 0.060263 seconds. 
  Full-batch training loss = 2.305882, test loss = 2.303899
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 9/30. Took 0.059218 seconds. 
  Full-batch training loss = 2.305162, test loss = 2.303287
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 10/30. Took 0.057617 seconds. 
  Full-batch training loss = 2.304438, test loss = 2.302669
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 11/30. Took 0.055564 seconds. 
  Full-batch training loss = 2.303721, test loss = 2.302063
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 12/30. Took 0.06005 seconds. 
  Full-batch training loss = 2.303043, test loss = 2.301497
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 13/30. Took 0.059463 seconds. 
  Full-batch training loss = 2.302385, test loss = 2.300944
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 14/30. Took 0.05996 seconds. 
  Full-batch training loss = 2.301766, test loss = 2.300415
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 15/30. Took 0.059607 seconds. 
  Full-batch training loss = 2.301125, test loss = 2.299893
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 16/30. Took 0.060442 seconds. 
  Full-batch training loss = 2.300531, test loss = 2.299382
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 17/30. Took 0.059397 seconds. 
  Full-batch training loss = 2.299936, test loss = 2.298883
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 18/30. Took 0.060369 seconds. 
  Full-batch training loss = 2.299320, test loss = 2.298373
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 19/30. Took 0.059701 seconds. 
  Full-batch training loss = 2.298712, test loss = 2.297861
  Training set accuracy = 0.096500, Test set accuracy = 0.102700
 epoch 20/30. Took 0.060173 seconds. 
  Full-batch training loss = 2.298133, test loss = 2.297370
  Training set accuracy = 0.096500, Test set accuracy = 0.102700
 epoch 21/30. Took 0.059684 seconds. 
  Full-batch training loss = 2.297542, test loss = 2.296873
  Training set accuracy = 0.096500, Test set accuracy = 0.102700
 epoch 22/30. Took 0.059795 seconds. 
  Full-batch training loss = 2.296962, test loss = 2.296394
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 23/30. Took 0.059142 seconds. 
  Full-batch training loss = 2.296385, test loss = 2.295923
  Training set accuracy = 0.096500, Test set accuracy = 0.102800
 epoch 24/30. Took 0.058921 seconds. 
  Full-batch training loss = 2.295844, test loss = 2.295468
  Training set accuracy = 0.096500, Test set accuracy = 0.102900
 epoch 25/30. Took 0.059278 seconds. 
  Full-batch training loss = 2.295314, test loss = 2.295020
  Training set accuracy = 0.096500, Test set accuracy = 0.102900
 epoch 26/30. Took 0.070774 seconds. 
  Full-batch training loss = 2.294783, test loss = 2.294575
  Training set accuracy = 0.096500, Test set accuracy = 0.103000
 epoch 27/30. Took 0.058951 seconds. 
  Full-batch training loss = 2.294236, test loss = 2.294119
  Training set accuracy = 0.096500, Test set accuracy = 0.103200
 epoch 28/30. Took 0.059426 seconds. 
  Full-batch training loss = 2.293671, test loss = 2.293636
  Training set accuracy = 0.096500, Test set accuracy = 0.103100
 epoch 29/30. Took 0.059043 seconds. 
  Full-batch training loss = 2.293139, test loss = 2.293188
  Training set accuracy = 0.096500, Test set accuracy = 0.103200
 epoch 30/30. Took 0.060302 seconds. 
  Full-batch training loss = 2.292623, test loss = 2.292765
  Training set accuracy = 0.096500, Test set accuracy = 0.103200
Elapsed time is 6.407463 seconds.
End Training
-----
Params 2000 0.001 0.40 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11055 seconds. 
  Full-batch training loss = 2.303797, test loss = 2.304286
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 2/30. Took 0.10754 seconds. 
  Full-batch training loss = 2.302883, test loss = 2.303351
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 3/30. Took 0.11086 seconds. 
  Full-batch training loss = 2.301927, test loss = 2.302365
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 4/30. Took 0.10334 seconds. 
  Full-batch training loss = 2.301041, test loss = 2.301454
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 5/30. Took 0.10299 seconds. 
  Full-batch training loss = 2.300141, test loss = 2.300538
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 6/30. Took 0.11682 seconds. 
  Full-batch training loss = 2.299295, test loss = 2.299668
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 7/30. Took 0.10835 seconds. 
  Full-batch training loss = 2.298451, test loss = 2.298811
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 8/30. Took 0.10809 seconds. 
  Full-batch training loss = 2.297619, test loss = 2.297951
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 9/30. Took 0.10889 seconds. 
  Full-batch training loss = 2.296771, test loss = 2.297089
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 10/30. Took 0.10332 seconds. 
  Full-batch training loss = 2.295942, test loss = 2.296239
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 11/30. Took 0.10374 seconds. 
  Full-batch training loss = 2.295143, test loss = 2.295412
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 12/30. Took 0.10825 seconds. 
  Full-batch training loss = 2.294310, test loss = 2.294560
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 13/30. Took 0.11871 seconds. 
  Full-batch training loss = 2.293454, test loss = 2.293684
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 14/30. Took 0.10815 seconds. 
  Full-batch training loss = 2.292655, test loss = 2.292863
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 15/30. Took 0.10634 seconds. 
  Full-batch training loss = 2.291830, test loss = 2.292017
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 16/30. Took 0.10197 seconds. 
  Full-batch training loss = 2.291034, test loss = 2.291193
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 17/30. Took 0.10658 seconds. 
  Full-batch training loss = 2.290241, test loss = 2.290375
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 18/30. Took 0.10827 seconds. 
  Full-batch training loss = 2.289448, test loss = 2.289569
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 19/30. Took 0.11502 seconds. 
  Full-batch training loss = 2.288662, test loss = 2.288754
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 20/30. Took 0.10537 seconds. 
  Full-batch training loss = 2.287863, test loss = 2.287931
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 21/30. Took 0.10866 seconds. 
  Full-batch training loss = 2.287071, test loss = 2.287123
  Training set accuracy = 0.096500, Test set accuracy = 0.098200
 epoch 22/30. Took 0.10805 seconds. 
  Full-batch training loss = 2.286261, test loss = 2.286290
  Training set accuracy = 0.096500, Test set accuracy = 0.098300
 epoch 23/30. Took 0.10781 seconds. 
  Full-batch training loss = 2.285460, test loss = 2.285468
  Training set accuracy = 0.096500, Test set accuracy = 0.098300
 epoch 24/30. Took 0.10701 seconds. 
  Full-batch training loss = 2.284675, test loss = 2.284655
  Training set accuracy = 0.097000, Test set accuracy = 0.098400
 epoch 25/30. Took 0.10847 seconds. 
  Full-batch training loss = 2.283903, test loss = 2.283864
  Training set accuracy = 0.097000, Test set accuracy = 0.098800
 epoch 26/30. Took 0.10825 seconds. 
  Full-batch training loss = 2.283074, test loss = 2.283008
  Training set accuracy = 0.097500, Test set accuracy = 0.099800
 epoch 27/30. Took 0.10776 seconds. 
  Full-batch training loss = 2.282279, test loss = 2.282188
  Training set accuracy = 0.098000, Test set accuracy = 0.100800
 epoch 28/30. Took 0.11743 seconds. 
  Full-batch training loss = 2.281464, test loss = 2.281354
  Training set accuracy = 0.099000, Test set accuracy = 0.101700
 epoch 29/30. Took 0.1023 seconds. 
  Full-batch training loss = 2.280616, test loss = 2.280485
  Training set accuracy = 0.101000, Test set accuracy = 0.104600
 epoch 30/30. Took 0.10624 seconds. 
  Full-batch training loss = 2.279790, test loss = 2.279627
  Training set accuracy = 0.105000, Test set accuracy = 0.108100
Elapsed time is 10.928237 seconds.
End Training
-----
Params 2000 0.001 0.40 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.3243 seconds. 
  Full-batch training loss = 2.300881, test loss = 2.302371
  Training set accuracy = 0.124000, Test set accuracy = 0.124800
 epoch 2/30. Took 0.3236 seconds. 
  Full-batch training loss = 2.299965, test loss = 2.301484
  Training set accuracy = 0.129500, Test set accuracy = 0.130300
 epoch 3/30. Took 0.32258 seconds. 
  Full-batch training loss = 2.299018, test loss = 2.300603
  Training set accuracy = 0.134500, Test set accuracy = 0.130800
 epoch 4/30. Took 0.32071 seconds. 
  Full-batch training loss = 2.298116, test loss = 2.299721
  Training set accuracy = 0.140000, Test set accuracy = 0.133800
 epoch 5/30. Took 0.31982 seconds. 
  Full-batch training loss = 2.297193, test loss = 2.298854
  Training set accuracy = 0.143500, Test set accuracy = 0.133000
 epoch 6/30. Took 0.31924 seconds. 
  Full-batch training loss = 2.296304, test loss = 2.297998
  Training set accuracy = 0.146000, Test set accuracy = 0.133600
 epoch 7/30. Took 0.31901 seconds. 
  Full-batch training loss = 2.295390, test loss = 2.297128
  Training set accuracy = 0.141000, Test set accuracy = 0.130500
 epoch 8/30. Took 0.31825 seconds. 
  Full-batch training loss = 2.294504, test loss = 2.296276
  Training set accuracy = 0.140000, Test set accuracy = 0.127400
 epoch 9/30. Took 0.32122 seconds. 
  Full-batch training loss = 2.293602, test loss = 2.295422
  Training set accuracy = 0.136000, Test set accuracy = 0.123600
 epoch 10/30. Took 0.32164 seconds. 
  Full-batch training loss = 2.292739, test loss = 2.294577
  Training set accuracy = 0.134000, Test set accuracy = 0.121600
 epoch 11/30. Took 0.33736 seconds. 
  Full-batch training loss = 2.291834, test loss = 2.293714
  Training set accuracy = 0.129000, Test set accuracy = 0.119200
 epoch 12/30. Took 0.31939 seconds. 
  Full-batch training loss = 2.290944, test loss = 2.292870
  Training set accuracy = 0.129000, Test set accuracy = 0.116700
 epoch 13/30. Took 0.33621 seconds. 
  Full-batch training loss = 2.290063, test loss = 2.292014
  Training set accuracy = 0.128000, Test set accuracy = 0.115200
 epoch 14/30. Took 0.32188 seconds. 
  Full-batch training loss = 2.289188, test loss = 2.291169
  Training set accuracy = 0.128000, Test set accuracy = 0.115300
 epoch 15/30. Took 0.32447 seconds. 
  Full-batch training loss = 2.288268, test loss = 2.290272
  Training set accuracy = 0.127000, Test set accuracy = 0.115200
 epoch 16/30. Took 0.31865 seconds. 
  Full-batch training loss = 2.287370, test loss = 2.289419
  Training set accuracy = 0.125500, Test set accuracy = 0.112600
 epoch 17/30. Took 0.35789 seconds. 
  Full-batch training loss = 2.286489, test loss = 2.288574
  Training set accuracy = 0.125500, Test set accuracy = 0.111700
 epoch 18/30. Took 0.31802 seconds. 
  Full-batch training loss = 2.285595, test loss = 2.287697
  Training set accuracy = 0.129000, Test set accuracy = 0.112600
 epoch 19/30. Took 0.31994 seconds. 
  Full-batch training loss = 2.284688, test loss = 2.286813
  Training set accuracy = 0.129000, Test set accuracy = 0.113200
 epoch 20/30. Took 0.37273 seconds. 
  Full-batch training loss = 2.283794, test loss = 2.285953
  Training set accuracy = 0.128000, Test set accuracy = 0.112500
 epoch 21/30. Took 0.3186 seconds. 
  Full-batch training loss = 2.282909, test loss = 2.285102
  Training set accuracy = 0.130000, Test set accuracy = 0.113100
 epoch 22/30. Took 0.31986 seconds. 
  Full-batch training loss = 2.282000, test loss = 2.284220
  Training set accuracy = 0.131000, Test set accuracy = 0.113700
 epoch 23/30. Took 0.31855 seconds. 
  Full-batch training loss = 2.281101, test loss = 2.283339
  Training set accuracy = 0.132000, Test set accuracy = 0.114500
 epoch 24/30. Took 0.31865 seconds. 
  Full-batch training loss = 2.280166, test loss = 2.282428
  Training set accuracy = 0.131500, Test set accuracy = 0.115100
 epoch 25/30. Took 0.32204 seconds. 
  Full-batch training loss = 2.279268, test loss = 2.281544
  Training set accuracy = 0.132500, Test set accuracy = 0.117800
 epoch 26/30. Took 0.32395 seconds. 
  Full-batch training loss = 2.278362, test loss = 2.280675
  Training set accuracy = 0.131500, Test set accuracy = 0.118100
 epoch 27/30. Took 0.323 seconds. 
  Full-batch training loss = 2.277435, test loss = 2.279753
  Training set accuracy = 0.134500, Test set accuracy = 0.119700
 epoch 28/30. Took 0.3344 seconds. 
  Full-batch training loss = 2.276517, test loss = 2.278856
  Training set accuracy = 0.136000, Test set accuracy = 0.120900
 epoch 29/30. Took 0.31719 seconds. 
  Full-batch training loss = 2.275590, test loss = 2.277952
  Training set accuracy = 0.138500, Test set accuracy = 0.122500
 epoch 30/30. Took 0.31871 seconds. 
  Full-batch training loss = 2.274640, test loss = 2.277024
  Training set accuracy = 0.141500, Test set accuracy = 0.123000
Elapsed time is 31.674968 seconds.
End Training
-----
Params 2000 0.001 0.50 1 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.045032 seconds. 
  Full-batch training loss = 2.308745, test loss = 2.307327
  Training set accuracy = 0.078000, Test set accuracy = 0.071000
 epoch 2/30. Took 0.039397 seconds. 
  Full-batch training loss = 2.294296, test loss = 2.293401
  Training set accuracy = 0.095000, Test set accuracy = 0.090600
 epoch 3/30. Took 0.039448 seconds. 
  Full-batch training loss = 2.280175, test loss = 2.279810
  Training set accuracy = 0.118500, Test set accuracy = 0.113500
 epoch 4/30. Took 0.039368 seconds. 
  Full-batch training loss = 2.266206, test loss = 2.266337
  Training set accuracy = 0.140000, Test set accuracy = 0.139500
 epoch 5/30. Took 0.039458 seconds. 
  Full-batch training loss = 2.252298, test loss = 2.252948
  Training set accuracy = 0.167000, Test set accuracy = 0.163600
 epoch 6/30. Took 0.040978 seconds. 
  Full-batch training loss = 2.238481, test loss = 2.239571
  Training set accuracy = 0.196500, Test set accuracy = 0.190700
 epoch 7/30. Took 0.043282 seconds. 
  Full-batch training loss = 2.224599, test loss = 2.226109
  Training set accuracy = 0.228500, Test set accuracy = 0.221500
 epoch 8/30. Took 0.039228 seconds. 
  Full-batch training loss = 2.210904, test loss = 2.212817
  Training set accuracy = 0.269500, Test set accuracy = 0.259800
 epoch 9/30. Took 0.03904 seconds. 
  Full-batch training loss = 2.197239, test loss = 2.199479
  Training set accuracy = 0.310500, Test set accuracy = 0.302400
 epoch 10/30. Took 0.039251 seconds. 
  Full-batch training loss = 2.183644, test loss = 2.186204
  Training set accuracy = 0.346000, Test set accuracy = 0.342900
 epoch 11/30. Took 0.040136 seconds. 
  Full-batch training loss = 2.169845, test loss = 2.172691
  Training set accuracy = 0.387500, Test set accuracy = 0.376900
 epoch 12/30. Took 0.039045 seconds. 
  Full-batch training loss = 2.155800, test loss = 2.158877
  Training set accuracy = 0.416500, Test set accuracy = 0.410000
 epoch 13/30. Took 0.039178 seconds. 
  Full-batch training loss = 2.141600, test loss = 2.144918
  Training set accuracy = 0.443500, Test set accuracy = 0.437700
 epoch 14/30. Took 0.03967 seconds. 
  Full-batch training loss = 2.127360, test loss = 2.130902
  Training set accuracy = 0.474000, Test set accuracy = 0.461500
 epoch 15/30. Took 0.03924 seconds. 
  Full-batch training loss = 2.112689, test loss = 2.116444
  Training set accuracy = 0.501500, Test set accuracy = 0.485600
 epoch 16/30. Took 0.039975 seconds. 
  Full-batch training loss = 2.098025, test loss = 2.101963
  Training set accuracy = 0.523000, Test set accuracy = 0.504700
 epoch 17/30. Took 0.039732 seconds. 
  Full-batch training loss = 2.083041, test loss = 2.087096
  Training set accuracy = 0.537000, Test set accuracy = 0.521300
 epoch 18/30. Took 0.039868 seconds. 
  Full-batch training loss = 2.067806, test loss = 2.072018
  Training set accuracy = 0.551500, Test set accuracy = 0.536200
 epoch 19/30. Took 0.039428 seconds. 
  Full-batch training loss = 2.052419, test loss = 2.056838
  Training set accuracy = 0.565000, Test set accuracy = 0.547700
 epoch 20/30. Took 0.0423 seconds. 
  Full-batch training loss = 2.036734, test loss = 2.041309
  Training set accuracy = 0.577500, Test set accuracy = 0.557700
 epoch 21/30. Took 0.041448 seconds. 
  Full-batch training loss = 2.021355, test loss = 2.026029
  Training set accuracy = 0.586500, Test set accuracy = 0.570800
 epoch 22/30. Took 0.040023 seconds. 
  Full-batch training loss = 2.005851, test loss = 2.010751
  Training set accuracy = 0.592000, Test set accuracy = 0.577500
 epoch 23/30. Took 0.041534 seconds. 
  Full-batch training loss = 1.989810, test loss = 1.994850
  Training set accuracy = 0.599500, Test set accuracy = 0.585800
 epoch 24/30. Took 0.039794 seconds. 
  Full-batch training loss = 1.973918, test loss = 1.979160
  Training set accuracy = 0.608500, Test set accuracy = 0.593400
 epoch 25/30. Took 0.037406 seconds. 
  Full-batch training loss = 1.957871, test loss = 1.963241
  Training set accuracy = 0.612000, Test set accuracy = 0.598800
 epoch 26/30. Took 0.039638 seconds. 
  Full-batch training loss = 1.941435, test loss = 1.946965
  Training set accuracy = 0.616500, Test set accuracy = 0.603300
 epoch 27/30. Took 0.039806 seconds. 
  Full-batch training loss = 1.925394, test loss = 1.931075
  Training set accuracy = 0.623000, Test set accuracy = 0.607500
 epoch 28/30. Took 0.03921 seconds. 
  Full-batch training loss = 1.908866, test loss = 1.914721
  Training set accuracy = 0.624000, Test set accuracy = 0.611600
 epoch 29/30. Took 0.039417 seconds. 
  Full-batch training loss = 1.892479, test loss = 1.898581
  Training set accuracy = 0.626500, Test set accuracy = 0.616700
 epoch 30/30. Took 0.039253 seconds. 
  Full-batch training loss = 1.875923, test loss = 1.882262
  Training set accuracy = 0.628000, Test set accuracy = 0.619600
Elapsed time is 4.821837 seconds.
End Training
-----
Params 2000 0.001 0.50 1 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.075471 seconds. 
  Full-batch training loss = 2.285969, test loss = 2.286726
  Training set accuracy = 0.124000, Test set accuracy = 0.123700
 epoch 2/30. Took 0.061524 seconds. 
  Full-batch training loss = 2.270831, test loss = 2.272069
  Training set accuracy = 0.148500, Test set accuracy = 0.147500
 epoch 3/30. Took 0.06285 seconds. 
  Full-batch training loss = 2.255745, test loss = 2.257462
  Training set accuracy = 0.172500, Test set accuracy = 0.173500
 epoch 4/30. Took 0.063723 seconds. 
  Full-batch training loss = 2.240721, test loss = 2.242978
  Training set accuracy = 0.195500, Test set accuracy = 0.203700
 epoch 5/30. Took 0.062952 seconds. 
  Full-batch training loss = 2.225957, test loss = 2.228726
  Training set accuracy = 0.233000, Test set accuracy = 0.240800
 epoch 6/30. Took 0.063328 seconds. 
  Full-batch training loss = 2.211240, test loss = 2.214470
  Training set accuracy = 0.270500, Test set accuracy = 0.276800
 epoch 7/30. Took 0.06943 seconds. 
  Full-batch training loss = 2.196612, test loss = 2.200273
  Training set accuracy = 0.306000, Test set accuracy = 0.311500
 epoch 8/30. Took 0.063284 seconds. 
  Full-batch training loss = 2.181956, test loss = 2.186045
  Training set accuracy = 0.353000, Test set accuracy = 0.353000
 epoch 9/30. Took 0.063354 seconds. 
  Full-batch training loss = 2.167117, test loss = 2.171539
  Training set accuracy = 0.393000, Test set accuracy = 0.395500
 epoch 10/30. Took 0.065363 seconds. 
  Full-batch training loss = 2.152109, test loss = 2.157021
  Training set accuracy = 0.431000, Test set accuracy = 0.430300
 epoch 11/30. Took 0.062793 seconds. 
  Full-batch training loss = 2.136936, test loss = 2.142264
  Training set accuracy = 0.465000, Test set accuracy = 0.459100
 epoch 12/30. Took 0.064699 seconds. 
  Full-batch training loss = 2.121616, test loss = 2.127243
  Training set accuracy = 0.495500, Test set accuracy = 0.488900
 epoch 13/30. Took 0.063443 seconds. 
  Full-batch training loss = 2.106094, test loss = 2.112129
  Training set accuracy = 0.525500, Test set accuracy = 0.512400
 epoch 14/30. Took 0.063001 seconds. 
  Full-batch training loss = 2.090456, test loss = 2.096840
  Training set accuracy = 0.550500, Test set accuracy = 0.536200
 epoch 15/30. Took 0.062795 seconds. 
  Full-batch training loss = 2.074621, test loss = 2.081345
  Training set accuracy = 0.572500, Test set accuracy = 0.557900
 epoch 16/30. Took 0.063365 seconds. 
  Full-batch training loss = 2.058782, test loss = 2.065750
  Training set accuracy = 0.590000, Test set accuracy = 0.578700
 epoch 17/30. Took 0.063317 seconds. 
  Full-batch training loss = 2.042728, test loss = 2.050047
  Training set accuracy = 0.599000, Test set accuracy = 0.591800
 epoch 18/30. Took 0.063094 seconds. 
  Full-batch training loss = 2.026644, test loss = 2.034181
  Training set accuracy = 0.613000, Test set accuracy = 0.606500
 epoch 19/30. Took 0.063593 seconds. 
  Full-batch training loss = 2.010269, test loss = 2.018099
  Training set accuracy = 0.618500, Test set accuracy = 0.615300
 epoch 20/30. Took 0.06342 seconds. 
  Full-batch training loss = 1.993800, test loss = 2.001890
  Training set accuracy = 0.633000, Test set accuracy = 0.626000
 epoch 21/30. Took 0.062928 seconds. 
  Full-batch training loss = 1.977284, test loss = 1.985630
  Training set accuracy = 0.641000, Test set accuracy = 0.635800
 epoch 22/30. Took 0.063136 seconds. 
  Full-batch training loss = 1.960433, test loss = 1.968969
  Training set accuracy = 0.646500, Test set accuracy = 0.646400
 epoch 23/30. Took 0.063234 seconds. 
  Full-batch training loss = 1.943679, test loss = 1.952407
  Training set accuracy = 0.656000, Test set accuracy = 0.655100
 epoch 24/30. Took 0.062798 seconds. 
  Full-batch training loss = 1.926768, test loss = 1.935726
  Training set accuracy = 0.665500, Test set accuracy = 0.658500
 epoch 25/30. Took 0.063427 seconds. 
  Full-batch training loss = 1.909671, test loss = 1.918816
  Training set accuracy = 0.675000, Test set accuracy = 0.666400
 epoch 26/30. Took 0.063565 seconds. 
  Full-batch training loss = 1.892567, test loss = 1.901957
  Training set accuracy = 0.681500, Test set accuracy = 0.671600
 epoch 27/30. Took 0.06323 seconds. 
  Full-batch training loss = 1.875281, test loss = 1.884886
  Training set accuracy = 0.684500, Test set accuracy = 0.677200
 epoch 28/30. Took 0.06312 seconds. 
  Full-batch training loss = 1.857686, test loss = 1.867538
  Training set accuracy = 0.691500, Test set accuracy = 0.681400
 epoch 29/30. Took 0.063489 seconds. 
  Full-batch training loss = 1.840436, test loss = 1.850404
  Training set accuracy = 0.697500, Test set accuracy = 0.686000
 epoch 30/30. Took 0.063473 seconds. 
  Full-batch training loss = 1.823030, test loss = 1.833257
  Training set accuracy = 0.702000, Test set accuracy = 0.689400
Elapsed time is 6.937566 seconds.
End Training
-----
Params 2000 0.001 0.50 1 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14035 seconds. 
  Full-batch training loss = 2.281179, test loss = 2.282779
  Training set accuracy = 0.165000, Test set accuracy = 0.168400
 epoch 2/30. Took 0.14862 seconds. 
  Full-batch training loss = 2.262597, test loss = 2.264877
  Training set accuracy = 0.185000, Test set accuracy = 0.186200
 epoch 3/30. Took 0.13589 seconds. 
  Full-batch training loss = 2.244158, test loss = 2.247189
  Training set accuracy = 0.208500, Test set accuracy = 0.206700
 epoch 4/30. Took 0.13583 seconds. 
  Full-batch training loss = 2.226104, test loss = 2.229806
  Training set accuracy = 0.249000, Test set accuracy = 0.240900
 epoch 5/30. Took 0.13663 seconds. 
  Full-batch training loss = 2.208226, test loss = 2.212605
  Training set accuracy = 0.293000, Test set accuracy = 0.277900
 epoch 6/30. Took 0.13638 seconds. 
  Full-batch training loss = 2.190427, test loss = 2.195495
  Training set accuracy = 0.341000, Test set accuracy = 0.322700
 epoch 7/30. Took 0.13506 seconds. 
  Full-batch training loss = 2.172760, test loss = 2.178420
  Training set accuracy = 0.379500, Test set accuracy = 0.361700
 epoch 8/30. Took 0.13561 seconds. 
  Full-batch training loss = 2.154863, test loss = 2.161230
  Training set accuracy = 0.425500, Test set accuracy = 0.402100
 epoch 9/30. Took 0.13506 seconds. 
  Full-batch training loss = 2.137019, test loss = 2.144024
  Training set accuracy = 0.462500, Test set accuracy = 0.439700
 epoch 10/30. Took 0.13358 seconds. 
  Full-batch training loss = 2.119175, test loss = 2.126774
  Training set accuracy = 0.497500, Test set accuracy = 0.474800
 epoch 11/30. Took 0.14368 seconds. 
  Full-batch training loss = 2.101334, test loss = 2.109567
  Training set accuracy = 0.526500, Test set accuracy = 0.503700
 epoch 12/30. Took 0.13661 seconds. 
  Full-batch training loss = 2.083242, test loss = 2.092128
  Training set accuracy = 0.555000, Test set accuracy = 0.533200
 epoch 13/30. Took 0.13461 seconds. 
  Full-batch training loss = 2.065210, test loss = 2.074641
  Training set accuracy = 0.578000, Test set accuracy = 0.559400
 epoch 14/30. Took 0.13577 seconds. 
  Full-batch training loss = 2.047046, test loss = 2.057020
  Training set accuracy = 0.594500, Test set accuracy = 0.583400
 epoch 15/30. Took 0.13727 seconds. 
  Full-batch training loss = 2.028661, test loss = 2.039182
  Training set accuracy = 0.619500, Test set accuracy = 0.606500
 epoch 16/30. Took 0.1378 seconds. 
  Full-batch training loss = 2.010013, test loss = 2.021193
  Training set accuracy = 0.640500, Test set accuracy = 0.622500
 epoch 17/30. Took 0.1414 seconds. 
  Full-batch training loss = 1.991216, test loss = 2.002914
  Training set accuracy = 0.653500, Test set accuracy = 0.634300
 epoch 18/30. Took 0.14578 seconds. 
  Full-batch training loss = 1.972028, test loss = 1.984292
  Training set accuracy = 0.667500, Test set accuracy = 0.648500
 epoch 19/30. Took 0.13639 seconds. 
  Full-batch training loss = 1.952867, test loss = 1.965720
  Training set accuracy = 0.678000, Test set accuracy = 0.659700
 epoch 20/30. Took 0.13542 seconds. 
  Full-batch training loss = 1.933693, test loss = 1.947121
  Training set accuracy = 0.690000, Test set accuracy = 0.667500
 epoch 21/30. Took 0.13591 seconds. 
  Full-batch training loss = 1.914134, test loss = 1.928151
  Training set accuracy = 0.700000, Test set accuracy = 0.681100
 epoch 22/30. Took 0.14036 seconds. 
  Full-batch training loss = 1.894199, test loss = 1.908674
  Training set accuracy = 0.708500, Test set accuracy = 0.691500
 epoch 23/30. Took 0.13522 seconds. 
  Full-batch training loss = 1.874478, test loss = 1.889610
  Training set accuracy = 0.719000, Test set accuracy = 0.699400
 epoch 24/30. Took 0.13514 seconds. 
  Full-batch training loss = 1.854233, test loss = 1.869868
  Training set accuracy = 0.729000, Test set accuracy = 0.704200
 epoch 25/30. Took 0.13239 seconds. 
  Full-batch training loss = 1.834106, test loss = 1.850344
  Training set accuracy = 0.737000, Test set accuracy = 0.712000
 epoch 26/30. Took 0.13639 seconds. 
  Full-batch training loss = 1.813796, test loss = 1.830590
  Training set accuracy = 0.741500, Test set accuracy = 0.717800
 epoch 27/30. Took 0.15194 seconds. 
  Full-batch training loss = 1.793622, test loss = 1.810837
  Training set accuracy = 0.745500, Test set accuracy = 0.723000
 epoch 28/30. Took 0.13581 seconds. 
  Full-batch training loss = 1.773217, test loss = 1.790987
  Training set accuracy = 0.751000, Test set accuracy = 0.729700
 epoch 29/30. Took 0.13627 seconds. 
  Full-batch training loss = 1.752637, test loss = 1.770931
  Training set accuracy = 0.754000, Test set accuracy = 0.731500
 epoch 30/30. Took 0.13575 seconds. 
  Full-batch training loss = 1.732123, test loss = 1.750847
  Training set accuracy = 0.757000, Test set accuracy = 0.736000
Elapsed time is 14.168721 seconds.
End Training
-----
Params 2000 0.001 0.50 2 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.052199 seconds. 
  Full-batch training loss = 2.313724, test loss = 2.310785
  Training set accuracy = 0.090500, Test set accuracy = 0.092600
 epoch 2/30. Took 0.050029 seconds. 
  Full-batch training loss = 2.311823, test loss = 2.309018
  Training set accuracy = 0.092000, Test set accuracy = 0.092900
 epoch 3/30. Took 0.049315 seconds. 
  Full-batch training loss = 2.309951, test loss = 2.307276
  Training set accuracy = 0.093000, Test set accuracy = 0.093400
 epoch 4/30. Took 0.047076 seconds. 
  Full-batch training loss = 2.308062, test loss = 2.305500
  Training set accuracy = 0.094000, Test set accuracy = 0.093700
 epoch 5/30. Took 0.049599 seconds. 
  Full-batch training loss = 2.306221, test loss = 2.303781
  Training set accuracy = 0.094000, Test set accuracy = 0.094400
 epoch 6/30. Took 0.049468 seconds. 
  Full-batch training loss = 2.304392, test loss = 2.302070
  Training set accuracy = 0.095000, Test set accuracy = 0.094900
 epoch 7/30. Took 0.048483 seconds. 
  Full-batch training loss = 2.302622, test loss = 2.300431
  Training set accuracy = 0.095000, Test set accuracy = 0.095300
 epoch 8/30. Took 0.046831 seconds. 
  Full-batch training loss = 2.300851, test loss = 2.298785
  Training set accuracy = 0.095500, Test set accuracy = 0.095800
 epoch 9/30. Took 0.050364 seconds. 
  Full-batch training loss = 2.299186, test loss = 2.297226
  Training set accuracy = 0.096000, Test set accuracy = 0.096500
 epoch 10/30. Took 0.047064 seconds. 
  Full-batch training loss = 2.297521, test loss = 2.295679
  Training set accuracy = 0.096500, Test set accuracy = 0.097100
 epoch 11/30. Took 0.049624 seconds. 
  Full-batch training loss = 2.295781, test loss = 2.294064
  Training set accuracy = 0.097500, Test set accuracy = 0.098400
 epoch 12/30. Took 0.048025 seconds. 
  Full-batch training loss = 2.294094, test loss = 2.292489
  Training set accuracy = 0.095500, Test set accuracy = 0.097800
 epoch 13/30. Took 0.049104 seconds. 
  Full-batch training loss = 2.292416, test loss = 2.290918
  Training set accuracy = 0.097500, Test set accuracy = 0.098400
 epoch 14/30. Took 0.049775 seconds. 
  Full-batch training loss = 2.290781, test loss = 2.289388
  Training set accuracy = 0.097500, Test set accuracy = 0.099100
 epoch 15/30. Took 0.047979 seconds. 
  Full-batch training loss = 2.289141, test loss = 2.287849
  Training set accuracy = 0.099500, Test set accuracy = 0.099700
 epoch 16/30. Took 0.048767 seconds. 
  Full-batch training loss = 2.287437, test loss = 2.286269
  Training set accuracy = 0.102500, Test set accuracy = 0.101400
 epoch 17/30. Took 0.046845 seconds. 
  Full-batch training loss = 2.285768, test loss = 2.284703
  Training set accuracy = 0.107000, Test set accuracy = 0.103100
 epoch 18/30. Took 0.046761 seconds. 
  Full-batch training loss = 2.284130, test loss = 2.283142
  Training set accuracy = 0.112500, Test set accuracy = 0.108600
 epoch 19/30. Took 0.047393 seconds. 
  Full-batch training loss = 2.282432, test loss = 2.281543
  Training set accuracy = 0.117500, Test set accuracy = 0.117600
 epoch 20/30. Took 0.04953 seconds. 
  Full-batch training loss = 2.280706, test loss = 2.279920
  Training set accuracy = 0.125500, Test set accuracy = 0.131300
 epoch 21/30. Took 0.049825 seconds. 
  Full-batch training loss = 2.279029, test loss = 2.278354
  Training set accuracy = 0.143500, Test set accuracy = 0.145400
 epoch 22/30. Took 0.050861 seconds. 
  Full-batch training loss = 2.277316, test loss = 2.276733
  Training set accuracy = 0.163500, Test set accuracy = 0.160100
 epoch 23/30. Took 0.050896 seconds. 
  Full-batch training loss = 2.275565, test loss = 2.275060
  Training set accuracy = 0.178500, Test set accuracy = 0.174000
 epoch 24/30. Took 0.053961 seconds. 
  Full-batch training loss = 2.273850, test loss = 2.273443
  Training set accuracy = 0.192500, Test set accuracy = 0.189800
 epoch 25/30. Took 0.049992 seconds. 
  Full-batch training loss = 2.272185, test loss = 2.271874
  Training set accuracy = 0.204000, Test set accuracy = 0.200900
 epoch 26/30. Took 0.049736 seconds. 
  Full-batch training loss = 2.270434, test loss = 2.270211
  Training set accuracy = 0.211500, Test set accuracy = 0.210700
 epoch 27/30. Took 0.049331 seconds. 
  Full-batch training loss = 2.268751, test loss = 2.268613
  Training set accuracy = 0.220000, Test set accuracy = 0.219200
 epoch 28/30. Took 0.04971 seconds. 
  Full-batch training loss = 2.266960, test loss = 2.266914
  Training set accuracy = 0.226500, Test set accuracy = 0.226100
 epoch 29/30. Took 0.050617 seconds. 
  Full-batch training loss = 2.265212, test loss = 2.265260
  Training set accuracy = 0.232000, Test set accuracy = 0.230300
 epoch 30/30. Took 0.05111 seconds. 
  Full-batch training loss = 2.263441, test loss = 2.263559
  Training set accuracy = 0.237000, Test set accuracy = 0.237000
Elapsed time is 5.527350 seconds.
End Training
-----
Params 2000 0.001 0.50 2 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.089441 seconds. 
  Full-batch training loss = 2.308604, test loss = 2.308685
  Training set accuracy = 0.098500, Test set accuracy = 0.097100
 epoch 2/30. Took 0.085874 seconds. 
  Full-batch training loss = 2.307192, test loss = 2.307282
  Training set accuracy = 0.103000, Test set accuracy = 0.100500
 epoch 3/30. Took 0.08723 seconds. 
  Full-batch training loss = 2.305806, test loss = 2.305928
  Training set accuracy = 0.105500, Test set accuracy = 0.102800
 epoch 4/30. Took 0.085101 seconds. 
  Full-batch training loss = 2.304439, test loss = 2.304566
  Training set accuracy = 0.108500, Test set accuracy = 0.105400
 epoch 5/30. Took 0.087516 seconds. 
  Full-batch training loss = 2.303088, test loss = 2.303251
  Training set accuracy = 0.113000, Test set accuracy = 0.109900
 epoch 6/30. Took 0.093659 seconds. 
  Full-batch training loss = 2.301728, test loss = 2.301911
  Training set accuracy = 0.114500, Test set accuracy = 0.112400
 epoch 7/30. Took 0.089275 seconds. 
  Full-batch training loss = 2.300337, test loss = 2.300550
  Training set accuracy = 0.116000, Test set accuracy = 0.115900
 epoch 8/30. Took 0.085574 seconds. 
  Full-batch training loss = 2.299041, test loss = 2.299261
  Training set accuracy = 0.121000, Test set accuracy = 0.119700
 epoch 9/30. Took 0.088079 seconds. 
  Full-batch training loss = 2.297682, test loss = 2.297924
  Training set accuracy = 0.124000, Test set accuracy = 0.122800
 epoch 10/30. Took 0.087516 seconds. 
  Full-batch training loss = 2.296339, test loss = 2.296600
  Training set accuracy = 0.129500, Test set accuracy = 0.126300
 epoch 11/30. Took 0.087435 seconds. 
  Full-batch training loss = 2.295002, test loss = 2.295273
  Training set accuracy = 0.132500, Test set accuracy = 0.129000
 epoch 12/30. Took 0.086949 seconds. 
  Full-batch training loss = 2.293693, test loss = 2.293982
  Training set accuracy = 0.133500, Test set accuracy = 0.132500
 epoch 13/30. Took 0.087163 seconds. 
  Full-batch training loss = 2.292389, test loss = 2.292695
  Training set accuracy = 0.136000, Test set accuracy = 0.136700
 epoch 14/30. Took 0.087035 seconds. 
  Full-batch training loss = 2.291046, test loss = 2.291360
  Training set accuracy = 0.135500, Test set accuracy = 0.139400
 epoch 15/30. Took 0.086967 seconds. 
  Full-batch training loss = 2.289770, test loss = 2.290077
  Training set accuracy = 0.139500, Test set accuracy = 0.143000
 epoch 16/30. Took 0.099656 seconds. 
  Full-batch training loss = 2.288457, test loss = 2.288758
  Training set accuracy = 0.141000, Test set accuracy = 0.145500
 epoch 17/30. Took 0.086127 seconds. 
  Full-batch training loss = 2.287093, test loss = 2.287408
  Training set accuracy = 0.145000, Test set accuracy = 0.147300
 epoch 18/30. Took 0.08612 seconds. 
  Full-batch training loss = 2.285776, test loss = 2.286089
  Training set accuracy = 0.147500, Test set accuracy = 0.152000
 epoch 19/30. Took 0.086285 seconds. 
  Full-batch training loss = 2.284472, test loss = 2.284787
  Training set accuracy = 0.150500, Test set accuracy = 0.155700
 epoch 20/30. Took 0.087344 seconds. 
  Full-batch training loss = 2.283166, test loss = 2.283484
  Training set accuracy = 0.156000, Test set accuracy = 0.160500
 epoch 21/30. Took 0.087299 seconds. 
  Full-batch training loss = 2.281803, test loss = 2.282117
  Training set accuracy = 0.159500, Test set accuracy = 0.164900
 epoch 22/30. Took 0.087199 seconds. 
  Full-batch training loss = 2.280454, test loss = 2.280767
  Training set accuracy = 0.166000, Test set accuracy = 0.170400
 epoch 23/30. Took 0.087598 seconds. 
  Full-batch training loss = 2.279087, test loss = 2.279392
  Training set accuracy = 0.176000, Test set accuracy = 0.176300
 epoch 24/30. Took 0.087314 seconds. 
  Full-batch training loss = 2.277744, test loss = 2.278053
  Training set accuracy = 0.184500, Test set accuracy = 0.181300
 epoch 25/30. Took 0.087442 seconds. 
  Full-batch training loss = 2.276351, test loss = 2.276651
  Training set accuracy = 0.188500, Test set accuracy = 0.187100
 epoch 26/30. Took 0.087653 seconds. 
  Full-batch training loss = 2.274963, test loss = 2.275266
  Training set accuracy = 0.200500, Test set accuracy = 0.198400
 epoch 27/30. Took 0.086845 seconds. 
  Full-batch training loss = 2.273571, test loss = 2.273871
  Training set accuracy = 0.213000, Test set accuracy = 0.209400
 epoch 28/30. Took 0.086866 seconds. 
  Full-batch training loss = 2.272134, test loss = 2.272427
  Training set accuracy = 0.230500, Test set accuracy = 0.222700
 epoch 29/30. Took 0.088592 seconds. 
  Full-batch training loss = 2.270716, test loss = 2.270990
  Training set accuracy = 0.247000, Test set accuracy = 0.236500
 epoch 30/30. Took 0.0871 seconds. 
  Full-batch training loss = 2.269272, test loss = 2.269536
  Training set accuracy = 0.266000, Test set accuracy = 0.250500
Elapsed time is 9.141583 seconds.
End Training
-----
Params 2000 0.001 0.50 2 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23288 seconds. 
  Full-batch training loss = 2.305170, test loss = 2.305623
  Training set accuracy = 0.139500, Test set accuracy = 0.140400
 epoch 2/30. Took 0.22844 seconds. 
  Full-batch training loss = 2.302704, test loss = 2.303279
  Training set accuracy = 0.150500, Test set accuracy = 0.146600
 epoch 3/30. Took 0.25722 seconds. 
  Full-batch training loss = 2.300235, test loss = 2.300922
  Training set accuracy = 0.156500, Test set accuracy = 0.152400
 epoch 4/30. Took 0.23363 seconds. 
  Full-batch training loss = 2.297779, test loss = 2.298557
  Training set accuracy = 0.162500, Test set accuracy = 0.157200
 epoch 5/30. Took 0.2453 seconds. 
  Full-batch training loss = 2.295351, test loss = 2.296235
  Training set accuracy = 0.168000, Test set accuracy = 0.160500
 epoch 6/30. Took 0.23014 seconds. 
  Full-batch training loss = 2.292915, test loss = 2.293898
  Training set accuracy = 0.173000, Test set accuracy = 0.163900
 epoch 7/30. Took 0.23133 seconds. 
  Full-batch training loss = 2.290507, test loss = 2.291573
  Training set accuracy = 0.176500, Test set accuracy = 0.166600
 epoch 8/30. Took 0.24309 seconds. 
  Full-batch training loss = 2.288097, test loss = 2.289275
  Training set accuracy = 0.178500, Test set accuracy = 0.168200
 epoch 9/30. Took 0.22831 seconds. 
  Full-batch training loss = 2.285732, test loss = 2.287013
  Training set accuracy = 0.184000, Test set accuracy = 0.172500
 epoch 10/30. Took 0.23029 seconds. 
  Full-batch training loss = 2.283362, test loss = 2.284730
  Training set accuracy = 0.187500, Test set accuracy = 0.175600
 epoch 11/30. Took 0.22765 seconds. 
  Full-batch training loss = 2.280946, test loss = 2.282400
  Training set accuracy = 0.193500, Test set accuracy = 0.180300
 epoch 12/30. Took 0.23017 seconds. 
  Full-batch training loss = 2.278589, test loss = 2.280163
  Training set accuracy = 0.200000, Test set accuracy = 0.186700
 epoch 13/30. Took 0.22775 seconds. 
  Full-batch training loss = 2.276206, test loss = 2.277835
  Training set accuracy = 0.216000, Test set accuracy = 0.194900
 epoch 14/30. Took 0.22875 seconds. 
  Full-batch training loss = 2.273807, test loss = 2.275525
  Training set accuracy = 0.228500, Test set accuracy = 0.204500
 epoch 15/30. Took 0.22896 seconds. 
  Full-batch training loss = 2.271422, test loss = 2.273224
  Training set accuracy = 0.239500, Test set accuracy = 0.215600
 epoch 16/30. Took 0.22981 seconds. 
  Full-batch training loss = 2.268995, test loss = 2.270883
  Training set accuracy = 0.249000, Test set accuracy = 0.227500
 epoch 17/30. Took 0.22997 seconds. 
  Full-batch training loss = 2.266598, test loss = 2.268548
  Training set accuracy = 0.261000, Test set accuracy = 0.241900
 epoch 18/30. Took 0.2307 seconds. 
  Full-batch training loss = 2.264136, test loss = 2.266131
  Training set accuracy = 0.271000, Test set accuracy = 0.256700
 epoch 19/30. Took 0.22915 seconds. 
  Full-batch training loss = 2.261668, test loss = 2.263754
  Training set accuracy = 0.287500, Test set accuracy = 0.270200
 epoch 20/30. Took 0.22431 seconds. 
  Full-batch training loss = 2.259211, test loss = 2.261386
  Training set accuracy = 0.301000, Test set accuracy = 0.288400
 epoch 21/30. Took 0.23066 seconds. 
  Full-batch training loss = 2.256736, test loss = 2.258958
  Training set accuracy = 0.318500, Test set accuracy = 0.302000
 epoch 22/30. Took 0.23103 seconds. 
  Full-batch training loss = 2.254207, test loss = 2.256518
  Training set accuracy = 0.339500, Test set accuracy = 0.319800
 epoch 23/30. Took 0.24657 seconds. 
  Full-batch training loss = 2.251670, test loss = 2.254017
  Training set accuracy = 0.360500, Test set accuracy = 0.336600
 epoch 24/30. Took 0.23063 seconds. 
  Full-batch training loss = 2.249078, test loss = 2.251502
  Training set accuracy = 0.379000, Test set accuracy = 0.352900
 epoch 25/30. Took 0.22949 seconds. 
  Full-batch training loss = 2.246485, test loss = 2.248939
  Training set accuracy = 0.397500, Test set accuracy = 0.370300
 epoch 26/30. Took 0.24985 seconds. 
  Full-batch training loss = 2.243854, test loss = 2.246368
  Training set accuracy = 0.410000, Test set accuracy = 0.385000
 epoch 27/30. Took 0.23018 seconds. 
  Full-batch training loss = 2.241166, test loss = 2.243755
  Training set accuracy = 0.425000, Test set accuracy = 0.401800
 epoch 28/30. Took 0.22981 seconds. 
  Full-batch training loss = 2.238432, test loss = 2.241097
  Training set accuracy = 0.438500, Test set accuracy = 0.414400
 epoch 29/30. Took 0.25903 seconds. 
  Full-batch training loss = 2.235712, test loss = 2.238437
  Training set accuracy = 0.451500, Test set accuracy = 0.424300
 epoch 30/30. Took 0.23831 seconds. 
  Full-batch training loss = 2.232908, test loss = 2.235707
  Training set accuracy = 0.471500, Test set accuracy = 0.435800
Elapsed time is 23.194429 seconds.
End Training
-----
Params 2000 0.001 0.50 3 100
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.064155 seconds. 
  Full-batch training loss = 2.309922, test loss = 2.307046
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 2/30. Took 0.056951 seconds. 
  Full-batch training loss = 2.309428, test loss = 2.306662
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 3/30. Took 0.059973 seconds. 
  Full-batch training loss = 2.308940, test loss = 2.306293
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 4/30. Took 0.059702 seconds. 
  Full-batch training loss = 2.308494, test loss = 2.305947
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 5/30. Took 0.059776 seconds. 
  Full-batch training loss = 2.308030, test loss = 2.305592
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 6/30. Took 0.060163 seconds. 
  Full-batch training loss = 2.307572, test loss = 2.305245
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 7/30. Took 0.059608 seconds. 
  Full-batch training loss = 2.307115, test loss = 2.304895
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 8/30. Took 0.059548 seconds. 
  Full-batch training loss = 2.306676, test loss = 2.304561
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 9/30. Took 0.059866 seconds. 
  Full-batch training loss = 2.306265, test loss = 2.304245
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 10/30. Took 0.059862 seconds. 
  Full-batch training loss = 2.305838, test loss = 2.303919
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 11/30. Took 0.059547 seconds. 
  Full-batch training loss = 2.305410, test loss = 2.303595
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 12/30. Took 0.05497 seconds. 
  Full-batch training loss = 2.305029, test loss = 2.303304
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 13/30. Took 0.059342 seconds. 
  Full-batch training loss = 2.304599, test loss = 2.302978
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 14/30. Took 0.058767 seconds. 
  Full-batch training loss = 2.304208, test loss = 2.302680
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 15/30. Took 0.060381 seconds. 
  Full-batch training loss = 2.303795, test loss = 2.302371
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 16/30. Took 0.059695 seconds. 
  Full-batch training loss = 2.303432, test loss = 2.302093
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 17/30. Took 0.060253 seconds. 
  Full-batch training loss = 2.303060, test loss = 2.301813
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 18/30. Took 0.063943 seconds. 
  Full-batch training loss = 2.302676, test loss = 2.301521
  Training set accuracy = 0.090500, Test set accuracy = 0.100900
 epoch 19/30. Took 0.058703 seconds. 
  Full-batch training loss = 2.302309, test loss = 2.301243
  Training set accuracy = 0.091000, Test set accuracy = 0.100900
 epoch 20/30. Took 0.058929 seconds. 
  Full-batch training loss = 2.301940, test loss = 2.300959
  Training set accuracy = 0.091000, Test set accuracy = 0.101000
 epoch 21/30. Took 0.057498 seconds. 
  Full-batch training loss = 2.301599, test loss = 2.300700
  Training set accuracy = 0.091500, Test set accuracy = 0.101000
 epoch 22/30. Took 0.055482 seconds. 
  Full-batch training loss = 2.301248, test loss = 2.300429
  Training set accuracy = 0.091000, Test set accuracy = 0.102100
 epoch 23/30. Took 0.055384 seconds. 
  Full-batch training loss = 2.300877, test loss = 2.300153
  Training set accuracy = 0.093000, Test set accuracy = 0.103100
 epoch 24/30. Took 0.055368 seconds. 
  Full-batch training loss = 2.300535, test loss = 2.299889
  Training set accuracy = 0.094500, Test set accuracy = 0.105600
 epoch 25/30. Took 0.055538 seconds. 
  Full-batch training loss = 2.300208, test loss = 2.299638
  Training set accuracy = 0.096000, Test set accuracy = 0.107400
 epoch 26/30. Took 0.06723 seconds. 
  Full-batch training loss = 2.299859, test loss = 2.299372
  Training set accuracy = 0.099500, Test set accuracy = 0.109900
 epoch 27/30. Took 0.059377 seconds. 
  Full-batch training loss = 2.299528, test loss = 2.299114
  Training set accuracy = 0.103500, Test set accuracy = 0.113200
 epoch 28/30. Took 0.057028 seconds. 
  Full-batch training loss = 2.299200, test loss = 2.298867
  Training set accuracy = 0.107000, Test set accuracy = 0.118100
 epoch 29/30. Took 0.059494 seconds. 
  Full-batch training loss = 2.298875, test loss = 2.298617
  Training set accuracy = 0.112000, Test set accuracy = 0.124400
 epoch 30/30. Took 0.061599 seconds. 
  Full-batch training loss = 2.298551, test loss = 2.298370
  Training set accuracy = 0.117500, Test set accuracy = 0.129100
Elapsed time is 6.334673 seconds.
End Training
-----
Params 2000 0.001 0.50 3 200
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11099 seconds. 
  Full-batch training loss = 2.306650, test loss = 2.305717
  Training set accuracy = 0.096500, Test set accuracy = 0.094700
 epoch 2/30. Took 0.10736 seconds. 
  Full-batch training loss = 2.306223, test loss = 2.305355
  Training set accuracy = 0.099000, Test set accuracy = 0.097600
 epoch 3/30. Took 0.10856 seconds. 
  Full-batch training loss = 2.305789, test loss = 2.304991
  Training set accuracy = 0.100000, Test set accuracy = 0.098800
 epoch 4/30. Took 0.10905 seconds. 
  Full-batch training loss = 2.305385, test loss = 2.304653
  Training set accuracy = 0.100000, Test set accuracy = 0.100200
 epoch 5/30. Took 0.10969 seconds. 
  Full-batch training loss = 2.304979, test loss = 2.304298
  Training set accuracy = 0.099000, Test set accuracy = 0.100700
 epoch 6/30. Took 0.10852 seconds. 
  Full-batch training loss = 2.304567, test loss = 2.303953
  Training set accuracy = 0.100000, Test set accuracy = 0.101600
 epoch 7/30. Took 0.10772 seconds. 
  Full-batch training loss = 2.304166, test loss = 2.303611
  Training set accuracy = 0.101000, Test set accuracy = 0.102400
 epoch 8/30. Took 0.10876 seconds. 
  Full-batch training loss = 2.303766, test loss = 2.303273
  Training set accuracy = 0.101000, Test set accuracy = 0.102400
 epoch 9/30. Took 0.11371 seconds. 
  Full-batch training loss = 2.303371, test loss = 2.302936
  Training set accuracy = 0.100500, Test set accuracy = 0.102800
 epoch 10/30. Took 0.10832 seconds. 
  Full-batch training loss = 2.302990, test loss = 2.302616
  Training set accuracy = 0.101000, Test set accuracy = 0.102900
 epoch 11/30. Took 0.10194 seconds. 
  Full-batch training loss = 2.302582, test loss = 2.302261
  Training set accuracy = 0.101500, Test set accuracy = 0.102900
 epoch 12/30. Took 0.10868 seconds. 
  Full-batch training loss = 2.302197, test loss = 2.301946
  Training set accuracy = 0.101500, Test set accuracy = 0.103100
 epoch 13/30. Took 0.10933 seconds. 
  Full-batch training loss = 2.301840, test loss = 2.301629
  Training set accuracy = 0.101500, Test set accuracy = 0.103200
 epoch 14/30. Took 0.11096 seconds. 
  Full-batch training loss = 2.301459, test loss = 2.301308
  Training set accuracy = 0.101500, Test set accuracy = 0.103200
 epoch 15/30. Took 0.10894 seconds. 
  Full-batch training loss = 2.301100, test loss = 2.300994
  Training set accuracy = 0.101500, Test set accuracy = 0.103200
 epoch 16/30. Took 0.108 seconds. 
  Full-batch training loss = 2.300722, test loss = 2.300683
  Training set accuracy = 0.101500, Test set accuracy = 0.103200
 epoch 17/30. Took 0.10889 seconds. 
  Full-batch training loss = 2.300353, test loss = 2.300368
  Training set accuracy = 0.101500, Test set accuracy = 0.103200
 epoch 18/30. Took 0.10158 seconds. 
  Full-batch training loss = 2.299992, test loss = 2.300059
  Training set accuracy = 0.101500, Test set accuracy = 0.103200
 epoch 19/30. Took 0.1061 seconds. 
  Full-batch training loss = 2.299634, test loss = 2.299746
  Training set accuracy = 0.101500, Test set accuracy = 0.103200
 epoch 20/30. Took 0.12016 seconds. 
  Full-batch training loss = 2.299270, test loss = 2.299425
  Training set accuracy = 0.101500, Test set accuracy = 0.103300
 epoch 21/30. Took 0.10404 seconds. 
  Full-batch training loss = 2.298921, test loss = 2.299107
  Training set accuracy = 0.101500, Test set accuracy = 0.103300
 epoch 22/30. Took 0.10715 seconds. 
  Full-batch training loss = 2.298575, test loss = 2.298815
  Training set accuracy = 0.101000, Test set accuracy = 0.103500
 epoch 23/30. Took 0.10324 seconds. 
  Full-batch training loss = 2.298224, test loss = 2.298510
  Training set accuracy = 0.101000, Test set accuracy = 0.103700
 epoch 24/30. Took 0.10852 seconds. 
  Full-batch training loss = 2.297889, test loss = 2.298210
  Training set accuracy = 0.101000, Test set accuracy = 0.104000
 epoch 25/30. Took 0.10555 seconds. 
  Full-batch training loss = 2.297531, test loss = 2.297910
  Training set accuracy = 0.101000, Test set accuracy = 0.104000
 epoch 26/30. Took 0.10782 seconds. 
  Full-batch training loss = 2.297176, test loss = 2.297598
  Training set accuracy = 0.101000, Test set accuracy = 0.104000
 epoch 27/30. Took 0.10351 seconds. 
  Full-batch training loss = 2.296831, test loss = 2.297298
  Training set accuracy = 0.101500, Test set accuracy = 0.104000
 epoch 28/30. Took 0.10955 seconds. 
  Full-batch training loss = 2.296496, test loss = 2.296997
  Training set accuracy = 0.101000, Test set accuracy = 0.105000
 epoch 29/30. Took 0.10812 seconds. 
  Full-batch training loss = 2.296159, test loss = 2.296708
  Training set accuracy = 0.100500, Test set accuracy = 0.105400
 epoch 30/30. Took 0.10749 seconds. 
  Full-batch training loss = 2.295815, test loss = 2.296409
  Training set accuracy = 0.101000, Test set accuracy = 0.106100
Elapsed time is 10.998746 seconds.
End Training
-----
Params 2000 0.001 0.50 3 500
Setting parameters
Start Training
Number of training examples: 2000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32736 seconds. 
  Full-batch training loss = 2.299194, test loss = 2.299509
  Training set accuracy = 0.140500, Test set accuracy = 0.156200
 epoch 2/30. Took 0.32203 seconds. 
  Full-batch training loss = 2.298755, test loss = 2.299170
  Training set accuracy = 0.148000, Test set accuracy = 0.161500
 epoch 3/30. Took 0.33579 seconds. 
  Full-batch training loss = 2.298331, test loss = 2.298846
  Training set accuracy = 0.149500, Test set accuracy = 0.161700
 epoch 4/30. Took 0.34352 seconds. 
  Full-batch training loss = 2.297891, test loss = 2.298525
  Training set accuracy = 0.148500, Test set accuracy = 0.152800
 epoch 5/30. Took 0.32142 seconds. 
  Full-batch training loss = 2.297491, test loss = 2.298201
  Training set accuracy = 0.147000, Test set accuracy = 0.149500
 epoch 6/30. Took 0.32025 seconds. 
  Full-batch training loss = 2.297047, test loss = 2.297882
  Training set accuracy = 0.140000, Test set accuracy = 0.138400
 epoch 7/30. Took 0.32025 seconds. 
  Full-batch training loss = 2.296645, test loss = 2.297570
  Training set accuracy = 0.134000, Test set accuracy = 0.134300
 epoch 8/30. Took 0.32195 seconds. 
  Full-batch training loss = 2.296230, test loss = 2.297257
  Training set accuracy = 0.136500, Test set accuracy = 0.132000
 epoch 9/30. Took 0.32128 seconds. 
  Full-batch training loss = 2.295814, test loss = 2.296947
  Training set accuracy = 0.137500, Test set accuracy = 0.128800
 epoch 10/30. Took 0.32172 seconds. 
  Full-batch training loss = 2.295412, test loss = 2.296623
  Training set accuracy = 0.142500, Test set accuracy = 0.128300
 epoch 11/30. Took 0.32121 seconds. 
  Full-batch training loss = 2.295006, test loss = 2.296321
  Training set accuracy = 0.140000, Test set accuracy = 0.125400
 epoch 12/30. Took 0.32207 seconds. 
  Full-batch training loss = 2.294594, test loss = 2.296009
  Training set accuracy = 0.138500, Test set accuracy = 0.120900
 epoch 13/30. Took 0.32089 seconds. 
  Full-batch training loss = 2.294203, test loss = 2.295709
  Training set accuracy = 0.131000, Test set accuracy = 0.117900
 epoch 14/30. Took 0.3193 seconds. 
  Full-batch training loss = 2.293801, test loss = 2.295390
  Training set accuracy = 0.132500, Test set accuracy = 0.114900
 epoch 15/30. Took 0.34059 seconds. 
  Full-batch training loss = 2.293427, test loss = 2.295101
  Training set accuracy = 0.133000, Test set accuracy = 0.110800
 epoch 16/30. Took 0.32233 seconds. 
  Full-batch training loss = 2.293036, test loss = 2.294804
  Training set accuracy = 0.130500, Test set accuracy = 0.107700
 epoch 17/30. Took 0.32017 seconds. 
  Full-batch training loss = 2.292631, test loss = 2.294497
  Training set accuracy = 0.127500, Test set accuracy = 0.105400
 epoch 18/30. Took 0.32251 seconds. 
  Full-batch training loss = 2.292257, test loss = 2.294198
  Training set accuracy = 0.125000, Test set accuracy = 0.103900
 epoch 19/30. Took 0.32134 seconds. 
  Full-batch training loss = 2.291886, test loss = 2.293896
  Training set accuracy = 0.122500, Test set accuracy = 0.102800
 epoch 20/30. Took 0.32254 seconds. 
  Full-batch training loss = 2.291495, test loss = 2.293598
  Training set accuracy = 0.121500, Test set accuracy = 0.101900
 epoch 21/30. Took 0.31984 seconds. 
  Full-batch training loss = 2.291120, test loss = 2.293294
  Training set accuracy = 0.121500, Test set accuracy = 0.101500
 epoch 22/30. Took 0.32175 seconds. 
  Full-batch training loss = 2.290736, test loss = 2.292991
  Training set accuracy = 0.121000, Test set accuracy = 0.101300
 epoch 23/30. Took 0.31765 seconds. 
  Full-batch training loss = 2.290368, test loss = 2.292686
  Training set accuracy = 0.121000, Test set accuracy = 0.101400
 epoch 24/30. Took 0.33022 seconds. 
  Full-batch training loss = 2.289990, test loss = 2.292383
  Training set accuracy = 0.120500, Test set accuracy = 0.101400
 epoch 25/30. Took 0.32279 seconds. 
  Full-batch training loss = 2.289603, test loss = 2.292075
  Training set accuracy = 0.121000, Test set accuracy = 0.101700
 epoch 26/30. Took 0.31979 seconds. 
  Full-batch training loss = 2.289245, test loss = 2.291782
  Training set accuracy = 0.120500, Test set accuracy = 0.101600
 epoch 27/30. Took 0.32058 seconds. 
  Full-batch training loss = 2.288873, test loss = 2.291478
  Training set accuracy = 0.120500, Test set accuracy = 0.101600
 epoch 28/30. Took 0.32071 seconds. 
  Full-batch training loss = 2.288484, test loss = 2.291169
  Training set accuracy = 0.120500, Test set accuracy = 0.101800
 epoch 29/30. Took 0.3237 seconds. 
  Full-batch training loss = 2.288116, test loss = 2.290866
  Training set accuracy = 0.120500, Test set accuracy = 0.101700
 epoch 30/30. Took 0.32636 seconds. 
  Full-batch training loss = 2.287741, test loss = 2.290564
  Training set accuracy = 0.120500, Test set accuracy = 0.101700
Elapsed time is 31.662399 seconds.
End Training
-----
Params 5000 0.100 0.00 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.10155 seconds. 
  Full-batch training loss = 0.393599, test loss = 0.414887
  Training set accuracy = 0.883000, Test set accuracy = 0.878600
 epoch 2/30. Took 0.095302 seconds. 
  Full-batch training loss = 0.286380, test loss = 0.339863
  Training set accuracy = 0.921000, Test set accuracy = 0.900000
 epoch 3/30. Took 0.095384 seconds. 
  Full-batch training loss = 0.222918, test loss = 0.293082
  Training set accuracy = 0.937400, Test set accuracy = 0.914500
 epoch 4/30. Took 0.097437 seconds. 
  Full-batch training loss = 0.185988, test loss = 0.275187
  Training set accuracy = 0.947600, Test set accuracy = 0.921400
 epoch 5/30. Took 0.097802 seconds. 
  Full-batch training loss = 0.159647, test loss = 0.259165
  Training set accuracy = 0.956800, Test set accuracy = 0.923800
 epoch 6/30. Took 0.10333 seconds. 
  Full-batch training loss = 0.148147, test loss = 0.258630
  Training set accuracy = 0.956800, Test set accuracy = 0.920300
 epoch 7/30. Took 0.096632 seconds. 
  Full-batch training loss = 0.110411, test loss = 0.240730
  Training set accuracy = 0.973400, Test set accuracy = 0.929400
 epoch 8/30. Took 0.097407 seconds. 
  Full-batch training loss = 0.102116, test loss = 0.246080
  Training set accuracy = 0.969600, Test set accuracy = 0.924500
 epoch 9/30. Took 0.10224 seconds. 
  Full-batch training loss = 0.079518, test loss = 0.221101
  Training set accuracy = 0.980600, Test set accuracy = 0.935000
 epoch 10/30. Took 0.099482 seconds. 
  Full-batch training loss = 0.059748, test loss = 0.217115
  Training set accuracy = 0.988400, Test set accuracy = 0.935400
 epoch 11/30. Took 0.096965 seconds. 
  Full-batch training loss = 0.054231, test loss = 0.216896
  Training set accuracy = 0.990000, Test set accuracy = 0.934800
 epoch 12/30. Took 0.097154 seconds. 
  Full-batch training loss = 0.041906, test loss = 0.206273
  Training set accuracy = 0.994400, Test set accuracy = 0.940100
 epoch 13/30. Took 0.097654 seconds. 
  Full-batch training loss = 0.033571, test loss = 0.205706
  Training set accuracy = 0.995800, Test set accuracy = 0.941300
 epoch 14/30. Took 0.097855 seconds. 
  Full-batch training loss = 0.031202, test loss = 0.209394
  Training set accuracy = 0.998000, Test set accuracy = 0.939000
 epoch 15/30. Took 0.097321 seconds. 
  Full-batch training loss = 0.025001, test loss = 0.206511
  Training set accuracy = 0.998000, Test set accuracy = 0.941600
 epoch 16/30. Took 0.097168 seconds. 
  Full-batch training loss = 0.021160, test loss = 0.209721
  Training set accuracy = 0.998600, Test set accuracy = 0.941300
 epoch 17/30. Took 0.09725 seconds. 
  Full-batch training loss = 0.018538, test loss = 0.205904
  Training set accuracy = 0.999400, Test set accuracy = 0.943000
 epoch 18/30. Took 0.097359 seconds. 
  Full-batch training loss = 0.017656, test loss = 0.214500
  Training set accuracy = 0.999800, Test set accuracy = 0.940700
 epoch 19/30. Took 0.097861 seconds. 
  Full-batch training loss = 0.013946, test loss = 0.209600
  Training set accuracy = 1.000000, Test set accuracy = 0.941800
 epoch 20/30. Took 0.097274 seconds. 
  Full-batch training loss = 0.012887, test loss = 0.210870
  Training set accuracy = 1.000000, Test set accuracy = 0.944400
 epoch 21/30. Took 0.097436 seconds. 
  Full-batch training loss = 0.012146, test loss = 0.214031
  Training set accuracy = 1.000000, Test set accuracy = 0.942500
 epoch 22/30. Took 0.096216 seconds. 
  Full-batch training loss = 0.010675, test loss = 0.211824
  Training set accuracy = 1.000000, Test set accuracy = 0.944500
 epoch 23/30. Took 0.097369 seconds. 
  Full-batch training loss = 0.009698, test loss = 0.214468
  Training set accuracy = 1.000000, Test set accuracy = 0.943800
 epoch 24/30. Took 0.097495 seconds. 
  Full-batch training loss = 0.009248, test loss = 0.217566
  Training set accuracy = 1.000000, Test set accuracy = 0.942200
 epoch 25/30. Took 0.097707 seconds. 
  Full-batch training loss = 0.008237, test loss = 0.216459
  Training set accuracy = 1.000000, Test set accuracy = 0.943400
 epoch 26/30. Took 0.097327 seconds. 
  Full-batch training loss = 0.007694, test loss = 0.217925
  Training set accuracy = 1.000000, Test set accuracy = 0.944300
 epoch 27/30. Took 0.097757 seconds. 
  Full-batch training loss = 0.007289, test loss = 0.219795
  Training set accuracy = 1.000000, Test set accuracy = 0.944500
 epoch 28/30. Took 0.097293 seconds. 
  Full-batch training loss = 0.006863, test loss = 0.220379
  Training set accuracy = 1.000000, Test set accuracy = 0.944600
 epoch 29/30. Took 0.099663 seconds. 
  Full-batch training loss = 0.006485, test loss = 0.220083
  Training set accuracy = 1.000000, Test set accuracy = 0.945600
 epoch 30/30. Took 0.097031 seconds. 
  Full-batch training loss = 0.006042, test loss = 0.221926
  Training set accuracy = 1.000000, Test set accuracy = 0.944900
Elapsed time is 7.584761 seconds.
End Training
-----
Params 5000 0.100 0.00 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.15616 seconds. 
  Full-batch training loss = 0.394085, test loss = 0.398316
  Training set accuracy = 0.883000, Test set accuracy = 0.884400
 epoch 2/30. Took 0.15633 seconds. 
  Full-batch training loss = 0.289688, test loss = 0.327034
  Training set accuracy = 0.918000, Test set accuracy = 0.906000
 epoch 3/30. Took 0.14867 seconds. 
  Full-batch training loss = 0.228330, test loss = 0.293092
  Training set accuracy = 0.933400, Test set accuracy = 0.917500
 epoch 4/30. Took 0.1451 seconds. 
  Full-batch training loss = 0.187996, test loss = 0.270504
  Training set accuracy = 0.945600, Test set accuracy = 0.920400
 epoch 5/30. Took 0.14565 seconds. 
  Full-batch training loss = 0.154757, test loss = 0.245827
  Training set accuracy = 0.957400, Test set accuracy = 0.928000
 epoch 6/30. Took 0.14535 seconds. 
  Full-batch training loss = 0.119308, test loss = 0.225490
  Training set accuracy = 0.969600, Test set accuracy = 0.933600
 epoch 7/30. Took 0.14586 seconds. 
  Full-batch training loss = 0.099049, test loss = 0.218718
  Training set accuracy = 0.976400, Test set accuracy = 0.936100
 epoch 8/30. Took 0.14512 seconds. 
  Full-batch training loss = 0.081699, test loss = 0.214643
  Training set accuracy = 0.981800, Test set accuracy = 0.937600
 epoch 9/30. Took 0.1451 seconds. 
  Full-batch training loss = 0.087742, test loss = 0.232167
  Training set accuracy = 0.979600, Test set accuracy = 0.931800
 epoch 10/30. Took 0.14705 seconds. 
  Full-batch training loss = 0.059657, test loss = 0.206528
  Training set accuracy = 0.988800, Test set accuracy = 0.940500
 epoch 11/30. Took 0.14601 seconds. 
  Full-batch training loss = 0.049522, test loss = 0.209779
  Training set accuracy = 0.991400, Test set accuracy = 0.940700
 epoch 12/30. Took 0.14631 seconds. 
  Full-batch training loss = 0.040702, test loss = 0.203164
  Training set accuracy = 0.994600, Test set accuracy = 0.943200
 epoch 13/30. Took 0.14704 seconds. 
  Full-batch training loss = 0.037518, test loss = 0.209350
  Training set accuracy = 0.994400, Test set accuracy = 0.940300
 epoch 14/30. Took 0.14491 seconds. 
  Full-batch training loss = 0.029054, test loss = 0.203211
  Training set accuracy = 0.997800, Test set accuracy = 0.942200
 epoch 15/30. Took 0.14514 seconds. 
  Full-batch training loss = 0.025789, test loss = 0.198885
  Training set accuracy = 0.998800, Test set accuracy = 0.943900
 epoch 16/30. Took 0.14506 seconds. 
  Full-batch training loss = 0.022331, test loss = 0.202461
  Training set accuracy = 0.998400, Test set accuracy = 0.943300
 epoch 17/30. Took 0.15792 seconds. 
  Full-batch training loss = 0.019715, test loss = 0.204233
  Training set accuracy = 0.999000, Test set accuracy = 0.943600
 epoch 18/30. Took 0.1451 seconds. 
  Full-batch training loss = 0.017844, test loss = 0.202670
  Training set accuracy = 0.999200, Test set accuracy = 0.945500
 epoch 19/30. Took 0.14672 seconds. 
  Full-batch training loss = 0.014719, test loss = 0.201772
  Training set accuracy = 0.999800, Test set accuracy = 0.946900
 epoch 20/30. Took 0.14505 seconds. 
  Full-batch training loss = 0.013111, test loss = 0.203263
  Training set accuracy = 0.999800, Test set accuracy = 0.947200
 epoch 21/30. Took 0.14473 seconds. 
  Full-batch training loss = 0.011667, test loss = 0.204130
  Training set accuracy = 1.000000, Test set accuracy = 0.946300
 epoch 22/30. Took 0.14443 seconds. 
  Full-batch training loss = 0.010910, test loss = 0.205538
  Training set accuracy = 0.999800, Test set accuracy = 0.946000
 epoch 23/30. Took 0.14494 seconds. 
  Full-batch training loss = 0.010159, test loss = 0.206836
  Training set accuracy = 1.000000, Test set accuracy = 0.946800
 epoch 24/30. Took 0.14366 seconds. 
  Full-batch training loss = 0.009123, test loss = 0.205900
  Training set accuracy = 1.000000, Test set accuracy = 0.947000
 epoch 25/30. Took 0.16416 seconds. 
  Full-batch training loss = 0.008352, test loss = 0.207265
  Training set accuracy = 1.000000, Test set accuracy = 0.947100
 epoch 26/30. Took 0.14664 seconds. 
  Full-batch training loss = 0.008251, test loss = 0.210322
  Training set accuracy = 1.000000, Test set accuracy = 0.947000
 epoch 27/30. Took 0.14714 seconds. 
  Full-batch training loss = 0.007291, test loss = 0.210631
  Training set accuracy = 1.000000, Test set accuracy = 0.947100
 epoch 28/30. Took 0.14741 seconds. 
  Full-batch training loss = 0.007045, test loss = 0.211479
  Training set accuracy = 1.000000, Test set accuracy = 0.946900
 epoch 29/30. Took 0.14462 seconds. 
  Full-batch training loss = 0.006671, test loss = 0.212114
  Training set accuracy = 1.000000, Test set accuracy = 0.948000
 epoch 30/30. Took 0.14512 seconds. 
  Full-batch training loss = 0.006308, test loss = 0.212479
  Training set accuracy = 1.000000, Test set accuracy = 0.947200
Elapsed time is 10.687261 seconds.
End Training
-----
Params 5000 0.100 0.00 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32838 seconds. 
  Full-batch training loss = 0.355239, test loss = 0.374413
  Training set accuracy = 0.892600, Test set accuracy = 0.890600
 epoch 2/30. Took 0.31567 seconds. 
  Full-batch training loss = 0.268920, test loss = 0.319517
  Training set accuracy = 0.918400, Test set accuracy = 0.907900
 epoch 3/30. Took 0.31144 seconds. 
  Full-batch training loss = 0.198911, test loss = 0.278442
  Training set accuracy = 0.944600, Test set accuracy = 0.920100
 epoch 4/30. Took 0.31073 seconds. 
  Full-batch training loss = 0.155582, test loss = 0.245752
  Training set accuracy = 0.957000, Test set accuracy = 0.928800
 epoch 5/30. Took 0.31197 seconds. 
  Full-batch training loss = 0.123347, test loss = 0.221042
  Training set accuracy = 0.969000, Test set accuracy = 0.935400
 epoch 6/30. Took 0.31164 seconds. 
  Full-batch training loss = 0.105176, test loss = 0.222392
  Training set accuracy = 0.974400, Test set accuracy = 0.930500
 epoch 7/30. Took 0.31298 seconds. 
  Full-batch training loss = 0.078780, test loss = 0.200224
  Training set accuracy = 0.985800, Test set accuracy = 0.941700
 epoch 8/30. Took 0.31313 seconds. 
  Full-batch training loss = 0.069167, test loss = 0.205461
  Training set accuracy = 0.989200, Test set accuracy = 0.940400
 epoch 9/30. Took 0.31296 seconds. 
  Full-batch training loss = 0.054623, test loss = 0.195412
  Training set accuracy = 0.991200, Test set accuracy = 0.941100
 epoch 10/30. Took 0.31281 seconds. 
  Full-batch training loss = 0.045341, test loss = 0.196242
  Training set accuracy = 0.994200, Test set accuracy = 0.941400
 epoch 11/30. Took 0.32307 seconds. 
  Full-batch training loss = 0.037741, test loss = 0.191531
  Training set accuracy = 0.996400, Test set accuracy = 0.943800
 epoch 12/30. Took 0.35836 seconds. 
  Full-batch training loss = 0.036038, test loss = 0.201350
  Training set accuracy = 0.995400, Test set accuracy = 0.939700
 epoch 13/30. Took 0.31175 seconds. 
  Full-batch training loss = 0.026343, test loss = 0.190773
  Training set accuracy = 0.998200, Test set accuracy = 0.947200
 epoch 14/30. Took 0.31008 seconds. 
  Full-batch training loss = 0.023457, test loss = 0.189071
  Training set accuracy = 0.998600, Test set accuracy = 0.944300
 epoch 15/30. Took 0.32991 seconds. 
  Full-batch training loss = 0.018873, test loss = 0.189843
  Training set accuracy = 0.999600, Test set accuracy = 0.946600
 epoch 16/30. Took 0.31229 seconds. 
  Full-batch training loss = 0.017290, test loss = 0.193513
  Training set accuracy = 0.999200, Test set accuracy = 0.945200
 epoch 17/30. Took 0.31274 seconds. 
  Full-batch training loss = 0.015431, test loss = 0.195563
  Training set accuracy = 1.000000, Test set accuracy = 0.947300
 epoch 18/30. Took 0.31252 seconds. 
  Full-batch training loss = 0.013891, test loss = 0.193945
  Training set accuracy = 0.999400, Test set accuracy = 0.946000
 epoch 19/30. Took 0.31271 seconds. 
  Full-batch training loss = 0.012030, test loss = 0.193978
  Training set accuracy = 1.000000, Test set accuracy = 0.946900
 epoch 20/30. Took 0.31352 seconds. 
  Full-batch training loss = 0.011086, test loss = 0.195080
  Training set accuracy = 1.000000, Test set accuracy = 0.946000
 epoch 21/30. Took 0.31275 seconds. 
  Full-batch training loss = 0.010641, test loss = 0.196343
  Training set accuracy = 1.000000, Test set accuracy = 0.947300
 epoch 22/30. Took 0.31339 seconds. 
  Full-batch training loss = 0.009398, test loss = 0.196515
  Training set accuracy = 1.000000, Test set accuracy = 0.945900
 epoch 23/30. Took 0.31378 seconds. 
  Full-batch training loss = 0.009195, test loss = 0.195939
  Training set accuracy = 1.000000, Test set accuracy = 0.947100
 epoch 24/30. Took 0.3125 seconds. 
  Full-batch training loss = 0.008076, test loss = 0.196833
  Training set accuracy = 1.000000, Test set accuracy = 0.947200
 epoch 25/30. Took 0.31216 seconds. 
  Full-batch training loss = 0.007331, test loss = 0.196907
  Training set accuracy = 1.000000, Test set accuracy = 0.948000
 epoch 26/30. Took 0.31286 seconds. 
  Full-batch training loss = 0.006949, test loss = 0.198332
  Training set accuracy = 1.000000, Test set accuracy = 0.947400
 epoch 27/30. Took 0.31849 seconds. 
  Full-batch training loss = 0.006468, test loss = 0.198901
  Training set accuracy = 1.000000, Test set accuracy = 0.948100
 epoch 28/30. Took 0.31426 seconds. 
  Full-batch training loss = 0.006149, test loss = 0.201012
  Training set accuracy = 1.000000, Test set accuracy = 0.947500
 epoch 29/30. Took 0.31238 seconds. 
  Full-batch training loss = 0.005999, test loss = 0.200394
  Training set accuracy = 1.000000, Test set accuracy = 0.947300
 epoch 30/30. Took 0.31183 seconds. 
  Full-batch training loss = 0.005651, test loss = 0.202628
  Training set accuracy = 1.000000, Test set accuracy = 0.948100
Elapsed time is 21.326274 seconds.
End Training
-----
Params 5000 0.100 0.00 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11326 seconds. 
  Full-batch training loss = 0.337307, test loss = 0.376881
  Training set accuracy = 0.901600, Test set accuracy = 0.888100
 epoch 2/30. Took 0.11859 seconds. 
  Full-batch training loss = 0.240638, test loss = 0.314077
  Training set accuracy = 0.930600, Test set accuracy = 0.905300
 epoch 3/30. Took 0.11159 seconds. 
  Full-batch training loss = 0.186996, test loss = 0.290571
  Training set accuracy = 0.946600, Test set accuracy = 0.909700
 epoch 4/30. Took 0.11163 seconds. 
  Full-batch training loss = 0.155562, test loss = 0.264822
  Training set accuracy = 0.956400, Test set accuracy = 0.921200
 epoch 5/30. Took 0.10741 seconds. 
  Full-batch training loss = 0.133505, test loss = 0.280914
  Training set accuracy = 0.956800, Test set accuracy = 0.912600
 epoch 6/30. Took 0.1156 seconds. 
  Full-batch training loss = 0.081968, test loss = 0.230178
  Training set accuracy = 0.977200, Test set accuracy = 0.930800
 epoch 7/30. Took 0.11694 seconds. 
  Full-batch training loss = 0.055657, test loss = 0.217031
  Training set accuracy = 0.987800, Test set accuracy = 0.935900
 epoch 8/30. Took 0.10898 seconds. 
  Full-batch training loss = 0.046394, test loss = 0.224206
  Training set accuracy = 0.988000, Test set accuracy = 0.935300
 epoch 9/30. Took 0.1108 seconds. 
  Full-batch training loss = 0.030570, test loss = 0.216735
  Training set accuracy = 0.993400, Test set accuracy = 0.938100
 epoch 10/30. Took 0.10833 seconds. 
  Full-batch training loss = 0.021600, test loss = 0.210971
  Training set accuracy = 0.996800, Test set accuracy = 0.941200
 epoch 11/30. Took 0.11146 seconds. 
  Full-batch training loss = 0.019066, test loss = 0.219102
  Training set accuracy = 0.996800, Test set accuracy = 0.939200
 epoch 12/30. Took 0.12105 seconds. 
  Full-batch training loss = 0.018765, test loss = 0.236602
  Training set accuracy = 0.997400, Test set accuracy = 0.938200
 epoch 13/30. Took 0.11918 seconds. 
  Full-batch training loss = 0.007193, test loss = 0.216564
  Training set accuracy = 0.999800, Test set accuracy = 0.944500
 epoch 14/30. Took 0.11024 seconds. 
  Full-batch training loss = 0.005443, test loss = 0.215167
  Training set accuracy = 0.999800, Test set accuracy = 0.944000
 epoch 15/30. Took 0.1176 seconds. 
  Full-batch training loss = 0.004494, test loss = 0.221190
  Training set accuracy = 0.999800, Test set accuracy = 0.943800
 epoch 16/30. Took 0.11106 seconds. 
  Full-batch training loss = 0.004046, test loss = 0.221794
  Training set accuracy = 0.999800, Test set accuracy = 0.944300
 epoch 17/30. Took 0.11096 seconds. 
  Full-batch training loss = 0.003343, test loss = 0.226903
  Training set accuracy = 0.999800, Test set accuracy = 0.945100
 epoch 18/30. Took 0.11152 seconds. 
  Full-batch training loss = 0.003111, test loss = 0.230378
  Training set accuracy = 0.999800, Test set accuracy = 0.945100
 epoch 19/30. Took 0.11134 seconds. 
  Full-batch training loss = 0.002624, test loss = 0.228835
  Training set accuracy = 0.999800, Test set accuracy = 0.944300
 epoch 20/30. Took 0.11113 seconds. 
  Full-batch training loss = 0.002422, test loss = 0.231802
  Training set accuracy = 1.000000, Test set accuracy = 0.944100
 epoch 21/30. Took 0.11156 seconds. 
  Full-batch training loss = 0.002210, test loss = 0.233792
  Training set accuracy = 1.000000, Test set accuracy = 0.943800
 epoch 22/30. Took 0.11079 seconds. 
  Full-batch training loss = 0.002003, test loss = 0.235169
  Training set accuracy = 1.000000, Test set accuracy = 0.944700
 epoch 23/30. Took 0.11266 seconds. 
  Full-batch training loss = 0.001876, test loss = 0.237963
  Training set accuracy = 1.000000, Test set accuracy = 0.945200
 epoch 24/30. Took 0.11066 seconds. 
  Full-batch training loss = 0.001729, test loss = 0.238991
  Training set accuracy = 1.000000, Test set accuracy = 0.944800
 epoch 25/30. Took 0.1116 seconds. 
  Full-batch training loss = 0.001605, test loss = 0.240688
  Training set accuracy = 1.000000, Test set accuracy = 0.944600
 epoch 26/30. Took 0.11134 seconds. 
  Full-batch training loss = 0.001499, test loss = 0.241770
  Training set accuracy = 1.000000, Test set accuracy = 0.945000
 epoch 27/30. Took 0.11112 seconds. 
  Full-batch training loss = 0.001411, test loss = 0.243742
  Training set accuracy = 1.000000, Test set accuracy = 0.945000
 epoch 28/30. Took 0.11707 seconds. 
  Full-batch training loss = 0.001354, test loss = 0.245297
  Training set accuracy = 1.000000, Test set accuracy = 0.945200
 epoch 29/30. Took 0.10974 seconds. 
  Full-batch training loss = 0.001261, test loss = 0.245105
  Training set accuracy = 1.000000, Test set accuracy = 0.945600
 epoch 30/30. Took 0.11377 seconds. 
  Full-batch training loss = 0.001178, test loss = 0.246911
  Training set accuracy = 1.000000, Test set accuracy = 0.945500
Elapsed time is 8.543640 seconds.
End Training
-----
Params 5000 0.100 0.00 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.19986 seconds. 
  Full-batch training loss = 0.404890, test loss = 0.423648
  Training set accuracy = 0.869200, Test set accuracy = 0.861900
 epoch 2/30. Took 0.21291 seconds. 
  Full-batch training loss = 0.249634, test loss = 0.299485
  Training set accuracy = 0.925600, Test set accuracy = 0.905600
 epoch 3/30. Took 0.21104 seconds. 
  Full-batch training loss = 0.170944, test loss = 0.256142
  Training set accuracy = 0.946800, Test set accuracy = 0.919800
 epoch 4/30. Took 0.19624 seconds. 
  Full-batch training loss = 0.151655, test loss = 0.254951
  Training set accuracy = 0.953000, Test set accuracy = 0.922800
 epoch 5/30. Took 0.19712 seconds. 
  Full-batch training loss = 0.097703, test loss = 0.224191
  Training set accuracy = 0.970600, Test set accuracy = 0.929800
 epoch 6/30. Took 0.18939 seconds. 
  Full-batch training loss = 0.059217, test loss = 0.195711
  Training set accuracy = 0.986400, Test set accuracy = 0.941500
 epoch 7/30. Took 0.18984 seconds. 
  Full-batch training loss = 0.068209, test loss = 0.243610
  Training set accuracy = 0.980200, Test set accuracy = 0.930000
 epoch 8/30. Took 0.18896 seconds. 
  Full-batch training loss = 0.031656, test loss = 0.200787
  Training set accuracy = 0.993800, Test set accuracy = 0.942200
 epoch 9/30. Took 0.19045 seconds. 
  Full-batch training loss = 0.028506, test loss = 0.215901
  Training set accuracy = 0.994600, Test set accuracy = 0.939600
 epoch 10/30. Took 0.18992 seconds. 
  Full-batch training loss = 0.015252, test loss = 0.192503
  Training set accuracy = 0.998000, Test set accuracy = 0.945300
 epoch 11/30. Took 0.19953 seconds. 
  Full-batch training loss = 0.009629, test loss = 0.200215
  Training set accuracy = 0.999200, Test set accuracy = 0.945100
 epoch 12/30. Took 0.18744 seconds. 
  Full-batch training loss = 0.005784, test loss = 0.195412
  Training set accuracy = 1.000000, Test set accuracy = 0.947300
 epoch 13/30. Took 0.18894 seconds. 
  Full-batch training loss = 0.006198, test loss = 0.210685
  Training set accuracy = 0.999800, Test set accuracy = 0.944400
 epoch 14/30. Took 0.18686 seconds. 
  Full-batch training loss = 0.003997, test loss = 0.208490
  Training set accuracy = 1.000000, Test set accuracy = 0.947300
 epoch 15/30. Took 0.19097 seconds. 
  Full-batch training loss = 0.003291, test loss = 0.207458
  Training set accuracy = 1.000000, Test set accuracy = 0.946800
 epoch 16/30. Took 0.18741 seconds. 
  Full-batch training loss = 0.002979, test loss = 0.209294
  Training set accuracy = 1.000000, Test set accuracy = 0.948100
 epoch 17/30. Took 0.18851 seconds. 
  Full-batch training loss = 0.002778, test loss = 0.211854
  Training set accuracy = 1.000000, Test set accuracy = 0.947100
 epoch 18/30. Took 0.18727 seconds. 
  Full-batch training loss = 0.002274, test loss = 0.215162
  Training set accuracy = 1.000000, Test set accuracy = 0.947800
 epoch 19/30. Took 0.19105 seconds. 
  Full-batch training loss = 0.002089, test loss = 0.215082
  Training set accuracy = 1.000000, Test set accuracy = 0.947800
 epoch 20/30. Took 0.18857 seconds. 
  Full-batch training loss = 0.001915, test loss = 0.217925
  Training set accuracy = 1.000000, Test set accuracy = 0.947700
 epoch 21/30. Took 0.19036 seconds. 
  Full-batch training loss = 0.001822, test loss = 0.219826
  Training set accuracy = 1.000000, Test set accuracy = 0.947900
 epoch 22/30. Took 0.1897 seconds. 
  Full-batch training loss = 0.001639, test loss = 0.220677
  Training set accuracy = 1.000000, Test set accuracy = 0.947100
 epoch 23/30. Took 0.19212 seconds. 
  Full-batch training loss = 0.001528, test loss = 0.221827
  Training set accuracy = 1.000000, Test set accuracy = 0.948100
 epoch 24/30. Took 0.18895 seconds. 
  Full-batch training loss = 0.001439, test loss = 0.223520
  Training set accuracy = 1.000000, Test set accuracy = 0.948700
 epoch 25/30. Took 0.1892 seconds. 
  Full-batch training loss = 0.001352, test loss = 0.224004
  Training set accuracy = 1.000000, Test set accuracy = 0.948100
 epoch 26/30. Took 0.19018 seconds. 
  Full-batch training loss = 0.001319, test loss = 0.227357
  Training set accuracy = 1.000000, Test set accuracy = 0.948200
 epoch 27/30. Took 0.18953 seconds. 
  Full-batch training loss = 0.001210, test loss = 0.227315
  Training set accuracy = 1.000000, Test set accuracy = 0.947500
 epoch 28/30. Took 0.19204 seconds. 
  Full-batch training loss = 0.001142, test loss = 0.229307
  Training set accuracy = 1.000000, Test set accuracy = 0.947600
 epoch 29/30. Took 0.18915 seconds. 
  Full-batch training loss = 0.001102, test loss = 0.229479
  Training set accuracy = 1.000000, Test set accuracy = 0.948200
 epoch 30/30. Took 0.18834 seconds. 
  Full-batch training loss = 0.001043, test loss = 0.229998
  Training set accuracy = 1.000000, Test set accuracy = 0.948100
Elapsed time is 14.171645 seconds.
End Training
-----
Params 5000 0.100 0.00 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.51865 seconds. 
  Full-batch training loss = 0.340762, test loss = 0.373045
  Training set accuracy = 0.904400, Test set accuracy = 0.886900
 epoch 2/30. Took 0.52924 seconds. 
  Full-batch training loss = 0.223289, test loss = 0.297392
  Training set accuracy = 0.934800, Test set accuracy = 0.912100
 epoch 3/30. Took 0.51103 seconds. 
  Full-batch training loss = 0.147021, test loss = 0.234649
  Training set accuracy = 0.959200, Test set accuracy = 0.931500
 epoch 4/30. Took 0.52845 seconds. 
  Full-batch training loss = 0.113428, test loss = 0.226155
  Training set accuracy = 0.969400, Test set accuracy = 0.929700
 epoch 5/30. Took 0.50847 seconds. 
  Full-batch training loss = 0.064601, test loss = 0.184803
  Training set accuracy = 0.986200, Test set accuracy = 0.941900
 epoch 6/30. Took 0.54698 seconds. 
  Full-batch training loss = 0.045235, test loss = 0.192825
  Training set accuracy = 0.990800, Test set accuracy = 0.944700
 epoch 7/30. Took 0.50962 seconds. 
  Full-batch training loss = 0.038237, test loss = 0.193043
  Training set accuracy = 0.992200, Test set accuracy = 0.943600
 epoch 8/30. Took 0.52233 seconds. 
  Full-batch training loss = 0.022325, test loss = 0.182555
  Training set accuracy = 0.997000, Test set accuracy = 0.947500
 epoch 9/30. Took 0.50895 seconds. 
  Full-batch training loss = 0.012456, test loss = 0.178678
  Training set accuracy = 0.999200, Test set accuracy = 0.948400
 epoch 10/30. Took 0.5109 seconds. 
  Full-batch training loss = 0.008899, test loss = 0.182222
  Training set accuracy = 0.999800, Test set accuracy = 0.948300
 epoch 11/30. Took 0.51042 seconds. 
  Full-batch training loss = 0.006428, test loss = 0.181228
  Training set accuracy = 1.000000, Test set accuracy = 0.948500
 epoch 12/30. Took 0.51079 seconds. 
  Full-batch training loss = 0.010815, test loss = 0.196047
  Training set accuracy = 0.998200, Test set accuracy = 0.948400
 epoch 13/30. Took 0.50933 seconds. 
  Full-batch training loss = 0.003873, test loss = 0.186023
  Training set accuracy = 1.000000, Test set accuracy = 0.950700
 epoch 14/30. Took 0.5069 seconds. 
  Full-batch training loss = 0.003333, test loss = 0.187890
  Training set accuracy = 1.000000, Test set accuracy = 0.950600
 epoch 15/30. Took 0.5104 seconds. 
  Full-batch training loss = 0.003075, test loss = 0.193784
  Training set accuracy = 1.000000, Test set accuracy = 0.950600
 epoch 16/30. Took 0.52457 seconds. 
  Full-batch training loss = 0.002573, test loss = 0.191306
  Training set accuracy = 1.000000, Test set accuracy = 0.950800
 epoch 17/30. Took 0.51731 seconds. 
  Full-batch training loss = 0.002375, test loss = 0.189828
  Training set accuracy = 1.000000, Test set accuracy = 0.950800
 epoch 18/30. Took 0.51213 seconds. 
  Full-batch training loss = 0.002112, test loss = 0.192494
  Training set accuracy = 1.000000, Test set accuracy = 0.951000
 epoch 19/30. Took 0.53628 seconds. 
  Full-batch training loss = 0.001931, test loss = 0.193665
  Training set accuracy = 1.000000, Test set accuracy = 0.951100
 epoch 20/30. Took 0.50977 seconds. 
  Full-batch training loss = 0.001775, test loss = 0.196302
  Training set accuracy = 1.000000, Test set accuracy = 0.951100
 epoch 21/30. Took 0.50963 seconds. 
  Full-batch training loss = 0.001669, test loss = 0.197371
  Training set accuracy = 1.000000, Test set accuracy = 0.951800
 epoch 22/30. Took 0.5082 seconds. 
  Full-batch training loss = 0.001536, test loss = 0.198925
  Training set accuracy = 1.000000, Test set accuracy = 0.950800
 epoch 23/30. Took 0.51119 seconds. 
  Full-batch training loss = 0.001444, test loss = 0.199533
  Training set accuracy = 1.000000, Test set accuracy = 0.951500
 epoch 24/30. Took 0.50908 seconds. 
  Full-batch training loss = 0.001357, test loss = 0.201121
  Training set accuracy = 1.000000, Test set accuracy = 0.951000
 epoch 25/30. Took 0.51945 seconds. 
  Full-batch training loss = 0.001290, test loss = 0.202274
  Training set accuracy = 1.000000, Test set accuracy = 0.951700
 epoch 26/30. Took 0.50982 seconds. 
  Full-batch training loss = 0.001203, test loss = 0.202362
  Training set accuracy = 1.000000, Test set accuracy = 0.951500
 epoch 27/30. Took 0.51192 seconds. 
  Full-batch training loss = 0.001132, test loss = 0.203705
  Training set accuracy = 1.000000, Test set accuracy = 0.951300
 epoch 28/30. Took 0.52387 seconds. 
  Full-batch training loss = 0.001089, test loss = 0.205925
  Training set accuracy = 1.000000, Test set accuracy = 0.951500
 epoch 29/30. Took 0.50986 seconds. 
  Full-batch training loss = 0.001047, test loss = 0.204948
  Training set accuracy = 1.000000, Test set accuracy = 0.952000
 epoch 30/30. Took 0.50731 seconds. 
  Full-batch training loss = 0.000976, test loss = 0.205441
  Training set accuracy = 1.000000, Test set accuracy = 0.951700
Elapsed time is 33.958924 seconds.
End Training
-----
Params 5000 0.100 0.00 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.12896 seconds. 
  Full-batch training loss = 0.438372, test loss = 0.467537
  Training set accuracy = 0.873200, Test set accuracy = 0.864700
 epoch 2/30. Took 0.12563 seconds. 
  Full-batch training loss = 0.220333, test loss = 0.300698
  Training set accuracy = 0.935800, Test set accuracy = 0.907900
 epoch 3/30. Took 0.12768 seconds. 
  Full-batch training loss = 0.178048, test loss = 0.269835
  Training set accuracy = 0.948800, Test set accuracy = 0.916900
 epoch 4/30. Took 0.12301 seconds. 
  Full-batch training loss = 0.110881, test loss = 0.248663
  Training set accuracy = 0.967600, Test set accuracy = 0.926700
 epoch 5/30. Took 0.12664 seconds. 
  Full-batch training loss = 0.065123, test loss = 0.223657
  Training set accuracy = 0.981600, Test set accuracy = 0.933300
 epoch 6/30. Took 0.12768 seconds. 
  Full-batch training loss = 0.201745, test loss = 0.386598
  Training set accuracy = 0.932400, Test set accuracy = 0.885600
 epoch 7/30. Took 0.12769 seconds. 
  Full-batch training loss = 0.041364, test loss = 0.228854
  Training set accuracy = 0.988200, Test set accuracy = 0.936000
 epoch 8/30. Took 0.12743 seconds. 
  Full-batch training loss = 0.028984, test loss = 0.234243
  Training set accuracy = 0.992600, Test set accuracy = 0.937400
 epoch 9/30. Took 0.12679 seconds. 
  Full-batch training loss = 0.017214, test loss = 0.235927
  Training set accuracy = 0.996800, Test set accuracy = 0.939500
 epoch 10/30. Took 0.13226 seconds. 
  Full-batch training loss = 0.011116, test loss = 0.238548
  Training set accuracy = 0.997200, Test set accuracy = 0.940800
 epoch 11/30. Took 0.12114 seconds. 
  Full-batch training loss = 0.004795, test loss = 0.233678
  Training set accuracy = 0.999400, Test set accuracy = 0.945300
 epoch 12/30. Took 0.12337 seconds. 
  Full-batch training loss = 0.004637, test loss = 0.243492
  Training set accuracy = 1.000000, Test set accuracy = 0.942300
 epoch 13/30. Took 0.12325 seconds. 
  Full-batch training loss = 0.002779, test loss = 0.254884
  Training set accuracy = 1.000000, Test set accuracy = 0.943500
 epoch 14/30. Took 0.12618 seconds. 
  Full-batch training loss = 0.001346, test loss = 0.259094
  Training set accuracy = 1.000000, Test set accuracy = 0.943900
 epoch 15/30. Took 0.12625 seconds. 
  Full-batch training loss = 0.001100, test loss = 0.262601
  Training set accuracy = 1.000000, Test set accuracy = 0.944100
 epoch 16/30. Took 0.12543 seconds. 
  Full-batch training loss = 0.000917, test loss = 0.266800
  Training set accuracy = 1.000000, Test set accuracy = 0.944100
 epoch 17/30. Took 0.12645 seconds. 
  Full-batch training loss = 0.000819, test loss = 0.271332
  Training set accuracy = 1.000000, Test set accuracy = 0.944100
 epoch 18/30. Took 0.12688 seconds. 
  Full-batch training loss = 0.000719, test loss = 0.274427
  Training set accuracy = 1.000000, Test set accuracy = 0.945100
 epoch 19/30. Took 0.12648 seconds. 
  Full-batch training loss = 0.000652, test loss = 0.275821
  Training set accuracy = 1.000000, Test set accuracy = 0.944500
 epoch 20/30. Took 0.12691 seconds. 
  Full-batch training loss = 0.000593, test loss = 0.279606
  Training set accuracy = 1.000000, Test set accuracy = 0.945400
 epoch 21/30. Took 0.12292 seconds. 
  Full-batch training loss = 0.000546, test loss = 0.281118
  Training set accuracy = 1.000000, Test set accuracy = 0.945400
 epoch 22/30. Took 0.12667 seconds. 
  Full-batch training loss = 0.000504, test loss = 0.283976
  Training set accuracy = 1.000000, Test set accuracy = 0.945200
 epoch 23/30. Took 0.12656 seconds. 
  Full-batch training loss = 0.000473, test loss = 0.285280
  Training set accuracy = 1.000000, Test set accuracy = 0.945100
 epoch 24/30. Took 0.1268 seconds. 
  Full-batch training loss = 0.000447, test loss = 0.287843
  Training set accuracy = 1.000000, Test set accuracy = 0.944700
 epoch 25/30. Took 0.13176 seconds. 
  Full-batch training loss = 0.000417, test loss = 0.290080
  Training set accuracy = 1.000000, Test set accuracy = 0.945500
 epoch 26/30. Took 0.13237 seconds. 
  Full-batch training loss = 0.000389, test loss = 0.291462
  Training set accuracy = 1.000000, Test set accuracy = 0.945300
 epoch 27/30. Took 0.12726 seconds. 
  Full-batch training loss = 0.000369, test loss = 0.292762
  Training set accuracy = 1.000000, Test set accuracy = 0.945200
 epoch 28/30. Took 0.12029 seconds. 
  Full-batch training loss = 0.000350, test loss = 0.293871
  Training set accuracy = 1.000000, Test set accuracy = 0.945300
 epoch 29/30. Took 0.12351 seconds. 
  Full-batch training loss = 0.000334, test loss = 0.296118
  Training set accuracy = 1.000000, Test set accuracy = 0.945800
 epoch 30/30. Took 0.12597 seconds. 
  Full-batch training loss = 0.000319, test loss = 0.297234
  Training set accuracy = 1.000000, Test set accuracy = 0.945600
Elapsed time is 9.538278 seconds.
End Training
-----
Params 5000 0.100 0.00 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.2319 seconds. 
  Full-batch training loss = 0.389040, test loss = 0.415021
  Training set accuracy = 0.888800, Test set accuracy = 0.883100
 epoch 2/30. Took 0.22028 seconds. 
  Full-batch training loss = 0.223683, test loss = 0.294036
  Training set accuracy = 0.932200, Test set accuracy = 0.908400
 epoch 3/30. Took 0.21997 seconds. 
  Full-batch training loss = 0.163830, test loss = 0.277046
  Training set accuracy = 0.949200, Test set accuracy = 0.914100
 epoch 4/30. Took 0.22824 seconds. 
  Full-batch training loss = 0.102318, test loss = 0.223087
  Training set accuracy = 0.971000, Test set accuracy = 0.931000
 epoch 5/30. Took 0.22061 seconds. 
  Full-batch training loss = 0.091196, test loss = 0.259559
  Training set accuracy = 0.970200, Test set accuracy = 0.920900
 epoch 6/30. Took 0.21732 seconds. 
  Full-batch training loss = 0.059111, test loss = 0.235124
  Training set accuracy = 0.979800, Test set accuracy = 0.934800
 epoch 7/30. Took 0.22036 seconds. 
  Full-batch training loss = 0.073748, test loss = 0.288793
  Training set accuracy = 0.977200, Test set accuracy = 0.922800
 epoch 8/30. Took 0.21951 seconds. 
  Full-batch training loss = 0.020166, test loss = 0.211329
  Training set accuracy = 0.995800, Test set accuracy = 0.942300
 epoch 9/30. Took 0.22192 seconds. 
  Full-batch training loss = 0.023023, test loss = 0.238959
  Training set accuracy = 0.993000, Test set accuracy = 0.938400
 epoch 10/30. Took 0.22026 seconds. 
  Full-batch training loss = 0.004488, test loss = 0.212998
  Training set accuracy = 0.999600, Test set accuracy = 0.948100
 epoch 11/30. Took 0.22137 seconds. 
  Full-batch training loss = 0.002441, test loss = 0.217693
  Training set accuracy = 1.000000, Test set accuracy = 0.949000
 epoch 12/30. Took 0.21858 seconds. 
  Full-batch training loss = 0.001430, test loss = 0.220196
  Training set accuracy = 1.000000, Test set accuracy = 0.949100
 epoch 13/30. Took 0.21903 seconds. 
  Full-batch training loss = 0.001113, test loss = 0.225104
  Training set accuracy = 1.000000, Test set accuracy = 0.948100
 epoch 14/30. Took 0.24921 seconds. 
  Full-batch training loss = 0.000923, test loss = 0.226953
  Training set accuracy = 1.000000, Test set accuracy = 0.949600
 epoch 15/30. Took 0.22092 seconds. 
  Full-batch training loss = 0.000809, test loss = 0.229600
  Training set accuracy = 1.000000, Test set accuracy = 0.949500
 epoch 16/30. Took 0.21923 seconds. 
  Full-batch training loss = 0.000718, test loss = 0.233143
  Training set accuracy = 1.000000, Test set accuracy = 0.949400
 epoch 17/30. Took 0.22861 seconds. 
  Full-batch training loss = 0.000649, test loss = 0.235682
  Training set accuracy = 1.000000, Test set accuracy = 0.949800
 epoch 18/30. Took 0.22201 seconds. 
  Full-batch training loss = 0.000596, test loss = 0.237913
  Training set accuracy = 1.000000, Test set accuracy = 0.949100
 epoch 19/30. Took 0.23978 seconds. 
  Full-batch training loss = 0.000552, test loss = 0.239948
  Training set accuracy = 1.000000, Test set accuracy = 0.949800
 epoch 20/30. Took 0.21938 seconds. 
  Full-batch training loss = 0.000508, test loss = 0.242009
  Training set accuracy = 1.000000, Test set accuracy = 0.949500
 epoch 21/30. Took 0.2208 seconds. 
  Full-batch training loss = 0.000477, test loss = 0.243950
  Training set accuracy = 1.000000, Test set accuracy = 0.949900
 epoch 22/30. Took 0.24504 seconds. 
  Full-batch training loss = 0.000442, test loss = 0.245087
  Training set accuracy = 1.000000, Test set accuracy = 0.949900
 epoch 23/30. Took 0.22046 seconds. 
  Full-batch training loss = 0.000418, test loss = 0.247326
  Training set accuracy = 1.000000, Test set accuracy = 0.949800
 epoch 24/30. Took 0.22704 seconds. 
  Full-batch training loss = 0.000391, test loss = 0.248993
  Training set accuracy = 1.000000, Test set accuracy = 0.949500
 epoch 25/30. Took 0.22203 seconds. 
  Full-batch training loss = 0.000370, test loss = 0.250257
  Training set accuracy = 1.000000, Test set accuracy = 0.949400
 epoch 26/30. Took 0.22021 seconds. 
  Full-batch training loss = 0.000352, test loss = 0.251515
  Training set accuracy = 1.000000, Test set accuracy = 0.949400
 epoch 27/30. Took 0.22351 seconds. 
  Full-batch training loss = 0.000336, test loss = 0.252777
  Training set accuracy = 1.000000, Test set accuracy = 0.949500
 epoch 28/30. Took 0.21931 seconds. 
  Full-batch training loss = 0.000318, test loss = 0.253785
  Training set accuracy = 1.000000, Test set accuracy = 0.949400
 epoch 29/30. Took 0.22026 seconds. 
  Full-batch training loss = 0.000305, test loss = 0.255285
  Training set accuracy = 1.000000, Test set accuracy = 0.949400
 epoch 30/30. Took 0.22777 seconds. 
  Full-batch training loss = 0.000291, test loss = 0.256265
  Training set accuracy = 1.000000, Test set accuracy = 0.949100
Elapsed time is 16.905229 seconds.
End Training
-----
Params 5000 0.100 0.00 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.70517 seconds. 
  Full-batch training loss = 0.358665, test loss = 0.388557
  Training set accuracy = 0.899600, Test set accuracy = 0.882400
 epoch 2/30. Took 0.71082 seconds. 
  Full-batch training loss = 0.185499, test loss = 0.256747
  Training set accuracy = 0.945000, Test set accuracy = 0.919300
 epoch 3/30. Took 0.70036 seconds. 
  Full-batch training loss = 0.128073, test loss = 0.241406
  Training set accuracy = 0.961800, Test set accuracy = 0.926800
 epoch 4/30. Took 0.70554 seconds. 
  Full-batch training loss = 0.114501, test loss = 0.256972
  Training set accuracy = 0.967600, Test set accuracy = 0.921400
 epoch 5/30. Took 0.69821 seconds. 
  Full-batch training loss = 0.039890, test loss = 0.177430
  Training set accuracy = 0.991400, Test set accuracy = 0.945000
 epoch 6/30. Took 0.70818 seconds. 
  Full-batch training loss = 0.045749, test loss = 0.213308
  Training set accuracy = 0.986200, Test set accuracy = 0.939700
 epoch 7/30. Took 0.71745 seconds. 
  Full-batch training loss = 0.019710, test loss = 0.169969
  Training set accuracy = 0.995800, Test set accuracy = 0.950000
 epoch 8/30. Took 0.70038 seconds. 
  Full-batch training loss = 0.009020, test loss = 0.176993
  Training set accuracy = 0.999200, Test set accuracy = 0.950600
 epoch 9/30. Took 0.70097 seconds. 
  Full-batch training loss = 0.010072, test loss = 0.205058
  Training set accuracy = 0.998600, Test set accuracy = 0.944100
 epoch 10/30. Took 0.70236 seconds. 
  Full-batch training loss = 0.002183, test loss = 0.176167
  Training set accuracy = 0.999800, Test set accuracy = 0.955300
 epoch 11/30. Took 0.72436 seconds. 
  Full-batch training loss = 0.001558, test loss = 0.175854
  Training set accuracy = 1.000000, Test set accuracy = 0.955100
 epoch 12/30. Took 0.7037 seconds. 
  Full-batch training loss = 0.001078, test loss = 0.178544
  Training set accuracy = 1.000000, Test set accuracy = 0.956000
 epoch 13/30. Took 0.80116 seconds. 
  Full-batch training loss = 0.000901, test loss = 0.181516
  Training set accuracy = 1.000000, Test set accuracy = 0.956000
 epoch 14/30. Took 0.79249 seconds. 
  Full-batch training loss = 0.000794, test loss = 0.184737
  Training set accuracy = 1.000000, Test set accuracy = 0.955800
 epoch 15/30. Took 0.70072 seconds. 
  Full-batch training loss = 0.000708, test loss = 0.187867
  Training set accuracy = 1.000000, Test set accuracy = 0.955100
 epoch 16/30. Took 0.70323 seconds. 
  Full-batch training loss = 0.000632, test loss = 0.189304
  Training set accuracy = 1.000000, Test set accuracy = 0.955300
 epoch 17/30. Took 0.70812 seconds. 
  Full-batch training loss = 0.000578, test loss = 0.190581
  Training set accuracy = 1.000000, Test set accuracy = 0.955500
 epoch 18/30. Took 0.7062 seconds. 
  Full-batch training loss = 0.000534, test loss = 0.193481
  Training set accuracy = 1.000000, Test set accuracy = 0.955100
 epoch 19/30. Took 0.72621 seconds. 
  Full-batch training loss = 0.000496, test loss = 0.195312
  Training set accuracy = 1.000000, Test set accuracy = 0.955500
 epoch 20/30. Took 0.7005 seconds. 
  Full-batch training loss = 0.000457, test loss = 0.195719
  Training set accuracy = 1.000000, Test set accuracy = 0.955200
 epoch 21/30. Took 0.70229 seconds. 
  Full-batch training loss = 0.000429, test loss = 0.196372
  Training set accuracy = 1.000000, Test set accuracy = 0.955400
 epoch 22/30. Took 0.70256 seconds. 
  Full-batch training loss = 0.000403, test loss = 0.198984
  Training set accuracy = 1.000000, Test set accuracy = 0.955300
 epoch 23/30. Took 0.70305 seconds. 
  Full-batch training loss = 0.000380, test loss = 0.200004
  Training set accuracy = 1.000000, Test set accuracy = 0.955500
 epoch 24/30. Took 0.72183 seconds. 
  Full-batch training loss = 0.000359, test loss = 0.200843
  Training set accuracy = 1.000000, Test set accuracy = 0.955000
 epoch 25/30. Took 0.80439 seconds. 
  Full-batch training loss = 0.000339, test loss = 0.201693
  Training set accuracy = 1.000000, Test set accuracy = 0.955100
 epoch 26/30. Took 0.69869 seconds. 
  Full-batch training loss = 0.000325, test loss = 0.202212
  Training set accuracy = 1.000000, Test set accuracy = 0.955100
 epoch 27/30. Took 0.70093 seconds. 
  Full-batch training loss = 0.000309, test loss = 0.203227
  Training set accuracy = 1.000000, Test set accuracy = 0.955100
 epoch 28/30. Took 0.70106 seconds. 
  Full-batch training loss = 0.000295, test loss = 0.204693
  Training set accuracy = 1.000000, Test set accuracy = 0.955200
 epoch 29/30. Took 0.70037 seconds. 
  Full-batch training loss = 0.000282, test loss = 0.205239
  Training set accuracy = 1.000000, Test set accuracy = 0.955300
 epoch 30/30. Took 0.70504 seconds. 
  Full-batch training loss = 0.000271, test loss = 0.206144
  Training set accuracy = 1.000000, Test set accuracy = 0.955300
Elapsed time is 46.525544 seconds.
End Training
-----
Params 5000 0.100 0.10 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11669 seconds. 
  Full-batch training loss = 0.387076, test loss = 0.397745
  Training set accuracy = 0.888400, Test set accuracy = 0.886000
 epoch 2/30. Took 0.10519 seconds. 
  Full-batch training loss = 0.294831, test loss = 0.331832
  Training set accuracy = 0.916800, Test set accuracy = 0.903900
 epoch 3/30. Took 0.10762 seconds. 
  Full-batch training loss = 0.250417, test loss = 0.297870
  Training set accuracy = 0.928600, Test set accuracy = 0.915900
 epoch 4/30. Took 0.10893 seconds. 
  Full-batch training loss = 0.203908, test loss = 0.271721
  Training set accuracy = 0.941000, Test set accuracy = 0.921400
 epoch 5/30. Took 0.10887 seconds. 
  Full-batch training loss = 0.174490, test loss = 0.252092
  Training set accuracy = 0.952600, Test set accuracy = 0.926900
 epoch 6/30. Took 0.10887 seconds. 
  Full-batch training loss = 0.148821, test loss = 0.241725
  Training set accuracy = 0.962000, Test set accuracy = 0.931600
 epoch 7/30. Took 0.10939 seconds. 
  Full-batch training loss = 0.128472, test loss = 0.228010
  Training set accuracy = 0.967600, Test set accuracy = 0.930600
 epoch 8/30. Took 0.10886 seconds. 
  Full-batch training loss = 0.109942, test loss = 0.221665
  Training set accuracy = 0.973000, Test set accuracy = 0.933600
 epoch 9/30. Took 0.10916 seconds. 
  Full-batch training loss = 0.085850, test loss = 0.202458
  Training set accuracy = 0.981800, Test set accuracy = 0.939400
 epoch 10/30. Took 0.10649 seconds. 
  Full-batch training loss = 0.077439, test loss = 0.199053
  Training set accuracy = 0.985400, Test set accuracy = 0.941100
 epoch 11/30. Took 0.10499 seconds. 
  Full-batch training loss = 0.067193, test loss = 0.195260
  Training set accuracy = 0.988200, Test set accuracy = 0.942200
 epoch 12/30. Took 0.10733 seconds. 
  Full-batch training loss = 0.063184, test loss = 0.199473
  Training set accuracy = 0.988000, Test set accuracy = 0.942800
 epoch 13/30. Took 0.10924 seconds. 
  Full-batch training loss = 0.050321, test loss = 0.193007
  Training set accuracy = 0.990800, Test set accuracy = 0.943200
 epoch 14/30. Took 0.10829 seconds. 
  Full-batch training loss = 0.043209, test loss = 0.191074
  Training set accuracy = 0.994600, Test set accuracy = 0.944200
 epoch 15/30. Took 0.10981 seconds. 
  Full-batch training loss = 0.042966, test loss = 0.198040
  Training set accuracy = 0.994600, Test set accuracy = 0.942500
 epoch 16/30. Took 0.10808 seconds. 
  Full-batch training loss = 0.035807, test loss = 0.189327
  Training set accuracy = 0.995000, Test set accuracy = 0.944300
 epoch 17/30. Took 0.10844 seconds. 
  Full-batch training loss = 0.034954, test loss = 0.192630
  Training set accuracy = 0.994800, Test set accuracy = 0.943500
 epoch 18/30. Took 0.10987 seconds. 
  Full-batch training loss = 0.026712, test loss = 0.188338
  Training set accuracy = 0.998400, Test set accuracy = 0.946100
 epoch 19/30. Took 0.10945 seconds. 
  Full-batch training loss = 0.023874, test loss = 0.190932
  Training set accuracy = 0.997400, Test set accuracy = 0.946100
 epoch 20/30. Took 0.10923 seconds. 
  Full-batch training loss = 0.022930, test loss = 0.189808
  Training set accuracy = 0.998600, Test set accuracy = 0.945500
 epoch 21/30. Took 0.10975 seconds. 
  Full-batch training loss = 0.019404, test loss = 0.184348
  Training set accuracy = 0.998800, Test set accuracy = 0.947900
 epoch 22/30. Took 0.11373 seconds. 
  Full-batch training loss = 0.019018, test loss = 0.187385
  Training set accuracy = 0.998800, Test set accuracy = 0.946200
 epoch 23/30. Took 0.11498 seconds. 
  Full-batch training loss = 0.016495, test loss = 0.183935
  Training set accuracy = 0.999400, Test set accuracy = 0.948600
 epoch 24/30. Took 0.11777 seconds. 
  Full-batch training loss = 0.015440, test loss = 0.193671
  Training set accuracy = 0.999200, Test set accuracy = 0.947700
 epoch 25/30. Took 0.11728 seconds. 
  Full-batch training loss = 0.015793, test loss = 0.188790
  Training set accuracy = 0.998800, Test set accuracy = 0.947500
 epoch 26/30. Took 0.10457 seconds. 
  Full-batch training loss = 0.012341, test loss = 0.190533
  Training set accuracy = 0.999000, Test set accuracy = 0.948900
 epoch 27/30. Took 0.10854 seconds. 
  Full-batch training loss = 0.011399, test loss = 0.190743
  Training set accuracy = 0.999400, Test set accuracy = 0.949400
 epoch 28/30. Took 0.11862 seconds. 
  Full-batch training loss = 0.009792, test loss = 0.192694
  Training set accuracy = 0.999600, Test set accuracy = 0.947800
 epoch 29/30. Took 0.10869 seconds. 
  Full-batch training loss = 0.009905, test loss = 0.187660
  Training set accuracy = 1.000000, Test set accuracy = 0.948600
 epoch 30/30. Took 0.10897 seconds. 
  Full-batch training loss = 0.010494, test loss = 0.189537
  Training set accuracy = 0.999800, Test set accuracy = 0.946800
Elapsed time is 8.077210 seconds.
End Training
-----
Params 5000 0.100 0.10 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.1742 seconds. 
  Full-batch training loss = 0.374744, test loss = 0.399121
  Training set accuracy = 0.893800, Test set accuracy = 0.887000
 epoch 2/30. Took 0.17003 seconds. 
  Full-batch training loss = 0.328548, test loss = 0.382942
  Training set accuracy = 0.894000, Test set accuracy = 0.878500
 epoch 3/30. Took 0.16645 seconds. 
  Full-batch training loss = 0.221703, test loss = 0.284909
  Training set accuracy = 0.939600, Test set accuracy = 0.917000
 epoch 4/30. Took 0.16891 seconds. 
  Full-batch training loss = 0.189748, test loss = 0.274296
  Training set accuracy = 0.948800, Test set accuracy = 0.919700
 epoch 5/30. Took 0.17036 seconds. 
  Full-batch training loss = 0.163559, test loss = 0.259529
  Training set accuracy = 0.955200, Test set accuracy = 0.922900
 epoch 6/30. Took 0.16891 seconds. 
  Full-batch training loss = 0.129737, test loss = 0.233038
  Training set accuracy = 0.967800, Test set accuracy = 0.932700
 epoch 7/30. Took 0.16963 seconds. 
  Full-batch training loss = 0.115668, test loss = 0.226422
  Training set accuracy = 0.971800, Test set accuracy = 0.930400
 epoch 8/30. Took 0.16958 seconds. 
  Full-batch training loss = 0.093393, test loss = 0.217096
  Training set accuracy = 0.976800, Test set accuracy = 0.935200
 epoch 9/30. Took 0.18062 seconds. 
  Full-batch training loss = 0.082665, test loss = 0.210057
  Training set accuracy = 0.981000, Test set accuracy = 0.934000
 epoch 10/30. Took 0.16878 seconds. 
  Full-batch training loss = 0.064616, test loss = 0.200957
  Training set accuracy = 0.986000, Test set accuracy = 0.940100
 epoch 11/30. Took 0.1684 seconds. 
  Full-batch training loss = 0.057272, test loss = 0.202495
  Training set accuracy = 0.987400, Test set accuracy = 0.939400
 epoch 12/30. Took 0.16838 seconds. 
  Full-batch training loss = 0.047854, test loss = 0.195717
  Training set accuracy = 0.991800, Test set accuracy = 0.940600
 epoch 13/30. Took 0.16855 seconds. 
  Full-batch training loss = 0.036634, test loss = 0.187421
  Training set accuracy = 0.996400, Test set accuracy = 0.943800
 epoch 14/30. Took 0.17691 seconds. 
  Full-batch training loss = 0.031970, test loss = 0.185670
  Training set accuracy = 0.996600, Test set accuracy = 0.945400
 epoch 15/30. Took 0.17116 seconds. 
  Full-batch training loss = 0.029493, test loss = 0.193289
  Training set accuracy = 0.997600, Test set accuracy = 0.943000
 epoch 16/30. Took 0.16872 seconds. 
  Full-batch training loss = 0.023792, test loss = 0.183090
  Training set accuracy = 0.999000, Test set accuracy = 0.944600
 epoch 17/30. Took 0.17003 seconds. 
  Full-batch training loss = 0.023027, test loss = 0.188745
  Training set accuracy = 0.998800, Test set accuracy = 0.945000
 epoch 18/30. Took 0.19131 seconds. 
  Full-batch training loss = 0.017745, test loss = 0.178723
  Training set accuracy = 0.999400, Test set accuracy = 0.950000
 epoch 19/30. Took 0.16671 seconds. 
  Full-batch training loss = 0.016895, test loss = 0.186803
  Training set accuracy = 0.999600, Test set accuracy = 0.946800
 epoch 20/30. Took 0.16867 seconds. 
  Full-batch training loss = 0.014631, test loss = 0.184569
  Training set accuracy = 0.999800, Test set accuracy = 0.947900
 epoch 21/30. Took 0.16918 seconds. 
  Full-batch training loss = 0.013236, test loss = 0.182619
  Training set accuracy = 1.000000, Test set accuracy = 0.949000
 epoch 22/30. Took 0.16987 seconds. 
  Full-batch training loss = 0.011924, test loss = 0.184806
  Training set accuracy = 1.000000, Test set accuracy = 0.948200
 epoch 23/30. Took 0.1697 seconds. 
  Full-batch training loss = 0.010338, test loss = 0.180357
  Training set accuracy = 1.000000, Test set accuracy = 0.948500
 epoch 24/30. Took 0.16928 seconds. 
  Full-batch training loss = 0.009534, test loss = 0.184518
  Training set accuracy = 1.000000, Test set accuracy = 0.949800
 epoch 25/30. Took 0.17014 seconds. 
  Full-batch training loss = 0.010076, test loss = 0.184900
  Training set accuracy = 0.999800, Test set accuracy = 0.947800
 epoch 26/30. Took 0.16835 seconds. 
  Full-batch training loss = 0.008356, test loss = 0.183578
  Training set accuracy = 1.000000, Test set accuracy = 0.949600
 epoch 27/30. Took 0.17058 seconds. 
  Full-batch training loss = 0.007237, test loss = 0.178251
  Training set accuracy = 1.000000, Test set accuracy = 0.951800
 epoch 28/30. Took 0.16875 seconds. 
  Full-batch training loss = 0.006941, test loss = 0.182240
  Training set accuracy = 1.000000, Test set accuracy = 0.951700
 epoch 29/30. Took 0.16897 seconds. 
  Full-batch training loss = 0.007024, test loss = 0.185083
  Training set accuracy = 1.000000, Test set accuracy = 0.950000
 epoch 30/30. Took 0.16866 seconds. 
  Full-batch training loss = 0.006267, test loss = 0.186405
  Training set accuracy = 1.000000, Test set accuracy = 0.948800
Elapsed time is 11.684106 seconds.
End Training
-----
Params 5000 0.100 0.10 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.3641 seconds. 
  Full-batch training loss = 0.381384, test loss = 0.393836
  Training set accuracy = 0.883000, Test set accuracy = 0.880500
 epoch 2/30. Took 0.3541 seconds. 
  Full-batch training loss = 0.274897, test loss = 0.312209
  Training set accuracy = 0.926000, Test set accuracy = 0.912600
 epoch 3/30. Took 0.35678 seconds. 
  Full-batch training loss = 0.242778, test loss = 0.300720
  Training set accuracy = 0.933200, Test set accuracy = 0.910200
 epoch 4/30. Took 0.37314 seconds. 
  Full-batch training loss = 0.190931, test loss = 0.266507
  Training set accuracy = 0.951200, Test set accuracy = 0.921700
 epoch 5/30. Took 0.356 seconds. 
  Full-batch training loss = 0.153647, test loss = 0.241348
  Training set accuracy = 0.961600, Test set accuracy = 0.930800
 epoch 6/30. Took 0.37578 seconds. 
  Full-batch training loss = 0.121137, test loss = 0.220950
  Training set accuracy = 0.968400, Test set accuracy = 0.933000
 epoch 7/30. Took 0.35932 seconds. 
  Full-batch training loss = 0.097175, test loss = 0.210904
  Training set accuracy = 0.980000, Test set accuracy = 0.937100
 epoch 8/30. Took 0.35722 seconds. 
  Full-batch training loss = 0.081241, test loss = 0.200596
  Training set accuracy = 0.981400, Test set accuracy = 0.940100
 epoch 9/30. Took 0.35766 seconds. 
  Full-batch training loss = 0.071967, test loss = 0.194947
  Training set accuracy = 0.986800, Test set accuracy = 0.942900
 epoch 10/30. Took 0.35747 seconds. 
  Full-batch training loss = 0.055024, test loss = 0.182503
  Training set accuracy = 0.990000, Test set accuracy = 0.944800
 epoch 11/30. Took 0.35647 seconds. 
  Full-batch training loss = 0.045283, test loss = 0.184028
  Training set accuracy = 0.992600, Test set accuracy = 0.945900
 epoch 12/30. Took 0.38201 seconds. 
  Full-batch training loss = 0.039231, test loss = 0.178804
  Training set accuracy = 0.994400, Test set accuracy = 0.947900
 epoch 13/30. Took 0.3561 seconds. 
  Full-batch training loss = 0.033095, test loss = 0.178715
  Training set accuracy = 0.996800, Test set accuracy = 0.946900
 epoch 14/30. Took 0.38313 seconds. 
  Full-batch training loss = 0.027245, test loss = 0.174595
  Training set accuracy = 0.998200, Test set accuracy = 0.950100
 epoch 15/30. Took 0.35397 seconds. 
  Full-batch training loss = 0.023787, test loss = 0.175861
  Training set accuracy = 0.998600, Test set accuracy = 0.949600
 epoch 16/30. Took 0.35678 seconds. 
  Full-batch training loss = 0.020892, test loss = 0.175647
  Training set accuracy = 0.999200, Test set accuracy = 0.950500
 epoch 17/30. Took 0.38187 seconds. 
  Full-batch training loss = 0.019009, test loss = 0.176591
  Training set accuracy = 0.999400, Test set accuracy = 0.950000
 epoch 18/30. Took 0.35292 seconds. 
  Full-batch training loss = 0.015914, test loss = 0.173085
  Training set accuracy = 0.999600, Test set accuracy = 0.949200
 epoch 19/30. Took 0.36272 seconds. 
  Full-batch training loss = 0.014783, test loss = 0.173884
  Training set accuracy = 0.999800, Test set accuracy = 0.951300
 epoch 20/30. Took 0.37535 seconds. 
  Full-batch training loss = 0.014635, test loss = 0.178982
  Training set accuracy = 0.999600, Test set accuracy = 0.950500
 epoch 21/30. Took 0.352 seconds. 
  Full-batch training loss = 0.010905, test loss = 0.173700
  Training set accuracy = 1.000000, Test set accuracy = 0.951900
 epoch 22/30. Took 0.35405 seconds. 
  Full-batch training loss = 0.010917, test loss = 0.177041
  Training set accuracy = 1.000000, Test set accuracy = 0.951200
 epoch 23/30. Took 0.36492 seconds. 
  Full-batch training loss = 0.010067, test loss = 0.174447
  Training set accuracy = 1.000000, Test set accuracy = 0.950600
 epoch 24/30. Took 0.35664 seconds. 
  Full-batch training loss = 0.008687, test loss = 0.173367
  Training set accuracy = 1.000000, Test set accuracy = 0.952500
 epoch 25/30. Took 0.36128 seconds. 
  Full-batch training loss = 0.008012, test loss = 0.174058
  Training set accuracy = 1.000000, Test set accuracy = 0.952100
 epoch 26/30. Took 0.35753 seconds. 
  Full-batch training loss = 0.007794, test loss = 0.179825
  Training set accuracy = 1.000000, Test set accuracy = 0.949800
 epoch 27/30. Took 0.3813 seconds. 
  Full-batch training loss = 0.006670, test loss = 0.176129
  Training set accuracy = 1.000000, Test set accuracy = 0.952000
 epoch 28/30. Took 0.36876 seconds. 
  Full-batch training loss = 0.006363, test loss = 0.176777
  Training set accuracy = 1.000000, Test set accuracy = 0.952500
 epoch 29/30. Took 0.37576 seconds. 
  Full-batch training loss = 0.006086, test loss = 0.177274
  Training set accuracy = 1.000000, Test set accuracy = 0.951500
 epoch 30/30. Took 0.35244 seconds. 
  Full-batch training loss = 0.005785, test loss = 0.181602
  Training set accuracy = 1.000000, Test set accuracy = 0.952200
Elapsed time is 23.565412 seconds.
End Training
-----
Params 5000 0.100 0.10 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.13757 seconds. 
  Full-batch training loss = 0.367361, test loss = 0.393522
  Training set accuracy = 0.884800, Test set accuracy = 0.882100
 epoch 2/30. Took 0.13018 seconds. 
  Full-batch training loss = 0.294954, test loss = 0.349629
  Training set accuracy = 0.912200, Test set accuracy = 0.891500
 epoch 3/30. Took 0.13577 seconds. 
  Full-batch training loss = 0.196480, test loss = 0.279886
  Training set accuracy = 0.942800, Test set accuracy = 0.916000
 epoch 4/30. Took 0.13359 seconds. 
  Full-batch training loss = 0.160109, test loss = 0.262551
  Training set accuracy = 0.952000, Test set accuracy = 0.919400
 epoch 5/30. Took 0.14718 seconds. 
  Full-batch training loss = 0.117347, test loss = 0.228925
  Training set accuracy = 0.967200, Test set accuracy = 0.930800
 epoch 6/30. Took 0.12651 seconds. 
  Full-batch training loss = 0.109779, test loss = 0.241408
  Training set accuracy = 0.970200, Test set accuracy = 0.925900
 epoch 7/30. Took 0.14304 seconds. 
  Full-batch training loss = 0.072312, test loss = 0.219744
  Training set accuracy = 0.978200, Test set accuracy = 0.934200
 epoch 8/30. Took 0.13523 seconds. 
  Full-batch training loss = 0.051507, test loss = 0.196017
  Training set accuracy = 0.987400, Test set accuracy = 0.941100
 epoch 9/30. Took 0.12844 seconds. 
  Full-batch training loss = 0.042841, test loss = 0.196910
  Training set accuracy = 0.989200, Test set accuracy = 0.941800
 epoch 10/30. Took 0.12731 seconds. 
  Full-batch training loss = 0.051246, test loss = 0.215558
  Training set accuracy = 0.986600, Test set accuracy = 0.936500
 epoch 11/30. Took 0.13042 seconds. 
  Full-batch training loss = 0.043322, test loss = 0.217800
  Training set accuracy = 0.986200, Test set accuracy = 0.935900
 epoch 12/30. Took 0.12823 seconds. 
  Full-batch training loss = 0.027544, test loss = 0.221040
  Training set accuracy = 0.992400, Test set accuracy = 0.939400
 epoch 13/30. Took 0.13573 seconds. 
  Full-batch training loss = 0.020417, test loss = 0.211119
  Training set accuracy = 0.996200, Test set accuracy = 0.942200
 epoch 14/30. Took 0.12899 seconds. 
  Full-batch training loss = 0.024325, test loss = 0.233343
  Training set accuracy = 0.993000, Test set accuracy = 0.938000
 epoch 15/30. Took 0.13267 seconds. 
  Full-batch training loss = 0.013132, test loss = 0.221435
  Training set accuracy = 0.997800, Test set accuracy = 0.944700
 epoch 16/30. Took 0.13551 seconds. 
  Full-batch training loss = 0.012580, test loss = 0.214204
  Training set accuracy = 0.998400, Test set accuracy = 0.944300
 epoch 17/30. Took 0.13575 seconds. 
  Full-batch training loss = 0.008096, test loss = 0.220624
  Training set accuracy = 0.999400, Test set accuracy = 0.944200
 epoch 18/30. Took 0.12877 seconds. 
  Full-batch training loss = 0.008969, test loss = 0.218395
  Training set accuracy = 0.999000, Test set accuracy = 0.944000
 epoch 19/30. Took 0.13178 seconds. 
  Full-batch training loss = 0.008106, test loss = 0.233647
  Training set accuracy = 0.999000, Test set accuracy = 0.943400
 epoch 20/30. Took 0.13451 seconds. 
  Full-batch training loss = 0.004773, test loss = 0.222675
  Training set accuracy = 0.999800, Test set accuracy = 0.944500
 epoch 21/30. Took 0.12744 seconds. 
  Full-batch training loss = 0.006597, test loss = 0.220700
  Training set accuracy = 0.998600, Test set accuracy = 0.946400
 epoch 22/30. Took 0.14193 seconds. 
  Full-batch training loss = 0.002854, test loss = 0.208229
  Training set accuracy = 1.000000, Test set accuracy = 0.949800
 epoch 23/30. Took 0.12743 seconds. 
  Full-batch training loss = 0.002763, test loss = 0.230392
  Training set accuracy = 1.000000, Test set accuracy = 0.948000
 epoch 24/30. Took 0.13214 seconds. 
  Full-batch training loss = 0.006297, test loss = 0.234655
  Training set accuracy = 0.998800, Test set accuracy = 0.946100
 epoch 25/30. Took 0.12768 seconds. 
  Full-batch training loss = 0.003700, test loss = 0.229922
  Training set accuracy = 1.000000, Test set accuracy = 0.947100
 epoch 26/30. Took 0.13177 seconds. 
  Full-batch training loss = 0.002767, test loss = 0.231067
  Training set accuracy = 1.000000, Test set accuracy = 0.946000
 epoch 27/30. Took 0.13507 seconds. 
  Full-batch training loss = 0.003752, test loss = 0.248588
  Training set accuracy = 0.999400, Test set accuracy = 0.944000
 epoch 28/30. Took 0.13495 seconds. 
  Full-batch training loss = 0.002738, test loss = 0.245190
  Training set accuracy = 0.999800, Test set accuracy = 0.944800
 epoch 29/30. Took 0.12667 seconds. 
  Full-batch training loss = 0.002916, test loss = 0.249394
  Training set accuracy = 0.999800, Test set accuracy = 0.942900
 epoch 30/30. Took 0.13538 seconds. 
  Full-batch training loss = 0.001329, test loss = 0.246200
  Training set accuracy = 1.000000, Test set accuracy = 0.947100
Elapsed time is 9.457670 seconds.
End Training
-----
Params 5000 0.100 0.10 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.2307 seconds. 
  Full-batch training loss = 0.339032, test loss = 0.388276
  Training set accuracy = 0.899200, Test set accuracy = 0.884900
 epoch 2/30. Took 0.23902 seconds. 
  Full-batch training loss = 0.225168, test loss = 0.313287
  Training set accuracy = 0.931200, Test set accuracy = 0.909200
 epoch 3/30. Took 0.22186 seconds. 
  Full-batch training loss = 0.153131, test loss = 0.259627
  Training set accuracy = 0.954400, Test set accuracy = 0.923000
 epoch 4/30. Took 0.22445 seconds. 
  Full-batch training loss = 0.118965, test loss = 0.241302
  Training set accuracy = 0.965200, Test set accuracy = 0.929500
 epoch 5/30. Took 0.22827 seconds. 
  Full-batch training loss = 0.092380, test loss = 0.245018
  Training set accuracy = 0.972800, Test set accuracy = 0.929200
 epoch 6/30. Took 0.22859 seconds. 
  Full-batch training loss = 0.068008, test loss = 0.230361
  Training set accuracy = 0.981600, Test set accuracy = 0.931900
 epoch 7/30. Took 0.228 seconds. 
  Full-batch training loss = 0.046356, test loss = 0.219602
  Training set accuracy = 0.989800, Test set accuracy = 0.938300
 epoch 8/30. Took 0.22118 seconds. 
  Full-batch training loss = 0.039898, test loss = 0.212204
  Training set accuracy = 0.990800, Test set accuracy = 0.939500
 epoch 9/30. Took 0.21978 seconds. 
  Full-batch training loss = 0.036434, test loss = 0.218559
  Training set accuracy = 0.991000, Test set accuracy = 0.939700
 epoch 10/30. Took 0.22276 seconds. 
  Full-batch training loss = 0.021580, test loss = 0.218612
  Training set accuracy = 0.997000, Test set accuracy = 0.941800
 epoch 11/30. Took 0.22429 seconds. 
  Full-batch training loss = 0.017674, test loss = 0.219416
  Training set accuracy = 0.997800, Test set accuracy = 0.944200
 epoch 12/30. Took 0.2298 seconds. 
  Full-batch training loss = 0.014863, test loss = 0.222637
  Training set accuracy = 0.998400, Test set accuracy = 0.943000
 epoch 13/30. Took 0.23114 seconds. 
  Full-batch training loss = 0.011558, test loss = 0.225448
  Training set accuracy = 0.998400, Test set accuracy = 0.945700
 epoch 14/30. Took 0.22818 seconds. 
  Full-batch training loss = 0.009480, test loss = 0.226945
  Training set accuracy = 0.999000, Test set accuracy = 0.943500
 epoch 15/30. Took 0.22756 seconds. 
  Full-batch training loss = 0.008262, test loss = 0.225663
  Training set accuracy = 0.999000, Test set accuracy = 0.944900
 epoch 16/30. Took 0.22477 seconds. 
  Full-batch training loss = 0.006878, test loss = 0.226261
  Training set accuracy = 0.998600, Test set accuracy = 0.946100
 epoch 17/30. Took 0.24761 seconds. 
  Full-batch training loss = 0.009817, test loss = 0.230663
  Training set accuracy = 0.998000, Test set accuracy = 0.944200
 epoch 18/30. Took 0.2381 seconds. 
  Full-batch training loss = 0.006310, test loss = 0.227308
  Training set accuracy = 0.999200, Test set accuracy = 0.947300
 epoch 19/30. Took 0.22643 seconds. 
  Full-batch training loss = 0.006669, test loss = 0.240656
  Training set accuracy = 1.000000, Test set accuracy = 0.946200
 epoch 20/30. Took 0.24616 seconds. 
  Full-batch training loss = 0.002486, test loss = 0.220978
  Training set accuracy = 1.000000, Test set accuracy = 0.950400
 epoch 21/30. Took 0.22109 seconds. 
  Full-batch training loss = 0.002554, test loss = 0.232066
  Training set accuracy = 1.000000, Test set accuracy = 0.947000
 epoch 22/30. Took 0.22845 seconds. 
  Full-batch training loss = 0.001845, test loss = 0.235243
  Training set accuracy = 1.000000, Test set accuracy = 0.949600
 epoch 23/30. Took 0.22897 seconds. 
  Full-batch training loss = 0.001596, test loss = 0.231537
  Training set accuracy = 1.000000, Test set accuracy = 0.948800
 epoch 24/30. Took 0.23784 seconds. 
  Full-batch training loss = 0.003206, test loss = 0.250589
  Training set accuracy = 0.999800, Test set accuracy = 0.947300
 epoch 25/30. Took 0.22065 seconds. 
  Full-batch training loss = 0.001417, test loss = 0.240328
  Training set accuracy = 1.000000, Test set accuracy = 0.949700
 epoch 26/30. Took 0.25437 seconds. 
  Full-batch training loss = 0.001334, test loss = 0.245241
  Training set accuracy = 1.000000, Test set accuracy = 0.947900
 epoch 27/30. Took 0.22095 seconds. 
  Full-batch training loss = 0.001450, test loss = 0.256229
  Training set accuracy = 1.000000, Test set accuracy = 0.945900
 epoch 28/30. Took 0.22788 seconds. 
  Full-batch training loss = 0.002757, test loss = 0.256376
  Training set accuracy = 1.000000, Test set accuracy = 0.945300
 epoch 29/30. Took 0.23132 seconds. 
  Full-batch training loss = 0.002229, test loss = 0.245699
  Training set accuracy = 0.999800, Test set accuracy = 0.947600
 epoch 30/30. Took 0.22836 seconds. 
  Full-batch training loss = 0.003427, test loss = 0.250759
  Training set accuracy = 0.999200, Test set accuracy = 0.947300
Elapsed time is 15.272747 seconds.
End Training
-----
Params 5000 0.100 0.10 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.63856 seconds. 
  Full-batch training loss = 0.433353, test loss = 0.448355
  Training set accuracy = 0.863800, Test set accuracy = 0.860100
 epoch 2/30. Took 0.58801 seconds. 
  Full-batch training loss = 0.282437, test loss = 0.329521
  Training set accuracy = 0.914000, Test set accuracy = 0.899500
 epoch 3/30. Took 0.60233 seconds. 
  Full-batch training loss = 0.213040, test loss = 0.289098
  Training set accuracy = 0.937400, Test set accuracy = 0.911400
 epoch 4/30. Took 0.5901 seconds. 
  Full-batch training loss = 0.124623, test loss = 0.210276
  Training set accuracy = 0.965200, Test set accuracy = 0.936500
 epoch 5/30. Took 0.58857 seconds. 
  Full-batch training loss = 0.095383, test loss = 0.201562
  Training set accuracy = 0.973000, Test set accuracy = 0.940100
 epoch 6/30. Took 0.61121 seconds. 
  Full-batch training loss = 0.079786, test loss = 0.201830
  Training set accuracy = 0.975200, Test set accuracy = 0.937400
 epoch 7/30. Took 0.58845 seconds. 
  Full-batch training loss = 0.048684, test loss = 0.176763
  Training set accuracy = 0.990600, Test set accuracy = 0.946200
 epoch 8/30. Took 0.63737 seconds. 
  Full-batch training loss = 0.053615, test loss = 0.208695
  Training set accuracy = 0.985400, Test set accuracy = 0.936300
 epoch 9/30. Took 0.61755 seconds. 
  Full-batch training loss = 0.024577, test loss = 0.174497
  Training set accuracy = 0.997000, Test set accuracy = 0.949500
 epoch 10/30. Took 0.60109 seconds. 
  Full-batch training loss = 0.018634, test loss = 0.171997
  Training set accuracy = 0.998200, Test set accuracy = 0.950300
 epoch 11/30. Took 0.59037 seconds. 
  Full-batch training loss = 0.015162, test loss = 0.179565
  Training set accuracy = 0.998800, Test set accuracy = 0.949600
 epoch 12/30. Took 0.59627 seconds. 
  Full-batch training loss = 0.008881, test loss = 0.172337
  Training set accuracy = 0.999800, Test set accuracy = 0.953000
 epoch 13/30. Took 0.58941 seconds. 
  Full-batch training loss = 0.007616, test loss = 0.181725
  Training set accuracy = 0.999800, Test set accuracy = 0.952100
 epoch 14/30. Took 0.58965 seconds. 
  Full-batch training loss = 0.006506, test loss = 0.181163
  Training set accuracy = 0.999800, Test set accuracy = 0.951900
 epoch 15/30. Took 0.59308 seconds. 
  Full-batch training loss = 0.005707, test loss = 0.183828
  Training set accuracy = 1.000000, Test set accuracy = 0.951700
 epoch 16/30. Took 0.59444 seconds. 
  Full-batch training loss = 0.003272, test loss = 0.180016
  Training set accuracy = 1.000000, Test set accuracy = 0.953600
 epoch 17/30. Took 0.60027 seconds. 
  Full-batch training loss = 0.003566, test loss = 0.188471
  Training set accuracy = 1.000000, Test set accuracy = 0.953700
 epoch 18/30. Took 0.61 seconds. 
  Full-batch training loss = 0.002720, test loss = 0.179689
  Training set accuracy = 1.000000, Test set accuracy = 0.955100
 epoch 19/30. Took 0.58707 seconds. 
  Full-batch training loss = 0.002608, test loss = 0.192237
  Training set accuracy = 1.000000, Test set accuracy = 0.951600
 epoch 20/30. Took 0.59102 seconds. 
  Full-batch training loss = 0.002353, test loss = 0.189873
  Training set accuracy = 1.000000, Test set accuracy = 0.954500
 epoch 21/30. Took 0.66787 seconds. 
  Full-batch training loss = 0.002010, test loss = 0.192365
  Training set accuracy = 1.000000, Test set accuracy = 0.954100
 epoch 22/30. Took 0.58746 seconds. 
  Full-batch training loss = 0.001938, test loss = 0.188897
  Training set accuracy = 1.000000, Test set accuracy = 0.953800
 epoch 23/30. Took 0.61379 seconds. 
  Full-batch training loss = 0.001418, test loss = 0.188549
  Training set accuracy = 1.000000, Test set accuracy = 0.955200
 epoch 24/30. Took 0.59143 seconds. 
  Full-batch training loss = 0.001293, test loss = 0.188643
  Training set accuracy = 1.000000, Test set accuracy = 0.954400
 epoch 25/30. Took 0.63044 seconds. 
  Full-batch training loss = 0.001187, test loss = 0.194706
  Training set accuracy = 1.000000, Test set accuracy = 0.954000
 epoch 26/30. Took 0.59612 seconds. 
  Full-batch training loss = 0.001170, test loss = 0.193773
  Training set accuracy = 1.000000, Test set accuracy = 0.954600
 epoch 27/30. Took 0.66639 seconds. 
  Full-batch training loss = 0.001140, test loss = 0.197086
  Training set accuracy = 1.000000, Test set accuracy = 0.953000
 epoch 28/30. Took 0.59279 seconds. 
  Full-batch training loss = 0.000919, test loss = 0.196007
  Training set accuracy = 1.000000, Test set accuracy = 0.956000
 epoch 29/30. Took 0.58964 seconds. 
  Full-batch training loss = 0.000913, test loss = 0.199814
  Training set accuracy = 1.000000, Test set accuracy = 0.955000
 epoch 30/30. Took 0.58532 seconds. 
  Full-batch training loss = 0.000934, test loss = 0.195876
  Training set accuracy = 1.000000, Test set accuracy = 0.956200
Elapsed time is 38.264644 seconds.
End Training
-----
Params 5000 0.100 0.10 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.16907 seconds. 
  Full-batch training loss = 0.511936, test loss = 0.523431
  Training set accuracy = 0.846400, Test set accuracy = 0.840400
 epoch 2/30. Took 0.15912 seconds. 
  Full-batch training loss = 0.268754, test loss = 0.305307
  Training set accuracy = 0.922600, Test set accuracy = 0.904500
 epoch 3/30. Took 0.15219 seconds. 
  Full-batch training loss = 0.184974, test loss = 0.265426
  Training set accuracy = 0.943800, Test set accuracy = 0.918300
 epoch 4/30. Took 0.16304 seconds. 
  Full-batch training loss = 0.147289, test loss = 0.248083
  Training set accuracy = 0.952600, Test set accuracy = 0.923500
 epoch 5/30. Took 0.15329 seconds. 
  Full-batch training loss = 0.101967, test loss = 0.227052
  Training set accuracy = 0.971000, Test set accuracy = 0.930700
 epoch 6/30. Took 0.16229 seconds. 
  Full-batch training loss = 0.072688, test loss = 0.214491
  Training set accuracy = 0.977000, Test set accuracy = 0.935300
 epoch 7/30. Took 0.15761 seconds. 
  Full-batch training loss = 0.075559, test loss = 0.225057
  Training set accuracy = 0.977800, Test set accuracy = 0.930600
 epoch 8/30. Took 0.16126 seconds. 
  Full-batch training loss = 0.068799, test loss = 0.255420
  Training set accuracy = 0.979600, Test set accuracy = 0.931200
 epoch 9/30. Took 0.15978 seconds. 
  Full-batch training loss = 0.038210, test loss = 0.213007
  Training set accuracy = 0.990200, Test set accuracy = 0.943300
 epoch 10/30. Took 0.14958 seconds. 
  Full-batch training loss = 0.035065, test loss = 0.221953
  Training set accuracy = 0.989800, Test set accuracy = 0.939000
 epoch 11/30. Took 0.15259 seconds. 
  Full-batch training loss = 0.038087, test loss = 0.225512
  Training set accuracy = 0.988600, Test set accuracy = 0.942300
 epoch 12/30. Took 0.15126 seconds. 
  Full-batch training loss = 0.027681, test loss = 0.230015
  Training set accuracy = 0.991800, Test set accuracy = 0.941200
 epoch 13/30. Took 0.15829 seconds. 
  Full-batch training loss = 0.026505, test loss = 0.233518
  Training set accuracy = 0.992000, Test set accuracy = 0.940900
 epoch 14/30. Took 0.1514 seconds. 
  Full-batch training loss = 0.014889, test loss = 0.213272
  Training set accuracy = 0.997000, Test set accuracy = 0.947900
 epoch 15/30. Took 0.15125 seconds. 
  Full-batch training loss = 0.017323, test loss = 0.223769
  Training set accuracy = 0.994800, Test set accuracy = 0.947000
 epoch 16/30. Took 0.16123 seconds. 
  Full-batch training loss = 0.012563, test loss = 0.216030
  Training set accuracy = 0.997200, Test set accuracy = 0.945800
 epoch 17/30. Took 0.16164 seconds. 
  Full-batch training loss = 0.011739, test loss = 0.223875
  Training set accuracy = 0.997800, Test set accuracy = 0.946900
 epoch 18/30. Took 0.15567 seconds. 
  Full-batch training loss = 0.015150, test loss = 0.263890
  Training set accuracy = 0.995800, Test set accuracy = 0.939200
 epoch 19/30. Took 0.15106 seconds. 
  Full-batch training loss = 0.009058, test loss = 0.244738
  Training set accuracy = 0.997000, Test set accuracy = 0.943200
 epoch 20/30. Took 0.15432 seconds. 
  Full-batch training loss = 0.007124, test loss = 0.230480
  Training set accuracy = 0.998200, Test set accuracy = 0.949600
 epoch 21/30. Took 0.1601 seconds. 
  Full-batch training loss = 0.005013, test loss = 0.214387
  Training set accuracy = 0.999000, Test set accuracy = 0.952600
 epoch 22/30. Took 0.15343 seconds. 
  Full-batch training loss = 0.005289, test loss = 0.233456
  Training set accuracy = 0.999000, Test set accuracy = 0.950700
 epoch 23/30. Took 0.15696 seconds. 
  Full-batch training loss = 0.005136, test loss = 0.234962
  Training set accuracy = 0.998600, Test set accuracy = 0.949000
 epoch 24/30. Took 0.15189 seconds. 
  Full-batch training loss = 0.009958, test loss = 0.257899
  Training set accuracy = 0.997600, Test set accuracy = 0.943900
 epoch 25/30. Took 0.159 seconds. 
  Full-batch training loss = 0.002949, test loss = 0.238198
  Training set accuracy = 0.999200, Test set accuracy = 0.947800
 epoch 26/30. Took 0.15162 seconds. 
  Full-batch training loss = 0.005340, test loss = 0.262357
  Training set accuracy = 0.998200, Test set accuracy = 0.944100
 epoch 27/30. Took 0.15174 seconds. 
  Full-batch training loss = 0.002247, test loss = 0.241222
  Training set accuracy = 0.999800, Test set accuracy = 0.948400
 epoch 28/30. Took 0.15386 seconds. 
  Full-batch training loss = 0.004045, test loss = 0.261050
  Training set accuracy = 0.998800, Test set accuracy = 0.950500
 epoch 29/30. Took 0.15946 seconds. 
  Full-batch training loss = 0.002813, test loss = 0.249514
  Training set accuracy = 0.999600, Test set accuracy = 0.948500
 epoch 30/30. Took 0.1524 seconds. 
  Full-batch training loss = 0.004459, test loss = 0.267073
  Training set accuracy = 0.999000, Test set accuracy = 0.945900
Elapsed time is 10.737411 seconds.
End Training
-----
Params 5000 0.100 0.10 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28417 seconds. 
  Full-batch training loss = 0.414244, test loss = 0.429538
  Training set accuracy = 0.882400, Test set accuracy = 0.878700
 epoch 2/30. Took 0.2775 seconds. 
  Full-batch training loss = 0.304019, test loss = 0.349841
  Training set accuracy = 0.906800, Test set accuracy = 0.891100
 epoch 3/30. Took 0.2973 seconds. 
  Full-batch training loss = 0.194299, test loss = 0.265666
  Training set accuracy = 0.941200, Test set accuracy = 0.918600
 epoch 4/30. Took 0.28356 seconds. 
  Full-batch training loss = 0.133233, test loss = 0.238827
  Training set accuracy = 0.961400, Test set accuracy = 0.925500
 epoch 5/30. Took 0.2683 seconds. 
  Full-batch training loss = 0.106731, test loss = 0.223985
  Training set accuracy = 0.971200, Test set accuracy = 0.932300
 epoch 6/30. Took 0.27563 seconds. 
  Full-batch training loss = 0.093204, test loss = 0.238865
  Training set accuracy = 0.971800, Test set accuracy = 0.927200
 epoch 7/30. Took 0.27582 seconds. 
  Full-batch training loss = 0.070673, test loss = 0.235056
  Training set accuracy = 0.977000, Test set accuracy = 0.932100
 epoch 8/30. Took 0.28307 seconds. 
  Full-batch training loss = 0.033184, test loss = 0.195930
  Training set accuracy = 0.992400, Test set accuracy = 0.943400
 epoch 9/30. Took 0.30378 seconds. 
  Full-batch training loss = 0.034583, test loss = 0.208506
  Training set accuracy = 0.989600, Test set accuracy = 0.941300
 epoch 10/30. Took 0.28089 seconds. 
  Full-batch training loss = 0.031391, test loss = 0.224036
  Training set accuracy = 0.989200, Test set accuracy = 0.940100
 epoch 11/30. Took 0.28236 seconds. 
  Full-batch training loss = 0.020381, test loss = 0.201741
  Training set accuracy = 0.995200, Test set accuracy = 0.944300
 epoch 12/30. Took 0.28182 seconds. 
  Full-batch training loss = 0.018128, test loss = 0.204389
  Training set accuracy = 0.994600, Test set accuracy = 0.945600
 epoch 13/30. Took 0.28241 seconds. 
  Full-batch training loss = 0.011411, test loss = 0.203932
  Training set accuracy = 0.997800, Test set accuracy = 0.946800
 epoch 14/30. Took 0.28239 seconds. 
  Full-batch training loss = 0.006766, test loss = 0.198979
  Training set accuracy = 0.998200, Test set accuracy = 0.950000
 epoch 15/30. Took 0.28171 seconds. 
  Full-batch training loss = 0.010899, test loss = 0.224012
  Training set accuracy = 0.997200, Test set accuracy = 0.946200
 epoch 16/30. Took 0.28524 seconds. 
  Full-batch training loss = 0.007896, test loss = 0.223126
  Training set accuracy = 0.998000, Test set accuracy = 0.945400
 epoch 17/30. Took 0.27684 seconds. 
  Full-batch training loss = 0.004419, test loss = 0.221579
  Training set accuracy = 0.998800, Test set accuracy = 0.946600
 epoch 18/30. Took 0.31317 seconds. 
  Full-batch training loss = 0.017514, test loss = 0.252689
  Training set accuracy = 0.993200, Test set accuracy = 0.942400
 epoch 19/30. Took 0.27559 seconds. 
  Full-batch training loss = 0.004570, test loss = 0.223182
  Training set accuracy = 0.999000, Test set accuracy = 0.949200
 epoch 20/30. Took 0.28801 seconds. 
  Full-batch training loss = 0.005784, test loss = 0.238169
  Training set accuracy = 0.998600, Test set accuracy = 0.946100
 epoch 21/30. Took 0.28163 seconds. 
  Full-batch training loss = 0.004579, test loss = 0.232278
  Training set accuracy = 0.998600, Test set accuracy = 0.949400
 epoch 22/30. Took 0.28109 seconds. 
  Full-batch training loss = 0.001543, test loss = 0.213878
  Training set accuracy = 0.999600, Test set accuracy = 0.955400
 epoch 23/30. Took 0.28129 seconds. 
  Full-batch training loss = 0.003605, test loss = 0.251505
  Training set accuracy = 0.999000, Test set accuracy = 0.949400
 epoch 24/30. Took 0.31486 seconds. 
  Full-batch training loss = 0.002608, test loss = 0.235448
  Training set accuracy = 0.999800, Test set accuracy = 0.947100
 epoch 25/30. Took 0.2773 seconds. 
  Full-batch training loss = 0.001497, test loss = 0.234786
  Training set accuracy = 1.000000, Test set accuracy = 0.950500
 epoch 26/30. Took 0.2731 seconds. 
  Full-batch training loss = 0.005461, test loss = 0.261404
  Training set accuracy = 0.998400, Test set accuracy = 0.948000
 epoch 27/30. Took 0.28107 seconds. 
  Full-batch training loss = 0.002375, test loss = 0.219200
  Training set accuracy = 0.999400, Test set accuracy = 0.953900
 epoch 28/30. Took 0.27531 seconds. 
  Full-batch training loss = 0.001748, test loss = 0.228622
  Training set accuracy = 0.999800, Test set accuracy = 0.951600
 epoch 29/30. Took 0.27987 seconds. 
  Full-batch training loss = 0.001972, test loss = 0.229116
  Training set accuracy = 1.000000, Test set accuracy = 0.951100
 epoch 30/30. Took 0.26972 seconds. 
  Full-batch training loss = 0.003700, test loss = 0.254939
  Training set accuracy = 0.999200, Test set accuracy = 0.948600
Elapsed time is 18.651833 seconds.
End Training
-----
Params 5000 0.100 0.10 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.83579 seconds. 
  Full-batch training loss = 0.400329, test loss = 0.427479
  Training set accuracy = 0.876000, Test set accuracy = 0.868300
 epoch 2/30. Took 0.82616 seconds. 
  Full-batch training loss = 0.307311, test loss = 0.347215
  Training set accuracy = 0.906200, Test set accuracy = 0.893800
 epoch 3/30. Took 0.83586 seconds. 
  Full-batch training loss = 0.187170, test loss = 0.259795
  Training set accuracy = 0.943000, Test set accuracy = 0.918800
 epoch 4/30. Took 0.84055 seconds. 
  Full-batch training loss = 0.130572, test loss = 0.238422
  Training set accuracy = 0.960400, Test set accuracy = 0.927000
 epoch 5/30. Took 0.8256 seconds. 
  Full-batch training loss = 0.079295, test loss = 0.191640
  Training set accuracy = 0.977000, Test set accuracy = 0.940200
 epoch 6/30. Took 0.82519 seconds. 
  Full-batch training loss = 0.056919, test loss = 0.207168
  Training set accuracy = 0.984600, Test set accuracy = 0.937100
 epoch 7/30. Took 0.84387 seconds. 
  Full-batch training loss = 0.058081, test loss = 0.219687
  Training set accuracy = 0.983400, Test set accuracy = 0.936600
 epoch 8/30. Took 0.82649 seconds. 
  Full-batch training loss = 0.048384, test loss = 0.215703
  Training set accuracy = 0.984600, Test set accuracy = 0.936700
 epoch 9/30. Took 0.97561 seconds. 
  Full-batch training loss = 0.029909, test loss = 0.208043
  Training set accuracy = 0.992200, Test set accuracy = 0.940700
 epoch 10/30. Took 0.85787 seconds. 
  Full-batch training loss = 0.016021, test loss = 0.179606
  Training set accuracy = 0.996400, Test set accuracy = 0.949600
 epoch 11/30. Took 0.86954 seconds. 
  Full-batch training loss = 0.009402, test loss = 0.196410
  Training set accuracy = 0.998600, Test set accuracy = 0.949800
 epoch 12/30. Took 0.8251 seconds. 
  Full-batch training loss = 0.006994, test loss = 0.178614
  Training set accuracy = 0.998600, Test set accuracy = 0.955000
 epoch 13/30. Took 0.97566 seconds. 
  Full-batch training loss = 0.013746, test loss = 0.222633
  Training set accuracy = 0.996400, Test set accuracy = 0.945400
 epoch 14/30. Took 0.86262 seconds. 
  Full-batch training loss = 0.003726, test loss = 0.194548
  Training set accuracy = 0.999600, Test set accuracy = 0.954800
 epoch 15/30. Took 0.8288 seconds. 
  Full-batch training loss = 0.003837, test loss = 0.198713
  Training set accuracy = 0.999400, Test set accuracy = 0.952800
 epoch 16/30. Took 0.82148 seconds. 
  Full-batch training loss = 0.001898, test loss = 0.185267
  Training set accuracy = 1.000000, Test set accuracy = 0.955500
 epoch 17/30. Took 0.82172 seconds. 
  Full-batch training loss = 0.001387, test loss = 0.175477
  Training set accuracy = 0.999800, Test set accuracy = 0.957700
 epoch 18/30. Took 0.82161 seconds. 
  Full-batch training loss = 0.005242, test loss = 0.220628
  Training set accuracy = 0.999200, Test set accuracy = 0.948300
 epoch 19/30. Took 0.82124 seconds. 
  Full-batch training loss = 0.001150, test loss = 0.188958
  Training set accuracy = 0.999800, Test set accuracy = 0.956700
 epoch 20/30. Took 0.82119 seconds. 
  Full-batch training loss = 0.000579, test loss = 0.196831
  Training set accuracy = 1.000000, Test set accuracy = 0.956800
 epoch 21/30. Took 0.81795 seconds. 
  Full-batch training loss = 0.001101, test loss = 0.194136
  Training set accuracy = 0.999800, Test set accuracy = 0.956900
 epoch 22/30. Took 0.85917 seconds. 
  Full-batch training loss = 0.000424, test loss = 0.198946
  Training set accuracy = 1.000000, Test set accuracy = 0.958200
 epoch 23/30. Took 0.86063 seconds. 
  Full-batch training loss = 0.000274, test loss = 0.200252
  Training set accuracy = 1.000000, Test set accuracy = 0.957800
 epoch 24/30. Took 0.82373 seconds. 
  Full-batch training loss = 0.000208, test loss = 0.200789
  Training set accuracy = 1.000000, Test set accuracy = 0.957800
 epoch 25/30. Took 0.82292 seconds. 
  Full-batch training loss = 0.000196, test loss = 0.199132
  Training set accuracy = 1.000000, Test set accuracy = 0.958700
 epoch 26/30. Took 0.82453 seconds. 
  Full-batch training loss = 0.000259, test loss = 0.215747
  Training set accuracy = 1.000000, Test set accuracy = 0.955100
 epoch 27/30. Took 0.84943 seconds. 
  Full-batch training loss = 0.000185, test loss = 0.200418
  Training set accuracy = 1.000000, Test set accuracy = 0.957600
 epoch 28/30. Took 0.8187 seconds. 
  Full-batch training loss = 0.000446, test loss = 0.216030
  Training set accuracy = 1.000000, Test set accuracy = 0.955000
 epoch 29/30. Took 0.84433 seconds. 
  Full-batch training loss = 0.000600, test loss = 0.233538
  Training set accuracy = 1.000000, Test set accuracy = 0.953800
 epoch 30/30. Took 0.84615 seconds. 
  Full-batch training loss = 0.000432, test loss = 0.230199
  Training set accuracy = 1.000000, Test set accuracy = 0.953500
Elapsed time is 52.768010 seconds.
End Training
-----
Params 5000 0.100 0.20 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.1166 seconds. 
  Full-batch training loss = 0.457074, test loss = 0.460379
  Training set accuracy = 0.865400, Test set accuracy = 0.859200
 epoch 2/30. Took 0.10891 seconds. 
  Full-batch training loss = 0.317409, test loss = 0.334187
  Training set accuracy = 0.907000, Test set accuracy = 0.904000
 epoch 3/30. Took 0.11001 seconds. 
  Full-batch training loss = 0.265470, test loss = 0.306460
  Training set accuracy = 0.923600, Test set accuracy = 0.911800
 epoch 4/30. Took 0.10912 seconds. 
  Full-batch training loss = 0.221114, test loss = 0.273930
  Training set accuracy = 0.940600, Test set accuracy = 0.921000
 epoch 5/30. Took 0.10824 seconds. 
  Full-batch training loss = 0.198382, test loss = 0.262009
  Training set accuracy = 0.943800, Test set accuracy = 0.921800
 epoch 6/30. Took 0.10937 seconds. 
  Full-batch training loss = 0.166376, test loss = 0.242453
  Training set accuracy = 0.955400, Test set accuracy = 0.927900
 epoch 7/30. Took 0.10958 seconds. 
  Full-batch training loss = 0.148043, test loss = 0.230248
  Training set accuracy = 0.960600, Test set accuracy = 0.932700
 epoch 8/30. Took 0.10846 seconds. 
  Full-batch training loss = 0.131774, test loss = 0.222439
  Training set accuracy = 0.966400, Test set accuracy = 0.933500
 epoch 9/30. Took 0.10572 seconds. 
  Full-batch training loss = 0.109369, test loss = 0.212054
  Training set accuracy = 0.972400, Test set accuracy = 0.936300
 epoch 10/30. Took 0.10675 seconds. 
  Full-batch training loss = 0.100450, test loss = 0.209879
  Training set accuracy = 0.976400, Test set accuracy = 0.936300
 epoch 11/30. Took 0.11422 seconds. 
  Full-batch training loss = 0.089357, test loss = 0.204723
  Training set accuracy = 0.979400, Test set accuracy = 0.940000
 epoch 12/30. Took 0.10784 seconds. 
  Full-batch training loss = 0.079299, test loss = 0.202030
  Training set accuracy = 0.982200, Test set accuracy = 0.940000
 epoch 13/30. Took 0.10937 seconds. 
  Full-batch training loss = 0.067186, test loss = 0.195014
  Training set accuracy = 0.985600, Test set accuracy = 0.941700
 epoch 14/30. Took 0.12007 seconds. 
  Full-batch training loss = 0.060987, test loss = 0.191758
  Training set accuracy = 0.986800, Test set accuracy = 0.943200
 epoch 15/30. Took 0.1078 seconds. 
  Full-batch training loss = 0.052699, test loss = 0.188045
  Training set accuracy = 0.991600, Test set accuracy = 0.944900
 epoch 16/30. Took 0.10766 seconds. 
  Full-batch training loss = 0.049463, test loss = 0.193154
  Training set accuracy = 0.991600, Test set accuracy = 0.944000
 epoch 17/30. Took 0.10919 seconds. 
  Full-batch training loss = 0.041966, test loss = 0.188782
  Training set accuracy = 0.993400, Test set accuracy = 0.944100
 epoch 18/30. Took 0.10613 seconds. 
  Full-batch training loss = 0.039894, test loss = 0.184221
  Training set accuracy = 0.994200, Test set accuracy = 0.945900
 epoch 19/30. Took 0.10855 seconds. 
  Full-batch training loss = 0.039877, test loss = 0.192941
  Training set accuracy = 0.991400, Test set accuracy = 0.942800
 epoch 20/30. Took 0.10905 seconds. 
  Full-batch training loss = 0.036991, test loss = 0.191218
  Training set accuracy = 0.992200, Test set accuracy = 0.942900
 epoch 21/30. Took 0.10947 seconds. 
  Full-batch training loss = 0.029133, test loss = 0.186118
  Training set accuracy = 0.996200, Test set accuracy = 0.946100
 epoch 22/30. Took 0.10937 seconds. 
  Full-batch training loss = 0.027818, test loss = 0.186299
  Training set accuracy = 0.995800, Test set accuracy = 0.946500
 epoch 23/30. Took 0.10913 seconds. 
  Full-batch training loss = 0.024777, test loss = 0.188461
  Training set accuracy = 0.996600, Test set accuracy = 0.946200
 epoch 24/30. Took 0.10788 seconds. 
  Full-batch training loss = 0.020703, test loss = 0.184869
  Training set accuracy = 0.997600, Test set accuracy = 0.946500
 epoch 25/30. Took 0.10912 seconds. 
  Full-batch training loss = 0.019862, test loss = 0.183786
  Training set accuracy = 0.998800, Test set accuracy = 0.946800
 epoch 26/30. Took 0.10927 seconds. 
  Full-batch training loss = 0.020856, test loss = 0.190177
  Training set accuracy = 0.997800, Test set accuracy = 0.945700
 epoch 27/30. Took 0.10856 seconds. 
  Full-batch training loss = 0.016041, test loss = 0.186601
  Training set accuracy = 0.999000, Test set accuracy = 0.948000
 epoch 28/30. Took 0.10909 seconds. 
  Full-batch training loss = 0.015264, test loss = 0.183195
  Training set accuracy = 0.999200, Test set accuracy = 0.948100
 epoch 29/30. Took 0.10918 seconds. 
  Full-batch training loss = 0.014061, test loss = 0.187471
  Training set accuracy = 0.998800, Test set accuracy = 0.948600
 epoch 30/30. Took 0.10905 seconds. 
  Full-batch training loss = 0.013363, test loss = 0.186271
  Training set accuracy = 0.999400, Test set accuracy = 0.949100
Elapsed time is 8.061096 seconds.
End Training
-----
Params 5000 0.100 0.20 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17864 seconds. 
  Full-batch training loss = 0.406297, test loss = 0.417448
  Training set accuracy = 0.889200, Test set accuracy = 0.882100
 epoch 2/30. Took 0.17043 seconds. 
  Full-batch training loss = 0.317823, test loss = 0.361687
  Training set accuracy = 0.909800, Test set accuracy = 0.892100
 epoch 3/30. Took 0.16856 seconds. 
  Full-batch training loss = 0.261428, test loss = 0.320126
  Training set accuracy = 0.920800, Test set accuracy = 0.906800
 epoch 4/30. Took 0.17143 seconds. 
  Full-batch training loss = 0.206226, test loss = 0.285387
  Training set accuracy = 0.949000, Test set accuracy = 0.917900
 epoch 5/30. Took 0.16956 seconds. 
  Full-batch training loss = 0.173944, test loss = 0.260752
  Training set accuracy = 0.952600, Test set accuracy = 0.924000
 epoch 6/30. Took 0.17255 seconds. 
  Full-batch training loss = 0.148456, test loss = 0.248449
  Training set accuracy = 0.957200, Test set accuracy = 0.926500
 epoch 7/30. Took 0.1716 seconds. 
  Full-batch training loss = 0.125262, test loss = 0.237524
  Training set accuracy = 0.968200, Test set accuracy = 0.930500
 epoch 8/30. Took 0.16844 seconds. 
  Full-batch training loss = 0.105746, test loss = 0.230263
  Training set accuracy = 0.975000, Test set accuracy = 0.932800
 epoch 9/30. Took 0.17002 seconds. 
  Full-batch training loss = 0.096463, test loss = 0.222642
  Training set accuracy = 0.976600, Test set accuracy = 0.935100
 epoch 10/30. Took 0.17388 seconds. 
  Full-batch training loss = 0.074341, test loss = 0.209811
  Training set accuracy = 0.985400, Test set accuracy = 0.941000
 epoch 11/30. Took 0.17123 seconds. 
  Full-batch training loss = 0.067319, test loss = 0.205531
  Training set accuracy = 0.985800, Test set accuracy = 0.941400
 epoch 12/30. Took 0.17001 seconds. 
  Full-batch training loss = 0.057016, test loss = 0.204378
  Training set accuracy = 0.990000, Test set accuracy = 0.941800
 epoch 13/30. Took 0.16889 seconds. 
  Full-batch training loss = 0.049807, test loss = 0.198134
  Training set accuracy = 0.993400, Test set accuracy = 0.942000
 epoch 14/30. Took 0.17175 seconds. 
  Full-batch training loss = 0.041136, test loss = 0.196443
  Training set accuracy = 0.994000, Test set accuracy = 0.945600
 epoch 15/30. Took 0.17281 seconds. 
  Full-batch training loss = 0.038948, test loss = 0.196190
  Training set accuracy = 0.994600, Test set accuracy = 0.944200
 epoch 16/30. Took 0.17312 seconds. 
  Full-batch training loss = 0.034534, test loss = 0.207060
  Training set accuracy = 0.996200, Test set accuracy = 0.942700
 epoch 17/30. Took 0.1708 seconds. 
  Full-batch training loss = 0.031048, test loss = 0.201504
  Training set accuracy = 0.996400, Test set accuracy = 0.945000
 epoch 18/30. Took 0.1815 seconds. 
  Full-batch training loss = 0.027485, test loss = 0.192560
  Training set accuracy = 0.996400, Test set accuracy = 0.945500
 epoch 19/30. Took 0.16992 seconds. 
  Full-batch training loss = 0.024859, test loss = 0.197235
  Training set accuracy = 0.997200, Test set accuracy = 0.944700
 epoch 20/30. Took 0.16822 seconds. 
  Full-batch training loss = 0.021043, test loss = 0.198579
  Training set accuracy = 0.998600, Test set accuracy = 0.945600
 epoch 21/30. Took 0.17156 seconds. 
  Full-batch training loss = 0.021912, test loss = 0.204762
  Training set accuracy = 0.998000, Test set accuracy = 0.945400
 epoch 22/30. Took 0.17082 seconds. 
  Full-batch training loss = 0.019045, test loss = 0.198552
  Training set accuracy = 0.998600, Test set accuracy = 0.946600
 epoch 23/30. Took 0.1715 seconds. 
  Full-batch training loss = 0.016340, test loss = 0.195979
  Training set accuracy = 0.998600, Test set accuracy = 0.945900
 epoch 24/30. Took 0.171 seconds. 
  Full-batch training loss = 0.014323, test loss = 0.198538
  Training set accuracy = 0.999000, Test set accuracy = 0.947000
 epoch 25/30. Took 0.17837 seconds. 
  Full-batch training loss = 0.013481, test loss = 0.196563
  Training set accuracy = 1.000000, Test set accuracy = 0.948100
 epoch 26/30. Took 0.18968 seconds. 
  Full-batch training loss = 0.012129, test loss = 0.200086
  Training set accuracy = 0.999800, Test set accuracy = 0.947500
 epoch 27/30. Took 0.16964 seconds. 
  Full-batch training loss = 0.011375, test loss = 0.200467
  Training set accuracy = 0.999000, Test set accuracy = 0.949200
 epoch 28/30. Took 0.17215 seconds. 
  Full-batch training loss = 0.010725, test loss = 0.194715
  Training set accuracy = 0.999400, Test set accuracy = 0.948600
 epoch 29/30. Took 0.1703 seconds. 
  Full-batch training loss = 0.009641, test loss = 0.204556
  Training set accuracy = 0.999400, Test set accuracy = 0.948800
 epoch 30/30. Took 0.17182 seconds. 
  Full-batch training loss = 0.009003, test loss = 0.197326
  Training set accuracy = 1.000000, Test set accuracy = 0.949000
Elapsed time is 11.735444 seconds.
End Training
-----
Params 5000 0.100 0.20 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.39638 seconds. 
  Full-batch training loss = 0.377037, test loss = 0.391631
  Training set accuracy = 0.894600, Test set accuracy = 0.888100
 epoch 2/30. Took 0.3724 seconds. 
  Full-batch training loss = 0.283559, test loss = 0.321701
  Training set accuracy = 0.921600, Test set accuracy = 0.904500
 epoch 3/30. Took 0.35958 seconds. 
  Full-batch training loss = 0.227630, test loss = 0.288848
  Training set accuracy = 0.944200, Test set accuracy = 0.913500
 epoch 4/30. Took 0.35857 seconds. 
  Full-batch training loss = 0.188353, test loss = 0.262745
  Training set accuracy = 0.950800, Test set accuracy = 0.922600
 epoch 5/30. Took 0.36049 seconds. 
  Full-batch training loss = 0.144527, test loss = 0.227851
  Training set accuracy = 0.966000, Test set accuracy = 0.930900
 epoch 6/30. Took 0.35817 seconds. 
  Full-batch training loss = 0.129887, test loss = 0.222807
  Training set accuracy = 0.970600, Test set accuracy = 0.932400
 epoch 7/30. Took 0.38178 seconds. 
  Full-batch training loss = 0.108370, test loss = 0.213575
  Training set accuracy = 0.977400, Test set accuracy = 0.933100
 epoch 8/30. Took 0.37187 seconds. 
  Full-batch training loss = 0.092608, test loss = 0.201662
  Training set accuracy = 0.981400, Test set accuracy = 0.937700
 epoch 9/30. Took 0.36456 seconds. 
  Full-batch training loss = 0.080907, test loss = 0.200151
  Training set accuracy = 0.984600, Test set accuracy = 0.934800
 epoch 10/30. Took 0.35422 seconds. 
  Full-batch training loss = 0.068717, test loss = 0.187438
  Training set accuracy = 0.986400, Test set accuracy = 0.942400
 epoch 11/30. Took 0.3558 seconds. 
  Full-batch training loss = 0.059900, test loss = 0.182905
  Training set accuracy = 0.990400, Test set accuracy = 0.943900
 epoch 12/30. Took 0.35702 seconds. 
  Full-batch training loss = 0.051189, test loss = 0.185062
  Training set accuracy = 0.991800, Test set accuracy = 0.942300
 epoch 13/30. Took 0.3562 seconds. 
  Full-batch training loss = 0.043003, test loss = 0.177807
  Training set accuracy = 0.994200, Test set accuracy = 0.944900
 epoch 14/30. Took 0.39645 seconds. 
  Full-batch training loss = 0.038810, test loss = 0.179435
  Training set accuracy = 0.993800, Test set accuracy = 0.945600
 epoch 15/30. Took 0.357 seconds. 
  Full-batch training loss = 0.031944, test loss = 0.175053
  Training set accuracy = 0.995800, Test set accuracy = 0.946900
 epoch 16/30. Took 0.35736 seconds. 
  Full-batch training loss = 0.027686, test loss = 0.172953
  Training set accuracy = 0.996600, Test set accuracy = 0.948800
 epoch 17/30. Took 0.36797 seconds. 
  Full-batch training loss = 0.024996, test loss = 0.180097
  Training set accuracy = 0.998200, Test set accuracy = 0.945800
 epoch 18/30. Took 0.35786 seconds. 
  Full-batch training loss = 0.021638, test loss = 0.172480
  Training set accuracy = 0.998400, Test set accuracy = 0.948900
 epoch 19/30. Took 0.36802 seconds. 
  Full-batch training loss = 0.020299, test loss = 0.172328
  Training set accuracy = 0.998000, Test set accuracy = 0.949900
 epoch 20/30. Took 0.35502 seconds. 
  Full-batch training loss = 0.017505, test loss = 0.170283
  Training set accuracy = 0.999200, Test set accuracy = 0.948500
 epoch 21/30. Took 0.37143 seconds. 
  Full-batch training loss = 0.016065, test loss = 0.171262
  Training set accuracy = 0.999800, Test set accuracy = 0.950300
 epoch 22/30. Took 0.36256 seconds. 
  Full-batch training loss = 0.014281, test loss = 0.174891
  Training set accuracy = 0.999600, Test set accuracy = 0.949100
 epoch 23/30. Took 0.35589 seconds. 
  Full-batch training loss = 0.012920, test loss = 0.174604
  Training set accuracy = 0.999800, Test set accuracy = 0.950400
 epoch 24/30. Took 0.35544 seconds. 
  Full-batch training loss = 0.012549, test loss = 0.176191
  Training set accuracy = 0.999800, Test set accuracy = 0.950100
 epoch 25/30. Took 0.3568 seconds. 
  Full-batch training loss = 0.010612, test loss = 0.175523
  Training set accuracy = 1.000000, Test set accuracy = 0.950800
 epoch 26/30. Took 0.35788 seconds. 
  Full-batch training loss = 0.009694, test loss = 0.175580
  Training set accuracy = 1.000000, Test set accuracy = 0.948300
 epoch 27/30. Took 0.36348 seconds. 
  Full-batch training loss = 0.009282, test loss = 0.170549
  Training set accuracy = 1.000000, Test set accuracy = 0.951400
 epoch 28/30. Took 0.35645 seconds. 
  Full-batch training loss = 0.008798, test loss = 0.174343
  Training set accuracy = 1.000000, Test set accuracy = 0.951700
 epoch 29/30. Took 0.39962 seconds. 
  Full-batch training loss = 0.007638, test loss = 0.175074
  Training set accuracy = 1.000000, Test set accuracy = 0.949900
 epoch 30/30. Took 0.35418 seconds. 
  Full-batch training loss = 0.007331, test loss = 0.174500
  Training set accuracy = 1.000000, Test set accuracy = 0.951000
Elapsed time is 23.616256 seconds.
End Training
-----
Params 5000 0.100 0.20 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.1398 seconds. 
  Full-batch training loss = 0.489219, test loss = 0.508791
  Training set accuracy = 0.852600, Test set accuracy = 0.846500
 epoch 2/30. Took 0.13568 seconds. 
  Full-batch training loss = 0.296332, test loss = 0.352304
  Training set accuracy = 0.911400, Test set accuracy = 0.895900
 epoch 3/30. Took 0.13418 seconds. 
  Full-batch training loss = 0.211615, test loss = 0.282987
  Training set accuracy = 0.938200, Test set accuracy = 0.915900
 epoch 4/30. Took 0.13513 seconds. 
  Full-batch training loss = 0.183146, test loss = 0.261516
  Training set accuracy = 0.946600, Test set accuracy = 0.920600
 epoch 5/30. Took 0.13976 seconds. 
  Full-batch training loss = 0.153892, test loss = 0.251985
  Training set accuracy = 0.954200, Test set accuracy = 0.922500
 epoch 6/30. Took 0.1353 seconds. 
  Full-batch training loss = 0.111491, test loss = 0.228472
  Training set accuracy = 0.967600, Test set accuracy = 0.932100
 epoch 7/30. Took 0.13625 seconds. 
  Full-batch training loss = 0.095537, test loss = 0.220509
  Training set accuracy = 0.973000, Test set accuracy = 0.935400
 epoch 8/30. Took 0.13429 seconds. 
  Full-batch training loss = 0.089798, test loss = 0.228028
  Training set accuracy = 0.972000, Test set accuracy = 0.931400
 epoch 9/30. Took 0.1355 seconds. 
  Full-batch training loss = 0.073174, test loss = 0.219586
  Training set accuracy = 0.979400, Test set accuracy = 0.933200
 epoch 10/30. Took 0.13266 seconds. 
  Full-batch training loss = 0.056007, test loss = 0.208298
  Training set accuracy = 0.984800, Test set accuracy = 0.939800
 epoch 11/30. Took 0.13557 seconds. 
  Full-batch training loss = 0.062513, test loss = 0.228494
  Training set accuracy = 0.980000, Test set accuracy = 0.935300
 epoch 12/30. Took 0.13509 seconds. 
  Full-batch training loss = 0.041431, test loss = 0.216882
  Training set accuracy = 0.989200, Test set accuracy = 0.938500
 epoch 13/30. Took 0.14255 seconds. 
  Full-batch training loss = 0.032588, test loss = 0.212269
  Training set accuracy = 0.992600, Test set accuracy = 0.941300
 epoch 14/30. Took 0.14371 seconds. 
  Full-batch training loss = 0.031693, test loss = 0.227667
  Training set accuracy = 0.991800, Test set accuracy = 0.939600
 epoch 15/30. Took 0.12721 seconds. 
  Full-batch training loss = 0.029887, test loss = 0.210644
  Training set accuracy = 0.993400, Test set accuracy = 0.937900
 epoch 16/30. Took 0.13295 seconds. 
  Full-batch training loss = 0.024727, test loss = 0.214982
  Training set accuracy = 0.993400, Test set accuracy = 0.941100
 epoch 17/30. Took 0.13166 seconds. 
  Full-batch training loss = 0.018589, test loss = 0.212630
  Training set accuracy = 0.996800, Test set accuracy = 0.943300
 epoch 18/30. Took 0.14278 seconds. 
  Full-batch training loss = 0.016172, test loss = 0.212857
  Training set accuracy = 0.998200, Test set accuracy = 0.943500
 epoch 19/30. Took 0.13459 seconds. 
  Full-batch training loss = 0.015038, test loss = 0.209753
  Training set accuracy = 0.998400, Test set accuracy = 0.945500
 epoch 20/30. Took 0.13505 seconds. 
  Full-batch training loss = 0.015551, test loss = 0.218963
  Training set accuracy = 0.997000, Test set accuracy = 0.943900
 epoch 21/30. Took 0.13595 seconds. 
  Full-batch training loss = 0.010810, test loss = 0.213962
  Training set accuracy = 0.999000, Test set accuracy = 0.944300
 epoch 22/30. Took 0.13931 seconds. 
  Full-batch training loss = 0.011306, test loss = 0.227605
  Training set accuracy = 0.998200, Test set accuracy = 0.944800
 epoch 23/30. Took 0.13542 seconds. 
  Full-batch training loss = 0.008348, test loss = 0.209488
  Training set accuracy = 0.999400, Test set accuracy = 0.945600
 epoch 24/30. Took 0.13591 seconds. 
  Full-batch training loss = 0.008129, test loss = 0.235113
  Training set accuracy = 0.998600, Test set accuracy = 0.942300
 epoch 25/30. Took 0.13447 seconds. 
  Full-batch training loss = 0.005437, test loss = 0.223577
  Training set accuracy = 0.999600, Test set accuracy = 0.948100
 epoch 26/30. Took 0.13445 seconds. 
  Full-batch training loss = 0.007588, test loss = 0.237679
  Training set accuracy = 0.998600, Test set accuracy = 0.945700
 epoch 27/30. Took 0.13669 seconds. 
  Full-batch training loss = 0.006136, test loss = 0.217418
  Training set accuracy = 0.999600, Test set accuracy = 0.947500
 epoch 28/30. Took 0.13471 seconds. 
  Full-batch training loss = 0.005926, test loss = 0.216952
  Training set accuracy = 0.999600, Test set accuracy = 0.944900
 epoch 29/30. Took 0.13591 seconds. 
  Full-batch training loss = 0.005617, test loss = 0.231082
  Training set accuracy = 0.999800, Test set accuracy = 0.944000
 epoch 30/30. Took 0.1352 seconds. 
  Full-batch training loss = 0.007832, test loss = 0.235820
  Training set accuracy = 0.998400, Test set accuracy = 0.945300
Elapsed time is 9.487543 seconds.
End Training
-----
Params 5000 0.100 0.20 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.2331 seconds. 
  Full-batch training loss = 0.487669, test loss = 0.503039
  Training set accuracy = 0.851200, Test set accuracy = 0.853700
 epoch 2/30. Took 0.22145 seconds. 
  Full-batch training loss = 0.293356, test loss = 0.332710
  Training set accuracy = 0.916000, Test set accuracy = 0.903700
 epoch 3/30. Took 0.2247 seconds. 
  Full-batch training loss = 0.228719, test loss = 0.291149
  Training set accuracy = 0.933600, Test set accuracy = 0.913100
 epoch 4/30. Took 0.22947 seconds. 
  Full-batch training loss = 0.181539, test loss = 0.258158
  Training set accuracy = 0.949400, Test set accuracy = 0.921600
 epoch 5/30. Took 0.2257 seconds. 
  Full-batch training loss = 0.140975, test loss = 0.237625
  Training set accuracy = 0.960600, Test set accuracy = 0.928300
 epoch 6/30. Took 0.22298 seconds. 
  Full-batch training loss = 0.124292, test loss = 0.233310
  Training set accuracy = 0.963800, Test set accuracy = 0.929100
 epoch 7/30. Took 0.22723 seconds. 
  Full-batch training loss = 0.093251, test loss = 0.212220
  Training set accuracy = 0.974000, Test set accuracy = 0.937600
 epoch 8/30. Took 0.22814 seconds. 
  Full-batch training loss = 0.072169, test loss = 0.196623
  Training set accuracy = 0.980800, Test set accuracy = 0.938900
 epoch 9/30. Took 0.22798 seconds. 
  Full-batch training loss = 0.064216, test loss = 0.206489
  Training set accuracy = 0.981600, Test set accuracy = 0.942300
 epoch 10/30. Took 0.21887 seconds. 
  Full-batch training loss = 0.046190, test loss = 0.195639
  Training set accuracy = 0.989400, Test set accuracy = 0.941600
 epoch 11/30. Took 0.23965 seconds. 
  Full-batch training loss = 0.033138, test loss = 0.186236
  Training set accuracy = 0.993000, Test set accuracy = 0.948900
 epoch 12/30. Took 0.22756 seconds. 
  Full-batch training loss = 0.037124, test loss = 0.199614
  Training set accuracy = 0.990800, Test set accuracy = 0.942700
 epoch 13/30. Took 0.25125 seconds. 
  Full-batch training loss = 0.025315, test loss = 0.193395
  Training set accuracy = 0.995200, Test set accuracy = 0.945700
 epoch 14/30. Took 0.22793 seconds. 
  Full-batch training loss = 0.016588, test loss = 0.184098
  Training set accuracy = 0.997600, Test set accuracy = 0.946000
 epoch 15/30. Took 0.22097 seconds. 
  Full-batch training loss = 0.017585, test loss = 0.188628
  Training set accuracy = 0.998200, Test set accuracy = 0.946400
 epoch 16/30. Took 0.22803 seconds. 
  Full-batch training loss = 0.010496, test loss = 0.183839
  Training set accuracy = 0.999600, Test set accuracy = 0.947900
 epoch 17/30. Took 0.22798 seconds. 
  Full-batch training loss = 0.008692, test loss = 0.186986
  Training set accuracy = 1.000000, Test set accuracy = 0.948300
 epoch 18/30. Took 0.22778 seconds. 
  Full-batch training loss = 0.008661, test loss = 0.194416
  Training set accuracy = 1.000000, Test set accuracy = 0.944900
 epoch 19/30. Took 0.21952 seconds. 
  Full-batch training loss = 0.005806, test loss = 0.177025
  Training set accuracy = 0.999800, Test set accuracy = 0.951100
 epoch 20/30. Took 0.2264 seconds. 
  Full-batch training loss = 0.007098, test loss = 0.190181
  Training set accuracy = 0.999200, Test set accuracy = 0.949200
 epoch 21/30. Took 0.22826 seconds. 
  Full-batch training loss = 0.005152, test loss = 0.198730
  Training set accuracy = 1.000000, Test set accuracy = 0.951700
 epoch 22/30. Took 0.22807 seconds. 
  Full-batch training loss = 0.003596, test loss = 0.193952
  Training set accuracy = 1.000000, Test set accuracy = 0.950600
 epoch 23/30. Took 0.22798 seconds. 
  Full-batch training loss = 0.003253, test loss = 0.193732
  Training set accuracy = 1.000000, Test set accuracy = 0.950500
 epoch 24/30. Took 0.24547 seconds. 
  Full-batch training loss = 0.004068, test loss = 0.199292
  Training set accuracy = 0.999800, Test set accuracy = 0.949900
 epoch 25/30. Took 0.22428 seconds. 
  Full-batch training loss = 0.002855, test loss = 0.189371
  Training set accuracy = 1.000000, Test set accuracy = 0.953400
 epoch 26/30. Took 0.22788 seconds. 
  Full-batch training loss = 0.002675, test loss = 0.194404
  Training set accuracy = 0.999800, Test set accuracy = 0.952300
 epoch 27/30. Took 0.22697 seconds. 
  Full-batch training loss = 0.001864, test loss = 0.196024
  Training set accuracy = 1.000000, Test set accuracy = 0.952900
 epoch 28/30. Took 0.22751 seconds. 
  Full-batch training loss = 0.001630, test loss = 0.199115
  Training set accuracy = 1.000000, Test set accuracy = 0.951800
 epoch 29/30. Took 0.22825 seconds. 
  Full-batch training loss = 0.001770, test loss = 0.195420
  Training set accuracy = 1.000000, Test set accuracy = 0.951000
 epoch 30/30. Took 0.22724 seconds. 
  Full-batch training loss = 0.001495, test loss = 0.201776
  Training set accuracy = 1.000000, Test set accuracy = 0.951600
Elapsed time is 15.171126 seconds.
End Training
-----
Params 5000 0.100 0.20 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.6316 seconds. 
  Full-batch training loss = 0.423411, test loss = 0.445771
  Training set accuracy = 0.873800, Test set accuracy = 0.867600
 epoch 2/30. Took 0.59291 seconds. 
  Full-batch training loss = 0.298125, test loss = 0.360448
  Training set accuracy = 0.907400, Test set accuracy = 0.886200
 epoch 3/30. Took 0.59174 seconds. 
  Full-batch training loss = 0.177757, test loss = 0.252349
  Training set accuracy = 0.947400, Test set accuracy = 0.924500
 epoch 4/30. Took 0.59337 seconds. 
  Full-batch training loss = 0.164853, test loss = 0.264957
  Training set accuracy = 0.950000, Test set accuracy = 0.918200
 epoch 5/30. Took 0.59279 seconds. 
  Full-batch training loss = 0.112031, test loss = 0.226013
  Training set accuracy = 0.969600, Test set accuracy = 0.931400
 epoch 6/30. Took 0.60259 seconds. 
  Full-batch training loss = 0.093748, test loss = 0.215982
  Training set accuracy = 0.977400, Test set accuracy = 0.933500
 epoch 7/30. Took 0.61123 seconds. 
  Full-batch training loss = 0.058176, test loss = 0.191389
  Training set accuracy = 0.987200, Test set accuracy = 0.943000
 epoch 8/30. Took 0.5922 seconds. 
  Full-batch training loss = 0.054394, test loss = 0.195718
  Training set accuracy = 0.986000, Test set accuracy = 0.941700
 epoch 9/30. Took 0.59071 seconds. 
  Full-batch training loss = 0.041886, test loss = 0.195689
  Training set accuracy = 0.991000, Test set accuracy = 0.939900
 epoch 10/30. Took 0.59279 seconds. 
  Full-batch training loss = 0.030527, test loss = 0.180438
  Training set accuracy = 0.994800, Test set accuracy = 0.944700
 epoch 11/30. Took 0.59262 seconds. 
  Full-batch training loss = 0.023084, test loss = 0.176444
  Training set accuracy = 0.995600, Test set accuracy = 0.946900
 epoch 12/30. Took 0.59245 seconds. 
  Full-batch training loss = 0.031711, test loss = 0.205853
  Training set accuracy = 0.992600, Test set accuracy = 0.939300
 epoch 13/30. Took 0.59028 seconds. 
  Full-batch training loss = 0.023081, test loss = 0.193711
  Training set accuracy = 0.995600, Test set accuracy = 0.943000
 epoch 14/30. Took 0.63003 seconds. 
  Full-batch training loss = 0.011508, test loss = 0.177092
  Training set accuracy = 0.998200, Test set accuracy = 0.948900
 epoch 15/30. Took 0.59177 seconds. 
  Full-batch training loss = 0.009234, test loss = 0.180968
  Training set accuracy = 0.999200, Test set accuracy = 0.950000
 epoch 16/30. Took 0.59371 seconds. 
  Full-batch training loss = 0.007686, test loss = 0.187402
  Training set accuracy = 0.999000, Test set accuracy = 0.948200
 epoch 17/30. Took 0.59422 seconds. 
  Full-batch training loss = 0.006273, test loss = 0.182821
  Training set accuracy = 0.999600, Test set accuracy = 0.950200
 epoch 18/30. Took 0.61676 seconds. 
  Full-batch training loss = 0.005029, test loss = 0.190047
  Training set accuracy = 0.999800, Test set accuracy = 0.948900
 epoch 19/30. Took 0.59703 seconds. 
  Full-batch training loss = 0.005074, test loss = 0.184573
  Training set accuracy = 0.999800, Test set accuracy = 0.949700
 epoch 20/30. Took 0.59301 seconds. 
  Full-batch training loss = 0.003469, test loss = 0.179706
  Training set accuracy = 1.000000, Test set accuracy = 0.953100
 epoch 21/30. Took 0.59471 seconds. 
  Full-batch training loss = 0.003692, test loss = 0.183192
  Training set accuracy = 0.999800, Test set accuracy = 0.950600
 epoch 22/30. Took 0.59587 seconds. 
  Full-batch training loss = 0.002106, test loss = 0.185931
  Training set accuracy = 1.000000, Test set accuracy = 0.951500
 epoch 23/30. Took 0.59575 seconds. 
  Full-batch training loss = 0.002344, test loss = 0.189497
  Training set accuracy = 1.000000, Test set accuracy = 0.951000
 epoch 24/30. Took 0.61942 seconds. 
  Full-batch training loss = 0.002274, test loss = 0.190858
  Training set accuracy = 1.000000, Test set accuracy = 0.951500
 epoch 25/30. Took 0.62178 seconds. 
  Full-batch training loss = 0.001715, test loss = 0.183487
  Training set accuracy = 1.000000, Test set accuracy = 0.951400
 epoch 26/30. Took 0.60025 seconds. 
  Full-batch training loss = 0.001563, test loss = 0.184961
  Training set accuracy = 1.000000, Test set accuracy = 0.953200
 epoch 27/30. Took 0.59977 seconds. 
  Full-batch training loss = 0.001514, test loss = 0.195664
  Training set accuracy = 1.000000, Test set accuracy = 0.951500
 epoch 28/30. Took 0.60305 seconds. 
  Full-batch training loss = 0.001213, test loss = 0.190688
  Training set accuracy = 1.000000, Test set accuracy = 0.951700
 epoch 29/30. Took 0.62104 seconds. 
  Full-batch training loss = 0.001171, test loss = 0.195754
  Training set accuracy = 1.000000, Test set accuracy = 0.952100
 epoch 30/30. Took 0.61387 seconds. 
  Full-batch training loss = 0.001174, test loss = 0.196049
  Training set accuracy = 1.000000, Test set accuracy = 0.951700
Elapsed time is 38.048363 seconds.
End Training
-----
Params 5000 0.100 0.20 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.15961 seconds. 
  Full-batch training loss = 0.718716, test loss = 0.734554
  Training set accuracy = 0.742200, Test set accuracy = 0.737600
 epoch 2/30. Took 0.15755 seconds. 
  Full-batch training loss = 0.364364, test loss = 0.406395
  Training set accuracy = 0.894200, Test set accuracy = 0.876800
 epoch 3/30. Took 0.16048 seconds. 
  Full-batch training loss = 0.307594, test loss = 0.370935
  Training set accuracy = 0.902600, Test set accuracy = 0.889200
 epoch 4/30. Took 0.15042 seconds. 
  Full-batch training loss = 0.187942, test loss = 0.275034
  Training set accuracy = 0.945600, Test set accuracy = 0.915600
 epoch 5/30. Took 0.1616 seconds. 
  Full-batch training loss = 0.161478, test loss = 0.266031
  Training set accuracy = 0.950000, Test set accuracy = 0.917300
 epoch 6/30. Took 0.15092 seconds. 
  Full-batch training loss = 0.139132, test loss = 0.260461
  Training set accuracy = 0.958400, Test set accuracy = 0.922100
 epoch 7/30. Took 0.15087 seconds. 
  Full-batch training loss = 0.125239, test loss = 0.254589
  Training set accuracy = 0.963800, Test set accuracy = 0.924300
 epoch 8/30. Took 0.16277 seconds. 
  Full-batch training loss = 0.086389, test loss = 0.230589
  Training set accuracy = 0.973200, Test set accuracy = 0.933100
 epoch 9/30. Took 0.15138 seconds. 
  Full-batch training loss = 0.076948, test loss = 0.232632
  Training set accuracy = 0.975200, Test set accuracy = 0.935100
 epoch 10/30. Took 0.15189 seconds. 
  Full-batch training loss = 0.066937, test loss = 0.230637
  Training set accuracy = 0.979400, Test set accuracy = 0.934700
 epoch 11/30. Took 0.15191 seconds. 
  Full-batch training loss = 0.053834, test loss = 0.230501
  Training set accuracy = 0.982000, Test set accuracy = 0.939200
 epoch 12/30. Took 0.16639 seconds. 
  Full-batch training loss = 0.063154, test loss = 0.240723
  Training set accuracy = 0.980600, Test set accuracy = 0.932900
 epoch 13/30. Took 0.16684 seconds. 
  Full-batch training loss = 0.041855, test loss = 0.230589
  Training set accuracy = 0.988000, Test set accuracy = 0.940700
 epoch 14/30. Took 0.14913 seconds. 
  Full-batch training loss = 0.048089, test loss = 0.228918
  Training set accuracy = 0.986400, Test set accuracy = 0.939700
 epoch 15/30. Took 0.15056 seconds. 
  Full-batch training loss = 0.035594, test loss = 0.216695
  Training set accuracy = 0.991200, Test set accuracy = 0.940600
 epoch 16/30. Took 0.1551 seconds. 
  Full-batch training loss = 0.035376, test loss = 0.262004
  Training set accuracy = 0.990200, Test set accuracy = 0.937100
 epoch 17/30. Took 0.15433 seconds. 
  Full-batch training loss = 0.024939, test loss = 0.248361
  Training set accuracy = 0.992200, Test set accuracy = 0.939100
 epoch 18/30. Took 0.16198 seconds. 
  Full-batch training loss = 0.027678, test loss = 0.241618
  Training set accuracy = 0.991600, Test set accuracy = 0.939800
 epoch 19/30. Took 0.15637 seconds. 
  Full-batch training loss = 0.017356, test loss = 0.234168
  Training set accuracy = 0.994800, Test set accuracy = 0.944300
 epoch 20/30. Took 0.16153 seconds. 
  Full-batch training loss = 0.027810, test loss = 0.267179
  Training set accuracy = 0.991000, Test set accuracy = 0.940900
 epoch 21/30. Took 0.16339 seconds. 
  Full-batch training loss = 0.017219, test loss = 0.244123
  Training set accuracy = 0.996400, Test set accuracy = 0.943800
 epoch 22/30. Took 0.1711 seconds. 
  Full-batch training loss = 0.010096, test loss = 0.232119
  Training set accuracy = 0.998000, Test set accuracy = 0.946600
 epoch 23/30. Took 0.16022 seconds. 
  Full-batch training loss = 0.006939, test loss = 0.241201
  Training set accuracy = 0.998200, Test set accuracy = 0.946800
 epoch 24/30. Took 0.15881 seconds. 
  Full-batch training loss = 0.007557, test loss = 0.231077
  Training set accuracy = 0.998400, Test set accuracy = 0.944600
 epoch 25/30. Took 0.15182 seconds. 
  Full-batch training loss = 0.008425, test loss = 0.248776
  Training set accuracy = 0.997800, Test set accuracy = 0.945600
 epoch 26/30. Took 0.15108 seconds. 
  Full-batch training loss = 0.006646, test loss = 0.242983
  Training set accuracy = 0.999200, Test set accuracy = 0.945700
 epoch 27/30. Took 0.1577 seconds. 
  Full-batch training loss = 0.009754, test loss = 0.259452
  Training set accuracy = 0.997600, Test set accuracy = 0.940800
 epoch 28/30. Took 0.15725 seconds. 
  Full-batch training loss = 0.007510, test loss = 0.258370
  Training set accuracy = 0.997400, Test set accuracy = 0.944500
 epoch 29/30. Took 0.16654 seconds. 
  Full-batch training loss = 0.010321, test loss = 0.266500
  Training set accuracy = 0.997200, Test set accuracy = 0.944900
 epoch 30/30. Took 0.15463 seconds. 
  Full-batch training loss = 0.009321, test loss = 0.259353
  Training set accuracy = 0.998000, Test set accuracy = 0.943300
Elapsed time is 10.767368 seconds.
End Training
-----
Params 5000 0.100 0.20 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27743 seconds. 
  Full-batch training loss = 0.586238, test loss = 0.581863
  Training set accuracy = 0.817200, Test set accuracy = 0.817100
 epoch 2/30. Took 0.27664 seconds. 
  Full-batch training loss = 0.324952, test loss = 0.343183
  Training set accuracy = 0.907000, Test set accuracy = 0.897500
 epoch 3/30. Took 0.27317 seconds. 
  Full-batch training loss = 0.287218, test loss = 0.336516
  Training set accuracy = 0.912400, Test set accuracy = 0.895400
 epoch 4/30. Took 0.27439 seconds. 
  Full-batch training loss = 0.180348, test loss = 0.242257
  Training set accuracy = 0.947000, Test set accuracy = 0.926100
 epoch 5/30. Took 0.29177 seconds. 
  Full-batch training loss = 0.145145, test loss = 0.227923
  Training set accuracy = 0.956800, Test set accuracy = 0.928700
 epoch 6/30. Took 0.28113 seconds. 
  Full-batch training loss = 0.110276, test loss = 0.202749
  Training set accuracy = 0.969800, Test set accuracy = 0.938000
 epoch 7/30. Took 0.28215 seconds. 
  Full-batch training loss = 0.085087, test loss = 0.191846
  Training set accuracy = 0.975000, Test set accuracy = 0.940200
 epoch 8/30. Took 0.28216 seconds. 
  Full-batch training loss = 0.064657, test loss = 0.186480
  Training set accuracy = 0.982400, Test set accuracy = 0.943300
 epoch 9/30. Took 0.26427 seconds. 
  Full-batch training loss = 0.053876, test loss = 0.196306
  Training set accuracy = 0.984800, Test set accuracy = 0.944600
 epoch 10/30. Took 0.27607 seconds. 
  Full-batch training loss = 0.045870, test loss = 0.196455
  Training set accuracy = 0.987000, Test set accuracy = 0.942600
 epoch 11/30. Took 0.2686 seconds. 
  Full-batch training loss = 0.065211, test loss = 0.238904
  Training set accuracy = 0.979800, Test set accuracy = 0.932900
 epoch 12/30. Took 0.28051 seconds. 
  Full-batch training loss = 0.023851, test loss = 0.168867
  Training set accuracy = 0.994200, Test set accuracy = 0.952100
 epoch 13/30. Took 0.28682 seconds. 
  Full-batch training loss = 0.023229, test loss = 0.185317
  Training set accuracy = 0.993200, Test set accuracy = 0.949800
 epoch 14/30. Took 0.26611 seconds. 
  Full-batch training loss = 0.020770, test loss = 0.189901
  Training set accuracy = 0.994800, Test set accuracy = 0.948900
 epoch 15/30. Took 0.27864 seconds. 
  Full-batch training loss = 0.019662, test loss = 0.191080
  Training set accuracy = 0.993800, Test set accuracy = 0.951700
 epoch 16/30. Took 0.27163 seconds. 
  Full-batch training loss = 0.014314, test loss = 0.186833
  Training set accuracy = 0.997400, Test set accuracy = 0.948500
 epoch 17/30. Took 0.29152 seconds. 
  Full-batch training loss = 0.011404, test loss = 0.189976
  Training set accuracy = 0.997800, Test set accuracy = 0.951000
 epoch 18/30. Took 0.27916 seconds. 
  Full-batch training loss = 0.018234, test loss = 0.215158
  Training set accuracy = 0.995000, Test set accuracy = 0.945300
 epoch 19/30. Took 0.27959 seconds. 
  Full-batch training loss = 0.007883, test loss = 0.183934
  Training set accuracy = 0.998400, Test set accuracy = 0.952600
 epoch 20/30. Took 0.28052 seconds. 
  Full-batch training loss = 0.008581, test loss = 0.191001
  Training set accuracy = 0.998000, Test set accuracy = 0.950400
 epoch 21/30. Took 0.27076 seconds. 
  Full-batch training loss = 0.005832, test loss = 0.194740
  Training set accuracy = 0.999000, Test set accuracy = 0.950500
 epoch 22/30. Took 0.30122 seconds. 
  Full-batch training loss = 0.005744, test loss = 0.186954
  Training set accuracy = 0.998400, Test set accuracy = 0.954500
 epoch 23/30. Took 0.26509 seconds. 
  Full-batch training loss = 0.002893, test loss = 0.192378
  Training set accuracy = 0.999400, Test set accuracy = 0.954200
 epoch 24/30. Took 0.26881 seconds. 
  Full-batch training loss = 0.006175, test loss = 0.220616
  Training set accuracy = 0.999000, Test set accuracy = 0.948400
 epoch 25/30. Took 0.27784 seconds. 
  Full-batch training loss = 0.002848, test loss = 0.200314
  Training set accuracy = 0.999400, Test set accuracy = 0.955800
 epoch 26/30. Took 0.27678 seconds. 
  Full-batch training loss = 0.004615, test loss = 0.204996
  Training set accuracy = 0.999200, Test set accuracy = 0.951300
 epoch 27/30. Took 0.26655 seconds. 
  Full-batch training loss = 0.005048, test loss = 0.225021
  Training set accuracy = 0.998800, Test set accuracy = 0.948800
 epoch 28/30. Took 0.27749 seconds. 
  Full-batch training loss = 0.004177, test loss = 0.222554
  Training set accuracy = 0.999000, Test set accuracy = 0.950200
 epoch 29/30. Took 0.29688 seconds. 
  Full-batch training loss = 0.004134, test loss = 0.216703
  Training set accuracy = 0.999200, Test set accuracy = 0.951400
 epoch 30/30. Took 0.26659 seconds. 
  Full-batch training loss = 0.003039, test loss = 0.224688
  Training set accuracy = 0.999200, Test set accuracy = 0.952600
Elapsed time is 18.356053 seconds.
End Training
-----
Params 5000 0.100 0.20 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.89226 seconds. 
  Full-batch training loss = 0.458126, test loss = 0.457457
  Training set accuracy = 0.859800, Test set accuracy = 0.858500
 epoch 2/30. Took 0.83404 seconds. 
  Full-batch training loss = 0.285565, test loss = 0.323738
  Training set accuracy = 0.916800, Test set accuracy = 0.903500
 epoch 3/30. Took 0.81881 seconds. 
  Full-batch training loss = 0.210409, test loss = 0.278405
  Training set accuracy = 0.937600, Test set accuracy = 0.913500
 epoch 4/30. Took 0.81757 seconds. 
  Full-batch training loss = 0.156406, test loss = 0.241294
  Training set accuracy = 0.952200, Test set accuracy = 0.927300
 epoch 5/30. Took 0.93276 seconds. 
  Full-batch training loss = 0.134675, test loss = 0.235896
  Training set accuracy = 0.960400, Test set accuracy = 0.923100
 epoch 6/30. Took 0.84941 seconds. 
  Full-batch training loss = 0.115583, test loss = 0.240823
  Training set accuracy = 0.966000, Test set accuracy = 0.924900
 epoch 7/30. Took 0.82076 seconds. 
  Full-batch training loss = 0.084832, test loss = 0.216408
  Training set accuracy = 0.975000, Test set accuracy = 0.936900
 epoch 8/30. Took 0.82984 seconds. 
  Full-batch training loss = 0.044863, test loss = 0.182136
  Training set accuracy = 0.988800, Test set accuracy = 0.947700
 epoch 9/30. Took 0.86043 seconds. 
  Full-batch training loss = 0.034904, test loss = 0.195524
  Training set accuracy = 0.991200, Test set accuracy = 0.945300
 epoch 10/30. Took 0.81278 seconds. 
  Full-batch training loss = 0.024773, test loss = 0.193454
  Training set accuracy = 0.994800, Test set accuracy = 0.945600
 epoch 11/30. Took 0.81895 seconds. 
  Full-batch training loss = 0.015101, test loss = 0.179840
  Training set accuracy = 0.997200, Test set accuracy = 0.950200
 epoch 12/30. Took 0.81621 seconds. 
  Full-batch training loss = 0.016633, test loss = 0.195930
  Training set accuracy = 0.996400, Test set accuracy = 0.948000
 epoch 13/30. Took 0.85872 seconds. 
  Full-batch training loss = 0.019388, test loss = 0.197141
  Training set accuracy = 0.994000, Test set accuracy = 0.946600
 epoch 14/30. Took 0.81314 seconds. 
  Full-batch training loss = 0.010224, test loss = 0.194549
  Training set accuracy = 0.997200, Test set accuracy = 0.950100
 epoch 15/30. Took 0.82035 seconds. 
  Full-batch training loss = 0.019090, test loss = 0.231671
  Training set accuracy = 0.994200, Test set accuracy = 0.943100
 epoch 16/30. Took 0.91938 seconds. 
  Full-batch training loss = 0.009043, test loss = 0.187421
  Training set accuracy = 0.997600, Test set accuracy = 0.953000
 epoch 17/30. Took 0.82879 seconds. 
  Full-batch training loss = 0.004756, test loss = 0.188364
  Training set accuracy = 0.999400, Test set accuracy = 0.955200
 epoch 18/30. Took 0.81999 seconds. 
  Full-batch training loss = 0.004408, test loss = 0.200486
  Training set accuracy = 0.998800, Test set accuracy = 0.953900
 epoch 19/30. Took 0.8695 seconds. 
  Full-batch training loss = 0.006339, test loss = 0.221081
  Training set accuracy = 0.999000, Test set accuracy = 0.948200
 epoch 20/30. Took 0.88685 seconds. 
  Full-batch training loss = 0.002118, test loss = 0.210742
  Training set accuracy = 1.000000, Test set accuracy = 0.953100
 epoch 21/30. Took 0.8172 seconds. 
  Full-batch training loss = 0.002585, test loss = 0.200038
  Training set accuracy = 0.999600, Test set accuracy = 0.956600
 epoch 22/30. Took 0.82139 seconds. 
  Full-batch training loss = 0.004944, test loss = 0.230107
  Training set accuracy = 0.998600, Test set accuracy = 0.949900
 epoch 23/30. Took 0.88583 seconds. 
  Full-batch training loss = 0.001469, test loss = 0.210012
  Training set accuracy = 1.000000, Test set accuracy = 0.953400
 epoch 24/30. Took 0.81535 seconds. 
  Full-batch training loss = 0.002335, test loss = 0.202308
  Training set accuracy = 0.999800, Test set accuracy = 0.953600
 epoch 25/30. Took 0.82178 seconds. 
  Full-batch training loss = 0.001311, test loss = 0.212809
  Training set accuracy = 1.000000, Test set accuracy = 0.955000
 epoch 26/30. Took 0.91617 seconds. 
  Full-batch training loss = 0.000852, test loss = 0.196936
  Training set accuracy = 1.000000, Test set accuracy = 0.957200
 epoch 27/30. Took 0.81537 seconds. 
  Full-batch training loss = 0.002013, test loss = 0.224560
  Training set accuracy = 0.999400, Test set accuracy = 0.954000
 epoch 28/30. Took 0.81894 seconds. 
  Full-batch training loss = 0.003569, test loss = 0.222747
  Training set accuracy = 0.999200, Test set accuracy = 0.955100
 epoch 29/30. Took 0.8191 seconds. 
  Full-batch training loss = 0.000480, test loss = 0.221215
  Training set accuracy = 1.000000, Test set accuracy = 0.956800
 epoch 30/30. Took 0.81937 seconds. 
  Full-batch training loss = 0.000743, test loss = 0.218889
  Training set accuracy = 1.000000, Test set accuracy = 0.952400
Elapsed time is 52.707341 seconds.
End Training
-----
Params 5000 0.100 0.30 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11837 seconds. 
  Full-batch training loss = 0.474036, test loss = 0.480967
  Training set accuracy = 0.862800, Test set accuracy = 0.858100
 epoch 2/30. Took 0.1102 seconds. 
  Full-batch training loss = 0.335430, test loss = 0.365383
  Training set accuracy = 0.904000, Test set accuracy = 0.898400
 epoch 3/30. Took 0.11394 seconds. 
  Full-batch training loss = 0.296595, test loss = 0.339022
  Training set accuracy = 0.913200, Test set accuracy = 0.900100
 epoch 4/30. Took 0.12099 seconds. 
  Full-batch training loss = 0.243490, test loss = 0.300217
  Training set accuracy = 0.924800, Test set accuracy = 0.909200
 epoch 5/30. Took 0.11571 seconds. 
  Full-batch training loss = 0.215439, test loss = 0.284673
  Training set accuracy = 0.938000, Test set accuracy = 0.916600
 epoch 6/30. Took 0.1184 seconds. 
  Full-batch training loss = 0.175732, test loss = 0.257187
  Training set accuracy = 0.948400, Test set accuracy = 0.925700
 epoch 7/30. Took 0.11798 seconds. 
  Full-batch training loss = 0.156920, test loss = 0.244856
  Training set accuracy = 0.957000, Test set accuracy = 0.929200
 epoch 8/30. Took 0.11633 seconds. 
  Full-batch training loss = 0.141283, test loss = 0.240227
  Training set accuracy = 0.959200, Test set accuracy = 0.930500
 epoch 9/30. Took 0.11564 seconds. 
  Full-batch training loss = 0.124015, test loss = 0.228272
  Training set accuracy = 0.966800, Test set accuracy = 0.932900
 epoch 10/30. Took 0.10717 seconds. 
  Full-batch training loss = 0.114965, test loss = 0.223132
  Training set accuracy = 0.967400, Test set accuracy = 0.934400
 epoch 11/30. Took 0.10909 seconds. 
  Full-batch training loss = 0.096432, test loss = 0.219927
  Training set accuracy = 0.975000, Test set accuracy = 0.935400
 epoch 12/30. Took 0.11012 seconds. 
  Full-batch training loss = 0.087213, test loss = 0.216559
  Training set accuracy = 0.977800, Test set accuracy = 0.934800
 epoch 13/30. Took 0.1107 seconds. 
  Full-batch training loss = 0.083054, test loss = 0.213358
  Training set accuracy = 0.980200, Test set accuracy = 0.938500
 epoch 14/30. Took 0.10913 seconds. 
  Full-batch training loss = 0.071433, test loss = 0.204566
  Training set accuracy = 0.983800, Test set accuracy = 0.941700
 epoch 15/30. Took 0.10882 seconds. 
  Full-batch training loss = 0.064159, test loss = 0.201195
  Training set accuracy = 0.987600, Test set accuracy = 0.940800
 epoch 16/30. Took 0.11066 seconds. 
  Full-batch training loss = 0.059993, test loss = 0.206584
  Training set accuracy = 0.986600, Test set accuracy = 0.938900
 epoch 17/30. Took 0.10984 seconds. 
  Full-batch training loss = 0.054393, test loss = 0.201925
  Training set accuracy = 0.990000, Test set accuracy = 0.941500
 epoch 18/30. Took 0.11013 seconds. 
  Full-batch training loss = 0.057369, test loss = 0.215625
  Training set accuracy = 0.987200, Test set accuracy = 0.936100
 epoch 19/30. Took 0.10996 seconds. 
  Full-batch training loss = 0.045664, test loss = 0.194284
  Training set accuracy = 0.991200, Test set accuracy = 0.944400
 epoch 20/30. Took 0.10853 seconds. 
  Full-batch training loss = 0.046369, test loss = 0.210319
  Training set accuracy = 0.991200, Test set accuracy = 0.939600
 epoch 21/30. Took 0.1091 seconds. 
  Full-batch training loss = 0.036590, test loss = 0.198754
  Training set accuracy = 0.994200, Test set accuracy = 0.943500
 epoch 22/30. Took 0.10941 seconds. 
  Full-batch training loss = 0.038184, test loss = 0.199742
  Training set accuracy = 0.993800, Test set accuracy = 0.942800
 epoch 23/30. Took 0.10934 seconds. 
  Full-batch training loss = 0.034607, test loss = 0.199132
  Training set accuracy = 0.994600, Test set accuracy = 0.944300
 epoch 24/30. Took 0.1181 seconds. 
  Full-batch training loss = 0.029270, test loss = 0.200283
  Training set accuracy = 0.996600, Test set accuracy = 0.941900
 epoch 25/30. Took 0.10799 seconds. 
  Full-batch training loss = 0.025570, test loss = 0.198175
  Training set accuracy = 0.997000, Test set accuracy = 0.945400
 epoch 26/30. Took 0.10817 seconds. 
  Full-batch training loss = 0.025458, test loss = 0.192419
  Training set accuracy = 0.997800, Test set accuracy = 0.945900
 epoch 27/30. Took 0.10978 seconds. 
  Full-batch training loss = 0.022615, test loss = 0.195615
  Training set accuracy = 0.998600, Test set accuracy = 0.945000
 epoch 28/30. Took 0.10896 seconds. 
  Full-batch training loss = 0.022830, test loss = 0.195195
  Training set accuracy = 0.998000, Test set accuracy = 0.944500
 epoch 29/30. Took 0.10833 seconds. 
  Full-batch training loss = 0.022981, test loss = 0.209384
  Training set accuracy = 0.998200, Test set accuracy = 0.941400
 epoch 30/30. Took 0.10625 seconds. 
  Full-batch training loss = 0.019872, test loss = 0.192039
  Training set accuracy = 0.999000, Test set accuracy = 0.947200
Elapsed time is 8.205400 seconds.
End Training
-----
Params 5000 0.100 0.30 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17275 seconds. 
  Full-batch training loss = 0.426520, test loss = 0.429715
  Training set accuracy = 0.884200, Test set accuracy = 0.884500
 epoch 2/30. Took 0.16701 seconds. 
  Full-batch training loss = 0.308223, test loss = 0.339582
  Training set accuracy = 0.915400, Test set accuracy = 0.905800
 epoch 3/30. Took 0.16745 seconds. 
  Full-batch training loss = 0.264687, test loss = 0.310510
  Training set accuracy = 0.925400, Test set accuracy = 0.911700
 epoch 4/30. Took 0.16938 seconds. 
  Full-batch training loss = 0.212136, test loss = 0.273544
  Training set accuracy = 0.941400, Test set accuracy = 0.923700
 epoch 5/30. Took 0.16384 seconds. 
  Full-batch training loss = 0.182911, test loss = 0.258118
  Training set accuracy = 0.950600, Test set accuracy = 0.927200
 epoch 6/30. Took 0.16425 seconds. 
  Full-batch training loss = 0.160728, test loss = 0.247541
  Training set accuracy = 0.954400, Test set accuracy = 0.928200
 epoch 7/30. Took 0.16447 seconds. 
  Full-batch training loss = 0.138834, test loss = 0.231811
  Training set accuracy = 0.963400, Test set accuracy = 0.933300
 epoch 8/30. Took 0.16548 seconds. 
  Full-batch training loss = 0.120936, test loss = 0.220661
  Training set accuracy = 0.970000, Test set accuracy = 0.935300
 epoch 9/30. Took 0.16611 seconds. 
  Full-batch training loss = 0.104951, test loss = 0.210336
  Training set accuracy = 0.976000, Test set accuracy = 0.938600
 epoch 10/30. Took 0.16662 seconds. 
  Full-batch training loss = 0.097943, test loss = 0.210784
  Training set accuracy = 0.975600, Test set accuracy = 0.937100
 epoch 11/30. Took 0.16869 seconds. 
  Full-batch training loss = 0.085423, test loss = 0.209370
  Training set accuracy = 0.979000, Test set accuracy = 0.938100
 epoch 12/30. Took 0.16942 seconds. 
  Full-batch training loss = 0.072282, test loss = 0.196613
  Training set accuracy = 0.984000, Test set accuracy = 0.942900
 epoch 13/30. Took 0.16273 seconds. 
  Full-batch training loss = 0.064125, test loss = 0.194399
  Training set accuracy = 0.984600, Test set accuracy = 0.941500
 epoch 14/30. Took 0.1653 seconds. 
  Full-batch training loss = 0.056407, test loss = 0.188200
  Training set accuracy = 0.988600, Test set accuracy = 0.945800
 epoch 15/30. Took 0.16329 seconds. 
  Full-batch training loss = 0.051131, test loss = 0.187229
  Training set accuracy = 0.989200, Test set accuracy = 0.944800
 epoch 16/30. Took 0.16458 seconds. 
  Full-batch training loss = 0.045983, test loss = 0.187611
  Training set accuracy = 0.991400, Test set accuracy = 0.947000
 epoch 17/30. Took 0.16831 seconds. 
  Full-batch training loss = 0.039928, test loss = 0.179612
  Training set accuracy = 0.993400, Test set accuracy = 0.947600
 epoch 18/30. Took 0.16922 seconds. 
  Full-batch training loss = 0.039003, test loss = 0.184585
  Training set accuracy = 0.993400, Test set accuracy = 0.946900
 epoch 19/30. Took 0.16957 seconds. 
  Full-batch training loss = 0.032689, test loss = 0.181691
  Training set accuracy = 0.996000, Test set accuracy = 0.947300
 epoch 20/30. Took 0.17199 seconds. 
  Full-batch training loss = 0.030504, test loss = 0.181648
  Training set accuracy = 0.996200, Test set accuracy = 0.947400
 epoch 21/30. Took 0.16948 seconds. 
  Full-batch training loss = 0.026315, test loss = 0.175774
  Training set accuracy = 0.996200, Test set accuracy = 0.950000
 epoch 22/30. Took 0.18606 seconds. 
  Full-batch training loss = 0.022913, test loss = 0.177055
  Training set accuracy = 0.997400, Test set accuracy = 0.948800
 epoch 23/30. Took 0.1752 seconds. 
  Full-batch training loss = 0.022099, test loss = 0.172215
  Training set accuracy = 0.998600, Test set accuracy = 0.951600
 epoch 24/30. Took 0.16668 seconds. 
  Full-batch training loss = 0.020022, test loss = 0.179254
  Training set accuracy = 0.998200, Test set accuracy = 0.949800
 epoch 25/30. Took 0.1688 seconds. 
  Full-batch training loss = 0.020180, test loss = 0.177888
  Training set accuracy = 0.998600, Test set accuracy = 0.950400
 epoch 26/30. Took 0.16944 seconds. 
  Full-batch training loss = 0.018205, test loss = 0.176287
  Training set accuracy = 0.998600, Test set accuracy = 0.951700
 epoch 27/30. Took 0.16857 seconds. 
  Full-batch training loss = 0.014804, test loss = 0.173687
  Training set accuracy = 0.999000, Test set accuracy = 0.952700
 epoch 28/30. Took 0.16746 seconds. 
  Full-batch training loss = 0.014682, test loss = 0.180144
  Training set accuracy = 0.999000, Test set accuracy = 0.951200
 epoch 29/30. Took 0.1753 seconds. 
  Full-batch training loss = 0.014806, test loss = 0.175736
  Training set accuracy = 0.999400, Test set accuracy = 0.952100
 epoch 30/30. Took 0.16376 seconds. 
  Full-batch training loss = 0.012122, test loss = 0.174891
  Training set accuracy = 0.999600, Test set accuracy = 0.952400
Elapsed time is 11.643618 seconds.
End Training
-----
Params 5000 0.100 0.30 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.38154 seconds. 
  Full-batch training loss = 0.404718, test loss = 0.411841
  Training set accuracy = 0.886800, Test set accuracy = 0.886800
 epoch 2/30. Took 0.35587 seconds. 
  Full-batch training loss = 0.304887, test loss = 0.332428
  Training set accuracy = 0.912600, Test set accuracy = 0.904600
 epoch 3/30. Took 0.35885 seconds. 
  Full-batch training loss = 0.240336, test loss = 0.292004
  Training set accuracy = 0.934600, Test set accuracy = 0.917200
 epoch 4/30. Took 0.3561 seconds. 
  Full-batch training loss = 0.214370, test loss = 0.279958
  Training set accuracy = 0.941400, Test set accuracy = 0.915500
 epoch 5/30. Took 0.36379 seconds. 
  Full-batch training loss = 0.182638, test loss = 0.262393
  Training set accuracy = 0.947800, Test set accuracy = 0.920600
 epoch 6/30. Took 0.35606 seconds. 
  Full-batch training loss = 0.155150, test loss = 0.236041
  Training set accuracy = 0.957200, Test set accuracy = 0.928900
 epoch 7/30. Took 0.35743 seconds. 
  Full-batch training loss = 0.134608, test loss = 0.228531
  Training set accuracy = 0.963400, Test set accuracy = 0.934100
 epoch 8/30. Took 0.35114 seconds. 
  Full-batch training loss = 0.109242, test loss = 0.213279
  Training set accuracy = 0.973000, Test set accuracy = 0.935500
 epoch 9/30. Took 0.36325 seconds. 
  Full-batch training loss = 0.102363, test loss = 0.214637
  Training set accuracy = 0.972800, Test set accuracy = 0.936300
 epoch 10/30. Took 0.35346 seconds. 
  Full-batch training loss = 0.081852, test loss = 0.200700
  Training set accuracy = 0.979600, Test set accuracy = 0.940000
 epoch 11/30. Took 0.37701 seconds. 
  Full-batch training loss = 0.073385, test loss = 0.194278
  Training set accuracy = 0.984600, Test set accuracy = 0.941800
 epoch 12/30. Took 0.35071 seconds. 
  Full-batch training loss = 0.069251, test loss = 0.194603
  Training set accuracy = 0.984800, Test set accuracy = 0.941200
 epoch 13/30. Took 0.35566 seconds. 
  Full-batch training loss = 0.054664, test loss = 0.182639
  Training set accuracy = 0.990200, Test set accuracy = 0.943700
 epoch 14/30. Took 0.36126 seconds. 
  Full-batch training loss = 0.050169, test loss = 0.185599
  Training set accuracy = 0.991800, Test set accuracy = 0.944400
 epoch 15/30. Took 0.35537 seconds. 
  Full-batch training loss = 0.042638, test loss = 0.182818
  Training set accuracy = 0.995400, Test set accuracy = 0.943700
 epoch 16/30. Took 0.35439 seconds. 
  Full-batch training loss = 0.041222, test loss = 0.180340
  Training set accuracy = 0.992400, Test set accuracy = 0.945800
 epoch 17/30. Took 0.39976 seconds. 
  Full-batch training loss = 0.032918, test loss = 0.172679
  Training set accuracy = 0.996200, Test set accuracy = 0.948300
 epoch 18/30. Took 0.35698 seconds. 
  Full-batch training loss = 0.029802, test loss = 0.177721
  Training set accuracy = 0.997400, Test set accuracy = 0.947200
 epoch 19/30. Took 0.3528 seconds. 
  Full-batch training loss = 0.025883, test loss = 0.171189
  Training set accuracy = 0.997400, Test set accuracy = 0.949300
 epoch 20/30. Took 0.35502 seconds. 
  Full-batch training loss = 0.022699, test loss = 0.170764
  Training set accuracy = 0.998800, Test set accuracy = 0.950000
 epoch 21/30. Took 0.35166 seconds. 
  Full-batch training loss = 0.022793, test loss = 0.173152
  Training set accuracy = 0.998600, Test set accuracy = 0.949500
 epoch 22/30. Took 0.35679 seconds. 
  Full-batch training loss = 0.019391, test loss = 0.172481
  Training set accuracy = 0.998800, Test set accuracy = 0.949000
 epoch 23/30. Took 0.35539 seconds. 
  Full-batch training loss = 0.019235, test loss = 0.173939
  Training set accuracy = 0.999000, Test set accuracy = 0.948500
 epoch 24/30. Took 0.35536 seconds. 
  Full-batch training loss = 0.016805, test loss = 0.170283
  Training set accuracy = 0.999400, Test set accuracy = 0.947600
 epoch 25/30. Took 0.35069 seconds. 
  Full-batch training loss = 0.014884, test loss = 0.170194
  Training set accuracy = 0.999400, Test set accuracy = 0.950800
 epoch 26/30. Took 0.37197 seconds. 
  Full-batch training loss = 0.013589, test loss = 0.171811
  Training set accuracy = 0.999800, Test set accuracy = 0.950000
 epoch 27/30. Took 0.3712 seconds. 
  Full-batch training loss = 0.011854, test loss = 0.169080
  Training set accuracy = 0.999800, Test set accuracy = 0.952000
 epoch 28/30. Took 0.35124 seconds. 
  Full-batch training loss = 0.011183, test loss = 0.170857
  Training set accuracy = 1.000000, Test set accuracy = 0.950400
 epoch 29/30. Took 0.35476 seconds. 
  Full-batch training loss = 0.010278, test loss = 0.170221
  Training set accuracy = 0.999800, Test set accuracy = 0.950600
 epoch 30/30. Took 0.35507 seconds. 
  Full-batch training loss = 0.010338, test loss = 0.172973
  Training set accuracy = 0.999800, Test set accuracy = 0.949400
Elapsed time is 23.492532 seconds.
End Training
-----
Params 5000 0.100 0.30 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.1425 seconds. 
  Full-batch training loss = 0.613481, test loss = 0.617886
  Training set accuracy = 0.826400, Test set accuracy = 0.830300
 epoch 2/30. Took 0.13456 seconds. 
  Full-batch training loss = 0.365650, test loss = 0.394175
  Training set accuracy = 0.899400, Test set accuracy = 0.887100
 epoch 3/30. Took 0.13517 seconds. 
  Full-batch training loss = 0.286735, test loss = 0.340794
  Training set accuracy = 0.917200, Test set accuracy = 0.897800
 epoch 4/30. Took 0.13598 seconds. 
  Full-batch training loss = 0.245245, test loss = 0.309305
  Training set accuracy = 0.929200, Test set accuracy = 0.905600
 epoch 5/30. Took 0.13489 seconds. 
  Full-batch training loss = 0.198409, test loss = 0.268320
  Training set accuracy = 0.946000, Test set accuracy = 0.922400
 epoch 6/30. Took 0.1357 seconds. 
  Full-batch training loss = 0.164833, test loss = 0.248596
  Training set accuracy = 0.954000, Test set accuracy = 0.924100
 epoch 7/30. Took 0.14169 seconds. 
  Full-batch training loss = 0.171468, test loss = 0.279871
  Training set accuracy = 0.947000, Test set accuracy = 0.912100
 epoch 8/30. Took 0.13481 seconds. 
  Full-batch training loss = 0.133839, test loss = 0.233270
  Training set accuracy = 0.961600, Test set accuracy = 0.928300
 epoch 9/30. Took 0.13514 seconds. 
  Full-batch training loss = 0.116404, test loss = 0.223380
  Training set accuracy = 0.967200, Test set accuracy = 0.932700
 epoch 10/30. Took 0.13713 seconds. 
  Full-batch training loss = 0.096508, test loss = 0.211781
  Training set accuracy = 0.972200, Test set accuracy = 0.936000
 epoch 11/30. Took 0.14345 seconds. 
  Full-batch training loss = 0.084343, test loss = 0.204281
  Training set accuracy = 0.977400, Test set accuracy = 0.938500
 epoch 12/30. Took 0.13121 seconds. 
  Full-batch training loss = 0.077343, test loss = 0.201293
  Training set accuracy = 0.979200, Test set accuracy = 0.939200
 epoch 13/30. Took 0.12843 seconds. 
  Full-batch training loss = 0.069036, test loss = 0.198991
  Training set accuracy = 0.982000, Test set accuracy = 0.939600
 epoch 14/30. Took 0.13167 seconds. 
  Full-batch training loss = 0.058373, test loss = 0.190940
  Training set accuracy = 0.984600, Test set accuracy = 0.944500
 epoch 15/30. Took 0.13423 seconds. 
  Full-batch training loss = 0.050127, test loss = 0.194731
  Training set accuracy = 0.988000, Test set accuracy = 0.943600
 epoch 16/30. Took 0.13625 seconds. 
  Full-batch training loss = 0.042632, test loss = 0.200817
  Training set accuracy = 0.989400, Test set accuracy = 0.941900
 epoch 17/30. Took 0.13569 seconds. 
  Full-batch training loss = 0.038013, test loss = 0.191999
  Training set accuracy = 0.989600, Test set accuracy = 0.946000
 epoch 18/30. Took 0.13634 seconds. 
  Full-batch training loss = 0.037091, test loss = 0.190268
  Training set accuracy = 0.990200, Test set accuracy = 0.943900
 epoch 19/30. Took 0.1361 seconds. 
  Full-batch training loss = 0.029226, test loss = 0.194392
  Training set accuracy = 0.992600, Test set accuracy = 0.944300
 epoch 20/30. Took 0.13537 seconds. 
  Full-batch training loss = 0.027170, test loss = 0.200911
  Training set accuracy = 0.993400, Test set accuracy = 0.945500
 epoch 21/30. Took 0.13593 seconds. 
  Full-batch training loss = 0.026463, test loss = 0.195928
  Training set accuracy = 0.994000, Test set accuracy = 0.945600
 epoch 22/30. Took 0.13744 seconds. 
  Full-batch training loss = 0.026128, test loss = 0.213935
  Training set accuracy = 0.994400, Test set accuracy = 0.942500
 epoch 23/30. Took 0.13575 seconds. 
  Full-batch training loss = 0.020939, test loss = 0.190389
  Training set accuracy = 0.996600, Test set accuracy = 0.945600
 epoch 24/30. Took 0.13649 seconds. 
  Full-batch training loss = 0.019232, test loss = 0.197746
  Training set accuracy = 0.996400, Test set accuracy = 0.945500
 epoch 25/30. Took 0.13602 seconds. 
  Full-batch training loss = 0.014928, test loss = 0.204524
  Training set accuracy = 0.997000, Test set accuracy = 0.947100
 epoch 26/30. Took 0.14727 seconds. 
  Full-batch training loss = 0.016656, test loss = 0.199291
  Training set accuracy = 0.996400, Test set accuracy = 0.945300
 epoch 27/30. Took 0.13124 seconds. 
  Full-batch training loss = 0.014958, test loss = 0.199627
  Training set accuracy = 0.997400, Test set accuracy = 0.947100
 epoch 28/30. Took 0.13182 seconds. 
  Full-batch training loss = 0.014095, test loss = 0.210147
  Training set accuracy = 0.996600, Test set accuracy = 0.943000
 epoch 29/30. Took 0.13311 seconds. 
  Full-batch training loss = 0.011696, test loss = 0.199813
  Training set accuracy = 0.996800, Test set accuracy = 0.947400
 epoch 30/30. Took 0.13589 seconds. 
  Full-batch training loss = 0.011890, test loss = 0.206385
  Training set accuracy = 0.997400, Test set accuracy = 0.944600
Elapsed time is 9.491391 seconds.
End Training
-----
Params 5000 0.100 0.30 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23176 seconds. 
  Full-batch training loss = 0.499412, test loss = 0.504419
  Training set accuracy = 0.868200, Test set accuracy = 0.864800
 epoch 2/30. Took 0.23293 seconds. 
  Full-batch training loss = 0.322114, test loss = 0.350714
  Training set accuracy = 0.900800, Test set accuracy = 0.896000
 epoch 3/30. Took 0.22653 seconds. 
  Full-batch training loss = 0.268131, test loss = 0.320310
  Training set accuracy = 0.915200, Test set accuracy = 0.902400
 epoch 4/30. Took 0.24379 seconds. 
  Full-batch training loss = 0.210193, test loss = 0.274500
  Training set accuracy = 0.938000, Test set accuracy = 0.917500
 epoch 5/30. Took 0.22602 seconds. 
  Full-batch training loss = 0.162966, test loss = 0.245074
  Training set accuracy = 0.952800, Test set accuracy = 0.925000
 epoch 6/30. Took 0.22795 seconds. 
  Full-batch training loss = 0.129180, test loss = 0.218581
  Training set accuracy = 0.964600, Test set accuracy = 0.931700
 epoch 7/30. Took 0.22822 seconds. 
  Full-batch training loss = 0.114593, test loss = 0.209580
  Training set accuracy = 0.967000, Test set accuracy = 0.935900
 epoch 8/30. Took 0.24556 seconds. 
  Full-batch training loss = 0.101345, test loss = 0.211033
  Training set accuracy = 0.972600, Test set accuracy = 0.936900
 epoch 9/30. Took 0.25133 seconds. 
  Full-batch training loss = 0.073638, test loss = 0.191416
  Training set accuracy = 0.980000, Test set accuracy = 0.942400
 epoch 10/30. Took 0.22555 seconds. 
  Full-batch training loss = 0.069050, test loss = 0.196755
  Training set accuracy = 0.981200, Test set accuracy = 0.939600
 epoch 11/30. Took 0.22637 seconds. 
  Full-batch training loss = 0.053695, test loss = 0.188402
  Training set accuracy = 0.988600, Test set accuracy = 0.941400
 epoch 12/30. Took 0.22328 seconds. 
  Full-batch training loss = 0.048464, test loss = 0.196108
  Training set accuracy = 0.987400, Test set accuracy = 0.941200
 epoch 13/30. Took 0.22139 seconds. 
  Full-batch training loss = 0.043694, test loss = 0.195827
  Training set accuracy = 0.988400, Test set accuracy = 0.942300
 epoch 14/30. Took 0.22779 seconds. 
  Full-batch training loss = 0.030038, test loss = 0.182262
  Training set accuracy = 0.992800, Test set accuracy = 0.947100
 epoch 15/30. Took 0.22784 seconds. 
  Full-batch training loss = 0.028405, test loss = 0.182178
  Training set accuracy = 0.995000, Test set accuracy = 0.946300
 epoch 16/30. Took 0.22798 seconds. 
  Full-batch training loss = 0.030810, test loss = 0.194762
  Training set accuracy = 0.992800, Test set accuracy = 0.944200
 epoch 17/30. Took 0.23114 seconds. 
  Full-batch training loss = 0.026385, test loss = 0.196058
  Training set accuracy = 0.994600, Test set accuracy = 0.944400
 epoch 18/30. Took 0.22838 seconds. 
  Full-batch training loss = 0.023080, test loss = 0.190616
  Training set accuracy = 0.995800, Test set accuracy = 0.946500
 epoch 19/30. Took 0.22737 seconds. 
  Full-batch training loss = 0.015469, test loss = 0.186644
  Training set accuracy = 0.996400, Test set accuracy = 0.949400
 epoch 20/30. Took 0.25445 seconds. 
  Full-batch training loss = 0.014659, test loss = 0.183179
  Training set accuracy = 0.998000, Test set accuracy = 0.949500
 epoch 21/30. Took 0.22855 seconds. 
  Full-batch training loss = 0.012596, test loss = 0.188616
  Training set accuracy = 0.998000, Test set accuracy = 0.949100
 epoch 22/30. Took 0.23488 seconds. 
  Full-batch training loss = 0.017675, test loss = 0.207211
  Training set accuracy = 0.996600, Test set accuracy = 0.943000
 epoch 23/30. Took 0.24292 seconds. 
  Full-batch training loss = 0.011277, test loss = 0.186727
  Training set accuracy = 0.998000, Test set accuracy = 0.950200
 epoch 24/30. Took 0.22674 seconds. 
  Full-batch training loss = 0.011375, test loss = 0.196305
  Training set accuracy = 0.998200, Test set accuracy = 0.948500
 epoch 25/30. Took 0.22824 seconds. 
  Full-batch training loss = 0.007658, test loss = 0.187890
  Training set accuracy = 0.999200, Test set accuracy = 0.950600
 epoch 26/30. Took 0.22758 seconds. 
  Full-batch training loss = 0.007508, test loss = 0.201849
  Training set accuracy = 0.999400, Test set accuracy = 0.948800
 epoch 27/30. Took 0.25142 seconds. 
  Full-batch training loss = 0.006240, test loss = 0.196212
  Training set accuracy = 0.999200, Test set accuracy = 0.949900
 epoch 28/30. Took 0.2204 seconds. 
  Full-batch training loss = 0.004757, test loss = 0.191458
  Training set accuracy = 0.999800, Test set accuracy = 0.952200
 epoch 29/30. Took 0.22375 seconds. 
  Full-batch training loss = 0.004990, test loss = 0.190345
  Training set accuracy = 0.999600, Test set accuracy = 0.950900
 epoch 30/30. Took 0.23193 seconds. 
  Full-batch training loss = 0.003984, test loss = 0.192136
  Training set accuracy = 1.000000, Test set accuracy = 0.951600
Elapsed time is 15.293206 seconds.
End Training
-----
Params 5000 0.100 0.30 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.59535 seconds. 
  Full-batch training loss = 0.468694, test loss = 0.486245
  Training set accuracy = 0.867000, Test set accuracy = 0.859000
 epoch 2/30. Took 0.5886 seconds. 
  Full-batch training loss = 0.324964, test loss = 0.368939
  Training set accuracy = 0.905600, Test set accuracy = 0.891600
 epoch 3/30. Took 0.59992 seconds. 
  Full-batch training loss = 0.218173, test loss = 0.275336
  Training set accuracy = 0.940800, Test set accuracy = 0.918300
 epoch 4/30. Took 0.58848 seconds. 
  Full-batch training loss = 0.187800, test loss = 0.266617
  Training set accuracy = 0.947600, Test set accuracy = 0.920500
 epoch 5/30. Took 0.59206 seconds. 
  Full-batch training loss = 0.145097, test loss = 0.228658
  Training set accuracy = 0.962000, Test set accuracy = 0.929900
 epoch 6/30. Took 0.59239 seconds. 
  Full-batch training loss = 0.116371, test loss = 0.208153
  Training set accuracy = 0.968000, Test set accuracy = 0.937200
 epoch 7/30. Took 0.59477 seconds. 
  Full-batch training loss = 0.088918, test loss = 0.191190
  Training set accuracy = 0.978600, Test set accuracy = 0.942300
 epoch 8/30. Took 0.59125 seconds. 
  Full-batch training loss = 0.081157, test loss = 0.208482
  Training set accuracy = 0.979200, Test set accuracy = 0.937900
 epoch 9/30. Took 0.58691 seconds. 
  Full-batch training loss = 0.065501, test loss = 0.196907
  Training set accuracy = 0.981600, Test set accuracy = 0.940200
 epoch 10/30. Took 0.58767 seconds. 
  Full-batch training loss = 0.053738, test loss = 0.198297
  Training set accuracy = 0.986400, Test set accuracy = 0.943100
 epoch 11/30. Took 0.59282 seconds. 
  Full-batch training loss = 0.041661, test loss = 0.185840
  Training set accuracy = 0.991000, Test set accuracy = 0.943900
 epoch 12/30. Took 0.58826 seconds. 
  Full-batch training loss = 0.032183, test loss = 0.175891
  Training set accuracy = 0.992800, Test set accuracy = 0.947100
 epoch 13/30. Took 0.59074 seconds. 
  Full-batch training loss = 0.027265, test loss = 0.169023
  Training set accuracy = 0.995000, Test set accuracy = 0.949100
 epoch 14/30. Took 0.60169 seconds. 
  Full-batch training loss = 0.018549, test loss = 0.176882
  Training set accuracy = 0.997000, Test set accuracy = 0.950400
 epoch 15/30. Took 0.59197 seconds. 
  Full-batch training loss = 0.017136, test loss = 0.177572
  Training set accuracy = 0.996600, Test set accuracy = 0.950100
 epoch 16/30. Took 0.63527 seconds. 
  Full-batch training loss = 0.013083, test loss = 0.181773
  Training set accuracy = 0.998000, Test set accuracy = 0.949200
 epoch 17/30. Took 0.5927 seconds. 
  Full-batch training loss = 0.010543, test loss = 0.173468
  Training set accuracy = 0.998800, Test set accuracy = 0.952100
 epoch 18/30. Took 0.58718 seconds. 
  Full-batch training loss = 0.008883, test loss = 0.173520
  Training set accuracy = 0.999800, Test set accuracy = 0.952600
 epoch 19/30. Took 0.58627 seconds. 
  Full-batch training loss = 0.007292, test loss = 0.174195
  Training set accuracy = 0.999600, Test set accuracy = 0.951500
 epoch 20/30. Took 0.58849 seconds. 
  Full-batch training loss = 0.006072, test loss = 0.179425
  Training set accuracy = 0.999800, Test set accuracy = 0.951600
 epoch 21/30. Took 0.60573 seconds. 
  Full-batch training loss = 0.005963, test loss = 0.179483
  Training set accuracy = 0.999400, Test set accuracy = 0.951600
 epoch 22/30. Took 0.5909 seconds. 
  Full-batch training loss = 0.004481, test loss = 0.174429
  Training set accuracy = 0.999800, Test set accuracy = 0.952700
 epoch 23/30. Took 0.62022 seconds. 
  Full-batch training loss = 0.004963, test loss = 0.191841
  Training set accuracy = 0.999800, Test set accuracy = 0.952000
 epoch 24/30. Took 0.58603 seconds. 
  Full-batch training loss = 0.004594, test loss = 0.178914
  Training set accuracy = 1.000000, Test set accuracy = 0.952600
 epoch 25/30. Took 0.61338 seconds. 
  Full-batch training loss = 0.003100, test loss = 0.177708
  Training set accuracy = 0.999800, Test set accuracy = 0.955700
 epoch 26/30. Took 0.59032 seconds. 
  Full-batch training loss = 0.003125, test loss = 0.184775
  Training set accuracy = 0.999800, Test set accuracy = 0.953800
 epoch 27/30. Took 0.59446 seconds. 
  Full-batch training loss = 0.002558, test loss = 0.188961
  Training set accuracy = 1.000000, Test set accuracy = 0.953100
 epoch 28/30. Took 0.58733 seconds. 
  Full-batch training loss = 0.002316, test loss = 0.190365
  Training set accuracy = 1.000000, Test set accuracy = 0.953300
 epoch 29/30. Took 0.6001 seconds. 
  Full-batch training loss = 0.001871, test loss = 0.191273
  Training set accuracy = 1.000000, Test set accuracy = 0.951800
 epoch 30/30. Took 0.61585 seconds. 
  Full-batch training loss = 0.001769, test loss = 0.193350
  Training set accuracy = 1.000000, Test set accuracy = 0.952400
Elapsed time is 37.962323 seconds.
End Training
-----
Params 5000 0.100 0.30 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.16889 seconds. 
  Full-batch training loss = 0.905785, test loss = 0.911067
  Training set accuracy = 0.678600, Test set accuracy = 0.679400
 epoch 2/30. Took 0.17302 seconds. 
  Full-batch training loss = 0.479234, test loss = 0.485203
  Training set accuracy = 0.864800, Test set accuracy = 0.866300
 epoch 3/30. Took 0.16026 seconds. 
  Full-batch training loss = 0.384154, test loss = 0.420501
  Training set accuracy = 0.868800, Test set accuracy = 0.865700
 epoch 4/30. Took 0.16008 seconds. 
  Full-batch training loss = 0.281632, test loss = 0.340520
  Training set accuracy = 0.915600, Test set accuracy = 0.894500
 epoch 5/30. Took 0.16373 seconds. 
  Full-batch training loss = 0.235697, test loss = 0.310012
  Training set accuracy = 0.934800, Test set accuracy = 0.909500
 epoch 6/30. Took 0.16202 seconds. 
  Full-batch training loss = 0.214026, test loss = 0.308810
  Training set accuracy = 0.933600, Test set accuracy = 0.909000
 epoch 7/30. Took 0.16158 seconds. 
  Full-batch training loss = 0.193832, test loss = 0.317855
  Training set accuracy = 0.942800, Test set accuracy = 0.912500
 epoch 8/30. Took 0.1719 seconds. 
  Full-batch training loss = 0.133578, test loss = 0.252938
  Training set accuracy = 0.960600, Test set accuracy = 0.924700
 epoch 9/30. Took 0.1627 seconds. 
  Full-batch training loss = 0.134527, test loss = 0.246806
  Training set accuracy = 0.965800, Test set accuracy = 0.923500
 epoch 10/30. Took 0.16314 seconds. 
  Full-batch training loss = 0.126074, test loss = 0.273730
  Training set accuracy = 0.964000, Test set accuracy = 0.922100
 epoch 11/30. Took 0.16299 seconds. 
  Full-batch training loss = 0.090038, test loss = 0.235650
  Training set accuracy = 0.972200, Test set accuracy = 0.931700
 epoch 12/30. Took 0.1622 seconds. 
  Full-batch training loss = 0.083121, test loss = 0.241813
  Training set accuracy = 0.974600, Test set accuracy = 0.930200
 epoch 13/30. Took 0.16393 seconds. 
  Full-batch training loss = 0.066583, test loss = 0.233422
  Training set accuracy = 0.980200, Test set accuracy = 0.935600
 epoch 14/30. Took 0.16244 seconds. 
  Full-batch training loss = 0.066862, test loss = 0.246380
  Training set accuracy = 0.980200, Test set accuracy = 0.932500
 epoch 15/30. Took 0.16303 seconds. 
  Full-batch training loss = 0.060936, test loss = 0.236224
  Training set accuracy = 0.980800, Test set accuracy = 0.933800
 epoch 16/30. Took 0.1618 seconds. 
  Full-batch training loss = 0.068183, test loss = 0.242870
  Training set accuracy = 0.980600, Test set accuracy = 0.932200
 epoch 17/30. Took 0.16237 seconds. 
  Full-batch training loss = 0.049722, test loss = 0.236665
  Training set accuracy = 0.986600, Test set accuracy = 0.936400
 epoch 18/30. Took 0.16523 seconds. 
  Full-batch training loss = 0.041962, test loss = 0.234658
  Training set accuracy = 0.989400, Test set accuracy = 0.939600
 epoch 19/30. Took 0.16938 seconds. 
  Full-batch training loss = 0.043790, test loss = 0.232678
  Training set accuracy = 0.989200, Test set accuracy = 0.936700
 epoch 20/30. Took 0.1612 seconds. 
  Full-batch training loss = 0.035510, test loss = 0.212229
  Training set accuracy = 0.992200, Test set accuracy = 0.942300
 epoch 21/30. Took 0.16218 seconds. 
  Full-batch training loss = 0.033334, test loss = 0.232974
  Training set accuracy = 0.989400, Test set accuracy = 0.938600
 epoch 22/30. Took 0.16235 seconds. 
  Full-batch training loss = 0.031564, test loss = 0.238921
  Training set accuracy = 0.992200, Test set accuracy = 0.941300
 epoch 23/30. Took 0.16279 seconds. 
  Full-batch training loss = 0.024405, test loss = 0.239885
  Training set accuracy = 0.994200, Test set accuracy = 0.940900
 epoch 24/30. Took 0.16189 seconds. 
  Full-batch training loss = 0.027572, test loss = 0.231404
  Training set accuracy = 0.993600, Test set accuracy = 0.939100
 epoch 25/30. Took 0.1619 seconds. 
  Full-batch training loss = 0.021469, test loss = 0.228697
  Training set accuracy = 0.994600, Test set accuracy = 0.943000
 epoch 26/30. Took 0.16181 seconds. 
  Full-batch training loss = 0.021654, test loss = 0.248582
  Training set accuracy = 0.993800, Test set accuracy = 0.939300
 epoch 27/30. Took 0.16279 seconds. 
  Full-batch training loss = 0.030532, test loss = 0.270721
  Training set accuracy = 0.990000, Test set accuracy = 0.935000
 epoch 28/30. Took 0.16227 seconds. 
  Full-batch training loss = 0.016241, test loss = 0.221665
  Training set accuracy = 0.995600, Test set accuracy = 0.945100
 epoch 29/30. Took 0.16175 seconds. 
  Full-batch training loss = 0.015630, test loss = 0.229455
  Training set accuracy = 0.997400, Test set accuracy = 0.943800
 epoch 30/30. Took 0.1627 seconds. 
  Full-batch training loss = 0.019538, test loss = 0.244616
  Training set accuracy = 0.994200, Test set accuracy = 0.941800
Elapsed time is 10.987446 seconds.
End Training
-----
Params 5000 0.100 0.30 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28453 seconds. 
  Full-batch training loss = 0.783702, test loss = 0.807228
  Training set accuracy = 0.724400, Test set accuracy = 0.717300
 epoch 2/30. Took 0.27758 seconds. 
  Full-batch training loss = 0.419743, test loss = 0.450057
  Training set accuracy = 0.882200, Test set accuracy = 0.870900
 epoch 3/30. Took 0.28143 seconds. 
  Full-batch training loss = 0.279164, test loss = 0.331707
  Training set accuracy = 0.916000, Test set accuracy = 0.900800
 epoch 4/30. Took 0.28098 seconds. 
  Full-batch training loss = 0.221364, test loss = 0.286984
  Training set accuracy = 0.936000, Test set accuracy = 0.913000
 epoch 5/30. Took 0.27923 seconds. 
  Full-batch training loss = 0.177265, test loss = 0.267899
  Training set accuracy = 0.948400, Test set accuracy = 0.920000
 epoch 6/30. Took 0.28647 seconds. 
  Full-batch training loss = 0.136556, test loss = 0.245790
  Training set accuracy = 0.962000, Test set accuracy = 0.925500
 epoch 7/30. Took 0.28106 seconds. 
  Full-batch training loss = 0.118689, test loss = 0.229147
  Training set accuracy = 0.967200, Test set accuracy = 0.928900
 epoch 8/30. Took 0.27495 seconds. 
  Full-batch training loss = 0.099988, test loss = 0.235357
  Training set accuracy = 0.969000, Test set accuracy = 0.928100
 epoch 9/30. Took 0.27751 seconds. 
  Full-batch training loss = 0.085074, test loss = 0.225934
  Training set accuracy = 0.976200, Test set accuracy = 0.932900
 epoch 10/30. Took 0.26799 seconds. 
  Full-batch training loss = 0.078844, test loss = 0.226385
  Training set accuracy = 0.976200, Test set accuracy = 0.933700
 epoch 11/30. Took 0.27713 seconds. 
  Full-batch training loss = 0.048523, test loss = 0.203160
  Training set accuracy = 0.987800, Test set accuracy = 0.938500
 epoch 12/30. Took 0.28214 seconds. 
  Full-batch training loss = 0.050808, test loss = 0.220972
  Training set accuracy = 0.987000, Test set accuracy = 0.936600
 epoch 13/30. Took 0.28114 seconds. 
  Full-batch training loss = 0.048599, test loss = 0.233451
  Training set accuracy = 0.985800, Test set accuracy = 0.933300
 epoch 14/30. Took 0.27942 seconds. 
  Full-batch training loss = 0.031407, test loss = 0.209020
  Training set accuracy = 0.991800, Test set accuracy = 0.942300
 epoch 15/30. Took 0.26888 seconds. 
  Full-batch training loss = 0.027357, test loss = 0.204864
  Training set accuracy = 0.993600, Test set accuracy = 0.944100
 epoch 16/30. Took 0.282 seconds. 
  Full-batch training loss = 0.021807, test loss = 0.204897
  Training set accuracy = 0.994600, Test set accuracy = 0.944900
 epoch 17/30. Took 0.27921 seconds. 
  Full-batch training loss = 0.022763, test loss = 0.225809
  Training set accuracy = 0.993200, Test set accuracy = 0.942900
 epoch 18/30. Took 0.27401 seconds. 
  Full-batch training loss = 0.015669, test loss = 0.206207
  Training set accuracy = 0.997200, Test set accuracy = 0.946400
 epoch 19/30. Took 0.27004 seconds. 
  Full-batch training loss = 0.014951, test loss = 0.213103
  Training set accuracy = 0.996600, Test set accuracy = 0.943900
 epoch 20/30. Took 0.26845 seconds. 
  Full-batch training loss = 0.018159, test loss = 0.228665
  Training set accuracy = 0.995800, Test set accuracy = 0.944400
 epoch 21/30. Took 0.27581 seconds. 
  Full-batch training loss = 0.012507, test loss = 0.220696
  Training set accuracy = 0.997600, Test set accuracy = 0.946500
 epoch 22/30. Took 0.2787 seconds. 
  Full-batch training loss = 0.009373, test loss = 0.217921
  Training set accuracy = 0.998000, Test set accuracy = 0.944000
 epoch 23/30. Took 0.28214 seconds. 
  Full-batch training loss = 0.006814, test loss = 0.211117
  Training set accuracy = 0.998800, Test set accuracy = 0.950600
 epoch 24/30. Took 0.28478 seconds. 
  Full-batch training loss = 0.008946, test loss = 0.218397
  Training set accuracy = 0.997800, Test set accuracy = 0.949100
 epoch 25/30. Took 0.28801 seconds. 
  Full-batch training loss = 0.005325, test loss = 0.220385
  Training set accuracy = 0.999200, Test set accuracy = 0.949000
 epoch 26/30. Took 0.2819 seconds. 
  Full-batch training loss = 0.007818, test loss = 0.221147
  Training set accuracy = 0.998800, Test set accuracy = 0.949900
 epoch 27/30. Took 0.2806 seconds. 
  Full-batch training loss = 0.005351, test loss = 0.224177
  Training set accuracy = 0.998600, Test set accuracy = 0.948800
 epoch 28/30. Took 0.28008 seconds. 
  Full-batch training loss = 0.004144, test loss = 0.216404
  Training set accuracy = 0.999200, Test set accuracy = 0.949900
 epoch 29/30. Took 0.28074 seconds. 
  Full-batch training loss = 0.003457, test loss = 0.211753
  Training set accuracy = 0.999600, Test set accuracy = 0.950700
 epoch 30/30. Took 0.28012 seconds. 
  Full-batch training loss = 0.002154, test loss = 0.216760
  Training set accuracy = 1.000000, Test set accuracy = 0.952400
Elapsed time is 18.368094 seconds.
End Training
-----
Params 5000 0.100 0.30 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.8578 seconds. 
  Full-batch training loss = 0.644032, test loss = 0.642341
  Training set accuracy = 0.785600, Test set accuracy = 0.793500
 epoch 2/30. Took 0.81882 seconds. 
  Full-batch training loss = 0.348919, test loss = 0.364076
  Training set accuracy = 0.901200, Test set accuracy = 0.894700
 epoch 3/30. Took 0.82015 seconds. 
  Full-batch training loss = 0.272507, test loss = 0.325577
  Training set accuracy = 0.915200, Test set accuracy = 0.903500
 epoch 4/30. Took 0.83276 seconds. 
  Full-batch training loss = 0.185068, test loss = 0.251501
  Training set accuracy = 0.945200, Test set accuracy = 0.925500
 epoch 5/30. Took 0.84724 seconds. 
  Full-batch training loss = 0.138554, test loss = 0.223552
  Training set accuracy = 0.958000, Test set accuracy = 0.931100
 epoch 6/30. Took 0.82552 seconds. 
  Full-batch training loss = 0.103875, test loss = 0.214698
  Training set accuracy = 0.968400, Test set accuracy = 0.937500
 epoch 7/30. Took 0.88973 seconds. 
  Full-batch training loss = 0.091601, test loss = 0.208167
  Training set accuracy = 0.973800, Test set accuracy = 0.939200
 epoch 8/30. Took 0.82153 seconds. 
  Full-batch training loss = 0.073323, test loss = 0.204001
  Training set accuracy = 0.976200, Test set accuracy = 0.938800
 epoch 9/30. Took 0.81802 seconds. 
  Full-batch training loss = 0.054939, test loss = 0.200833
  Training set accuracy = 0.982800, Test set accuracy = 0.943900
 epoch 10/30. Took 0.94255 seconds. 
  Full-batch training loss = 0.051017, test loss = 0.204538
  Training set accuracy = 0.984800, Test set accuracy = 0.938500
 epoch 11/30. Took 0.82031 seconds. 
  Full-batch training loss = 0.042010, test loss = 0.201671
  Training set accuracy = 0.990000, Test set accuracy = 0.944100
 epoch 12/30. Took 0.82276 seconds. 
  Full-batch training loss = 0.029108, test loss = 0.192280
  Training set accuracy = 0.993000, Test set accuracy = 0.945900
 epoch 13/30. Took 0.82695 seconds. 
  Full-batch training loss = 0.018594, test loss = 0.191407
  Training set accuracy = 0.996200, Test set accuracy = 0.950400
 epoch 14/30. Took 0.82317 seconds. 
  Full-batch training loss = 0.024960, test loss = 0.189462
  Training set accuracy = 0.992600, Test set accuracy = 0.946400
 epoch 15/30. Took 0.82193 seconds. 
  Full-batch training loss = 0.014467, test loss = 0.199972
  Training set accuracy = 0.997200, Test set accuracy = 0.951500
 epoch 16/30. Took 0.82973 seconds. 
  Full-batch training loss = 0.014399, test loss = 0.198895
  Training set accuracy = 0.996800, Test set accuracy = 0.950300
 epoch 17/30. Took 0.8734 seconds. 
  Full-batch training loss = 0.011191, test loss = 0.207931
  Training set accuracy = 0.998000, Test set accuracy = 0.947500
 epoch 18/30. Took 0.82016 seconds. 
  Full-batch training loss = 0.009288, test loss = 0.206707
  Training set accuracy = 0.998200, Test set accuracy = 0.950300
 epoch 19/30. Took 0.89184 seconds. 
  Full-batch training loss = 0.007375, test loss = 0.206949
  Training set accuracy = 0.998400, Test set accuracy = 0.951000
 epoch 20/30. Took 0.82467 seconds. 
  Full-batch training loss = 0.007718, test loss = 0.209338
  Training set accuracy = 0.998000, Test set accuracy = 0.950900
 epoch 21/30. Took 0.82294 seconds. 
  Full-batch training loss = 0.024244, test loss = 0.243400
  Training set accuracy = 0.990600, Test set accuracy = 0.943200
 epoch 22/30. Took 0.82788 seconds. 
  Full-batch training loss = 0.006809, test loss = 0.209990
  Training set accuracy = 0.997800, Test set accuracy = 0.952100
 epoch 23/30. Took 0.88523 seconds. 
  Full-batch training loss = 0.002732, test loss = 0.205945
  Training set accuracy = 0.999800, Test set accuracy = 0.954300
 epoch 24/30. Took 0.87077 seconds. 
  Full-batch training loss = 0.003768, test loss = 0.210824
  Training set accuracy = 0.999200, Test set accuracy = 0.952200
 epoch 25/30. Took 0.82326 seconds. 
  Full-batch training loss = 0.005149, test loss = 0.211673
  Training set accuracy = 0.998600, Test set accuracy = 0.949200
 epoch 26/30. Took 0.83672 seconds. 
  Full-batch training loss = 0.002164, test loss = 0.206764
  Training set accuracy = 0.999600, Test set accuracy = 0.954500
 epoch 27/30. Took 0.82353 seconds. 
  Full-batch training loss = 0.002140, test loss = 0.209911
  Training set accuracy = 0.999800, Test set accuracy = 0.955100
 epoch 28/30. Took 0.82525 seconds. 
  Full-batch training loss = 0.001631, test loss = 0.222697
  Training set accuracy = 0.999800, Test set accuracy = 0.953700
 epoch 29/30. Took 0.85216 seconds. 
  Full-batch training loss = 0.002357, test loss = 0.239614
  Training set accuracy = 0.999800, Test set accuracy = 0.953200
 epoch 30/30. Took 0.83958 seconds. 
  Full-batch training loss = 0.001638, test loss = 0.220663
  Training set accuracy = 0.999800, Test set accuracy = 0.953700
Elapsed time is 52.604655 seconds.
End Training
-----
Params 5000 0.100 0.40 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11688 seconds. 
  Full-batch training loss = 0.491230, test loss = 0.498304
  Training set accuracy = 0.869600, Test set accuracy = 0.864000
 epoch 2/30. Took 0.11811 seconds. 
  Full-batch training loss = 0.352047, test loss = 0.372515
  Training set accuracy = 0.905800, Test set accuracy = 0.896700
 epoch 3/30. Took 0.11689 seconds. 
  Full-batch training loss = 0.306123, test loss = 0.335584
  Training set accuracy = 0.913400, Test set accuracy = 0.903400
 epoch 4/30. Took 0.10705 seconds. 
  Full-batch training loss = 0.252047, test loss = 0.297903
  Training set accuracy = 0.930600, Test set accuracy = 0.914200
 epoch 5/30. Took 0.10395 seconds. 
  Full-batch training loss = 0.232768, test loss = 0.287223
  Training set accuracy = 0.936600, Test set accuracy = 0.918800
 epoch 6/30. Took 0.10547 seconds. 
  Full-batch training loss = 0.206213, test loss = 0.265573
  Training set accuracy = 0.946200, Test set accuracy = 0.923400
 epoch 7/30. Took 0.10997 seconds. 
  Full-batch training loss = 0.186153, test loss = 0.255534
  Training set accuracy = 0.948000, Test set accuracy = 0.923300
 epoch 8/30. Took 0.10855 seconds. 
  Full-batch training loss = 0.170027, test loss = 0.244891
  Training set accuracy = 0.954400, Test set accuracy = 0.923600
 epoch 9/30. Took 0.10866 seconds. 
  Full-batch training loss = 0.157193, test loss = 0.242925
  Training set accuracy = 0.958200, Test set accuracy = 0.928400
 epoch 10/30. Took 0.10873 seconds. 
  Full-batch training loss = 0.138210, test loss = 0.226256
  Training set accuracy = 0.961200, Test set accuracy = 0.928900
 epoch 11/30. Took 0.10846 seconds. 
  Full-batch training loss = 0.130376, test loss = 0.225221
  Training set accuracy = 0.964600, Test set accuracy = 0.930900
 epoch 12/30. Took 0.10773 seconds. 
  Full-batch training loss = 0.123935, test loss = 0.220115
  Training set accuracy = 0.967200, Test set accuracy = 0.933900
 epoch 13/30. Took 0.10883 seconds. 
  Full-batch training loss = 0.106671, test loss = 0.208773
  Training set accuracy = 0.972600, Test set accuracy = 0.937100
 epoch 14/30. Took 0.10699 seconds. 
  Full-batch training loss = 0.101340, test loss = 0.206707
  Training set accuracy = 0.973000, Test set accuracy = 0.938100
 epoch 15/30. Took 0.10526 seconds. 
  Full-batch training loss = 0.092983, test loss = 0.200021
  Training set accuracy = 0.977400, Test set accuracy = 0.936700
 epoch 16/30. Took 0.11634 seconds. 
  Full-batch training loss = 0.084441, test loss = 0.197512
  Training set accuracy = 0.980600, Test set accuracy = 0.939500
 epoch 17/30. Took 0.11999 seconds. 
  Full-batch training loss = 0.078366, test loss = 0.198115
  Training set accuracy = 0.981600, Test set accuracy = 0.939900
 epoch 18/30. Took 0.10747 seconds. 
  Full-batch training loss = 0.072489, test loss = 0.194242
  Training set accuracy = 0.983000, Test set accuracy = 0.942600
 epoch 19/30. Took 0.10684 seconds. 
  Full-batch training loss = 0.066365, test loss = 0.193616
  Training set accuracy = 0.983800, Test set accuracy = 0.941900
 epoch 20/30. Took 0.11902 seconds. 
  Full-batch training loss = 0.068807, test loss = 0.203868
  Training set accuracy = 0.981600, Test set accuracy = 0.938200
 epoch 21/30. Took 0.10923 seconds. 
  Full-batch training loss = 0.060611, test loss = 0.195041
  Training set accuracy = 0.986200, Test set accuracy = 0.939400
 epoch 22/30. Took 0.10911 seconds. 
  Full-batch training loss = 0.053411, test loss = 0.190651
  Training set accuracy = 0.989200, Test set accuracy = 0.941600
 epoch 23/30. Took 0.10828 seconds. 
  Full-batch training loss = 0.053182, test loss = 0.195282
  Training set accuracy = 0.988600, Test set accuracy = 0.943100
 epoch 24/30. Took 0.1091 seconds. 
  Full-batch training loss = 0.048936, test loss = 0.194419
  Training set accuracy = 0.990000, Test set accuracy = 0.942500
 epoch 25/30. Took 0.10847 seconds. 
  Full-batch training loss = 0.047451, test loss = 0.187850
  Training set accuracy = 0.991200, Test set accuracy = 0.943800
 epoch 26/30. Took 0.10919 seconds. 
  Full-batch training loss = 0.040180, test loss = 0.186154
  Training set accuracy = 0.992800, Test set accuracy = 0.943500
 epoch 27/30. Took 0.10717 seconds. 
  Full-batch training loss = 0.039813, test loss = 0.191791
  Training set accuracy = 0.993000, Test set accuracy = 0.942300
 epoch 28/30. Took 0.10453 seconds. 
  Full-batch training loss = 0.037585, test loss = 0.183983
  Training set accuracy = 0.993400, Test set accuracy = 0.945600
 epoch 29/30. Took 0.10469 seconds. 
  Full-batch training loss = 0.036432, test loss = 0.191159
  Training set accuracy = 0.993400, Test set accuracy = 0.943000
 epoch 30/30. Took 0.10789 seconds. 
  Full-batch training loss = 0.031386, test loss = 0.185906
  Training set accuracy = 0.995000, Test set accuracy = 0.946100
Elapsed time is 8.093525 seconds.
End Training
-----
Params 5000 0.100 0.40 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.19256 seconds. 
  Full-batch training loss = 0.492262, test loss = 0.489441
  Training set accuracy = 0.869200, Test set accuracy = 0.867500
 epoch 2/30. Took 0.16401 seconds. 
  Full-batch training loss = 0.362534, test loss = 0.389478
  Training set accuracy = 0.898400, Test set accuracy = 0.888100
 epoch 3/30. Took 0.1711 seconds. 
  Full-batch training loss = 0.299513, test loss = 0.336365
  Training set accuracy = 0.918200, Test set accuracy = 0.903900
 epoch 4/30. Took 0.16454 seconds. 
  Full-batch training loss = 0.255896, test loss = 0.302360
  Training set accuracy = 0.930200, Test set accuracy = 0.911400
 epoch 5/30. Took 0.16453 seconds. 
  Full-batch training loss = 0.221507, test loss = 0.282950
  Training set accuracy = 0.941200, Test set accuracy = 0.918700
 epoch 6/30. Took 0.16452 seconds. 
  Full-batch training loss = 0.193302, test loss = 0.263361
  Training set accuracy = 0.947000, Test set accuracy = 0.922200
 epoch 7/30. Took 0.16403 seconds. 
  Full-batch training loss = 0.172057, test loss = 0.251906
  Training set accuracy = 0.954600, Test set accuracy = 0.927100
 epoch 8/30. Took 0.18523 seconds. 
  Full-batch training loss = 0.158607, test loss = 0.254356
  Training set accuracy = 0.957600, Test set accuracy = 0.924600
 epoch 9/30. Took 0.16684 seconds. 
  Full-batch training loss = 0.136936, test loss = 0.232986
  Training set accuracy = 0.963200, Test set accuracy = 0.930600
 epoch 10/30. Took 0.16617 seconds. 
  Full-batch training loss = 0.121416, test loss = 0.224033
  Training set accuracy = 0.968400, Test set accuracy = 0.934700
 epoch 11/30. Took 0.17746 seconds. 
  Full-batch training loss = 0.118674, test loss = 0.223678
  Training set accuracy = 0.968800, Test set accuracy = 0.933300
 epoch 12/30. Took 0.1675 seconds. 
  Full-batch training loss = 0.100459, test loss = 0.215431
  Training set accuracy = 0.974800, Test set accuracy = 0.936000
 epoch 13/30. Took 0.16697 seconds. 
  Full-batch training loss = 0.089039, test loss = 0.208014
  Training set accuracy = 0.978800, Test set accuracy = 0.937900
 epoch 14/30. Took 0.16501 seconds. 
  Full-batch training loss = 0.082557, test loss = 0.203105
  Training set accuracy = 0.980000, Test set accuracy = 0.940600
 epoch 15/30. Took 0.17655 seconds. 
  Full-batch training loss = 0.074277, test loss = 0.203481
  Training set accuracy = 0.981400, Test set accuracy = 0.940000
 epoch 16/30. Took 0.16562 seconds. 
  Full-batch training loss = 0.067980, test loss = 0.201265
  Training set accuracy = 0.984600, Test set accuracy = 0.940900
 epoch 17/30. Took 0.16348 seconds. 
  Full-batch training loss = 0.063211, test loss = 0.200477
  Training set accuracy = 0.985000, Test set accuracy = 0.942300
 epoch 18/30. Took 0.16905 seconds. 
  Full-batch training loss = 0.054343, test loss = 0.195788
  Training set accuracy = 0.988200, Test set accuracy = 0.942200
 epoch 19/30. Took 0.16727 seconds. 
  Full-batch training loss = 0.050698, test loss = 0.187963
  Training set accuracy = 0.991000, Test set accuracy = 0.944900
 epoch 20/30. Took 0.16886 seconds. 
  Full-batch training loss = 0.050601, test loss = 0.194888
  Training set accuracy = 0.990200, Test set accuracy = 0.944600
 epoch 21/30. Took 0.16828 seconds. 
  Full-batch training loss = 0.043606, test loss = 0.189609
  Training set accuracy = 0.991800, Test set accuracy = 0.944800
 epoch 22/30. Took 0.16818 seconds. 
  Full-batch training loss = 0.039816, test loss = 0.191641
  Training set accuracy = 0.993800, Test set accuracy = 0.944000
 epoch 23/30. Took 0.1675 seconds. 
  Full-batch training loss = 0.036812, test loss = 0.185576
  Training set accuracy = 0.994000, Test set accuracy = 0.945100
 epoch 24/30. Took 0.16638 seconds. 
  Full-batch training loss = 0.032553, test loss = 0.188624
  Training set accuracy = 0.996000, Test set accuracy = 0.945200
 epoch 25/30. Took 0.1678 seconds. 
  Full-batch training loss = 0.031968, test loss = 0.194490
  Training set accuracy = 0.995200, Test set accuracy = 0.943100
 epoch 26/30. Took 0.16442 seconds. 
  Full-batch training loss = 0.028036, test loss = 0.185933
  Training set accuracy = 0.995600, Test set accuracy = 0.946400
 epoch 27/30. Took 0.16735 seconds. 
  Full-batch training loss = 0.027253, test loss = 0.189761
  Training set accuracy = 0.997000, Test set accuracy = 0.946100
 epoch 28/30. Took 0.16939 seconds. 
  Full-batch training loss = 0.024039, test loss = 0.189970
  Training set accuracy = 0.998400, Test set accuracy = 0.945900
 epoch 29/30. Took 0.16603 seconds. 
  Full-batch training loss = 0.024303, test loss = 0.187365
  Training set accuracy = 0.998600, Test set accuracy = 0.944700
 epoch 30/30. Took 0.16603 seconds. 
  Full-batch training loss = 0.020323, test loss = 0.185910
  Training set accuracy = 0.998600, Test set accuracy = 0.946400
Elapsed time is 11.621995 seconds.
End Training
-----
Params 5000 0.100 0.40 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.39412 seconds. 
  Full-batch training loss = 0.433943, test loss = 0.450806
  Training set accuracy = 0.885000, Test set accuracy = 0.880000
 epoch 2/30. Took 0.36235 seconds. 
  Full-batch training loss = 0.323460, test loss = 0.368158
  Training set accuracy = 0.907600, Test set accuracy = 0.894700
 epoch 3/30. Took 0.35585 seconds. 
  Full-batch training loss = 0.274718, test loss = 0.326987
  Training set accuracy = 0.923200, Test set accuracy = 0.907300
 epoch 4/30. Took 0.39054 seconds. 
  Full-batch training loss = 0.229455, test loss = 0.299255
  Training set accuracy = 0.938400, Test set accuracy = 0.914500
 epoch 5/30. Took 0.37315 seconds. 
  Full-batch training loss = 0.199699, test loss = 0.272635
  Training set accuracy = 0.946600, Test set accuracy = 0.921800
 epoch 6/30. Took 0.35386 seconds. 
  Full-batch training loss = 0.174685, test loss = 0.258858
  Training set accuracy = 0.950800, Test set accuracy = 0.926500
 epoch 7/30. Took 0.35248 seconds. 
  Full-batch training loss = 0.155192, test loss = 0.252523
  Training set accuracy = 0.959400, Test set accuracy = 0.927100
 epoch 8/30. Took 0.356 seconds. 
  Full-batch training loss = 0.139145, test loss = 0.241746
  Training set accuracy = 0.964800, Test set accuracy = 0.929900
 epoch 9/30. Took 0.35617 seconds. 
  Full-batch training loss = 0.126990, test loss = 0.230157
  Training set accuracy = 0.968800, Test set accuracy = 0.932100
 epoch 10/30. Took 0.35253 seconds. 
  Full-batch training loss = 0.109004, test loss = 0.218916
  Training set accuracy = 0.973200, Test set accuracy = 0.935800
 epoch 11/30. Took 0.35804 seconds. 
  Full-batch training loss = 0.098837, test loss = 0.217764
  Training set accuracy = 0.976800, Test set accuracy = 0.935900
 epoch 12/30. Took 0.36162 seconds. 
  Full-batch training loss = 0.087659, test loss = 0.207619
  Training set accuracy = 0.979600, Test set accuracy = 0.938000
 epoch 13/30. Took 0.35627 seconds. 
  Full-batch training loss = 0.078933, test loss = 0.205923
  Training set accuracy = 0.982200, Test set accuracy = 0.938600
 epoch 14/30. Took 0.35181 seconds. 
  Full-batch training loss = 0.071697, test loss = 0.202916
  Training set accuracy = 0.985200, Test set accuracy = 0.940800
 epoch 15/30. Took 0.36813 seconds. 
  Full-batch training loss = 0.061479, test loss = 0.200241
  Training set accuracy = 0.988200, Test set accuracy = 0.941400
 epoch 16/30. Took 0.35778 seconds. 
  Full-batch training loss = 0.056568, test loss = 0.196816
  Training set accuracy = 0.990600, Test set accuracy = 0.942200
 epoch 17/30. Took 0.35686 seconds. 
  Full-batch training loss = 0.050720, test loss = 0.191995
  Training set accuracy = 0.992000, Test set accuracy = 0.943600
 epoch 18/30. Took 0.3683 seconds. 
  Full-batch training loss = 0.045270, test loss = 0.189356
  Training set accuracy = 0.992800, Test set accuracy = 0.945100
 epoch 19/30. Took 0.3567 seconds. 
  Full-batch training loss = 0.041385, test loss = 0.189636
  Training set accuracy = 0.992800, Test set accuracy = 0.944500
 epoch 20/30. Took 0.36374 seconds. 
  Full-batch training loss = 0.037048, test loss = 0.187697
  Training set accuracy = 0.994600, Test set accuracy = 0.945100
 epoch 21/30. Took 0.36272 seconds. 
  Full-batch training loss = 0.034125, test loss = 0.188007
  Training set accuracy = 0.996600, Test set accuracy = 0.945900
 epoch 22/30. Took 0.36195 seconds. 
  Full-batch training loss = 0.030463, test loss = 0.185709
  Training set accuracy = 0.997200, Test set accuracy = 0.945600
 epoch 23/30. Took 0.35756 seconds. 
  Full-batch training loss = 0.027217, test loss = 0.184380
  Training set accuracy = 0.997600, Test set accuracy = 0.946000
 epoch 24/30. Took 0.35588 seconds. 
  Full-batch training loss = 0.024826, test loss = 0.182805
  Training set accuracy = 0.997200, Test set accuracy = 0.946300
 epoch 25/30. Took 0.35874 seconds. 
  Full-batch training loss = 0.023329, test loss = 0.182231
  Training set accuracy = 0.998000, Test set accuracy = 0.948100
 epoch 26/30. Took 0.376 seconds. 
  Full-batch training loss = 0.021547, test loss = 0.185064
  Training set accuracy = 0.998400, Test set accuracy = 0.947300
 epoch 27/30. Took 0.35949 seconds. 
  Full-batch training loss = 0.020462, test loss = 0.184846
  Training set accuracy = 0.998600, Test set accuracy = 0.946300
 epoch 28/30. Took 0.35658 seconds. 
  Full-batch training loss = 0.018941, test loss = 0.179792
  Training set accuracy = 0.998600, Test set accuracy = 0.948900
 epoch 29/30. Took 0.35504 seconds. 
  Full-batch training loss = 0.017812, test loss = 0.186595
  Training set accuracy = 0.999000, Test set accuracy = 0.947200
 epoch 30/30. Took 0.34958 seconds. 
  Full-batch training loss = 0.015318, test loss = 0.182821
  Training set accuracy = 0.999000, Test set accuracy = 0.947600
Elapsed time is 23.553275 seconds.
End Training
-----
Params 5000 0.100 0.40 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14329 seconds. 
  Full-batch training loss = 0.731897, test loss = 0.723994
  Training set accuracy = 0.786000, Test set accuracy = 0.787500
 epoch 2/30. Took 0.13546 seconds. 
  Full-batch training loss = 0.437976, test loss = 0.454029
  Training set accuracy = 0.874800, Test set accuracy = 0.871500
 epoch 3/30. Took 0.13208 seconds. 
  Full-batch training loss = 0.348236, test loss = 0.378291
  Training set accuracy = 0.896600, Test set accuracy = 0.889600
 epoch 4/30. Took 0.13181 seconds. 
  Full-batch training loss = 0.282825, test loss = 0.324984
  Training set accuracy = 0.917600, Test set accuracy = 0.905800
 epoch 5/30. Took 0.13659 seconds. 
  Full-batch training loss = 0.271801, test loss = 0.338564
  Training set accuracy = 0.919000, Test set accuracy = 0.895800
 epoch 6/30. Took 0.13147 seconds. 
  Full-batch training loss = 0.210003, test loss = 0.280354
  Training set accuracy = 0.938600, Test set accuracy = 0.917500
 epoch 7/30. Took 0.13293 seconds. 
  Full-batch training loss = 0.200789, test loss = 0.277101
  Training set accuracy = 0.942400, Test set accuracy = 0.919600
 epoch 8/30. Took 0.13592 seconds. 
  Full-batch training loss = 0.160655, test loss = 0.252700
  Training set accuracy = 0.953800, Test set accuracy = 0.925300
 epoch 9/30. Took 0.13617 seconds. 
  Full-batch training loss = 0.146844, test loss = 0.240839
  Training set accuracy = 0.958600, Test set accuracy = 0.930500
 epoch 10/30. Took 0.14386 seconds. 
  Full-batch training loss = 0.127051, test loss = 0.227494
  Training set accuracy = 0.962600, Test set accuracy = 0.934300
 epoch 11/30. Took 0.1348 seconds. 
  Full-batch training loss = 0.120824, test loss = 0.228338
  Training set accuracy = 0.969000, Test set accuracy = 0.934100
 epoch 12/30. Took 0.13576 seconds. 
  Full-batch training loss = 0.107227, test loss = 0.219425
  Training set accuracy = 0.971200, Test set accuracy = 0.935800
 epoch 13/30. Took 0.13555 seconds. 
  Full-batch training loss = 0.095361, test loss = 0.205916
  Training set accuracy = 0.970800, Test set accuracy = 0.939300
 epoch 14/30. Took 0.1358 seconds. 
  Full-batch training loss = 0.095686, test loss = 0.221744
  Training set accuracy = 0.973200, Test set accuracy = 0.936900
 epoch 15/30. Took 0.13739 seconds. 
  Full-batch training loss = 0.084911, test loss = 0.221643
  Training set accuracy = 0.976800, Test set accuracy = 0.934800
 epoch 16/30. Took 0.13635 seconds. 
  Full-batch training loss = 0.074240, test loss = 0.207259
  Training set accuracy = 0.981200, Test set accuracy = 0.939500
 epoch 17/30. Took 0.1355 seconds. 
  Full-batch training loss = 0.067488, test loss = 0.202321
  Training set accuracy = 0.984000, Test set accuracy = 0.940400
 epoch 18/30. Took 0.14793 seconds. 
  Full-batch training loss = 0.061678, test loss = 0.207439
  Training set accuracy = 0.985400, Test set accuracy = 0.942000
 epoch 19/30. Took 0.14655 seconds. 
  Full-batch training loss = 0.060262, test loss = 0.216254
  Training set accuracy = 0.983600, Test set accuracy = 0.940500
 epoch 20/30. Took 0.13425 seconds. 
  Full-batch training loss = 0.054667, test loss = 0.211297
  Training set accuracy = 0.986000, Test set accuracy = 0.940800
 epoch 21/30. Took 0.13495 seconds. 
  Full-batch training loss = 0.057595, test loss = 0.212483
  Training set accuracy = 0.986400, Test set accuracy = 0.943000
 epoch 22/30. Took 0.12993 seconds. 
  Full-batch training loss = 0.045885, test loss = 0.198664
  Training set accuracy = 0.988000, Test set accuracy = 0.944600
 epoch 23/30. Took 0.12717 seconds. 
  Full-batch training loss = 0.044120, test loss = 0.209307
  Training set accuracy = 0.987400, Test set accuracy = 0.943000
 epoch 24/30. Took 0.12922 seconds. 
  Full-batch training loss = 0.039341, test loss = 0.207384
  Training set accuracy = 0.991000, Test set accuracy = 0.943400
 epoch 25/30. Took 0.13533 seconds. 
  Full-batch training loss = 0.034019, test loss = 0.194911
  Training set accuracy = 0.991600, Test set accuracy = 0.947000
 epoch 26/30. Took 0.13067 seconds. 
  Full-batch training loss = 0.030604, test loss = 0.195840
  Training set accuracy = 0.993800, Test set accuracy = 0.946300
 epoch 27/30. Took 0.13493 seconds. 
  Full-batch training loss = 0.032483, test loss = 0.210980
  Training set accuracy = 0.990600, Test set accuracy = 0.944400
 epoch 28/30. Took 0.13729 seconds. 
  Full-batch training loss = 0.031860, test loss = 0.203517
  Training set accuracy = 0.991200, Test set accuracy = 0.943400
 epoch 29/30. Took 0.1331 seconds. 
  Full-batch training loss = 0.027126, test loss = 0.210507
  Training set accuracy = 0.992400, Test set accuracy = 0.946000
 epoch 30/30. Took 0.13594 seconds. 
  Full-batch training loss = 0.032055, test loss = 0.213717
  Training set accuracy = 0.990000, Test set accuracy = 0.941700
Elapsed time is 9.503267 seconds.
End Training
-----
Params 5000 0.100 0.40 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.24192 seconds. 
  Full-batch training loss = 0.687041, test loss = 0.661307
  Training set accuracy = 0.819000, Test set accuracy = 0.827600
 epoch 2/30. Took 0.22322 seconds. 
  Full-batch training loss = 0.430364, test loss = 0.415993
  Training set accuracy = 0.873800, Test set accuracy = 0.879600
 epoch 3/30. Took 0.22488 seconds. 
  Full-batch training loss = 0.334462, test loss = 0.335449
  Training set accuracy = 0.903800, Test set accuracy = 0.901100
 epoch 4/30. Took 0.22733 seconds. 
  Full-batch training loss = 0.283863, test loss = 0.309525
  Training set accuracy = 0.920600, Test set accuracy = 0.909700
 epoch 5/30. Took 0.23227 seconds. 
  Full-batch training loss = 0.224913, test loss = 0.271113
  Training set accuracy = 0.935600, Test set accuracy = 0.917600
 epoch 6/30. Took 0.22814 seconds. 
  Full-batch training loss = 0.200632, test loss = 0.252981
  Training set accuracy = 0.943000, Test set accuracy = 0.922700
 epoch 7/30. Took 0.2281 seconds. 
  Full-batch training loss = 0.163402, test loss = 0.229512
  Training set accuracy = 0.954000, Test set accuracy = 0.928600
 epoch 8/30. Took 0.22706 seconds. 
  Full-batch training loss = 0.154101, test loss = 0.233018
  Training set accuracy = 0.954600, Test set accuracy = 0.929500
 epoch 9/30. Took 0.22772 seconds. 
  Full-batch training loss = 0.122995, test loss = 0.208799
  Training set accuracy = 0.964400, Test set accuracy = 0.936800
 epoch 10/30. Took 0.22844 seconds. 
  Full-batch training loss = 0.102958, test loss = 0.193172
  Training set accuracy = 0.974200, Test set accuracy = 0.939000
 epoch 11/30. Took 0.22752 seconds. 
  Full-batch training loss = 0.090401, test loss = 0.190401
  Training set accuracy = 0.974200, Test set accuracy = 0.941300
 epoch 12/30. Took 0.22843 seconds. 
  Full-batch training loss = 0.076810, test loss = 0.186555
  Training set accuracy = 0.978200, Test set accuracy = 0.941600
 epoch 13/30. Took 0.23774 seconds. 
  Full-batch training loss = 0.068295, test loss = 0.184487
  Training set accuracy = 0.983000, Test set accuracy = 0.942800
 epoch 14/30. Took 0.22256 seconds. 
  Full-batch training loss = 0.062687, test loss = 0.175291
  Training set accuracy = 0.984200, Test set accuracy = 0.945700
 epoch 15/30. Took 0.2215 seconds. 
  Full-batch training loss = 0.051523, test loss = 0.185304
  Training set accuracy = 0.987000, Test set accuracy = 0.942800
 epoch 16/30. Took 0.22039 seconds. 
  Full-batch training loss = 0.047770, test loss = 0.173460
  Training set accuracy = 0.987600, Test set accuracy = 0.946100
 epoch 17/30. Took 0.2199 seconds. 
  Full-batch training loss = 0.043101, test loss = 0.172563
  Training set accuracy = 0.988000, Test set accuracy = 0.949300
 epoch 18/30. Took 0.24287 seconds. 
  Full-batch training loss = 0.036773, test loss = 0.173665
  Training set accuracy = 0.990200, Test set accuracy = 0.948600
 epoch 19/30. Took 0.22626 seconds. 
  Full-batch training loss = 0.034936, test loss = 0.182370
  Training set accuracy = 0.992000, Test set accuracy = 0.945700
 epoch 20/30. Took 0.23989 seconds. 
  Full-batch training loss = 0.027270, test loss = 0.162630
  Training set accuracy = 0.994000, Test set accuracy = 0.950600
 epoch 21/30. Took 0.22885 seconds. 
  Full-batch training loss = 0.023131, test loss = 0.168372
  Training set accuracy = 0.993800, Test set accuracy = 0.949400
 epoch 22/30. Took 0.22748 seconds. 
  Full-batch training loss = 0.022127, test loss = 0.157188
  Training set accuracy = 0.996200, Test set accuracy = 0.953100
 epoch 23/30. Took 0.22839 seconds. 
  Full-batch training loss = 0.019130, test loss = 0.164184
  Training set accuracy = 0.996000, Test set accuracy = 0.952600
 epoch 24/30. Took 0.22525 seconds. 
  Full-batch training loss = 0.015982, test loss = 0.164458
  Training set accuracy = 0.997200, Test set accuracy = 0.952800
 epoch 25/30. Took 0.22764 seconds. 
  Full-batch training loss = 0.014663, test loss = 0.166386
  Training set accuracy = 0.996800, Test set accuracy = 0.952300
 epoch 26/30. Took 0.2277 seconds. 
  Full-batch training loss = 0.013838, test loss = 0.173070
  Training set accuracy = 0.997200, Test set accuracy = 0.952400
 epoch 27/30. Took 0.22079 seconds. 
  Full-batch training loss = 0.012218, test loss = 0.173889
  Training set accuracy = 0.997800, Test set accuracy = 0.951000
 epoch 28/30. Took 0.21988 seconds. 
  Full-batch training loss = 0.012939, test loss = 0.176331
  Training set accuracy = 0.997600, Test set accuracy = 0.949900
 epoch 29/30. Took 0.22803 seconds. 
  Full-batch training loss = 0.010446, test loss = 0.169022
  Training set accuracy = 0.998800, Test set accuracy = 0.951600
 epoch 30/30. Took 0.22482 seconds. 
  Full-batch training loss = 0.008352, test loss = 0.171459
  Training set accuracy = 0.999000, Test set accuracy = 0.952700
Elapsed time is 15.185666 seconds.
End Training
-----
Params 5000 0.100 0.40 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.63808 seconds. 
  Full-batch training loss = 0.578646, test loss = 0.579775
  Training set accuracy = 0.822200, Test set accuracy = 0.813800
 epoch 2/30. Took 0.5885 seconds. 
  Full-batch training loss = 0.363284, test loss = 0.384150
  Training set accuracy = 0.892800, Test set accuracy = 0.882000
 epoch 3/30. Took 0.59276 seconds. 
  Full-batch training loss = 0.280633, test loss = 0.320844
  Training set accuracy = 0.917000, Test set accuracy = 0.906000
 epoch 4/30. Took 0.59356 seconds. 
  Full-batch training loss = 0.232577, test loss = 0.289522
  Training set accuracy = 0.931400, Test set accuracy = 0.914200
 epoch 5/30. Took 0.6139 seconds. 
  Full-batch training loss = 0.190048, test loss = 0.252882
  Training set accuracy = 0.942600, Test set accuracy = 0.925100
 epoch 6/30. Took 0.59366 seconds. 
  Full-batch training loss = 0.174912, test loss = 0.248742
  Training set accuracy = 0.947800, Test set accuracy = 0.922400
 epoch 7/30. Took 0.59065 seconds. 
  Full-batch training loss = 0.137470, test loss = 0.226673
  Training set accuracy = 0.962000, Test set accuracy = 0.932200
 epoch 8/30. Took 0.59466 seconds. 
  Full-batch training loss = 0.121383, test loss = 0.228407
  Training set accuracy = 0.961400, Test set accuracy = 0.930300
 epoch 9/30. Took 0.59405 seconds. 
  Full-batch training loss = 0.095610, test loss = 0.205603
  Training set accuracy = 0.973400, Test set accuracy = 0.939300
 epoch 10/30. Took 0.59198 seconds. 
  Full-batch training loss = 0.082852, test loss = 0.195653
  Training set accuracy = 0.976400, Test set accuracy = 0.940300
 epoch 11/30. Took 0.59664 seconds. 
  Full-batch training loss = 0.068838, test loss = 0.187467
  Training set accuracy = 0.982200, Test set accuracy = 0.943800
 epoch 12/30. Took 0.58937 seconds. 
  Full-batch training loss = 0.060467, test loss = 0.192666
  Training set accuracy = 0.983200, Test set accuracy = 0.942100
 epoch 13/30. Took 0.6328 seconds. 
  Full-batch training loss = 0.048739, test loss = 0.180967
  Training set accuracy = 0.988800, Test set accuracy = 0.946200
 epoch 14/30. Took 0.59211 seconds. 
  Full-batch training loss = 0.039380, test loss = 0.183209
  Training set accuracy = 0.991200, Test set accuracy = 0.947500
 epoch 15/30. Took 0.59331 seconds. 
  Full-batch training loss = 0.039860, test loss = 0.192050
  Training set accuracy = 0.990000, Test set accuracy = 0.944900
 epoch 16/30. Took 0.59403 seconds. 
  Full-batch training loss = 0.026972, test loss = 0.173356
  Training set accuracy = 0.994800, Test set accuracy = 0.949200
 epoch 17/30. Took 0.59413 seconds. 
  Full-batch training loss = 0.026512, test loss = 0.175579
  Training set accuracy = 0.995400, Test set accuracy = 0.948500
 epoch 18/30. Took 0.60449 seconds. 
  Full-batch training loss = 0.021084, test loss = 0.178916
  Training set accuracy = 0.996400, Test set accuracy = 0.948600
 epoch 19/30. Took 0.61359 seconds. 
  Full-batch training loss = 0.020831, test loss = 0.176120
  Training set accuracy = 0.995600, Test set accuracy = 0.949000
 epoch 20/30. Took 0.6159 seconds. 
  Full-batch training loss = 0.014515, test loss = 0.176683
  Training set accuracy = 0.999000, Test set accuracy = 0.948400
 epoch 21/30. Took 0.61781 seconds. 
  Full-batch training loss = 0.012620, test loss = 0.174438
  Training set accuracy = 0.998800, Test set accuracy = 0.950600
 epoch 22/30. Took 0.60942 seconds. 
  Full-batch training loss = 0.014572, test loss = 0.184129
  Training set accuracy = 0.997200, Test set accuracy = 0.948000
 epoch 23/30. Took 0.62583 seconds. 
  Full-batch training loss = 0.011071, test loss = 0.182367
  Training set accuracy = 0.999200, Test set accuracy = 0.948700
 epoch 24/30. Took 0.59424 seconds. 
  Full-batch training loss = 0.008702, test loss = 0.180439
  Training set accuracy = 0.999600, Test set accuracy = 0.951200
 epoch 25/30. Took 0.63977 seconds. 
  Full-batch training loss = 0.008017, test loss = 0.182625
  Training set accuracy = 0.999400, Test set accuracy = 0.951000
 epoch 26/30. Took 0.59134 seconds. 
  Full-batch training loss = 0.005673, test loss = 0.181178
  Training set accuracy = 1.000000, Test set accuracy = 0.951800
 epoch 27/30. Took 0.59302 seconds. 
  Full-batch training loss = 0.004889, test loss = 0.185811
  Training set accuracy = 1.000000, Test set accuracy = 0.951600
 epoch 28/30. Took 0.59623 seconds. 
  Full-batch training loss = 0.004278, test loss = 0.181740
  Training set accuracy = 0.999800, Test set accuracy = 0.953300
 epoch 29/30. Took 0.61265 seconds. 
  Full-batch training loss = 0.005002, test loss = 0.192355
  Training set accuracy = 0.999800, Test set accuracy = 0.951700
 epoch 30/30. Took 0.59186 seconds. 
  Full-batch training loss = 0.003802, test loss = 0.180427
  Training set accuracy = 0.999800, Test set accuracy = 0.952900
Elapsed time is 38.111233 seconds.
End Training
-----
Params 5000 0.100 0.40 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.16523 seconds. 
  Full-batch training loss = 1.781081, test loss = 1.785142
  Training set accuracy = 0.587600, Test set accuracy = 0.587400
 epoch 2/30. Took 0.1511 seconds. 
  Full-batch training loss = 0.753941, test loss = 0.788605
  Training set accuracy = 0.730800, Test set accuracy = 0.707800
 epoch 3/30. Took 0.15043 seconds. 
  Full-batch training loss = 0.519976, test loss = 0.553405
  Training set accuracy = 0.855400, Test set accuracy = 0.840800
 epoch 4/30. Took 0.152 seconds. 
  Full-batch training loss = 0.385894, test loss = 0.432074
  Training set accuracy = 0.886800, Test set accuracy = 0.872100
 epoch 5/30. Took 0.1574 seconds. 
  Full-batch training loss = 0.332781, test loss = 0.398350
  Training set accuracy = 0.898400, Test set accuracy = 0.877800
 epoch 6/30. Took 0.16195 seconds. 
  Full-batch training loss = 0.246326, test loss = 0.327267
  Training set accuracy = 0.930200, Test set accuracy = 0.901900
 epoch 7/30. Took 0.16267 seconds. 
  Full-batch training loss = 0.232229, test loss = 0.321335
  Training set accuracy = 0.931800, Test set accuracy = 0.903800
 epoch 8/30. Took 0.15892 seconds. 
  Full-batch training loss = 0.198428, test loss = 0.291162
  Training set accuracy = 0.944200, Test set accuracy = 0.912600
 epoch 9/30. Took 0.1621 seconds. 
  Full-batch training loss = 0.167640, test loss = 0.263811
  Training set accuracy = 0.954600, Test set accuracy = 0.921700
 epoch 10/30. Took 0.15324 seconds. 
  Full-batch training loss = 0.161813, test loss = 0.274121
  Training set accuracy = 0.949200, Test set accuracy = 0.918400
 epoch 11/30. Took 0.15857 seconds. 
  Full-batch training loss = 0.140104, test loss = 0.280493
  Training set accuracy = 0.959400, Test set accuracy = 0.918100
 epoch 12/30. Took 0.15901 seconds. 
  Full-batch training loss = 0.121468, test loss = 0.253213
  Training set accuracy = 0.965600, Test set accuracy = 0.925600
 epoch 13/30. Took 0.16178 seconds. 
  Full-batch training loss = 0.128633, test loss = 0.264888
  Training set accuracy = 0.960000, Test set accuracy = 0.921700
 epoch 14/30. Took 0.16261 seconds. 
  Full-batch training loss = 0.120697, test loss = 0.275253
  Training set accuracy = 0.963400, Test set accuracy = 0.921900
 epoch 15/30. Took 0.16186 seconds. 
  Full-batch training loss = 0.091623, test loss = 0.243379
  Training set accuracy = 0.974000, Test set accuracy = 0.932100
 epoch 16/30. Took 0.15212 seconds. 
  Full-batch training loss = 0.083743, test loss = 0.246132
  Training set accuracy = 0.975000, Test set accuracy = 0.931700
 epoch 17/30. Took 0.16189 seconds. 
  Full-batch training loss = 0.073001, test loss = 0.236266
  Training set accuracy = 0.979400, Test set accuracy = 0.935600
 epoch 18/30. Took 0.16084 seconds. 
  Full-batch training loss = 0.081348, test loss = 0.274341
  Training set accuracy = 0.975800, Test set accuracy = 0.923600
 epoch 19/30. Took 0.16351 seconds. 
  Full-batch training loss = 0.065100, test loss = 0.230908
  Training set accuracy = 0.980400, Test set accuracy = 0.938100
 epoch 20/30. Took 0.1613 seconds. 
  Full-batch training loss = 0.059957, test loss = 0.239207
  Training set accuracy = 0.984000, Test set accuracy = 0.938200
 epoch 21/30. Took 0.15765 seconds. 
  Full-batch training loss = 0.055398, test loss = 0.232557
  Training set accuracy = 0.986000, Test set accuracy = 0.940200
 epoch 22/30. Took 0.15311 seconds. 
  Full-batch training loss = 0.056129, test loss = 0.230437
  Training set accuracy = 0.982000, Test set accuracy = 0.939400
 epoch 23/30. Took 0.16304 seconds. 
  Full-batch training loss = 0.045294, test loss = 0.218307
  Training set accuracy = 0.988200, Test set accuracy = 0.942000
 epoch 24/30. Took 0.16231 seconds. 
  Full-batch training loss = 0.043177, test loss = 0.229995
  Training set accuracy = 0.988200, Test set accuracy = 0.940500
 epoch 25/30. Took 0.16352 seconds. 
  Full-batch training loss = 0.040439, test loss = 0.240666
  Training set accuracy = 0.989600, Test set accuracy = 0.935600
 epoch 26/30. Took 0.16895 seconds. 
  Full-batch training loss = 0.036244, test loss = 0.226294
  Training set accuracy = 0.990000, Test set accuracy = 0.941700
 epoch 27/30. Took 0.14888 seconds. 
  Full-batch training loss = 0.039874, test loss = 0.241821
  Training set accuracy = 0.990200, Test set accuracy = 0.939400
 epoch 28/30. Took 0.15069 seconds. 
  Full-batch training loss = 0.037967, test loss = 0.252225
  Training set accuracy = 0.990200, Test set accuracy = 0.936500
 epoch 29/30. Took 0.15135 seconds. 
  Full-batch training loss = 0.028673, test loss = 0.248433
  Training set accuracy = 0.992800, Test set accuracy = 0.940000
 epoch 30/30. Took 0.15365 seconds. 
  Full-batch training loss = 0.030326, test loss = 0.230825
  Training set accuracy = 0.991000, Test set accuracy = 0.940500
Elapsed time is 10.758778 seconds.
End Training
-----
Params 5000 0.100 0.40 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28253 seconds. 
  Full-batch training loss = 1.535055, test loss = 1.539453
  Training set accuracy = 0.577400, Test set accuracy = 0.570800
 epoch 2/30. Took 0.27802 seconds. 
  Full-batch training loss = 0.580450, test loss = 0.590168
  Training set accuracy = 0.841200, Test set accuracy = 0.837900
 epoch 3/30. Took 0.28221 seconds. 
  Full-batch training loss = 0.394301, test loss = 0.430401
  Training set accuracy = 0.885800, Test set accuracy = 0.871300
 epoch 4/30. Took 0.28232 seconds. 
  Full-batch training loss = 0.287417, test loss = 0.336979
  Training set accuracy = 0.921400, Test set accuracy = 0.901800
 epoch 5/30. Took 0.28132 seconds. 
  Full-batch training loss = 0.234136, test loss = 0.302923
  Training set accuracy = 0.931600, Test set accuracy = 0.908500
 epoch 6/30. Took 0.28267 seconds. 
  Full-batch training loss = 0.198141, test loss = 0.266949
  Training set accuracy = 0.944400, Test set accuracy = 0.918000
 epoch 7/30. Took 0.27864 seconds. 
  Full-batch training loss = 0.161971, test loss = 0.250689
  Training set accuracy = 0.953800, Test set accuracy = 0.923600
 epoch 8/30. Took 0.27994 seconds. 
  Full-batch training loss = 0.134259, test loss = 0.239282
  Training set accuracy = 0.958800, Test set accuracy = 0.926900
 epoch 9/30. Took 0.27342 seconds. 
  Full-batch training loss = 0.112727, test loss = 0.229364
  Training set accuracy = 0.966800, Test set accuracy = 0.931500
 epoch 10/30. Took 0.28151 seconds. 
  Full-batch training loss = 0.097026, test loss = 0.220280
  Training set accuracy = 0.972600, Test set accuracy = 0.934900
 epoch 11/30. Took 0.27157 seconds. 
  Full-batch training loss = 0.103970, test loss = 0.228389
  Training set accuracy = 0.970800, Test set accuracy = 0.930400
 epoch 12/30. Took 0.27139 seconds. 
  Full-batch training loss = 0.071612, test loss = 0.215403
  Training set accuracy = 0.980200, Test set accuracy = 0.936600
 epoch 13/30. Took 0.28104 seconds. 
  Full-batch training loss = 0.057178, test loss = 0.213296
  Training set accuracy = 0.983800, Test set accuracy = 0.941300
 epoch 14/30. Took 0.27305 seconds. 
  Full-batch training loss = 0.057053, test loss = 0.227624
  Training set accuracy = 0.983000, Test set accuracy = 0.934200
 epoch 15/30. Took 0.27397 seconds. 
  Full-batch training loss = 0.049399, test loss = 0.203423
  Training set accuracy = 0.987200, Test set accuracy = 0.940400
 epoch 16/30. Took 0.26774 seconds. 
  Full-batch training loss = 0.035123, test loss = 0.202850
  Training set accuracy = 0.992200, Test set accuracy = 0.943400
 epoch 17/30. Took 0.27706 seconds. 
  Full-batch training loss = 0.037359, test loss = 0.208862
  Training set accuracy = 0.989800, Test set accuracy = 0.943400
 epoch 18/30. Took 0.28016 seconds. 
  Full-batch training loss = 0.025318, test loss = 0.193126
  Training set accuracy = 0.994600, Test set accuracy = 0.946100
 epoch 19/30. Took 0.33063 seconds. 
  Full-batch training loss = 0.023159, test loss = 0.214422
  Training set accuracy = 0.994000, Test set accuracy = 0.942800
 epoch 20/30. Took 0.27874 seconds. 
  Full-batch training loss = 0.030614, test loss = 0.225914
  Training set accuracy = 0.992000, Test set accuracy = 0.941000
 epoch 21/30. Took 0.30311 seconds. 
  Full-batch training loss = 0.020708, test loss = 0.202766
  Training set accuracy = 0.995600, Test set accuracy = 0.943500
 epoch 22/30. Took 0.27821 seconds. 
  Full-batch training loss = 0.020300, test loss = 0.212956
  Training set accuracy = 0.995800, Test set accuracy = 0.942300
 epoch 23/30. Took 0.28338 seconds. 
  Full-batch training loss = 0.014430, test loss = 0.216569
  Training set accuracy = 0.997200, Test set accuracy = 0.944300
 epoch 24/30. Took 0.28148 seconds. 
  Full-batch training loss = 0.014112, test loss = 0.215982
  Training set accuracy = 0.995400, Test set accuracy = 0.946000
 epoch 25/30. Took 0.2818 seconds. 
  Full-batch training loss = 0.010472, test loss = 0.212221
  Training set accuracy = 0.998000, Test set accuracy = 0.945300
 epoch 26/30. Took 0.28235 seconds. 
  Full-batch training loss = 0.013077, test loss = 0.232689
  Training set accuracy = 0.996800, Test set accuracy = 0.945400
 epoch 27/30. Took 0.27463 seconds. 
  Full-batch training loss = 0.009293, test loss = 0.227096
  Training set accuracy = 0.998200, Test set accuracy = 0.946400
 epoch 28/30. Took 0.28156 seconds. 
  Full-batch training loss = 0.010178, test loss = 0.227021
  Training set accuracy = 0.998000, Test set accuracy = 0.944800
 epoch 29/30. Took 0.28098 seconds. 
  Full-batch training loss = 0.008408, test loss = 0.217504
  Training set accuracy = 0.999000, Test set accuracy = 0.947100
 epoch 30/30. Took 0.29944 seconds. 
  Full-batch training loss = 0.011507, test loss = 0.233243
  Training set accuracy = 0.996600, Test set accuracy = 0.946900
Elapsed time is 18.510346 seconds.
End Training
-----
Params 5000 0.100 0.40 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.86163 seconds. 
  Full-batch training loss = 1.000772, test loss = 1.013801
  Training set accuracy = 0.691800, Test set accuracy = 0.686100
 epoch 2/30. Took 0.82265 seconds. 
  Full-batch training loss = 0.448538, test loss = 0.476200
  Training set accuracy = 0.863200, Test set accuracy = 0.850700
 epoch 3/30. Took 0.90716 seconds. 
  Full-batch training loss = 0.294039, test loss = 0.347261
  Training set accuracy = 0.913000, Test set accuracy = 0.896000
 epoch 4/30. Took 0.82618 seconds. 
  Full-batch training loss = 0.241018, test loss = 0.307696
  Training set accuracy = 0.924800, Test set accuracy = 0.904600
 epoch 5/30. Took 0.8264 seconds. 
  Full-batch training loss = 0.197562, test loss = 0.276088
  Training set accuracy = 0.939000, Test set accuracy = 0.917600
 epoch 6/30. Took 0.82715 seconds. 
  Full-batch training loss = 0.147230, test loss = 0.237808
  Training set accuracy = 0.957200, Test set accuracy = 0.928000
 epoch 7/30. Took 0.83282 seconds. 
  Full-batch training loss = 0.120207, test loss = 0.238157
  Training set accuracy = 0.964200, Test set accuracy = 0.930600
 epoch 8/30. Took 0.86629 seconds. 
  Full-batch training loss = 0.108839, test loss = 0.232671
  Training set accuracy = 0.968200, Test set accuracy = 0.930100
 epoch 9/30. Took 0.81578 seconds. 
  Full-batch training loss = 0.097503, test loss = 0.239499
  Training set accuracy = 0.969400, Test set accuracy = 0.930400
 epoch 10/30. Took 0.81323 seconds. 
  Full-batch training loss = 0.074293, test loss = 0.225389
  Training set accuracy = 0.978200, Test set accuracy = 0.934600
 epoch 11/30. Took 0.81402 seconds. 
  Full-batch training loss = 0.047561, test loss = 0.198793
  Training set accuracy = 0.987600, Test set accuracy = 0.942300
 epoch 12/30. Took 0.8308 seconds. 
  Full-batch training loss = 0.041140, test loss = 0.200758
  Training set accuracy = 0.988200, Test set accuracy = 0.942600
 epoch 13/30. Took 0.83189 seconds. 
  Full-batch training loss = 0.042054, test loss = 0.201988
  Training set accuracy = 0.988000, Test set accuracy = 0.943400
 epoch 14/30. Took 0.82573 seconds. 
  Full-batch training loss = 0.029236, test loss = 0.200270
  Training set accuracy = 0.993000, Test set accuracy = 0.943500
 epoch 15/30. Took 0.81941 seconds. 
  Full-batch training loss = 0.035431, test loss = 0.222389
  Training set accuracy = 0.989000, Test set accuracy = 0.938400
 epoch 16/30. Took 0.82436 seconds. 
  Full-batch training loss = 0.023567, test loss = 0.209656
  Training set accuracy = 0.993600, Test set accuracy = 0.944200
 epoch 17/30. Took 0.82188 seconds. 
  Full-batch training loss = 0.015833, test loss = 0.201737
  Training set accuracy = 0.996200, Test set accuracy = 0.947400
 epoch 18/30. Took 0.82051 seconds. 
  Full-batch training loss = 0.017330, test loss = 0.200349
  Training set accuracy = 0.996000, Test set accuracy = 0.947500
 epoch 19/30. Took 0.81945 seconds. 
  Full-batch training loss = 0.008633, test loss = 0.193025
  Training set accuracy = 0.998400, Test set accuracy = 0.952200
 epoch 20/30. Took 0.87974 seconds. 
  Full-batch training loss = 0.011288, test loss = 0.211978
  Training set accuracy = 0.997400, Test set accuracy = 0.947200
 epoch 21/30. Took 0.82166 seconds. 
  Full-batch training loss = 0.008750, test loss = 0.222159
  Training set accuracy = 0.998800, Test set accuracy = 0.946700
 epoch 22/30. Took 0.83718 seconds. 
  Full-batch training loss = 0.007791, test loss = 0.201247
  Training set accuracy = 0.998600, Test set accuracy = 0.949500
 epoch 23/30. Took 0.82117 seconds. 
  Full-batch training loss = 0.004594, test loss = 0.198183
  Training set accuracy = 0.999200, Test set accuracy = 0.951800
 epoch 24/30. Took 0.81714 seconds. 
  Full-batch training loss = 0.006588, test loss = 0.215396
  Training set accuracy = 0.998800, Test set accuracy = 0.949000
 epoch 25/30. Took 0.841 seconds. 
  Full-batch training loss = 0.004814, test loss = 0.216035
  Training set accuracy = 0.999400, Test set accuracy = 0.949300
 epoch 26/30. Took 0.84857 seconds. 
  Full-batch training loss = 0.002787, test loss = 0.209092
  Training set accuracy = 0.999800, Test set accuracy = 0.951700
 epoch 27/30. Took 0.82511 seconds. 
  Full-batch training loss = 0.002625, test loss = 0.209502
  Training set accuracy = 0.999800, Test set accuracy = 0.953000
 epoch 28/30. Took 0.90098 seconds. 
  Full-batch training loss = 0.004244, test loss = 0.219608
  Training set accuracy = 0.999600, Test set accuracy = 0.948700
 epoch 29/30. Took 0.82625 seconds. 
  Full-batch training loss = 0.002316, test loss = 0.221202
  Training set accuracy = 0.999600, Test set accuracy = 0.951400
 epoch 30/30. Took 0.82602 seconds. 
  Full-batch training loss = 0.002218, test loss = 0.220553
  Training set accuracy = 0.999800, Test set accuracy = 0.951300
Elapsed time is 52.535250 seconds.
End Training
-----
Params 5000 0.100 0.50 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.1169 seconds. 
  Full-batch training loss = 0.624189, test loss = 0.608076
  Training set accuracy = 0.830000, Test set accuracy = 0.827900
 epoch 2/30. Took 0.10976 seconds. 
  Full-batch training loss = 0.429563, test loss = 0.432993
  Training set accuracy = 0.889000, Test set accuracy = 0.885500
 epoch 3/30. Took 0.12158 seconds. 
  Full-batch training loss = 0.347571, test loss = 0.361769
  Training set accuracy = 0.905800, Test set accuracy = 0.899900
 epoch 4/30. Took 0.11974 seconds. 
  Full-batch training loss = 0.301496, test loss = 0.329376
  Training set accuracy = 0.920800, Test set accuracy = 0.903800
 epoch 5/30. Took 0.10789 seconds. 
  Full-batch training loss = 0.262940, test loss = 0.298752
  Training set accuracy = 0.928600, Test set accuracy = 0.914200
 epoch 6/30. Took 0.10906 seconds. 
  Full-batch training loss = 0.237438, test loss = 0.283388
  Training set accuracy = 0.935000, Test set accuracy = 0.917400
 epoch 7/30. Took 0.11277 seconds. 
  Full-batch training loss = 0.211410, test loss = 0.266123
  Training set accuracy = 0.941800, Test set accuracy = 0.922800
 epoch 8/30. Took 0.11142 seconds. 
  Full-batch training loss = 0.196641, test loss = 0.257773
  Training set accuracy = 0.946400, Test set accuracy = 0.924100
 epoch 9/30. Took 0.1058 seconds. 
  Full-batch training loss = 0.180166, test loss = 0.247173
  Training set accuracy = 0.949600, Test set accuracy = 0.926900
 epoch 10/30. Took 0.10584 seconds. 
  Full-batch training loss = 0.165480, test loss = 0.242766
  Training set accuracy = 0.954600, Test set accuracy = 0.929000
 epoch 11/30. Took 0.10678 seconds. 
  Full-batch training loss = 0.157006, test loss = 0.242596
  Training set accuracy = 0.958600, Test set accuracy = 0.928100
 epoch 12/30. Took 0.10711 seconds. 
  Full-batch training loss = 0.144162, test loss = 0.233815
  Training set accuracy = 0.960200, Test set accuracy = 0.928300
 epoch 13/30. Took 0.10892 seconds. 
  Full-batch training loss = 0.133690, test loss = 0.228911
  Training set accuracy = 0.963400, Test set accuracy = 0.931900
 epoch 14/30. Took 0.10994 seconds. 
  Full-batch training loss = 0.120599, test loss = 0.221408
  Training set accuracy = 0.967400, Test set accuracy = 0.934100
 epoch 15/30. Took 0.10681 seconds. 
  Full-batch training loss = 0.116467, test loss = 0.218783
  Training set accuracy = 0.970400, Test set accuracy = 0.935000
 epoch 16/30. Took 0.10785 seconds. 
  Full-batch training loss = 0.108328, test loss = 0.217833
  Training set accuracy = 0.971600, Test set accuracy = 0.934600
 epoch 17/30. Took 0.10771 seconds. 
  Full-batch training loss = 0.107630, test loss = 0.227041
  Training set accuracy = 0.972000, Test set accuracy = 0.932500
 epoch 18/30. Took 0.10528 seconds. 
  Full-batch training loss = 0.094695, test loss = 0.219457
  Training set accuracy = 0.975800, Test set accuracy = 0.934400
 epoch 19/30. Took 0.10868 seconds. 
  Full-batch training loss = 0.090689, test loss = 0.210575
  Training set accuracy = 0.977200, Test set accuracy = 0.936800
 epoch 20/30. Took 0.11124 seconds. 
  Full-batch training loss = 0.084536, test loss = 0.205882
  Training set accuracy = 0.981600, Test set accuracy = 0.937400
 epoch 21/30. Took 0.11293 seconds. 
  Full-batch training loss = 0.079099, test loss = 0.202364
  Training set accuracy = 0.981200, Test set accuracy = 0.939900
 epoch 22/30. Took 0.10608 seconds. 
  Full-batch training loss = 0.073368, test loss = 0.206373
  Training set accuracy = 0.983200, Test set accuracy = 0.939100
 epoch 23/30. Took 0.10475 seconds. 
  Full-batch training loss = 0.073794, test loss = 0.201784
  Training set accuracy = 0.984600, Test set accuracy = 0.939700
 epoch 24/30. Took 0.10626 seconds. 
  Full-batch training loss = 0.065446, test loss = 0.202660
  Training set accuracy = 0.984800, Test set accuracy = 0.940100
 epoch 25/30. Took 0.10737 seconds. 
  Full-batch training loss = 0.062894, test loss = 0.198698
  Training set accuracy = 0.985800, Test set accuracy = 0.941500
 epoch 26/30. Took 0.10526 seconds. 
  Full-batch training loss = 0.060171, test loss = 0.200262
  Training set accuracy = 0.985600, Test set accuracy = 0.941500
 epoch 27/30. Took 0.11417 seconds. 
  Full-batch training loss = 0.055012, test loss = 0.197414
  Training set accuracy = 0.988200, Test set accuracy = 0.942800
 epoch 28/30. Took 0.10746 seconds. 
  Full-batch training loss = 0.056220, test loss = 0.202509
  Training set accuracy = 0.988600, Test set accuracy = 0.940800
 epoch 29/30. Took 0.10527 seconds. 
  Full-batch training loss = 0.050203, test loss = 0.196011
  Training set accuracy = 0.989800, Test set accuracy = 0.944300
 epoch 30/30. Took 0.11941 seconds. 
  Full-batch training loss = 0.050524, test loss = 0.194832
  Training set accuracy = 0.990000, Test set accuracy = 0.942700
Elapsed time is 8.034822 seconds.
End Training
-----
Params 5000 0.100 0.50 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17555 seconds. 
  Full-batch training loss = 0.534560, test loss = 0.545410
  Training set accuracy = 0.870400, Test set accuracy = 0.860700
 epoch 2/30. Took 0.16355 seconds. 
  Full-batch training loss = 0.382037, test loss = 0.403884
  Training set accuracy = 0.900800, Test set accuracy = 0.887600
 epoch 3/30. Took 0.18138 seconds. 
  Full-batch training loss = 0.315402, test loss = 0.353017
  Training set accuracy = 0.917800, Test set accuracy = 0.899000
 epoch 4/30. Took 0.16689 seconds. 
  Full-batch training loss = 0.273732, test loss = 0.317309
  Training set accuracy = 0.927400, Test set accuracy = 0.907600
 epoch 5/30. Took 0.18667 seconds. 
  Full-batch training loss = 0.251530, test loss = 0.311516
  Training set accuracy = 0.931000, Test set accuracy = 0.910200
 epoch 6/30. Took 0.16872 seconds. 
  Full-batch training loss = 0.217423, test loss = 0.278178
  Training set accuracy = 0.940800, Test set accuracy = 0.917200
 epoch 7/30. Took 0.16716 seconds. 
  Full-batch training loss = 0.203043, test loss = 0.274061
  Training set accuracy = 0.945200, Test set accuracy = 0.916600
 epoch 8/30. Took 0.17292 seconds. 
  Full-batch training loss = 0.183162, test loss = 0.259249
  Training set accuracy = 0.951400, Test set accuracy = 0.920500
 epoch 9/30. Took 0.17033 seconds. 
  Full-batch training loss = 0.165840, test loss = 0.243344
  Training set accuracy = 0.957200, Test set accuracy = 0.926600
 epoch 10/30. Took 0.16898 seconds. 
  Full-batch training loss = 0.159290, test loss = 0.245593
  Training set accuracy = 0.956600, Test set accuracy = 0.924700
 epoch 11/30. Took 0.16848 seconds. 
  Full-batch training loss = 0.133779, test loss = 0.231065
  Training set accuracy = 0.965000, Test set accuracy = 0.931700
 epoch 12/30. Took 0.16833 seconds. 
  Full-batch training loss = 0.123592, test loss = 0.221321
  Training set accuracy = 0.969800, Test set accuracy = 0.932900
 epoch 13/30. Took 0.16884 seconds. 
  Full-batch training loss = 0.112368, test loss = 0.217065
  Training set accuracy = 0.971000, Test set accuracy = 0.934600
 epoch 14/30. Took 0.16859 seconds. 
  Full-batch training loss = 0.103116, test loss = 0.209618
  Training set accuracy = 0.974600, Test set accuracy = 0.937200
 epoch 15/30. Took 0.16869 seconds. 
  Full-batch training loss = 0.100912, test loss = 0.212244
  Training set accuracy = 0.975400, Test set accuracy = 0.934800
 epoch 16/30. Took 0.1712 seconds. 
  Full-batch training loss = 0.087966, test loss = 0.201990
  Training set accuracy = 0.978200, Test set accuracy = 0.938900
 epoch 17/30. Took 0.16825 seconds. 
  Full-batch training loss = 0.083324, test loss = 0.200687
  Training set accuracy = 0.980200, Test set accuracy = 0.939300
 epoch 18/30. Took 0.16989 seconds. 
  Full-batch training loss = 0.075680, test loss = 0.199841
  Training set accuracy = 0.983800, Test set accuracy = 0.940000
 epoch 19/30. Took 0.16957 seconds. 
  Full-batch training loss = 0.069463, test loss = 0.193557
  Training set accuracy = 0.984400, Test set accuracy = 0.943400
 epoch 20/30. Took 0.16898 seconds. 
  Full-batch training loss = 0.063215, test loss = 0.193178
  Training set accuracy = 0.985000, Test set accuracy = 0.941000
 epoch 21/30. Took 0.16926 seconds. 
  Full-batch training loss = 0.058486, test loss = 0.189525
  Training set accuracy = 0.988400, Test set accuracy = 0.943600
 epoch 22/30. Took 0.18543 seconds. 
  Full-batch training loss = 0.054490, test loss = 0.186858
  Training set accuracy = 0.988200, Test set accuracy = 0.943200
 epoch 23/30. Took 0.16977 seconds. 
  Full-batch training loss = 0.051152, test loss = 0.189714
  Training set accuracy = 0.990200, Test set accuracy = 0.943100
 epoch 24/30. Took 0.16406 seconds. 
  Full-batch training loss = 0.048190, test loss = 0.186446
  Training set accuracy = 0.990800, Test set accuracy = 0.944500
 epoch 25/30. Took 0.16839 seconds. 
  Full-batch training loss = 0.043272, test loss = 0.180705
  Training set accuracy = 0.992200, Test set accuracy = 0.945300
 epoch 26/30. Took 0.17829 seconds. 
  Full-batch training loss = 0.045027, test loss = 0.190493
  Training set accuracy = 0.992800, Test set accuracy = 0.942900
 epoch 27/30. Took 0.16907 seconds. 
  Full-batch training loss = 0.039871, test loss = 0.183253
  Training set accuracy = 0.993200, Test set accuracy = 0.944900
 epoch 28/30. Took 0.16879 seconds. 
  Full-batch training loss = 0.035135, test loss = 0.180050
  Training set accuracy = 0.994800, Test set accuracy = 0.945300
 epoch 29/30. Took 0.16871 seconds. 
  Full-batch training loss = 0.034547, test loss = 0.183113
  Training set accuracy = 0.994400, Test set accuracy = 0.945800
 epoch 30/30. Took 0.16939 seconds. 
  Full-batch training loss = 0.031449, test loss = 0.178501
  Training set accuracy = 0.995200, Test set accuracy = 0.947200
Elapsed time is 11.689115 seconds.
End Training
-----
Params 5000 0.100 0.50 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.3738 seconds. 
  Full-batch training loss = 0.494238, test loss = 0.512249
  Training set accuracy = 0.860200, Test set accuracy = 0.855500
 epoch 2/30. Took 0.36001 seconds. 
  Full-batch training loss = 0.356747, test loss = 0.390468
  Training set accuracy = 0.893800, Test set accuracy = 0.887500
 epoch 3/30. Took 0.35572 seconds. 
  Full-batch training loss = 0.294506, test loss = 0.339744
  Training set accuracy = 0.913600, Test set accuracy = 0.900900
 epoch 4/30. Took 0.3545 seconds. 
  Full-batch training loss = 0.250562, test loss = 0.307153
  Training set accuracy = 0.927800, Test set accuracy = 0.912400
 epoch 5/30. Took 0.36783 seconds. 
  Full-batch training loss = 0.227389, test loss = 0.296002
  Training set accuracy = 0.933600, Test set accuracy = 0.913600
 epoch 6/30. Took 0.35487 seconds. 
  Full-batch training loss = 0.196233, test loss = 0.270636
  Training set accuracy = 0.943800, Test set accuracy = 0.920100
 epoch 7/30. Took 0.35592 seconds. 
  Full-batch training loss = 0.176734, test loss = 0.261778
  Training set accuracy = 0.947800, Test set accuracy = 0.920800
 epoch 8/30. Took 0.35387 seconds. 
  Full-batch training loss = 0.159128, test loss = 0.247340
  Training set accuracy = 0.957400, Test set accuracy = 0.927700
 epoch 9/30. Took 0.35186 seconds. 
  Full-batch training loss = 0.145579, test loss = 0.239085
  Training set accuracy = 0.961000, Test set accuracy = 0.930200
 epoch 10/30. Took 0.3515 seconds. 
  Full-batch training loss = 0.132693, test loss = 0.236787
  Training set accuracy = 0.962000, Test set accuracy = 0.927400
 epoch 11/30. Took 0.35424 seconds. 
  Full-batch training loss = 0.113892, test loss = 0.221081
  Training set accuracy = 0.971200, Test set accuracy = 0.934500
 epoch 12/30. Took 0.39166 seconds. 
  Full-batch training loss = 0.100057, test loss = 0.216242
  Training set accuracy = 0.975400, Test set accuracy = 0.936000
 epoch 13/30. Took 0.36808 seconds. 
  Full-batch training loss = 0.091917, test loss = 0.208656
  Training set accuracy = 0.978600, Test set accuracy = 0.937300
 epoch 14/30. Took 0.35273 seconds. 
  Full-batch training loss = 0.086286, test loss = 0.208244
  Training set accuracy = 0.979800, Test set accuracy = 0.937400
 epoch 15/30. Took 0.35561 seconds. 
  Full-batch training loss = 0.077491, test loss = 0.205450
  Training set accuracy = 0.982400, Test set accuracy = 0.937500
 epoch 16/30. Took 0.36948 seconds. 
  Full-batch training loss = 0.075072, test loss = 0.211759
  Training set accuracy = 0.983200, Test set accuracy = 0.936600
 epoch 17/30. Took 0.35154 seconds. 
  Full-batch training loss = 0.068747, test loss = 0.198733
  Training set accuracy = 0.984600, Test set accuracy = 0.939600
 epoch 18/30. Took 0.35457 seconds. 
  Full-batch training loss = 0.061236, test loss = 0.195496
  Training set accuracy = 0.988200, Test set accuracy = 0.941500
 epoch 19/30. Took 0.35411 seconds. 
  Full-batch training loss = 0.052344, test loss = 0.192956
  Training set accuracy = 0.991000, Test set accuracy = 0.940700
 epoch 20/30. Took 0.38482 seconds. 
  Full-batch training loss = 0.049643, test loss = 0.193733
  Training set accuracy = 0.991800, Test set accuracy = 0.941200
 epoch 21/30. Took 0.35334 seconds. 
  Full-batch training loss = 0.045509, test loss = 0.188290
  Training set accuracy = 0.993200, Test set accuracy = 0.942300
 epoch 22/30. Took 0.35449 seconds. 
  Full-batch training loss = 0.040228, test loss = 0.185631
  Training set accuracy = 0.993800, Test set accuracy = 0.943300
 epoch 23/30. Took 0.35076 seconds. 
  Full-batch training loss = 0.037680, test loss = 0.183937
  Training set accuracy = 0.994400, Test set accuracy = 0.943700
 epoch 24/30. Took 0.35505 seconds. 
  Full-batch training loss = 0.035493, test loss = 0.185590
  Training set accuracy = 0.995600, Test set accuracy = 0.944500
 epoch 25/30. Took 0.35642 seconds. 
  Full-batch training loss = 0.032822, test loss = 0.187541
  Training set accuracy = 0.996400, Test set accuracy = 0.944800
 epoch 26/30. Took 0.35397 seconds. 
  Full-batch training loss = 0.029681, test loss = 0.183684
  Training set accuracy = 0.997000, Test set accuracy = 0.944700
 epoch 27/30. Took 0.35447 seconds. 
  Full-batch training loss = 0.026714, test loss = 0.184334
  Training set accuracy = 0.998400, Test set accuracy = 0.944800
 epoch 28/30. Took 0.35214 seconds. 
  Full-batch training loss = 0.026432, test loss = 0.185502
  Training set accuracy = 0.998000, Test set accuracy = 0.944100
 epoch 29/30. Took 0.35396 seconds. 
  Full-batch training loss = 0.026198, test loss = 0.187644
  Training set accuracy = 0.997600, Test set accuracy = 0.946300
 epoch 30/30. Took 0.37112 seconds. 
  Full-batch training loss = 0.021549, test loss = 0.183580
  Training set accuracy = 0.998400, Test set accuracy = 0.945200
Elapsed time is 23.431653 seconds.
End Training
-----
Params 5000 0.100 0.50 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14161 seconds. 
  Full-batch training loss = 1.225239, test loss = 1.223016
  Training set accuracy = 0.705200, Test set accuracy = 0.703100
 epoch 2/30. Took 0.13471 seconds. 
  Full-batch training loss = 0.644860, test loss = 0.653844
  Training set accuracy = 0.826000, Test set accuracy = 0.820200
 epoch 3/30. Took 0.13469 seconds. 
  Full-batch training loss = 0.475542, test loss = 0.503698
  Training set accuracy = 0.865600, Test set accuracy = 0.852900
 epoch 4/30. Took 0.13213 seconds. 
  Full-batch training loss = 0.370949, test loss = 0.403511
  Training set accuracy = 0.895800, Test set accuracy = 0.885800
 epoch 5/30. Took 0.13011 seconds. 
  Full-batch training loss = 0.312335, test loss = 0.358034
  Training set accuracy = 0.913800, Test set accuracy = 0.893100
 epoch 6/30. Took 0.13669 seconds. 
  Full-batch training loss = 0.278080, test loss = 0.330512
  Training set accuracy = 0.919000, Test set accuracy = 0.899800
 epoch 7/30. Took 0.13519 seconds. 
  Full-batch training loss = 0.245012, test loss = 0.301220
  Training set accuracy = 0.932600, Test set accuracy = 0.912800
 epoch 8/30. Took 0.13906 seconds. 
  Full-batch training loss = 0.220062, test loss = 0.293178
  Training set accuracy = 0.938400, Test set accuracy = 0.913500
 epoch 9/30. Took 0.13568 seconds. 
  Full-batch training loss = 0.194673, test loss = 0.268350
  Training set accuracy = 0.944000, Test set accuracy = 0.918800
 epoch 10/30. Took 0.13542 seconds. 
  Full-batch training loss = 0.179593, test loss = 0.266052
  Training set accuracy = 0.948400, Test set accuracy = 0.919600
 epoch 11/30. Took 0.13551 seconds. 
  Full-batch training loss = 0.171046, test loss = 0.261705
  Training set accuracy = 0.952600, Test set accuracy = 0.920800
 epoch 12/30. Took 0.13783 seconds. 
  Full-batch training loss = 0.162028, test loss = 0.264040
  Training set accuracy = 0.952800, Test set accuracy = 0.921500
 epoch 13/30. Took 0.14967 seconds. 
  Full-batch training loss = 0.152702, test loss = 0.271166
  Training set accuracy = 0.959000, Test set accuracy = 0.920300
 epoch 14/30. Took 0.1348 seconds. 
  Full-batch training loss = 0.139099, test loss = 0.248908
  Training set accuracy = 0.960600, Test set accuracy = 0.924100
 epoch 15/30. Took 0.13567 seconds. 
  Full-batch training loss = 0.123299, test loss = 0.239938
  Training set accuracy = 0.964800, Test set accuracy = 0.928000
 epoch 16/30. Took 0.13571 seconds. 
  Full-batch training loss = 0.107648, test loss = 0.230143
  Training set accuracy = 0.971000, Test set accuracy = 0.931400
 epoch 17/30. Took 0.14627 seconds. 
  Full-batch training loss = 0.109777, test loss = 0.240722
  Training set accuracy = 0.969000, Test set accuracy = 0.927600
 epoch 18/30. Took 0.13197 seconds. 
  Full-batch training loss = 0.099508, test loss = 0.232168
  Training set accuracy = 0.972000, Test set accuracy = 0.932100
 epoch 19/30. Took 0.13443 seconds. 
  Full-batch training loss = 0.093738, test loss = 0.242818
  Training set accuracy = 0.975200, Test set accuracy = 0.930200
 epoch 20/30. Took 0.13596 seconds. 
  Full-batch training loss = 0.088759, test loss = 0.234233
  Training set accuracy = 0.976400, Test set accuracy = 0.932500
 epoch 21/30. Took 0.1358 seconds. 
  Full-batch training loss = 0.086803, test loss = 0.243970
  Training set accuracy = 0.976000, Test set accuracy = 0.930700
 epoch 22/30. Took 0.13624 seconds. 
  Full-batch training loss = 0.080635, test loss = 0.233325
  Training set accuracy = 0.977800, Test set accuracy = 0.932400
 epoch 23/30. Took 0.13592 seconds. 
  Full-batch training loss = 0.073888, test loss = 0.227508
  Training set accuracy = 0.978600, Test set accuracy = 0.935500
 epoch 24/30. Took 0.13561 seconds. 
  Full-batch training loss = 0.068119, test loss = 0.224508
  Training set accuracy = 0.980400, Test set accuracy = 0.934800
 epoch 25/30. Took 0.13588 seconds. 
  Full-batch training loss = 0.065448, test loss = 0.230655
  Training set accuracy = 0.982800, Test set accuracy = 0.934800
 epoch 26/30. Took 0.13539 seconds. 
  Full-batch training loss = 0.071560, test loss = 0.231597
  Training set accuracy = 0.982600, Test set accuracy = 0.935400
 epoch 27/30. Took 0.13783 seconds. 
  Full-batch training loss = 0.057122, test loss = 0.232640
  Training set accuracy = 0.986000, Test set accuracy = 0.935200
 epoch 28/30. Took 0.13587 seconds. 
  Full-batch training loss = 0.053397, test loss = 0.227832
  Training set accuracy = 0.985800, Test set accuracy = 0.935400
 epoch 29/30. Took 0.13148 seconds. 
  Full-batch training loss = 0.053248, test loss = 0.230800
  Training set accuracy = 0.987400, Test set accuracy = 0.934400
 epoch 30/30. Took 0.12864 seconds. 
  Full-batch training loss = 0.048346, test loss = 0.227508
  Training set accuracy = 0.986000, Test set accuracy = 0.937700
Elapsed time is 9.422788 seconds.
End Training
-----
Params 5000 0.100 0.50 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.22656 seconds. 
  Full-batch training loss = 1.062600, test loss = 1.058083
  Training set accuracy = 0.753000, Test set accuracy = 0.756700
 epoch 2/30. Took 0.23198 seconds. 
  Full-batch training loss = 0.518086, test loss = 0.531494
  Training set accuracy = 0.858000, Test set accuracy = 0.853000
 epoch 3/30. Took 0.2257 seconds. 
  Full-batch training loss = 0.390385, test loss = 0.420068
  Training set accuracy = 0.886200, Test set accuracy = 0.875900
 epoch 4/30. Took 0.22366 seconds. 
  Full-batch training loss = 0.310062, test loss = 0.350956
  Training set accuracy = 0.909800, Test set accuracy = 0.901400
 epoch 5/30. Took 0.24521 seconds. 
  Full-batch training loss = 0.269902, test loss = 0.318086
  Training set accuracy = 0.924400, Test set accuracy = 0.905100
 epoch 6/30. Took 0.22696 seconds. 
  Full-batch training loss = 0.227837, test loss = 0.286592
  Training set accuracy = 0.936400, Test set accuracy = 0.914900
 epoch 7/30. Took 0.24542 seconds. 
  Full-batch training loss = 0.212729, test loss = 0.274555
  Training set accuracy = 0.937600, Test set accuracy = 0.917000
 epoch 8/30. Took 0.22179 seconds. 
  Full-batch training loss = 0.186493, test loss = 0.264612
  Training set accuracy = 0.946000, Test set accuracy = 0.921600
 epoch 9/30. Took 0.22887 seconds. 
  Full-batch training loss = 0.158034, test loss = 0.246072
  Training set accuracy = 0.956400, Test set accuracy = 0.928100
 epoch 10/30. Took 0.25163 seconds. 
  Full-batch training loss = 0.140528, test loss = 0.231489
  Training set accuracy = 0.961000, Test set accuracy = 0.930900
 epoch 11/30. Took 0.22491 seconds. 
  Full-batch training loss = 0.130359, test loss = 0.230492
  Training set accuracy = 0.961800, Test set accuracy = 0.931100
 epoch 12/30. Took 0.22694 seconds. 
  Full-batch training loss = 0.112174, test loss = 0.226580
  Training set accuracy = 0.967000, Test set accuracy = 0.933300
 epoch 13/30. Took 0.24056 seconds. 
  Full-batch training loss = 0.099457, test loss = 0.217115
  Training set accuracy = 0.970800, Test set accuracy = 0.934500
 epoch 14/30. Took 0.22754 seconds. 
  Full-batch training loss = 0.088076, test loss = 0.211938
  Training set accuracy = 0.974200, Test set accuracy = 0.935700
 epoch 15/30. Took 0.24265 seconds. 
  Full-batch training loss = 0.082252, test loss = 0.204158
  Training set accuracy = 0.976600, Test set accuracy = 0.940000
 epoch 16/30. Took 0.22777 seconds. 
  Full-batch training loss = 0.077236, test loss = 0.208400
  Training set accuracy = 0.976600, Test set accuracy = 0.938500
 epoch 17/30. Took 0.2217 seconds. 
  Full-batch training loss = 0.067129, test loss = 0.203498
  Training set accuracy = 0.981200, Test set accuracy = 0.939600
 epoch 18/30. Took 0.22338 seconds. 
  Full-batch training loss = 0.058738, test loss = 0.200928
  Training set accuracy = 0.984800, Test set accuracy = 0.942600
 epoch 19/30. Took 0.22784 seconds. 
  Full-batch training loss = 0.056367, test loss = 0.206125
  Training set accuracy = 0.984000, Test set accuracy = 0.940500
 epoch 20/30. Took 0.2268 seconds. 
  Full-batch training loss = 0.048590, test loss = 0.201199
  Training set accuracy = 0.986000, Test set accuracy = 0.940500
 epoch 21/30. Took 0.22648 seconds. 
  Full-batch training loss = 0.047950, test loss = 0.198214
  Training set accuracy = 0.987600, Test set accuracy = 0.942500
 epoch 22/30. Took 0.227 seconds. 
  Full-batch training loss = 0.041524, test loss = 0.195260
  Training set accuracy = 0.989200, Test set accuracy = 0.941000
 epoch 23/30. Took 0.22738 seconds. 
  Full-batch training loss = 0.035804, test loss = 0.188259
  Training set accuracy = 0.992000, Test set accuracy = 0.944300
 epoch 24/30. Took 0.22746 seconds. 
  Full-batch training loss = 0.033666, test loss = 0.193242
  Training set accuracy = 0.991000, Test set accuracy = 0.944400
 epoch 25/30. Took 0.22929 seconds. 
  Full-batch training loss = 0.032227, test loss = 0.198046
  Training set accuracy = 0.992600, Test set accuracy = 0.944000
 epoch 26/30. Took 0.22473 seconds. 
  Full-batch training loss = 0.028256, test loss = 0.200225
  Training set accuracy = 0.993200, Test set accuracy = 0.944900
 epoch 27/30. Took 0.22499 seconds. 
  Full-batch training loss = 0.027734, test loss = 0.206485
  Training set accuracy = 0.993800, Test set accuracy = 0.943800
 epoch 28/30. Took 0.21928 seconds. 
  Full-batch training loss = 0.022575, test loss = 0.196853
  Training set accuracy = 0.994800, Test set accuracy = 0.944600
 epoch 29/30. Took 0.21904 seconds. 
  Full-batch training loss = 0.025132, test loss = 0.209783
  Training set accuracy = 0.993600, Test set accuracy = 0.940300
 epoch 30/30. Took 0.22405 seconds. 
  Full-batch training loss = 0.025305, test loss = 0.202331
  Training set accuracy = 0.993200, Test set accuracy = 0.943800
Elapsed time is 15.233257 seconds.
End Training
-----
Params 5000 0.100 0.50 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.63448 seconds. 
  Full-batch training loss = 0.839733, test loss = 0.832672
  Training set accuracy = 0.795000, Test set accuracy = 0.786700
 epoch 2/30. Took 0.59214 seconds. 
  Full-batch training loss = 0.454541, test loss = 0.459601
  Training set accuracy = 0.874800, Test set accuracy = 0.864900
 epoch 3/30. Took 0.60093 seconds. 
  Full-batch training loss = 0.342307, test loss = 0.361449
  Training set accuracy = 0.902600, Test set accuracy = 0.896200
 epoch 4/30. Took 0.58792 seconds. 
  Full-batch training loss = 0.285891, test loss = 0.319582
  Training set accuracy = 0.917400, Test set accuracy = 0.904700
 epoch 5/30. Took 0.59326 seconds. 
  Full-batch training loss = 0.252021, test loss = 0.297191
  Training set accuracy = 0.927200, Test set accuracy = 0.910600
 epoch 6/30. Took 0.59171 seconds. 
  Full-batch training loss = 0.213534, test loss = 0.271354
  Training set accuracy = 0.938400, Test set accuracy = 0.917000
 epoch 7/30. Took 0.6112 seconds. 
  Full-batch training loss = 0.180963, test loss = 0.244575
  Training set accuracy = 0.948800, Test set accuracy = 0.925600
 epoch 8/30. Took 0.59268 seconds. 
  Full-batch training loss = 0.170173, test loss = 0.242176
  Training set accuracy = 0.952000, Test set accuracy = 0.923500
 epoch 9/30. Took 0.62848 seconds. 
  Full-batch training loss = 0.139118, test loss = 0.219615
  Training set accuracy = 0.960000, Test set accuracy = 0.932500
 epoch 10/30. Took 0.5906 seconds. 
  Full-batch training loss = 0.128490, test loss = 0.216253
  Training set accuracy = 0.963600, Test set accuracy = 0.931600
 epoch 11/30. Took 0.59063 seconds. 
  Full-batch training loss = 0.113352, test loss = 0.206379
  Training set accuracy = 0.969200, Test set accuracy = 0.934300
 epoch 12/30. Took 0.61397 seconds. 
  Full-batch training loss = 0.098602, test loss = 0.193864
  Training set accuracy = 0.973000, Test set accuracy = 0.938700
 epoch 13/30. Took 0.59465 seconds. 
  Full-batch training loss = 0.084033, test loss = 0.189526
  Training set accuracy = 0.977800, Test set accuracy = 0.939600
 epoch 14/30. Took 0.59747 seconds. 
  Full-batch training loss = 0.073230, test loss = 0.184919
  Training set accuracy = 0.982600, Test set accuracy = 0.943200
 epoch 15/30. Took 0.59101 seconds. 
  Full-batch training loss = 0.062902, test loss = 0.182240
  Training set accuracy = 0.984200, Test set accuracy = 0.943900
 epoch 16/30. Took 0.59064 seconds. 
  Full-batch training loss = 0.057849, test loss = 0.185043
  Training set accuracy = 0.985800, Test set accuracy = 0.943500
 epoch 17/30. Took 0.59242 seconds. 
  Full-batch training loss = 0.047479, test loss = 0.177866
  Training set accuracy = 0.989600, Test set accuracy = 0.945800
 epoch 18/30. Took 0.59645 seconds. 
  Full-batch training loss = 0.046359, test loss = 0.173622
  Training set accuracy = 0.991000, Test set accuracy = 0.946700
 epoch 19/30. Took 0.5935 seconds. 
  Full-batch training loss = 0.040552, test loss = 0.175776
  Training set accuracy = 0.991600, Test set accuracy = 0.945300
 epoch 20/30. Took 0.5914 seconds. 
  Full-batch training loss = 0.032677, test loss = 0.171176
  Training set accuracy = 0.994400, Test set accuracy = 0.948700
 epoch 21/30. Took 0.60655 seconds. 
  Full-batch training loss = 0.030790, test loss = 0.171635
  Training set accuracy = 0.993600, Test set accuracy = 0.949300
 epoch 22/30. Took 0.5969 seconds. 
  Full-batch training loss = 0.029121, test loss = 0.172447
  Training set accuracy = 0.995400, Test set accuracy = 0.949700
 epoch 23/30. Took 0.60542 seconds. 
  Full-batch training loss = 0.022333, test loss = 0.168408
  Training set accuracy = 0.996200, Test set accuracy = 0.949900
 epoch 24/30. Took 0.59324 seconds. 
  Full-batch training loss = 0.019825, test loss = 0.161513
  Training set accuracy = 0.996800, Test set accuracy = 0.951800
 epoch 25/30. Took 0.59113 seconds. 
  Full-batch training loss = 0.017546, test loss = 0.160037
  Training set accuracy = 0.997800, Test set accuracy = 0.954300
 epoch 26/30. Took 0.60226 seconds. 
  Full-batch training loss = 0.017468, test loss = 0.173118
  Training set accuracy = 0.998000, Test set accuracy = 0.949900
 epoch 27/30. Took 0.5924 seconds. 
  Full-batch training loss = 0.013156, test loss = 0.170356
  Training set accuracy = 0.998400, Test set accuracy = 0.952000
 epoch 28/30. Took 0.59165 seconds. 
  Full-batch training loss = 0.013853, test loss = 0.170906
  Training set accuracy = 0.998600, Test set accuracy = 0.950700
 epoch 29/30. Took 0.59693 seconds. 
  Full-batch training loss = 0.011696, test loss = 0.169908
  Training set accuracy = 0.998600, Test set accuracy = 0.952900
 epoch 30/30. Took 0.64246 seconds. 
  Full-batch training loss = 0.010836, test loss = 0.163407
  Training set accuracy = 0.999200, Test set accuracy = 0.954000
Elapsed time is 38.159843 seconds.
End Training
-----
Params 5000 0.100 0.50 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.16817 seconds. 
  Full-batch training loss = 2.202942, test loss = 2.204044
  Training set accuracy = 0.378800, Test set accuracy = 0.378100
 epoch 2/30. Took 0.15864 seconds. 
  Full-batch training loss = 1.383862, test loss = 1.386535
  Training set accuracy = 0.689800, Test set accuracy = 0.675900
 epoch 3/30. Took 0.15543 seconds. 
  Full-batch training loss = 0.803437, test loss = 0.823883
  Training set accuracy = 0.763000, Test set accuracy = 0.753900
 epoch 4/30. Took 0.15186 seconds. 
  Full-batch training loss = 0.581280, test loss = 0.614942
  Training set accuracy = 0.852800, Test set accuracy = 0.840900
 epoch 5/30. Took 0.1515 seconds. 
  Full-batch training loss = 0.461389, test loss = 0.510426
  Training set accuracy = 0.872200, Test set accuracy = 0.860800
 epoch 6/30. Took 0.15023 seconds. 
  Full-batch training loss = 0.384327, test loss = 0.440833
  Training set accuracy = 0.900800, Test set accuracy = 0.884200
 epoch 7/30. Took 0.15103 seconds. 
  Full-batch training loss = 0.335375, test loss = 0.405786
  Training set accuracy = 0.905800, Test set accuracy = 0.888100
 epoch 8/30. Took 0.16093 seconds. 
  Full-batch training loss = 0.293438, test loss = 0.377929
  Training set accuracy = 0.914200, Test set accuracy = 0.896700
 epoch 9/30. Took 0.15064 seconds. 
  Full-batch training loss = 0.252194, test loss = 0.359748
  Training set accuracy = 0.926200, Test set accuracy = 0.898900
 epoch 10/30. Took 0.15323 seconds. 
  Full-batch training loss = 0.228757, test loss = 0.329195
  Training set accuracy = 0.937000, Test set accuracy = 0.909300
 epoch 11/30. Took 0.1534 seconds. 
  Full-batch training loss = 0.207882, test loss = 0.324841
  Training set accuracy = 0.943800, Test set accuracy = 0.907600
 epoch 12/30. Took 0.15357 seconds. 
  Full-batch training loss = 0.199047, test loss = 0.322012
  Training set accuracy = 0.944600, Test set accuracy = 0.907000
 epoch 13/30. Took 0.14979 seconds. 
  Full-batch training loss = 0.176005, test loss = 0.303870
  Training set accuracy = 0.950200, Test set accuracy = 0.913000
 epoch 14/30. Took 0.15605 seconds. 
  Full-batch training loss = 0.154595, test loss = 0.294625
  Training set accuracy = 0.954800, Test set accuracy = 0.918800
 epoch 15/30. Took 0.15369 seconds. 
  Full-batch training loss = 0.145067, test loss = 0.296086
  Training set accuracy = 0.957200, Test set accuracy = 0.919700
 epoch 16/30. Took 0.16024 seconds. 
  Full-batch training loss = 0.137562, test loss = 0.287726
  Training set accuracy = 0.961000, Test set accuracy = 0.921100
 epoch 17/30. Took 0.15073 seconds. 
  Full-batch training loss = 0.121981, test loss = 0.307907
  Training set accuracy = 0.964800, Test set accuracy = 0.919000
 epoch 18/30. Took 0.16109 seconds. 
  Full-batch training loss = 0.120227, test loss = 0.291772
  Training set accuracy = 0.965000, Test set accuracy = 0.922900
 epoch 19/30. Took 0.15088 seconds. 
  Full-batch training loss = 0.121440, test loss = 0.299150
  Training set accuracy = 0.963600, Test set accuracy = 0.923200
 epoch 20/30. Took 0.1547 seconds. 
  Full-batch training loss = 0.102224, test loss = 0.272496
  Training set accuracy = 0.971600, Test set accuracy = 0.924900
 epoch 21/30. Took 0.16106 seconds. 
  Full-batch training loss = 0.099222, test loss = 0.275527
  Training set accuracy = 0.972800, Test set accuracy = 0.926200
 epoch 22/30. Took 0.16059 seconds. 
  Full-batch training loss = 0.087583, test loss = 0.277981
  Training set accuracy = 0.977000, Test set accuracy = 0.926600
 epoch 23/30. Took 0.16128 seconds. 
  Full-batch training loss = 0.091402, test loss = 0.297369
  Training set accuracy = 0.976600, Test set accuracy = 0.923800
 epoch 24/30. Took 0.15093 seconds. 
  Full-batch training loss = 0.078273, test loss = 0.281227
  Training set accuracy = 0.978000, Test set accuracy = 0.929800
 epoch 25/30. Took 0.15548 seconds. 
  Full-batch training loss = 0.076520, test loss = 0.298976
  Training set accuracy = 0.981000, Test set accuracy = 0.926500
 epoch 26/30. Took 0.16433 seconds. 
  Full-batch training loss = 0.064979, test loss = 0.275742
  Training set accuracy = 0.983200, Test set accuracy = 0.930600
 epoch 27/30. Took 0.16191 seconds. 
  Full-batch training loss = 0.071257, test loss = 0.287252
  Training set accuracy = 0.979600, Test set accuracy = 0.928200
 epoch 28/30. Took 0.16055 seconds. 
  Full-batch training loss = 0.060522, test loss = 0.284838
  Training set accuracy = 0.984800, Test set accuracy = 0.929600
 epoch 29/30. Took 0.16153 seconds. 
  Full-batch training loss = 0.067390, test loss = 0.270385
  Training set accuracy = 0.983000, Test set accuracy = 0.930000
 epoch 30/30. Took 0.16129 seconds. 
  Full-batch training loss = 0.055575, test loss = 0.295625
  Training set accuracy = 0.986200, Test set accuracy = 0.931600
Elapsed time is 10.665003 seconds.
End Training
-----
Params 5000 0.100 0.50 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27628 seconds. 
  Full-batch training loss = 2.232423, test loss = 2.233028
  Training set accuracy = 0.382200, Test set accuracy = 0.380500
 epoch 2/30. Took 0.27859 seconds. 
  Full-batch training loss = 1.345803, test loss = 1.357304
  Training set accuracy = 0.613000, Test set accuracy = 0.614400
 epoch 3/30. Took 0.27939 seconds. 
  Full-batch training loss = 0.659015, test loss = 0.688986
  Training set accuracy = 0.789200, Test set accuracy = 0.777800
 epoch 4/30. Took 0.2816 seconds. 
  Full-batch training loss = 0.456447, test loss = 0.500947
  Training set accuracy = 0.863800, Test set accuracy = 0.850900
 epoch 5/30. Took 0.28026 seconds. 
  Full-batch training loss = 0.388278, test loss = 0.439389
  Training set accuracy = 0.887600, Test set accuracy = 0.872800
 epoch 6/30. Took 0.29686 seconds. 
  Full-batch training loss = 0.308965, test loss = 0.385679
  Training set accuracy = 0.908800, Test set accuracy = 0.883400
 epoch 7/30. Took 0.27179 seconds. 
  Full-batch training loss = 0.274943, test loss = 0.350811
  Training set accuracy = 0.920800, Test set accuracy = 0.899100
 epoch 8/30. Took 0.28188 seconds. 
  Full-batch training loss = 0.233194, test loss = 0.326236
  Training set accuracy = 0.928600, Test set accuracy = 0.902600
 epoch 9/30. Took 0.28246 seconds. 
  Full-batch training loss = 0.204364, test loss = 0.304133
  Training set accuracy = 0.941200, Test set accuracy = 0.910100
 epoch 10/30. Took 0.30057 seconds. 
  Full-batch training loss = 0.180075, test loss = 0.277424
  Training set accuracy = 0.946600, Test set accuracy = 0.917500
 epoch 11/30. Took 0.28155 seconds. 
  Full-batch training loss = 0.160949, test loss = 0.267645
  Training set accuracy = 0.953400, Test set accuracy = 0.919300
 epoch 12/30. Took 0.27968 seconds. 
  Full-batch training loss = 0.147119, test loss = 0.262261
  Training set accuracy = 0.957400, Test set accuracy = 0.924500
 epoch 13/30. Took 0.28033 seconds. 
  Full-batch training loss = 0.136037, test loss = 0.254758
  Training set accuracy = 0.962400, Test set accuracy = 0.924100
 epoch 14/30. Took 0.32627 seconds. 
  Full-batch training loss = 0.123095, test loss = 0.252386
  Training set accuracy = 0.966200, Test set accuracy = 0.925600
 epoch 15/30. Took 0.29905 seconds. 
  Full-batch training loss = 0.103420, test loss = 0.240052
  Training set accuracy = 0.970000, Test set accuracy = 0.931200
 epoch 16/30. Took 0.28152 seconds. 
  Full-batch training loss = 0.105118, test loss = 0.259400
  Training set accuracy = 0.969800, Test set accuracy = 0.924400
 epoch 17/30. Took 0.28147 seconds. 
  Full-batch training loss = 0.094006, test loss = 0.247777
  Training set accuracy = 0.972200, Test set accuracy = 0.929100
 epoch 18/30. Took 0.28083 seconds. 
  Full-batch training loss = 0.081398, test loss = 0.243597
  Training set accuracy = 0.976200, Test set accuracy = 0.929800
 epoch 19/30. Took 0.2788 seconds. 
  Full-batch training loss = 0.072327, test loss = 0.238554
  Training set accuracy = 0.979800, Test set accuracy = 0.934600
 epoch 20/30. Took 0.28082 seconds. 
  Full-batch training loss = 0.072094, test loss = 0.254445
  Training set accuracy = 0.977600, Test set accuracy = 0.931000
 epoch 21/30. Took 0.29177 seconds. 
  Full-batch training loss = 0.064632, test loss = 0.228028
  Training set accuracy = 0.980800, Test set accuracy = 0.937300
 epoch 22/30. Took 0.28032 seconds. 
  Full-batch training loss = 0.054503, test loss = 0.236858
  Training set accuracy = 0.984000, Test set accuracy = 0.937100
 epoch 23/30. Took 0.28249 seconds. 
  Full-batch training loss = 0.051338, test loss = 0.224011
  Training set accuracy = 0.985600, Test set accuracy = 0.939700
 epoch 24/30. Took 0.27697 seconds. 
  Full-batch training loss = 0.048254, test loss = 0.230905
  Training set accuracy = 0.986000, Test set accuracy = 0.935900
 epoch 25/30. Took 0.28209 seconds. 
  Full-batch training loss = 0.044682, test loss = 0.234566
  Training set accuracy = 0.986000, Test set accuracy = 0.939000
 epoch 26/30. Took 0.27621 seconds. 
  Full-batch training loss = 0.049450, test loss = 0.242268
  Training set accuracy = 0.985400, Test set accuracy = 0.939200
 epoch 27/30. Took 0.27747 seconds. 
  Full-batch training loss = 0.035216, test loss = 0.216500
  Training set accuracy = 0.989400, Test set accuracy = 0.942900
 epoch 28/30. Took 0.27256 seconds. 
  Full-batch training loss = 0.037571, test loss = 0.252070
  Training set accuracy = 0.988200, Test set accuracy = 0.939100
 epoch 29/30. Took 0.28028 seconds. 
  Full-batch training loss = 0.030762, test loss = 0.227763
  Training set accuracy = 0.991000, Test set accuracy = 0.942500
 epoch 30/30. Took 0.31482 seconds. 
  Full-batch training loss = 0.026325, test loss = 0.227866
  Training set accuracy = 0.993000, Test set accuracy = 0.941500
Elapsed time is 18.579431 seconds.
End Training
-----
Params 5000 0.100 0.50 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.87081 seconds. 
  Full-batch training loss = 2.169240, test loss = 2.170028
  Training set accuracy = 0.359600, Test set accuracy = 0.352200
 epoch 2/30. Took 0.82097 seconds. 
  Full-batch training loss = 0.916661, test loss = 0.914263
  Training set accuracy = 0.724600, Test set accuracy = 0.714500
 epoch 3/30. Took 0.82218 seconds. 
  Full-batch training loss = 0.535320, test loss = 0.532083
  Training set accuracy = 0.834600, Test set accuracy = 0.836500
 epoch 4/30. Took 0.82199 seconds. 
  Full-batch training loss = 0.398348, test loss = 0.415352
  Training set accuracy = 0.886600, Test set accuracy = 0.872500
 epoch 5/30. Took 0.87828 seconds. 
  Full-batch training loss = 0.318653, test loss = 0.352048
  Training set accuracy = 0.903200, Test set accuracy = 0.893200
 epoch 6/30. Took 0.82376 seconds. 
  Full-batch training loss = 0.272165, test loss = 0.313815
  Training set accuracy = 0.920000, Test set accuracy = 0.906800
 epoch 7/30. Took 0.83674 seconds. 
  Full-batch training loss = 0.232898, test loss = 0.282404
  Training set accuracy = 0.926200, Test set accuracy = 0.911500
 epoch 8/30. Took 0.82103 seconds. 
  Full-batch training loss = 0.192595, test loss = 0.262864
  Training set accuracy = 0.943200, Test set accuracy = 0.920800
 epoch 9/30. Took 0.81822 seconds. 
  Full-batch training loss = 0.188821, test loss = 0.272490
  Training set accuracy = 0.942000, Test set accuracy = 0.918700
 epoch 10/30. Took 0.85051 seconds. 
  Full-batch training loss = 0.143653, test loss = 0.237486
  Training set accuracy = 0.957600, Test set accuracy = 0.930600
 epoch 11/30. Took 0.82226 seconds. 
  Full-batch training loss = 0.131123, test loss = 0.249525
  Training set accuracy = 0.959600, Test set accuracy = 0.923500
 epoch 12/30. Took 0.82989 seconds. 
  Full-batch training loss = 0.111333, test loss = 0.220817
  Training set accuracy = 0.968800, Test set accuracy = 0.933000
 epoch 13/30. Took 0.81913 seconds. 
  Full-batch training loss = 0.094789, test loss = 0.215555
  Training set accuracy = 0.970000, Test set accuracy = 0.935300
 epoch 14/30. Took 0.86199 seconds. 
  Full-batch training loss = 0.078235, test loss = 0.204817
  Training set accuracy = 0.976800, Test set accuracy = 0.939700
 epoch 15/30. Took 0.82032 seconds. 
  Full-batch training loss = 0.065971, test loss = 0.205718
  Training set accuracy = 0.981000, Test set accuracy = 0.937600
 epoch 16/30. Took 0.85987 seconds. 
  Full-batch training loss = 0.063859, test loss = 0.200074
  Training set accuracy = 0.981800, Test set accuracy = 0.942100
 epoch 17/30. Took 0.82275 seconds. 
  Full-batch training loss = 0.049380, test loss = 0.203626
  Training set accuracy = 0.985600, Test set accuracy = 0.944200
 epoch 18/30. Took 0.82475 seconds. 
  Full-batch training loss = 0.044886, test loss = 0.207608
  Training set accuracy = 0.987000, Test set accuracy = 0.942500
 epoch 19/30. Took 0.86148 seconds. 
  Full-batch training loss = 0.033870, test loss = 0.193695
  Training set accuracy = 0.992000, Test set accuracy = 0.945300
 epoch 20/30. Took 0.81974 seconds. 
  Full-batch training loss = 0.041462, test loss = 0.209625
  Training set accuracy = 0.988800, Test set accuracy = 0.940000
 epoch 21/30. Took 0.81891 seconds. 
  Full-batch training loss = 0.026064, test loss = 0.190467
  Training set accuracy = 0.993800, Test set accuracy = 0.947300
 epoch 22/30. Took 0.82452 seconds. 
  Full-batch training loss = 0.025077, test loss = 0.203314
  Training set accuracy = 0.994800, Test set accuracy = 0.947300
 epoch 23/30. Took 0.82228 seconds. 
  Full-batch training loss = 0.018739, test loss = 0.201646
  Training set accuracy = 0.995600, Test set accuracy = 0.946100
 epoch 24/30. Took 0.82449 seconds. 
  Full-batch training loss = 0.020004, test loss = 0.206907
  Training set accuracy = 0.994800, Test set accuracy = 0.947200
 epoch 25/30. Took 0.83766 seconds. 
  Full-batch training loss = 0.015860, test loss = 0.196575
  Training set accuracy = 0.996800, Test set accuracy = 0.948700
 epoch 26/30. Took 0.85166 seconds. 
  Full-batch training loss = 0.014533, test loss = 0.202413
  Training set accuracy = 0.996800, Test set accuracy = 0.949200
 epoch 27/30. Took 0.92807 seconds. 
  Full-batch training loss = 0.016345, test loss = 0.208140
  Training set accuracy = 0.996600, Test set accuracy = 0.946300
 epoch 28/30. Took 0.93131 seconds. 
  Full-batch training loss = 0.009216, test loss = 0.198298
  Training set accuracy = 0.998200, Test set accuracy = 0.951100
 epoch 29/30. Took 0.86768 seconds. 
  Full-batch training loss = 0.010368, test loss = 0.213128
  Training set accuracy = 0.997600, Test set accuracy = 0.946000
 epoch 30/30. Took 0.8874 seconds. 
  Full-batch training loss = 0.009641, test loss = 0.204435
  Training set accuracy = 0.998600, Test set accuracy = 0.947000
Elapsed time is 52.688536 seconds.
End Training
-----
Params 5000 0.010 0.00 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.10503 seconds. 
  Full-batch training loss = 1.403520, test loss = 1.401811
  Training set accuracy = 0.719800, Test set accuracy = 0.731700
 epoch 2/30. Took 0.10455 seconds. 
  Full-batch training loss = 0.809734, test loss = 0.797433
  Training set accuracy = 0.820800, Test set accuracy = 0.832300
 epoch 3/30. Took 0.09734 seconds. 
  Full-batch training loss = 0.613245, test loss = 0.599077
  Training set accuracy = 0.845400, Test set accuracy = 0.858300
 epoch 4/30. Took 0.095187 seconds. 
  Full-batch training loss = 0.513183, test loss = 0.504387
  Training set accuracy = 0.869200, Test set accuracy = 0.877300
 epoch 5/30. Took 0.096373 seconds. 
  Full-batch training loss = 0.456091, test loss = 0.450371
  Training set accuracy = 0.880200, Test set accuracy = 0.885700
 epoch 6/30. Took 0.098166 seconds. 
  Full-batch training loss = 0.418162, test loss = 0.417275
  Training set accuracy = 0.887600, Test set accuracy = 0.890300
 epoch 7/30. Took 0.097134 seconds. 
  Full-batch training loss = 0.389450, test loss = 0.394139
  Training set accuracy = 0.891000, Test set accuracy = 0.894800
 epoch 8/30. Took 0.097034 seconds. 
  Full-batch training loss = 0.368123, test loss = 0.376055
  Training set accuracy = 0.895000, Test set accuracy = 0.899400
 epoch 9/30. Took 0.09684 seconds. 
  Full-batch training loss = 0.350169, test loss = 0.362817
  Training set accuracy = 0.899600, Test set accuracy = 0.901500
 epoch 10/30. Took 0.097455 seconds. 
  Full-batch training loss = 0.334897, test loss = 0.351686
  Training set accuracy = 0.904400, Test set accuracy = 0.900900
 epoch 11/30. Took 0.096735 seconds. 
  Full-batch training loss = 0.321914, test loss = 0.341757
  Training set accuracy = 0.909000, Test set accuracy = 0.905200
 epoch 12/30. Took 0.097072 seconds. 
  Full-batch training loss = 0.309748, test loss = 0.333397
  Training set accuracy = 0.911200, Test set accuracy = 0.907200
 epoch 13/30. Took 0.097881 seconds. 
  Full-batch training loss = 0.298005, test loss = 0.325594
  Training set accuracy = 0.914800, Test set accuracy = 0.908400
 epoch 14/30. Took 0.10529 seconds. 
  Full-batch training loss = 0.288863, test loss = 0.320986
  Training set accuracy = 0.918000, Test set accuracy = 0.909900
 epoch 15/30. Took 0.095297 seconds. 
  Full-batch training loss = 0.284941, test loss = 0.322356
  Training set accuracy = 0.918400, Test set accuracy = 0.908900
 epoch 16/30. Took 0.096814 seconds. 
  Full-batch training loss = 0.271757, test loss = 0.308597
  Training set accuracy = 0.922800, Test set accuracy = 0.913500
 epoch 17/30. Took 0.096582 seconds. 
  Full-batch training loss = 0.264895, test loss = 0.307367
  Training set accuracy = 0.926000, Test set accuracy = 0.912400
 epoch 18/30. Took 0.097582 seconds. 
  Full-batch training loss = 0.258253, test loss = 0.301758
  Training set accuracy = 0.929800, Test set accuracy = 0.914000
 epoch 19/30. Took 0.098192 seconds. 
  Full-batch training loss = 0.250103, test loss = 0.296882
  Training set accuracy = 0.929200, Test set accuracy = 0.915500
 epoch 20/30. Took 0.095004 seconds. 
  Full-batch training loss = 0.244754, test loss = 0.297534
  Training set accuracy = 0.933400, Test set accuracy = 0.916300
 epoch 21/30. Took 0.096392 seconds. 
  Full-batch training loss = 0.236995, test loss = 0.291818
  Training set accuracy = 0.934400, Test set accuracy = 0.917600
 epoch 22/30. Took 0.096811 seconds. 
  Full-batch training loss = 0.232495, test loss = 0.289196
  Training set accuracy = 0.936000, Test set accuracy = 0.919700
 epoch 23/30. Took 0.10038 seconds. 
  Full-batch training loss = 0.225658, test loss = 0.283857
  Training set accuracy = 0.938800, Test set accuracy = 0.920600
 epoch 24/30. Took 0.095396 seconds. 
  Full-batch training loss = 0.221056, test loss = 0.282710
  Training set accuracy = 0.940800, Test set accuracy = 0.920800
 epoch 25/30. Took 0.09714 seconds. 
  Full-batch training loss = 0.214595, test loss = 0.277415
  Training set accuracy = 0.940200, Test set accuracy = 0.921500
 epoch 26/30. Took 0.098343 seconds. 
  Full-batch training loss = 0.210037, test loss = 0.277117
  Training set accuracy = 0.941800, Test set accuracy = 0.921300
 epoch 27/30. Took 0.1007 seconds. 
  Full-batch training loss = 0.207727, test loss = 0.276820
  Training set accuracy = 0.944200, Test set accuracy = 0.920700
 epoch 28/30. Took 0.095401 seconds. 
  Full-batch training loss = 0.202286, test loss = 0.277191
  Training set accuracy = 0.944800, Test set accuracy = 0.921100
 epoch 29/30. Took 0.097279 seconds. 
  Full-batch training loss = 0.198146, test loss = 0.272953
  Training set accuracy = 0.944800, Test set accuracy = 0.921600
 epoch 30/30. Took 0.097226 seconds. 
  Full-batch training loss = 0.192995, test loss = 0.267690
  Training set accuracy = 0.948200, Test set accuracy = 0.923900
Elapsed time is 7.569295 seconds.
End Training
-----
Params 5000 0.010 0.00 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17255 seconds. 
  Full-batch training loss = 1.188861, test loss = 1.187171
  Training set accuracy = 0.786400, Test set accuracy = 0.783700
 epoch 2/30. Took 0.14565 seconds. 
  Full-batch training loss = 0.717516, test loss = 0.717646
  Training set accuracy = 0.838400, Test set accuracy = 0.838800
 epoch 3/30. Took 0.14864 seconds. 
  Full-batch training loss = 0.557555, test loss = 0.561054
  Training set accuracy = 0.864400, Test set accuracy = 0.862700
 epoch 4/30. Took 0.14599 seconds. 
  Full-batch training loss = 0.481480, test loss = 0.488922
  Training set accuracy = 0.882600, Test set accuracy = 0.875400
 epoch 5/30. Took 0.14758 seconds. 
  Full-batch training loss = 0.434178, test loss = 0.446864
  Training set accuracy = 0.887200, Test set accuracy = 0.882000
 epoch 6/30. Took 0.14666 seconds. 
  Full-batch training loss = 0.395912, test loss = 0.409616
  Training set accuracy = 0.896400, Test set accuracy = 0.891900
 epoch 7/30. Took 0.16322 seconds. 
  Full-batch training loss = 0.371400, test loss = 0.389815
  Training set accuracy = 0.902400, Test set accuracy = 0.893900
 epoch 8/30. Took 0.15425 seconds. 
  Full-batch training loss = 0.349617, test loss = 0.370401
  Training set accuracy = 0.905800, Test set accuracy = 0.899500
 epoch 9/30. Took 0.15787 seconds. 
  Full-batch training loss = 0.333428, test loss = 0.356814
  Training set accuracy = 0.911200, Test set accuracy = 0.902600
 epoch 10/30. Took 0.14541 seconds. 
  Full-batch training loss = 0.318359, test loss = 0.346070
  Training set accuracy = 0.915200, Test set accuracy = 0.904700
 epoch 11/30. Took 0.14782 seconds. 
  Full-batch training loss = 0.306576, test loss = 0.337242
  Training set accuracy = 0.916000, Test set accuracy = 0.907200
 epoch 12/30. Took 0.14789 seconds. 
  Full-batch training loss = 0.296779, test loss = 0.330630
  Training set accuracy = 0.922000, Test set accuracy = 0.909300
 epoch 13/30. Took 0.14609 seconds. 
  Full-batch training loss = 0.285934, test loss = 0.323191
  Training set accuracy = 0.923600, Test set accuracy = 0.910800
 epoch 14/30. Took 0.15842 seconds. 
  Full-batch training loss = 0.277814, test loss = 0.318432
  Training set accuracy = 0.923600, Test set accuracy = 0.910800
 epoch 15/30. Took 0.14607 seconds. 
  Full-batch training loss = 0.269303, test loss = 0.313644
  Training set accuracy = 0.927800, Test set accuracy = 0.913400
 epoch 16/30. Took 0.15835 seconds. 
  Full-batch training loss = 0.265941, test loss = 0.313052
  Training set accuracy = 0.929000, Test set accuracy = 0.912000
 epoch 17/30. Took 0.14793 seconds. 
  Full-batch training loss = 0.253872, test loss = 0.304127
  Training set accuracy = 0.932200, Test set accuracy = 0.914800
 epoch 18/30. Took 0.14689 seconds. 
  Full-batch training loss = 0.247953, test loss = 0.301287
  Training set accuracy = 0.931800, Test set accuracy = 0.914700
 epoch 19/30. Took 0.14751 seconds. 
  Full-batch training loss = 0.241387, test loss = 0.296658
  Training set accuracy = 0.934600, Test set accuracy = 0.916100
 epoch 20/30. Took 0.1481 seconds. 
  Full-batch training loss = 0.235899, test loss = 0.294337
  Training set accuracy = 0.938000, Test set accuracy = 0.916200
 epoch 21/30. Took 0.14652 seconds. 
  Full-batch training loss = 0.230365, test loss = 0.291463
  Training set accuracy = 0.939600, Test set accuracy = 0.917300
 epoch 22/30. Took 0.14683 seconds. 
  Full-batch training loss = 0.225036, test loss = 0.288655
  Training set accuracy = 0.941800, Test set accuracy = 0.917200
 epoch 23/30. Took 0.14805 seconds. 
  Full-batch training loss = 0.219252, test loss = 0.286176
  Training set accuracy = 0.945000, Test set accuracy = 0.918900
 epoch 24/30. Took 0.14688 seconds. 
  Full-batch training loss = 0.215973, test loss = 0.285361
  Training set accuracy = 0.943600, Test set accuracy = 0.917900
 epoch 25/30. Took 0.14803 seconds. 
  Full-batch training loss = 0.210402, test loss = 0.283111
  Training set accuracy = 0.946400, Test set accuracy = 0.918500
 epoch 26/30. Took 0.14784 seconds. 
  Full-batch training loss = 0.204760, test loss = 0.279479
  Training set accuracy = 0.949600, Test set accuracy = 0.920700
 epoch 27/30. Took 0.14975 seconds. 
  Full-batch training loss = 0.198828, test loss = 0.276093
  Training set accuracy = 0.950600, Test set accuracy = 0.922000
 epoch 28/30. Took 0.14765 seconds. 
  Full-batch training loss = 0.197242, test loss = 0.277454
  Training set accuracy = 0.951600, Test set accuracy = 0.920600
 epoch 29/30. Took 0.14925 seconds. 
  Full-batch training loss = 0.191737, test loss = 0.273054
  Training set accuracy = 0.953200, Test set accuracy = 0.922700
 epoch 30/30. Took 0.16489 seconds. 
  Full-batch training loss = 0.187989, test loss = 0.271532
  Training set accuracy = 0.953400, Test set accuracy = 0.922000
Elapsed time is 11.221067 seconds.
End Training
-----
Params 5000 0.010 0.00 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32143 seconds. 
  Full-batch training loss = 1.139040, test loss = 1.129813
  Training set accuracy = 0.795000, Test set accuracy = 0.806500
 epoch 2/30. Took 0.31758 seconds. 
  Full-batch training loss = 0.706557, test loss = 0.688880
  Training set accuracy = 0.843600, Test set accuracy = 0.850900
 epoch 3/30. Took 0.31667 seconds. 
  Full-batch training loss = 0.559431, test loss = 0.541914
  Training set accuracy = 0.867000, Test set accuracy = 0.870800
 epoch 4/30. Took 0.31664 seconds. 
  Full-batch training loss = 0.483639, test loss = 0.468193
  Training set accuracy = 0.877600, Test set accuracy = 0.882400
 epoch 5/30. Took 0.3165 seconds. 
  Full-batch training loss = 0.436488, test loss = 0.428113
  Training set accuracy = 0.884800, Test set accuracy = 0.887400
 epoch 6/30. Took 0.31571 seconds. 
  Full-batch training loss = 0.403548, test loss = 0.397714
  Training set accuracy = 0.894600, Test set accuracy = 0.895500
 epoch 7/30. Took 0.31638 seconds. 
  Full-batch training loss = 0.380945, test loss = 0.379100
  Training set accuracy = 0.904000, Test set accuracy = 0.899000
 epoch 8/30. Took 0.31668 seconds. 
  Full-batch training loss = 0.359695, test loss = 0.363354
  Training set accuracy = 0.908200, Test set accuracy = 0.900500
 epoch 9/30. Took 0.31702 seconds. 
  Full-batch training loss = 0.343036, test loss = 0.351791
  Training set accuracy = 0.910800, Test set accuracy = 0.903400
 epoch 10/30. Took 0.31587 seconds. 
  Full-batch training loss = 0.331099, test loss = 0.342282
  Training set accuracy = 0.913400, Test set accuracy = 0.905000
 epoch 11/30. Took 0.31742 seconds. 
  Full-batch training loss = 0.317593, test loss = 0.332495
  Training set accuracy = 0.917800, Test set accuracy = 0.907400
 epoch 12/30. Took 0.33756 seconds. 
  Full-batch training loss = 0.305238, test loss = 0.324075
  Training set accuracy = 0.922200, Test set accuracy = 0.909600
 epoch 13/30. Took 0.31851 seconds. 
  Full-batch training loss = 0.297672, test loss = 0.321539
  Training set accuracy = 0.922200, Test set accuracy = 0.909700
 epoch 14/30. Took 0.31917 seconds. 
  Full-batch training loss = 0.287175, test loss = 0.314259
  Training set accuracy = 0.926200, Test set accuracy = 0.913200
 epoch 15/30. Took 0.35202 seconds. 
  Full-batch training loss = 0.277519, test loss = 0.307471
  Training set accuracy = 0.929400, Test set accuracy = 0.911400
 epoch 16/30. Took 0.32064 seconds. 
  Full-batch training loss = 0.270451, test loss = 0.304048
  Training set accuracy = 0.931200, Test set accuracy = 0.913000
 epoch 17/30. Took 0.31611 seconds. 
  Full-batch training loss = 0.263050, test loss = 0.298153
  Training set accuracy = 0.931600, Test set accuracy = 0.915600
 epoch 18/30. Took 0.31659 seconds. 
  Full-batch training loss = 0.256082, test loss = 0.294843
  Training set accuracy = 0.932000, Test set accuracy = 0.915200
 epoch 19/30. Took 0.31626 seconds. 
  Full-batch training loss = 0.249246, test loss = 0.289519
  Training set accuracy = 0.935400, Test set accuracy = 0.915800
 epoch 20/30. Took 0.32284 seconds. 
  Full-batch training loss = 0.242991, test loss = 0.288688
  Training set accuracy = 0.936400, Test set accuracy = 0.916300
 epoch 21/30. Took 0.31488 seconds. 
  Full-batch training loss = 0.236797, test loss = 0.284837
  Training set accuracy = 0.939000, Test set accuracy = 0.918200
 epoch 22/30. Took 0.35197 seconds. 
  Full-batch training loss = 0.230868, test loss = 0.279674
  Training set accuracy = 0.942200, Test set accuracy = 0.919000
 epoch 23/30. Took 0.31489 seconds. 
  Full-batch training loss = 0.226253, test loss = 0.278239
  Training set accuracy = 0.944400, Test set accuracy = 0.919500
 epoch 24/30. Took 0.36838 seconds. 
  Full-batch training loss = 0.223614, test loss = 0.278309
  Training set accuracy = 0.942800, Test set accuracy = 0.918600
 epoch 25/30. Took 0.31446 seconds. 
  Full-batch training loss = 0.214256, test loss = 0.273155
  Training set accuracy = 0.945800, Test set accuracy = 0.919700
 epoch 26/30. Took 0.31481 seconds. 
  Full-batch training loss = 0.210949, test loss = 0.271425
  Training set accuracy = 0.945000, Test set accuracy = 0.921000
 epoch 27/30. Took 0.31937 seconds. 
  Full-batch training loss = 0.204337, test loss = 0.267270
  Training set accuracy = 0.949200, Test set accuracy = 0.922900
 epoch 28/30. Took 0.33404 seconds. 
  Full-batch training loss = 0.200190, test loss = 0.265006
  Training set accuracy = 0.948600, Test set accuracy = 0.922900
 epoch 29/30. Took 0.31532 seconds. 
  Full-batch training loss = 0.195417, test loss = 0.265443
  Training set accuracy = 0.950200, Test set accuracy = 0.922300
 epoch 30/30. Took 0.3166 seconds. 
  Full-batch training loss = 0.191834, test loss = 0.262063
  Training set accuracy = 0.952200, Test set accuracy = 0.922900
Elapsed time is 21.531581 seconds.
End Training
-----
Params 5000 0.010 0.00 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11605 seconds. 
  Full-batch training loss = 1.582922, test loss = 1.573386
  Training set accuracy = 0.692200, Test set accuracy = 0.691200
 epoch 2/30. Took 0.11042 seconds. 
  Full-batch training loss = 0.786317, test loss = 0.772885
  Training set accuracy = 0.822400, Test set accuracy = 0.818800
 epoch 3/30. Took 0.1116 seconds. 
  Full-batch training loss = 0.551211, test loss = 0.549059
  Training set accuracy = 0.855200, Test set accuracy = 0.847000
 epoch 4/30. Took 0.11169 seconds. 
  Full-batch training loss = 0.453357, test loss = 0.458620
  Training set accuracy = 0.885400, Test set accuracy = 0.874100
 epoch 5/30. Took 0.11331 seconds. 
  Full-batch training loss = 0.392683, test loss = 0.406050
  Training set accuracy = 0.898400, Test set accuracy = 0.886200
 epoch 6/30. Took 0.11202 seconds. 
  Full-batch training loss = 0.353979, test loss = 0.373723
  Training set accuracy = 0.906200, Test set accuracy = 0.893700
 epoch 7/30. Took 0.11111 seconds. 
  Full-batch training loss = 0.325669, test loss = 0.351976
  Training set accuracy = 0.910800, Test set accuracy = 0.901700
 epoch 8/30. Took 0.12199 seconds. 
  Full-batch training loss = 0.303808, test loss = 0.338559
  Training set accuracy = 0.915600, Test set accuracy = 0.902900
 epoch 9/30. Took 0.11069 seconds. 
  Full-batch training loss = 0.291195, test loss = 0.330338
  Training set accuracy = 0.917200, Test set accuracy = 0.904300
 epoch 10/30. Took 0.11725 seconds. 
  Full-batch training loss = 0.271009, test loss = 0.314475
  Training set accuracy = 0.922600, Test set accuracy = 0.910000
 epoch 11/30. Took 0.11094 seconds. 
  Full-batch training loss = 0.261998, test loss = 0.316041
  Training set accuracy = 0.926000, Test set accuracy = 0.908800
 epoch 12/30. Took 0.11185 seconds. 
  Full-batch training loss = 0.245073, test loss = 0.301809
  Training set accuracy = 0.930800, Test set accuracy = 0.912900
 epoch 13/30. Took 0.1085 seconds. 
  Full-batch training loss = 0.238987, test loss = 0.301045
  Training set accuracy = 0.932000, Test set accuracy = 0.911100
 epoch 14/30. Took 0.1102 seconds. 
  Full-batch training loss = 0.227544, test loss = 0.295032
  Training set accuracy = 0.933800, Test set accuracy = 0.914300
 epoch 15/30. Took 0.1117 seconds. 
  Full-batch training loss = 0.217358, test loss = 0.288977
  Training set accuracy = 0.939400, Test set accuracy = 0.916900
 epoch 16/30. Took 0.10825 seconds. 
  Full-batch training loss = 0.203713, test loss = 0.278700
  Training set accuracy = 0.942400, Test set accuracy = 0.918700
 epoch 17/30. Took 0.11062 seconds. 
  Full-batch training loss = 0.195505, test loss = 0.277510
  Training set accuracy = 0.946400, Test set accuracy = 0.919500
 epoch 18/30. Took 0.11193 seconds. 
  Full-batch training loss = 0.192824, test loss = 0.280107
  Training set accuracy = 0.941400, Test set accuracy = 0.918500
 epoch 19/30. Took 0.11162 seconds. 
  Full-batch training loss = 0.182198, test loss = 0.271246
  Training set accuracy = 0.948200, Test set accuracy = 0.920100
 epoch 20/30. Took 0.11176 seconds. 
  Full-batch training loss = 0.174368, test loss = 0.268217
  Training set accuracy = 0.951000, Test set accuracy = 0.921300
 epoch 21/30. Took 0.11172 seconds. 
  Full-batch training loss = 0.166510, test loss = 0.265307
  Training set accuracy = 0.950800, Test set accuracy = 0.921700
 epoch 22/30. Took 0.10958 seconds. 
  Full-batch training loss = 0.159136, test loss = 0.264964
  Training set accuracy = 0.956800, Test set accuracy = 0.921400
 epoch 23/30. Took 0.11042 seconds. 
  Full-batch training loss = 0.151664, test loss = 0.260439
  Training set accuracy = 0.958400, Test set accuracy = 0.923400
 epoch 24/30. Took 0.10791 seconds. 
  Full-batch training loss = 0.147161, test loss = 0.259096
  Training set accuracy = 0.959400, Test set accuracy = 0.923800
 epoch 25/30. Took 0.10905 seconds. 
  Full-batch training loss = 0.137271, test loss = 0.252060
  Training set accuracy = 0.964000, Test set accuracy = 0.924900
 epoch 26/30. Took 0.11035 seconds. 
  Full-batch training loss = 0.143074, test loss = 0.262809
  Training set accuracy = 0.961600, Test set accuracy = 0.921500
 epoch 27/30. Took 0.1114 seconds. 
  Full-batch training loss = 0.130433, test loss = 0.254035
  Training set accuracy = 0.968000, Test set accuracy = 0.924400
 epoch 28/30. Took 0.11201 seconds. 
  Full-batch training loss = 0.125688, test loss = 0.250333
  Training set accuracy = 0.968200, Test set accuracy = 0.925100
 epoch 29/30. Took 0.11162 seconds. 
  Full-batch training loss = 0.118988, test loss = 0.247449
  Training set accuracy = 0.969800, Test set accuracy = 0.925400
 epoch 30/30. Took 0.1123 seconds. 
  Full-batch training loss = 0.113949, test loss = 0.247484
  Training set accuracy = 0.973000, Test set accuracy = 0.925500
Elapsed time is 8.487742 seconds.
End Training
-----
Params 5000 0.010 0.00 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.22354 seconds. 
  Full-batch training loss = 1.494513, test loss = 1.489976
  Training set accuracy = 0.707600, Test set accuracy = 0.703100
 epoch 2/30. Took 0.18834 seconds. 
  Full-batch training loss = 0.725795, test loss = 0.723895
  Training set accuracy = 0.821800, Test set accuracy = 0.822600
 epoch 3/30. Took 0.18726 seconds. 
  Full-batch training loss = 0.516817, test loss = 0.514252
  Training set accuracy = 0.862200, Test set accuracy = 0.863000
 epoch 4/30. Took 0.20356 seconds. 
  Full-batch training loss = 0.428898, test loss = 0.435023
  Training set accuracy = 0.879400, Test set accuracy = 0.881500
 epoch 5/30. Took 0.18559 seconds. 
  Full-batch training loss = 0.373800, test loss = 0.384706
  Training set accuracy = 0.897400, Test set accuracy = 0.894300
 epoch 6/30. Took 0.18927 seconds. 
  Full-batch training loss = 0.344636, test loss = 0.362445
  Training set accuracy = 0.900200, Test set accuracy = 0.896400
 epoch 7/30. Took 0.19082 seconds. 
  Full-batch training loss = 0.316634, test loss = 0.339451
  Training set accuracy = 0.911400, Test set accuracy = 0.902200
 epoch 8/30. Took 0.18784 seconds. 
  Full-batch training loss = 0.299583, test loss = 0.330710
  Training set accuracy = 0.919000, Test set accuracy = 0.906500
 epoch 9/30. Took 0.18894 seconds. 
  Full-batch training loss = 0.281577, test loss = 0.319302
  Training set accuracy = 0.921400, Test set accuracy = 0.907700
 epoch 10/30. Took 0.19105 seconds. 
  Full-batch training loss = 0.266753, test loss = 0.310239
  Training set accuracy = 0.927400, Test set accuracy = 0.910100
 epoch 11/30. Took 0.18901 seconds. 
  Full-batch training loss = 0.259196, test loss = 0.305232
  Training set accuracy = 0.926400, Test set accuracy = 0.911300
 epoch 12/30. Took 0.19306 seconds. 
  Full-batch training loss = 0.244677, test loss = 0.295437
  Training set accuracy = 0.933800, Test set accuracy = 0.914400
 epoch 13/30. Took 0.18837 seconds. 
  Full-batch training loss = 0.233234, test loss = 0.290583
  Training set accuracy = 0.937000, Test set accuracy = 0.914100
 epoch 14/30. Took 0.19718 seconds. 
  Full-batch training loss = 0.227352, test loss = 0.286621
  Training set accuracy = 0.937200, Test set accuracy = 0.916100
 epoch 15/30. Took 0.18953 seconds. 
  Full-batch training loss = 0.217697, test loss = 0.288816
  Training set accuracy = 0.941600, Test set accuracy = 0.914600
 epoch 16/30. Took 0.18915 seconds. 
  Full-batch training loss = 0.210526, test loss = 0.278278
  Training set accuracy = 0.943200, Test set accuracy = 0.918700
 epoch 17/30. Took 0.18926 seconds. 
  Full-batch training loss = 0.196408, test loss = 0.274208
  Training set accuracy = 0.949400, Test set accuracy = 0.920100
 epoch 18/30. Took 0.20475 seconds. 
  Full-batch training loss = 0.190516, test loss = 0.269636
  Training set accuracy = 0.952000, Test set accuracy = 0.921600
 epoch 19/30. Took 0.18623 seconds. 
  Full-batch training loss = 0.180494, test loss = 0.264558
  Training set accuracy = 0.955400, Test set accuracy = 0.923500
 epoch 20/30. Took 0.18817 seconds. 
  Full-batch training loss = 0.178189, test loss = 0.265513
  Training set accuracy = 0.954800, Test set accuracy = 0.921200
 epoch 21/30. Took 0.18981 seconds. 
  Full-batch training loss = 0.171921, test loss = 0.262500
  Training set accuracy = 0.956400, Test set accuracy = 0.923600
 epoch 22/30. Took 0.19041 seconds. 
  Full-batch training loss = 0.165535, test loss = 0.264231
  Training set accuracy = 0.958000, Test set accuracy = 0.921000
 epoch 23/30. Took 0.19106 seconds. 
  Full-batch training loss = 0.155528, test loss = 0.252799
  Training set accuracy = 0.958600, Test set accuracy = 0.924900
 epoch 24/30. Took 0.18708 seconds. 
  Full-batch training loss = 0.162870, test loss = 0.266997
  Training set accuracy = 0.957600, Test set accuracy = 0.919200
 epoch 25/30. Took 0.18788 seconds. 
  Full-batch training loss = 0.147019, test loss = 0.252298
  Training set accuracy = 0.961800, Test set accuracy = 0.924700
 epoch 26/30. Took 0.18922 seconds. 
  Full-batch training loss = 0.139628, test loss = 0.252202
  Training set accuracy = 0.967800, Test set accuracy = 0.924400
 epoch 27/30. Took 0.18837 seconds. 
  Full-batch training loss = 0.135609, test loss = 0.251013
  Training set accuracy = 0.965800, Test set accuracy = 0.925700
 epoch 28/30. Took 0.18846 seconds. 
  Full-batch training loss = 0.131874, test loss = 0.248474
  Training set accuracy = 0.966200, Test set accuracy = 0.924200
 epoch 29/30. Took 0.18641 seconds. 
  Full-batch training loss = 0.122987, test loss = 0.244487
  Training set accuracy = 0.971200, Test set accuracy = 0.925700
 epoch 30/30. Took 0.20558 seconds. 
  Full-batch training loss = 0.120588, test loss = 0.245157
  Training set accuracy = 0.972400, Test set accuracy = 0.926000
Elapsed time is 14.253945 seconds.
End Training
-----
Params 5000 0.010 0.00 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.5197 seconds. 
  Full-batch training loss = 1.292982, test loss = 1.274577
  Training set accuracy = 0.743600, Test set accuracy = 0.751600
 epoch 2/30. Took 0.51015 seconds. 
  Full-batch training loss = 0.634651, test loss = 0.621603
  Training set accuracy = 0.848000, Test set accuracy = 0.852400
 epoch 3/30. Took 0.51039 seconds. 
  Full-batch training loss = 0.471477, test loss = 0.469234
  Training set accuracy = 0.882800, Test set accuracy = 0.880800
 epoch 4/30. Took 0.53492 seconds. 
  Full-batch training loss = 0.395014, test loss = 0.404870
  Training set accuracy = 0.899400, Test set accuracy = 0.891500
 epoch 5/30. Took 0.50817 seconds. 
  Full-batch training loss = 0.348124, test loss = 0.365606
  Training set accuracy = 0.912600, Test set accuracy = 0.897400
 epoch 6/30. Took 0.50752 seconds. 
  Full-batch training loss = 0.319483, test loss = 0.347049
  Training set accuracy = 0.917800, Test set accuracy = 0.903900
 epoch 7/30. Took 0.51029 seconds. 
  Full-batch training loss = 0.294746, test loss = 0.325028
  Training set accuracy = 0.921000, Test set accuracy = 0.906600
 epoch 8/30. Took 0.52781 seconds. 
  Full-batch training loss = 0.283402, test loss = 0.321774
  Training set accuracy = 0.921600, Test set accuracy = 0.905600
 epoch 9/30. Took 0.51184 seconds. 
  Full-batch training loss = 0.256617, test loss = 0.302014
  Training set accuracy = 0.931800, Test set accuracy = 0.912100
 epoch 10/30. Took 0.51273 seconds. 
  Full-batch training loss = 0.246870, test loss = 0.300609
  Training set accuracy = 0.935800, Test set accuracy = 0.911000
 epoch 11/30. Took 0.50861 seconds. 
  Full-batch training loss = 0.233648, test loss = 0.292857
  Training set accuracy = 0.937800, Test set accuracy = 0.913700
 epoch 12/30. Took 0.51035 seconds. 
  Full-batch training loss = 0.218913, test loss = 0.283288
  Training set accuracy = 0.939800, Test set accuracy = 0.916300
 epoch 13/30. Took 0.57079 seconds. 
  Full-batch training loss = 0.205321, test loss = 0.275068
  Training set accuracy = 0.945200, Test set accuracy = 0.919100
 epoch 14/30. Took 0.51012 seconds. 
  Full-batch training loss = 0.195536, test loss = 0.271116
  Training set accuracy = 0.946800, Test set accuracy = 0.920600
 epoch 15/30. Took 0.51725 seconds. 
  Full-batch training loss = 0.193129, test loss = 0.277054
  Training set accuracy = 0.948600, Test set accuracy = 0.914600
 epoch 16/30. Took 0.51127 seconds. 
  Full-batch training loss = 0.174323, test loss = 0.260577
  Training set accuracy = 0.953800, Test set accuracy = 0.922900
 epoch 17/30. Took 0.50906 seconds. 
  Full-batch training loss = 0.167972, test loss = 0.259271
  Training set accuracy = 0.955400, Test set accuracy = 0.922500
 epoch 18/30. Took 0.55114 seconds. 
  Full-batch training loss = 0.165977, test loss = 0.263607
  Training set accuracy = 0.956600, Test set accuracy = 0.919400
 epoch 19/30. Took 0.50824 seconds. 
  Full-batch training loss = 0.153604, test loss = 0.255192
  Training set accuracy = 0.959600, Test set accuracy = 0.923700
 epoch 20/30. Took 0.51111 seconds. 
  Full-batch training loss = 0.145169, test loss = 0.251226
  Training set accuracy = 0.964400, Test set accuracy = 0.924600
 epoch 21/30. Took 0.51125 seconds. 
  Full-batch training loss = 0.138612, test loss = 0.247786
  Training set accuracy = 0.966200, Test set accuracy = 0.927700
 epoch 22/30. Took 0.5096 seconds. 
  Full-batch training loss = 0.132155, test loss = 0.249882
  Training set accuracy = 0.967600, Test set accuracy = 0.925900
 epoch 23/30. Took 0.50889 seconds. 
  Full-batch training loss = 0.125856, test loss = 0.241745
  Training set accuracy = 0.969600, Test set accuracy = 0.927400
 epoch 24/30. Took 0.50982 seconds. 
  Full-batch training loss = 0.127146, test loss = 0.253322
  Training set accuracy = 0.970200, Test set accuracy = 0.925000
 epoch 25/30. Took 0.50945 seconds. 
  Full-batch training loss = 0.114221, test loss = 0.241926
  Training set accuracy = 0.973600, Test set accuracy = 0.929400
 epoch 26/30. Took 0.50933 seconds. 
  Full-batch training loss = 0.114604, test loss = 0.244860
  Training set accuracy = 0.975000, Test set accuracy = 0.927500
 epoch 27/30. Took 0.50897 seconds. 
  Full-batch training loss = 0.102733, test loss = 0.239823
  Training set accuracy = 0.978000, Test set accuracy = 0.928600
 epoch 28/30. Took 0.50886 seconds. 
  Full-batch training loss = 0.098437, test loss = 0.235961
  Training set accuracy = 0.979000, Test set accuracy = 0.930200
 epoch 29/30. Took 0.50885 seconds. 
  Full-batch training loss = 0.094164, test loss = 0.232535
  Training set accuracy = 0.980600, Test set accuracy = 0.929900
 epoch 30/30. Took 0.53591 seconds. 
  Full-batch training loss = 0.091446, test loss = 0.237841
  Training set accuracy = 0.981400, Test set accuracy = 0.929300
Elapsed time is 33.883505 seconds.
End Training
-----
Params 5000 0.010 0.00 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.13176 seconds. 
  Full-batch training loss = 1.985327, test loss = 1.980920
  Training set accuracy = 0.520800, Test set accuracy = 0.533900
 epoch 2/30. Took 0.12011 seconds. 
  Full-batch training loss = 1.094907, test loss = 1.089953
  Training set accuracy = 0.762800, Test set accuracy = 0.760000
 epoch 3/30. Took 0.12124 seconds. 
  Full-batch training loss = 0.621788, test loss = 0.623949
  Training set accuracy = 0.829600, Test set accuracy = 0.828000
 epoch 4/30. Took 0.13467 seconds. 
  Full-batch training loss = 0.479179, test loss = 0.480918
  Training set accuracy = 0.866800, Test set accuracy = 0.863000
 epoch 5/30. Took 0.12244 seconds. 
  Full-batch training loss = 0.403911, test loss = 0.414969
  Training set accuracy = 0.885400, Test set accuracy = 0.879800
 epoch 6/30. Took 0.13172 seconds. 
  Full-batch training loss = 0.361603, test loss = 0.382178
  Training set accuracy = 0.898800, Test set accuracy = 0.887900
 epoch 7/30. Took 0.12338 seconds. 
  Full-batch training loss = 0.361751, test loss = 0.391277
  Training set accuracy = 0.892600, Test set accuracy = 0.881800
 epoch 8/30. Took 0.12157 seconds. 
  Full-batch training loss = 0.318624, test loss = 0.348362
  Training set accuracy = 0.911600, Test set accuracy = 0.896700
 epoch 9/30. Took 0.1207 seconds. 
  Full-batch training loss = 0.295472, test loss = 0.333335
  Training set accuracy = 0.914000, Test set accuracy = 0.899700
 epoch 10/30. Took 0.12364 seconds. 
  Full-batch training loss = 0.282058, test loss = 0.330614
  Training set accuracy = 0.917800, Test set accuracy = 0.902900
 epoch 11/30. Took 0.12431 seconds. 
  Full-batch training loss = 0.266736, test loss = 0.313753
  Training set accuracy = 0.923200, Test set accuracy = 0.903900
 epoch 12/30. Took 0.123 seconds. 
  Full-batch training loss = 0.257845, test loss = 0.321184
  Training set accuracy = 0.925600, Test set accuracy = 0.905100
 epoch 13/30. Took 0.12252 seconds. 
  Full-batch training loss = 0.234017, test loss = 0.300367
  Training set accuracy = 0.936000, Test set accuracy = 0.909700
 epoch 14/30. Took 0.12573 seconds. 
  Full-batch training loss = 0.215334, test loss = 0.287789
  Training set accuracy = 0.940600, Test set accuracy = 0.913600
 epoch 15/30. Took 0.12452 seconds. 
  Full-batch training loss = 0.205981, test loss = 0.286390
  Training set accuracy = 0.943600, Test set accuracy = 0.916400
 epoch 16/30. Took 0.12409 seconds. 
  Full-batch training loss = 0.191471, test loss = 0.275451
  Training set accuracy = 0.946600, Test set accuracy = 0.918500
 epoch 17/30. Took 0.12509 seconds. 
  Full-batch training loss = 0.188042, test loss = 0.275032
  Training set accuracy = 0.948800, Test set accuracy = 0.918400
 epoch 18/30. Took 0.12366 seconds. 
  Full-batch training loss = 0.173752, test loss = 0.272071
  Training set accuracy = 0.954800, Test set accuracy = 0.918000
 epoch 19/30. Took 0.11965 seconds. 
  Full-batch training loss = 0.160556, test loss = 0.262471
  Training set accuracy = 0.954800, Test set accuracy = 0.922100
 epoch 20/30. Took 0.12436 seconds. 
  Full-batch training loss = 0.154256, test loss = 0.266965
  Training set accuracy = 0.957600, Test set accuracy = 0.921500
 epoch 21/30. Took 0.12436 seconds. 
  Full-batch training loss = 0.139571, test loss = 0.253939
  Training set accuracy = 0.963000, Test set accuracy = 0.925900
 epoch 22/30. Took 0.13305 seconds. 
  Full-batch training loss = 0.139096, test loss = 0.265968
  Training set accuracy = 0.962600, Test set accuracy = 0.923100
 epoch 23/30. Took 0.11907 seconds. 
  Full-batch training loss = 0.120458, test loss = 0.246691
  Training set accuracy = 0.970400, Test set accuracy = 0.927700
 epoch 24/30. Took 0.11857 seconds. 
  Full-batch training loss = 0.113090, test loss = 0.246627
  Training set accuracy = 0.972600, Test set accuracy = 0.927600
 epoch 25/30. Took 0.12412 seconds. 
  Full-batch training loss = 0.109323, test loss = 0.250566
  Training set accuracy = 0.974800, Test set accuracy = 0.927400
 epoch 26/30. Took 0.12461 seconds. 
  Full-batch training loss = 0.103046, test loss = 0.246745
  Training set accuracy = 0.974800, Test set accuracy = 0.927600
 epoch 27/30. Took 0.12425 seconds. 
  Full-batch training loss = 0.093207, test loss = 0.241882
  Training set accuracy = 0.979000, Test set accuracy = 0.930400
 epoch 28/30. Took 0.1234 seconds. 
  Full-batch training loss = 0.088423, test loss = 0.244725
  Training set accuracy = 0.980600, Test set accuracy = 0.928900
 epoch 29/30. Took 0.127 seconds. 
  Full-batch training loss = 0.082253, test loss = 0.238355
  Training set accuracy = 0.982400, Test set accuracy = 0.930500
 epoch 30/30. Took 0.12433 seconds. 
  Full-batch training loss = 0.085471, test loss = 0.249616
  Training set accuracy = 0.980000, Test set accuracy = 0.927500
Elapsed time is 10.049824 seconds.
End Training
-----
Params 5000 0.010 0.00 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.22866 seconds. 
  Full-batch training loss = 1.852148, test loss = 1.850005
  Training set accuracy = 0.612600, Test set accuracy = 0.602700
 epoch 2/30. Took 0.22049 seconds. 
  Full-batch training loss = 0.837944, test loss = 0.822167
  Training set accuracy = 0.785400, Test set accuracy = 0.782500
 epoch 3/30. Took 0.21641 seconds. 
  Full-batch training loss = 0.526631, test loss = 0.518430
  Training set accuracy = 0.861800, Test set accuracy = 0.857900
 epoch 4/30. Took 0.2182 seconds. 
  Full-batch training loss = 0.418291, test loss = 0.425857
  Training set accuracy = 0.887600, Test set accuracy = 0.880900
 epoch 5/30. Took 0.21894 seconds. 
  Full-batch training loss = 0.365270, test loss = 0.389646
  Training set accuracy = 0.895600, Test set accuracy = 0.889500
 epoch 6/30. Took 0.21952 seconds. 
  Full-batch training loss = 0.325337, test loss = 0.348596
  Training set accuracy = 0.904800, Test set accuracy = 0.898000
 epoch 7/30. Took 0.23419 seconds. 
  Full-batch training loss = 0.293562, test loss = 0.330457
  Training set accuracy = 0.916800, Test set accuracy = 0.904900
 epoch 8/30. Took 0.21824 seconds. 
  Full-batch training loss = 0.267137, test loss = 0.314298
  Training set accuracy = 0.924800, Test set accuracy = 0.908000
 epoch 9/30. Took 0.22226 seconds. 
  Full-batch training loss = 0.247433, test loss = 0.307297
  Training set accuracy = 0.929200, Test set accuracy = 0.910500
 epoch 10/30. Took 0.21851 seconds. 
  Full-batch training loss = 0.228969, test loss = 0.289881
  Training set accuracy = 0.935600, Test set accuracy = 0.915800
 epoch 11/30. Took 0.21902 seconds. 
  Full-batch training loss = 0.218502, test loss = 0.295672
  Training set accuracy = 0.938200, Test set accuracy = 0.916100
 epoch 12/30. Took 0.22129 seconds. 
  Full-batch training loss = 0.200434, test loss = 0.280986
  Training set accuracy = 0.943200, Test set accuracy = 0.918600
 epoch 13/30. Took 0.21974 seconds. 
  Full-batch training loss = 0.187882, test loss = 0.273123
  Training set accuracy = 0.948400, Test set accuracy = 0.920700
 epoch 14/30. Took 0.21872 seconds. 
  Full-batch training loss = 0.182397, test loss = 0.278531
  Training set accuracy = 0.951000, Test set accuracy = 0.916900
 epoch 15/30. Took 0.21751 seconds. 
  Full-batch training loss = 0.160125, test loss = 0.260214
  Training set accuracy = 0.956800, Test set accuracy = 0.924300
 epoch 16/30. Took 0.22248 seconds. 
  Full-batch training loss = 0.151958, test loss = 0.258322
  Training set accuracy = 0.959800, Test set accuracy = 0.926800
 epoch 17/30. Took 0.21944 seconds. 
  Full-batch training loss = 0.150782, test loss = 0.265479
  Training set accuracy = 0.958200, Test set accuracy = 0.923100
 epoch 18/30. Took 0.22386 seconds. 
  Full-batch training loss = 0.138356, test loss = 0.258460
  Training set accuracy = 0.963800, Test set accuracy = 0.925000
 epoch 19/30. Took 0.22015 seconds. 
  Full-batch training loss = 0.128474, test loss = 0.255835
  Training set accuracy = 0.967800, Test set accuracy = 0.924900
 epoch 20/30. Took 0.2187 seconds. 
  Full-batch training loss = 0.124428, test loss = 0.254897
  Training set accuracy = 0.966200, Test set accuracy = 0.927400
 epoch 21/30. Took 0.24188 seconds. 
  Full-batch training loss = 0.111324, test loss = 0.243597
  Training set accuracy = 0.973400, Test set accuracy = 0.928000
 epoch 22/30. Took 0.22015 seconds. 
  Full-batch training loss = 0.105006, test loss = 0.247175
  Training set accuracy = 0.973000, Test set accuracy = 0.929000
 epoch 23/30. Took 0.22102 seconds. 
  Full-batch training loss = 0.098480, test loss = 0.242694
  Training set accuracy = 0.973200, Test set accuracy = 0.930500
 epoch 24/30. Took 0.22156 seconds. 
  Full-batch training loss = 0.090245, test loss = 0.242060
  Training set accuracy = 0.976800, Test set accuracy = 0.929400
 epoch 25/30. Took 0.21602 seconds. 
  Full-batch training loss = 0.082941, test loss = 0.236395
  Training set accuracy = 0.982800, Test set accuracy = 0.930500
 epoch 26/30. Took 0.2205 seconds. 
  Full-batch training loss = 0.080115, test loss = 0.241553
  Training set accuracy = 0.983200, Test set accuracy = 0.930700
 epoch 27/30. Took 0.21987 seconds. 
  Full-batch training loss = 0.073095, test loss = 0.240053
  Training set accuracy = 0.985000, Test set accuracy = 0.931500
 epoch 28/30. Took 0.22222 seconds. 
  Full-batch training loss = 0.065645, test loss = 0.234663
  Training set accuracy = 0.988200, Test set accuracy = 0.933000
 epoch 29/30. Took 0.22647 seconds. 
  Full-batch training loss = 0.061554, test loss = 0.231891
  Training set accuracy = 0.988200, Test set accuracy = 0.933800
 epoch 30/30. Took 0.21594 seconds. 
  Full-batch training loss = 0.060267, test loss = 0.237018
  Training set accuracy = 0.988000, Test set accuracy = 0.933000
Elapsed time is 16.783365 seconds.
End Training
-----
Params 5000 0.010 0.00 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.70482 seconds. 
  Full-batch training loss = 1.594923, test loss = 1.587669
  Training set accuracy = 0.725400, Test set accuracy = 0.736800
 epoch 2/30. Took 0.69872 seconds. 
  Full-batch training loss = 0.648224, test loss = 0.654284
  Training set accuracy = 0.839800, Test set accuracy = 0.838600
 epoch 3/30. Took 0.70152 seconds. 
  Full-batch training loss = 0.436987, test loss = 0.462726
  Training set accuracy = 0.880400, Test set accuracy = 0.873100
 epoch 4/30. Took 0.70393 seconds. 
  Full-batch training loss = 0.360715, test loss = 0.392901
  Training set accuracy = 0.898400, Test set accuracy = 0.887100
 epoch 5/30. Took 0.70012 seconds. 
  Full-batch training loss = 0.314718, test loss = 0.351119
  Training set accuracy = 0.910400, Test set accuracy = 0.897100
 epoch 6/30. Took 0.70027 seconds. 
  Full-batch training loss = 0.281530, test loss = 0.331307
  Training set accuracy = 0.918400, Test set accuracy = 0.905100
 epoch 7/30. Took 0.70393 seconds. 
  Full-batch training loss = 0.259550, test loss = 0.322989
  Training set accuracy = 0.927200, Test set accuracy = 0.906000
 epoch 8/30. Took 0.70395 seconds. 
  Full-batch training loss = 0.237372, test loss = 0.306892
  Training set accuracy = 0.933400, Test set accuracy = 0.911700
 epoch 9/30. Took 0.70877 seconds. 
  Full-batch training loss = 0.218096, test loss = 0.294250
  Training set accuracy = 0.936800, Test set accuracy = 0.917000
 epoch 10/30. Took 0.72971 seconds. 
  Full-batch training loss = 0.211993, test loss = 0.296207
  Training set accuracy = 0.938800, Test set accuracy = 0.914300
 epoch 11/30. Took 0.70086 seconds. 
  Full-batch training loss = 0.193671, test loss = 0.279595
  Training set accuracy = 0.943000, Test set accuracy = 0.917500
 epoch 12/30. Took 0.70007 seconds. 
  Full-batch training loss = 0.177582, test loss = 0.273376
  Training set accuracy = 0.950800, Test set accuracy = 0.919500
 epoch 13/30. Took 0.70184 seconds. 
  Full-batch training loss = 0.161214, test loss = 0.263833
  Training set accuracy = 0.956000, Test set accuracy = 0.923400
 epoch 14/30. Took 0.72228 seconds. 
  Full-batch training loss = 0.153060, test loss = 0.268887
  Training set accuracy = 0.958200, Test set accuracy = 0.920300
 epoch 15/30. Took 0.71511 seconds. 
  Full-batch training loss = 0.141762, test loss = 0.259208
  Training set accuracy = 0.960400, Test set accuracy = 0.922900
 epoch 16/30. Took 0.7103 seconds. 
  Full-batch training loss = 0.129644, test loss = 0.251980
  Training set accuracy = 0.962800, Test set accuracy = 0.925900
 epoch 17/30. Took 0.69988 seconds. 
  Full-batch training loss = 0.124216, test loss = 0.252024
  Training set accuracy = 0.967200, Test set accuracy = 0.924200
 epoch 18/30. Took 0.7021 seconds. 
  Full-batch training loss = 0.111962, test loss = 0.243530
  Training set accuracy = 0.970600, Test set accuracy = 0.929100
 epoch 19/30. Took 0.74993 seconds. 
  Full-batch training loss = 0.108979, test loss = 0.246950
  Training set accuracy = 0.972400, Test set accuracy = 0.928700
 epoch 20/30. Took 0.70076 seconds. 
  Full-batch training loss = 0.101159, test loss = 0.247323
  Training set accuracy = 0.974800, Test set accuracy = 0.926400
 epoch 21/30. Took 0.73467 seconds. 
  Full-batch training loss = 0.091452, test loss = 0.239165
  Training set accuracy = 0.979200, Test set accuracy = 0.929200
 epoch 22/30. Took 0.70827 seconds. 
  Full-batch training loss = 0.089949, test loss = 0.239647
  Training set accuracy = 0.977200, Test set accuracy = 0.927500
 epoch 23/30. Took 0.69851 seconds. 
  Full-batch training loss = 0.078912, test loss = 0.233145
  Training set accuracy = 0.982600, Test set accuracy = 0.931100
 epoch 24/30. Took 0.6983 seconds. 
  Full-batch training loss = 0.072171, test loss = 0.229995
  Training set accuracy = 0.984600, Test set accuracy = 0.931500
 epoch 25/30. Took 0.70242 seconds. 
  Full-batch training loss = 0.069162, test loss = 0.236811
  Training set accuracy = 0.984000, Test set accuracy = 0.930300
 epoch 26/30. Took 0.70166 seconds. 
  Full-batch training loss = 0.062386, test loss = 0.231165
  Training set accuracy = 0.988000, Test set accuracy = 0.932700
 epoch 27/30. Took 0.70374 seconds. 
  Full-batch training loss = 0.057697, test loss = 0.229146
  Training set accuracy = 0.987400, Test set accuracy = 0.932800
 epoch 28/30. Took 0.70067 seconds. 
  Full-batch training loss = 0.056826, test loss = 0.232786
  Training set accuracy = 0.986400, Test set accuracy = 0.932500
 epoch 29/30. Took 0.69929 seconds. 
  Full-batch training loss = 0.049367, test loss = 0.231408
  Training set accuracy = 0.990800, Test set accuracy = 0.931600
 epoch 30/30. Took 0.70129 seconds. 
  Full-batch training loss = 0.048809, test loss = 0.233064
  Training set accuracy = 0.990400, Test set accuracy = 0.931100
Elapsed time is 46.266709 seconds.
End Training
-----
Params 5000 0.010 0.10 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11842 seconds. 
  Full-batch training loss = 1.497647, test loss = 1.487394
  Training set accuracy = 0.688800, Test set accuracy = 0.699200
 epoch 2/30. Took 0.10974 seconds. 
  Full-batch training loss = 0.904433, test loss = 0.890589
  Training set accuracy = 0.814800, Test set accuracy = 0.823000
 epoch 3/30. Took 0.10549 seconds. 
  Full-batch training loss = 0.674271, test loss = 0.659211
  Training set accuracy = 0.846600, Test set accuracy = 0.851400
 epoch 4/30. Took 0.10918 seconds. 
  Full-batch training loss = 0.566199, test loss = 0.553035
  Training set accuracy = 0.865200, Test set accuracy = 0.871100
 epoch 5/30. Took 0.11037 seconds. 
  Full-batch training loss = 0.502433, test loss = 0.490635
  Training set accuracy = 0.876000, Test set accuracy = 0.879200
 epoch 6/30. Took 0.11249 seconds. 
  Full-batch training loss = 0.460212, test loss = 0.451459
  Training set accuracy = 0.882400, Test set accuracy = 0.886300
 epoch 7/30. Took 0.11785 seconds. 
  Full-batch training loss = 0.432157, test loss = 0.433119
  Training set accuracy = 0.886600, Test set accuracy = 0.884100
 epoch 8/30. Took 0.10724 seconds. 
  Full-batch training loss = 0.402650, test loss = 0.402147
  Training set accuracy = 0.893600, Test set accuracy = 0.893600
 epoch 9/30. Took 0.1091 seconds. 
  Full-batch training loss = 0.383197, test loss = 0.387781
  Training set accuracy = 0.898800, Test set accuracy = 0.895600
 epoch 10/30. Took 0.10576 seconds. 
  Full-batch training loss = 0.367306, test loss = 0.372067
  Training set accuracy = 0.899800, Test set accuracy = 0.898700
 epoch 11/30. Took 0.1068 seconds. 
  Full-batch training loss = 0.352874, test loss = 0.360842
  Training set accuracy = 0.904000, Test set accuracy = 0.902100
 epoch 12/30. Took 0.10619 seconds. 
  Full-batch training loss = 0.342155, test loss = 0.351738
  Training set accuracy = 0.904200, Test set accuracy = 0.904100
 epoch 13/30. Took 0.10883 seconds. 
  Full-batch training loss = 0.328346, test loss = 0.342896
  Training set accuracy = 0.911800, Test set accuracy = 0.904600
 epoch 14/30. Took 0.10907 seconds. 
  Full-batch training loss = 0.318800, test loss = 0.335624
  Training set accuracy = 0.912400, Test set accuracy = 0.906300
 epoch 15/30. Took 0.10794 seconds. 
  Full-batch training loss = 0.309015, test loss = 0.329322
  Training set accuracy = 0.915200, Test set accuracy = 0.907400
 epoch 16/30. Took 0.10923 seconds. 
  Full-batch training loss = 0.299025, test loss = 0.324217
  Training set accuracy = 0.920000, Test set accuracy = 0.908500
 epoch 17/30. Took 0.10667 seconds. 
  Full-batch training loss = 0.292523, test loss = 0.317794
  Training set accuracy = 0.917800, Test set accuracy = 0.910800
 epoch 18/30. Took 0.10753 seconds. 
  Full-batch training loss = 0.283397, test loss = 0.312223
  Training set accuracy = 0.923200, Test set accuracy = 0.911700
 epoch 19/30. Took 0.10826 seconds. 
  Full-batch training loss = 0.275981, test loss = 0.308151
  Training set accuracy = 0.922800, Test set accuracy = 0.912700
 epoch 20/30. Took 0.10725 seconds. 
  Full-batch training loss = 0.270109, test loss = 0.304957
  Training set accuracy = 0.925200, Test set accuracy = 0.915100
 epoch 21/30. Took 0.10913 seconds. 
  Full-batch training loss = 0.263306, test loss = 0.300364
  Training set accuracy = 0.926800, Test set accuracy = 0.913800
 epoch 22/30. Took 0.11521 seconds. 
  Full-batch training loss = 0.257650, test loss = 0.296873
  Training set accuracy = 0.927800, Test set accuracy = 0.915000
 epoch 23/30. Took 0.10448 seconds. 
  Full-batch training loss = 0.251564, test loss = 0.294085
  Training set accuracy = 0.931000, Test set accuracy = 0.915700
 epoch 24/30. Took 0.12025 seconds. 
  Full-batch training loss = 0.244810, test loss = 0.289348
  Training set accuracy = 0.933200, Test set accuracy = 0.917100
 epoch 25/30. Took 0.11304 seconds. 
  Full-batch training loss = 0.240741, test loss = 0.286640
  Training set accuracy = 0.932200, Test set accuracy = 0.918100
 epoch 26/30. Took 0.12023 seconds. 
  Full-batch training loss = 0.235424, test loss = 0.286306
  Training set accuracy = 0.933800, Test set accuracy = 0.917800
 epoch 27/30. Took 0.11955 seconds. 
  Full-batch training loss = 0.229165, test loss = 0.279964
  Training set accuracy = 0.936400, Test set accuracy = 0.920400
 epoch 28/30. Took 0.10731 seconds. 
  Full-batch training loss = 0.226000, test loss = 0.280267
  Training set accuracy = 0.938400, Test set accuracy = 0.921200
 epoch 29/30. Took 0.10855 seconds. 
  Full-batch training loss = 0.220408, test loss = 0.276775
  Training set accuracy = 0.942000, Test set accuracy = 0.921300
 epoch 30/30. Took 0.10928 seconds. 
  Full-batch training loss = 0.216543, test loss = 0.276024
  Training set accuracy = 0.942600, Test set accuracy = 0.921300
Elapsed time is 8.127227 seconds.
End Training
-----
Params 5000 0.010 0.10 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17497 seconds. 
  Full-batch training loss = 1.446085, test loss = 1.434023
  Training set accuracy = 0.770600, Test set accuracy = 0.784000
 epoch 2/30. Took 0.16588 seconds. 
  Full-batch training loss = 0.863682, test loss = 0.841686
  Training set accuracy = 0.829800, Test set accuracy = 0.841500
 epoch 3/30. Took 0.16781 seconds. 
  Full-batch training loss = 0.655860, test loss = 0.631118
  Training set accuracy = 0.848400, Test set accuracy = 0.860900
 epoch 4/30. Took 0.1692 seconds. 
  Full-batch training loss = 0.556823, test loss = 0.532320
  Training set accuracy = 0.864200, Test set accuracy = 0.878400
 epoch 5/30. Took 0.16859 seconds. 
  Full-batch training loss = 0.500067, test loss = 0.476536
  Training set accuracy = 0.868400, Test set accuracy = 0.884800
 epoch 6/30. Took 0.16434 seconds. 
  Full-batch training loss = 0.459595, test loss = 0.440094
  Training set accuracy = 0.878400, Test set accuracy = 0.889600
 epoch 7/30. Took 0.16498 seconds. 
  Full-batch training loss = 0.430414, test loss = 0.412502
  Training set accuracy = 0.885200, Test set accuracy = 0.894600
 epoch 8/30. Took 0.16935 seconds. 
  Full-batch training loss = 0.409220, test loss = 0.397302
  Training set accuracy = 0.887600, Test set accuracy = 0.895800
 epoch 9/30. Took 0.16858 seconds. 
  Full-batch training loss = 0.389547, test loss = 0.377147
  Training set accuracy = 0.892400, Test set accuracy = 0.898000
 epoch 10/30. Took 0.1687 seconds. 
  Full-batch training loss = 0.372404, test loss = 0.364328
  Training set accuracy = 0.896600, Test set accuracy = 0.903500
 epoch 11/30. Took 0.18174 seconds. 
  Full-batch training loss = 0.361289, test loss = 0.356000
  Training set accuracy = 0.897400, Test set accuracy = 0.905500
 epoch 12/30. Took 0.16784 seconds. 
  Full-batch training loss = 0.347816, test loss = 0.345529
  Training set accuracy = 0.904400, Test set accuracy = 0.907100
 epoch 13/30. Took 0.16478 seconds. 
  Full-batch training loss = 0.340238, test loss = 0.342040
  Training set accuracy = 0.905400, Test set accuracy = 0.908900
 epoch 14/30. Took 0.16796 seconds. 
  Full-batch training loss = 0.326397, test loss = 0.331852
  Training set accuracy = 0.907200, Test set accuracy = 0.909500
 epoch 15/30. Took 0.16831 seconds. 
  Full-batch training loss = 0.317380, test loss = 0.325165
  Training set accuracy = 0.912200, Test set accuracy = 0.911700
 epoch 16/30. Took 0.16916 seconds. 
  Full-batch training loss = 0.311096, test loss = 0.323823
  Training set accuracy = 0.911800, Test set accuracy = 0.911600
 epoch 17/30. Took 0.16994 seconds. 
  Full-batch training loss = 0.299975, test loss = 0.314452
  Training set accuracy = 0.916000, Test set accuracy = 0.914600
 epoch 18/30. Took 0.16921 seconds. 
  Full-batch training loss = 0.292967, test loss = 0.311362
  Training set accuracy = 0.918000, Test set accuracy = 0.915200
 epoch 19/30. Took 0.17069 seconds. 
  Full-batch training loss = 0.285057, test loss = 0.306144
  Training set accuracy = 0.921200, Test set accuracy = 0.915300
 epoch 20/30. Took 0.16515 seconds. 
  Full-batch training loss = 0.278640, test loss = 0.302535
  Training set accuracy = 0.923400, Test set accuracy = 0.916600
 epoch 21/30. Took 0.16615 seconds. 
  Full-batch training loss = 0.272105, test loss = 0.299986
  Training set accuracy = 0.924400, Test set accuracy = 0.917500
 epoch 22/30. Took 0.16495 seconds. 
  Full-batch training loss = 0.267432, test loss = 0.297411
  Training set accuracy = 0.925800, Test set accuracy = 0.918000
 epoch 23/30. Took 0.16482 seconds. 
  Full-batch training loss = 0.260439, test loss = 0.292945
  Training set accuracy = 0.928000, Test set accuracy = 0.917100
 epoch 24/30. Took 0.16488 seconds. 
  Full-batch training loss = 0.253528, test loss = 0.290185
  Training set accuracy = 0.931200, Test set accuracy = 0.918400
 epoch 25/30. Took 0.16515 seconds. 
  Full-batch training loss = 0.249647, test loss = 0.287748
  Training set accuracy = 0.930400, Test set accuracy = 0.917000
 epoch 26/30. Took 0.17601 seconds. 
  Full-batch training loss = 0.243195, test loss = 0.284077
  Training set accuracy = 0.934400, Test set accuracy = 0.919800
 epoch 27/30. Took 0.1676 seconds. 
  Full-batch training loss = 0.238917, test loss = 0.281243
  Training set accuracy = 0.934000, Test set accuracy = 0.920100
 epoch 28/30. Took 0.16845 seconds. 
  Full-batch training loss = 0.232725, test loss = 0.277568
  Training set accuracy = 0.937800, Test set accuracy = 0.921800
 epoch 29/30. Took 0.1703 seconds. 
  Full-batch training loss = 0.227455, test loss = 0.275313
  Training set accuracy = 0.938200, Test set accuracy = 0.922000
 epoch 30/30. Took 0.16496 seconds. 
  Full-batch training loss = 0.223211, test loss = 0.274530
  Training set accuracy = 0.939000, Test set accuracy = 0.921700
Elapsed time is 11.647981 seconds.
End Training
-----
Params 5000 0.010 0.10 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.36154 seconds. 
  Full-batch training loss = 1.272030, test loss = 1.272143
  Training set accuracy = 0.738800, Test set accuracy = 0.741800
 epoch 2/30. Took 0.35409 seconds. 
  Full-batch training loss = 0.776108, test loss = 0.768258
  Training set accuracy = 0.830200, Test set accuracy = 0.834700
 epoch 3/30. Took 0.35676 seconds. 
  Full-batch training loss = 0.597469, test loss = 0.592033
  Training set accuracy = 0.863200, Test set accuracy = 0.865100
 epoch 4/30. Took 0.3811 seconds. 
  Full-batch training loss = 0.508262, test loss = 0.506516
  Training set accuracy = 0.875800, Test set accuracy = 0.877600
 epoch 5/30. Took 0.35247 seconds. 
  Full-batch training loss = 0.455466, test loss = 0.456531
  Training set accuracy = 0.887000, Test set accuracy = 0.884600
 epoch 6/30. Took 0.35082 seconds. 
  Full-batch training loss = 0.418482, test loss = 0.424129
  Training set accuracy = 0.893600, Test set accuracy = 0.888500
 epoch 7/30. Took 0.349 seconds. 
  Full-batch training loss = 0.391267, test loss = 0.399874
  Training set accuracy = 0.901200, Test set accuracy = 0.895300
 epoch 8/30. Took 0.35696 seconds. 
  Full-batch training loss = 0.369397, test loss = 0.383896
  Training set accuracy = 0.903600, Test set accuracy = 0.896800
 epoch 9/30. Took 0.37854 seconds. 
  Full-batch training loss = 0.352671, test loss = 0.371173
  Training set accuracy = 0.907400, Test set accuracy = 0.898900
 epoch 10/30. Took 0.35752 seconds. 
  Full-batch training loss = 0.337033, test loss = 0.358730
  Training set accuracy = 0.908400, Test set accuracy = 0.902200
 epoch 11/30. Took 0.35629 seconds. 
  Full-batch training loss = 0.321258, test loss = 0.346741
  Training set accuracy = 0.914000, Test set accuracy = 0.906200
 epoch 12/30. Took 0.35579 seconds. 
  Full-batch training loss = 0.313863, test loss = 0.341401
  Training set accuracy = 0.915800, Test set accuracy = 0.906100
 epoch 13/30. Took 0.36336 seconds. 
  Full-batch training loss = 0.300634, test loss = 0.334324
  Training set accuracy = 0.920000, Test set accuracy = 0.905800
 epoch 14/30. Took 0.3572 seconds. 
  Full-batch training loss = 0.292469, test loss = 0.328164
  Training set accuracy = 0.921400, Test set accuracy = 0.907600
 epoch 15/30. Took 0.35714 seconds. 
  Full-batch training loss = 0.280693, test loss = 0.320097
  Training set accuracy = 0.923200, Test set accuracy = 0.908800
 epoch 16/30. Took 0.35525 seconds. 
  Full-batch training loss = 0.274335, test loss = 0.316076
  Training set accuracy = 0.926600, Test set accuracy = 0.909600
 epoch 17/30. Took 0.35646 seconds. 
  Full-batch training loss = 0.266869, test loss = 0.311772
  Training set accuracy = 0.927200, Test set accuracy = 0.911000
 epoch 18/30. Took 0.35436 seconds. 
  Full-batch training loss = 0.260152, test loss = 0.309561
  Training set accuracy = 0.931600, Test set accuracy = 0.909600
 epoch 19/30. Took 0.38933 seconds. 
  Full-batch training loss = 0.251590, test loss = 0.303548
  Training set accuracy = 0.931400, Test set accuracy = 0.913400
 epoch 20/30. Took 0.35441 seconds. 
  Full-batch training loss = 0.246390, test loss = 0.302345
  Training set accuracy = 0.935800, Test set accuracy = 0.913300
 epoch 21/30. Took 0.371 seconds. 
  Full-batch training loss = 0.238929, test loss = 0.297168
  Training set accuracy = 0.936600, Test set accuracy = 0.913700
 epoch 22/30. Took 0.36967 seconds. 
  Full-batch training loss = 0.233603, test loss = 0.293716
  Training set accuracy = 0.937800, Test set accuracy = 0.913700
 epoch 23/30. Took 0.35745 seconds. 
  Full-batch training loss = 0.228539, test loss = 0.292629
  Training set accuracy = 0.940400, Test set accuracy = 0.915100
 epoch 24/30. Took 0.35843 seconds. 
  Full-batch training loss = 0.221791, test loss = 0.287823
  Training set accuracy = 0.941200, Test set accuracy = 0.916800
 epoch 25/30. Took 0.35735 seconds. 
  Full-batch training loss = 0.216658, test loss = 0.284749
  Training set accuracy = 0.944600, Test set accuracy = 0.916300
 epoch 26/30. Took 0.36187 seconds. 
  Full-batch training loss = 0.212969, test loss = 0.284653
  Training set accuracy = 0.943200, Test set accuracy = 0.917200
 epoch 27/30. Took 0.39381 seconds. 
  Full-batch training loss = 0.206198, test loss = 0.280531
  Training set accuracy = 0.946800, Test set accuracy = 0.917800
 epoch 28/30. Took 0.35184 seconds. 
  Full-batch training loss = 0.203039, test loss = 0.279323
  Training set accuracy = 0.947400, Test set accuracy = 0.917600
 epoch 29/30. Took 0.35659 seconds. 
  Full-batch training loss = 0.198011, test loss = 0.276610
  Training set accuracy = 0.950000, Test set accuracy = 0.919200
 epoch 30/30. Took 0.38171 seconds. 
  Full-batch training loss = 0.193254, test loss = 0.275218
  Training set accuracy = 0.951200, Test set accuracy = 0.920300
Elapsed time is 23.559341 seconds.
End Training
-----
Params 5000 0.010 0.10 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14272 seconds. 
  Full-batch training loss = 1.784053, test loss = 1.775547
  Training set accuracy = 0.633200, Test set accuracy = 0.632900
 epoch 2/30. Took 0.13685 seconds. 
  Full-batch training loss = 1.024446, test loss = 1.007170
  Training set accuracy = 0.750200, Test set accuracy = 0.758100
 epoch 3/30. Took 0.13793 seconds. 
  Full-batch training loss = 0.696474, test loss = 0.681385
  Training set accuracy = 0.822600, Test set accuracy = 0.828400
 epoch 4/30. Took 0.13674 seconds. 
  Full-batch training loss = 0.564740, test loss = 0.549903
  Training set accuracy = 0.852600, Test set accuracy = 0.855000
 epoch 5/30. Took 0.13755 seconds. 
  Full-batch training loss = 0.489602, test loss = 0.478684
  Training set accuracy = 0.871800, Test set accuracy = 0.876700
 epoch 6/30. Took 0.13726 seconds. 
  Full-batch training loss = 0.441995, test loss = 0.433314
  Training set accuracy = 0.883800, Test set accuracy = 0.887400
 epoch 7/30. Took 0.1372 seconds. 
  Full-batch training loss = 0.407468, test loss = 0.399689
  Training set accuracy = 0.888600, Test set accuracy = 0.893700
 epoch 8/30. Took 0.13314 seconds. 
  Full-batch training loss = 0.378617, test loss = 0.378875
  Training set accuracy = 0.896400, Test set accuracy = 0.896500
 epoch 9/30. Took 0.13803 seconds. 
  Full-batch training loss = 0.357064, test loss = 0.360712
  Training set accuracy = 0.901000, Test set accuracy = 0.901500
 epoch 10/30. Took 0.13723 seconds. 
  Full-batch training loss = 0.339125, test loss = 0.346522
  Training set accuracy = 0.902400, Test set accuracy = 0.902600
 epoch 11/30. Took 0.13258 seconds. 
  Full-batch training loss = 0.319381, test loss = 0.331729
  Training set accuracy = 0.912600, Test set accuracy = 0.908200
 epoch 12/30. Took 0.13037 seconds. 
  Full-batch training loss = 0.312878, test loss = 0.329321
  Training set accuracy = 0.913200, Test set accuracy = 0.904800
 epoch 13/30. Took 0.13726 seconds. 
  Full-batch training loss = 0.292590, test loss = 0.310540
  Training set accuracy = 0.920400, Test set accuracy = 0.912700
 epoch 14/30. Took 0.1305 seconds. 
  Full-batch training loss = 0.283004, test loss = 0.304269
  Training set accuracy = 0.921800, Test set accuracy = 0.912900
 epoch 15/30. Took 0.13483 seconds. 
  Full-batch training loss = 0.273694, test loss = 0.297728
  Training set accuracy = 0.924600, Test set accuracy = 0.914500
 epoch 16/30. Took 0.13623 seconds. 
  Full-batch training loss = 0.260646, test loss = 0.291711
  Training set accuracy = 0.929000, Test set accuracy = 0.916200
 epoch 17/30. Took 0.14086 seconds. 
  Full-batch training loss = 0.253279, test loss = 0.288907
  Training set accuracy = 0.930400, Test set accuracy = 0.917000
 epoch 18/30. Took 0.12847 seconds. 
  Full-batch training loss = 0.245044, test loss = 0.279469
  Training set accuracy = 0.930400, Test set accuracy = 0.918600
 epoch 19/30. Took 0.13672 seconds. 
  Full-batch training loss = 0.233385, test loss = 0.273296
  Training set accuracy = 0.937200, Test set accuracy = 0.920900
 epoch 20/30. Took 0.13455 seconds. 
  Full-batch training loss = 0.224403, test loss = 0.268697
  Training set accuracy = 0.938400, Test set accuracy = 0.921400
 epoch 21/30. Took 0.13676 seconds. 
  Full-batch training loss = 0.219658, test loss = 0.266432
  Training set accuracy = 0.939000, Test set accuracy = 0.921400
 epoch 22/30. Took 0.13669 seconds. 
  Full-batch training loss = 0.211151, test loss = 0.260916
  Training set accuracy = 0.942000, Test set accuracy = 0.922600
 epoch 23/30. Took 0.14011 seconds. 
  Full-batch training loss = 0.206410, test loss = 0.259993
  Training set accuracy = 0.946400, Test set accuracy = 0.922000
 epoch 24/30. Took 0.1291 seconds. 
  Full-batch training loss = 0.196876, test loss = 0.253437
  Training set accuracy = 0.946800, Test set accuracy = 0.925300
 epoch 25/30. Took 0.13706 seconds. 
  Full-batch training loss = 0.191648, test loss = 0.250991
  Training set accuracy = 0.946600, Test set accuracy = 0.925600
 epoch 26/30. Took 0.136 seconds. 
  Full-batch training loss = 0.187641, test loss = 0.245727
  Training set accuracy = 0.948800, Test set accuracy = 0.925300
 epoch 27/30. Took 0.13705 seconds. 
  Full-batch training loss = 0.179426, test loss = 0.246009
  Training set accuracy = 0.954600, Test set accuracy = 0.926900
 epoch 28/30. Took 0.13666 seconds. 
  Full-batch training loss = 0.173068, test loss = 0.241061
  Training set accuracy = 0.953200, Test set accuracy = 0.928200
 epoch 29/30. Took 0.13691 seconds. 
  Full-batch training loss = 0.169539, test loss = 0.242077
  Training set accuracy = 0.954600, Test set accuracy = 0.927800
 epoch 30/30. Took 0.13376 seconds. 
  Full-batch training loss = 0.166344, test loss = 0.238426
  Training set accuracy = 0.955800, Test set accuracy = 0.927400
Elapsed time is 9.486620 seconds.
End Training
-----
Params 5000 0.010 0.10 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23452 seconds. 
  Full-batch training loss = 1.744807, test loss = 1.735641
  Training set accuracy = 0.709200, Test set accuracy = 0.716300
 epoch 2/30. Took 0.22697 seconds. 
  Full-batch training loss = 0.919967, test loss = 0.901625
  Training set accuracy = 0.807200, Test set accuracy = 0.815600
 epoch 3/30. Took 0.22831 seconds. 
  Full-batch training loss = 0.620113, test loss = 0.605954
  Training set accuracy = 0.846800, Test set accuracy = 0.849800
 epoch 4/30. Took 0.23539 seconds. 
  Full-batch training loss = 0.509082, test loss = 0.501332
  Training set accuracy = 0.874600, Test set accuracy = 0.870300
 epoch 5/30. Took 0.22879 seconds. 
  Full-batch training loss = 0.445409, test loss = 0.442955
  Training set accuracy = 0.885200, Test set accuracy = 0.883900
 epoch 6/30. Took 0.22702 seconds. 
  Full-batch training loss = 0.400036, test loss = 0.405237
  Training set accuracy = 0.891800, Test set accuracy = 0.890000
 epoch 7/30. Took 0.23988 seconds. 
  Full-batch training loss = 0.368029, test loss = 0.377194
  Training set accuracy = 0.905400, Test set accuracy = 0.895300
 epoch 8/30. Took 0.22811 seconds. 
  Full-batch training loss = 0.343331, test loss = 0.359358
  Training set accuracy = 0.908400, Test set accuracy = 0.900000
 epoch 9/30. Took 0.22811 seconds. 
  Full-batch training loss = 0.325418, test loss = 0.343461
  Training set accuracy = 0.912200, Test set accuracy = 0.902400
 epoch 10/30. Took 0.22767 seconds. 
  Full-batch training loss = 0.305003, test loss = 0.331649
  Training set accuracy = 0.917800, Test set accuracy = 0.904700
 epoch 11/30. Took 0.22945 seconds. 
  Full-batch training loss = 0.290793, test loss = 0.324605
  Training set accuracy = 0.922600, Test set accuracy = 0.907600
 epoch 12/30. Took 0.22853 seconds. 
  Full-batch training loss = 0.280193, test loss = 0.318582
  Training set accuracy = 0.925000, Test set accuracy = 0.907800
 epoch 13/30. Took 0.22565 seconds. 
  Full-batch training loss = 0.264832, test loss = 0.301951
  Training set accuracy = 0.926600, Test set accuracy = 0.914300
 epoch 14/30. Took 0.22536 seconds. 
  Full-batch training loss = 0.257208, test loss = 0.298046
  Training set accuracy = 0.928400, Test set accuracy = 0.914000
 epoch 15/30. Took 0.22872 seconds. 
  Full-batch training loss = 0.244106, test loss = 0.290309
  Training set accuracy = 0.933200, Test set accuracy = 0.915600
 epoch 16/30. Took 0.22887 seconds. 
  Full-batch training loss = 0.233778, test loss = 0.283267
  Training set accuracy = 0.935000, Test set accuracy = 0.917800
 epoch 17/30. Took 0.25877 seconds. 
  Full-batch training loss = 0.225108, test loss = 0.279253
  Training set accuracy = 0.938200, Test set accuracy = 0.916100
 epoch 18/30. Took 0.22571 seconds. 
  Full-batch training loss = 0.216554, test loss = 0.276122
  Training set accuracy = 0.941800, Test set accuracy = 0.918200
 epoch 19/30. Took 0.22668 seconds. 
  Full-batch training loss = 0.213108, test loss = 0.280728
  Training set accuracy = 0.942600, Test set accuracy = 0.917800
 epoch 20/30. Took 0.22908 seconds. 
  Full-batch training loss = 0.200106, test loss = 0.264600
  Training set accuracy = 0.946200, Test set accuracy = 0.923000
 epoch 21/30. Took 0.22915 seconds. 
  Full-batch training loss = 0.192406, test loss = 0.263046
  Training set accuracy = 0.947600, Test set accuracy = 0.922000
 epoch 22/30. Took 0.22831 seconds. 
  Full-batch training loss = 0.185333, test loss = 0.257156
  Training set accuracy = 0.948400, Test set accuracy = 0.923400
 epoch 23/30. Took 0.22881 seconds. 
  Full-batch training loss = 0.178727, test loss = 0.253406
  Training set accuracy = 0.952200, Test set accuracy = 0.925600
 epoch 24/30. Took 0.23014 seconds. 
  Full-batch training loss = 0.172863, test loss = 0.250243
  Training set accuracy = 0.952800, Test set accuracy = 0.927400
 epoch 25/30. Took 0.2288 seconds. 
  Full-batch training loss = 0.168257, test loss = 0.251540
  Training set accuracy = 0.954400, Test set accuracy = 0.924900
 epoch 26/30. Took 0.22194 seconds. 
  Full-batch training loss = 0.160406, test loss = 0.245546
  Training set accuracy = 0.958800, Test set accuracy = 0.927300
 epoch 27/30. Took 0.22939 seconds. 
  Full-batch training loss = 0.155323, test loss = 0.242764
  Training set accuracy = 0.960200, Test set accuracy = 0.929000
 epoch 28/30. Took 0.23244 seconds. 
  Full-batch training loss = 0.150571, test loss = 0.238398
  Training set accuracy = 0.961800, Test set accuracy = 0.929900
 epoch 29/30. Took 0.22969 seconds. 
  Full-batch training loss = 0.145203, test loss = 0.238893
  Training set accuracy = 0.964000, Test set accuracy = 0.928800
 epoch 30/30. Took 0.22858 seconds. 
  Full-batch training loss = 0.138823, test loss = 0.232103
  Training set accuracy = 0.964800, Test set accuracy = 0.930000
Elapsed time is 15.326881 seconds.
End Training
-----
Params 5000 0.010 0.10 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.6197 seconds. 
  Full-batch training loss = 1.599776, test loss = 1.591640
  Training set accuracy = 0.742000, Test set accuracy = 0.751300
 epoch 2/30. Took 0.595 seconds. 
  Full-batch training loss = 0.806811, test loss = 0.792111
  Training set accuracy = 0.837000, Test set accuracy = 0.836600
 epoch 3/30. Took 0.59803 seconds. 
  Full-batch training loss = 0.555806, test loss = 0.557219
  Training set accuracy = 0.862000, Test set accuracy = 0.860900
 epoch 4/30. Took 0.6013 seconds. 
  Full-batch training loss = 0.448782, test loss = 0.456404
  Training set accuracy = 0.884000, Test set accuracy = 0.879300
 epoch 5/30. Took 0.59569 seconds. 
  Full-batch training loss = 0.394130, test loss = 0.414382
  Training set accuracy = 0.895200, Test set accuracy = 0.886700
 epoch 6/30. Took 0.60724 seconds. 
  Full-batch training loss = 0.352391, test loss = 0.379643
  Training set accuracy = 0.902600, Test set accuracy = 0.895000
 epoch 7/30. Took 0.59596 seconds. 
  Full-batch training loss = 0.335117, test loss = 0.362864
  Training set accuracy = 0.905000, Test set accuracy = 0.896200
 epoch 8/30. Took 0.63158 seconds. 
  Full-batch training loss = 0.307306, test loss = 0.351130
  Training set accuracy = 0.914400, Test set accuracy = 0.898500
 epoch 9/30. Took 0.58808 seconds. 
  Full-batch training loss = 0.284282, test loss = 0.331464
  Training set accuracy = 0.923600, Test set accuracy = 0.905700
 epoch 10/30. Took 0.59055 seconds. 
  Full-batch training loss = 0.272029, test loss = 0.325489
  Training set accuracy = 0.926800, Test set accuracy = 0.907500
 epoch 11/30. Took 0.59298 seconds. 
  Full-batch training loss = 0.258692, test loss = 0.319012
  Training set accuracy = 0.928200, Test set accuracy = 0.908500
 epoch 12/30. Took 0.59412 seconds. 
  Full-batch training loss = 0.245964, test loss = 0.312302
  Training set accuracy = 0.934400, Test set accuracy = 0.909900
 epoch 13/30. Took 0.59266 seconds. 
  Full-batch training loss = 0.235754, test loss = 0.308035
  Training set accuracy = 0.934200, Test set accuracy = 0.910700
 epoch 14/30. Took 0.59309 seconds. 
  Full-batch training loss = 0.224288, test loss = 0.296809
  Training set accuracy = 0.941000, Test set accuracy = 0.913700
 epoch 15/30. Took 0.59278 seconds. 
  Full-batch training loss = 0.219957, test loss = 0.294454
  Training set accuracy = 0.940000, Test set accuracy = 0.913800
 epoch 16/30. Took 0.59174 seconds. 
  Full-batch training loss = 0.220555, test loss = 0.298663
  Training set accuracy = 0.938600, Test set accuracy = 0.910800
 epoch 17/30. Took 0.60835 seconds. 
  Full-batch training loss = 0.196788, test loss = 0.280947
  Training set accuracy = 0.947800, Test set accuracy = 0.917600
 epoch 18/30. Took 0.60412 seconds. 
  Full-batch training loss = 0.194688, test loss = 0.280562
  Training set accuracy = 0.949800, Test set accuracy = 0.918100
 epoch 19/30. Took 0.59874 seconds. 
  Full-batch training loss = 0.180906, test loss = 0.274544
  Training set accuracy = 0.952000, Test set accuracy = 0.919500
 epoch 20/30. Took 0.59391 seconds. 
  Full-batch training loss = 0.177738, test loss = 0.277731
  Training set accuracy = 0.952600, Test set accuracy = 0.917500
 epoch 21/30. Took 0.59051 seconds. 
  Full-batch training loss = 0.172216, test loss = 0.269014
  Training set accuracy = 0.954800, Test set accuracy = 0.921200
 epoch 22/30. Took 0.62193 seconds. 
  Full-batch training loss = 0.164755, test loss = 0.270085
  Training set accuracy = 0.955000, Test set accuracy = 0.920800
 epoch 23/30. Took 0.59917 seconds. 
  Full-batch training loss = 0.157199, test loss = 0.263411
  Training set accuracy = 0.959200, Test set accuracy = 0.922200
 epoch 24/30. Took 0.59442 seconds. 
  Full-batch training loss = 0.151803, test loss = 0.263465
  Training set accuracy = 0.958800, Test set accuracy = 0.923800
 epoch 25/30. Took 0.59208 seconds. 
  Full-batch training loss = 0.146213, test loss = 0.264150
  Training set accuracy = 0.960600, Test set accuracy = 0.922300
 epoch 26/30. Took 0.64406 seconds. 
  Full-batch training loss = 0.139256, test loss = 0.261034
  Training set accuracy = 0.965200, Test set accuracy = 0.922300
 epoch 27/30. Took 0.59302 seconds. 
  Full-batch training loss = 0.134189, test loss = 0.257692
  Training set accuracy = 0.964600, Test set accuracy = 0.924600
 epoch 28/30. Took 0.59138 seconds. 
  Full-batch training loss = 0.129186, test loss = 0.250764
  Training set accuracy = 0.967400, Test set accuracy = 0.925900
 epoch 29/30. Took 0.60818 seconds. 
  Full-batch training loss = 0.121761, test loss = 0.246773
  Training set accuracy = 0.969000, Test set accuracy = 0.926500
 epoch 30/30. Took 0.62751 seconds. 
  Full-batch training loss = 0.118678, test loss = 0.249489
  Training set accuracy = 0.969400, Test set accuracy = 0.927300
Elapsed time is 38.152166 seconds.
End Training
-----
Params 5000 0.010 0.10 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.169 seconds. 
  Full-batch training loss = 2.152140, test loss = 2.152730
  Training set accuracy = 0.400400, Test set accuracy = 0.394400
 epoch 2/30. Took 0.1626 seconds. 
  Full-batch training loss = 1.636679, test loss = 1.628790
  Training set accuracy = 0.658400, Test set accuracy = 0.657700
 epoch 3/30. Took 0.16211 seconds. 
  Full-batch training loss = 0.905980, test loss = 0.901669
  Training set accuracy = 0.766000, Test set accuracy = 0.766500
 epoch 4/30. Took 0.15151 seconds. 
  Full-batch training loss = 0.639278, test loss = 0.634008
  Training set accuracy = 0.833400, Test set accuracy = 0.833400
 epoch 5/30. Took 0.16169 seconds. 
  Full-batch training loss = 0.520561, test loss = 0.529261
  Training set accuracy = 0.854600, Test set accuracy = 0.850800
 epoch 6/30. Took 0.16481 seconds. 
  Full-batch training loss = 0.447654, test loss = 0.457732
  Training set accuracy = 0.880000, Test set accuracy = 0.874800
 epoch 7/30. Took 0.16244 seconds. 
  Full-batch training loss = 0.402075, test loss = 0.423700
  Training set accuracy = 0.888800, Test set accuracy = 0.879200
 epoch 8/30. Took 0.16314 seconds. 
  Full-batch training loss = 0.368244, test loss = 0.393961
  Training set accuracy = 0.898400, Test set accuracy = 0.885500
 epoch 9/30. Took 0.16253 seconds. 
  Full-batch training loss = 0.346775, test loss = 0.377737
  Training set accuracy = 0.897400, Test set accuracy = 0.888500
 epoch 10/30. Took 0.16262 seconds. 
  Full-batch training loss = 0.312049, test loss = 0.350980
  Training set accuracy = 0.911800, Test set accuracy = 0.898300
 epoch 11/30. Took 0.16256 seconds. 
  Full-batch training loss = 0.301782, test loss = 0.349775
  Training set accuracy = 0.916400, Test set accuracy = 0.896500
 epoch 12/30. Took 0.16231 seconds. 
  Full-batch training loss = 0.283441, test loss = 0.329125
  Training set accuracy = 0.918600, Test set accuracy = 0.901200
 epoch 13/30. Took 0.15472 seconds. 
  Full-batch training loss = 0.269214, test loss = 0.324095
  Training set accuracy = 0.922600, Test set accuracy = 0.903900
 epoch 14/30. Took 0.16213 seconds. 
  Full-batch training loss = 0.249372, test loss = 0.307490
  Training set accuracy = 0.928600, Test set accuracy = 0.909400
 epoch 15/30. Took 0.15548 seconds. 
  Full-batch training loss = 0.235885, test loss = 0.297006
  Training set accuracy = 0.932600, Test set accuracy = 0.911800
 epoch 16/30. Took 0.16014 seconds. 
  Full-batch training loss = 0.231060, test loss = 0.298571
  Training set accuracy = 0.934800, Test set accuracy = 0.910500
 epoch 17/30. Took 0.16264 seconds. 
  Full-batch training loss = 0.219576, test loss = 0.291318
  Training set accuracy = 0.935000, Test set accuracy = 0.910200
 epoch 18/30. Took 0.16159 seconds. 
  Full-batch training loss = 0.206974, test loss = 0.283303
  Training set accuracy = 0.940600, Test set accuracy = 0.913500
 epoch 19/30. Took 0.15157 seconds. 
  Full-batch training loss = 0.196059, test loss = 0.277220
  Training set accuracy = 0.944200, Test set accuracy = 0.916400
 epoch 20/30. Took 0.15646 seconds. 
  Full-batch training loss = 0.190308, test loss = 0.270184
  Training set accuracy = 0.944600, Test set accuracy = 0.917100
 epoch 21/30. Took 0.16124 seconds. 
  Full-batch training loss = 0.183661, test loss = 0.268991
  Training set accuracy = 0.949000, Test set accuracy = 0.918900
 epoch 22/30. Took 0.16321 seconds. 
  Full-batch training loss = 0.167817, test loss = 0.257633
  Training set accuracy = 0.954600, Test set accuracy = 0.921800
 epoch 23/30. Took 0.16198 seconds. 
  Full-batch training loss = 0.160386, test loss = 0.253083
  Training set accuracy = 0.957400, Test set accuracy = 0.924500
 epoch 24/30. Took 0.15682 seconds. 
  Full-batch training loss = 0.155122, test loss = 0.249218
  Training set accuracy = 0.957800, Test set accuracy = 0.924000
 epoch 25/30. Took 0.16361 seconds. 
  Full-batch training loss = 0.146899, test loss = 0.247411
  Training set accuracy = 0.962000, Test set accuracy = 0.925400
 epoch 26/30. Took 0.16171 seconds. 
  Full-batch training loss = 0.138610, test loss = 0.240502
  Training set accuracy = 0.964000, Test set accuracy = 0.928500
 epoch 27/30. Took 0.16303 seconds. 
  Full-batch training loss = 0.132722, test loss = 0.237037
  Training set accuracy = 0.966400, Test set accuracy = 0.928800
 epoch 28/30. Took 0.15207 seconds. 
  Full-batch training loss = 0.124901, test loss = 0.236278
  Training set accuracy = 0.970200, Test set accuracy = 0.927900
 epoch 29/30. Took 0.16307 seconds. 
  Full-batch training loss = 0.120811, test loss = 0.236218
  Training set accuracy = 0.969000, Test set accuracy = 0.929500
 epoch 30/30. Took 0.16231 seconds. 
  Full-batch training loss = 0.115770, test loss = 0.234267
  Training set accuracy = 0.968800, Test set accuracy = 0.929000
Elapsed time is 10.823802 seconds.
End Training
-----
Params 5000 0.010 0.10 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.29185 seconds. 
  Full-batch training loss = 2.079500, test loss = 2.082764
  Training set accuracy = 0.494800, Test set accuracy = 0.484600
 epoch 2/30. Took 0.26976 seconds. 
  Full-batch training loss = 1.336743, test loss = 1.341250
  Training set accuracy = 0.670800, Test set accuracy = 0.661200
 epoch 3/30. Took 0.2714 seconds. 
  Full-batch training loss = 0.740349, test loss = 0.748083
  Training set accuracy = 0.812800, Test set accuracy = 0.809400
 epoch 4/30. Took 0.29454 seconds. 
  Full-batch training loss = 0.535216, test loss = 0.552047
  Training set accuracy = 0.849200, Test set accuracy = 0.845500
 epoch 5/30. Took 0.28153 seconds. 
  Full-batch training loss = 0.434335, test loss = 0.464884
  Training set accuracy = 0.880600, Test set accuracy = 0.869100
 epoch 6/30. Took 0.28285 seconds. 
  Full-batch training loss = 0.370561, test loss = 0.410823
  Training set accuracy = 0.900000, Test set accuracy = 0.883100
 epoch 7/30. Took 0.28667 seconds. 
  Full-batch training loss = 0.327475, test loss = 0.372044
  Training set accuracy = 0.911800, Test set accuracy = 0.894500
 epoch 8/30. Took 0.27614 seconds. 
  Full-batch training loss = 0.304553, test loss = 0.356778
  Training set accuracy = 0.915400, Test set accuracy = 0.897900
 epoch 9/30. Took 0.28381 seconds. 
  Full-batch training loss = 0.278624, test loss = 0.342823
  Training set accuracy = 0.921600, Test set accuracy = 0.900100
 epoch 10/30. Took 0.29885 seconds. 
  Full-batch training loss = 0.258985, test loss = 0.328187
  Training set accuracy = 0.927400, Test set accuracy = 0.905500
 epoch 11/30. Took 0.29659 seconds. 
  Full-batch training loss = 0.242322, test loss = 0.318987
  Training set accuracy = 0.928600, Test set accuracy = 0.907900
 epoch 12/30. Took 0.28419 seconds. 
  Full-batch training loss = 0.227529, test loss = 0.308315
  Training set accuracy = 0.936600, Test set accuracy = 0.911800
 epoch 13/30. Took 0.29157 seconds. 
  Full-batch training loss = 0.214513, test loss = 0.300750
  Training set accuracy = 0.939000, Test set accuracy = 0.912500
 epoch 14/30. Took 0.29126 seconds. 
  Full-batch training loss = 0.208216, test loss = 0.297588
  Training set accuracy = 0.940400, Test set accuracy = 0.913100
 epoch 15/30. Took 0.3044 seconds. 
  Full-batch training loss = 0.195707, test loss = 0.287180
  Training set accuracy = 0.943800, Test set accuracy = 0.917800
 epoch 16/30. Took 0.28963 seconds. 
  Full-batch training loss = 0.189485, test loss = 0.289098
  Training set accuracy = 0.946000, Test set accuracy = 0.913200
 epoch 17/30. Took 0.27647 seconds. 
  Full-batch training loss = 0.174925, test loss = 0.280797
  Training set accuracy = 0.948400, Test set accuracy = 0.917700
 epoch 18/30. Took 0.27967 seconds. 
  Full-batch training loss = 0.164356, test loss = 0.272615
  Training set accuracy = 0.952000, Test set accuracy = 0.921100
 epoch 19/30. Took 0.28514 seconds. 
  Full-batch training loss = 0.157515, test loss = 0.265222
  Training set accuracy = 0.954400, Test set accuracy = 0.924200
 epoch 20/30. Took 0.28075 seconds. 
  Full-batch training loss = 0.146853, test loss = 0.262189
  Training set accuracy = 0.958200, Test set accuracy = 0.923000
 epoch 21/30. Took 0.28914 seconds. 
  Full-batch training loss = 0.141228, test loss = 0.261406
  Training set accuracy = 0.959200, Test set accuracy = 0.923700
 epoch 22/30. Took 0.2682 seconds. 
  Full-batch training loss = 0.135215, test loss = 0.260642
  Training set accuracy = 0.960800, Test set accuracy = 0.924400
 epoch 23/30. Took 0.31414 seconds. 
  Full-batch training loss = 0.126677, test loss = 0.254939
  Training set accuracy = 0.961200, Test set accuracy = 0.925200
 epoch 24/30. Took 0.28363 seconds. 
  Full-batch training loss = 0.119632, test loss = 0.251136
  Training set accuracy = 0.965200, Test set accuracy = 0.926600
 epoch 25/30. Took 0.30332 seconds. 
  Full-batch training loss = 0.114977, test loss = 0.249140
  Training set accuracy = 0.969800, Test set accuracy = 0.927800
 epoch 26/30. Took 0.26986 seconds. 
  Full-batch training loss = 0.104711, test loss = 0.243176
  Training set accuracy = 0.972200, Test set accuracy = 0.928500
 epoch 27/30. Took 0.27126 seconds. 
  Full-batch training loss = 0.099107, test loss = 0.240209
  Training set accuracy = 0.973800, Test set accuracy = 0.928800
 epoch 28/30. Took 0.28118 seconds. 
  Full-batch training loss = 0.093408, test loss = 0.235052
  Training set accuracy = 0.975800, Test set accuracy = 0.930300
 epoch 29/30. Took 0.28422 seconds. 
  Full-batch training loss = 0.088634, test loss = 0.235591
  Training set accuracy = 0.977400, Test set accuracy = 0.930600
 epoch 30/30. Took 0.27203 seconds. 
  Full-batch training loss = 0.087689, test loss = 0.238927
  Training set accuracy = 0.976600, Test set accuracy = 0.930100
Elapsed time is 18.634544 seconds.
End Training
-----
Params 5000 0.010 0.10 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.85211 seconds. 
  Full-batch training loss = 1.982566, test loss = 1.978661
  Training set accuracy = 0.628600, Test set accuracy = 0.618900
 epoch 2/30. Took 0.86104 seconds. 
  Full-batch training loss = 1.054407, test loss = 1.040623
  Training set accuracy = 0.763000, Test set accuracy = 0.761500
 epoch 3/30. Took 0.82463 seconds. 
  Full-batch training loss = 0.600812, test loss = 0.594596
  Training set accuracy = 0.839200, Test set accuracy = 0.842100
 epoch 4/30. Took 0.81991 seconds. 
  Full-batch training loss = 0.453506, test loss = 0.463737
  Training set accuracy = 0.875600, Test set accuracy = 0.871300
 epoch 5/30. Took 0.82054 seconds. 
  Full-batch training loss = 0.383074, test loss = 0.404284
  Training set accuracy = 0.893400, Test set accuracy = 0.884000
 epoch 6/30. Took 0.82347 seconds. 
  Full-batch training loss = 0.335661, test loss = 0.363391
  Training set accuracy = 0.904800, Test set accuracy = 0.894700
 epoch 7/30. Took 0.84981 seconds. 
  Full-batch training loss = 0.321476, test loss = 0.359238
  Training set accuracy = 0.906400, Test set accuracy = 0.893800
 epoch 8/30. Took 0.8281 seconds. 
  Full-batch training loss = 0.291145, test loss = 0.340225
  Training set accuracy = 0.914600, Test set accuracy = 0.899900
 epoch 9/30. Took 0.82389 seconds. 
  Full-batch training loss = 0.261996, test loss = 0.316300
  Training set accuracy = 0.924400, Test set accuracy = 0.907600
 epoch 10/30. Took 0.82781 seconds. 
  Full-batch training loss = 0.245539, test loss = 0.306884
  Training set accuracy = 0.930600, Test set accuracy = 0.910000
 epoch 11/30. Took 0.82093 seconds. 
  Full-batch training loss = 0.229706, test loss = 0.297043
  Training set accuracy = 0.933400, Test set accuracy = 0.910300
 epoch 12/30. Took 0.84306 seconds. 
  Full-batch training loss = 0.211997, test loss = 0.285260
  Training set accuracy = 0.940400, Test set accuracy = 0.913900
 epoch 13/30. Took 0.82515 seconds. 
  Full-batch training loss = 0.210685, test loss = 0.290316
  Training set accuracy = 0.941000, Test set accuracy = 0.915500
 epoch 14/30. Took 0.85222 seconds. 
  Full-batch training loss = 0.188255, test loss = 0.275774
  Training set accuracy = 0.947400, Test set accuracy = 0.917700
 epoch 15/30. Took 0.9325 seconds. 
  Full-batch training loss = 0.177755, test loss = 0.269525
  Training set accuracy = 0.951400, Test set accuracy = 0.920600
 epoch 16/30. Took 0.85844 seconds. 
  Full-batch training loss = 0.174427, test loss = 0.271915
  Training set accuracy = 0.949400, Test set accuracy = 0.920200
 epoch 17/30. Took 0.82594 seconds. 
  Full-batch training loss = 0.163576, test loss = 0.264047
  Training set accuracy = 0.953600, Test set accuracy = 0.919300
 epoch 18/30. Took 0.9213 seconds. 
  Full-batch training loss = 0.151530, test loss = 0.259621
  Training set accuracy = 0.959200, Test set accuracy = 0.923800
 epoch 19/30. Took 0.84633 seconds. 
  Full-batch training loss = 0.140105, test loss = 0.248214
  Training set accuracy = 0.960200, Test set accuracy = 0.927500
 epoch 20/30. Took 0.87698 seconds. 
  Full-batch training loss = 0.132532, test loss = 0.248424
  Training set accuracy = 0.963000, Test set accuracy = 0.925700
 epoch 21/30. Took 0.8372 seconds. 
  Full-batch training loss = 0.121997, test loss = 0.242723
  Training set accuracy = 0.967400, Test set accuracy = 0.925900
 epoch 22/30. Took 0.81683 seconds. 
  Full-batch training loss = 0.116814, test loss = 0.243683
  Training set accuracy = 0.969200, Test set accuracy = 0.928800
 epoch 23/30. Took 0.85092 seconds. 
  Full-batch training loss = 0.106496, test loss = 0.239342
  Training set accuracy = 0.973000, Test set accuracy = 0.927400
 epoch 24/30. Took 0.81912 seconds. 
  Full-batch training loss = 0.099898, test loss = 0.231502
  Training set accuracy = 0.973800, Test set accuracy = 0.930400
 epoch 25/30. Took 0.81803 seconds. 
  Full-batch training loss = 0.092471, test loss = 0.224525
  Training set accuracy = 0.976000, Test set accuracy = 0.932700
 epoch 26/30. Took 0.8507 seconds. 
  Full-batch training loss = 0.090051, test loss = 0.229594
  Training set accuracy = 0.977800, Test set accuracy = 0.931300
 epoch 27/30. Took 0.82272 seconds. 
  Full-batch training loss = 0.080453, test loss = 0.221777
  Training set accuracy = 0.980400, Test set accuracy = 0.932900
 epoch 28/30. Took 0.82819 seconds. 
  Full-batch training loss = 0.073943, test loss = 0.216153
  Training set accuracy = 0.982400, Test set accuracy = 0.935600
 epoch 29/30. Took 0.82404 seconds. 
  Full-batch training loss = 0.071644, test loss = 0.221370
  Training set accuracy = 0.983000, Test set accuracy = 0.934900
 epoch 30/30. Took 0.82475 seconds. 
  Full-batch training loss = 0.066874, test loss = 0.214657
  Training set accuracy = 0.982800, Test set accuracy = 0.936300
Elapsed time is 52.855581 seconds.
End Training
-----
Params 5000 0.010 0.20 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.12429 seconds. 
  Full-batch training loss = 1.623687, test loss = 1.615099
  Training set accuracy = 0.707000, Test set accuracy = 0.707800
 epoch 2/30. Took 0.10578 seconds. 
  Full-batch training loss = 1.031253, test loss = 1.013916
  Training set accuracy = 0.806800, Test set accuracy = 0.809900
 epoch 3/30. Took 0.1044 seconds. 
  Full-batch training loss = 0.759929, test loss = 0.742735
  Training set accuracy = 0.836200, Test set accuracy = 0.837600
 epoch 4/30. Took 0.10859 seconds. 
  Full-batch training loss = 0.626978, test loss = 0.614109
  Training set accuracy = 0.848400, Test set accuracy = 0.854000
 epoch 5/30. Took 0.10776 seconds. 
  Full-batch training loss = 0.546130, test loss = 0.537697
  Training set accuracy = 0.866000, Test set accuracy = 0.872500
 epoch 6/30. Took 0.10753 seconds. 
  Full-batch training loss = 0.492512, test loss = 0.488065
  Training set accuracy = 0.873600, Test set accuracy = 0.877200
 epoch 7/30. Took 0.10876 seconds. 
  Full-batch training loss = 0.455998, test loss = 0.454247
  Training set accuracy = 0.881600, Test set accuracy = 0.881100
 epoch 8/30. Took 0.10881 seconds. 
  Full-batch training loss = 0.426887, test loss = 0.431329
  Training set accuracy = 0.886200, Test set accuracy = 0.885600
 epoch 9/30. Took 0.10743 seconds. 
  Full-batch training loss = 0.402720, test loss = 0.408166
  Training set accuracy = 0.893000, Test set accuracy = 0.889800
 epoch 10/30. Took 0.10452 seconds. 
  Full-batch training loss = 0.384924, test loss = 0.394500
  Training set accuracy = 0.895200, Test set accuracy = 0.893700
 epoch 11/30. Took 0.10879 seconds. 
  Full-batch training loss = 0.371375, test loss = 0.384800
  Training set accuracy = 0.897600, Test set accuracy = 0.895200
 epoch 12/30. Took 0.11086 seconds. 
  Full-batch training loss = 0.357336, test loss = 0.372496
  Training set accuracy = 0.900200, Test set accuracy = 0.896000
 epoch 13/30. Took 0.11566 seconds. 
  Full-batch training loss = 0.344016, test loss = 0.362285
  Training set accuracy = 0.903200, Test set accuracy = 0.899000
 epoch 14/30. Took 0.10806 seconds. 
  Full-batch training loss = 0.332510, test loss = 0.354493
  Training set accuracy = 0.906800, Test set accuracy = 0.900500
 epoch 15/30. Took 0.10849 seconds. 
  Full-batch training loss = 0.322011, test loss = 0.346502
  Training set accuracy = 0.908800, Test set accuracy = 0.901300
 epoch 16/30. Took 0.10417 seconds. 
  Full-batch training loss = 0.314088, test loss = 0.341046
  Training set accuracy = 0.911800, Test set accuracy = 0.902800
 epoch 17/30. Took 0.10749 seconds. 
  Full-batch training loss = 0.305861, test loss = 0.336403
  Training set accuracy = 0.912400, Test set accuracy = 0.904300
 epoch 18/30. Took 0.10802 seconds. 
  Full-batch training loss = 0.297579, test loss = 0.330058
  Training set accuracy = 0.915800, Test set accuracy = 0.905200
 epoch 19/30. Took 0.10815 seconds. 
  Full-batch training loss = 0.290181, test loss = 0.324739
  Training set accuracy = 0.919000, Test set accuracy = 0.906100
 epoch 20/30. Took 0.10533 seconds. 
  Full-batch training loss = 0.284207, test loss = 0.321913
  Training set accuracy = 0.919000, Test set accuracy = 0.907100
 epoch 21/30. Took 0.10804 seconds. 
  Full-batch training loss = 0.278388, test loss = 0.316019
  Training set accuracy = 0.923600, Test set accuracy = 0.910300
 epoch 22/30. Took 0.10884 seconds. 
  Full-batch training loss = 0.271234, test loss = 0.312005
  Training set accuracy = 0.924000, Test set accuracy = 0.909900
 epoch 23/30. Took 0.10736 seconds. 
  Full-batch training loss = 0.265920, test loss = 0.308967
  Training set accuracy = 0.924200, Test set accuracy = 0.909700
 epoch 24/30. Took 0.10696 seconds. 
  Full-batch training loss = 0.260479, test loss = 0.305971
  Training set accuracy = 0.928000, Test set accuracy = 0.911900
 epoch 25/30. Took 0.10783 seconds. 
  Full-batch training loss = 0.253882, test loss = 0.302260
  Training set accuracy = 0.929400, Test set accuracy = 0.913200
 epoch 26/30. Took 0.10774 seconds. 
  Full-batch training loss = 0.249883, test loss = 0.298730
  Training set accuracy = 0.931200, Test set accuracy = 0.912900
 epoch 27/30. Took 0.10799 seconds. 
  Full-batch training loss = 0.243925, test loss = 0.296025
  Training set accuracy = 0.933000, Test set accuracy = 0.913800
 epoch 28/30. Took 0.10922 seconds. 
  Full-batch training loss = 0.239794, test loss = 0.294271
  Training set accuracy = 0.934200, Test set accuracy = 0.913700
 epoch 29/30. Took 0.10723 seconds. 
  Full-batch training loss = 0.232896, test loss = 0.288839
  Training set accuracy = 0.938200, Test set accuracy = 0.915500
 epoch 30/30. Took 0.1083 seconds. 
  Full-batch training loss = 0.229386, test loss = 0.288323
  Training set accuracy = 0.939000, Test set accuracy = 0.915700
Elapsed time is 7.987216 seconds.
End Training
-----
Params 5000 0.010 0.20 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17507 seconds. 
  Full-batch training loss = 1.591906, test loss = 1.585613
  Training set accuracy = 0.705000, Test set accuracy = 0.703400
 epoch 2/30. Took 0.16652 seconds. 
  Full-batch training loss = 0.996786, test loss = 0.983758
  Training set accuracy = 0.789600, Test set accuracy = 0.789400
 epoch 3/30. Took 0.16786 seconds. 
  Full-batch training loss = 0.730571, test loss = 0.716934
  Training set accuracy = 0.837800, Test set accuracy = 0.838000
 epoch 4/30. Took 0.17075 seconds. 
  Full-batch training loss = 0.604789, test loss = 0.592636
  Training set accuracy = 0.860600, Test set accuracy = 0.866200
 epoch 5/30. Took 0.17226 seconds. 
  Full-batch training loss = 0.527069, test loss = 0.518700
  Training set accuracy = 0.870400, Test set accuracy = 0.875300
 epoch 6/30. Took 0.18529 seconds. 
  Full-batch training loss = 0.476539, test loss = 0.471129
  Training set accuracy = 0.880800, Test set accuracy = 0.882700
 epoch 7/30. Took 0.16562 seconds. 
  Full-batch training loss = 0.441362, test loss = 0.440591
  Training set accuracy = 0.887000, Test set accuracy = 0.886300
 epoch 8/30. Took 0.16775 seconds. 
  Full-batch training loss = 0.415800, test loss = 0.416424
  Training set accuracy = 0.895000, Test set accuracy = 0.892300
 epoch 9/30. Took 0.16978 seconds. 
  Full-batch training loss = 0.394272, test loss = 0.399624
  Training set accuracy = 0.899200, Test set accuracy = 0.894600
 epoch 10/30. Took 0.16892 seconds. 
  Full-batch training loss = 0.376369, test loss = 0.384141
  Training set accuracy = 0.897800, Test set accuracy = 0.895500
 epoch 11/30. Took 0.18143 seconds. 
  Full-batch training loss = 0.360263, test loss = 0.370025
  Training set accuracy = 0.903000, Test set accuracy = 0.898500
 epoch 12/30. Took 0.16977 seconds. 
  Full-batch training loss = 0.347615, test loss = 0.359588
  Training set accuracy = 0.907000, Test set accuracy = 0.903500
 epoch 13/30. Took 0.1695 seconds. 
  Full-batch training loss = 0.336698, test loss = 0.351556
  Training set accuracy = 0.908600, Test set accuracy = 0.903400
 epoch 14/30. Took 0.17003 seconds. 
  Full-batch training loss = 0.325878, test loss = 0.343804
  Training set accuracy = 0.909200, Test set accuracy = 0.905600
 epoch 15/30. Took 0.16872 seconds. 
  Full-batch training loss = 0.316427, test loss = 0.336131
  Training set accuracy = 0.914800, Test set accuracy = 0.907600
 epoch 16/30. Took 0.16889 seconds. 
  Full-batch training loss = 0.308268, test loss = 0.330289
  Training set accuracy = 0.914600, Test set accuracy = 0.908900
 epoch 17/30. Took 0.16921 seconds. 
  Full-batch training loss = 0.300184, test loss = 0.327063
  Training set accuracy = 0.918000, Test set accuracy = 0.910200
 epoch 18/30. Took 0.16935 seconds. 
  Full-batch training loss = 0.291652, test loss = 0.319761
  Training set accuracy = 0.920200, Test set accuracy = 0.911700
 epoch 19/30. Took 0.17031 seconds. 
  Full-batch training loss = 0.284545, test loss = 0.313621
  Training set accuracy = 0.923400, Test set accuracy = 0.913700
 epoch 20/30. Took 0.1688 seconds. 
  Full-batch training loss = 0.278012, test loss = 0.310239
  Training set accuracy = 0.923600, Test set accuracy = 0.914500
 epoch 21/30. Took 0.18368 seconds. 
  Full-batch training loss = 0.272211, test loss = 0.306154
  Training set accuracy = 0.925800, Test set accuracy = 0.914100
 epoch 22/30. Took 0.16783 seconds. 
  Full-batch training loss = 0.266533, test loss = 0.303169
  Training set accuracy = 0.925600, Test set accuracy = 0.916700
 epoch 23/30. Took 0.1695 seconds. 
  Full-batch training loss = 0.261697, test loss = 0.300850
  Training set accuracy = 0.928800, Test set accuracy = 0.916700
 epoch 24/30. Took 0.17 seconds. 
  Full-batch training loss = 0.254901, test loss = 0.296087
  Training set accuracy = 0.931800, Test set accuracy = 0.917500
 epoch 25/30. Took 0.1697 seconds. 
  Full-batch training loss = 0.249831, test loss = 0.292111
  Training set accuracy = 0.933000, Test set accuracy = 0.917800
 epoch 26/30. Took 0.16971 seconds. 
  Full-batch training loss = 0.244520, test loss = 0.289049
  Training set accuracy = 0.934200, Test set accuracy = 0.917400
 epoch 27/30. Took 0.18657 seconds. 
  Full-batch training loss = 0.240094, test loss = 0.286779
  Training set accuracy = 0.935200, Test set accuracy = 0.919200
 epoch 28/30. Took 0.17237 seconds. 
  Full-batch training loss = 0.236335, test loss = 0.285877
  Training set accuracy = 0.937600, Test set accuracy = 0.919600
 epoch 29/30. Took 0.17255 seconds. 
  Full-batch training loss = 0.232325, test loss = 0.282159
  Training set accuracy = 0.938800, Test set accuracy = 0.919100
 epoch 30/30. Took 0.16588 seconds. 
  Full-batch training loss = 0.225958, test loss = 0.278568
  Training set accuracy = 0.941200, Test set accuracy = 0.921800
Elapsed time is 11.832328 seconds.
End Training
-----
Params 5000 0.010 0.20 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.36649 seconds. 
  Full-batch training loss = 1.369215, test loss = 1.367963
  Training set accuracy = 0.770000, Test set accuracy = 0.773600
 epoch 2/30. Took 0.35642 seconds. 
  Full-batch training loss = 0.836314, test loss = 0.832861
  Training set accuracy = 0.826400, Test set accuracy = 0.829100
 epoch 3/30. Took 0.35629 seconds. 
  Full-batch training loss = 0.633729, test loss = 0.632230
  Training set accuracy = 0.857200, Test set accuracy = 0.861000
 epoch 4/30. Took 0.35462 seconds. 
  Full-batch training loss = 0.532018, test loss = 0.534010
  Training set accuracy = 0.870600, Test set accuracy = 0.870900
 epoch 5/30. Took 0.35632 seconds. 
  Full-batch training loss = 0.472202, test loss = 0.475980
  Training set accuracy = 0.880400, Test set accuracy = 0.880900
 epoch 6/30. Took 0.3688 seconds. 
  Full-batch training loss = 0.433382, test loss = 0.439016
  Training set accuracy = 0.889000, Test set accuracy = 0.887900
 epoch 7/30. Took 0.36117 seconds. 
  Full-batch training loss = 0.401181, test loss = 0.413170
  Training set accuracy = 0.894400, Test set accuracy = 0.891900
 epoch 8/30. Took 0.35746 seconds. 
  Full-batch training loss = 0.378280, test loss = 0.395181
  Training set accuracy = 0.899000, Test set accuracy = 0.894700
 epoch 9/30. Took 0.35611 seconds. 
  Full-batch training loss = 0.358787, test loss = 0.377575
  Training set accuracy = 0.902200, Test set accuracy = 0.898300
 epoch 10/30. Took 0.35908 seconds. 
  Full-batch training loss = 0.343637, test loss = 0.367704
  Training set accuracy = 0.906800, Test set accuracy = 0.898600
 epoch 11/30. Took 0.3509 seconds. 
  Full-batch training loss = 0.330403, test loss = 0.353528
  Training set accuracy = 0.911600, Test set accuracy = 0.904700
 epoch 12/30. Took 0.35688 seconds. 
  Full-batch training loss = 0.316671, test loss = 0.345757
  Training set accuracy = 0.914000, Test set accuracy = 0.905000
 epoch 13/30. Took 0.35615 seconds. 
  Full-batch training loss = 0.305649, test loss = 0.339652
  Training set accuracy = 0.917800, Test set accuracy = 0.905600
 epoch 14/30. Took 0.35367 seconds. 
  Full-batch training loss = 0.296184, test loss = 0.331527
  Training set accuracy = 0.921000, Test set accuracy = 0.906700
 epoch 15/30. Took 0.35389 seconds. 
  Full-batch training loss = 0.287572, test loss = 0.327292
  Training set accuracy = 0.922000, Test set accuracy = 0.908000
 epoch 16/30. Took 0.3507 seconds. 
  Full-batch training loss = 0.279266, test loss = 0.321725
  Training set accuracy = 0.924000, Test set accuracy = 0.909200
 epoch 17/30. Took 0.35669 seconds. 
  Full-batch training loss = 0.271527, test loss = 0.316336
  Training set accuracy = 0.925800, Test set accuracy = 0.910200
 epoch 18/30. Took 0.39245 seconds. 
  Full-batch training loss = 0.264966, test loss = 0.310966
  Training set accuracy = 0.928000, Test set accuracy = 0.911700
 epoch 19/30. Took 0.3509 seconds. 
  Full-batch training loss = 0.257803, test loss = 0.306284
  Training set accuracy = 0.928000, Test set accuracy = 0.914100
 epoch 20/30. Took 0.35284 seconds. 
  Full-batch training loss = 0.252687, test loss = 0.306160
  Training set accuracy = 0.932200, Test set accuracy = 0.914000
 epoch 21/30. Took 0.39893 seconds. 
  Full-batch training loss = 0.246233, test loss = 0.301233
  Training set accuracy = 0.933400, Test set accuracy = 0.915600
 epoch 22/30. Took 0.36235 seconds. 
  Full-batch training loss = 0.240120, test loss = 0.298366
  Training set accuracy = 0.935400, Test set accuracy = 0.915700
 epoch 23/30. Took 0.35471 seconds. 
  Full-batch training loss = 0.236088, test loss = 0.294715
  Training set accuracy = 0.934800, Test set accuracy = 0.916300
 epoch 24/30. Took 0.35665 seconds. 
  Full-batch training loss = 0.228922, test loss = 0.289572
  Training set accuracy = 0.937600, Test set accuracy = 0.917700
 epoch 25/30. Took 0.37105 seconds. 
  Full-batch training loss = 0.224711, test loss = 0.286881
  Training set accuracy = 0.940000, Test set accuracy = 0.917500
 epoch 26/30. Took 0.34924 seconds. 
  Full-batch training loss = 0.219949, test loss = 0.284241
  Training set accuracy = 0.939200, Test set accuracy = 0.920300
 epoch 27/30. Took 0.36661 seconds. 
  Full-batch training loss = 0.215951, test loss = 0.283255
  Training set accuracy = 0.943200, Test set accuracy = 0.919700
 epoch 28/30. Took 0.35481 seconds. 
  Full-batch training loss = 0.210672, test loss = 0.281395
  Training set accuracy = 0.944600, Test set accuracy = 0.919900
 epoch 29/30. Took 0.36167 seconds. 
  Full-batch training loss = 0.205572, test loss = 0.278174
  Training set accuracy = 0.945800, Test set accuracy = 0.920700
 epoch 30/30. Took 0.35672 seconds. 
  Full-batch training loss = 0.201146, test loss = 0.274723
  Training set accuracy = 0.947800, Test set accuracy = 0.921400
Elapsed time is 23.485055 seconds.
End Training
-----
Params 5000 0.010 0.20 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14145 seconds. 
  Full-batch training loss = 2.110212, test loss = 2.104584
  Training set accuracy = 0.435400, Test set accuracy = 0.437900
 epoch 2/30. Took 0.13537 seconds. 
  Full-batch training loss = 1.610824, test loss = 1.599103
  Training set accuracy = 0.661800, Test set accuracy = 0.653800
 epoch 3/30. Took 0.13654 seconds. 
  Full-batch training loss = 1.059976, test loss = 1.045313
  Training set accuracy = 0.799200, Test set accuracy = 0.794700
 epoch 4/30. Took 0.13034 seconds. 
  Full-batch training loss = 0.772418, test loss = 0.760724
  Training set accuracy = 0.823400, Test set accuracy = 0.826300
 epoch 5/30. Took 0.13029 seconds. 
  Full-batch training loss = 0.622560, test loss = 0.618184
  Training set accuracy = 0.846600, Test set accuracy = 0.847100
 epoch 6/30. Took 0.13128 seconds. 
  Full-batch training loss = 0.530945, test loss = 0.531277
  Training set accuracy = 0.871600, Test set accuracy = 0.865100
 epoch 7/30. Took 0.12987 seconds. 
  Full-batch training loss = 0.471412, test loss = 0.478796
  Training set accuracy = 0.875200, Test set accuracy = 0.872300
 epoch 8/30. Took 0.13043 seconds. 
  Full-batch training loss = 0.425407, test loss = 0.438734
  Training set accuracy = 0.889800, Test set accuracy = 0.883800
 epoch 9/30. Took 0.13403 seconds. 
  Full-batch training loss = 0.393221, test loss = 0.409671
  Training set accuracy = 0.896600, Test set accuracy = 0.889700
 epoch 10/30. Took 0.1355 seconds. 
  Full-batch training loss = 0.368493, test loss = 0.390259
  Training set accuracy = 0.899800, Test set accuracy = 0.892900
 epoch 11/30. Took 0.13822 seconds. 
  Full-batch training loss = 0.346946, test loss = 0.369629
  Training set accuracy = 0.906200, Test set accuracy = 0.898600
 epoch 12/30. Took 0.13651 seconds. 
  Full-batch training loss = 0.328650, test loss = 0.361255
  Training set accuracy = 0.909200, Test set accuracy = 0.899800
 epoch 13/30. Took 0.13947 seconds. 
  Full-batch training loss = 0.312879, test loss = 0.346079
  Training set accuracy = 0.913200, Test set accuracy = 0.901800
 epoch 14/30. Took 0.13971 seconds. 
  Full-batch training loss = 0.298880, test loss = 0.336660
  Training set accuracy = 0.917800, Test set accuracy = 0.904600
 epoch 15/30. Took 0.13742 seconds. 
  Full-batch training loss = 0.290663, test loss = 0.328741
  Training set accuracy = 0.921200, Test set accuracy = 0.907000
 epoch 16/30. Took 0.13934 seconds. 
  Full-batch training loss = 0.277892, test loss = 0.323240
  Training set accuracy = 0.920400, Test set accuracy = 0.907900
 epoch 17/30. Took 0.13817 seconds. 
  Full-batch training loss = 0.271044, test loss = 0.315761
  Training set accuracy = 0.923400, Test set accuracy = 0.907700
 epoch 18/30. Took 0.13652 seconds. 
  Full-batch training loss = 0.259537, test loss = 0.308707
  Training set accuracy = 0.929400, Test set accuracy = 0.912200
 epoch 19/30. Took 0.13165 seconds. 
  Full-batch training loss = 0.247716, test loss = 0.300516
  Training set accuracy = 0.931200, Test set accuracy = 0.913500
 epoch 20/30. Took 0.13803 seconds. 
  Full-batch training loss = 0.240329, test loss = 0.297814
  Training set accuracy = 0.931800, Test set accuracy = 0.913500
 epoch 21/30. Took 0.13045 seconds. 
  Full-batch training loss = 0.232921, test loss = 0.293037
  Training set accuracy = 0.933200, Test set accuracy = 0.915100
 epoch 22/30. Took 0.13426 seconds. 
  Full-batch training loss = 0.227400, test loss = 0.288645
  Training set accuracy = 0.936600, Test set accuracy = 0.916300
 epoch 23/30. Took 0.13287 seconds. 
  Full-batch training loss = 0.219285, test loss = 0.283954
  Training set accuracy = 0.936400, Test set accuracy = 0.915200
 epoch 24/30. Took 0.13242 seconds. 
  Full-batch training loss = 0.211792, test loss = 0.278043
  Training set accuracy = 0.941000, Test set accuracy = 0.918600
 epoch 25/30. Took 0.13024 seconds. 
  Full-batch training loss = 0.205978, test loss = 0.276771
  Training set accuracy = 0.944000, Test set accuracy = 0.920700
 epoch 26/30. Took 0.1519 seconds. 
  Full-batch training loss = 0.200022, test loss = 0.273192
  Training set accuracy = 0.945200, Test set accuracy = 0.918500
 epoch 27/30. Took 0.13437 seconds. 
  Full-batch training loss = 0.193801, test loss = 0.267102
  Training set accuracy = 0.947800, Test set accuracy = 0.921300
 epoch 28/30. Took 0.12968 seconds. 
  Full-batch training loss = 0.190381, test loss = 0.265283
  Training set accuracy = 0.947600, Test set accuracy = 0.922400
 epoch 29/30. Took 0.14256 seconds. 
  Full-batch training loss = 0.184528, test loss = 0.262361
  Training set accuracy = 0.950000, Test set accuracy = 0.923000
 epoch 30/30. Took 0.14374 seconds. 
  Full-batch training loss = 0.180718, test loss = 0.259900
  Training set accuracy = 0.952000, Test set accuracy = 0.921800
Elapsed time is 9.502259 seconds.
End Training
-----
Params 5000 0.010 0.20 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23706 seconds. 
  Full-batch training loss = 1.993240, test loss = 1.986873
  Training set accuracy = 0.609800, Test set accuracy = 0.621100
 epoch 2/30. Took 0.22657 seconds. 
  Full-batch training loss = 1.365866, test loss = 1.351255
  Training set accuracy = 0.747600, Test set accuracy = 0.760800
 epoch 3/30. Took 0.22784 seconds. 
  Full-batch training loss = 0.870419, test loss = 0.849707
  Training set accuracy = 0.806000, Test set accuracy = 0.812800
 epoch 4/30. Took 0.22821 seconds. 
  Full-batch training loss = 0.648841, test loss = 0.631612
  Training set accuracy = 0.840200, Test set accuracy = 0.848700
 epoch 5/30. Took 0.22768 seconds. 
  Full-batch training loss = 0.544462, test loss = 0.536530
  Training set accuracy = 0.858600, Test set accuracy = 0.867200
 epoch 6/30. Took 0.23586 seconds. 
  Full-batch training loss = 0.471225, test loss = 0.468573
  Training set accuracy = 0.878400, Test set accuracy = 0.881700
 epoch 7/30. Took 0.24418 seconds. 
  Full-batch training loss = 0.426131, test loss = 0.425313
  Training set accuracy = 0.889800, Test set accuracy = 0.891100
 epoch 8/30. Took 0.22767 seconds. 
  Full-batch training loss = 0.397268, test loss = 0.404451
  Training set accuracy = 0.894000, Test set accuracy = 0.892100
 epoch 9/30. Took 0.22319 seconds. 
  Full-batch training loss = 0.370605, test loss = 0.384313
  Training set accuracy = 0.901400, Test set accuracy = 0.892900
 epoch 10/30. Took 0.22579 seconds. 
  Full-batch training loss = 0.349954, test loss = 0.367055
  Training set accuracy = 0.908800, Test set accuracy = 0.900800
 epoch 11/30. Took 0.21986 seconds. 
  Full-batch training loss = 0.336828, test loss = 0.359701
  Training set accuracy = 0.906600, Test set accuracy = 0.898400
 epoch 12/30. Took 0.22411 seconds. 
  Full-batch training loss = 0.317711, test loss = 0.343173
  Training set accuracy = 0.917200, Test set accuracy = 0.903300
 epoch 13/30. Took 0.2441 seconds. 
  Full-batch training loss = 0.303762, test loss = 0.334543
  Training set accuracy = 0.919400, Test set accuracy = 0.904500
 epoch 14/30. Took 0.2371 seconds. 
  Full-batch training loss = 0.290877, test loss = 0.325522
  Training set accuracy = 0.923200, Test set accuracy = 0.905400
 epoch 15/30. Took 0.23277 seconds. 
  Full-batch training loss = 0.283547, test loss = 0.321143
  Training set accuracy = 0.925800, Test set accuracy = 0.907500
 epoch 16/30. Took 0.22877 seconds. 
  Full-batch training loss = 0.270647, test loss = 0.309772
  Training set accuracy = 0.929600, Test set accuracy = 0.910800
 epoch 17/30. Took 0.2244 seconds. 
  Full-batch training loss = 0.261370, test loss = 0.305866
  Training set accuracy = 0.931400, Test set accuracy = 0.911500
 epoch 18/30. Took 0.22334 seconds. 
  Full-batch training loss = 0.251747, test loss = 0.299246
  Training set accuracy = 0.934800, Test set accuracy = 0.911300
 epoch 19/30. Took 0.22668 seconds. 
  Full-batch training loss = 0.246025, test loss = 0.299075
  Training set accuracy = 0.935600, Test set accuracy = 0.912100
 epoch 20/30. Took 0.2244 seconds. 
  Full-batch training loss = 0.237409, test loss = 0.291926
  Training set accuracy = 0.940000, Test set accuracy = 0.914800
 epoch 21/30. Took 0.23444 seconds. 
  Full-batch training loss = 0.234072, test loss = 0.291165
  Training set accuracy = 0.937400, Test set accuracy = 0.911900
 epoch 22/30. Took 0.22395 seconds. 
  Full-batch training loss = 0.226645, test loss = 0.287076
  Training set accuracy = 0.941000, Test set accuracy = 0.915200
 epoch 23/30. Took 0.229 seconds. 
  Full-batch training loss = 0.218746, test loss = 0.282161
  Training set accuracy = 0.942600, Test set accuracy = 0.915500
 epoch 24/30. Took 0.22765 seconds. 
  Full-batch training loss = 0.211539, test loss = 0.275849
  Training set accuracy = 0.945800, Test set accuracy = 0.917800
 epoch 25/30. Took 0.22792 seconds. 
  Full-batch training loss = 0.205488, test loss = 0.273967
  Training set accuracy = 0.947600, Test set accuracy = 0.917900
 epoch 26/30. Took 0.22793 seconds. 
  Full-batch training loss = 0.199148, test loss = 0.268205
  Training set accuracy = 0.948200, Test set accuracy = 0.919500
 epoch 27/30. Took 0.23668 seconds. 
  Full-batch training loss = 0.193458, test loss = 0.265898
  Training set accuracy = 0.949200, Test set accuracy = 0.920700
 epoch 28/30. Took 0.22768 seconds. 
  Full-batch training loss = 0.187609, test loss = 0.263289
  Training set accuracy = 0.950400, Test set accuracy = 0.921200
 epoch 29/30. Took 0.22875 seconds. 
  Full-batch training loss = 0.181741, test loss = 0.258778
  Training set accuracy = 0.951800, Test set accuracy = 0.921700
 epoch 30/30. Took 0.22849 seconds. 
  Full-batch training loss = 0.178021, test loss = 0.256560
  Training set accuracy = 0.953400, Test set accuracy = 0.923400
Elapsed time is 15.201854 seconds.
End Training
-----
Params 5000 0.010 0.20 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.60181 seconds. 
  Full-batch training loss = 1.872824, test loss = 1.864613
  Training set accuracy = 0.712200, Test set accuracy = 0.714300
 epoch 2/30. Took 0.59216 seconds. 
  Full-batch training loss = 1.143627, test loss = 1.124778
  Training set accuracy = 0.776000, Test set accuracy = 0.787700
 epoch 3/30. Took 0.59313 seconds. 
  Full-batch training loss = 0.728163, test loss = 0.710087
  Training set accuracy = 0.836600, Test set accuracy = 0.846700
 epoch 4/30. Took 0.59179 seconds. 
  Full-batch training loss = 0.563604, test loss = 0.547423
  Training set accuracy = 0.865800, Test set accuracy = 0.871000
 epoch 5/30. Took 0.59341 seconds. 
  Full-batch training loss = 0.483579, test loss = 0.468118
  Training set accuracy = 0.876400, Test set accuracy = 0.880400
 epoch 6/30. Took 0.59377 seconds. 
  Full-batch training loss = 0.429720, test loss = 0.424558
  Training set accuracy = 0.893600, Test set accuracy = 0.888000
 epoch 7/30. Took 0.59518 seconds. 
  Full-batch training loss = 0.395280, test loss = 0.394703
  Training set accuracy = 0.898600, Test set accuracy = 0.894600
 epoch 8/30. Took 0.59625 seconds. 
  Full-batch training loss = 0.369505, test loss = 0.371271
  Training set accuracy = 0.902200, Test set accuracy = 0.896400
 epoch 9/30. Took 0.59438 seconds. 
  Full-batch training loss = 0.349194, test loss = 0.356030
  Training set accuracy = 0.906600, Test set accuracy = 0.899400
 epoch 10/30. Took 0.59603 seconds. 
  Full-batch training loss = 0.329244, test loss = 0.342711
  Training set accuracy = 0.911800, Test set accuracy = 0.902700
 epoch 11/30. Took 0.59318 seconds. 
  Full-batch training loss = 0.313783, test loss = 0.330034
  Training set accuracy = 0.915000, Test set accuracy = 0.906800
 epoch 12/30. Took 0.59443 seconds. 
  Full-batch training loss = 0.301240, test loss = 0.321064
  Training set accuracy = 0.919800, Test set accuracy = 0.908700
 epoch 13/30. Took 0.58985 seconds. 
  Full-batch training loss = 0.290648, test loss = 0.317474
  Training set accuracy = 0.923200, Test set accuracy = 0.908400
 epoch 14/30. Took 0.59192 seconds. 
  Full-batch training loss = 0.279169, test loss = 0.310226
  Training set accuracy = 0.924400, Test set accuracy = 0.910200
 epoch 15/30. Took 0.59753 seconds. 
  Full-batch training loss = 0.270146, test loss = 0.301885
  Training set accuracy = 0.925800, Test set accuracy = 0.910500
 epoch 16/30. Took 0.59529 seconds. 
  Full-batch training loss = 0.258376, test loss = 0.292659
  Training set accuracy = 0.930400, Test set accuracy = 0.915000
 epoch 17/30. Took 0.59194 seconds. 
  Full-batch training loss = 0.250586, test loss = 0.290305
  Training set accuracy = 0.932800, Test set accuracy = 0.915100
 epoch 18/30. Took 0.59318 seconds. 
  Full-batch training loss = 0.241141, test loss = 0.283925
  Training set accuracy = 0.934600, Test set accuracy = 0.917000
 epoch 19/30. Took 0.59336 seconds. 
  Full-batch training loss = 0.234015, test loss = 0.278980
  Training set accuracy = 0.936400, Test set accuracy = 0.918000
 epoch 20/30. Took 0.59404 seconds. 
  Full-batch training loss = 0.225109, test loss = 0.272755
  Training set accuracy = 0.937200, Test set accuracy = 0.919800
 epoch 21/30. Took 0.59659 seconds. 
  Full-batch training loss = 0.217789, test loss = 0.269004
  Training set accuracy = 0.938800, Test set accuracy = 0.921400
 epoch 22/30. Took 0.59516 seconds. 
  Full-batch training loss = 0.211481, test loss = 0.266330
  Training set accuracy = 0.943800, Test set accuracy = 0.921100
 epoch 23/30. Took 0.59636 seconds. 
  Full-batch training loss = 0.202851, test loss = 0.261617
  Training set accuracy = 0.944400, Test set accuracy = 0.923500
 epoch 24/30. Took 0.65229 seconds. 
  Full-batch training loss = 0.197018, test loss = 0.256899
  Training set accuracy = 0.945800, Test set accuracy = 0.923900
 epoch 25/30. Took 0.60728 seconds. 
  Full-batch training loss = 0.191408, test loss = 0.256523
  Training set accuracy = 0.946600, Test set accuracy = 0.924900
 epoch 26/30. Took 0.60201 seconds. 
  Full-batch training loss = 0.186553, test loss = 0.254929
  Training set accuracy = 0.948000, Test set accuracy = 0.923000
 epoch 27/30. Took 0.65456 seconds. 
  Full-batch training loss = 0.179310, test loss = 0.248558
  Training set accuracy = 0.952000, Test set accuracy = 0.925500
 epoch 28/30. Took 0.59611 seconds. 
  Full-batch training loss = 0.173787, test loss = 0.244645
  Training set accuracy = 0.952000, Test set accuracy = 0.926300
 epoch 29/30. Took 0.59277 seconds. 
  Full-batch training loss = 0.169232, test loss = 0.242857
  Training set accuracy = 0.954000, Test set accuracy = 0.926900
 epoch 30/30. Took 0.58877 seconds. 
  Full-batch training loss = 0.164528, test loss = 0.240430
  Training set accuracy = 0.956400, Test set accuracy = 0.929200
Elapsed time is 38.038423 seconds.
End Training
-----
Params 5000 0.010 0.20 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17125 seconds. 
  Full-batch training loss = 2.268708, test loss = 2.267462
  Training set accuracy = 0.261400, Test set accuracy = 0.276000
 epoch 2/30. Took 0.15124 seconds. 
  Full-batch training loss = 2.194142, test loss = 2.190704
  Training set accuracy = 0.451000, Test set accuracy = 0.445600
 epoch 3/30. Took 0.16214 seconds. 
  Full-batch training loss = 2.000824, test loss = 1.990765
  Training set accuracy = 0.577200, Test set accuracy = 0.574200
 epoch 4/30. Took 0.1625 seconds. 
  Full-batch training loss = 1.571430, test loss = 1.548836
  Training set accuracy = 0.658000, Test set accuracy = 0.659400
 epoch 5/30. Took 0.16363 seconds. 
  Full-batch training loss = 1.079987, test loss = 1.052930
  Training set accuracy = 0.744600, Test set accuracy = 0.754200
 epoch 6/30. Took 0.16432 seconds. 
  Full-batch training loss = 0.808272, test loss = 0.778885
  Training set accuracy = 0.775800, Test set accuracy = 0.788000
 epoch 7/30. Took 0.16761 seconds. 
  Full-batch training loss = 0.671508, test loss = 0.646168
  Training set accuracy = 0.815600, Test set accuracy = 0.825600
 epoch 8/30. Took 0.16333 seconds. 
  Full-batch training loss = 0.579525, test loss = 0.561385
  Training set accuracy = 0.840400, Test set accuracy = 0.844200
 epoch 9/30. Took 0.16306 seconds. 
  Full-batch training loss = 0.524826, test loss = 0.513317
  Training set accuracy = 0.852000, Test set accuracy = 0.856800
 epoch 10/30. Took 0.16216 seconds. 
  Full-batch training loss = 0.471102, test loss = 0.463389
  Training set accuracy = 0.866800, Test set accuracy = 0.869500
 epoch 11/30. Took 0.16374 seconds. 
  Full-batch training loss = 0.438207, test loss = 0.438677
  Training set accuracy = 0.870400, Test set accuracy = 0.871000
 epoch 12/30. Took 0.16296 seconds. 
  Full-batch training loss = 0.405894, test loss = 0.408000
  Training set accuracy = 0.885600, Test set accuracy = 0.881000
 epoch 13/30. Took 0.15588 seconds. 
  Full-batch training loss = 0.381665, test loss = 0.389353
  Training set accuracy = 0.890800, Test set accuracy = 0.883800
 epoch 14/30. Took 0.16371 seconds. 
  Full-batch training loss = 0.357962, test loss = 0.369690
  Training set accuracy = 0.901800, Test set accuracy = 0.891200
 epoch 15/30. Took 0.16243 seconds. 
  Full-batch training loss = 0.338683, test loss = 0.353867
  Training set accuracy = 0.905200, Test set accuracy = 0.895400
 epoch 16/30. Took 0.16242 seconds. 
  Full-batch training loss = 0.324401, test loss = 0.344825
  Training set accuracy = 0.908600, Test set accuracy = 0.898000
 epoch 17/30. Took 0.15724 seconds. 
  Full-batch training loss = 0.307424, test loss = 0.332905
  Training set accuracy = 0.912200, Test set accuracy = 0.900500
 epoch 18/30. Took 0.16562 seconds. 
  Full-batch training loss = 0.298349, test loss = 0.328682
  Training set accuracy = 0.915600, Test set accuracy = 0.900700
 epoch 19/30. Took 0.16379 seconds. 
  Full-batch training loss = 0.283455, test loss = 0.315627
  Training set accuracy = 0.919200, Test set accuracy = 0.905600
 epoch 20/30. Took 0.16273 seconds. 
  Full-batch training loss = 0.274276, test loss = 0.314475
  Training set accuracy = 0.921200, Test set accuracy = 0.904000
 epoch 21/30. Took 0.15868 seconds. 
  Full-batch training loss = 0.264563, test loss = 0.306992
  Training set accuracy = 0.923400, Test set accuracy = 0.907800
 epoch 22/30. Took 0.16317 seconds. 
  Full-batch training loss = 0.253836, test loss = 0.296309
  Training set accuracy = 0.927200, Test set accuracy = 0.910600
 epoch 23/30. Took 0.17542 seconds. 
  Full-batch training loss = 0.253498, test loss = 0.299587
  Training set accuracy = 0.925400, Test set accuracy = 0.908400
 epoch 24/30. Took 0.1866 seconds. 
  Full-batch training loss = 0.241892, test loss = 0.292802
  Training set accuracy = 0.932000, Test set accuracy = 0.911300
 epoch 25/30. Took 0.15285 seconds. 
  Full-batch training loss = 0.225457, test loss = 0.279948
  Training set accuracy = 0.934600, Test set accuracy = 0.915100
 epoch 26/30. Took 0.16039 seconds. 
  Full-batch training loss = 0.217616, test loss = 0.274996
  Training set accuracy = 0.936400, Test set accuracy = 0.917300
 epoch 27/30. Took 0.16388 seconds. 
  Full-batch training loss = 0.210462, test loss = 0.270956
  Training set accuracy = 0.939400, Test set accuracy = 0.918300
 epoch 28/30. Took 0.15501 seconds. 
  Full-batch training loss = 0.207081, test loss = 0.268923
  Training set accuracy = 0.941000, Test set accuracy = 0.919500
 epoch 29/30. Took 0.15566 seconds. 
  Full-batch training loss = 0.194658, test loss = 0.265535
  Training set accuracy = 0.945800, Test set accuracy = 0.918900
 epoch 30/30. Took 0.15182 seconds. 
  Full-batch training loss = 0.192407, test loss = 0.266773
  Training set accuracy = 0.945400, Test set accuracy = 0.917800
Elapsed time is 10.959682 seconds.
End Training
-----
Params 5000 0.010 0.20 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28463 seconds. 
  Full-batch training loss = 2.225179, test loss = 2.225112
  Training set accuracy = 0.376800, Test set accuracy = 0.381800
 epoch 2/30. Took 0.27896 seconds. 
  Full-batch training loss = 2.038464, test loss = 2.036941
  Training set accuracy = 0.546200, Test set accuracy = 0.549000
 epoch 3/30. Took 0.26973 seconds. 
  Full-batch training loss = 1.500085, test loss = 1.492458
  Training set accuracy = 0.666800, Test set accuracy = 0.663700
 epoch 4/30. Took 0.27135 seconds. 
  Full-batch training loss = 0.965704, test loss = 0.960759
  Training set accuracy = 0.719400, Test set accuracy = 0.719200
 epoch 5/30. Took 0.28285 seconds. 
  Full-batch training loss = 0.737940, test loss = 0.735727
  Training set accuracy = 0.795600, Test set accuracy = 0.802500
 epoch 6/30. Took 0.28269 seconds. 
  Full-batch training loss = 0.614123, test loss = 0.612287
  Training set accuracy = 0.833600, Test set accuracy = 0.834400
 epoch 7/30. Took 0.27642 seconds. 
  Full-batch training loss = 0.527041, test loss = 0.528553
  Training set accuracy = 0.857000, Test set accuracy = 0.856300
 epoch 8/30. Took 0.27986 seconds. 
  Full-batch training loss = 0.468542, test loss = 0.472269
  Training set accuracy = 0.874200, Test set accuracy = 0.872700
 epoch 9/30. Took 0.30047 seconds. 
  Full-batch training loss = 0.430655, test loss = 0.436538
  Training set accuracy = 0.882200, Test set accuracy = 0.878000
 epoch 10/30. Took 0.28163 seconds. 
  Full-batch training loss = 0.398982, test loss = 0.411844
  Training set accuracy = 0.887600, Test set accuracy = 0.882200
 epoch 11/30. Took 0.28512 seconds. 
  Full-batch training loss = 0.366132, test loss = 0.384115
  Training set accuracy = 0.898600, Test set accuracy = 0.891300
 epoch 12/30. Took 0.31764 seconds. 
  Full-batch training loss = 0.347378, test loss = 0.370794
  Training set accuracy = 0.903400, Test set accuracy = 0.892000
 epoch 13/30. Took 0.30003 seconds. 
  Full-batch training loss = 0.330424, test loss = 0.359966
  Training set accuracy = 0.908200, Test set accuracy = 0.894200
 epoch 14/30. Took 0.28245 seconds. 
  Full-batch training loss = 0.309189, test loss = 0.341771
  Training set accuracy = 0.913200, Test set accuracy = 0.900300
 epoch 15/30. Took 0.27816 seconds. 
  Full-batch training loss = 0.294692, test loss = 0.331988
  Training set accuracy = 0.921400, Test set accuracy = 0.903300
 epoch 16/30. Took 0.27086 seconds. 
  Full-batch training loss = 0.282123, test loss = 0.322470
  Training set accuracy = 0.922000, Test set accuracy = 0.905500
 epoch 17/30. Took 0.27198 seconds. 
  Full-batch training loss = 0.269000, test loss = 0.313410
  Training set accuracy = 0.926400, Test set accuracy = 0.907300
 epoch 18/30. Took 0.28394 seconds. 
  Full-batch training loss = 0.258810, test loss = 0.307435
  Training set accuracy = 0.928400, Test set accuracy = 0.910400
 epoch 19/30. Took 0.27961 seconds. 
  Full-batch training loss = 0.245304, test loss = 0.295783
  Training set accuracy = 0.933800, Test set accuracy = 0.910500
 epoch 20/30. Took 0.28428 seconds. 
  Full-batch training loss = 0.237576, test loss = 0.291887
  Training set accuracy = 0.937000, Test set accuracy = 0.912400
 epoch 21/30. Took 0.28269 seconds. 
  Full-batch training loss = 0.227395, test loss = 0.285533
  Training set accuracy = 0.938400, Test set accuracy = 0.914000
 epoch 22/30. Took 0.28274 seconds. 
  Full-batch training loss = 0.220906, test loss = 0.283563
  Training set accuracy = 0.939600, Test set accuracy = 0.913500
 epoch 23/30. Took 0.28277 seconds. 
  Full-batch training loss = 0.209532, test loss = 0.273791
  Training set accuracy = 0.942200, Test set accuracy = 0.918900
 epoch 24/30. Took 0.28325 seconds. 
  Full-batch training loss = 0.201505, test loss = 0.269479
  Training set accuracy = 0.944800, Test set accuracy = 0.918600
 epoch 25/30. Took 0.28188 seconds. 
  Full-batch training loss = 0.193064, test loss = 0.263642
  Training set accuracy = 0.947600, Test set accuracy = 0.920500
 epoch 26/30. Took 0.27042 seconds. 
  Full-batch training loss = 0.187440, test loss = 0.261276
  Training set accuracy = 0.949400, Test set accuracy = 0.920000
 epoch 27/30. Took 0.27671 seconds. 
  Full-batch training loss = 0.181600, test loss = 0.257442
  Training set accuracy = 0.949800, Test set accuracy = 0.921600
 epoch 28/30. Took 0.28277 seconds. 
  Full-batch training loss = 0.177447, test loss = 0.254218
  Training set accuracy = 0.951400, Test set accuracy = 0.922700
 epoch 29/30. Took 0.28299 seconds. 
  Full-batch training loss = 0.167132, test loss = 0.247957
  Training set accuracy = 0.954800, Test set accuracy = 0.923600
 epoch 30/30. Took 0.28287 seconds. 
  Full-batch training loss = 0.158415, test loss = 0.242519
  Training set accuracy = 0.957000, Test set accuracy = 0.924900
Elapsed time is 18.573571 seconds.
End Training
-----
Params 5000 0.010 0.20 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.86372 seconds. 
  Full-batch training loss = 2.147945, test loss = 2.150045
  Training set accuracy = 0.423000, Test set accuracy = 0.416800
 epoch 2/30. Took 0.84465 seconds. 
  Full-batch training loss = 1.727122, test loss = 1.722121
  Training set accuracy = 0.679800, Test set accuracy = 0.672400
 epoch 3/30. Took 0.876 seconds. 
  Full-batch training loss = 1.011953, test loss = 0.994735
  Training set accuracy = 0.763800, Test set accuracy = 0.768200
 epoch 4/30. Took 0.82374 seconds. 
  Full-batch training loss = 0.677368, test loss = 0.659397
  Training set accuracy = 0.820400, Test set accuracy = 0.820300
 epoch 5/30. Took 0.81469 seconds. 
  Full-batch training loss = 0.547077, test loss = 0.532976
  Training set accuracy = 0.853200, Test set accuracy = 0.853000
 epoch 6/30. Took 0.82222 seconds. 
  Full-batch training loss = 0.473467, test loss = 0.464170
  Training set accuracy = 0.865000, Test set accuracy = 0.867800
 epoch 7/30. Took 0.84593 seconds. 
  Full-batch training loss = 0.425330, test loss = 0.427802
  Training set accuracy = 0.874800, Test set accuracy = 0.876100
 epoch 8/30. Took 0.82037 seconds. 
  Full-batch training loss = 0.384542, test loss = 0.391327
  Training set accuracy = 0.889000, Test set accuracy = 0.888100
 epoch 9/30. Took 0.90798 seconds. 
  Full-batch training loss = 0.355576, test loss = 0.370007
  Training set accuracy = 0.893600, Test set accuracy = 0.893100
 epoch 10/30. Took 0.83448 seconds. 
  Full-batch training loss = 0.336496, test loss = 0.352571
  Training set accuracy = 0.902000, Test set accuracy = 0.898400
 epoch 11/30. Took 0.82027 seconds. 
  Full-batch training loss = 0.319204, test loss = 0.344361
  Training set accuracy = 0.906800, Test set accuracy = 0.901300
 epoch 12/30. Took 0.87031 seconds. 
  Full-batch training loss = 0.299057, test loss = 0.325943
  Training set accuracy = 0.912000, Test set accuracy = 0.906300
 epoch 13/30. Took 0.89448 seconds. 
  Full-batch training loss = 0.283560, test loss = 0.319538
  Training set accuracy = 0.916200, Test set accuracy = 0.909600
 epoch 14/30. Took 0.82648 seconds. 
  Full-batch training loss = 0.268207, test loss = 0.306939
  Training set accuracy = 0.919800, Test set accuracy = 0.912600
 epoch 15/30. Took 0.82585 seconds. 
  Full-batch training loss = 0.258117, test loss = 0.299621
  Training set accuracy = 0.924200, Test set accuracy = 0.914000
 epoch 16/30. Took 0.8263 seconds. 
  Full-batch training loss = 0.249608, test loss = 0.296487
  Training set accuracy = 0.927600, Test set accuracy = 0.915600
 epoch 17/30. Took 0.82259 seconds. 
  Full-batch training loss = 0.237129, test loss = 0.289689
  Training set accuracy = 0.927200, Test set accuracy = 0.914500
 epoch 18/30. Took 0.8254 seconds. 
  Full-batch training loss = 0.223694, test loss = 0.277718
  Training set accuracy = 0.934000, Test set accuracy = 0.919500
 epoch 19/30. Took 0.82311 seconds. 
  Full-batch training loss = 0.211903, test loss = 0.272560
  Training set accuracy = 0.936200, Test set accuracy = 0.922800
 epoch 20/30. Took 0.84162 seconds. 
  Full-batch training loss = 0.202346, test loss = 0.269021
  Training set accuracy = 0.939800, Test set accuracy = 0.922100
 epoch 21/30. Took 0.81691 seconds. 
  Full-batch training loss = 0.195434, test loss = 0.261698
  Training set accuracy = 0.943400, Test set accuracy = 0.922700
 epoch 22/30. Took 0.82103 seconds. 
  Full-batch training loss = 0.186434, test loss = 0.258718
  Training set accuracy = 0.943600, Test set accuracy = 0.923700
 epoch 23/30. Took 0.88366 seconds. 
  Full-batch training loss = 0.176648, test loss = 0.252311
  Training set accuracy = 0.948600, Test set accuracy = 0.926200
 epoch 24/30. Took 0.84307 seconds. 
  Full-batch training loss = 0.171361, test loss = 0.249902
  Training set accuracy = 0.950600, Test set accuracy = 0.926600
 epoch 25/30. Took 0.90027 seconds. 
  Full-batch training loss = 0.160346, test loss = 0.243038
  Training set accuracy = 0.953000, Test set accuracy = 0.928900
 epoch 26/30. Took 0.81685 seconds. 
  Full-batch training loss = 0.155887, test loss = 0.244323
  Training set accuracy = 0.955600, Test set accuracy = 0.927600
 epoch 27/30. Took 0.82161 seconds. 
  Full-batch training loss = 0.148605, test loss = 0.235804
  Training set accuracy = 0.955800, Test set accuracy = 0.933400
 epoch 28/30. Took 0.83093 seconds. 
  Full-batch training loss = 0.142782, test loss = 0.237313
  Training set accuracy = 0.960000, Test set accuracy = 0.929400
 epoch 29/30. Took 0.84365 seconds. 
  Full-batch training loss = 0.132953, test loss = 0.228813
  Training set accuracy = 0.963400, Test set accuracy = 0.934300
 epoch 30/30. Took 0.96708 seconds. 
  Full-batch training loss = 0.128965, test loss = 0.229284
  Training set accuracy = 0.966000, Test set accuracy = 0.933500
Elapsed time is 52.973115 seconds.
End Training
-----
Params 5000 0.010 0.30 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11431 seconds. 
  Full-batch training loss = 1.815820, test loss = 1.813049
  Training set accuracy = 0.661000, Test set accuracy = 0.664000
 epoch 2/30. Took 0.10661 seconds. 
  Full-batch training loss = 1.244528, test loss = 1.236607
  Training set accuracy = 0.776400, Test set accuracy = 0.778200
 epoch 3/30. Took 0.10672 seconds. 
  Full-batch training loss = 0.901733, test loss = 0.892292
  Training set accuracy = 0.821000, Test set accuracy = 0.823500
 epoch 4/30. Took 0.10857 seconds. 
  Full-batch training loss = 0.732185, test loss = 0.721278
  Training set accuracy = 0.839400, Test set accuracy = 0.842100
 epoch 5/30. Took 0.10858 seconds. 
  Full-batch training loss = 0.629780, test loss = 0.621000
  Training set accuracy = 0.855000, Test set accuracy = 0.858400
 epoch 6/30. Took 0.11413 seconds. 
  Full-batch training loss = 0.565628, test loss = 0.562721
  Training set accuracy = 0.860800, Test set accuracy = 0.863500
 epoch 7/30. Took 0.1175 seconds. 
  Full-batch training loss = 0.518369, test loss = 0.518060
  Training set accuracy = 0.871000, Test set accuracy = 0.870600
 epoch 8/30. Took 0.11637 seconds. 
  Full-batch training loss = 0.481478, test loss = 0.481705
  Training set accuracy = 0.880400, Test set accuracy = 0.881000
 epoch 9/30. Took 0.11149 seconds. 
  Full-batch training loss = 0.452795, test loss = 0.454783
  Training set accuracy = 0.885600, Test set accuracy = 0.884000
 epoch 10/30. Took 0.10654 seconds. 
  Full-batch training loss = 0.431395, test loss = 0.437957
  Training set accuracy = 0.889600, Test set accuracy = 0.885900
 epoch 11/30. Took 0.10554 seconds. 
  Full-batch training loss = 0.411590, test loss = 0.419667
  Training set accuracy = 0.893600, Test set accuracy = 0.890700
 epoch 12/30. Took 0.10378 seconds. 
  Full-batch training loss = 0.395607, test loss = 0.407024
  Training set accuracy = 0.898800, Test set accuracy = 0.893300
 epoch 13/30. Took 0.10666 seconds. 
  Full-batch training loss = 0.381062, test loss = 0.395088
  Training set accuracy = 0.903200, Test set accuracy = 0.893600
 epoch 14/30. Took 0.10699 seconds. 
  Full-batch training loss = 0.368718, test loss = 0.385272
  Training set accuracy = 0.905800, Test set accuracy = 0.895100
 epoch 15/30. Took 0.10838 seconds. 
  Full-batch training loss = 0.358053, test loss = 0.375976
  Training set accuracy = 0.906800, Test set accuracy = 0.897800
 epoch 16/30. Took 0.11019 seconds. 
  Full-batch training loss = 0.346606, test loss = 0.365791
  Training set accuracy = 0.910600, Test set accuracy = 0.901600
 epoch 17/30. Took 0.10878 seconds. 
  Full-batch training loss = 0.336973, test loss = 0.358525
  Training set accuracy = 0.912200, Test set accuracy = 0.902200
 epoch 18/30. Took 0.10865 seconds. 
  Full-batch training loss = 0.329789, test loss = 0.352963
  Training set accuracy = 0.912800, Test set accuracy = 0.901100
 epoch 19/30. Took 0.10836 seconds. 
  Full-batch training loss = 0.320957, test loss = 0.345861
  Training set accuracy = 0.916200, Test set accuracy = 0.905500
 epoch 20/30. Took 0.10853 seconds. 
  Full-batch training loss = 0.315754, test loss = 0.344010
  Training set accuracy = 0.913400, Test set accuracy = 0.904200
 epoch 21/30. Took 0.10766 seconds. 
  Full-batch training loss = 0.306478, test loss = 0.336110
  Training set accuracy = 0.919000, Test set accuracy = 0.905500
 epoch 22/30. Took 0.10913 seconds. 
  Full-batch training loss = 0.299606, test loss = 0.332723
  Training set accuracy = 0.920600, Test set accuracy = 0.905800
 epoch 23/30. Took 0.10839 seconds. 
  Full-batch training loss = 0.292854, test loss = 0.326712
  Training set accuracy = 0.921200, Test set accuracy = 0.908100
 epoch 24/30. Took 0.10889 seconds. 
  Full-batch training loss = 0.286428, test loss = 0.322969
  Training set accuracy = 0.923800, Test set accuracy = 0.910300
 epoch 25/30. Took 0.12172 seconds. 
  Full-batch training loss = 0.282283, test loss = 0.322513
  Training set accuracy = 0.924000, Test set accuracy = 0.908900
 epoch 26/30. Took 0.11275 seconds. 
  Full-batch training loss = 0.275712, test loss = 0.315343
  Training set accuracy = 0.926600, Test set accuracy = 0.912200
 epoch 27/30. Took 0.10818 seconds. 
  Full-batch training loss = 0.271434, test loss = 0.314135
  Training set accuracy = 0.927200, Test set accuracy = 0.911000
 epoch 28/30. Took 0.10946 seconds. 
  Full-batch training loss = 0.266367, test loss = 0.310459
  Training set accuracy = 0.928000, Test set accuracy = 0.912500
 epoch 29/30. Took 0.1077 seconds. 
  Full-batch training loss = 0.260430, test loss = 0.305988
  Training set accuracy = 0.931600, Test set accuracy = 0.913300
 epoch 30/30. Took 0.10914 seconds. 
  Full-batch training loss = 0.255290, test loss = 0.302625
  Training set accuracy = 0.932200, Test set accuracy = 0.914600
Elapsed time is 8.126886 seconds.
End Training
-----
Params 5000 0.010 0.30 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17509 seconds. 
  Full-batch training loss = 1.736028, test loss = 1.729972
  Training set accuracy = 0.707000, Test set accuracy = 0.710800
 epoch 2/30. Took 0.16691 seconds. 
  Full-batch training loss = 1.132997, test loss = 1.121451
  Training set accuracy = 0.783000, Test set accuracy = 0.788100
 epoch 3/30. Took 0.18095 seconds. 
  Full-batch training loss = 0.816996, test loss = 0.805425
  Training set accuracy = 0.836600, Test set accuracy = 0.839800
 epoch 4/30. Took 0.16717 seconds. 
  Full-batch training loss = 0.662903, test loss = 0.653498
  Training set accuracy = 0.854600, Test set accuracy = 0.858100
 epoch 5/30. Took 0.16769 seconds. 
  Full-batch training loss = 0.573468, test loss = 0.566783
  Training set accuracy = 0.871000, Test set accuracy = 0.869600
 epoch 6/30. Took 0.17786 seconds. 
  Full-batch training loss = 0.515808, test loss = 0.511872
  Training set accuracy = 0.877200, Test set accuracy = 0.876900
 epoch 7/30. Took 0.16895 seconds. 
  Full-batch training loss = 0.473635, test loss = 0.474001
  Training set accuracy = 0.888400, Test set accuracy = 0.883600
 epoch 8/30. Took 0.16886 seconds. 
  Full-batch training loss = 0.442643, test loss = 0.447049
  Training set accuracy = 0.895000, Test set accuracy = 0.888000
 epoch 9/30. Took 0.1689 seconds. 
  Full-batch training loss = 0.418525, test loss = 0.424828
  Training set accuracy = 0.897400, Test set accuracy = 0.890800
 epoch 10/30. Took 0.16898 seconds. 
  Full-batch training loss = 0.398317, test loss = 0.408514
  Training set accuracy = 0.902200, Test set accuracy = 0.893600
 epoch 11/30. Took 0.16915 seconds. 
  Full-batch training loss = 0.382004, test loss = 0.392947
  Training set accuracy = 0.901600, Test set accuracy = 0.895700
 epoch 12/30. Took 0.16917 seconds. 
  Full-batch training loss = 0.366803, test loss = 0.383188
  Training set accuracy = 0.907400, Test set accuracy = 0.899400
 epoch 13/30. Took 0.16688 seconds. 
  Full-batch training loss = 0.354445, test loss = 0.372956
  Training set accuracy = 0.908800, Test set accuracy = 0.901500
 epoch 14/30. Took 0.16858 seconds. 
  Full-batch training loss = 0.342173, test loss = 0.363303
  Training set accuracy = 0.912600, Test set accuracy = 0.900900
 epoch 15/30. Took 0.16912 seconds. 
  Full-batch training loss = 0.332411, test loss = 0.355909
  Training set accuracy = 0.915000, Test set accuracy = 0.903600
 epoch 16/30. Took 0.16543 seconds. 
  Full-batch training loss = 0.321698, test loss = 0.347468
  Training set accuracy = 0.916800, Test set accuracy = 0.906600
 epoch 17/30. Took 0.16731 seconds. 
  Full-batch training loss = 0.312967, test loss = 0.341540
  Training set accuracy = 0.919200, Test set accuracy = 0.907900
 epoch 18/30. Took 0.16932 seconds. 
  Full-batch training loss = 0.305215, test loss = 0.336939
  Training set accuracy = 0.920200, Test set accuracy = 0.906900
 epoch 19/30. Took 0.16972 seconds. 
  Full-batch training loss = 0.297615, test loss = 0.330920
  Training set accuracy = 0.922600, Test set accuracy = 0.910400
 epoch 20/30. Took 0.18839 seconds. 
  Full-batch training loss = 0.290571, test loss = 0.326597
  Training set accuracy = 0.925200, Test set accuracy = 0.910100
 epoch 21/30. Took 0.16342 seconds. 
  Full-batch training loss = 0.283222, test loss = 0.321250
  Training set accuracy = 0.925800, Test set accuracy = 0.911800
 epoch 22/30. Took 0.16653 seconds. 
  Full-batch training loss = 0.276794, test loss = 0.317538
  Training set accuracy = 0.927600, Test set accuracy = 0.912700
 epoch 23/30. Took 0.16953 seconds. 
  Full-batch training loss = 0.271443, test loss = 0.314019
  Training set accuracy = 0.929600, Test set accuracy = 0.914700
 epoch 24/30. Took 0.1711 seconds. 
  Full-batch training loss = 0.265331, test loss = 0.310045
  Training set accuracy = 0.929000, Test set accuracy = 0.914100
 epoch 25/30. Took 0.16977 seconds. 
  Full-batch training loss = 0.259772, test loss = 0.305355
  Training set accuracy = 0.929800, Test set accuracy = 0.916300
 epoch 26/30. Took 0.16951 seconds. 
  Full-batch training loss = 0.254926, test loss = 0.303945
  Training set accuracy = 0.933800, Test set accuracy = 0.916600
 epoch 27/30. Took 0.1652 seconds. 
  Full-batch training loss = 0.248881, test loss = 0.298482
  Training set accuracy = 0.934600, Test set accuracy = 0.917600
 epoch 28/30. Took 0.16761 seconds. 
  Full-batch training loss = 0.243764, test loss = 0.296556
  Training set accuracy = 0.935600, Test set accuracy = 0.918500
 epoch 29/30. Took 0.164 seconds. 
  Full-batch training loss = 0.238847, test loss = 0.292635
  Training set accuracy = 0.936800, Test set accuracy = 0.919300
 epoch 30/30. Took 0.16361 seconds. 
  Full-batch training loss = 0.235516, test loss = 0.291771
  Training set accuracy = 0.936800, Test set accuracy = 0.919100
Elapsed time is 11.764523 seconds.
End Training
-----
Params 5000 0.010 0.30 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.37909 seconds. 
  Full-batch training loss = 1.636568, test loss = 1.620167
  Training set accuracy = 0.713800, Test set accuracy = 0.721000
 epoch 2/30. Took 0.35983 seconds. 
  Full-batch training loss = 1.049103, test loss = 1.025819
  Training set accuracy = 0.804800, Test set accuracy = 0.809800
 epoch 3/30. Took 0.35227 seconds. 
  Full-batch training loss = 0.770714, test loss = 0.751773
  Training set accuracy = 0.830600, Test set accuracy = 0.834900
 epoch 4/30. Took 0.3559 seconds. 
  Full-batch training loss = 0.633853, test loss = 0.619340
  Training set accuracy = 0.856400, Test set accuracy = 0.858600
 epoch 5/30. Took 0.40378 seconds. 
  Full-batch training loss = 0.554826, test loss = 0.540830
  Training set accuracy = 0.866800, Test set accuracy = 0.867900
 epoch 6/30. Took 0.35762 seconds. 
  Full-batch training loss = 0.502485, test loss = 0.492760
  Training set accuracy = 0.879000, Test set accuracy = 0.878500
 epoch 7/30. Took 0.35567 seconds. 
  Full-batch training loss = 0.464562, test loss = 0.457897
  Training set accuracy = 0.884400, Test set accuracy = 0.884600
 epoch 8/30. Took 0.35643 seconds. 
  Full-batch training loss = 0.436547, test loss = 0.431630
  Training set accuracy = 0.887800, Test set accuracy = 0.889000
 epoch 9/30. Took 0.36464 seconds. 
  Full-batch training loss = 0.413982, test loss = 0.411311
  Training set accuracy = 0.892200, Test set accuracy = 0.891300
 epoch 10/30. Took 0.36166 seconds. 
  Full-batch training loss = 0.395525, test loss = 0.396134
  Training set accuracy = 0.895600, Test set accuracy = 0.894400
 epoch 11/30. Took 0.36009 seconds. 
  Full-batch training loss = 0.379888, test loss = 0.383282
  Training set accuracy = 0.897400, Test set accuracy = 0.896500
 epoch 12/30. Took 0.35659 seconds. 
  Full-batch training loss = 0.367291, test loss = 0.372867
  Training set accuracy = 0.903000, Test set accuracy = 0.899300
 epoch 13/30. Took 0.35519 seconds. 
  Full-batch training loss = 0.353910, test loss = 0.361369
  Training set accuracy = 0.905000, Test set accuracy = 0.900400
 epoch 14/30. Took 0.35415 seconds. 
  Full-batch training loss = 0.343814, test loss = 0.354558
  Training set accuracy = 0.905800, Test set accuracy = 0.900400
 epoch 15/30. Took 0.35473 seconds. 
  Full-batch training loss = 0.332694, test loss = 0.345732
  Training set accuracy = 0.911200, Test set accuracy = 0.903100
 epoch 16/30. Took 0.35295 seconds. 
  Full-batch training loss = 0.324276, test loss = 0.338552
  Training set accuracy = 0.909400, Test set accuracy = 0.903500
 epoch 17/30. Took 0.35249 seconds. 
  Full-batch training loss = 0.316708, test loss = 0.331224
  Training set accuracy = 0.914000, Test set accuracy = 0.905900
 epoch 18/30. Took 0.35255 seconds. 
  Full-batch training loss = 0.308076, test loss = 0.327083
  Training set accuracy = 0.915600, Test set accuracy = 0.907700
 epoch 19/30. Took 0.35029 seconds. 
  Full-batch training loss = 0.300871, test loss = 0.321616
  Training set accuracy = 0.919800, Test set accuracy = 0.907900
 epoch 20/30. Took 0.35361 seconds. 
  Full-batch training loss = 0.295614, test loss = 0.318984
  Training set accuracy = 0.917400, Test set accuracy = 0.907700
 epoch 21/30. Took 0.35532 seconds. 
  Full-batch training loss = 0.288533, test loss = 0.314977
  Training set accuracy = 0.922600, Test set accuracy = 0.908500
 epoch 22/30. Took 0.3572 seconds. 
  Full-batch training loss = 0.282196, test loss = 0.308305
  Training set accuracy = 0.925800, Test set accuracy = 0.912500
 epoch 23/30. Took 0.35885 seconds. 
  Full-batch training loss = 0.276619, test loss = 0.307683
  Training set accuracy = 0.927000, Test set accuracy = 0.911300
 epoch 24/30. Took 0.38326 seconds. 
  Full-batch training loss = 0.271044, test loss = 0.304384
  Training set accuracy = 0.927200, Test set accuracy = 0.912200
 epoch 25/30. Took 0.35259 seconds. 
  Full-batch training loss = 0.265621, test loss = 0.300922
  Training set accuracy = 0.929000, Test set accuracy = 0.913500
 epoch 26/30. Took 0.35249 seconds. 
  Full-batch training loss = 0.261753, test loss = 0.297175
  Training set accuracy = 0.932000, Test set accuracy = 0.916100
 epoch 27/30. Took 0.35422 seconds. 
  Full-batch training loss = 0.255915, test loss = 0.293323
  Training set accuracy = 0.932000, Test set accuracy = 0.916700
 epoch 28/30. Took 0.35615 seconds. 
  Full-batch training loss = 0.252024, test loss = 0.291858
  Training set accuracy = 0.933200, Test set accuracy = 0.918100
 epoch 29/30. Took 0.35636 seconds. 
  Full-batch training loss = 0.246567, test loss = 0.289630
  Training set accuracy = 0.933800, Test set accuracy = 0.915900
 epoch 30/30. Took 0.35413 seconds. 
  Full-batch training loss = 0.241703, test loss = 0.285776
  Training set accuracy = 0.935400, Test set accuracy = 0.917300
Elapsed time is 23.450495 seconds.
End Training
-----
Params 5000 0.010 0.30 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14869 seconds. 
  Full-batch training loss = 2.196925, test loss = 2.196931
  Training set accuracy = 0.358600, Test set accuracy = 0.355500
 epoch 2/30. Took 0.12909 seconds. 
  Full-batch training loss = 1.970597, test loss = 1.967052
  Training set accuracy = 0.583400, Test set accuracy = 0.572800
 epoch 3/30. Took 0.13023 seconds. 
  Full-batch training loss = 1.572669, test loss = 1.563364
  Training set accuracy = 0.727200, Test set accuracy = 0.718100
 epoch 4/30. Took 0.1327 seconds. 
  Full-batch training loss = 1.141484, test loss = 1.129410
  Training set accuracy = 0.787600, Test set accuracy = 0.782900
 epoch 5/30. Took 0.12876 seconds. 
  Full-batch training loss = 0.867150, test loss = 0.857324
  Training set accuracy = 0.815400, Test set accuracy = 0.806800
 epoch 6/30. Took 0.13617 seconds. 
  Full-batch training loss = 0.715732, test loss = 0.708240
  Training set accuracy = 0.840000, Test set accuracy = 0.832500
 epoch 7/30. Took 0.1408 seconds. 
  Full-batch training loss = 0.628590, test loss = 0.627204
  Training set accuracy = 0.850600, Test set accuracy = 0.839800
 epoch 8/30. Took 0.13584 seconds. 
  Full-batch training loss = 0.569497, test loss = 0.573166
  Training set accuracy = 0.856400, Test set accuracy = 0.847800
 epoch 9/30. Took 0.13516 seconds. 
  Full-batch training loss = 0.520259, test loss = 0.525448
  Training set accuracy = 0.870600, Test set accuracy = 0.862300
 epoch 10/30. Took 0.1323 seconds. 
  Full-batch training loss = 0.479352, test loss = 0.485422
  Training set accuracy = 0.877600, Test set accuracy = 0.869200
 epoch 11/30. Took 0.14469 seconds. 
  Full-batch training loss = 0.447318, test loss = 0.457594
  Training set accuracy = 0.887000, Test set accuracy = 0.875500
 epoch 12/30. Took 0.12868 seconds. 
  Full-batch training loss = 0.426332, test loss = 0.440764
  Training set accuracy = 0.888000, Test set accuracy = 0.878400
 epoch 13/30. Took 0.13572 seconds. 
  Full-batch training loss = 0.402405, test loss = 0.419391
  Training set accuracy = 0.894600, Test set accuracy = 0.883800
 epoch 14/30. Took 0.13567 seconds. 
  Full-batch training loss = 0.385074, test loss = 0.403214
  Training set accuracy = 0.896400, Test set accuracy = 0.887500
 epoch 15/30. Took 0.13519 seconds. 
  Full-batch training loss = 0.370088, test loss = 0.392602
  Training set accuracy = 0.898400, Test set accuracy = 0.887200
 epoch 16/30. Took 0.14529 seconds. 
  Full-batch training loss = 0.356050, test loss = 0.376697
  Training set accuracy = 0.903800, Test set accuracy = 0.893300
 epoch 17/30. Took 0.13959 seconds. 
  Full-batch training loss = 0.343785, test loss = 0.369395
  Training set accuracy = 0.904400, Test set accuracy = 0.892900
 epoch 18/30. Took 0.14103 seconds. 
  Full-batch training loss = 0.336903, test loss = 0.366835
  Training set accuracy = 0.906800, Test set accuracy = 0.892600
 epoch 19/30. Took 0.13945 seconds. 
  Full-batch training loss = 0.321167, test loss = 0.351275
  Training set accuracy = 0.914000, Test set accuracy = 0.897500
 epoch 20/30. Took 0.13589 seconds. 
  Full-batch training loss = 0.313485, test loss = 0.344928
  Training set accuracy = 0.917000, Test set accuracy = 0.899700
 epoch 21/30. Took 0.12855 seconds. 
  Full-batch training loss = 0.303088, test loss = 0.335847
  Training set accuracy = 0.917400, Test set accuracy = 0.902300
 epoch 22/30. Took 0.13579 seconds. 
  Full-batch training loss = 0.297684, test loss = 0.332523
  Training set accuracy = 0.919600, Test set accuracy = 0.902800
 epoch 23/30. Took 0.13528 seconds. 
  Full-batch training loss = 0.287451, test loss = 0.322831
  Training set accuracy = 0.920800, Test set accuracy = 0.905600
 epoch 24/30. Took 0.1333 seconds. 
  Full-batch training loss = 0.281468, test loss = 0.319164
  Training set accuracy = 0.923400, Test set accuracy = 0.905200
 epoch 25/30. Took 0.12888 seconds. 
  Full-batch training loss = 0.274685, test loss = 0.313612
  Training set accuracy = 0.924800, Test set accuracy = 0.908200
 epoch 26/30. Took 0.1361 seconds. 
  Full-batch training loss = 0.269031, test loss = 0.311402
  Training set accuracy = 0.926200, Test set accuracy = 0.907300
 epoch 27/30. Took 0.13409 seconds. 
  Full-batch training loss = 0.261379, test loss = 0.305715
  Training set accuracy = 0.927600, Test set accuracy = 0.909800
 epoch 28/30. Took 0.14723 seconds. 
  Full-batch training loss = 0.255846, test loss = 0.303531
  Training set accuracy = 0.927600, Test set accuracy = 0.910200
 epoch 29/30. Took 0.14449 seconds. 
  Full-batch training loss = 0.249686, test loss = 0.298121
  Training set accuracy = 0.928600, Test set accuracy = 0.911800
 epoch 30/30. Took 0.12916 seconds. 
  Full-batch training loss = 0.246585, test loss = 0.296713
  Training set accuracy = 0.932400, Test set accuracy = 0.912400
Elapsed time is 9.544044 seconds.
End Training
-----
Params 5000 0.010 0.30 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23179 seconds. 
  Full-batch training loss = 2.146256, test loss = 2.143030
  Training set accuracy = 0.524200, Test set accuracy = 0.521900
 epoch 2/30. Took 0.22566 seconds. 
  Full-batch training loss = 1.806644, test loss = 1.798502
  Training set accuracy = 0.698200, Test set accuracy = 0.690500
 epoch 3/30. Took 0.2282 seconds. 
  Full-batch training loss = 1.268524, test loss = 1.256680
  Training set accuracy = 0.778400, Test set accuracy = 0.776100
 epoch 4/30. Took 0.22265 seconds. 
  Full-batch training loss = 0.871393, test loss = 0.864316
  Training set accuracy = 0.814800, Test set accuracy = 0.809100
 epoch 5/30. Took 0.22453 seconds. 
  Full-batch training loss = 0.673402, test loss = 0.672795
  Training set accuracy = 0.844000, Test set accuracy = 0.839900
 epoch 6/30. Took 0.22777 seconds. 
  Full-batch training loss = 0.568905, test loss = 0.573815
  Training set accuracy = 0.857400, Test set accuracy = 0.851400
 epoch 7/30. Took 0.22111 seconds. 
  Full-batch training loss = 0.503142, test loss = 0.513367
  Training set accuracy = 0.871600, Test set accuracy = 0.864400
 epoch 8/30. Took 0.22623 seconds. 
  Full-batch training loss = 0.455978, test loss = 0.472219
  Training set accuracy = 0.879200, Test set accuracy = 0.874700
 epoch 9/30. Took 0.23417 seconds. 
  Full-batch training loss = 0.423524, test loss = 0.444383
  Training set accuracy = 0.890600, Test set accuracy = 0.879400
 epoch 10/30. Took 0.22886 seconds. 
  Full-batch training loss = 0.398691, test loss = 0.424698
  Training set accuracy = 0.897000, Test set accuracy = 0.881500
 epoch 11/30. Took 0.22456 seconds. 
  Full-batch training loss = 0.372360, test loss = 0.401596
  Training set accuracy = 0.902800, Test set accuracy = 0.890500
 epoch 12/30. Took 0.24313 seconds. 
  Full-batch training loss = 0.356341, test loss = 0.388216
  Training set accuracy = 0.907200, Test set accuracy = 0.890600
 epoch 13/30. Took 0.21891 seconds. 
  Full-batch training loss = 0.338631, test loss = 0.373965
  Training set accuracy = 0.909200, Test set accuracy = 0.895800
 epoch 14/30. Took 0.21965 seconds. 
  Full-batch training loss = 0.325606, test loss = 0.364982
  Training set accuracy = 0.914000, Test set accuracy = 0.898200
 epoch 15/30. Took 0.22481 seconds. 
  Full-batch training loss = 0.313974, test loss = 0.356427
  Training set accuracy = 0.916200, Test set accuracy = 0.900000
 epoch 16/30. Took 0.24398 seconds. 
  Full-batch training loss = 0.300838, test loss = 0.346543
  Training set accuracy = 0.918200, Test set accuracy = 0.900800
 epoch 17/30. Took 0.22639 seconds. 
  Full-batch training loss = 0.290506, test loss = 0.339348
  Training set accuracy = 0.920000, Test set accuracy = 0.903600
 epoch 18/30. Took 0.25579 seconds. 
  Full-batch training loss = 0.280537, test loss = 0.331836
  Training set accuracy = 0.923800, Test set accuracy = 0.905400
 epoch 19/30. Took 0.24618 seconds. 
  Full-batch training loss = 0.271471, test loss = 0.327508
  Training set accuracy = 0.929600, Test set accuracy = 0.906800
 epoch 20/30. Took 0.22131 seconds. 
  Full-batch training loss = 0.264137, test loss = 0.322149
  Training set accuracy = 0.926800, Test set accuracy = 0.904100
 epoch 21/30. Took 0.2267 seconds. 
  Full-batch training loss = 0.255632, test loss = 0.317554
  Training set accuracy = 0.931600, Test set accuracy = 0.907800
 epoch 22/30. Took 0.22701 seconds. 
  Full-batch training loss = 0.248506, test loss = 0.311572
  Training set accuracy = 0.934000, Test set accuracy = 0.909400
 epoch 23/30. Took 0.22177 seconds. 
  Full-batch training loss = 0.242027, test loss = 0.308403
  Training set accuracy = 0.932800, Test set accuracy = 0.908900
 epoch 24/30. Took 0.22966 seconds. 
  Full-batch training loss = 0.234147, test loss = 0.302395
  Training set accuracy = 0.935200, Test set accuracy = 0.911800
 epoch 25/30. Took 0.22871 seconds. 
  Full-batch training loss = 0.227930, test loss = 0.300199
  Training set accuracy = 0.938400, Test set accuracy = 0.912400
 epoch 26/30. Took 0.2291 seconds. 
  Full-batch training loss = 0.221282, test loss = 0.295327
  Training set accuracy = 0.938600, Test set accuracy = 0.913800
 epoch 27/30. Took 0.22328 seconds. 
  Full-batch training loss = 0.215289, test loss = 0.291305
  Training set accuracy = 0.939800, Test set accuracy = 0.914600
 epoch 28/30. Took 0.23801 seconds. 
  Full-batch training loss = 0.210666, test loss = 0.289785
  Training set accuracy = 0.941600, Test set accuracy = 0.914400
 epoch 29/30. Took 0.23247 seconds. 
  Full-batch training loss = 0.204254, test loss = 0.286400
  Training set accuracy = 0.943400, Test set accuracy = 0.913900
 epoch 30/30. Took 0.22253 seconds. 
  Full-batch training loss = 0.201336, test loss = 0.285080
  Training set accuracy = 0.945200, Test set accuracy = 0.915900
Elapsed time is 15.203794 seconds.
End Training
-----
Params 5000 0.010 0.30 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.65856 seconds. 
  Full-batch training loss = 2.076385, test loss = 2.071814
  Training set accuracy = 0.588200, Test set accuracy = 0.589200
 epoch 2/30. Took 0.59083 seconds. 
  Full-batch training loss = 1.627756, test loss = 1.615117
  Training set accuracy = 0.689400, Test set accuracy = 0.693600
 epoch 3/30. Took 0.61054 seconds. 
  Full-batch training loss = 1.082771, test loss = 1.063257
  Training set accuracy = 0.759800, Test set accuracy = 0.774300
 epoch 4/30. Took 0.64243 seconds. 
  Full-batch training loss = 0.779628, test loss = 0.762651
  Training set accuracy = 0.831400, Test set accuracy = 0.833900
 epoch 5/30. Took 0.5992 seconds. 
  Full-batch training loss = 0.625078, test loss = 0.615110
  Training set accuracy = 0.857800, Test set accuracy = 0.855500
 epoch 6/30. Took 0.59473 seconds. 
  Full-batch training loss = 0.538098, test loss = 0.530693
  Training set accuracy = 0.867200, Test set accuracy = 0.866600
 epoch 7/30. Took 0.59123 seconds. 
  Full-batch training loss = 0.482145, test loss = 0.480350
  Training set accuracy = 0.875200, Test set accuracy = 0.877600
 epoch 8/30. Took 0.62099 seconds. 
  Full-batch training loss = 0.438252, test loss = 0.442210
  Training set accuracy = 0.886200, Test set accuracy = 0.883100
 epoch 9/30. Took 0.63807 seconds. 
  Full-batch training loss = 0.410776, test loss = 0.418625
  Training set accuracy = 0.889000, Test set accuracy = 0.886800
 epoch 10/30. Took 0.62623 seconds. 
  Full-batch training loss = 0.384583, test loss = 0.394714
  Training set accuracy = 0.898800, Test set accuracy = 0.892100
 epoch 11/30. Took 0.59247 seconds. 
  Full-batch training loss = 0.367955, test loss = 0.382470
  Training set accuracy = 0.900400, Test set accuracy = 0.892100
 epoch 12/30. Took 0.59058 seconds. 
  Full-batch training loss = 0.348965, test loss = 0.367641
  Training set accuracy = 0.904200, Test set accuracy = 0.896500
 epoch 13/30. Took 0.59484 seconds. 
  Full-batch training loss = 0.339724, test loss = 0.362634
  Training set accuracy = 0.905800, Test set accuracy = 0.897800
 epoch 14/30. Took 0.60856 seconds. 
  Full-batch training loss = 0.320880, test loss = 0.346605
  Training set accuracy = 0.910600, Test set accuracy = 0.901300
 epoch 15/30. Took 0.59274 seconds. 
  Full-batch training loss = 0.311203, test loss = 0.340201
  Training set accuracy = 0.915000, Test set accuracy = 0.904600
 epoch 16/30. Took 0.59221 seconds. 
  Full-batch training loss = 0.305771, test loss = 0.338996
  Training set accuracy = 0.911400, Test set accuracy = 0.900400
 epoch 17/30. Took 0.58948 seconds. 
  Full-batch training loss = 0.289225, test loss = 0.324935
  Training set accuracy = 0.918800, Test set accuracy = 0.905200
 epoch 18/30. Took 0.62089 seconds. 
  Full-batch training loss = 0.280509, test loss = 0.318203
  Training set accuracy = 0.919200, Test set accuracy = 0.907700
 epoch 19/30. Took 0.59198 seconds. 
  Full-batch training loss = 0.273477, test loss = 0.312693
  Training set accuracy = 0.921400, Test set accuracy = 0.907900
 epoch 20/30. Took 0.59945 seconds. 
  Full-batch training loss = 0.263773, test loss = 0.307535
  Training set accuracy = 0.924400, Test set accuracy = 0.909600
 epoch 21/30. Took 0.58866 seconds. 
  Full-batch training loss = 0.255528, test loss = 0.301153
  Training set accuracy = 0.926600, Test set accuracy = 0.910700
 epoch 22/30. Took 0.58461 seconds. 
  Full-batch training loss = 0.249313, test loss = 0.298389
  Training set accuracy = 0.927800, Test set accuracy = 0.911600
 epoch 23/30. Took 0.59141 seconds. 
  Full-batch training loss = 0.245056, test loss = 0.298106
  Training set accuracy = 0.930200, Test set accuracy = 0.912000
 epoch 24/30. Took 0.59846 seconds. 
  Full-batch training loss = 0.234976, test loss = 0.289546
  Training set accuracy = 0.931800, Test set accuracy = 0.915300
 epoch 25/30. Took 0.60316 seconds. 
  Full-batch training loss = 0.226242, test loss = 0.283219
  Training set accuracy = 0.935200, Test set accuracy = 0.916500
 epoch 26/30. Took 0.64804 seconds. 
  Full-batch training loss = 0.220689, test loss = 0.280616
  Training set accuracy = 0.937200, Test set accuracy = 0.917000
 epoch 27/30. Took 0.59696 seconds. 
  Full-batch training loss = 0.216969, test loss = 0.277427
  Training set accuracy = 0.935800, Test set accuracy = 0.916600
 epoch 28/30. Took 0.61718 seconds. 
  Full-batch training loss = 0.208884, test loss = 0.273162
  Training set accuracy = 0.939800, Test set accuracy = 0.920300
 epoch 29/30. Took 0.59173 seconds. 
  Full-batch training loss = 0.202324, test loss = 0.268074
  Training set accuracy = 0.940400, Test set accuracy = 0.920300
 epoch 30/30. Took 0.61705 seconds. 
  Full-batch training loss = 0.199343, test loss = 0.267900
  Training set accuracy = 0.941000, Test set accuracy = 0.919900
Elapsed time is 38.322347 seconds.
End Training
-----
Params 5000 0.010 0.30 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.15914 seconds. 
  Full-batch training loss = 2.276589, test loss = 2.278376
  Training set accuracy = 0.205000, Test set accuracy = 0.210600
 epoch 2/30. Took 0.15776 seconds. 
  Full-batch training loss = 2.241719, test loss = 2.242769
  Training set accuracy = 0.372600, Test set accuracy = 0.379700
 epoch 3/30. Took 0.15959 seconds. 
  Full-batch training loss = 2.173307, test loss = 2.173084
  Training set accuracy = 0.462400, Test set accuracy = 0.471400
 epoch 4/30. Took 0.16159 seconds. 
  Full-batch training loss = 2.027587, test loss = 2.025782
  Training set accuracy = 0.494000, Test set accuracy = 0.497900
 epoch 5/30. Took 0.16416 seconds. 
  Full-batch training loss = 1.777423, test loss = 1.775805
  Training set accuracy = 0.527600, Test set accuracy = 0.525600
 epoch 6/30. Took 0.17435 seconds. 
  Full-batch training loss = 1.505568, test loss = 1.502695
  Training set accuracy = 0.613600, Test set accuracy = 0.617400
 epoch 7/30. Took 0.16273 seconds. 
  Full-batch training loss = 1.242224, test loss = 1.234061
  Training set accuracy = 0.682800, Test set accuracy = 0.683400
 epoch 8/30. Took 0.16226 seconds. 
  Full-batch training loss = 1.009821, test loss = 0.999379
  Training set accuracy = 0.747600, Test set accuracy = 0.746800
 epoch 9/30. Took 0.16168 seconds. 
  Full-batch training loss = 0.844997, test loss = 0.835621
  Training set accuracy = 0.782000, Test set accuracy = 0.787400
 epoch 10/30. Took 0.16275 seconds. 
  Full-batch training loss = 0.739972, test loss = 0.731318
  Training set accuracy = 0.806000, Test set accuracy = 0.808800
 epoch 11/30. Took 0.15333 seconds. 
  Full-batch training loss = 0.662605, test loss = 0.655646
  Training set accuracy = 0.825600, Test set accuracy = 0.833100
 epoch 12/30. Took 0.15391 seconds. 
  Full-batch training loss = 0.601270, test loss = 0.594992
  Training set accuracy = 0.839400, Test set accuracy = 0.847000
 epoch 13/30. Took 0.15244 seconds. 
  Full-batch training loss = 0.560234, test loss = 0.557540
  Training set accuracy = 0.849800, Test set accuracy = 0.851600
 epoch 14/30. Took 0.16523 seconds. 
  Full-batch training loss = 0.519529, test loss = 0.519241
  Training set accuracy = 0.859600, Test set accuracy = 0.863000
 epoch 15/30. Took 0.16335 seconds. 
  Full-batch training loss = 0.496280, test loss = 0.494596
  Training set accuracy = 0.864200, Test set accuracy = 0.865400
 epoch 16/30. Took 0.16981 seconds. 
  Full-batch training loss = 0.466205, test loss = 0.469436
  Training set accuracy = 0.872200, Test set accuracy = 0.872100
 epoch 17/30. Took 0.16858 seconds. 
  Full-batch training loss = 0.440690, test loss = 0.445216
  Training set accuracy = 0.879000, Test set accuracy = 0.877400
 epoch 18/30. Took 0.15988 seconds. 
  Full-batch training loss = 0.424494, test loss = 0.433935
  Training set accuracy = 0.884200, Test set accuracy = 0.878800
 epoch 19/30. Took 0.1707 seconds. 
  Full-batch training loss = 0.405180, test loss = 0.415149
  Training set accuracy = 0.886600, Test set accuracy = 0.882200
 epoch 20/30. Took 0.16588 seconds. 
  Full-batch training loss = 0.389842, test loss = 0.401930
  Training set accuracy = 0.888800, Test set accuracy = 0.886800
 epoch 21/30. Took 0.15854 seconds. 
  Full-batch training loss = 0.369650, test loss = 0.386102
  Training set accuracy = 0.893800, Test set accuracy = 0.890200
 epoch 22/30. Took 0.15226 seconds. 
  Full-batch training loss = 0.362197, test loss = 0.379954
  Training set accuracy = 0.894400, Test set accuracy = 0.892900
 epoch 23/30. Took 0.15663 seconds. 
  Full-batch training loss = 0.352862, test loss = 0.372631
  Training set accuracy = 0.896800, Test set accuracy = 0.890300
 epoch 24/30. Took 0.16111 seconds. 
  Full-batch training loss = 0.340600, test loss = 0.363339
  Training set accuracy = 0.897200, Test set accuracy = 0.895300
 epoch 25/30. Took 0.1619 seconds. 
  Full-batch training loss = 0.337689, test loss = 0.364864
  Training set accuracy = 0.896600, Test set accuracy = 0.895100
 epoch 26/30. Took 0.16163 seconds. 
  Full-batch training loss = 0.320018, test loss = 0.350166
  Training set accuracy = 0.902600, Test set accuracy = 0.900500
 epoch 27/30. Took 0.15491 seconds. 
  Full-batch training loss = 0.307959, test loss = 0.339068
  Training set accuracy = 0.907600, Test set accuracy = 0.900700
 epoch 28/30. Took 0.16511 seconds. 
  Full-batch training loss = 0.296368, test loss = 0.331669
  Training set accuracy = 0.911000, Test set accuracy = 0.903500
 epoch 29/30. Took 0.14925 seconds. 
  Full-batch training loss = 0.289212, test loss = 0.327011
  Training set accuracy = 0.913200, Test set accuracy = 0.904900
 epoch 30/30. Took 0.15979 seconds. 
  Full-batch training loss = 0.282598, test loss = 0.323139
  Training set accuracy = 0.912600, Test set accuracy = 0.905800
Elapsed time is 10.954064 seconds.
End Training
-----
Params 5000 0.010 0.30 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.29678 seconds. 
  Full-batch training loss = 2.266155, test loss = 2.266328
  Training set accuracy = 0.242800, Test set accuracy = 0.227400
 epoch 2/30. Took 0.29691 seconds. 
  Full-batch training loss = 2.200811, test loss = 2.202202
  Training set accuracy = 0.369600, Test set accuracy = 0.367900
 epoch 3/30. Took 0.27652 seconds. 
  Full-batch training loss = 2.067188, test loss = 2.069217
  Training set accuracy = 0.442200, Test set accuracy = 0.445100
 epoch 4/30. Took 0.29518 seconds. 
  Full-batch training loss = 1.824280, test loss = 1.823205
  Training set accuracy = 0.512600, Test set accuracy = 0.517900
 epoch 5/30. Took 0.29609 seconds. 
  Full-batch training loss = 1.443639, test loss = 1.435931
  Training set accuracy = 0.636000, Test set accuracy = 0.644200
 epoch 6/30. Took 0.28877 seconds. 
  Full-batch training loss = 1.064099, test loss = 1.053742
  Training set accuracy = 0.729600, Test set accuracy = 0.737000
 epoch 7/30. Took 0.28077 seconds. 
  Full-batch training loss = 0.840308, test loss = 0.828096
  Training set accuracy = 0.764400, Test set accuracy = 0.776900
 epoch 8/30. Took 0.27909 seconds. 
  Full-batch training loss = 0.709480, test loss = 0.695779
  Training set accuracy = 0.827400, Test set accuracy = 0.828800
 epoch 9/30. Took 0.27372 seconds. 
  Full-batch training loss = 0.628648, test loss = 0.613971
  Training set accuracy = 0.827800, Test set accuracy = 0.829800
 epoch 10/30. Took 0.29302 seconds. 
  Full-batch training loss = 0.562029, test loss = 0.550094
  Training set accuracy = 0.842600, Test set accuracy = 0.847100
 epoch 11/30. Took 0.28299 seconds. 
  Full-batch training loss = 0.520488, test loss = 0.509608
  Training set accuracy = 0.860400, Test set accuracy = 0.861100
 epoch 12/30. Took 0.28397 seconds. 
  Full-batch training loss = 0.486101, test loss = 0.478610
  Training set accuracy = 0.864800, Test set accuracy = 0.864700
 epoch 13/30. Took 0.28288 seconds. 
  Full-batch training loss = 0.459001, test loss = 0.453167
  Training set accuracy = 0.878000, Test set accuracy = 0.872400
 epoch 14/30. Took 0.28341 seconds. 
  Full-batch training loss = 0.433110, test loss = 0.429025
  Training set accuracy = 0.883600, Test set accuracy = 0.880200
 epoch 15/30. Took 0.28312 seconds. 
  Full-batch training loss = 0.410953, test loss = 0.409765
  Training set accuracy = 0.889800, Test set accuracy = 0.884700
 epoch 16/30. Took 0.28307 seconds. 
  Full-batch training loss = 0.392178, test loss = 0.395615
  Training set accuracy = 0.896000, Test set accuracy = 0.889100
 epoch 17/30. Took 0.283 seconds. 
  Full-batch training loss = 0.376003, test loss = 0.382757
  Training set accuracy = 0.898000, Test set accuracy = 0.892400
 epoch 18/30. Took 0.29922 seconds. 
  Full-batch training loss = 0.362595, test loss = 0.370987
  Training set accuracy = 0.900000, Test set accuracy = 0.894900
 epoch 19/30. Took 0.28219 seconds. 
  Full-batch training loss = 0.351047, test loss = 0.362939
  Training set accuracy = 0.901600, Test set accuracy = 0.897200
 epoch 20/30. Took 0.2833 seconds. 
  Full-batch training loss = 0.334187, test loss = 0.349015
  Training set accuracy = 0.907600, Test set accuracy = 0.901100
 epoch 21/30. Took 0.29428 seconds. 
  Full-batch training loss = 0.326465, test loss = 0.343129
  Training set accuracy = 0.909800, Test set accuracy = 0.901000
 epoch 22/30. Took 0.27858 seconds. 
  Full-batch training loss = 0.313331, test loss = 0.334624
  Training set accuracy = 0.911400, Test set accuracy = 0.904600
 epoch 23/30. Took 0.28353 seconds. 
  Full-batch training loss = 0.300545, test loss = 0.324263
  Training set accuracy = 0.917000, Test set accuracy = 0.906900
 epoch 24/30. Took 0.28429 seconds. 
  Full-batch training loss = 0.293241, test loss = 0.320483
  Training set accuracy = 0.917800, Test set accuracy = 0.906600
 epoch 25/30. Took 0.28273 seconds. 
  Full-batch training loss = 0.281497, test loss = 0.313923
  Training set accuracy = 0.920400, Test set accuracy = 0.908600
 epoch 26/30. Took 0.29613 seconds. 
  Full-batch training loss = 0.271433, test loss = 0.307866
  Training set accuracy = 0.924400, Test set accuracy = 0.909900
 epoch 27/30. Took 0.284 seconds. 
  Full-batch training loss = 0.264895, test loss = 0.303716
  Training set accuracy = 0.925800, Test set accuracy = 0.911500
 epoch 28/30. Took 0.28991 seconds. 
  Full-batch training loss = 0.258894, test loss = 0.303715
  Training set accuracy = 0.927200, Test set accuracy = 0.910000
 epoch 29/30. Took 0.28088 seconds. 
  Full-batch training loss = 0.245851, test loss = 0.291396
  Training set accuracy = 0.932800, Test set accuracy = 0.913800
 epoch 30/30. Took 0.28181 seconds. 
  Full-batch training loss = 0.237376, test loss = 0.289466
  Training set accuracy = 0.934200, Test set accuracy = 0.914400
Elapsed time is 18.670427 seconds.
End Training
-----
Params 5000 0.010 0.30 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.82113 seconds. 
  Full-batch training loss = 2.252996, test loss = 2.253261
  Training set accuracy = 0.231200, Test set accuracy = 0.220600
 epoch 2/30. Took 0.89782 seconds. 
  Full-batch training loss = 2.166651, test loss = 2.166404
  Training set accuracy = 0.532000, Test set accuracy = 0.524400
 epoch 3/30. Took 0.84503 seconds. 
  Full-batch training loss = 1.970942, test loss = 1.968887
  Training set accuracy = 0.625000, Test set accuracy = 0.622100
 epoch 4/30. Took 0.82391 seconds. 
  Full-batch training loss = 1.542135, test loss = 1.533816
  Training set accuracy = 0.686400, Test set accuracy = 0.679400
 epoch 5/30. Took 0.82156 seconds. 
  Full-batch training loss = 1.038967, test loss = 1.027150
  Training set accuracy = 0.747000, Test set accuracy = 0.739100
 epoch 6/30. Took 0.82254 seconds. 
  Full-batch training loss = 0.761645, test loss = 0.754729
  Training set accuracy = 0.798400, Test set accuracy = 0.788100
 epoch 7/30. Took 0.82679 seconds. 
  Full-batch training loss = 0.631658, test loss = 0.633139
  Training set accuracy = 0.820600, Test set accuracy = 0.808100
 epoch 8/30. Took 0.82568 seconds. 
  Full-batch training loss = 0.539468, test loss = 0.543495
  Training set accuracy = 0.849200, Test set accuracy = 0.841900
 epoch 9/30. Took 0.82314 seconds. 
  Full-batch training loss = 0.483752, test loss = 0.493517
  Training set accuracy = 0.864600, Test set accuracy = 0.855300
 epoch 10/30. Took 0.91015 seconds. 
  Full-batch training loss = 0.437449, test loss = 0.451271
  Training set accuracy = 0.879800, Test set accuracy = 0.871400
 epoch 11/30. Took 0.81577 seconds. 
  Full-batch training loss = 0.407875, test loss = 0.429449
  Training set accuracy = 0.888400, Test set accuracy = 0.876700
 epoch 12/30. Took 0.872 seconds. 
  Full-batch training loss = 0.382265, test loss = 0.403449
  Training set accuracy = 0.893600, Test set accuracy = 0.881000
 epoch 13/30. Took 0.83369 seconds. 
  Full-batch training loss = 0.363216, test loss = 0.388101
  Training set accuracy = 0.901400, Test set accuracy = 0.887200
 epoch 14/30. Took 0.91318 seconds. 
  Full-batch training loss = 0.341858, test loss = 0.368949
  Training set accuracy = 0.905800, Test set accuracy = 0.891300
 epoch 15/30. Took 0.8947 seconds. 
  Full-batch training loss = 0.324861, test loss = 0.357898
  Training set accuracy = 0.910200, Test set accuracy = 0.893100
 epoch 16/30. Took 0.87069 seconds. 
  Full-batch training loss = 0.310357, test loss = 0.345493
  Training set accuracy = 0.916200, Test set accuracy = 0.898100
 epoch 17/30. Took 0.82181 seconds. 
  Full-batch training loss = 0.298415, test loss = 0.339963
  Training set accuracy = 0.919800, Test set accuracy = 0.899100
 epoch 18/30. Took 0.82404 seconds. 
  Full-batch training loss = 0.283157, test loss = 0.329179
  Training set accuracy = 0.922000, Test set accuracy = 0.902400
 epoch 19/30. Took 0.89759 seconds. 
  Full-batch training loss = 0.269234, test loss = 0.317048
  Training set accuracy = 0.926200, Test set accuracy = 0.907300
 epoch 20/30. Took 0.82826 seconds. 
  Full-batch training loss = 0.262676, test loss = 0.311946
  Training set accuracy = 0.930000, Test set accuracy = 0.908900
 epoch 21/30. Took 0.83112 seconds. 
  Full-batch training loss = 0.252531, test loss = 0.310499
  Training set accuracy = 0.930000, Test set accuracy = 0.907800
 epoch 22/30. Took 0.82795 seconds. 
  Full-batch training loss = 0.241761, test loss = 0.299204
  Training set accuracy = 0.931800, Test set accuracy = 0.910400
 epoch 23/30. Took 0.86202 seconds. 
  Full-batch training loss = 0.232102, test loss = 0.292739
  Training set accuracy = 0.935400, Test set accuracy = 0.913000
 epoch 24/30. Took 0.83236 seconds. 
  Full-batch training loss = 0.224199, test loss = 0.285558
  Training set accuracy = 0.936600, Test set accuracy = 0.915500
 epoch 25/30. Took 0.82918 seconds. 
  Full-batch training loss = 0.214102, test loss = 0.281970
  Training set accuracy = 0.940400, Test set accuracy = 0.916100
 epoch 26/30. Took 0.82524 seconds. 
  Full-batch training loss = 0.207321, test loss = 0.278933
  Training set accuracy = 0.942000, Test set accuracy = 0.916800
 epoch 27/30. Took 0.82322 seconds. 
  Full-batch training loss = 0.197968, test loss = 0.271398
  Training set accuracy = 0.944400, Test set accuracy = 0.918200
 epoch 28/30. Took 0.88965 seconds. 
  Full-batch training loss = 0.192775, test loss = 0.267399
  Training set accuracy = 0.944800, Test set accuracy = 0.920200
 epoch 29/30. Took 0.92156 seconds. 
  Full-batch training loss = 0.184466, test loss = 0.263446
  Training set accuracy = 0.946000, Test set accuracy = 0.920900
 epoch 30/30. Took 0.82063 seconds. 
  Full-batch training loss = 0.180243, test loss = 0.259281
  Training set accuracy = 0.950000, Test set accuracy = 0.922400
Elapsed time is 52.972827 seconds.
End Training
-----
Params 5000 0.010 0.40 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11768 seconds. 
  Full-batch training loss = 1.950365, test loss = 1.948274
  Training set accuracy = 0.645200, Test set accuracy = 0.635300
 epoch 2/30. Took 0.10969 seconds. 
  Full-batch training loss = 1.455850, test loss = 1.444189
  Training set accuracy = 0.755000, Test set accuracy = 0.750400
 epoch 3/30. Took 0.10759 seconds. 
  Full-batch training loss = 1.061923, test loss = 1.049999
  Training set accuracy = 0.811400, Test set accuracy = 0.813000
 epoch 4/30. Took 0.10913 seconds. 
  Full-batch training loss = 0.838471, test loss = 0.830166
  Training set accuracy = 0.855600, Test set accuracy = 0.848100
 epoch 5/30. Took 0.10882 seconds. 
  Full-batch training loss = 0.704313, test loss = 0.700636
  Training set accuracy = 0.862400, Test set accuracy = 0.855300
 epoch 6/30. Took 0.10972 seconds. 
  Full-batch training loss = 0.620867, test loss = 0.621866
  Training set accuracy = 0.869600, Test set accuracy = 0.865600
 epoch 7/30. Took 0.10935 seconds. 
  Full-batch training loss = 0.559491, test loss = 0.563944
  Training set accuracy = 0.879600, Test set accuracy = 0.873000
 epoch 8/30. Took 0.10844 seconds. 
  Full-batch training loss = 0.515916, test loss = 0.522836
  Training set accuracy = 0.885200, Test set accuracy = 0.878600
 epoch 9/30. Took 0.11019 seconds. 
  Full-batch training loss = 0.479225, test loss = 0.489317
  Training set accuracy = 0.891800, Test set accuracy = 0.881900
 epoch 10/30. Took 0.1095 seconds. 
  Full-batch training loss = 0.453404, test loss = 0.467466
  Training set accuracy = 0.895400, Test set accuracy = 0.884800
 epoch 11/30. Took 0.10904 seconds. 
  Full-batch training loss = 0.428791, test loss = 0.444809
  Training set accuracy = 0.900200, Test set accuracy = 0.887400
 epoch 12/30. Took 0.11089 seconds. 
  Full-batch training loss = 0.410657, test loss = 0.430626
  Training set accuracy = 0.900400, Test set accuracy = 0.888100
 epoch 13/30. Took 0.11566 seconds. 
  Full-batch training loss = 0.392854, test loss = 0.414332
  Training set accuracy = 0.905600, Test set accuracy = 0.892200
 epoch 14/30. Took 0.10941 seconds. 
  Full-batch training loss = 0.380359, test loss = 0.404065
  Training set accuracy = 0.906400, Test set accuracy = 0.894000
 epoch 15/30. Took 0.10912 seconds. 
  Full-batch training loss = 0.368815, test loss = 0.394462
  Training set accuracy = 0.908200, Test set accuracy = 0.896900
 epoch 16/30. Took 0.11006 seconds. 
  Full-batch training loss = 0.355341, test loss = 0.382281
  Training set accuracy = 0.912200, Test set accuracy = 0.896900
 epoch 17/30. Took 0.11229 seconds. 
  Full-batch training loss = 0.345471, test loss = 0.373855
  Training set accuracy = 0.911000, Test set accuracy = 0.898300
 epoch 18/30. Took 0.10729 seconds. 
  Full-batch training loss = 0.334936, test loss = 0.365201
  Training set accuracy = 0.916800, Test set accuracy = 0.900100
 epoch 19/30. Took 0.10904 seconds. 
  Full-batch training loss = 0.325744, test loss = 0.358489
  Training set accuracy = 0.916200, Test set accuracy = 0.900700
 epoch 20/30. Took 0.10938 seconds. 
  Full-batch training loss = 0.318641, test loss = 0.353180
  Training set accuracy = 0.918000, Test set accuracy = 0.901700
 epoch 21/30. Took 0.1096 seconds. 
  Full-batch training loss = 0.312515, test loss = 0.349346
  Training set accuracy = 0.917800, Test set accuracy = 0.904000
 epoch 22/30. Took 0.1093 seconds. 
  Full-batch training loss = 0.304300, test loss = 0.342393
  Training set accuracy = 0.921600, Test set accuracy = 0.904100
 epoch 23/30. Took 0.1085 seconds. 
  Full-batch training loss = 0.298433, test loss = 0.338567
  Training set accuracy = 0.921000, Test set accuracy = 0.904500
 epoch 24/30. Took 0.10633 seconds. 
  Full-batch training loss = 0.291101, test loss = 0.332611
  Training set accuracy = 0.922800, Test set accuracy = 0.906600
 epoch 25/30. Took 0.1092 seconds. 
  Full-batch training loss = 0.285195, test loss = 0.327685
  Training set accuracy = 0.924400, Test set accuracy = 0.907400
 epoch 26/30. Took 0.11104 seconds. 
  Full-batch training loss = 0.279751, test loss = 0.324571
  Training set accuracy = 0.926600, Test set accuracy = 0.908200
 epoch 27/30. Took 0.11008 seconds. 
  Full-batch training loss = 0.274241, test loss = 0.319926
  Training set accuracy = 0.927400, Test set accuracy = 0.910800
 epoch 28/30. Took 0.10605 seconds. 
  Full-batch training loss = 0.269421, test loss = 0.316265
  Training set accuracy = 0.925200, Test set accuracy = 0.911100
 epoch 29/30. Took 0.10504 seconds. 
  Full-batch training loss = 0.265295, test loss = 0.314706
  Training set accuracy = 0.929200, Test set accuracy = 0.909700
 epoch 30/30. Took 0.10531 seconds. 
  Full-batch training loss = 0.259630, test loss = 0.309628
  Training set accuracy = 0.930600, Test set accuracy = 0.913600
Elapsed time is 8.037417 seconds.
End Training
-----
Params 5000 0.010 0.40 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17315 seconds. 
  Full-batch training loss = 1.822478, test loss = 1.819573
  Training set accuracy = 0.681200, Test set accuracy = 0.679000
 epoch 2/30. Took 0.16414 seconds. 
  Full-batch training loss = 1.305127, test loss = 1.293793
  Training set accuracy = 0.783400, Test set accuracy = 0.780200
 epoch 3/30. Took 0.1851 seconds. 
  Full-batch training loss = 0.965717, test loss = 0.952751
  Training set accuracy = 0.820800, Test set accuracy = 0.818600
 epoch 4/30. Took 0.18798 seconds. 
  Full-batch training loss = 0.781108, test loss = 0.765532
  Training set accuracy = 0.835000, Test set accuracy = 0.839900
 epoch 5/30. Took 0.16658 seconds. 
  Full-batch training loss = 0.673006, test loss = 0.660312
  Training set accuracy = 0.848000, Test set accuracy = 0.851600
 epoch 6/30. Took 0.16306 seconds. 
  Full-batch training loss = 0.606354, test loss = 0.593048
  Training set accuracy = 0.854400, Test set accuracy = 0.860200
 epoch 7/30. Took 0.16417 seconds. 
  Full-batch training loss = 0.557331, test loss = 0.546230
  Training set accuracy = 0.857400, Test set accuracy = 0.864400
 epoch 8/30. Took 0.16408 seconds. 
  Full-batch training loss = 0.519607, test loss = 0.508397
  Training set accuracy = 0.868000, Test set accuracy = 0.877100
 epoch 9/30. Took 0.1636 seconds. 
  Full-batch training loss = 0.489320, test loss = 0.479324
  Training set accuracy = 0.875000, Test set accuracy = 0.883700
 epoch 10/30. Took 0.16371 seconds. 
  Full-batch training loss = 0.465821, test loss = 0.457692
  Training set accuracy = 0.879200, Test set accuracy = 0.886200
 epoch 11/30. Took 0.18791 seconds. 
  Full-batch training loss = 0.447091, test loss = 0.440106
  Training set accuracy = 0.879800, Test set accuracy = 0.887700
 epoch 12/30. Took 0.18252 seconds. 
  Full-batch training loss = 0.429292, test loss = 0.425237
  Training set accuracy = 0.884000, Test set accuracy = 0.891400
 epoch 13/30. Took 0.17148 seconds. 
  Full-batch training loss = 0.415204, test loss = 0.413822
  Training set accuracy = 0.887400, Test set accuracy = 0.893900
 epoch 14/30. Took 0.16925 seconds. 
  Full-batch training loss = 0.401986, test loss = 0.401598
  Training set accuracy = 0.892400, Test set accuracy = 0.895600
 epoch 15/30. Took 0.16951 seconds. 
  Full-batch training loss = 0.391993, test loss = 0.392965
  Training set accuracy = 0.893400, Test set accuracy = 0.898400
 epoch 16/30. Took 0.16891 seconds. 
  Full-batch training loss = 0.380400, test loss = 0.382981
  Training set accuracy = 0.896400, Test set accuracy = 0.899200
 epoch 17/30. Took 0.16576 seconds. 
  Full-batch training loss = 0.369877, test loss = 0.374555
  Training set accuracy = 0.898600, Test set accuracy = 0.901700
 epoch 18/30. Took 0.16817 seconds. 
  Full-batch training loss = 0.361638, test loss = 0.368077
  Training set accuracy = 0.899200, Test set accuracy = 0.901600
 epoch 19/30. Took 0.16913 seconds. 
  Full-batch training loss = 0.351531, test loss = 0.359834
  Training set accuracy = 0.903800, Test set accuracy = 0.904400
 epoch 20/30. Took 0.16763 seconds. 
  Full-batch training loss = 0.344512, test loss = 0.354462
  Training set accuracy = 0.904400, Test set accuracy = 0.905700
 epoch 21/30. Took 0.16659 seconds. 
  Full-batch training loss = 0.336319, test loss = 0.348631
  Training set accuracy = 0.906000, Test set accuracy = 0.904500
 epoch 22/30. Took 0.16298 seconds. 
  Full-batch training loss = 0.329448, test loss = 0.343167
  Training set accuracy = 0.908600, Test set accuracy = 0.905800
 epoch 23/30. Took 0.16374 seconds. 
  Full-batch training loss = 0.322607, test loss = 0.337933
  Training set accuracy = 0.910600, Test set accuracy = 0.906800
 epoch 24/30. Took 0.16932 seconds. 
  Full-batch training loss = 0.316380, test loss = 0.334457
  Training set accuracy = 0.910000, Test set accuracy = 0.907400
 epoch 25/30. Took 0.16903 seconds. 
  Full-batch training loss = 0.310646, test loss = 0.329724
  Training set accuracy = 0.911800, Test set accuracy = 0.909100
 epoch 26/30. Took 0.17001 seconds. 
  Full-batch training loss = 0.304009, test loss = 0.324502
  Training set accuracy = 0.914000, Test set accuracy = 0.910500
 epoch 27/30. Took 0.16923 seconds. 
  Full-batch training loss = 0.298890, test loss = 0.322095
  Training set accuracy = 0.916600, Test set accuracy = 0.911200
 epoch 28/30. Took 0.16877 seconds. 
  Full-batch training loss = 0.292661, test loss = 0.317886
  Training set accuracy = 0.918000, Test set accuracy = 0.912000
 epoch 29/30. Took 0.17095 seconds. 
  Full-batch training loss = 0.287655, test loss = 0.314779
  Training set accuracy = 0.919400, Test set accuracy = 0.912400
 epoch 30/30. Took 0.16837 seconds. 
  Full-batch training loss = 0.282842, test loss = 0.311039
  Training set accuracy = 0.919400, Test set accuracy = 0.914400
Elapsed time is 11.701733 seconds.
End Training
-----
Params 5000 0.010 0.40 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.36279 seconds. 
  Full-batch training loss = 1.794454, test loss = 1.784900
  Training set accuracy = 0.728000, Test set accuracy = 0.721800
 epoch 2/30. Took 0.35735 seconds. 
  Full-batch training loss = 1.245853, test loss = 1.230592
  Training set accuracy = 0.776000, Test set accuracy = 0.780200
 epoch 3/30. Took 0.34932 seconds. 
  Full-batch training loss = 0.902161, test loss = 0.885308
  Training set accuracy = 0.826800, Test set accuracy = 0.825800
 epoch 4/30. Took 0.34956 seconds. 
  Full-batch training loss = 0.724655, test loss = 0.708044
  Training set accuracy = 0.847800, Test set accuracy = 0.850100
 epoch 5/30. Took 0.3574 seconds. 
  Full-batch training loss = 0.622075, test loss = 0.607991
  Training set accuracy = 0.855000, Test set accuracy = 0.859500
 epoch 6/30. Took 0.35543 seconds. 
  Full-batch training loss = 0.553644, test loss = 0.544183
  Training set accuracy = 0.868200, Test set accuracy = 0.868300
 epoch 7/30. Took 0.36556 seconds. 
  Full-batch training loss = 0.510430, test loss = 0.503973
  Training set accuracy = 0.875800, Test set accuracy = 0.875700
 epoch 8/30. Took 0.35417 seconds. 
  Full-batch training loss = 0.474704, test loss = 0.472728
  Training set accuracy = 0.881000, Test set accuracy = 0.879800
 epoch 9/30. Took 0.35617 seconds. 
  Full-batch training loss = 0.447485, test loss = 0.448248
  Training set accuracy = 0.885400, Test set accuracy = 0.884100
 epoch 10/30. Took 0.35595 seconds. 
  Full-batch training loss = 0.425399, test loss = 0.429017
  Training set accuracy = 0.889000, Test set accuracy = 0.886300
 epoch 11/30. Took 0.35341 seconds. 
  Full-batch training loss = 0.407043, test loss = 0.413952
  Training set accuracy = 0.893800, Test set accuracy = 0.889500
 epoch 12/30. Took 0.35608 seconds. 
  Full-batch training loss = 0.392572, test loss = 0.401613
  Training set accuracy = 0.897600, Test set accuracy = 0.891200
 epoch 13/30. Took 0.37422 seconds. 
  Full-batch training loss = 0.379877, test loss = 0.391751
  Training set accuracy = 0.897400, Test set accuracy = 0.892900
 epoch 14/30. Took 0.36794 seconds. 
  Full-batch training loss = 0.367090, test loss = 0.379755
  Training set accuracy = 0.902200, Test set accuracy = 0.896000
 epoch 15/30. Took 0.3733 seconds. 
  Full-batch training loss = 0.357568, test loss = 0.373097
  Training set accuracy = 0.902000, Test set accuracy = 0.896200
 epoch 16/30. Took 0.37871 seconds. 
  Full-batch training loss = 0.346730, test loss = 0.364163
  Training set accuracy = 0.905400, Test set accuracy = 0.899900
 epoch 17/30. Took 0.35151 seconds. 
  Full-batch training loss = 0.336534, test loss = 0.356465
  Training set accuracy = 0.908600, Test set accuracy = 0.900900
 epoch 18/30. Took 0.355 seconds. 
  Full-batch training loss = 0.329835, test loss = 0.349571
  Training set accuracy = 0.909800, Test set accuracy = 0.903100
 epoch 19/30. Took 0.37583 seconds. 
  Full-batch training loss = 0.321754, test loss = 0.343809
  Training set accuracy = 0.912600, Test set accuracy = 0.903600
 epoch 20/30. Took 0.39593 seconds. 
  Full-batch training loss = 0.314630, test loss = 0.340644
  Training set accuracy = 0.914000, Test set accuracy = 0.905300
 epoch 21/30. Took 0.34883 seconds. 
  Full-batch training loss = 0.308481, test loss = 0.335671
  Training set accuracy = 0.917200, Test set accuracy = 0.904900
 epoch 22/30. Took 0.35573 seconds. 
  Full-batch training loss = 0.302368, test loss = 0.334715
  Training set accuracy = 0.917800, Test set accuracy = 0.904300
 epoch 23/30. Took 0.35487 seconds. 
  Full-batch training loss = 0.296637, test loss = 0.326672
  Training set accuracy = 0.919400, Test set accuracy = 0.908800
 epoch 24/30. Took 0.39135 seconds. 
  Full-batch training loss = 0.291081, test loss = 0.325447
  Training set accuracy = 0.920800, Test set accuracy = 0.908100
 epoch 25/30. Took 0.35733 seconds. 
  Full-batch training loss = 0.286020, test loss = 0.322579
  Training set accuracy = 0.921200, Test set accuracy = 0.908400
 epoch 26/30. Took 0.36815 seconds. 
  Full-batch training loss = 0.280064, test loss = 0.318204
  Training set accuracy = 0.922200, Test set accuracy = 0.908600
 epoch 27/30. Took 0.35893 seconds. 
  Full-batch training loss = 0.275260, test loss = 0.313266
  Training set accuracy = 0.926800, Test set accuracy = 0.911000
 epoch 28/30. Took 0.35647 seconds. 
  Full-batch training loss = 0.270912, test loss = 0.310309
  Training set accuracy = 0.925800, Test set accuracy = 0.913100
 epoch 29/30. Took 0.3524 seconds. 
  Full-batch training loss = 0.266090, test loss = 0.309230
  Training set accuracy = 0.926800, Test set accuracy = 0.912100
 epoch 30/30. Took 0.35627 seconds. 
  Full-batch training loss = 0.261429, test loss = 0.304548
  Training set accuracy = 0.929400, Test set accuracy = 0.913000
Elapsed time is 23.535204 seconds.
End Training
-----
Params 5000 0.010 0.40 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14877 seconds. 
  Full-batch training loss = 2.221634, test loss = 2.221640
  Training set accuracy = 0.323800, Test set accuracy = 0.314800
 epoch 2/30. Took 0.13435 seconds. 
  Full-batch training loss = 2.084396, test loss = 2.081461
  Training set accuracy = 0.566400, Test set accuracy = 0.569200
 epoch 3/30. Took 0.14014 seconds. 
  Full-batch training loss = 1.847987, test loss = 1.840163
  Training set accuracy = 0.639800, Test set accuracy = 0.634000
 epoch 4/30. Took 0.13615 seconds. 
  Full-batch training loss = 1.525172, test loss = 1.509914
  Training set accuracy = 0.705000, Test set accuracy = 0.699700
 epoch 5/30. Took 0.14365 seconds. 
  Full-batch training loss = 1.217631, test loss = 1.198884
  Training set accuracy = 0.744800, Test set accuracy = 0.744300
 epoch 6/30. Took 0.14187 seconds. 
  Full-batch training loss = 1.000687, test loss = 0.982397
  Training set accuracy = 0.779400, Test set accuracy = 0.774500
 epoch 7/30. Took 0.13571 seconds. 
  Full-batch training loss = 0.852711, test loss = 0.833260
  Training set accuracy = 0.801200, Test set accuracy = 0.795600
 epoch 8/30. Took 0.13583 seconds. 
  Full-batch training loss = 0.757514, test loss = 0.742968
  Training set accuracy = 0.815800, Test set accuracy = 0.813700
 epoch 9/30. Took 0.13619 seconds. 
  Full-batch training loss = 0.685449, test loss = 0.672298
  Training set accuracy = 0.827400, Test set accuracy = 0.822200
 epoch 10/30. Took 0.13617 seconds. 
  Full-batch training loss = 0.631961, test loss = 0.621422
  Training set accuracy = 0.833600, Test set accuracy = 0.834300
 epoch 11/30. Took 0.13581 seconds. 
  Full-batch training loss = 0.591001, test loss = 0.584911
  Training set accuracy = 0.841600, Test set accuracy = 0.841300
 epoch 12/30. Took 0.13597 seconds. 
  Full-batch training loss = 0.549133, test loss = 0.542521
  Training set accuracy = 0.859000, Test set accuracy = 0.855300
 epoch 13/30. Took 0.1364 seconds. 
  Full-batch training loss = 0.525010, test loss = 0.523084
  Training set accuracy = 0.859400, Test set accuracy = 0.857600
 epoch 14/30. Took 0.13582 seconds. 
  Full-batch training loss = 0.500733, test loss = 0.502150
  Training set accuracy = 0.869600, Test set accuracy = 0.864100
 epoch 15/30. Took 0.13718 seconds. 
  Full-batch training loss = 0.483459, test loss = 0.485661
  Training set accuracy = 0.870000, Test set accuracy = 0.864700
 epoch 16/30. Took 0.13585 seconds. 
  Full-batch training loss = 0.460441, test loss = 0.465024
  Training set accuracy = 0.876600, Test set accuracy = 0.872500
 epoch 17/30. Took 0.13646 seconds. 
  Full-batch training loss = 0.442755, test loss = 0.452248
  Training set accuracy = 0.882400, Test set accuracy = 0.877300
 epoch 18/30. Took 0.13608 seconds. 
  Full-batch training loss = 0.425637, test loss = 0.434990
  Training set accuracy = 0.889400, Test set accuracy = 0.880900
 epoch 19/30. Took 0.12942 seconds. 
  Full-batch training loss = 0.412556, test loss = 0.426378
  Training set accuracy = 0.889600, Test set accuracy = 0.882000
 epoch 20/30. Took 0.12804 seconds. 
  Full-batch training loss = 0.400410, test loss = 0.412601
  Training set accuracy = 0.895600, Test set accuracy = 0.885900
 epoch 21/30. Took 0.12852 seconds. 
  Full-batch training loss = 0.389223, test loss = 0.403876
  Training set accuracy = 0.898000, Test set accuracy = 0.887400
 epoch 22/30. Took 0.13513 seconds. 
  Full-batch training loss = 0.378805, test loss = 0.394231
  Training set accuracy = 0.899600, Test set accuracy = 0.889100
 epoch 23/30. Took 0.13533 seconds. 
  Full-batch training loss = 0.368031, test loss = 0.385517
  Training set accuracy = 0.904400, Test set accuracy = 0.892400
 epoch 24/30. Took 0.13623 seconds. 
  Full-batch training loss = 0.359103, test loss = 0.378355
  Training set accuracy = 0.905200, Test set accuracy = 0.892600
 epoch 25/30. Took 0.13739 seconds. 
  Full-batch training loss = 0.345896, test loss = 0.368781
  Training set accuracy = 0.905800, Test set accuracy = 0.893500
 epoch 26/30. Took 0.14457 seconds. 
  Full-batch training loss = 0.340304, test loss = 0.362873
  Training set accuracy = 0.907600, Test set accuracy = 0.895900
 epoch 27/30. Took 0.14009 seconds. 
  Full-batch training loss = 0.330914, test loss = 0.358679
  Training set accuracy = 0.910800, Test set accuracy = 0.896800
 epoch 28/30. Took 0.13405 seconds. 
  Full-batch training loss = 0.323771, test loss = 0.352272
  Training set accuracy = 0.911400, Test set accuracy = 0.896700
 epoch 29/30. Took 0.13468 seconds. 
  Full-batch training loss = 0.317052, test loss = 0.344895
  Training set accuracy = 0.911600, Test set accuracy = 0.898100
 epoch 30/30. Took 0.13939 seconds. 
  Full-batch training loss = 0.313427, test loss = 0.347028
  Training set accuracy = 0.912400, Test set accuracy = 0.899300
Elapsed time is 9.522899 seconds.
End Training
-----
Params 5000 0.010 0.40 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23612 seconds. 
  Full-batch training loss = 2.217357, test loss = 2.217943
  Training set accuracy = 0.400200, Test set accuracy = 0.383200
 epoch 2/30. Took 0.22737 seconds. 
  Full-batch training loss = 2.059492, test loss = 2.057885
  Training set accuracy = 0.528400, Test set accuracy = 0.517300
 epoch 3/30. Took 0.22811 seconds. 
  Full-batch training loss = 1.783343, test loss = 1.778150
  Training set accuracy = 0.594600, Test set accuracy = 0.586100
 epoch 4/30. Took 0.22146 seconds. 
  Full-batch training loss = 1.412680, test loss = 1.399483
  Training set accuracy = 0.730000, Test set accuracy = 0.741100
 epoch 5/30. Took 0.22723 seconds. 
  Full-batch training loss = 1.081710, test loss = 1.069622
  Training set accuracy = 0.767600, Test set accuracy = 0.773600
 epoch 6/30. Took 0.22811 seconds. 
  Full-batch training loss = 0.867191, test loss = 0.853526
  Training set accuracy = 0.803200, Test set accuracy = 0.812200
 epoch 7/30. Took 0.22834 seconds. 
  Full-batch training loss = 0.735947, test loss = 0.724245
  Training set accuracy = 0.830400, Test set accuracy = 0.835200
 epoch 8/30. Took 0.22063 seconds. 
  Full-batch training loss = 0.646242, test loss = 0.635199
  Training set accuracy = 0.837800, Test set accuracy = 0.843600
 epoch 9/30. Took 0.22285 seconds. 
  Full-batch training loss = 0.586624, test loss = 0.580045
  Training set accuracy = 0.852200, Test set accuracy = 0.855900
 epoch 10/30. Took 0.22406 seconds. 
  Full-batch training loss = 0.540056, test loss = 0.535178
  Training set accuracy = 0.862200, Test set accuracy = 0.863600
 epoch 11/30. Took 0.23039 seconds. 
  Full-batch training loss = 0.502946, test loss = 0.503307
  Training set accuracy = 0.868000, Test set accuracy = 0.869400
 epoch 12/30. Took 0.25506 seconds. 
  Full-batch training loss = 0.471236, test loss = 0.473543
  Training set accuracy = 0.876200, Test set accuracy = 0.875600
 epoch 13/30. Took 0.22728 seconds. 
  Full-batch training loss = 0.447615, test loss = 0.452754
  Training set accuracy = 0.881200, Test set accuracy = 0.879900
 epoch 14/30. Took 0.22775 seconds. 
  Full-batch training loss = 0.427057, test loss = 0.434759
  Training set accuracy = 0.885800, Test set accuracy = 0.883300
 epoch 15/30. Took 0.24923 seconds. 
  Full-batch training loss = 0.403535, test loss = 0.414216
  Training set accuracy = 0.889800, Test set accuracy = 0.887200
 epoch 16/30. Took 0.22583 seconds. 
  Full-batch training loss = 0.389850, test loss = 0.403560
  Training set accuracy = 0.891600, Test set accuracy = 0.887900
 epoch 17/30. Took 0.22075 seconds. 
  Full-batch training loss = 0.376322, test loss = 0.393087
  Training set accuracy = 0.898600, Test set accuracy = 0.891600
 epoch 18/30. Took 0.25232 seconds. 
  Full-batch training loss = 0.363446, test loss = 0.380542
  Training set accuracy = 0.900000, Test set accuracy = 0.894500
 epoch 19/30. Took 0.22557 seconds. 
  Full-batch training loss = 0.349596, test loss = 0.369800
  Training set accuracy = 0.904600, Test set accuracy = 0.897500
 epoch 20/30. Took 0.22754 seconds. 
  Full-batch training loss = 0.341705, test loss = 0.363606
  Training set accuracy = 0.905400, Test set accuracy = 0.898600
 epoch 21/30. Took 0.22339 seconds. 
  Full-batch training loss = 0.330205, test loss = 0.355837
  Training set accuracy = 0.910600, Test set accuracy = 0.901500
 epoch 22/30. Took 0.23106 seconds. 
  Full-batch training loss = 0.323294, test loss = 0.351187
  Training set accuracy = 0.911200, Test set accuracy = 0.901700
 epoch 23/30. Took 0.22869 seconds. 
  Full-batch training loss = 0.312154, test loss = 0.342536
  Training set accuracy = 0.913800, Test set accuracy = 0.904300
 epoch 24/30. Took 0.22802 seconds. 
  Full-batch training loss = 0.304938, test loss = 0.336302
  Training set accuracy = 0.915000, Test set accuracy = 0.904400
 epoch 25/30. Took 0.22832 seconds. 
  Full-batch training loss = 0.298874, test loss = 0.332937
  Training set accuracy = 0.916400, Test set accuracy = 0.904400
 epoch 26/30. Took 0.22735 seconds. 
  Full-batch training loss = 0.290681, test loss = 0.325940
  Training set accuracy = 0.919800, Test set accuracy = 0.905300
 epoch 27/30. Took 0.22744 seconds. 
  Full-batch training loss = 0.284367, test loss = 0.321471
  Training set accuracy = 0.920000, Test set accuracy = 0.907800
 epoch 28/30. Took 0.22977 seconds. 
  Full-batch training loss = 0.278612, test loss = 0.317289
  Training set accuracy = 0.921800, Test set accuracy = 0.908500
 epoch 29/30. Took 0.22742 seconds. 
  Full-batch training loss = 0.272080, test loss = 0.314204
  Training set accuracy = 0.920800, Test set accuracy = 0.909000
 epoch 30/30. Took 0.23152 seconds. 
  Full-batch training loss = 0.267780, test loss = 0.312170
  Training set accuracy = 0.923200, Test set accuracy = 0.907100
Elapsed time is 15.299098 seconds.
End Training
-----
Params 5000 0.010 0.40 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.60737 seconds. 
  Full-batch training loss = 2.181452, test loss = 2.182774
  Training set accuracy = 0.529600, Test set accuracy = 0.511400
 epoch 2/30. Took 0.59467 seconds. 
  Full-batch training loss = 1.972011, test loss = 1.971871
  Training set accuracy = 0.667000, Test set accuracy = 0.661800
 epoch 3/30. Took 0.59723 seconds. 
  Full-batch training loss = 1.594263, test loss = 1.591447
  Training set accuracy = 0.726200, Test set accuracy = 0.727000
 epoch 4/30. Took 0.62063 seconds. 
  Full-batch training loss = 1.158997, test loss = 1.154864
  Training set accuracy = 0.769200, Test set accuracy = 0.768400
 epoch 5/30. Took 0.61074 seconds. 
  Full-batch training loss = 0.879307, test loss = 0.876198
  Training set accuracy = 0.803200, Test set accuracy = 0.801800
 epoch 6/30. Took 0.674 seconds. 
  Full-batch training loss = 0.722113, test loss = 0.722850
  Training set accuracy = 0.825000, Test set accuracy = 0.814800
 epoch 7/30. Took 0.5963 seconds. 
  Full-batch training loss = 0.625056, test loss = 0.628613
  Training set accuracy = 0.843600, Test set accuracy = 0.839600
 epoch 8/30. Took 0.60638 seconds. 
  Full-batch training loss = 0.557029, test loss = 0.561618
  Training set accuracy = 0.856800, Test set accuracy = 0.853400
 epoch 9/30. Took 0.59989 seconds. 
  Full-batch training loss = 0.512885, test loss = 0.520103
  Training set accuracy = 0.868000, Test set accuracy = 0.862000
 epoch 10/30. Took 0.59289 seconds. 
  Full-batch training loss = 0.473002, test loss = 0.481792
  Training set accuracy = 0.875200, Test set accuracy = 0.873600
 epoch 11/30. Took 0.59398 seconds. 
  Full-batch training loss = 0.445276, test loss = 0.453934
  Training set accuracy = 0.878800, Test set accuracy = 0.876400
 epoch 12/30. Took 0.59537 seconds. 
  Full-batch training loss = 0.422556, test loss = 0.434400
  Training set accuracy = 0.886000, Test set accuracy = 0.885000
 epoch 13/30. Took 0.59477 seconds. 
  Full-batch training loss = 0.402455, test loss = 0.416024
  Training set accuracy = 0.889800, Test set accuracy = 0.885100
 epoch 14/30. Took 0.59615 seconds. 
  Full-batch training loss = 0.385873, test loss = 0.401165
  Training set accuracy = 0.893400, Test set accuracy = 0.888300
 epoch 15/30. Took 0.63772 seconds. 
  Full-batch training loss = 0.370877, test loss = 0.388490
  Training set accuracy = 0.897800, Test set accuracy = 0.892300
 epoch 16/30. Took 0.59355 seconds. 
  Full-batch training loss = 0.357419, test loss = 0.377576
  Training set accuracy = 0.901200, Test set accuracy = 0.894800
 epoch 17/30. Took 0.59598 seconds. 
  Full-batch training loss = 0.346524, test loss = 0.366227
  Training set accuracy = 0.901400, Test set accuracy = 0.896300
 epoch 18/30. Took 0.59504 seconds. 
  Full-batch training loss = 0.336953, test loss = 0.360167
  Training set accuracy = 0.903800, Test set accuracy = 0.898000
 epoch 19/30. Took 0.59649 seconds. 
  Full-batch training loss = 0.327282, test loss = 0.351513
  Training set accuracy = 0.906600, Test set accuracy = 0.899900
 epoch 20/30. Took 0.59453 seconds. 
  Full-batch training loss = 0.317888, test loss = 0.345857
  Training set accuracy = 0.909000, Test set accuracy = 0.901400
 epoch 21/30. Took 0.61404 seconds. 
  Full-batch training loss = 0.309479, test loss = 0.338363
  Training set accuracy = 0.911800, Test set accuracy = 0.902000
 epoch 22/30. Took 0.60127 seconds. 
  Full-batch training loss = 0.303276, test loss = 0.333424
  Training set accuracy = 0.913000, Test set accuracy = 0.903600
 epoch 23/30. Took 0.59072 seconds. 
  Full-batch training loss = 0.293969, test loss = 0.326133
  Training set accuracy = 0.916200, Test set accuracy = 0.906200
 epoch 24/30. Took 0.62154 seconds. 
  Full-batch training loss = 0.288224, test loss = 0.322635
  Training set accuracy = 0.917800, Test set accuracy = 0.908100
 epoch 25/30. Took 0.59789 seconds. 
  Full-batch training loss = 0.282601, test loss = 0.319200
  Training set accuracy = 0.917400, Test set accuracy = 0.911500
 epoch 26/30. Took 0.59081 seconds. 
  Full-batch training loss = 0.275294, test loss = 0.314342
  Training set accuracy = 0.920400, Test set accuracy = 0.910500
 epoch 27/30. Took 0.59115 seconds. 
  Full-batch training loss = 0.270556, test loss = 0.310651
  Training set accuracy = 0.922800, Test set accuracy = 0.910300
 epoch 28/30. Took 0.59638 seconds. 
  Full-batch training loss = 0.262852, test loss = 0.303548
  Training set accuracy = 0.923600, Test set accuracy = 0.911300
 epoch 29/30. Took 0.59497 seconds. 
  Full-batch training loss = 0.258469, test loss = 0.301011
  Training set accuracy = 0.925200, Test set accuracy = 0.912900
 epoch 30/30. Took 0.59417 seconds. 
  Full-batch training loss = 0.253109, test loss = 0.296662
  Training set accuracy = 0.929000, Test set accuracy = 0.913700
Elapsed time is 38.238972 seconds.
End Training
-----
Params 5000 0.010 0.40 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17689 seconds. 
  Full-batch training loss = 2.296731, test loss = 2.297637
  Training set accuracy = 0.091400, Test set accuracy = 0.088900
 epoch 2/30. Took 0.16323 seconds. 
  Full-batch training loss = 2.283392, test loss = 2.284005
  Training set accuracy = 0.223000, Test set accuracy = 0.230000
 epoch 3/30. Took 0.16403 seconds. 
  Full-batch training loss = 2.266303, test loss = 2.266823
  Training set accuracy = 0.308800, Test set accuracy = 0.315700
 epoch 4/30. Took 0.16047 seconds. 
  Full-batch training loss = 2.240615, test loss = 2.240623
  Training set accuracy = 0.340600, Test set accuracy = 0.338100
 epoch 5/30. Took 0.17005 seconds. 
  Full-batch training loss = 2.199514, test loss = 2.198840
  Training set accuracy = 0.382200, Test set accuracy = 0.372600
 epoch 6/30. Took 0.15239 seconds. 
  Full-batch training loss = 2.129825, test loss = 2.127954
  Training set accuracy = 0.462000, Test set accuracy = 0.454300
 epoch 7/30. Took 0.15873 seconds. 
  Full-batch training loss = 2.017318, test loss = 2.013994
  Training set accuracy = 0.499400, Test set accuracy = 0.487500
 epoch 8/30. Took 0.16232 seconds. 
  Full-batch training loss = 1.852566, test loss = 1.848778
  Training set accuracy = 0.525800, Test set accuracy = 0.520300
 epoch 9/30. Took 0.15895 seconds. 
  Full-batch training loss = 1.644160, test loss = 1.639225
  Training set accuracy = 0.565400, Test set accuracy = 0.556300
 epoch 10/30. Took 0.15277 seconds. 
  Full-batch training loss = 1.427637, test loss = 1.422291
  Training set accuracy = 0.627800, Test set accuracy = 0.622500
 epoch 11/30. Took 0.1523 seconds. 
  Full-batch training loss = 1.248081, test loss = 1.241044
  Training set accuracy = 0.653600, Test set accuracy = 0.659400
 epoch 12/30. Took 0.15226 seconds. 
  Full-batch training loss = 1.095747, test loss = 1.089597
  Training set accuracy = 0.714800, Test set accuracy = 0.717400
 epoch 13/30. Took 0.16332 seconds. 
  Full-batch training loss = 0.979995, test loss = 0.973193
  Training set accuracy = 0.744800, Test set accuracy = 0.737100
 epoch 14/30. Took 0.16307 seconds. 
  Full-batch training loss = 0.885425, test loss = 0.879491
  Training set accuracy = 0.760000, Test set accuracy = 0.754200
 epoch 15/30. Took 0.16259 seconds. 
  Full-batch training loss = 0.810997, test loss = 0.805749
  Training set accuracy = 0.769800, Test set accuracy = 0.767600
 epoch 16/30. Took 0.15499 seconds. 
  Full-batch training loss = 0.745647, test loss = 0.742686
  Training set accuracy = 0.781000, Test set accuracy = 0.776600
 epoch 17/30. Took 0.16381 seconds. 
  Full-batch training loss = 0.696794, test loss = 0.694941
  Training set accuracy = 0.809800, Test set accuracy = 0.807500
 epoch 18/30. Took 0.15659 seconds. 
  Full-batch training loss = 0.654092, test loss = 0.654926
  Training set accuracy = 0.821600, Test set accuracy = 0.817400
 epoch 19/30. Took 0.16129 seconds. 
  Full-batch training loss = 0.613691, test loss = 0.615127
  Training set accuracy = 0.829800, Test set accuracy = 0.829800
 epoch 20/30. Took 0.16223 seconds. 
  Full-batch training loss = 0.583796, test loss = 0.588097
  Training set accuracy = 0.836000, Test set accuracy = 0.831800
 epoch 21/30. Took 0.16299 seconds. 
  Full-batch training loss = 0.557256, test loss = 0.563509
  Training set accuracy = 0.847000, Test set accuracy = 0.844600
 epoch 22/30. Took 0.16314 seconds. 
  Full-batch training loss = 0.527628, test loss = 0.538954
  Training set accuracy = 0.858200, Test set accuracy = 0.853800
 epoch 23/30. Took 0.16401 seconds. 
  Full-batch training loss = 0.505961, test loss = 0.517548
  Training set accuracy = 0.863200, Test set accuracy = 0.858100
 epoch 24/30. Took 0.16342 seconds. 
  Full-batch training loss = 0.490948, test loss = 0.504261
  Training set accuracy = 0.867800, Test set accuracy = 0.861800
 epoch 25/30. Took 0.15956 seconds. 
  Full-batch training loss = 0.471635, test loss = 0.485969
  Training set accuracy = 0.868000, Test set accuracy = 0.863500
 epoch 26/30. Took 0.16308 seconds. 
  Full-batch training loss = 0.454735, test loss = 0.472896
  Training set accuracy = 0.876000, Test set accuracy = 0.869500
 epoch 27/30. Took 0.16342 seconds. 
  Full-batch training loss = 0.443476, test loss = 0.460720
  Training set accuracy = 0.878200, Test set accuracy = 0.874200
 epoch 28/30. Took 0.15865 seconds. 
  Full-batch training loss = 0.425387, test loss = 0.448914
  Training set accuracy = 0.884000, Test set accuracy = 0.877200
 epoch 29/30. Took 0.16334 seconds. 
  Full-batch training loss = 0.413712, test loss = 0.438000
  Training set accuracy = 0.883200, Test set accuracy = 0.876800
 epoch 30/30. Took 0.16381 seconds. 
  Full-batch training loss = 0.402489, test loss = 0.427730
  Training set accuracy = 0.885400, Test set accuracy = 0.878300
Elapsed time is 10.868285 seconds.
End Training
-----
Params 5000 0.010 0.40 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28343 seconds. 
  Full-batch training loss = 2.290837, test loss = 2.290853
  Training set accuracy = 0.102200, Test set accuracy = 0.107700
 epoch 2/30. Took 0.27981 seconds. 
  Full-batch training loss = 2.274350, test loss = 2.274526
  Training set accuracy = 0.206200, Test set accuracy = 0.207600
 epoch 3/30. Took 0.28293 seconds. 
  Full-batch training loss = 2.252989, test loss = 2.252946
  Training set accuracy = 0.367400, Test set accuracy = 0.361000
 epoch 4/30. Took 0.2837 seconds. 
  Full-batch training loss = 2.219853, test loss = 2.219198
  Training set accuracy = 0.438000, Test set accuracy = 0.435600
 epoch 5/30. Took 0.28441 seconds. 
  Full-batch training loss = 2.161525, test loss = 2.159489
  Training set accuracy = 0.480200, Test set accuracy = 0.479700
 epoch 6/30. Took 0.28819 seconds. 
  Full-batch training loss = 2.053094, test loss = 2.048063
  Training set accuracy = 0.497600, Test set accuracy = 0.497100
 epoch 7/30. Took 0.28101 seconds. 
  Full-batch training loss = 1.861906, test loss = 1.851366
  Training set accuracy = 0.535000, Test set accuracy = 0.530400
 epoch 8/30. Took 0.28331 seconds. 
  Full-batch training loss = 1.581179, test loss = 1.564512
  Training set accuracy = 0.578200, Test set accuracy = 0.574300
 epoch 9/30. Took 0.26831 seconds. 
  Full-batch training loss = 1.295305, test loss = 1.275405
  Training set accuracy = 0.655400, Test set accuracy = 0.661300
 epoch 10/30. Took 0.27431 seconds. 
  Full-batch training loss = 1.078646, test loss = 1.059084
  Training set accuracy = 0.698800, Test set accuracy = 0.711400
 epoch 11/30. Took 0.27945 seconds. 
  Full-batch training loss = 0.935333, test loss = 0.916949
  Training set accuracy = 0.753400, Test set accuracy = 0.772600
 epoch 12/30. Took 0.27603 seconds. 
  Full-batch training loss = 0.838794, test loss = 0.825282
  Training set accuracy = 0.769400, Test set accuracy = 0.785600
 epoch 13/30. Took 0.28166 seconds. 
  Full-batch training loss = 0.763695, test loss = 0.751207
  Training set accuracy = 0.789600, Test set accuracy = 0.803500
 epoch 14/30. Took 0.28212 seconds. 
  Full-batch training loss = 0.705045, test loss = 0.695188
  Training set accuracy = 0.795800, Test set accuracy = 0.809400
 epoch 15/30. Took 0.28243 seconds. 
  Full-batch training loss = 0.645061, test loss = 0.640791
  Training set accuracy = 0.828600, Test set accuracy = 0.831000
 epoch 16/30. Took 0.28767 seconds. 
  Full-batch training loss = 0.599811, test loss = 0.594805
  Training set accuracy = 0.838600, Test set accuracy = 0.840700
 epoch 17/30. Took 0.27909 seconds. 
  Full-batch training loss = 0.554504, test loss = 0.553140
  Training set accuracy = 0.850000, Test set accuracy = 0.852200
 epoch 18/30. Took 0.2751 seconds. 
  Full-batch training loss = 0.526245, test loss = 0.525271
  Training set accuracy = 0.860200, Test set accuracy = 0.860300
 epoch 19/30. Took 0.27333 seconds. 
  Full-batch training loss = 0.501152, test loss = 0.503344
  Training set accuracy = 0.864400, Test set accuracy = 0.863600
 epoch 20/30. Took 0.27725 seconds. 
  Full-batch training loss = 0.471365, test loss = 0.474614
  Training set accuracy = 0.867800, Test set accuracy = 0.871200
 epoch 21/30. Took 0.28626 seconds. 
  Full-batch training loss = 0.450371, test loss = 0.457573
  Training set accuracy = 0.873600, Test set accuracy = 0.873600
 epoch 22/30. Took 0.28218 seconds. 
  Full-batch training loss = 0.431970, test loss = 0.441461
  Training set accuracy = 0.878600, Test set accuracy = 0.876300
 epoch 23/30. Took 0.28322 seconds. 
  Full-batch training loss = 0.417875, test loss = 0.426436
  Training set accuracy = 0.884000, Test set accuracy = 0.880800
 epoch 24/30. Took 0.2897 seconds. 
  Full-batch training loss = 0.399541, test loss = 0.414759
  Training set accuracy = 0.889000, Test set accuracy = 0.881400
 epoch 25/30. Took 0.27615 seconds. 
  Full-batch training loss = 0.392752, test loss = 0.412055
  Training set accuracy = 0.889200, Test set accuracy = 0.879800
 epoch 26/30. Took 0.28454 seconds. 
  Full-batch training loss = 0.372633, test loss = 0.393433
  Training set accuracy = 0.893600, Test set accuracy = 0.887200
 epoch 27/30. Took 0.28198 seconds. 
  Full-batch training loss = 0.357884, test loss = 0.379007
  Training set accuracy = 0.897600, Test set accuracy = 0.892900
 epoch 28/30. Took 0.26832 seconds. 
  Full-batch training loss = 0.351862, test loss = 0.374933
  Training set accuracy = 0.896600, Test set accuracy = 0.891600
 epoch 29/30. Took 0.30978 seconds. 
  Full-batch training loss = 0.336236, test loss = 0.366317
  Training set accuracy = 0.901800, Test set accuracy = 0.896300
 epoch 30/30. Took 0.27911 seconds. 
  Full-batch training loss = 0.329113, test loss = 0.354091
  Training set accuracy = 0.904200, Test set accuracy = 0.895700
Elapsed time is 18.523067 seconds.
End Training
-----
Params 5000 0.010 0.40 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.9248 seconds. 
  Full-batch training loss = 2.284562, test loss = 2.285407
  Training set accuracy = 0.261400, Test set accuracy = 0.258700
 epoch 2/30. Took 0.95625 seconds. 
  Full-batch training loss = 2.260377, test loss = 2.261268
  Training set accuracy = 0.463400, Test set accuracy = 0.450600
 epoch 3/30. Took 0.84793 seconds. 
  Full-batch training loss = 2.224010, test loss = 2.224678
  Training set accuracy = 0.537800, Test set accuracy = 0.524600
 epoch 4/30. Took 0.90261 seconds. 
  Full-batch training loss = 2.161098, test loss = 2.160857
  Training set accuracy = 0.567000, Test set accuracy = 0.551600
 epoch 5/30. Took 0.82379 seconds. 
  Full-batch training loss = 2.038161, test loss = 2.036209
  Training set accuracy = 0.592800, Test set accuracy = 0.583700
 epoch 6/30. Took 0.81995 seconds. 
  Full-batch training loss = 1.797893, test loss = 1.792934
  Training set accuracy = 0.639000, Test set accuracy = 0.629600
 epoch 7/30. Took 0.83776 seconds. 
  Full-batch training loss = 1.420094, test loss = 1.414389
  Training set accuracy = 0.693400, Test set accuracy = 0.689100
 epoch 8/30. Took 0.84855 seconds. 
  Full-batch training loss = 1.071872, test loss = 1.069446
  Training set accuracy = 0.726800, Test set accuracy = 0.725300
 epoch 9/30. Took 0.82425 seconds. 
  Full-batch training loss = 0.852410, test loss = 0.851727
  Training set accuracy = 0.779000, Test set accuracy = 0.782600
 epoch 10/30. Took 0.81973 seconds. 
  Full-batch training loss = 0.728802, test loss = 0.736132
  Training set accuracy = 0.786800, Test set accuracy = 0.787800
 epoch 11/30. Took 0.83738 seconds. 
  Full-batch training loss = 0.642806, test loss = 0.648818
  Training set accuracy = 0.818800, Test set accuracy = 0.818500
 epoch 12/30. Took 0.82095 seconds. 
  Full-batch training loss = 0.584772, test loss = 0.594440
  Training set accuracy = 0.827600, Test set accuracy = 0.828500
 epoch 13/30. Took 0.82571 seconds. 
  Full-batch training loss = 0.535895, test loss = 0.549201
  Training set accuracy = 0.844600, Test set accuracy = 0.841600
 epoch 14/30. Took 0.97312 seconds. 
  Full-batch training loss = 0.500090, test loss = 0.516168
  Training set accuracy = 0.849800, Test set accuracy = 0.848200
 epoch 15/30. Took 0.82291 seconds. 
  Full-batch training loss = 0.468480, test loss = 0.489522
  Training set accuracy = 0.861000, Test set accuracy = 0.857800
 epoch 16/30. Took 0.8206 seconds. 
  Full-batch training loss = 0.447843, test loss = 0.470690
  Training set accuracy = 0.866200, Test set accuracy = 0.862200
 epoch 17/30. Took 0.82139 seconds. 
  Full-batch training loss = 0.422720, test loss = 0.446573
  Training set accuracy = 0.878000, Test set accuracy = 0.867700
 epoch 18/30. Took 0.83056 seconds. 
  Full-batch training loss = 0.404417, test loss = 0.433429
  Training set accuracy = 0.885400, Test set accuracy = 0.873500
 epoch 19/30. Took 0.82306 seconds. 
  Full-batch training loss = 0.382883, test loss = 0.413683
  Training set accuracy = 0.889200, Test set accuracy = 0.879700
 epoch 20/30. Took 0.87057 seconds. 
  Full-batch training loss = 0.367390, test loss = 0.397711
  Training set accuracy = 0.893000, Test set accuracy = 0.882400
 epoch 21/30. Took 0.84872 seconds. 
  Full-batch training loss = 0.355088, test loss = 0.394341
  Training set accuracy = 0.898800, Test set accuracy = 0.885200
 epoch 22/30. Took 0.83368 seconds. 
  Full-batch training loss = 0.344780, test loss = 0.383816
  Training set accuracy = 0.900600, Test set accuracy = 0.886000
 epoch 23/30. Took 0.83006 seconds. 
  Full-batch training loss = 0.332417, test loss = 0.372862
  Training set accuracy = 0.906200, Test set accuracy = 0.889800
 epoch 24/30. Took 0.82595 seconds. 
  Full-batch training loss = 0.320104, test loss = 0.359427
  Training set accuracy = 0.909800, Test set accuracy = 0.892500
 epoch 25/30. Took 0.82642 seconds. 
  Full-batch training loss = 0.310438, test loss = 0.355199
  Training set accuracy = 0.913200, Test set accuracy = 0.895300
 epoch 26/30. Took 0.82546 seconds. 
  Full-batch training loss = 0.305049, test loss = 0.354102
  Training set accuracy = 0.913200, Test set accuracy = 0.894900
 epoch 27/30. Took 0.82637 seconds. 
  Full-batch training loss = 0.290018, test loss = 0.339530
  Training set accuracy = 0.916800, Test set accuracy = 0.899500
 epoch 28/30. Took 0.82378 seconds. 
  Full-batch training loss = 0.284656, test loss = 0.334611
  Training set accuracy = 0.916800, Test set accuracy = 0.901300
 epoch 29/30. Took 0.82339 seconds. 
  Full-batch training loss = 0.274472, test loss = 0.327098
  Training set accuracy = 0.918000, Test set accuracy = 0.903100
 epoch 30/30. Took 0.84747 seconds. 
  Full-batch training loss = 0.266823, test loss = 0.322310
  Training set accuracy = 0.923600, Test set accuracy = 0.904000
Elapsed time is 52.831047 seconds.
End Training
-----
Params 5000 0.010 0.50 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11307 seconds. 
  Full-batch training loss = 2.015615, test loss = 2.005706
  Training set accuracy = 0.595200, Test set accuracy = 0.610400
 epoch 2/30. Took 0.10371 seconds. 
  Full-batch training loss = 1.637278, test loss = 1.618028
  Training set accuracy = 0.742800, Test set accuracy = 0.760400
 epoch 3/30. Took 0.11538 seconds. 
  Full-batch training loss = 1.284592, test loss = 1.258106
  Training set accuracy = 0.784200, Test set accuracy = 0.803300
 epoch 4/30. Took 0.11785 seconds. 
  Full-batch training loss = 1.046017, test loss = 1.017389
  Training set accuracy = 0.803800, Test set accuracy = 0.817400
 epoch 5/30. Took 0.1117 seconds. 
  Full-batch training loss = 0.891109, test loss = 0.862779
  Training set accuracy = 0.828000, Test set accuracy = 0.840100
 epoch 6/30. Took 0.10641 seconds. 
  Full-batch training loss = 0.785137, test loss = 0.755036
  Training set accuracy = 0.834600, Test set accuracy = 0.843800
 epoch 7/30. Took 0.10251 seconds. 
  Full-batch training loss = 0.710487, test loss = 0.683278
  Training set accuracy = 0.844000, Test set accuracy = 0.856500
 epoch 8/30. Took 0.10723 seconds. 
  Full-batch training loss = 0.654214, test loss = 0.627477
  Training set accuracy = 0.856800, Test set accuracy = 0.864100
 epoch 9/30. Took 0.10754 seconds. 
  Full-batch training loss = 0.610308, test loss = 0.585323
  Training set accuracy = 0.861600, Test set accuracy = 0.870600
 epoch 10/30. Took 0.10308 seconds. 
  Full-batch training loss = 0.575310, test loss = 0.551381
  Training set accuracy = 0.862800, Test set accuracy = 0.873000
 epoch 11/30. Took 0.10441 seconds. 
  Full-batch training loss = 0.547012, test loss = 0.524167
  Training set accuracy = 0.870800, Test set accuracy = 0.877800
 epoch 12/30. Took 0.10648 seconds. 
  Full-batch training loss = 0.521831, test loss = 0.499893
  Training set accuracy = 0.873000, Test set accuracy = 0.881100
 epoch 13/30. Took 0.12024 seconds. 
  Full-batch training loss = 0.498581, test loss = 0.480023
  Training set accuracy = 0.876200, Test set accuracy = 0.886300
 epoch 14/30. Took 0.10537 seconds. 
  Full-batch training loss = 0.479812, test loss = 0.462343
  Training set accuracy = 0.880400, Test set accuracy = 0.887700
 epoch 15/30. Took 0.10325 seconds. 
  Full-batch training loss = 0.462932, test loss = 0.447582
  Training set accuracy = 0.882600, Test set accuracy = 0.889400
 epoch 16/30. Took 0.10507 seconds. 
  Full-batch training loss = 0.449411, test loss = 0.435799
  Training set accuracy = 0.884200, Test set accuracy = 0.890800
 epoch 17/30. Took 0.10703 seconds. 
  Full-batch training loss = 0.433999, test loss = 0.421670
  Training set accuracy = 0.888600, Test set accuracy = 0.892200
 epoch 18/30. Took 0.10681 seconds. 
  Full-batch training loss = 0.422908, test loss = 0.412381
  Training set accuracy = 0.891400, Test set accuracy = 0.895500
 epoch 19/30. Took 0.10419 seconds. 
  Full-batch training loss = 0.411514, test loss = 0.402119
  Training set accuracy = 0.892400, Test set accuracy = 0.896900
 epoch 20/30. Took 0.10372 seconds. 
  Full-batch training loss = 0.402547, test loss = 0.395584
  Training set accuracy = 0.894400, Test set accuracy = 0.898100
 epoch 21/30. Took 0.10378 seconds. 
  Full-batch training loss = 0.394493, test loss = 0.389962
  Training set accuracy = 0.898400, Test set accuracy = 0.898700
 epoch 22/30. Took 0.10635 seconds. 
  Full-batch training loss = 0.385563, test loss = 0.380907
  Training set accuracy = 0.897400, Test set accuracy = 0.900000
 epoch 23/30. Took 0.10809 seconds. 
  Full-batch training loss = 0.375137, test loss = 0.372794
  Training set accuracy = 0.900000, Test set accuracy = 0.902900
 epoch 24/30. Took 0.10397 seconds. 
  Full-batch training loss = 0.367112, test loss = 0.367202
  Training set accuracy = 0.902200, Test set accuracy = 0.902200
 epoch 25/30. Took 0.10239 seconds. 
  Full-batch training loss = 0.360389, test loss = 0.362292
  Training set accuracy = 0.903000, Test set accuracy = 0.904200
 epoch 26/30. Took 0.10786 seconds. 
  Full-batch training loss = 0.353144, test loss = 0.356937
  Training set accuracy = 0.904800, Test set accuracy = 0.905000
 epoch 27/30. Took 0.10737 seconds. 
  Full-batch training loss = 0.349659, test loss = 0.354889
  Training set accuracy = 0.906000, Test set accuracy = 0.904900
 epoch 28/30. Took 0.10775 seconds. 
  Full-batch training loss = 0.340447, test loss = 0.347080
  Training set accuracy = 0.908400, Test set accuracy = 0.905900
 epoch 29/30. Took 0.10809 seconds. 
  Full-batch training loss = 0.333754, test loss = 0.341305
  Training set accuracy = 0.910000, Test set accuracy = 0.907400
 epoch 30/30. Took 0.10801 seconds. 
  Full-batch training loss = 0.328265, test loss = 0.338029
  Training set accuracy = 0.910600, Test set accuracy = 0.909600
Elapsed time is 8.016814 seconds.
End Training
-----
Params 5000 0.010 0.50 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17598 seconds. 
  Full-batch training loss = 1.978751, test loss = 1.977998
  Training set accuracy = 0.676800, Test set accuracy = 0.683800
 epoch 2/30. Took 0.16698 seconds. 
  Full-batch training loss = 1.552489, test loss = 1.550020
  Training set accuracy = 0.734200, Test set accuracy = 0.729000
 epoch 3/30. Took 0.16903 seconds. 
  Full-batch training loss = 1.182924, test loss = 1.178188
  Training set accuracy = 0.795800, Test set accuracy = 0.797200
 epoch 4/30. Took 0.17181 seconds. 
  Full-batch training loss = 0.943177, test loss = 0.939370
  Training set accuracy = 0.815600, Test set accuracy = 0.815500
 epoch 5/30. Took 0.16848 seconds. 
  Full-batch training loss = 0.790309, test loss = 0.790891
  Training set accuracy = 0.840200, Test set accuracy = 0.839300
 epoch 6/30. Took 0.17812 seconds. 
  Full-batch training loss = 0.691782, test loss = 0.694674
  Training set accuracy = 0.852400, Test set accuracy = 0.848900
 epoch 7/30. Took 0.17967 seconds. 
  Full-batch training loss = 0.622206, test loss = 0.626927
  Training set accuracy = 0.861400, Test set accuracy = 0.858900
 epoch 8/30. Took 0.16997 seconds. 
  Full-batch training loss = 0.573633, test loss = 0.582997
  Training set accuracy = 0.870600, Test set accuracy = 0.863700
 epoch 9/30. Took 0.17048 seconds. 
  Full-batch training loss = 0.533919, test loss = 0.544824
  Training set accuracy = 0.872800, Test set accuracy = 0.870800
 epoch 10/30. Took 0.16937 seconds. 
  Full-batch training loss = 0.500889, test loss = 0.513527
  Training set accuracy = 0.880600, Test set accuracy = 0.875900
 epoch 11/30. Took 0.17154 seconds. 
  Full-batch training loss = 0.475357, test loss = 0.488989
  Training set accuracy = 0.884600, Test set accuracy = 0.882100
 epoch 12/30. Took 0.17037 seconds. 
  Full-batch training loss = 0.453807, test loss = 0.469714
  Training set accuracy = 0.887000, Test set accuracy = 0.882700
 epoch 13/30. Took 0.18818 seconds. 
  Full-batch training loss = 0.436445, test loss = 0.453711
  Training set accuracy = 0.890400, Test set accuracy = 0.883400
 epoch 14/30. Took 0.16729 seconds. 
  Full-batch training loss = 0.420917, test loss = 0.438426
  Training set accuracy = 0.894400, Test set accuracy = 0.887300
 epoch 15/30. Took 0.1664 seconds. 
  Full-batch training loss = 0.408292, test loss = 0.428273
  Training set accuracy = 0.893400, Test set accuracy = 0.888600
 epoch 16/30. Took 0.1779 seconds. 
  Full-batch training loss = 0.396430, test loss = 0.417720
  Training set accuracy = 0.896600, Test set accuracy = 0.890000
 epoch 17/30. Took 0.16863 seconds. 
  Full-batch training loss = 0.383980, test loss = 0.407262
  Training set accuracy = 0.901800, Test set accuracy = 0.893200
 epoch 18/30. Took 0.17063 seconds. 
  Full-batch training loss = 0.373777, test loss = 0.397914
  Training set accuracy = 0.903200, Test set accuracy = 0.894400
 epoch 19/30. Took 0.17056 seconds. 
  Full-batch training loss = 0.364081, test loss = 0.389320
  Training set accuracy = 0.904400, Test set accuracy = 0.896200
 epoch 20/30. Took 0.16688 seconds. 
  Full-batch training loss = 0.356302, test loss = 0.382658
  Training set accuracy = 0.907400, Test set accuracy = 0.898200
 epoch 21/30. Took 0.16957 seconds. 
  Full-batch training loss = 0.348099, test loss = 0.376963
  Training set accuracy = 0.908000, Test set accuracy = 0.899000
 epoch 22/30. Took 0.16948 seconds. 
  Full-batch training loss = 0.341007, test loss = 0.370854
  Training set accuracy = 0.910200, Test set accuracy = 0.899700
 epoch 23/30. Took 0.171 seconds. 
  Full-batch training loss = 0.334940, test loss = 0.364555
  Training set accuracy = 0.910800, Test set accuracy = 0.902700
 epoch 24/30. Took 0.16698 seconds. 
  Full-batch training loss = 0.328439, test loss = 0.360755
  Training set accuracy = 0.913400, Test set accuracy = 0.901800
 epoch 25/30. Took 0.16994 seconds. 
  Full-batch training loss = 0.322731, test loss = 0.355626
  Training set accuracy = 0.914800, Test set accuracy = 0.904800
 epoch 26/30. Took 0.17039 seconds. 
  Full-batch training loss = 0.316936, test loss = 0.351197
  Training set accuracy = 0.915400, Test set accuracy = 0.904200
 epoch 27/30. Took 0.18291 seconds. 
  Full-batch training loss = 0.312172, test loss = 0.348351
  Training set accuracy = 0.916600, Test set accuracy = 0.905000
 epoch 28/30. Took 0.16881 seconds. 
  Full-batch training loss = 0.307172, test loss = 0.344293
  Training set accuracy = 0.919600, Test set accuracy = 0.905500
 epoch 29/30. Took 0.16937 seconds. 
  Full-batch training loss = 0.302230, test loss = 0.340007
  Training set accuracy = 0.918800, Test set accuracy = 0.907600
 epoch 30/30. Took 0.17075 seconds. 
  Full-batch training loss = 0.297736, test loss = 0.336656
  Training set accuracy = 0.920400, Test set accuracy = 0.908900
Elapsed time is 11.744693 seconds.
End Training
-----
Params 5000 0.010 0.50 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.37998 seconds. 
  Full-batch training loss = 1.950762, test loss = 1.942135
  Training set accuracy = 0.703400, Test set accuracy = 0.708900
 epoch 2/30. Took 0.3513 seconds. 
  Full-batch training loss = 1.505524, test loss = 1.485727
  Training set accuracy = 0.755400, Test set accuracy = 0.770600
 epoch 3/30. Took 0.35641 seconds. 
  Full-batch training loss = 1.129824, test loss = 1.103784
  Training set accuracy = 0.792800, Test set accuracy = 0.808700
 epoch 4/30. Took 0.35489 seconds. 
  Full-batch training loss = 0.897918, test loss = 0.870650
  Training set accuracy = 0.812000, Test set accuracy = 0.827300
 epoch 5/30. Took 0.3528 seconds. 
  Full-batch training loss = 0.759616, test loss = 0.732649
  Training set accuracy = 0.839200, Test set accuracy = 0.847200
 epoch 6/30. Took 0.35569 seconds. 
  Full-batch training loss = 0.669199, test loss = 0.643240
  Training set accuracy = 0.851400, Test set accuracy = 0.860300
 epoch 7/30. Took 0.35429 seconds. 
  Full-batch training loss = 0.607012, test loss = 0.583156
  Training set accuracy = 0.854200, Test set accuracy = 0.865600
 epoch 8/30. Took 0.35311 seconds. 
  Full-batch training loss = 0.562407, test loss = 0.538847
  Training set accuracy = 0.866200, Test set accuracy = 0.873700
 epoch 9/30. Took 0.356 seconds. 
  Full-batch training loss = 0.525821, test loss = 0.504790
  Training set accuracy = 0.868800, Test set accuracy = 0.874000
 epoch 10/30. Took 0.35228 seconds. 
  Full-batch training loss = 0.498454, test loss = 0.479185
  Training set accuracy = 0.874000, Test set accuracy = 0.877500
 epoch 11/30. Took 0.35196 seconds. 
  Full-batch training loss = 0.476901, test loss = 0.458634
  Training set accuracy = 0.875600, Test set accuracy = 0.882200
 epoch 12/30. Took 0.37762 seconds. 
  Full-batch training loss = 0.455418, test loss = 0.439930
  Training set accuracy = 0.879200, Test set accuracy = 0.884400
 epoch 13/30. Took 0.35599 seconds. 
  Full-batch training loss = 0.438934, test loss = 0.425058
  Training set accuracy = 0.883400, Test set accuracy = 0.886900
 epoch 14/30. Took 0.35582 seconds. 
  Full-batch training loss = 0.424849, test loss = 0.413154
  Training set accuracy = 0.888400, Test set accuracy = 0.890900
 epoch 15/30. Took 0.35283 seconds. 
  Full-batch training loss = 0.411803, test loss = 0.401550
  Training set accuracy = 0.891400, Test set accuracy = 0.893800
 epoch 16/30. Took 0.35375 seconds. 
  Full-batch training loss = 0.401075, test loss = 0.393424
  Training set accuracy = 0.894000, Test set accuracy = 0.893500
 epoch 17/30. Took 0.35084 seconds. 
  Full-batch training loss = 0.390079, test loss = 0.383254
  Training set accuracy = 0.898000, Test set accuracy = 0.896600
 epoch 18/30. Took 0.39623 seconds. 
  Full-batch training loss = 0.380470, test loss = 0.376272
  Training set accuracy = 0.898600, Test set accuracy = 0.897900
 epoch 19/30. Took 0.35589 seconds. 
  Full-batch training loss = 0.372731, test loss = 0.370157
  Training set accuracy = 0.900600, Test set accuracy = 0.898700
 epoch 20/30. Took 0.35458 seconds. 
  Full-batch training loss = 0.364013, test loss = 0.363780
  Training set accuracy = 0.902800, Test set accuracy = 0.900100
 epoch 21/30. Took 0.36834 seconds. 
  Full-batch training loss = 0.357624, test loss = 0.358063
  Training set accuracy = 0.904400, Test set accuracy = 0.902400
 epoch 22/30. Took 0.35228 seconds. 
  Full-batch training loss = 0.350056, test loss = 0.352078
  Training set accuracy = 0.903600, Test set accuracy = 0.901400
 epoch 23/30. Took 0.35679 seconds. 
  Full-batch training loss = 0.344021, test loss = 0.347942
  Training set accuracy = 0.905200, Test set accuracy = 0.902700
 epoch 24/30. Took 0.35517 seconds. 
  Full-batch training loss = 0.337097, test loss = 0.342572
  Training set accuracy = 0.907800, Test set accuracy = 0.903300
 epoch 25/30. Took 0.38286 seconds. 
  Full-batch training loss = 0.331681, test loss = 0.338560
  Training set accuracy = 0.909400, Test set accuracy = 0.903700
 epoch 26/30. Took 0.35878 seconds. 
  Full-batch training loss = 0.325788, test loss = 0.334661
  Training set accuracy = 0.909800, Test set accuracy = 0.905300
 epoch 27/30. Took 0.36105 seconds. 
  Full-batch training loss = 0.320717, test loss = 0.330683
  Training set accuracy = 0.912200, Test set accuracy = 0.906300
 epoch 28/30. Took 0.35034 seconds. 
  Full-batch training loss = 0.316269, test loss = 0.327969
  Training set accuracy = 0.911800, Test set accuracy = 0.906700
 epoch 29/30. Took 0.36842 seconds. 
  Full-batch training loss = 0.311836, test loss = 0.325083
  Training set accuracy = 0.913000, Test set accuracy = 0.909100
 epoch 30/30. Took 0.35385 seconds. 
  Full-batch training loss = 0.306381, test loss = 0.320759
  Training set accuracy = 0.916400, Test set accuracy = 0.908600
Elapsed time is 23.498565 seconds.
End Training
-----
Params 5000 0.010 0.50 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.13809 seconds. 
  Full-batch training loss = 2.278208, test loss = 2.277444
  Training set accuracy = 0.207400, Test set accuracy = 0.209200
 epoch 2/30. Took 0.13534 seconds. 
  Full-batch training loss = 2.238806, test loss = 2.238081
  Training set accuracy = 0.315000, Test set accuracy = 0.307500
 epoch 3/30. Took 0.13571 seconds. 
  Full-batch training loss = 2.171408, test loss = 2.170087
  Training set accuracy = 0.504400, Test set accuracy = 0.502100
 epoch 4/30. Took 0.13559 seconds. 
  Full-batch training loss = 2.062655, test loss = 2.060630
  Training set accuracy = 0.628200, Test set accuracy = 0.636600
 epoch 5/30. Took 0.13526 seconds. 
  Full-batch training loss = 1.899924, test loss = 1.896626
  Training set accuracy = 0.656000, Test set accuracy = 0.654000
 epoch 6/30. Took 0.13312 seconds. 
  Full-batch training loss = 1.693541, test loss = 1.688070
  Training set accuracy = 0.678000, Test set accuracy = 0.673800
 epoch 7/30. Took 0.13528 seconds. 
  Full-batch training loss = 1.478695, test loss = 1.471570
  Training set accuracy = 0.701000, Test set accuracy = 0.702500
 epoch 8/30. Took 0.13055 seconds. 
  Full-batch training loss = 1.299104, test loss = 1.291611
  Training set accuracy = 0.726800, Test set accuracy = 0.731000
 epoch 9/30. Took 0.12867 seconds. 
  Full-batch training loss = 1.138029, test loss = 1.132070
  Training set accuracy = 0.758400, Test set accuracy = 0.752600
 epoch 10/30. Took 0.12903 seconds. 
  Full-batch training loss = 1.013940, test loss = 1.009825
  Training set accuracy = 0.788200, Test set accuracy = 0.786400
 epoch 11/30. Took 0.13367 seconds. 
  Full-batch training loss = 0.917165, test loss = 0.915359
  Training set accuracy = 0.804600, Test set accuracy = 0.802100
 epoch 12/30. Took 0.12888 seconds. 
  Full-batch training loss = 0.832406, test loss = 0.834634
  Training set accuracy = 0.817600, Test set accuracy = 0.809900
 epoch 13/30. Took 0.13933 seconds. 
  Full-batch training loss = 0.769680, test loss = 0.775244
  Training set accuracy = 0.820200, Test set accuracy = 0.816600
 epoch 14/30. Took 0.13242 seconds. 
  Full-batch training loss = 0.721072, test loss = 0.729532
  Training set accuracy = 0.824200, Test set accuracy = 0.815800
 epoch 15/30. Took 0.13594 seconds. 
  Full-batch training loss = 0.672467, test loss = 0.683522
  Training set accuracy = 0.845200, Test set accuracy = 0.830500
 epoch 16/30. Took 0.14306 seconds. 
  Full-batch training loss = 0.633904, test loss = 0.646738
  Training set accuracy = 0.850000, Test set accuracy = 0.841400
 epoch 17/30. Took 0.1289 seconds. 
  Full-batch training loss = 0.595550, test loss = 0.612181
  Training set accuracy = 0.860200, Test set accuracy = 0.845400
 epoch 18/30. Took 0.13506 seconds. 
  Full-batch training loss = 0.573383, test loss = 0.592755
  Training set accuracy = 0.862200, Test set accuracy = 0.850000
 epoch 19/30. Took 0.13288 seconds. 
  Full-batch training loss = 0.550117, test loss = 0.570499
  Training set accuracy = 0.865000, Test set accuracy = 0.853000
 epoch 20/30. Took 0.1358 seconds. 
  Full-batch training loss = 0.526823, test loss = 0.549019
  Training set accuracy = 0.870800, Test set accuracy = 0.858300
 epoch 21/30. Took 0.13569 seconds. 
  Full-batch training loss = 0.504734, test loss = 0.530666
  Training set accuracy = 0.870200, Test set accuracy = 0.860500
 epoch 22/30. Took 0.13618 seconds. 
  Full-batch training loss = 0.483280, test loss = 0.510909
  Training set accuracy = 0.873800, Test set accuracy = 0.864100
 epoch 23/30. Took 0.13548 seconds. 
  Full-batch training loss = 0.470199, test loss = 0.500911
  Training set accuracy = 0.873800, Test set accuracy = 0.863400
 epoch 24/30. Took 0.13625 seconds. 
  Full-batch training loss = 0.459250, test loss = 0.488610
  Training set accuracy = 0.880600, Test set accuracy = 0.869300
 epoch 25/30. Took 0.13573 seconds. 
  Full-batch training loss = 0.446522, test loss = 0.478987
  Training set accuracy = 0.882800, Test set accuracy = 0.868400
 epoch 26/30. Took 0.13918 seconds. 
  Full-batch training loss = 0.428546, test loss = 0.463570
  Training set accuracy = 0.885200, Test set accuracy = 0.874300
 epoch 27/30. Took 0.13338 seconds. 
  Full-batch training loss = 0.418796, test loss = 0.455501
  Training set accuracy = 0.889000, Test set accuracy = 0.875300
 epoch 28/30. Took 0.13066 seconds. 
  Full-batch training loss = 0.410455, test loss = 0.448322
  Training set accuracy = 0.889000, Test set accuracy = 0.877800
 epoch 29/30. Took 0.12902 seconds. 
  Full-batch training loss = 0.402604, test loss = 0.440493
  Training set accuracy = 0.893400, Test set accuracy = 0.881300
 epoch 30/30. Took 0.12871 seconds. 
  Full-batch training loss = 0.391505, test loss = 0.431476
  Training set accuracy = 0.895200, Test set accuracy = 0.882000
Elapsed time is 9.389089 seconds.
End Training
-----
Params 5000 0.010 0.50 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.25786 seconds. 
  Full-batch training loss = 2.263917, test loss = 2.263603
  Training set accuracy = 0.269400, Test set accuracy = 0.269000
 epoch 2/30. Took 0.22579 seconds. 
  Full-batch training loss = 2.209348, test loss = 2.208730
  Training set accuracy = 0.505600, Test set accuracy = 0.501400
 epoch 3/30. Took 0.22723 seconds. 
  Full-batch training loss = 2.122498, test loss = 2.120692
  Training set accuracy = 0.594600, Test set accuracy = 0.591800
 epoch 4/30. Took 0.23424 seconds. 
  Full-batch training loss = 1.981825, test loss = 1.978018
  Training set accuracy = 0.629000, Test set accuracy = 0.629700
 epoch 5/30. Took 0.22672 seconds. 
  Full-batch training loss = 1.762043, test loss = 1.754998
  Training set accuracy = 0.662200, Test set accuracy = 0.663200
 epoch 6/30. Took 0.25178 seconds. 
  Full-batch training loss = 1.491712, test loss = 1.481783
  Training set accuracy = 0.703600, Test set accuracy = 0.708800
 epoch 7/30. Took 0.22573 seconds. 
  Full-batch training loss = 1.239158, test loss = 1.227216
  Training set accuracy = 0.768000, Test set accuracy = 0.774600
 epoch 8/30. Took 0.2276 seconds. 
  Full-batch training loss = 1.040897, test loss = 1.030885
  Training set accuracy = 0.784200, Test set accuracy = 0.791400
 epoch 9/30. Took 0.2388 seconds. 
  Full-batch training loss = 0.898703, test loss = 0.888140
  Training set accuracy = 0.798600, Test set accuracy = 0.803500
 epoch 10/30. Took 0.23531 seconds. 
  Full-batch training loss = 0.797287, test loss = 0.789111
  Training set accuracy = 0.821800, Test set accuracy = 0.823200
 epoch 11/30. Took 0.22783 seconds. 
  Full-batch training loss = 0.720284, test loss = 0.715109
  Training set accuracy = 0.831000, Test set accuracy = 0.829200
 epoch 12/30. Took 0.22784 seconds. 
  Full-batch training loss = 0.663384, test loss = 0.661102
  Training set accuracy = 0.838400, Test set accuracy = 0.837900
 epoch 13/30. Took 0.2515 seconds. 
  Full-batch training loss = 0.619682, test loss = 0.619649
  Training set accuracy = 0.838800, Test set accuracy = 0.837900
 epoch 14/30. Took 0.22198 seconds. 
  Full-batch training loss = 0.581396, test loss = 0.582348
  Training set accuracy = 0.852200, Test set accuracy = 0.850900
 epoch 15/30. Took 0.22379 seconds. 
  Full-batch training loss = 0.551718, test loss = 0.556819
  Training set accuracy = 0.856600, Test set accuracy = 0.854900
 epoch 16/30. Took 0.224 seconds. 
  Full-batch training loss = 0.521976, test loss = 0.528873
  Training set accuracy = 0.861800, Test set accuracy = 0.858000
 epoch 17/30. Took 0.22915 seconds. 
  Full-batch training loss = 0.498878, test loss = 0.505273
  Training set accuracy = 0.869600, Test set accuracy = 0.866200
 epoch 18/30. Took 0.22775 seconds. 
  Full-batch training loss = 0.485041, test loss = 0.495649
  Training set accuracy = 0.868400, Test set accuracy = 0.866100
 epoch 19/30. Took 0.22815 seconds. 
  Full-batch training loss = 0.464621, test loss = 0.474450
  Training set accuracy = 0.878400, Test set accuracy = 0.872500
 epoch 20/30. Took 0.2399 seconds. 
  Full-batch training loss = 0.450899, test loss = 0.464029
  Training set accuracy = 0.880400, Test set accuracy = 0.872200
 epoch 21/30. Took 0.22786 seconds. 
  Full-batch training loss = 0.433137, test loss = 0.447913
  Training set accuracy = 0.884600, Test set accuracy = 0.877800
 epoch 22/30. Took 0.22398 seconds. 
  Full-batch training loss = 0.423866, test loss = 0.439513
  Training set accuracy = 0.888800, Test set accuracy = 0.880000
 epoch 23/30. Took 0.22127 seconds. 
  Full-batch training loss = 0.412508, test loss = 0.428397
  Training set accuracy = 0.891000, Test set accuracy = 0.881300
 epoch 24/30. Took 0.2281 seconds. 
  Full-batch training loss = 0.401300, test loss = 0.420455
  Training set accuracy = 0.891000, Test set accuracy = 0.883900
 epoch 25/30. Took 0.22777 seconds. 
  Full-batch training loss = 0.392212, test loss = 0.412144
  Training set accuracy = 0.895600, Test set accuracy = 0.885600
 epoch 26/30. Took 0.22748 seconds. 
  Full-batch training loss = 0.379605, test loss = 0.401837
  Training set accuracy = 0.898200, Test set accuracy = 0.888000
 epoch 27/30. Took 0.23754 seconds. 
  Full-batch training loss = 0.368505, test loss = 0.393284
  Training set accuracy = 0.900000, Test set accuracy = 0.890100
 epoch 28/30. Took 0.22808 seconds. 
  Full-batch training loss = 0.363559, test loss = 0.388672
  Training set accuracy = 0.900600, Test set accuracy = 0.892600
 epoch 29/30. Took 0.22774 seconds. 
  Full-batch training loss = 0.352048, test loss = 0.378183
  Training set accuracy = 0.901600, Test set accuracy = 0.894400
 epoch 30/30. Took 0.22828 seconds. 
  Full-batch training loss = 0.344400, test loss = 0.373986
  Training set accuracy = 0.905000, Test set accuracy = 0.894500
Elapsed time is 15.288129 seconds.
End Training
-----
Params 5000 0.010 0.50 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.59705 seconds. 
  Full-batch training loss = 2.246683, test loss = 2.248116
  Training set accuracy = 0.323200, Test set accuracy = 0.320000
 epoch 2/30. Took 0.60454 seconds. 
  Full-batch training loss = 2.171240, test loss = 2.173120
  Training set accuracy = 0.509000, Test set accuracy = 0.511400
 epoch 3/30. Took 0.58958 seconds. 
  Full-batch training loss = 2.045914, test loss = 2.047711
  Training set accuracy = 0.582400, Test set accuracy = 0.578900
 epoch 4/30. Took 0.58921 seconds. 
  Full-batch training loss = 1.840413, test loss = 1.841995
  Training set accuracy = 0.647000, Test set accuracy = 0.643000
 epoch 5/30. Took 0.59557 seconds. 
  Full-batch training loss = 1.548682, test loss = 1.546340
  Training set accuracy = 0.693800, Test set accuracy = 0.700700
 epoch 6/30. Took 0.58839 seconds. 
  Full-batch training loss = 1.239595, test loss = 1.233657
  Training set accuracy = 0.753800, Test set accuracy = 0.767600
 epoch 7/30. Took 0.59222 seconds. 
  Full-batch training loss = 0.993602, test loss = 0.985624
  Training set accuracy = 0.784800, Test set accuracy = 0.798300
 epoch 8/30. Took 0.59066 seconds. 
  Full-batch training loss = 0.830740, test loss = 0.824832
  Training set accuracy = 0.802600, Test set accuracy = 0.811800
 epoch 9/30. Took 0.58835 seconds. 
  Full-batch training loss = 0.723703, test loss = 0.716414
  Training set accuracy = 0.828400, Test set accuracy = 0.834300
 epoch 10/30. Took 0.58496 seconds. 
  Full-batch training loss = 0.649717, test loss = 0.646456
  Training set accuracy = 0.837800, Test set accuracy = 0.840700
 epoch 11/30. Took 0.59858 seconds. 
  Full-batch training loss = 0.593862, test loss = 0.594736
  Training set accuracy = 0.847600, Test set accuracy = 0.849400
 epoch 12/30. Took 0.59094 seconds. 
  Full-batch training loss = 0.551106, test loss = 0.551199
  Training set accuracy = 0.858000, Test set accuracy = 0.858100
 epoch 13/30. Took 0.58635 seconds. 
  Full-batch training loss = 0.517461, test loss = 0.516851
  Training set accuracy = 0.863600, Test set accuracy = 0.865100
 epoch 14/30. Took 0.59763 seconds. 
  Full-batch training loss = 0.490092, test loss = 0.494738
  Training set accuracy = 0.867600, Test set accuracy = 0.869900
 epoch 15/30. Took 0.59197 seconds. 
  Full-batch training loss = 0.467232, test loss = 0.472955
  Training set accuracy = 0.872600, Test set accuracy = 0.874600
 epoch 16/30. Took 0.63881 seconds. 
  Full-batch training loss = 0.448873, test loss = 0.456427
  Training set accuracy = 0.877400, Test set accuracy = 0.875800
 epoch 17/30. Took 0.63758 seconds. 
  Full-batch training loss = 0.430586, test loss = 0.440758
  Training set accuracy = 0.879000, Test set accuracy = 0.882600
 epoch 18/30. Took 0.58788 seconds. 
  Full-batch training loss = 0.414137, test loss = 0.424962
  Training set accuracy = 0.882800, Test set accuracy = 0.885300
 epoch 19/30. Took 0.59165 seconds. 
  Full-batch training loss = 0.400811, test loss = 0.415630
  Training set accuracy = 0.886400, Test set accuracy = 0.884900
 epoch 20/30. Took 0.5901 seconds. 
  Full-batch training loss = 0.387698, test loss = 0.405990
  Training set accuracy = 0.889600, Test set accuracy = 0.888600
 epoch 21/30. Took 0.59473 seconds. 
  Full-batch training loss = 0.378141, test loss = 0.397564
  Training set accuracy = 0.892800, Test set accuracy = 0.889400
 epoch 22/30. Took 0.58801 seconds. 
  Full-batch training loss = 0.367204, test loss = 0.388406
  Training set accuracy = 0.895000, Test set accuracy = 0.892900
 epoch 23/30. Took 0.64549 seconds. 
  Full-batch training loss = 0.357028, test loss = 0.379776
  Training set accuracy = 0.898200, Test set accuracy = 0.893400
 epoch 24/30. Took 0.59074 seconds. 
  Full-batch training loss = 0.347839, test loss = 0.374306
  Training set accuracy = 0.899200, Test set accuracy = 0.895000
 epoch 25/30. Took 0.59439 seconds. 
  Full-batch training loss = 0.339736, test loss = 0.367314
  Training set accuracy = 0.900200, Test set accuracy = 0.895800
 epoch 26/30. Took 0.59376 seconds. 
  Full-batch training loss = 0.332489, test loss = 0.361018
  Training set accuracy = 0.902000, Test set accuracy = 0.897600
 epoch 27/30. Took 0.59217 seconds. 
  Full-batch training loss = 0.322991, test loss = 0.353261
  Training set accuracy = 0.905600, Test set accuracy = 0.899100
 epoch 28/30. Took 0.61891 seconds. 
  Full-batch training loss = 0.316558, test loss = 0.350451
  Training set accuracy = 0.905400, Test set accuracy = 0.900900
 epoch 29/30. Took 0.68692 seconds. 
  Full-batch training loss = 0.311958, test loss = 0.349120
  Training set accuracy = 0.906800, Test set accuracy = 0.899100
 epoch 30/30. Took 0.64031 seconds. 
  Full-batch training loss = 0.304250, test loss = 0.340808
  Training set accuracy = 0.910600, Test set accuracy = 0.901900
Elapsed time is 38.203227 seconds.
End Training
-----
Params 5000 0.010 0.50 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.16815 seconds. 
  Full-batch training loss = 2.299179, test loss = 2.298694
  Training set accuracy = 0.155200, Test set accuracy = 0.160400
 epoch 2/30. Took 0.16041 seconds. 
  Full-batch training loss = 2.294129, test loss = 2.294529
  Training set accuracy = 0.129000, Test set accuracy = 0.134300
 epoch 3/30. Took 0.16222 seconds. 
  Full-batch training loss = 2.289092, test loss = 2.290113
  Training set accuracy = 0.119000, Test set accuracy = 0.125600
 epoch 4/30. Took 0.16061 seconds. 
  Full-batch training loss = 2.283803, test loss = 2.285366
  Training set accuracy = 0.184400, Test set accuracy = 0.195700
 epoch 5/30. Took 0.16018 seconds. 
  Full-batch training loss = 2.277262, test loss = 2.279018
  Training set accuracy = 0.261800, Test set accuracy = 0.265900
 epoch 6/30. Took 0.16027 seconds. 
  Full-batch training loss = 2.268568, test loss = 2.270664
  Training set accuracy = 0.291600, Test set accuracy = 0.291700
 epoch 7/30. Took 0.16043 seconds. 
  Full-batch training loss = 2.257201, test loss = 2.259561
  Training set accuracy = 0.316400, Test set accuracy = 0.312200
 epoch 8/30. Took 0.1562 seconds. 
  Full-batch training loss = 2.242140, test loss = 2.244570
  Training set accuracy = 0.332600, Test set accuracy = 0.327300
 epoch 9/30. Took 0.17105 seconds. 
  Full-batch training loss = 2.220046, test loss = 2.222585
  Training set accuracy = 0.335600, Test set accuracy = 0.329300
 epoch 10/30. Took 0.15852 seconds. 
  Full-batch training loss = 2.190705, test loss = 2.193174
  Training set accuracy = 0.347200, Test set accuracy = 0.336800
 epoch 11/30. Took 0.16618 seconds. 
  Full-batch training loss = 2.148634, test loss = 2.151115
  Training set accuracy = 0.394800, Test set accuracy = 0.376700
 epoch 12/30. Took 0.16233 seconds. 
  Full-batch training loss = 2.084930, test loss = 2.087643
  Training set accuracy = 0.434400, Test set accuracy = 0.411900
 epoch 13/30. Took 0.1523 seconds. 
  Full-batch training loss = 1.997650, test loss = 2.000370
  Training set accuracy = 0.447200, Test set accuracy = 0.428600
 epoch 14/30. Took 0.1499 seconds. 
  Full-batch training loss = 1.885882, test loss = 1.888230
  Training set accuracy = 0.469000, Test set accuracy = 0.456800
 epoch 15/30. Took 0.16649 seconds. 
  Full-batch training loss = 1.749732, test loss = 1.751572
  Training set accuracy = 0.505200, Test set accuracy = 0.491200
 epoch 16/30. Took 0.15323 seconds. 
  Full-batch training loss = 1.603479, test loss = 1.605899
  Training set accuracy = 0.515800, Test set accuracy = 0.504300
 epoch 17/30. Took 0.15313 seconds. 
  Full-batch training loss = 1.473317, test loss = 1.474768
  Training set accuracy = 0.559400, Test set accuracy = 0.549100
 epoch 18/30. Took 0.15003 seconds. 
  Full-batch training loss = 1.356098, test loss = 1.358678
  Training set accuracy = 0.600200, Test set accuracy = 0.590500
 epoch 19/30. Took 0.15121 seconds. 
  Full-batch training loss = 1.256485, test loss = 1.259639
  Training set accuracy = 0.642800, Test set accuracy = 0.636000
 epoch 20/30. Took 0.15115 seconds. 
  Full-batch training loss = 1.171194, test loss = 1.176348
  Training set accuracy = 0.656200, Test set accuracy = 0.643900
 epoch 21/30. Took 0.15016 seconds. 
  Full-batch training loss = 1.114702, test loss = 1.120735
  Training set accuracy = 0.656400, Test set accuracy = 0.659200
 epoch 22/30. Took 0.16212 seconds. 
  Full-batch training loss = 1.053093, test loss = 1.060821
  Training set accuracy = 0.695600, Test set accuracy = 0.687700
 epoch 23/30. Took 0.16168 seconds. 
  Full-batch training loss = 1.008352, test loss = 1.018038
  Training set accuracy = 0.696800, Test set accuracy = 0.694500
 epoch 24/30. Took 0.16198 seconds. 
  Full-batch training loss = 0.968658, test loss = 0.982361
  Training set accuracy = 0.707000, Test set accuracy = 0.686600
 epoch 25/30. Took 0.16194 seconds. 
  Full-batch training loss = 0.930373, test loss = 0.945734
  Training set accuracy = 0.724600, Test set accuracy = 0.707700
 epoch 26/30. Took 0.16181 seconds. 
  Full-batch training loss = 0.897732, test loss = 0.913352
  Training set accuracy = 0.741400, Test set accuracy = 0.730200
 epoch 27/30. Took 0.16091 seconds. 
  Full-batch training loss = 0.862913, test loss = 0.880054
  Training set accuracy = 0.749400, Test set accuracy = 0.739800
 epoch 28/30. Took 0.16103 seconds. 
  Full-batch training loss = 0.837199, test loss = 0.855714
  Training set accuracy = 0.769200, Test set accuracy = 0.757900
 epoch 29/30. Took 0.16154 seconds. 
  Full-batch training loss = 0.801571, test loss = 0.821419
  Training set accuracy = 0.760600, Test set accuracy = 0.753600
 epoch 30/30. Took 0.15804 seconds. 
  Full-batch training loss = 0.774060, test loss = 0.795359
  Training set accuracy = 0.789400, Test set accuracy = 0.782100
Elapsed time is 10.855228 seconds.
End Training
-----
Params 5000 0.010 0.50 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27902 seconds. 
  Full-batch training loss = 2.299542, test loss = 2.299766
  Training set accuracy = 0.106400, Test set accuracy = 0.105800
 epoch 2/30. Took 0.27174 seconds. 
  Full-batch training loss = 2.292112, test loss = 2.292782
  Training set accuracy = 0.220200, Test set accuracy = 0.207600
 epoch 3/30. Took 0.28214 seconds. 
  Full-batch training loss = 2.284629, test loss = 2.285563
  Training set accuracy = 0.291600, Test set accuracy = 0.281700
 epoch 4/30. Took 0.28403 seconds. 
  Full-batch training loss = 2.275527, test loss = 2.276763
  Training set accuracy = 0.271000, Test set accuracy = 0.264400
 epoch 5/30. Took 0.28465 seconds. 
  Full-batch training loss = 2.263910, test loss = 2.265223
  Training set accuracy = 0.277800, Test set accuracy = 0.272300
 epoch 6/30. Took 0.28347 seconds. 
  Full-batch training loss = 2.247880, test loss = 2.249393
  Training set accuracy = 0.302600, Test set accuracy = 0.298600
 epoch 7/30. Took 0.28352 seconds. 
  Full-batch training loss = 2.223166, test loss = 2.224925
  Training set accuracy = 0.318400, Test set accuracy = 0.315800
 epoch 8/30. Took 0.28234 seconds. 
  Full-batch training loss = 2.186540, test loss = 2.188513
  Training set accuracy = 0.328600, Test set accuracy = 0.326500
 epoch 9/30. Took 0.28323 seconds. 
  Full-batch training loss = 2.134867, test loss = 2.137080
  Training set accuracy = 0.349400, Test set accuracy = 0.346100
 epoch 10/30. Took 0.28303 seconds. 
  Full-batch training loss = 2.060549, test loss = 2.063407
  Training set accuracy = 0.402600, Test set accuracy = 0.401400
 epoch 11/30. Took 0.28406 seconds. 
  Full-batch training loss = 1.962110, test loss = 1.965130
  Training set accuracy = 0.435400, Test set accuracy = 0.429900
 epoch 12/30. Took 0.26959 seconds. 
  Full-batch training loss = 1.839932, test loss = 1.842865
  Training set accuracy = 0.485400, Test set accuracy = 0.483100
 epoch 13/30. Took 0.27449 seconds. 
  Full-batch training loss = 1.686304, test loss = 1.689231
  Training set accuracy = 0.527400, Test set accuracy = 0.530700
 epoch 14/30. Took 0.28243 seconds. 
  Full-batch training loss = 1.510700, test loss = 1.513905
  Training set accuracy = 0.600800, Test set accuracy = 0.602000
 epoch 15/30. Took 0.28151 seconds. 
  Full-batch training loss = 1.346688, test loss = 1.349653
  Training set accuracy = 0.659200, Test set accuracy = 0.662000
 epoch 16/30. Took 0.27384 seconds. 
  Full-batch training loss = 1.211385, test loss = 1.215850
  Training set accuracy = 0.668600, Test set accuracy = 0.670300
 epoch 17/30. Took 0.30924 seconds. 
  Full-batch training loss = 1.106976, test loss = 1.112315
  Training set accuracy = 0.705800, Test set accuracy = 0.711800
 epoch 18/30. Took 0.26814 seconds. 
  Full-batch training loss = 1.018398, test loss = 1.024207
  Training set accuracy = 0.716200, Test set accuracy = 0.719500
 epoch 19/30. Took 0.28172 seconds. 
  Full-batch training loss = 0.955692, test loss = 0.962564
  Training set accuracy = 0.726200, Test set accuracy = 0.733300
 epoch 20/30. Took 0.27927 seconds. 
  Full-batch training loss = 0.895787, test loss = 0.904844
  Training set accuracy = 0.746000, Test set accuracy = 0.746700
 epoch 21/30. Took 0.26991 seconds. 
  Full-batch training loss = 0.847241, test loss = 0.856440
  Training set accuracy = 0.761600, Test set accuracy = 0.762800
 epoch 22/30. Took 0.28227 seconds. 
  Full-batch training loss = 0.801142, test loss = 0.810615
  Training set accuracy = 0.784200, Test set accuracy = 0.781800
 epoch 23/30. Took 0.30895 seconds. 
  Full-batch training loss = 0.767685, test loss = 0.780100
  Training set accuracy = 0.787800, Test set accuracy = 0.787700
 epoch 24/30. Took 0.29288 seconds. 
  Full-batch training loss = 0.723701, test loss = 0.736424
  Training set accuracy = 0.808600, Test set accuracy = 0.806600
 epoch 25/30. Took 0.27191 seconds. 
  Full-batch training loss = 0.685986, test loss = 0.701846
  Training set accuracy = 0.811000, Test set accuracy = 0.805800
 epoch 26/30. Took 0.31337 seconds. 
  Full-batch training loss = 0.651787, test loss = 0.667591
  Training set accuracy = 0.825600, Test set accuracy = 0.815900
 epoch 27/30. Took 0.28179 seconds. 
  Full-batch training loss = 0.620678, test loss = 0.636747
  Training set accuracy = 0.832600, Test set accuracy = 0.827400
 epoch 28/30. Took 0.28248 seconds. 
  Full-batch training loss = 0.587999, test loss = 0.605131
  Training set accuracy = 0.844400, Test set accuracy = 0.841000
 epoch 29/30. Took 0.29584 seconds. 
  Full-batch training loss = 0.563999, test loss = 0.582543
  Training set accuracy = 0.851200, Test set accuracy = 0.844800
 epoch 30/30. Took 0.28105 seconds. 
  Full-batch training loss = 0.538272, test loss = 0.558458
  Training set accuracy = 0.856800, Test set accuracy = 0.848500
Elapsed time is 18.571973 seconds.
End Training
-----
Params 5000 0.010 0.50 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.8326 seconds. 
  Full-batch training loss = 2.296996, test loss = 2.297212
  Training set accuracy = 0.101200, Test set accuracy = 0.103200
 epoch 2/30. Took 0.9169 seconds. 
  Full-batch training loss = 2.288333, test loss = 2.288407
  Training set accuracy = 0.237200, Test set accuracy = 0.236100
 epoch 3/30. Took 0.87578 seconds. 
  Full-batch training loss = 2.278644, test loss = 2.278612
  Training set accuracy = 0.357000, Test set accuracy = 0.358200
 epoch 4/30. Took 0.86501 seconds. 
  Full-batch training loss = 2.266690, test loss = 2.266368
  Training set accuracy = 0.420600, Test set accuracy = 0.418300
 epoch 5/30. Took 0.81405 seconds. 
  Full-batch training loss = 2.250583, test loss = 2.249981
  Training set accuracy = 0.448600, Test set accuracy = 0.448000
 epoch 6/30. Took 0.87145 seconds. 
  Full-batch training loss = 2.227324, test loss = 2.226479
  Training set accuracy = 0.431000, Test set accuracy = 0.431900
 epoch 7/30. Took 0.82909 seconds. 
  Full-batch training loss = 2.192941, test loss = 2.191414
  Training set accuracy = 0.432200, Test set accuracy = 0.440100
 epoch 8/30. Took 0.82066 seconds. 
  Full-batch training loss = 2.139764, test loss = 2.137542
  Training set accuracy = 0.448600, Test set accuracy = 0.454300
 epoch 9/30. Took 0.87069 seconds. 
  Full-batch training loss = 2.058137, test loss = 2.055107
  Training set accuracy = 0.484400, Test set accuracy = 0.491100
 epoch 10/30. Took 0.8508 seconds. 
  Full-batch training loss = 1.941083, test loss = 1.935494
  Training set accuracy = 0.567800, Test set accuracy = 0.567200
 epoch 11/30. Took 0.8255 seconds. 
  Full-batch training loss = 1.786735, test loss = 1.777559
  Training set accuracy = 0.622200, Test set accuracy = 0.619300
 epoch 12/30. Took 0.91348 seconds. 
  Full-batch training loss = 1.590678, test loss = 1.577977
  Training set accuracy = 0.638800, Test set accuracy = 0.641500
 epoch 13/30. Took 0.91927 seconds. 
  Full-batch training loss = 1.370408, test loss = 1.354346
  Training set accuracy = 0.668400, Test set accuracy = 0.670900
 epoch 14/30. Took 0.83603 seconds. 
  Full-batch training loss = 1.168892, test loss = 1.152770
  Training set accuracy = 0.703800, Test set accuracy = 0.706500
 epoch 15/30. Took 0.82403 seconds. 
  Full-batch training loss = 1.013850, test loss = 0.996296
  Training set accuracy = 0.733800, Test set accuracy = 0.734000
 epoch 16/30. Took 0.823 seconds. 
  Full-batch training loss = 0.907869, test loss = 0.892299
  Training set accuracy = 0.749400, Test set accuracy = 0.755400
 epoch 17/30. Took 0.84363 seconds. 
  Full-batch training loss = 0.823156, test loss = 0.809281
  Training set accuracy = 0.770800, Test set accuracy = 0.775800
 epoch 18/30. Took 0.84267 seconds. 
  Full-batch training loss = 0.757841, test loss = 0.743592
  Training set accuracy = 0.784400, Test set accuracy = 0.793700
 epoch 19/30. Took 0.87641 seconds. 
  Full-batch training loss = 0.701040, test loss = 0.690366
  Training set accuracy = 0.797400, Test set accuracy = 0.800300
 epoch 20/30. Took 0.8271 seconds. 
  Full-batch training loss = 0.656771, test loss = 0.646277
  Training set accuracy = 0.806600, Test set accuracy = 0.814500
 epoch 21/30. Took 0.85179 seconds. 
  Full-batch training loss = 0.615976, test loss = 0.610392
  Training set accuracy = 0.819200, Test set accuracy = 0.821200
 epoch 22/30. Took 0.82272 seconds. 
  Full-batch training loss = 0.589255, test loss = 0.580681
  Training set accuracy = 0.825000, Test set accuracy = 0.832800
 epoch 23/30. Took 0.81809 seconds. 
  Full-batch training loss = 0.558191, test loss = 0.555186
  Training set accuracy = 0.832800, Test set accuracy = 0.838000
 epoch 24/30. Took 0.82428 seconds. 
  Full-batch training loss = 0.536128, test loss = 0.536007
  Training set accuracy = 0.841200, Test set accuracy = 0.839800
 epoch 25/30. Took 0.85995 seconds. 
  Full-batch training loss = 0.511449, test loss = 0.512024
  Training set accuracy = 0.854200, Test set accuracy = 0.848800
 epoch 26/30. Took 0.9042 seconds. 
  Full-batch training loss = 0.484163, test loss = 0.488514
  Training set accuracy = 0.867800, Test set accuracy = 0.858200
 epoch 27/30. Took 0.85967 seconds. 
  Full-batch training loss = 0.468193, test loss = 0.473500
  Training set accuracy = 0.868800, Test set accuracy = 0.863000
 epoch 28/30. Took 0.83883 seconds. 
  Full-batch training loss = 0.452477, test loss = 0.460058
  Training set accuracy = 0.873800, Test set accuracy = 0.868000
 epoch 29/30. Took 0.83007 seconds. 
  Full-batch training loss = 0.435009, test loss = 0.445862
  Training set accuracy = 0.878000, Test set accuracy = 0.871700
 epoch 30/30. Took 0.81915 seconds. 
  Full-batch training loss = 0.416988, test loss = 0.430982
  Training set accuracy = 0.883400, Test set accuracy = 0.876400
Elapsed time is 52.980403 seconds.
End Training
-----
Params 5000 0.001 0.00 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.10306 seconds. 
  Full-batch training loss = 2.239150, test loss = 2.237595
  Training set accuracy = 0.189800, Test set accuracy = 0.196000
 epoch 2/30. Took 0.096609 seconds. 
  Full-batch training loss = 2.122194, test loss = 2.118262
  Training set accuracy = 0.364800, Test set accuracy = 0.379000
 epoch 3/30. Took 0.097736 seconds. 
  Full-batch training loss = 2.011508, test loss = 2.005479
  Training set accuracy = 0.541200, Test set accuracy = 0.556500
 epoch 4/30. Took 0.097502 seconds. 
  Full-batch training loss = 1.901711, test loss = 1.893637
  Training set accuracy = 0.634200, Test set accuracy = 0.639000
 epoch 5/30. Took 0.10378 seconds. 
  Full-batch training loss = 1.791244, test loss = 1.781443
  Training set accuracy = 0.679600, Test set accuracy = 0.679700
 epoch 6/30. Took 0.097174 seconds. 
  Full-batch training loss = 1.681896, test loss = 1.670422
  Training set accuracy = 0.710400, Test set accuracy = 0.711900
 epoch 7/30. Took 0.10158 seconds. 
  Full-batch training loss = 1.574644, test loss = 1.562135
  Training set accuracy = 0.731200, Test set accuracy = 0.727700
 epoch 8/30. Took 0.096899 seconds. 
  Full-batch training loss = 1.472075, test loss = 1.458768
  Training set accuracy = 0.743800, Test set accuracy = 0.742000
 epoch 9/30. Took 0.09681 seconds. 
  Full-batch training loss = 1.375561, test loss = 1.361746
  Training set accuracy = 0.757800, Test set accuracy = 0.754800
 epoch 10/30. Took 0.096572 seconds. 
  Full-batch training loss = 1.286668, test loss = 1.272601
  Training set accuracy = 0.770400, Test set accuracy = 0.767800
 epoch 11/30. Took 0.094204 seconds. 
  Full-batch training loss = 1.206070, test loss = 1.191890
  Training set accuracy = 0.779200, Test set accuracy = 0.777000
 epoch 12/30. Took 0.097283 seconds. 
  Full-batch training loss = 1.134168, test loss = 1.119756
  Training set accuracy = 0.785800, Test set accuracy = 0.788400
 epoch 13/30. Took 0.10028 seconds. 
  Full-batch training loss = 1.069900, test loss = 1.055557
  Training set accuracy = 0.794400, Test set accuracy = 0.796600
 epoch 14/30. Took 0.10404 seconds. 
  Full-batch training loss = 1.012979, test loss = 0.999057
  Training set accuracy = 0.801000, Test set accuracy = 0.803200
 epoch 15/30. Took 0.097011 seconds. 
  Full-batch training loss = 0.962317, test loss = 0.948452
  Training set accuracy = 0.809200, Test set accuracy = 0.810900
 epoch 16/30. Took 0.09728 seconds. 
  Full-batch training loss = 0.917072, test loss = 0.903532
  Training set accuracy = 0.814200, Test set accuracy = 0.816200
 epoch 17/30. Took 0.096961 seconds. 
  Full-batch training loss = 0.876859, test loss = 0.863606
  Training set accuracy = 0.818800, Test set accuracy = 0.821100
 epoch 18/30. Took 0.095403 seconds. 
  Full-batch training loss = 0.840814, test loss = 0.827941
  Training set accuracy = 0.824800, Test set accuracy = 0.825400
 epoch 19/30. Took 0.094157 seconds. 
  Full-batch training loss = 0.808372, test loss = 0.795772
  Training set accuracy = 0.830000, Test set accuracy = 0.830600
 epoch 20/30. Took 0.097783 seconds. 
  Full-batch training loss = 0.779224, test loss = 0.766918
  Training set accuracy = 0.834800, Test set accuracy = 0.834100
 epoch 21/30. Took 0.097747 seconds. 
  Full-batch training loss = 0.752687, test loss = 0.740934
  Training set accuracy = 0.838800, Test set accuracy = 0.838300
 epoch 22/30. Took 0.097865 seconds. 
  Full-batch training loss = 0.728580, test loss = 0.716964
  Training set accuracy = 0.843800, Test set accuracy = 0.843200
 epoch 23/30. Took 0.097292 seconds. 
  Full-batch training loss = 0.706454, test loss = 0.695916
  Training set accuracy = 0.847200, Test set accuracy = 0.844200
 epoch 24/30. Took 0.09756 seconds. 
  Full-batch training loss = 0.686279, test loss = 0.675718
  Training set accuracy = 0.851000, Test set accuracy = 0.848700
 epoch 25/30. Took 0.097688 seconds. 
  Full-batch training loss = 0.667627, test loss = 0.657913
  Training set accuracy = 0.851800, Test set accuracy = 0.851900
 epoch 26/30. Took 0.098733 seconds. 
  Full-batch training loss = 0.650599, test loss = 0.641496
  Training set accuracy = 0.854800, Test set accuracy = 0.853600
 epoch 27/30. Took 0.098055 seconds. 
  Full-batch training loss = 0.634640, test loss = 0.625780
  Training set accuracy = 0.856800, Test set accuracy = 0.857700
 epoch 28/30. Took 0.10568 seconds. 
  Full-batch training loss = 0.619908, test loss = 0.611365
  Training set accuracy = 0.859800, Test set accuracy = 0.859500
 epoch 29/30. Took 0.093074 seconds. 
  Full-batch training loss = 0.606188, test loss = 0.598435
  Training set accuracy = 0.860400, Test set accuracy = 0.861300
 epoch 30/30. Took 0.096814 seconds. 
  Full-batch training loss = 0.593318, test loss = 0.586127
  Training set accuracy = 0.861800, Test set accuracy = 0.864500
Elapsed time is 7.616709 seconds.
End Training
-----
Params 5000 0.001 0.00 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.15794 seconds. 
  Full-batch training loss = 2.207797, test loss = 2.204273
  Training set accuracy = 0.226000, Test set accuracy = 0.230000
 epoch 2/30. Took 0.15764 seconds. 
  Full-batch training loss = 2.071714, test loss = 2.065934
  Training set accuracy = 0.465800, Test set accuracy = 0.471200
 epoch 3/30. Took 0.1481 seconds. 
  Full-batch training loss = 1.942673, test loss = 1.934683
  Training set accuracy = 0.587200, Test set accuracy = 0.593500
 epoch 4/30. Took 0.14775 seconds. 
  Full-batch training loss = 1.817113, test loss = 1.806670
  Training set accuracy = 0.646000, Test set accuracy = 0.648800
 epoch 5/30. Took 0.1496 seconds. 
  Full-batch training loss = 1.695138, test loss = 1.682292
  Training set accuracy = 0.685800, Test set accuracy = 0.694900
 epoch 6/30. Took 0.14658 seconds. 
  Full-batch training loss = 1.577000, test loss = 1.562193
  Training set accuracy = 0.714200, Test set accuracy = 0.728900
 epoch 7/30. Took 0.14696 seconds. 
  Full-batch training loss = 1.465866, test loss = 1.449196
  Training set accuracy = 0.739000, Test set accuracy = 0.751700
 epoch 8/30. Took 0.16152 seconds. 
  Full-batch training loss = 1.362290, test loss = 1.344280
  Training set accuracy = 0.761400, Test set accuracy = 0.772500
 epoch 9/30. Took 0.14892 seconds. 
  Full-batch training loss = 1.268835, test loss = 1.249647
  Training set accuracy = 0.781200, Test set accuracy = 0.791600
 epoch 10/30. Took 0.14832 seconds. 
  Full-batch training loss = 1.184908, test loss = 1.165088
  Training set accuracy = 0.792200, Test set accuracy = 0.802900
 epoch 11/30. Took 0.14914 seconds. 
  Full-batch training loss = 1.110133, test loss = 1.089790
  Training set accuracy = 0.802800, Test set accuracy = 0.811200
 epoch 12/30. Took 0.14908 seconds. 
  Full-batch training loss = 1.044239, test loss = 1.023835
  Training set accuracy = 0.812800, Test set accuracy = 0.819100
 epoch 13/30. Took 0.14935 seconds. 
  Full-batch training loss = 0.986006, test loss = 0.965973
  Training set accuracy = 0.819400, Test set accuracy = 0.825900
 epoch 14/30. Took 0.14846 seconds. 
  Full-batch training loss = 0.934995, test loss = 0.915267
  Training set accuracy = 0.825200, Test set accuracy = 0.831600
 epoch 15/30. Took 0.14727 seconds. 
  Full-batch training loss = 0.889832, test loss = 0.870639
  Training set accuracy = 0.830600, Test set accuracy = 0.836200
 epoch 16/30. Took 0.14758 seconds. 
  Full-batch training loss = 0.849774, test loss = 0.831190
  Training set accuracy = 0.834000, Test set accuracy = 0.842200
 epoch 17/30. Took 0.14571 seconds. 
  Full-batch training loss = 0.814140, test loss = 0.796274
  Training set accuracy = 0.837400, Test set accuracy = 0.844400
 epoch 18/30. Took 0.16081 seconds. 
  Full-batch training loss = 0.782365, test loss = 0.765180
  Training set accuracy = 0.841000, Test set accuracy = 0.846600
 epoch 19/30. Took 0.14823 seconds. 
  Full-batch training loss = 0.753692, test loss = 0.737256
  Training set accuracy = 0.845200, Test set accuracy = 0.850100
 epoch 20/30. Took 0.16172 seconds. 
  Full-batch training loss = 0.728020, test loss = 0.712255
  Training set accuracy = 0.847800, Test set accuracy = 0.851600
 epoch 21/30. Took 0.14822 seconds. 
  Full-batch training loss = 0.704651, test loss = 0.689903
  Training set accuracy = 0.852600, Test set accuracy = 0.854500
 epoch 22/30. Took 0.16114 seconds. 
  Full-batch training loss = 0.683385, test loss = 0.669528
  Training set accuracy = 0.854800, Test set accuracy = 0.856300
 epoch 23/30. Took 0.14711 seconds. 
  Full-batch training loss = 0.663913, test loss = 0.650785
  Training set accuracy = 0.856800, Test set accuracy = 0.857800
 epoch 24/30. Took 0.15014 seconds. 
  Full-batch training loss = 0.646029, test loss = 0.633889
  Training set accuracy = 0.859800, Test set accuracy = 0.860300
 epoch 25/30. Took 0.14715 seconds. 
  Full-batch training loss = 0.629661, test loss = 0.618067
  Training set accuracy = 0.861000, Test set accuracy = 0.861900
 epoch 26/30. Took 0.14605 seconds. 
  Full-batch training loss = 0.614396, test loss = 0.603577
  Training set accuracy = 0.865400, Test set accuracy = 0.863500
 epoch 27/30. Took 0.14488 seconds. 
  Full-batch training loss = 0.600300, test loss = 0.590491
  Training set accuracy = 0.866200, Test set accuracy = 0.865000
 epoch 28/30. Took 0.14765 seconds. 
  Full-batch training loss = 0.587193, test loss = 0.578065
  Training set accuracy = 0.868000, Test set accuracy = 0.866300
 epoch 29/30. Took 0.16349 seconds. 
  Full-batch training loss = 0.574936, test loss = 0.566748
  Training set accuracy = 0.871000, Test set accuracy = 0.868600
 epoch 30/30. Took 0.16621 seconds. 
  Full-batch training loss = 0.563424, test loss = 0.555885
  Training set accuracy = 0.871800, Test set accuracy = 0.869600
Elapsed time is 11.467827 seconds.
End Training
-----
Params 5000 0.001 0.00 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32715 seconds. 
  Full-batch training loss = 2.188796, test loss = 2.184016
  Training set accuracy = 0.271800, Test set accuracy = 0.275400
 epoch 2/30. Took 0.32017 seconds. 
  Full-batch training loss = 2.030043, test loss = 2.025243
  Training set accuracy = 0.538200, Test set accuracy = 0.539400
 epoch 3/30. Took 0.32997 seconds. 
  Full-batch training loss = 1.883676, test loss = 1.878919
  Training set accuracy = 0.648200, Test set accuracy = 0.650700
 epoch 4/30. Took 0.31673 seconds. 
  Full-batch training loss = 1.744272, test loss = 1.739106
  Training set accuracy = 0.702800, Test set accuracy = 0.701800
 epoch 5/30. Took 0.31726 seconds. 
  Full-batch training loss = 1.611638, test loss = 1.606106
  Training set accuracy = 0.734800, Test set accuracy = 0.735800
 epoch 6/30. Took 0.33593 seconds. 
  Full-batch training loss = 1.486997, test loss = 1.481037
  Training set accuracy = 0.756200, Test set accuracy = 0.759400
 epoch 7/30. Took 0.31393 seconds. 
  Full-batch training loss = 1.372819, test loss = 1.366280
  Training set accuracy = 0.777800, Test set accuracy = 0.774500
 epoch 8/30. Took 0.33113 seconds. 
  Full-batch training loss = 1.269888, test loss = 1.263047
  Training set accuracy = 0.789200, Test set accuracy = 0.788100
 epoch 9/30. Took 0.31421 seconds. 
  Full-batch training loss = 1.178502, test loss = 1.171465
  Training set accuracy = 0.801000, Test set accuracy = 0.802500
 epoch 10/30. Took 0.31413 seconds. 
  Full-batch training loss = 1.098172, test loss = 1.091089
  Training set accuracy = 0.812400, Test set accuracy = 0.813000
 epoch 11/30. Took 0.31556 seconds. 
  Full-batch training loss = 1.027952, test loss = 1.021265
  Training set accuracy = 0.821200, Test set accuracy = 0.819600
 epoch 12/30. Took 0.31613 seconds. 
  Full-batch training loss = 0.966653, test loss = 0.960250
  Training set accuracy = 0.826400, Test set accuracy = 0.825600
 epoch 13/30. Took 0.33626 seconds. 
  Full-batch training loss = 0.913310, test loss = 0.907227
  Training set accuracy = 0.832600, Test set accuracy = 0.832600
 epoch 14/30. Took 0.3145 seconds. 
  Full-batch training loss = 0.866426, test loss = 0.860787
  Training set accuracy = 0.836800, Test set accuracy = 0.836200
 epoch 15/30. Took 0.31423 seconds. 
  Full-batch training loss = 0.825226, test loss = 0.820097
  Training set accuracy = 0.841800, Test set accuracy = 0.840800
 epoch 16/30. Took 0.31461 seconds. 
  Full-batch training loss = 0.788893, test loss = 0.784121
  Training set accuracy = 0.846600, Test set accuracy = 0.844700
 epoch 17/30. Took 0.31383 seconds. 
  Full-batch training loss = 0.756494, test loss = 0.752475
  Training set accuracy = 0.850600, Test set accuracy = 0.847300
 epoch 18/30. Took 0.34424 seconds. 
  Full-batch training loss = 0.727644, test loss = 0.724240
  Training set accuracy = 0.854400, Test set accuracy = 0.851700
 epoch 19/30. Took 0.31392 seconds. 
  Full-batch training loss = 0.701647, test loss = 0.698848
  Training set accuracy = 0.856600, Test set accuracy = 0.854600
 epoch 20/30. Took 0.32455 seconds. 
  Full-batch training loss = 0.678324, test loss = 0.676303
  Training set accuracy = 0.858600, Test set accuracy = 0.856100
 epoch 21/30. Took 0.31388 seconds. 
  Full-batch training loss = 0.657151, test loss = 0.655713
  Training set accuracy = 0.862600, Test set accuracy = 0.858600
 epoch 22/30. Took 0.312 seconds. 
  Full-batch training loss = 0.637837, test loss = 0.637182
  Training set accuracy = 0.865800, Test set accuracy = 0.860000
 epoch 23/30. Took 0.31489 seconds. 
  Full-batch training loss = 0.620218, test loss = 0.620231
  Training set accuracy = 0.866800, Test set accuracy = 0.861600
 epoch 24/30. Took 0.31359 seconds. 
  Full-batch training loss = 0.604064, test loss = 0.604460
  Training set accuracy = 0.870600, Test set accuracy = 0.865000
 epoch 25/30. Took 0.31471 seconds. 
  Full-batch training loss = 0.589169, test loss = 0.590239
  Training set accuracy = 0.872600, Test set accuracy = 0.867100
 epoch 26/30. Took 0.31242 seconds. 
  Full-batch training loss = 0.575363, test loss = 0.577297
  Training set accuracy = 0.874400, Test set accuracy = 0.868000
 epoch 27/30. Took 0.33653 seconds. 
  Full-batch training loss = 0.562646, test loss = 0.565330
  Training set accuracy = 0.874400, Test set accuracy = 0.869100
 epoch 28/30. Took 0.31335 seconds. 
  Full-batch training loss = 0.550822, test loss = 0.553998
  Training set accuracy = 0.877400, Test set accuracy = 0.870500
 epoch 29/30. Took 0.34853 seconds. 
  Full-batch training loss = 0.539845, test loss = 0.543601
  Training set accuracy = 0.879800, Test set accuracy = 0.872000
 epoch 30/30. Took 0.31411 seconds. 
  Full-batch training loss = 0.529473, test loss = 0.533907
  Training set accuracy = 0.881400, Test set accuracy = 0.874100
Elapsed time is 21.614639 seconds.
End Training
-----
Params 5000 0.001 0.00 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11863 seconds. 
  Full-batch training loss = 2.244839, test loss = 2.247800
  Training set accuracy = 0.181800, Test set accuracy = 0.184100
 epoch 2/30. Took 0.11216 seconds. 
  Full-batch training loss = 2.180895, test loss = 2.183114
  Training set accuracy = 0.289200, Test set accuracy = 0.302300
 epoch 3/30. Took 0.11187 seconds. 
  Full-batch training loss = 2.111949, test loss = 2.113443
  Training set accuracy = 0.379000, Test set accuracy = 0.397900
 epoch 4/30. Took 0.11219 seconds. 
  Full-batch training loss = 2.033647, test loss = 2.034362
  Training set accuracy = 0.445200, Test set accuracy = 0.455000
 epoch 5/30. Took 0.11145 seconds. 
  Full-batch training loss = 1.946083, test loss = 1.946434
  Training set accuracy = 0.498800, Test set accuracy = 0.501800
 epoch 6/30. Took 0.1127 seconds. 
  Full-batch training loss = 1.850086, test loss = 1.849932
  Training set accuracy = 0.557000, Test set accuracy = 0.550200
 epoch 7/30. Took 0.11577 seconds. 
  Full-batch training loss = 1.746654, test loss = 1.746027
  Training set accuracy = 0.611200, Test set accuracy = 0.594800
 epoch 8/30. Took 0.11708 seconds. 
  Full-batch training loss = 1.637672, test loss = 1.636389
  Training set accuracy = 0.652400, Test set accuracy = 0.633000
 epoch 9/30. Took 0.1103 seconds. 
  Full-batch training loss = 1.526774, test loss = 1.524747
  Training set accuracy = 0.689200, Test set accuracy = 0.670600
 epoch 10/30. Took 0.1076 seconds. 
  Full-batch training loss = 1.417737, test loss = 1.415633
  Training set accuracy = 0.715200, Test set accuracy = 0.700700
 epoch 11/30. Took 0.10811 seconds. 
  Full-batch training loss = 1.313386, test loss = 1.311022
  Training set accuracy = 0.742400, Test set accuracy = 0.729400
 epoch 12/30. Took 0.10848 seconds. 
  Full-batch training loss = 1.216897, test loss = 1.214628
  Training set accuracy = 0.761400, Test set accuracy = 0.750400
 epoch 13/30. Took 0.10939 seconds. 
  Full-batch training loss = 1.128992, test loss = 1.127389
  Training set accuracy = 0.777000, Test set accuracy = 0.765500
 epoch 14/30. Took 0.11168 seconds. 
  Full-batch training loss = 1.050118, test loss = 1.048486
  Training set accuracy = 0.796000, Test set accuracy = 0.783500
 epoch 15/30. Took 0.11165 seconds. 
  Full-batch training loss = 0.979836, test loss = 0.979433
  Training set accuracy = 0.805200, Test set accuracy = 0.790900
 epoch 16/30. Took 0.10946 seconds. 
  Full-batch training loss = 0.918276, test loss = 0.918404
  Training set accuracy = 0.816200, Test set accuracy = 0.802500
 epoch 17/30. Took 0.11209 seconds. 
  Full-batch training loss = 0.864423, test loss = 0.865666
  Training set accuracy = 0.821200, Test set accuracy = 0.809700
 epoch 18/30. Took 0.11194 seconds. 
  Full-batch training loss = 0.816976, test loss = 0.818553
  Training set accuracy = 0.827600, Test set accuracy = 0.817200
 epoch 19/30. Took 0.1118 seconds. 
  Full-batch training loss = 0.775546, test loss = 0.777949
  Training set accuracy = 0.833000, Test set accuracy = 0.823500
 epoch 20/30. Took 0.11191 seconds. 
  Full-batch training loss = 0.738902, test loss = 0.741079
  Training set accuracy = 0.841200, Test set accuracy = 0.830800
 epoch 21/30. Took 0.11212 seconds. 
  Full-batch training loss = 0.706702, test loss = 0.709356
  Training set accuracy = 0.845200, Test set accuracy = 0.836300
 epoch 22/30. Took 0.11145 seconds. 
  Full-batch training loss = 0.678175, test loss = 0.681441
  Training set accuracy = 0.849000, Test set accuracy = 0.840400
 epoch 23/30. Took 0.10971 seconds. 
  Full-batch training loss = 0.652479, test loss = 0.656641
  Training set accuracy = 0.852200, Test set accuracy = 0.842800
 epoch 24/30. Took 0.11185 seconds. 
  Full-batch training loss = 0.629857, test loss = 0.634808
  Training set accuracy = 0.856200, Test set accuracy = 0.845600
 epoch 25/30. Took 0.11179 seconds. 
  Full-batch training loss = 0.609134, test loss = 0.614249
  Training set accuracy = 0.858400, Test set accuracy = 0.849700
 epoch 26/30. Took 0.10845 seconds. 
  Full-batch training loss = 0.590559, test loss = 0.596172
  Training set accuracy = 0.861200, Test set accuracy = 0.852700
 epoch 27/30. Took 0.11159 seconds. 
  Full-batch training loss = 0.573604, test loss = 0.579637
  Training set accuracy = 0.865800, Test set accuracy = 0.855100
 epoch 28/30. Took 0.1113 seconds. 
  Full-batch training loss = 0.558296, test loss = 0.565140
  Training set accuracy = 0.866800, Test set accuracy = 0.856700
 epoch 29/30. Took 0.11236 seconds. 
  Full-batch training loss = 0.543997, test loss = 0.550951
  Training set accuracy = 0.870000, Test set accuracy = 0.861100
 epoch 30/30. Took 0.11031 seconds. 
  Full-batch training loss = 0.530886, test loss = 0.538227
  Training set accuracy = 0.873200, Test set accuracy = 0.862900
Elapsed time is 8.539362 seconds.
End Training
-----
Params 5000 0.001 0.00 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.19531 seconds. 
  Full-batch training loss = 2.228624, test loss = 2.227954
  Training set accuracy = 0.229400, Test set accuracy = 0.229800
 epoch 2/30. Took 0.19184 seconds. 
  Full-batch training loss = 2.150108, test loss = 2.148569
  Training set accuracy = 0.380600, Test set accuracy = 0.382400
 epoch 3/30. Took 0.19064 seconds. 
  Full-batch training loss = 2.065946, test loss = 2.063817
  Training set accuracy = 0.500600, Test set accuracy = 0.491300
 epoch 4/30. Took 0.18875 seconds. 
  Full-batch training loss = 1.974206, test loss = 1.971334
  Training set accuracy = 0.565400, Test set accuracy = 0.553800
 epoch 5/30. Took 0.1924 seconds. 
  Full-batch training loss = 1.872808, test loss = 1.869108
  Training set accuracy = 0.612800, Test set accuracy = 0.604300
 epoch 6/30. Took 0.18937 seconds. 
  Full-batch training loss = 1.761805, test loss = 1.757183
  Training set accuracy = 0.647600, Test set accuracy = 0.637400
 epoch 7/30. Took 0.18906 seconds. 
  Full-batch training loss = 1.644645, test loss = 1.638731
  Training set accuracy = 0.682600, Test set accuracy = 0.670400
 epoch 8/30. Took 0.18877 seconds. 
  Full-batch training loss = 1.525076, test loss = 1.518212
  Training set accuracy = 0.706800, Test set accuracy = 0.697500
 epoch 9/30. Took 0.18937 seconds. 
  Full-batch training loss = 1.406217, test loss = 1.398049
  Training set accuracy = 0.728600, Test set accuracy = 0.720900
 epoch 10/30. Took 0.1887 seconds. 
  Full-batch training loss = 1.292879, test loss = 1.284165
  Training set accuracy = 0.749800, Test set accuracy = 0.740700
 epoch 11/30. Took 0.19021 seconds. 
  Full-batch training loss = 1.188206, test loss = 1.179625
  Training set accuracy = 0.769000, Test set accuracy = 0.758700
 epoch 12/30. Took 0.1871 seconds. 
  Full-batch training loss = 1.093892, test loss = 1.085398
  Training set accuracy = 0.788000, Test set accuracy = 0.778500
 epoch 13/30. Took 0.1904 seconds. 
  Full-batch training loss = 1.010818, test loss = 1.003802
  Training set accuracy = 0.799800, Test set accuracy = 0.790500
 epoch 14/30. Took 0.18959 seconds. 
  Full-batch training loss = 0.938443, test loss = 0.931910
  Training set accuracy = 0.806200, Test set accuracy = 0.799800
 epoch 15/30. Took 0.18985 seconds. 
  Full-batch training loss = 0.875752, test loss = 0.870232
  Training set accuracy = 0.819800, Test set accuracy = 0.817200
 epoch 16/30. Took 0.18996 seconds. 
  Full-batch training loss = 0.821517, test loss = 0.817241
  Training set accuracy = 0.828200, Test set accuracy = 0.823800
 epoch 17/30. Took 0.18906 seconds. 
  Full-batch training loss = 0.774980, test loss = 0.772342
  Training set accuracy = 0.836400, Test set accuracy = 0.830700
 epoch 18/30. Took 0.18885 seconds. 
  Full-batch training loss = 0.734217, test loss = 0.732724
  Training set accuracy = 0.840600, Test set accuracy = 0.835200
 epoch 19/30. Took 0.18936 seconds. 
  Full-batch training loss = 0.698771, test loss = 0.698568
  Training set accuracy = 0.845400, Test set accuracy = 0.842900
 epoch 20/30. Took 0.19104 seconds. 
  Full-batch training loss = 0.667879, test loss = 0.668901
  Training set accuracy = 0.848600, Test set accuracy = 0.847800
 epoch 21/30. Took 0.19058 seconds. 
  Full-batch training loss = 0.639761, test loss = 0.642355
  Training set accuracy = 0.852200, Test set accuracy = 0.850100
 epoch 22/30. Took 0.19012 seconds. 
  Full-batch training loss = 0.615073, test loss = 0.618251
  Training set accuracy = 0.855000, Test set accuracy = 0.856600
 epoch 23/30. Took 0.1884 seconds. 
  Full-batch training loss = 0.593312, test loss = 0.597810
  Training set accuracy = 0.858800, Test set accuracy = 0.858800
 epoch 24/30. Took 0.20488 seconds. 
  Full-batch training loss = 0.573211, test loss = 0.578404
  Training set accuracy = 0.864400, Test set accuracy = 0.862100
 epoch 25/30. Took 0.18974 seconds. 
  Full-batch training loss = 0.555527, test loss = 0.561398
  Training set accuracy = 0.865000, Test set accuracy = 0.865300
 epoch 26/30. Took 0.19191 seconds. 
  Full-batch training loss = 0.539208, test loss = 0.546179
  Training set accuracy = 0.868800, Test set accuracy = 0.868500
 epoch 27/30. Took 0.1899 seconds. 
  Full-batch training loss = 0.523952, test loss = 0.532584
  Training set accuracy = 0.871200, Test set accuracy = 0.870200
 epoch 28/30. Took 0.18941 seconds. 
  Full-batch training loss = 0.510343, test loss = 0.519102
  Training set accuracy = 0.872000, Test set accuracy = 0.873100
 epoch 29/30. Took 0.19 seconds. 
  Full-batch training loss = 0.497726, test loss = 0.507602
  Training set accuracy = 0.875000, Test set accuracy = 0.875100
 epoch 30/30. Took 0.20601 seconds. 
  Full-batch training loss = 0.485985, test loss = 0.497008
  Training set accuracy = 0.878600, Test set accuracy = 0.875900
Elapsed time is 14.077992 seconds.
End Training
-----
Params 5000 0.001 0.00 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.51832 seconds. 
  Full-batch training loss = 2.243246, test loss = 2.240558
  Training set accuracy = 0.186000, Test set accuracy = 0.201100
 epoch 2/30. Took 0.51387 seconds. 
  Full-batch training loss = 2.149881, test loss = 2.147368
  Training set accuracy = 0.396800, Test set accuracy = 0.409600
 epoch 3/30. Took 0.51472 seconds. 
  Full-batch training loss = 2.051773, test loss = 2.048944
  Training set accuracy = 0.581400, Test set accuracy = 0.578100
 epoch 4/30. Took 0.51805 seconds. 
  Full-batch training loss = 1.944670, test loss = 1.941103
  Training set accuracy = 0.663000, Test set accuracy = 0.655500
 epoch 5/30. Took 0.51126 seconds. 
  Full-batch training loss = 1.827483, test loss = 1.822970
  Training set accuracy = 0.694400, Test set accuracy = 0.684600
 epoch 6/30. Took 0.51392 seconds. 
  Full-batch training loss = 1.701008, test loss = 1.695090
  Training set accuracy = 0.720400, Test set accuracy = 0.712400
 epoch 7/30. Took 0.51326 seconds. 
  Full-batch training loss = 1.567530, test loss = 1.560499
  Training set accuracy = 0.735400, Test set accuracy = 0.731300
 epoch 8/30. Took 0.53296 seconds. 
  Full-batch training loss = 1.432919, test loss = 1.424678
  Training set accuracy = 0.753000, Test set accuracy = 0.747800
 epoch 9/30. Took 0.51209 seconds. 
  Full-batch training loss = 1.303744, test loss = 1.294486
  Training set accuracy = 0.769000, Test set accuracy = 0.768100
 epoch 10/30. Took 0.55763 seconds. 
  Full-batch training loss = 1.185197, test loss = 1.175321
  Training set accuracy = 0.781400, Test set accuracy = 0.782200
 epoch 11/30. Took 0.51212 seconds. 
  Full-batch training loss = 1.080829, test loss = 1.070901
  Training set accuracy = 0.793200, Test set accuracy = 0.794400
 epoch 12/30. Took 0.53822 seconds. 
  Full-batch training loss = 0.990529, test loss = 0.981202
  Training set accuracy = 0.804200, Test set accuracy = 0.804600
 epoch 13/30. Took 0.52209 seconds. 
  Full-batch training loss = 0.913922, test loss = 0.906461
  Training set accuracy = 0.813200, Test set accuracy = 0.813700
 epoch 14/30. Took 0.51625 seconds. 
  Full-batch training loss = 0.849200, test loss = 0.842507
  Training set accuracy = 0.821800, Test set accuracy = 0.820400
 epoch 15/30. Took 0.51284 seconds. 
  Full-batch training loss = 0.794337, test loss = 0.788335
  Training set accuracy = 0.828000, Test set accuracy = 0.827400
 epoch 16/30. Took 0.51126 seconds. 
  Full-batch training loss = 0.747409, test loss = 0.742959
  Training set accuracy = 0.832800, Test set accuracy = 0.834300
 epoch 17/30. Took 0.51845 seconds. 
  Full-batch training loss = 0.707131, test loss = 0.704046
  Training set accuracy = 0.840400, Test set accuracy = 0.840100
 epoch 18/30. Took 0.51316 seconds. 
  Full-batch training loss = 0.672570, test loss = 0.670043
  Training set accuracy = 0.846000, Test set accuracy = 0.844200
 epoch 19/30. Took 0.51584 seconds. 
  Full-batch training loss = 0.641776, test loss = 0.641855
  Training set accuracy = 0.847800, Test set accuracy = 0.847400
 epoch 20/30. Took 0.51224 seconds. 
  Full-batch training loss = 0.615061, test loss = 0.614775
  Training set accuracy = 0.855200, Test set accuracy = 0.854700
 epoch 21/30. Took 0.51236 seconds. 
  Full-batch training loss = 0.591134, test loss = 0.591980
  Training set accuracy = 0.857200, Test set accuracy = 0.859600
 epoch 22/30. Took 0.51169 seconds. 
  Full-batch training loss = 0.570184, test loss = 0.574159
  Training set accuracy = 0.861000, Test set accuracy = 0.860100
 epoch 23/30. Took 0.51281 seconds. 
  Full-batch training loss = 0.551049, test loss = 0.554544
  Training set accuracy = 0.864400, Test set accuracy = 0.862700
 epoch 24/30. Took 0.51359 seconds. 
  Full-batch training loss = 0.534299, test loss = 0.538258
  Training set accuracy = 0.867600, Test set accuracy = 0.866400
 epoch 25/30. Took 0.51017 seconds. 
  Full-batch training loss = 0.518203, test loss = 0.523856
  Training set accuracy = 0.872800, Test set accuracy = 0.869400
 epoch 26/30. Took 0.50906 seconds. 
  Full-batch training loss = 0.504054, test loss = 0.511593
  Training set accuracy = 0.874600, Test set accuracy = 0.871400
 epoch 27/30. Took 0.51255 seconds. 
  Full-batch training loss = 0.490752, test loss = 0.499392
  Training set accuracy = 0.880200, Test set accuracy = 0.873400
 epoch 28/30. Took 0.50846 seconds. 
  Full-batch training loss = 0.479412, test loss = 0.487866
  Training set accuracy = 0.882400, Test set accuracy = 0.876300
 epoch 29/30. Took 0.55956 seconds. 
  Full-batch training loss = 0.467960, test loss = 0.478113
  Training set accuracy = 0.885000, Test set accuracy = 0.878000
 epoch 30/30. Took 0.51149 seconds. 
  Full-batch training loss = 0.457617, test loss = 0.468297
  Training set accuracy = 0.886600, Test set accuracy = 0.879800
Elapsed time is 34.024524 seconds.
End Training
-----
Params 5000 0.001 0.00 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.13338 seconds. 
  Full-batch training loss = 2.272816, test loss = 2.274308
  Training set accuracy = 0.117800, Test set accuracy = 0.116200
 epoch 2/30. Took 0.12592 seconds. 
  Full-batch training loss = 2.235335, test loss = 2.237700
  Training set accuracy = 0.179400, Test set accuracy = 0.170900
 epoch 3/30. Took 0.12634 seconds. 
  Full-batch training loss = 2.193264, test loss = 2.196517
  Training set accuracy = 0.250000, Test set accuracy = 0.235700
 epoch 4/30. Took 0.12619 seconds. 
  Full-batch training loss = 2.144398, test loss = 2.148653
  Training set accuracy = 0.345200, Test set accuracy = 0.330900
 epoch 5/30. Took 0.12598 seconds. 
  Full-batch training loss = 2.086814, test loss = 2.091751
  Training set accuracy = 0.436200, Test set accuracy = 0.417700
 epoch 6/30. Took 0.12537 seconds. 
  Full-batch training loss = 2.018649, test loss = 2.024264
  Training set accuracy = 0.488200, Test set accuracy = 0.476200
 epoch 7/30. Took 0.13423 seconds. 
  Full-batch training loss = 1.938683, test loss = 1.944474
  Training set accuracy = 0.547400, Test set accuracy = 0.530700
 epoch 8/30. Took 0.12594 seconds. 
  Full-batch training loss = 1.846071, test loss = 1.851858
  Training set accuracy = 0.580000, Test set accuracy = 0.565300
 epoch 9/30. Took 0.12621 seconds. 
  Full-batch training loss = 1.741841, test loss = 1.747658
  Training set accuracy = 0.616000, Test set accuracy = 0.600900
 epoch 10/30. Took 0.12527 seconds. 
  Full-batch training loss = 1.628034, test loss = 1.632711
  Training set accuracy = 0.645400, Test set accuracy = 0.633900
 epoch 11/30. Took 0.12829 seconds. 
  Full-batch training loss = 1.509009, test loss = 1.512459
  Training set accuracy = 0.671400, Test set accuracy = 0.657600
 epoch 12/30. Took 0.127 seconds. 
  Full-batch training loss = 1.389279, test loss = 1.390937
  Training set accuracy = 0.687600, Test set accuracy = 0.678900
 epoch 13/30. Took 0.12711 seconds. 
  Full-batch training loss = 1.274889, test loss = 1.274886
  Training set accuracy = 0.705400, Test set accuracy = 0.696800
 epoch 14/30. Took 0.12596 seconds. 
  Full-batch training loss = 1.170902, test loss = 1.168260
  Training set accuracy = 0.718200, Test set accuracy = 0.713600
 epoch 15/30. Took 0.12308 seconds. 
  Full-batch training loss = 1.079689, test loss = 1.075110
  Training set accuracy = 0.737800, Test set accuracy = 0.730300
 epoch 16/30. Took 0.12622 seconds. 
  Full-batch training loss = 1.001706, test loss = 0.995563
  Training set accuracy = 0.745000, Test set accuracy = 0.741700
 epoch 17/30. Took 0.12658 seconds. 
  Full-batch training loss = 0.934560, test loss = 0.925914
  Training set accuracy = 0.759000, Test set accuracy = 0.758300
 epoch 18/30. Took 0.12532 seconds. 
  Full-batch training loss = 0.877633, test loss = 0.867484
  Training set accuracy = 0.771000, Test set accuracy = 0.773500
 epoch 19/30. Took 0.12648 seconds. 
  Full-batch training loss = 0.828115, test loss = 0.817682
  Training set accuracy = 0.780200, Test set accuracy = 0.784500
 epoch 20/30. Took 0.1267 seconds. 
  Full-batch training loss = 0.785197, test loss = 0.774565
  Training set accuracy = 0.790000, Test set accuracy = 0.794000
 epoch 21/30. Took 0.12705 seconds. 
  Full-batch training loss = 0.747099, test loss = 0.736749
  Training set accuracy = 0.802400, Test set accuracy = 0.803500
 epoch 22/30. Took 0.12288 seconds. 
  Full-batch training loss = 0.712734, test loss = 0.700846
  Training set accuracy = 0.809400, Test set accuracy = 0.812100
 epoch 23/30. Took 0.13048 seconds. 
  Full-batch training loss = 0.682859, test loss = 0.671292
  Training set accuracy = 0.815000, Test set accuracy = 0.820700
 epoch 24/30. Took 0.12534 seconds. 
  Full-batch training loss = 0.655064, test loss = 0.643367
  Training set accuracy = 0.821400, Test set accuracy = 0.826500
 epoch 25/30. Took 0.1233 seconds. 
  Full-batch training loss = 0.630616, test loss = 0.620179
  Training set accuracy = 0.828600, Test set accuracy = 0.830100
 epoch 26/30. Took 0.12615 seconds. 
  Full-batch training loss = 0.607953, test loss = 0.598573
  Training set accuracy = 0.834200, Test set accuracy = 0.838400
 epoch 27/30. Took 0.12643 seconds. 
  Full-batch training loss = 0.587707, test loss = 0.578435
  Training set accuracy = 0.839600, Test set accuracy = 0.841100
 epoch 28/30. Took 0.12625 seconds. 
  Full-batch training loss = 0.568120, test loss = 0.560905
  Training set accuracy = 0.845400, Test set accuracy = 0.848000
 epoch 29/30. Took 0.12626 seconds. 
  Full-batch training loss = 0.551092, test loss = 0.544874
  Training set accuracy = 0.851600, Test set accuracy = 0.855300
 epoch 30/30. Took 0.12617 seconds. 
  Full-batch training loss = 0.534495, test loss = 0.528689
  Training set accuracy = 0.854400, Test set accuracy = 0.857300
Elapsed time is 9.513234 seconds.
End Training
-----
Params 5000 0.001 0.00 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23095 seconds. 
  Full-batch training loss = 2.271772, test loss = 2.272378
  Training set accuracy = 0.174800, Test set accuracy = 0.179600
 epoch 2/30. Took 0.21993 seconds. 
  Full-batch training loss = 2.236657, test loss = 2.237323
  Training set accuracy = 0.305800, Test set accuracy = 0.307800
 epoch 3/30. Took 0.22569 seconds. 
  Full-batch training loss = 2.199918, test loss = 2.200400
  Training set accuracy = 0.414800, Test set accuracy = 0.424900
 epoch 4/30. Took 0.23822 seconds. 
  Full-batch training loss = 2.157922, test loss = 2.158187
  Training set accuracy = 0.483800, Test set accuracy = 0.487800
 epoch 5/30. Took 0.21804 seconds. 
  Full-batch training loss = 2.107913, test loss = 2.107861
  Training set accuracy = 0.523000, Test set accuracy = 0.533900
 epoch 6/30. Took 0.21779 seconds. 
  Full-batch training loss = 2.046961, test loss = 2.046499
  Training set accuracy = 0.555000, Test set accuracy = 0.561100
 epoch 7/30. Took 0.24363 seconds. 
  Full-batch training loss = 1.973268, test loss = 1.972059
  Training set accuracy = 0.599600, Test set accuracy = 0.596900
 epoch 8/30. Took 0.22645 seconds. 
  Full-batch training loss = 1.883521, test loss = 1.881420
  Training set accuracy = 0.626200, Test set accuracy = 0.626700
 epoch 9/30. Took 0.24838 seconds. 
  Full-batch training loss = 1.777254, test loss = 1.774378
  Training set accuracy = 0.648800, Test set accuracy = 0.646700
 epoch 10/30. Took 0.21761 seconds. 
  Full-batch training loss = 1.655772, test loss = 1.651721
  Training set accuracy = 0.672600, Test set accuracy = 0.672800
 epoch 11/30. Took 0.21818 seconds. 
  Full-batch training loss = 1.525482, test loss = 1.520671
  Training set accuracy = 0.686600, Test set accuracy = 0.687800
 epoch 12/30. Took 0.21678 seconds. 
  Full-batch training loss = 1.392963, test loss = 1.387250
  Training set accuracy = 0.713400, Test set accuracy = 0.712200
 epoch 13/30. Took 0.22092 seconds. 
  Full-batch training loss = 1.267124, test loss = 1.260569
  Training set accuracy = 0.733600, Test set accuracy = 0.732200
 epoch 14/30. Took 0.24126 seconds. 
  Full-batch training loss = 1.152543, test loss = 1.145806
  Training set accuracy = 0.748800, Test set accuracy = 0.751500
 epoch 15/30. Took 0.22083 seconds. 
  Full-batch training loss = 1.051964, test loss = 1.045771
  Training set accuracy = 0.771200, Test set accuracy = 0.771000
 epoch 16/30. Took 0.21718 seconds. 
  Full-batch training loss = 0.964911, test loss = 0.959192
  Training set accuracy = 0.785600, Test set accuracy = 0.786700
 epoch 17/30. Took 0.21825 seconds. 
  Full-batch training loss = 0.889640, test loss = 0.884074
  Training set accuracy = 0.804600, Test set accuracy = 0.804300
 epoch 18/30. Took 0.21962 seconds. 
  Full-batch training loss = 0.825145, test loss = 0.820747
  Training set accuracy = 0.815000, Test set accuracy = 0.814100
 epoch 19/30. Took 0.21649 seconds. 
  Full-batch training loss = 0.769272, test loss = 0.767335
  Training set accuracy = 0.823800, Test set accuracy = 0.819600
 epoch 20/30. Took 0.21851 seconds. 
  Full-batch training loss = 0.721477, test loss = 0.720043
  Training set accuracy = 0.834800, Test set accuracy = 0.828900
 epoch 21/30. Took 0.22761 seconds. 
  Full-batch training loss = 0.679878, test loss = 0.680661
  Training set accuracy = 0.842000, Test set accuracy = 0.836400
 epoch 22/30. Took 0.22129 seconds. 
  Full-batch training loss = 0.644550, test loss = 0.647040
  Training set accuracy = 0.845200, Test set accuracy = 0.839600
 epoch 23/30. Took 0.2188 seconds. 
  Full-batch training loss = 0.613570, test loss = 0.617061
  Training set accuracy = 0.851800, Test set accuracy = 0.845600
 epoch 24/30. Took 0.21882 seconds. 
  Full-batch training loss = 0.586314, test loss = 0.591590
  Training set accuracy = 0.859000, Test set accuracy = 0.851800
 epoch 25/30. Took 0.2183 seconds. 
  Full-batch training loss = 0.562756, test loss = 0.570379
  Training set accuracy = 0.860600, Test set accuracy = 0.855100
 epoch 26/30. Took 0.2353 seconds. 
  Full-batch training loss = 0.541150, test loss = 0.549186
  Training set accuracy = 0.868800, Test set accuracy = 0.857700
 epoch 27/30. Took 0.22106 seconds. 
  Full-batch training loss = 0.521071, test loss = 0.530768
  Training set accuracy = 0.873000, Test set accuracy = 0.861800
 epoch 28/30. Took 0.21832 seconds. 
  Full-batch training loss = 0.504238, test loss = 0.515783
  Training set accuracy = 0.873200, Test set accuracy = 0.865300
 epoch 29/30. Took 0.22108 seconds. 
  Full-batch training loss = 0.489205, test loss = 0.502348
  Training set accuracy = 0.878000, Test set accuracy = 0.867100
 epoch 30/30. Took 0.22137 seconds. 
  Full-batch training loss = 0.474404, test loss = 0.488622
  Training set accuracy = 0.881600, Test set accuracy = 0.870600
Elapsed time is 16.878094 seconds.
End Training
-----
Params 5000 0.001 0.00 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.74477 seconds. 
  Full-batch training loss = 2.252304, test loss = 2.251240
  Training set accuracy = 0.180600, Test set accuracy = 0.178200
 epoch 2/30. Took 0.69916 seconds. 
  Full-batch training loss = 2.190791, test loss = 2.189328
  Training set accuracy = 0.376000, Test set accuracy = 0.377600
 epoch 3/30. Took 0.73242 seconds. 
  Full-batch training loss = 2.122407, test loss = 2.120157
  Training set accuracy = 0.530200, Test set accuracy = 0.537800
 epoch 4/30. Took 0.69941 seconds. 
  Full-batch training loss = 2.042199, test loss = 2.039019
  Training set accuracy = 0.597800, Test set accuracy = 0.606100
 epoch 5/30. Took 0.70393 seconds. 
  Full-batch training loss = 1.944219, test loss = 1.939723
  Training set accuracy = 0.633000, Test set accuracy = 0.639700
 epoch 6/30. Took 0.70703 seconds. 
  Full-batch training loss = 1.825524, test loss = 1.819686
  Training set accuracy = 0.652000, Test set accuracy = 0.661200
 epoch 7/30. Took 0.70379 seconds. 
  Full-batch training loss = 1.687073, test loss = 1.679493
  Training set accuracy = 0.672600, Test set accuracy = 0.680200
 epoch 8/30. Took 0.70765 seconds. 
  Full-batch training loss = 1.536204, test loss = 1.527016
  Training set accuracy = 0.701600, Test set accuracy = 0.707600
 epoch 9/30. Took 0.70005 seconds. 
  Full-batch training loss = 1.383071, test loss = 1.371755
  Training set accuracy = 0.728800, Test set accuracy = 0.736500
 epoch 10/30. Took 0.70073 seconds. 
  Full-batch training loss = 1.238301, test loss = 1.225501
  Training set accuracy = 0.750600, Test set accuracy = 0.759700
 epoch 11/30. Took 0.72705 seconds. 
  Full-batch training loss = 1.110828, test loss = 1.097677
  Training set accuracy = 0.775400, Test set accuracy = 0.780100
 epoch 12/30. Took 0.70859 seconds. 
  Full-batch training loss = 1.002769, test loss = 0.988720
  Training set accuracy = 0.796200, Test set accuracy = 0.796900
 epoch 13/30. Took 0.7452 seconds. 
  Full-batch training loss = 0.912934, test loss = 0.899771
  Training set accuracy = 0.808800, Test set accuracy = 0.810200
 epoch 14/30. Took 0.70385 seconds. 
  Full-batch training loss = 0.839277, test loss = 0.826696
  Training set accuracy = 0.817400, Test set accuracy = 0.817200
 epoch 15/30. Took 0.69719 seconds. 
  Full-batch training loss = 0.778403, test loss = 0.767151
  Training set accuracy = 0.822800, Test set accuracy = 0.823000
 epoch 16/30. Took 0.69942 seconds. 
  Full-batch training loss = 0.727142, test loss = 0.716031
  Training set accuracy = 0.832000, Test set accuracy = 0.830200
 epoch 17/30. Took 0.7377 seconds. 
  Full-batch training loss = 0.685630, test loss = 0.675396
  Training set accuracy = 0.834400, Test set accuracy = 0.835000
 epoch 18/30. Took 0.73153 seconds. 
  Full-batch training loss = 0.647845, test loss = 0.638331
  Training set accuracy = 0.845000, Test set accuracy = 0.844400
 epoch 19/30. Took 0.69871 seconds. 
  Full-batch training loss = 0.616154, test loss = 0.606862
  Training set accuracy = 0.851000, Test set accuracy = 0.853800
 epoch 20/30. Took 0.69825 seconds. 
  Full-batch training loss = 0.588042, test loss = 0.579860
  Training set accuracy = 0.856200, Test set accuracy = 0.854700
 epoch 21/30. Took 0.70033 seconds. 
  Full-batch training loss = 0.563410, test loss = 0.555129
  Training set accuracy = 0.860600, Test set accuracy = 0.862600
 epoch 22/30. Took 0.70062 seconds. 
  Full-batch training loss = 0.542573, test loss = 0.535413
  Training set accuracy = 0.866600, Test set accuracy = 0.867400
 epoch 23/30. Took 0.70083 seconds. 
  Full-batch training loss = 0.522476, test loss = 0.516830
  Training set accuracy = 0.869600, Test set accuracy = 0.869400
 epoch 24/30. Took 0.72069 seconds. 
  Full-batch training loss = 0.506591, test loss = 0.501559
  Training set accuracy = 0.874800, Test set accuracy = 0.872600
 epoch 25/30. Took 0.70019 seconds. 
  Full-batch training loss = 0.489723, test loss = 0.486346
  Training set accuracy = 0.876200, Test set accuracy = 0.875000
 epoch 26/30. Took 0.70623 seconds. 
  Full-batch training loss = 0.475244, test loss = 0.472603
  Training set accuracy = 0.880200, Test set accuracy = 0.879300
 epoch 27/30. Took 0.70169 seconds. 
  Full-batch training loss = 0.462918, test loss = 0.461249
  Training set accuracy = 0.881000, Test set accuracy = 0.881200
 epoch 28/30. Took 0.70143 seconds. 
  Full-batch training loss = 0.450412, test loss = 0.449125
  Training set accuracy = 0.885800, Test set accuracy = 0.883100
 epoch 29/30. Took 0.70105 seconds. 
  Full-batch training loss = 0.439273, test loss = 0.439508
  Training set accuracy = 0.887600, Test set accuracy = 0.887100
 epoch 30/30. Took 0.70083 seconds. 
  Full-batch training loss = 0.429501, test loss = 0.429140
  Training set accuracy = 0.891200, Test set accuracy = 0.889100
Elapsed time is 46.417812 seconds.
End Training
-----
Params 5000 0.001 0.10 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11747 seconds. 
  Full-batch training loss = 2.243516, test loss = 2.246289
  Training set accuracy = 0.142800, Test set accuracy = 0.138500
 epoch 2/30. Took 0.10797 seconds. 
  Full-batch training loss = 2.145782, test loss = 2.147534
  Training set accuracy = 0.246200, Test set accuracy = 0.239800
 epoch 3/30. Took 0.10876 seconds. 
  Full-batch training loss = 2.050687, test loss = 2.051218
  Training set accuracy = 0.409600, Test set accuracy = 0.410500
 epoch 4/30. Took 0.11034 seconds. 
  Full-batch training loss = 1.953068, test loss = 1.952418
  Training set accuracy = 0.550400, Test set accuracy = 0.547700
 epoch 5/30. Took 0.1096 seconds. 
  Full-batch training loss = 1.853175, test loss = 1.851540
  Training set accuracy = 0.619400, Test set accuracy = 0.619800
 epoch 6/30. Took 0.10994 seconds. 
  Full-batch training loss = 1.753561, test loss = 1.750560
  Training set accuracy = 0.659200, Test set accuracy = 0.661700
 epoch 7/30. Took 0.10917 seconds. 
  Full-batch training loss = 1.655021, test loss = 1.650440
  Training set accuracy = 0.686000, Test set accuracy = 0.690700
 epoch 8/30. Took 0.10932 seconds. 
  Full-batch training loss = 1.560411, test loss = 1.554874
  Training set accuracy = 0.704200, Test set accuracy = 0.711200
 epoch 9/30. Took 0.10883 seconds. 
  Full-batch training loss = 1.470762, test loss = 1.464308
  Training set accuracy = 0.723400, Test set accuracy = 0.729700
 epoch 10/30. Took 0.10522 seconds. 
  Full-batch training loss = 1.386485, test loss = 1.378851
  Training set accuracy = 0.742200, Test set accuracy = 0.748800
 epoch 11/30. Took 0.10863 seconds. 
  Full-batch training loss = 1.309055, test loss = 1.300771
  Training set accuracy = 0.755400, Test set accuracy = 0.759900
 epoch 12/30. Took 0.1091 seconds. 
  Full-batch training loss = 1.237746, test loss = 1.228622
  Training set accuracy = 0.771400, Test set accuracy = 0.781100
 epoch 13/30. Took 0.10921 seconds. 
  Full-batch training loss = 1.172850, test loss = 1.163347
  Training set accuracy = 0.782000, Test set accuracy = 0.793800
 epoch 14/30. Took 0.11292 seconds. 
  Full-batch training loss = 1.113978, test loss = 1.104228
  Training set accuracy = 0.795400, Test set accuracy = 0.802900
 epoch 15/30. Took 0.10882 seconds. 
  Full-batch training loss = 1.060523, test loss = 1.050510
  Training set accuracy = 0.801000, Test set accuracy = 0.808500
 epoch 16/30. Took 0.10728 seconds. 
  Full-batch training loss = 1.012048, test loss = 1.002188
  Training set accuracy = 0.812600, Test set accuracy = 0.817000
 epoch 17/30. Took 0.10899 seconds. 
  Full-batch training loss = 0.968509, test loss = 0.958541
  Training set accuracy = 0.818200, Test set accuracy = 0.823800
 epoch 18/30. Took 0.10708 seconds. 
  Full-batch training loss = 0.928602, test loss = 0.918733
  Training set accuracy = 0.824400, Test set accuracy = 0.829100
 epoch 19/30. Took 0.10851 seconds. 
  Full-batch training loss = 0.892691, test loss = 0.882920
  Training set accuracy = 0.831600, Test set accuracy = 0.835700
 epoch 20/30. Took 0.10542 seconds. 
  Full-batch training loss = 0.860032, test loss = 0.850192
  Training set accuracy = 0.836000, Test set accuracy = 0.839600
 epoch 21/30. Took 0.10595 seconds. 
  Full-batch training loss = 0.830371, test loss = 0.821058
  Training set accuracy = 0.839400, Test set accuracy = 0.841700
 epoch 22/30. Took 0.10615 seconds. 
  Full-batch training loss = 0.803407, test loss = 0.794409
  Training set accuracy = 0.842000, Test set accuracy = 0.843200
 epoch 23/30. Took 0.10837 seconds. 
  Full-batch training loss = 0.778828, test loss = 0.770034
  Training set accuracy = 0.845000, Test set accuracy = 0.845300
 epoch 24/30. Took 0.11019 seconds. 
  Full-batch training loss = 0.756076, test loss = 0.747558
  Training set accuracy = 0.844800, Test set accuracy = 0.847500
 epoch 25/30. Took 0.10981 seconds. 
  Full-batch training loss = 0.735187, test loss = 0.726998
  Training set accuracy = 0.847200, Test set accuracy = 0.849800
 epoch 26/30. Took 0.11004 seconds. 
  Full-batch training loss = 0.716050, test loss = 0.708127
  Training set accuracy = 0.850800, Test set accuracy = 0.851600
 epoch 27/30. Took 0.10884 seconds. 
  Full-batch training loss = 0.698334, test loss = 0.690557
  Training set accuracy = 0.852200, Test set accuracy = 0.853100
 epoch 28/30. Took 0.10872 seconds. 
  Full-batch training loss = 0.681928, test loss = 0.674745
  Training set accuracy = 0.852800, Test set accuracy = 0.854900
 epoch 29/30. Took 0.10941 seconds. 
  Full-batch training loss = 0.666524, test loss = 0.659636
  Training set accuracy = 0.855400, Test set accuracy = 0.856300
 epoch 30/30. Took 0.10913 seconds. 
  Full-batch training loss = 0.652223, test loss = 0.645418
  Training set accuracy = 0.856600, Test set accuracy = 0.857900
Elapsed time is 8.004860 seconds.
End Training
-----
Params 5000 0.001 0.10 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17498 seconds. 
  Full-batch training loss = 2.204395, test loss = 2.206700
  Training set accuracy = 0.283000, Test set accuracy = 0.273500
 epoch 2/30. Took 0.17716 seconds. 
  Full-batch training loss = 2.093872, test loss = 2.094991
  Training set accuracy = 0.502600, Test set accuracy = 0.490700
 epoch 3/30. Took 0.16712 seconds. 
  Full-batch training loss = 1.987884, test loss = 1.987758
  Training set accuracy = 0.603400, Test set accuracy = 0.597800
 epoch 4/30. Took 0.16873 seconds. 
  Full-batch training loss = 1.882521, test loss = 1.880957
  Training set accuracy = 0.652400, Test set accuracy = 0.646100
 epoch 5/30. Took 0.16935 seconds. 
  Full-batch training loss = 1.776848, test loss = 1.773653
  Training set accuracy = 0.683000, Test set accuracy = 0.681200
 epoch 6/30. Took 0.16864 seconds. 
  Full-batch training loss = 1.671647, test loss = 1.666785
  Training set accuracy = 0.707200, Test set accuracy = 0.706800
 epoch 7/30. Took 0.16916 seconds. 
  Full-batch training loss = 1.569495, test loss = 1.563072
  Training set accuracy = 0.732600, Test set accuracy = 0.731700
 epoch 8/30. Took 0.16299 seconds. 
  Full-batch training loss = 1.471835, test loss = 1.463811
  Training set accuracy = 0.751000, Test set accuracy = 0.747400
 epoch 9/30. Took 0.17924 seconds. 
  Full-batch training loss = 1.380239, test loss = 1.371211
  Training set accuracy = 0.765000, Test set accuracy = 0.763600
 epoch 10/30. Took 0.1651 seconds. 
  Full-batch training loss = 1.295735, test loss = 1.285480
  Training set accuracy = 0.779800, Test set accuracy = 0.781700
 epoch 11/30. Took 0.16286 seconds. 
  Full-batch training loss = 1.218650, test loss = 1.207405
  Training set accuracy = 0.789400, Test set accuracy = 0.792300
 epoch 12/30. Took 0.16333 seconds. 
  Full-batch training loss = 1.148856, test loss = 1.136904
  Training set accuracy = 0.797800, Test set accuracy = 0.799400
 epoch 13/30. Took 0.16431 seconds. 
  Full-batch training loss = 1.086270, test loss = 1.073788
  Training set accuracy = 0.806600, Test set accuracy = 0.806800
 epoch 14/30. Took 0.18781 seconds. 
  Full-batch training loss = 1.030033, test loss = 1.016989
  Training set accuracy = 0.813000, Test set accuracy = 0.814800
 epoch 15/30. Took 0.16784 seconds. 
  Full-batch training loss = 0.979916, test loss = 0.966631
  Training set accuracy = 0.819200, Test set accuracy = 0.820200
 epoch 16/30. Took 0.16929 seconds. 
  Full-batch training loss = 0.934810, test loss = 0.921625
  Training set accuracy = 0.824200, Test set accuracy = 0.825000
 epoch 17/30. Took 0.16857 seconds. 
  Full-batch training loss = 0.894501, test loss = 0.881397
  Training set accuracy = 0.828600, Test set accuracy = 0.829300
 epoch 18/30. Took 0.16665 seconds. 
  Full-batch training loss = 0.858229, test loss = 0.845277
  Training set accuracy = 0.831400, Test set accuracy = 0.833500
 epoch 19/30. Took 0.1685 seconds. 
  Full-batch training loss = 0.825467, test loss = 0.812778
  Training set accuracy = 0.836000, Test set accuracy = 0.837100
 epoch 20/30. Took 0.16923 seconds. 
  Full-batch training loss = 0.795880, test loss = 0.783337
  Training set accuracy = 0.840000, Test set accuracy = 0.840700
 epoch 21/30. Took 0.16369 seconds. 
  Full-batch training loss = 0.769071, test loss = 0.757046
  Training set accuracy = 0.843600, Test set accuracy = 0.844600
 epoch 22/30. Took 0.16286 seconds. 
  Full-batch training loss = 0.744632, test loss = 0.733242
  Training set accuracy = 0.846000, Test set accuracy = 0.846600
 epoch 23/30. Took 0.1668 seconds. 
  Full-batch training loss = 0.722175, test loss = 0.711211
  Training set accuracy = 0.850400, Test set accuracy = 0.851200
 epoch 24/30. Took 0.16704 seconds. 
  Full-batch training loss = 0.701744, test loss = 0.691001
  Training set accuracy = 0.851800, Test set accuracy = 0.853700
 epoch 25/30. Took 0.16359 seconds. 
  Full-batch training loss = 0.682948, test loss = 0.672599
  Training set accuracy = 0.856000, Test set accuracy = 0.856900
 epoch 26/30. Took 0.16618 seconds. 
  Full-batch training loss = 0.665437, test loss = 0.655916
  Training set accuracy = 0.856800, Test set accuracy = 0.857600
 epoch 27/30. Took 0.16414 seconds. 
  Full-batch training loss = 0.649471, test loss = 0.640775
  Training set accuracy = 0.858600, Test set accuracy = 0.858500
 epoch 28/30. Took 0.1661 seconds. 
  Full-batch training loss = 0.634599, test loss = 0.626497
  Training set accuracy = 0.859400, Test set accuracy = 0.860800
 epoch 29/30. Took 0.16873 seconds. 
  Full-batch training loss = 0.620695, test loss = 0.613287
  Training set accuracy = 0.860800, Test set accuracy = 0.863300
 epoch 30/30. Took 0.16795 seconds. 
  Full-batch training loss = 0.607734, test loss = 0.600685
  Training set accuracy = 0.864200, Test set accuracy = 0.865500
Elapsed time is 11.621943 seconds.
End Training
-----
Params 5000 0.001 0.10 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.3648 seconds. 
  Full-batch training loss = 2.194686, test loss = 2.195638
  Training set accuracy = 0.224200, Test set accuracy = 0.227800
 epoch 2/30. Took 0.36168 seconds. 
  Full-batch training loss = 2.057039, test loss = 2.057511
  Training set accuracy = 0.486200, Test set accuracy = 0.483000
 epoch 3/30. Took 0.35718 seconds. 
  Full-batch training loss = 1.926713, test loss = 1.926965
  Training set accuracy = 0.607600, Test set accuracy = 0.600000
 epoch 4/30. Took 0.35764 seconds. 
  Full-batch training loss = 1.801534, test loss = 1.801570
  Training set accuracy = 0.670600, Test set accuracy = 0.667900
 epoch 5/30. Took 0.36155 seconds. 
  Full-batch training loss = 1.681317, test loss = 1.681168
  Training set accuracy = 0.703400, Test set accuracy = 0.707300
 epoch 6/30. Took 0.38727 seconds. 
  Full-batch training loss = 1.567652, test loss = 1.567310
  Training set accuracy = 0.731600, Test set accuracy = 0.732900
 epoch 7/30. Took 0.35323 seconds. 
  Full-batch training loss = 1.461988, test loss = 1.461445
  Training set accuracy = 0.747400, Test set accuracy = 0.751400
 epoch 8/30. Took 0.35529 seconds. 
  Full-batch training loss = 1.364745, test loss = 1.363993
  Training set accuracy = 0.764200, Test set accuracy = 0.767600
 epoch 9/30. Took 0.37492 seconds. 
  Full-batch training loss = 1.276298, test loss = 1.275401
  Training set accuracy = 0.777200, Test set accuracy = 0.781500
 epoch 10/30. Took 0.35745 seconds. 
  Full-batch training loss = 1.196811, test loss = 1.195843
  Training set accuracy = 0.791000, Test set accuracy = 0.795100
 epoch 11/30. Took 0.35749 seconds. 
  Full-batch training loss = 1.126115, test loss = 1.125091
  Training set accuracy = 0.803400, Test set accuracy = 0.804200
 epoch 12/30. Took 0.36034 seconds. 
  Full-batch training loss = 1.062729, test loss = 1.061816
  Training set accuracy = 0.812000, Test set accuracy = 0.813000
 epoch 13/30. Took 0.35738 seconds. 
  Full-batch training loss = 1.006565, test loss = 1.005620
  Training set accuracy = 0.818200, Test set accuracy = 0.816400
 epoch 14/30. Took 0.35713 seconds. 
  Full-batch training loss = 0.956679, test loss = 0.955859
  Training set accuracy = 0.825400, Test set accuracy = 0.821400
 epoch 15/30. Took 0.37307 seconds. 
  Full-batch training loss = 0.912367, test loss = 0.911549
  Training set accuracy = 0.829400, Test set accuracy = 0.826500
 epoch 16/30. Took 0.36592 seconds. 
  Full-batch training loss = 0.872717, test loss = 0.872188
  Training set accuracy = 0.834000, Test set accuracy = 0.831200
 epoch 17/30. Took 0.35778 seconds. 
  Full-batch training loss = 0.837226, test loss = 0.836916
  Training set accuracy = 0.838000, Test set accuracy = 0.835700
 epoch 18/30. Took 0.35734 seconds. 
  Full-batch training loss = 0.805257, test loss = 0.805168
  Training set accuracy = 0.842200, Test set accuracy = 0.838600
 epoch 19/30. Took 0.35784 seconds. 
  Full-batch training loss = 0.776370, test loss = 0.776436
  Training set accuracy = 0.844200, Test set accuracy = 0.841200
 epoch 20/30. Took 0.36478 seconds. 
  Full-batch training loss = 0.750289, test loss = 0.750530
  Training set accuracy = 0.849000, Test set accuracy = 0.845400
 epoch 21/30. Took 0.35435 seconds. 
  Full-batch training loss = 0.726533, test loss = 0.727180
  Training set accuracy = 0.851600, Test set accuracy = 0.848500
 epoch 22/30. Took 0.35886 seconds. 
  Full-batch training loss = 0.704767, test loss = 0.705673
  Training set accuracy = 0.853600, Test set accuracy = 0.850700
 epoch 23/30. Took 0.35459 seconds. 
  Full-batch training loss = 0.684797, test loss = 0.685938
  Training set accuracy = 0.857800, Test set accuracy = 0.853800
 epoch 24/30. Took 0.37161 seconds. 
  Full-batch training loss = 0.666499, test loss = 0.667839
  Training set accuracy = 0.858600, Test set accuracy = 0.855700
 epoch 25/30. Took 0.3573 seconds. 
  Full-batch training loss = 0.649534, test loss = 0.651139
  Training set accuracy = 0.860800, Test set accuracy = 0.857200
 epoch 26/30. Took 0.35449 seconds. 
  Full-batch training loss = 0.633833, test loss = 0.635730
  Training set accuracy = 0.862600, Test set accuracy = 0.860000
 epoch 27/30. Took 0.35695 seconds. 
  Full-batch training loss = 0.619281, test loss = 0.621639
  Training set accuracy = 0.864400, Test set accuracy = 0.861900
 epoch 28/30. Took 0.35648 seconds. 
  Full-batch training loss = 0.605750, test loss = 0.608360
  Training set accuracy = 0.866000, Test set accuracy = 0.862900
 epoch 29/30. Took 0.35046 seconds. 
  Full-batch training loss = 0.593189, test loss = 0.596121
  Training set accuracy = 0.868200, Test set accuracy = 0.864500
 epoch 30/30. Took 0.35313 seconds. 
  Full-batch training loss = 0.581397, test loss = 0.584673
  Training set accuracy = 0.869600, Test set accuracy = 0.866400
Elapsed time is 23.541718 seconds.
End Training
-----
Params 5000 0.001 0.10 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14031 seconds. 
  Full-batch training loss = 2.289273, test loss = 2.292643
  Training set accuracy = 0.114000, Test set accuracy = 0.093500
 epoch 2/30. Took 0.13047 seconds. 
  Full-batch training loss = 2.257346, test loss = 2.259712
  Training set accuracy = 0.163200, Test set accuracy = 0.147700
 epoch 3/30. Took 0.13547 seconds. 
  Full-batch training loss = 2.223221, test loss = 2.224580
  Training set accuracy = 0.242200, Test set accuracy = 0.229700
 epoch 4/30. Took 0.12913 seconds. 
  Full-batch training loss = 2.184876, test loss = 2.185375
  Training set accuracy = 0.357600, Test set accuracy = 0.349200
 epoch 5/30. Took 0.1365 seconds. 
  Full-batch training loss = 2.142153, test loss = 2.141667
  Training set accuracy = 0.431400, Test set accuracy = 0.427100
 epoch 6/30. Took 0.1343 seconds. 
  Full-batch training loss = 2.095088, test loss = 2.093473
  Training set accuracy = 0.478600, Test set accuracy = 0.476400
 epoch 7/30. Took 0.12888 seconds. 
  Full-batch training loss = 2.041055, test loss = 2.038342
  Training set accuracy = 0.517600, Test set accuracy = 0.511000
 epoch 8/30. Took 0.1294 seconds. 
  Full-batch training loss = 1.979895, test loss = 1.976061
  Training set accuracy = 0.552400, Test set accuracy = 0.549300
 epoch 9/30. Took 0.12928 seconds. 
  Full-batch training loss = 1.911309, test loss = 1.905942
  Training set accuracy = 0.590600, Test set accuracy = 0.584400
 epoch 10/30. Took 0.12906 seconds. 
  Full-batch training loss = 1.836717, test loss = 1.829677
  Training set accuracy = 0.621200, Test set accuracy = 0.615500
 epoch 11/30. Took 0.13126 seconds. 
  Full-batch training loss = 1.758374, test loss = 1.749436
  Training set accuracy = 0.651400, Test set accuracy = 0.645300
 epoch 12/30. Took 0.13464 seconds. 
  Full-batch training loss = 1.677274, test loss = 1.666265
  Training set accuracy = 0.680800, Test set accuracy = 0.674600
 epoch 13/30. Took 0.13373 seconds. 
  Full-batch training loss = 1.594967, test loss = 1.582043
  Training set accuracy = 0.705800, Test set accuracy = 0.703100
 epoch 14/30. Took 0.12996 seconds. 
  Full-batch training loss = 1.512389, test loss = 1.497908
  Training set accuracy = 0.722800, Test set accuracy = 0.722500
 epoch 15/30. Took 0.13779 seconds. 
  Full-batch training loss = 1.431318, test loss = 1.415226
  Training set accuracy = 0.743000, Test set accuracy = 0.741800
 epoch 16/30. Took 0.14664 seconds. 
  Full-batch training loss = 1.352480, test loss = 1.334872
  Training set accuracy = 0.755400, Test set accuracy = 0.754300
 epoch 17/30. Took 0.1345 seconds. 
  Full-batch training loss = 1.276310, test loss = 1.257768
  Training set accuracy = 0.762400, Test set accuracy = 0.766500
 epoch 18/30. Took 0.14212 seconds. 
  Full-batch training loss = 1.204297, test loss = 1.184365
  Training set accuracy = 0.772200, Test set accuracy = 0.775300
 epoch 19/30. Took 0.14106 seconds. 
  Full-batch training loss = 1.137445, test loss = 1.116898
  Training set accuracy = 0.777200, Test set accuracy = 0.785000
 epoch 20/30. Took 0.13554 seconds. 
  Full-batch training loss = 1.075448, test loss = 1.054621
  Training set accuracy = 0.785200, Test set accuracy = 0.792600
 epoch 21/30. Took 0.13658 seconds. 
  Full-batch training loss = 1.019063, test loss = 0.997694
  Training set accuracy = 0.791200, Test set accuracy = 0.798200
 epoch 22/30. Took 0.13667 seconds. 
  Full-batch training loss = 0.967525, test loss = 0.946179
  Training set accuracy = 0.798000, Test set accuracy = 0.802700
 epoch 23/30. Took 0.13641 seconds. 
  Full-batch training loss = 0.921172, test loss = 0.900369
  Training set accuracy = 0.803600, Test set accuracy = 0.808800
 epoch 24/30. Took 0.13635 seconds. 
  Full-batch training loss = 0.879443, test loss = 0.858811
  Training set accuracy = 0.810400, Test set accuracy = 0.815200
 epoch 25/30. Took 0.13626 seconds. 
  Full-batch training loss = 0.841721, test loss = 0.821307
  Training set accuracy = 0.817400, Test set accuracy = 0.820600
 epoch 26/30. Took 0.13648 seconds. 
  Full-batch training loss = 0.807735, test loss = 0.787843
  Training set accuracy = 0.822800, Test set accuracy = 0.822900
 epoch 27/30. Took 0.13591 seconds. 
  Full-batch training loss = 0.777209, test loss = 0.757919
  Training set accuracy = 0.827000, Test set accuracy = 0.827700
 epoch 28/30. Took 0.13611 seconds. 
  Full-batch training loss = 0.749602, test loss = 0.730761
  Training set accuracy = 0.829800, Test set accuracy = 0.830000
 epoch 29/30. Took 0.13577 seconds. 
  Full-batch training loss = 0.724007, test loss = 0.706191
  Training set accuracy = 0.834600, Test set accuracy = 0.835600
 epoch 30/30. Took 0.14125 seconds. 
  Full-batch training loss = 0.701358, test loss = 0.683760
  Training set accuracy = 0.836400, Test set accuracy = 0.838100
Elapsed time is 9.518639 seconds.
End Training
-----
Params 5000 0.001 0.10 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.2476 seconds. 
  Full-batch training loss = 2.278040, test loss = 2.281785
  Training set accuracy = 0.197600, Test set accuracy = 0.193800
 epoch 2/30. Took 0.24033 seconds. 
  Full-batch training loss = 2.232688, test loss = 2.235648
  Training set accuracy = 0.316400, Test set accuracy = 0.313500
 epoch 3/30. Took 0.22847 seconds. 
  Full-batch training loss = 2.187344, test loss = 2.189826
  Training set accuracy = 0.398800, Test set accuracy = 0.385800
 epoch 4/30. Took 0.22656 seconds. 
  Full-batch training loss = 2.138940, test loss = 2.140871
  Training set accuracy = 0.464600, Test set accuracy = 0.458000
 epoch 5/30. Took 0.22081 seconds. 
  Full-batch training loss = 2.084971, test loss = 2.086379
  Training set accuracy = 0.524200, Test set accuracy = 0.518500
 epoch 6/30. Took 0.2227 seconds. 
  Full-batch training loss = 2.024898, test loss = 2.025841
  Training set accuracy = 0.572600, Test set accuracy = 0.562500
 epoch 7/30. Took 0.22877 seconds. 
  Full-batch training loss = 1.957786, test loss = 1.958203
  Training set accuracy = 0.601400, Test set accuracy = 0.596800
 epoch 8/30. Took 0.22727 seconds. 
  Full-batch training loss = 1.882391, test loss = 1.882445
  Training set accuracy = 0.628600, Test set accuracy = 0.619800
 epoch 9/30. Took 0.22723 seconds. 
  Full-batch training loss = 1.800250, test loss = 1.799617
  Training set accuracy = 0.655400, Test set accuracy = 0.648500
 epoch 10/30. Took 0.22809 seconds. 
  Full-batch training loss = 1.711166, test loss = 1.710153
  Training set accuracy = 0.671200, Test set accuracy = 0.667500
 epoch 11/30. Took 0.23011 seconds. 
  Full-batch training loss = 1.617862, test loss = 1.616313
  Training set accuracy = 0.689600, Test set accuracy = 0.685100
 epoch 12/30. Took 0.22645 seconds. 
  Full-batch training loss = 1.521966, test loss = 1.519887
  Training set accuracy = 0.709400, Test set accuracy = 0.704700
 epoch 13/30. Took 0.2272 seconds. 
  Full-batch training loss = 1.426658, test loss = 1.424334
  Training set accuracy = 0.729200, Test set accuracy = 0.722500
 epoch 14/30. Took 0.23595 seconds. 
  Full-batch training loss = 1.334047, test loss = 1.331437
  Training set accuracy = 0.742800, Test set accuracy = 0.740200
 epoch 15/30. Took 0.22358 seconds. 
  Full-batch training loss = 1.246581, test loss = 1.243974
  Training set accuracy = 0.754800, Test set accuracy = 0.754000
 epoch 16/30. Took 0.23092 seconds. 
  Full-batch training loss = 1.165312, test loss = 1.162242
  Training set accuracy = 0.774400, Test set accuracy = 0.770700
 epoch 17/30. Took 0.22827 seconds. 
  Full-batch training loss = 1.090788, test loss = 1.087975
  Training set accuracy = 0.789000, Test set accuracy = 0.785100
 epoch 18/30. Took 0.22715 seconds. 
  Full-batch training loss = 1.023149, test loss = 1.020886
  Training set accuracy = 0.802200, Test set accuracy = 0.796900
 epoch 19/30. Took 0.2271 seconds. 
  Full-batch training loss = 0.961870, test loss = 0.959624
  Training set accuracy = 0.810600, Test set accuracy = 0.808100
 epoch 20/30. Took 0.22774 seconds. 
  Full-batch training loss = 0.907239, test loss = 0.905119
  Training set accuracy = 0.821600, Test set accuracy = 0.817800
 epoch 21/30. Took 0.22758 seconds. 
  Full-batch training loss = 0.858446, test loss = 0.857008
  Training set accuracy = 0.825000, Test set accuracy = 0.823300
 epoch 22/30. Took 0.23593 seconds. 
  Full-batch training loss = 0.814924, test loss = 0.814211
  Training set accuracy = 0.833600, Test set accuracy = 0.829400
 epoch 23/30. Took 0.23573 seconds. 
  Full-batch training loss = 0.776378, test loss = 0.776220
  Training set accuracy = 0.835200, Test set accuracy = 0.833700
 epoch 24/30. Took 0.23293 seconds. 
  Full-batch training loss = 0.741632, test loss = 0.742557
  Training set accuracy = 0.843800, Test set accuracy = 0.839700
 epoch 25/30. Took 0.22654 seconds. 
  Full-batch training loss = 0.710517, test loss = 0.711982
  Training set accuracy = 0.848000, Test set accuracy = 0.843200
 epoch 26/30. Took 0.24733 seconds. 
  Full-batch training loss = 0.682659, test loss = 0.684979
  Training set accuracy = 0.851400, Test set accuracy = 0.847100
 epoch 27/30. Took 0.22285 seconds. 
  Full-batch training loss = 0.657520, test loss = 0.660332
  Training set accuracy = 0.857000, Test set accuracy = 0.851000
 epoch 28/30. Took 0.2282 seconds. 
  Full-batch training loss = 0.634801, test loss = 0.639092
  Training set accuracy = 0.855600, Test set accuracy = 0.851500
 epoch 29/30. Took 0.22746 seconds. 
  Full-batch training loss = 0.613834, test loss = 0.618624
  Training set accuracy = 0.860600, Test set accuracy = 0.856700
 epoch 30/30. Took 0.23142 seconds. 
  Full-batch training loss = 0.595272, test loss = 0.601550
  Training set accuracy = 0.862200, Test set accuracy = 0.856900
Elapsed time is 15.246327 seconds.
End Training
-----
Params 5000 0.001 0.10 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.62347 seconds. 
  Full-batch training loss = 2.241475, test loss = 2.243229
  Training set accuracy = 0.230600, Test set accuracy = 0.232700
 epoch 2/30. Took 0.58799 seconds. 
  Full-batch training loss = 2.178134, test loss = 2.178718
  Training set accuracy = 0.429800, Test set accuracy = 0.432600
 epoch 3/30. Took 0.60624 seconds. 
  Full-batch training loss = 2.112503, test loss = 2.112134
  Training set accuracy = 0.521400, Test set accuracy = 0.530400
 epoch 4/30. Took 0.59012 seconds. 
  Full-batch training loss = 2.042050, test loss = 2.040489
  Training set accuracy = 0.600600, Test set accuracy = 0.601100
 epoch 5/30. Took 0.59043 seconds. 
  Full-batch training loss = 1.964623, test loss = 1.961908
  Training set accuracy = 0.641800, Test set accuracy = 0.643900
 epoch 6/30. Took 0.66132 seconds. 
  Full-batch training loss = 1.879789, test loss = 1.875602
  Training set accuracy = 0.675400, Test set accuracy = 0.681400
 epoch 7/30. Took 0.6098 seconds. 
  Full-batch training loss = 1.786178, test loss = 1.780355
  Training set accuracy = 0.704000, Test set accuracy = 0.705200
 epoch 8/30. Took 0.58913 seconds. 
  Full-batch training loss = 1.686291, test loss = 1.678743
  Training set accuracy = 0.722000, Test set accuracy = 0.728200
 epoch 9/30. Took 0.59251 seconds. 
  Full-batch training loss = 1.581444, test loss = 1.572130
  Training set accuracy = 0.735800, Test set accuracy = 0.739700
 epoch 10/30. Took 0.61455 seconds. 
  Full-batch training loss = 1.474877, test loss = 1.464267
  Training set accuracy = 0.744800, Test set accuracy = 0.749300
 epoch 11/30. Took 0.60698 seconds. 
  Full-batch training loss = 1.371051, test loss = 1.359200
  Training set accuracy = 0.756400, Test set accuracy = 0.760500
 epoch 12/30. Took 0.63663 seconds. 
  Full-batch training loss = 1.273035, test loss = 1.259984
  Training set accuracy = 0.769000, Test set accuracy = 0.771000
 epoch 13/30. Took 0.60808 seconds. 
  Full-batch training loss = 1.182441, test loss = 1.168685
  Training set accuracy = 0.780000, Test set accuracy = 0.783300
 epoch 14/30. Took 0.58811 seconds. 
  Full-batch training loss = 1.100782, test loss = 1.086416
  Training set accuracy = 0.787400, Test set accuracy = 0.792300
 epoch 15/30. Took 0.58837 seconds. 
  Full-batch training loss = 1.027746, test loss = 1.013505
  Training set accuracy = 0.797000, Test set accuracy = 0.804800
 epoch 16/30. Took 0.6026 seconds. 
  Full-batch training loss = 0.963596, test loss = 0.949567
  Training set accuracy = 0.807600, Test set accuracy = 0.810500
 epoch 17/30. Took 0.58545 seconds. 
  Full-batch training loss = 0.907045, test loss = 0.893298
  Training set accuracy = 0.817200, Test set accuracy = 0.818600
 epoch 18/30. Took 0.59286 seconds. 
  Full-batch training loss = 0.857313, test loss = 0.843733
  Training set accuracy = 0.822200, Test set accuracy = 0.822300
 epoch 19/30. Took 0.62486 seconds. 
  Full-batch training loss = 0.813495, test loss = 0.800076
  Training set accuracy = 0.827800, Test set accuracy = 0.827700
 epoch 20/30. Took 0.61649 seconds. 
  Full-batch training loss = 0.774967, test loss = 0.762343
  Training set accuracy = 0.832800, Test set accuracy = 0.833700
 epoch 21/30. Took 0.5885 seconds. 
  Full-batch training loss = 0.740909, test loss = 0.728050
  Training set accuracy = 0.837600, Test set accuracy = 0.837300
 epoch 22/30. Took 0.58743 seconds. 
  Full-batch training loss = 0.710003, test loss = 0.697854
  Training set accuracy = 0.840000, Test set accuracy = 0.840200
 epoch 23/30. Took 0.59069 seconds. 
  Full-batch training loss = 0.682925, test loss = 0.671317
  Training set accuracy = 0.844400, Test set accuracy = 0.844600
 epoch 24/30. Took 0.60697 seconds. 
  Full-batch training loss = 0.658775, test loss = 0.647384
  Training set accuracy = 0.844200, Test set accuracy = 0.846100
 epoch 25/30. Took 0.59107 seconds. 
  Full-batch training loss = 0.636811, test loss = 0.626034
  Training set accuracy = 0.849600, Test set accuracy = 0.849900
 epoch 26/30. Took 0.62233 seconds. 
  Full-batch training loss = 0.617153, test loss = 0.606781
  Training set accuracy = 0.854400, Test set accuracy = 0.853600
 epoch 27/30. Took 0.58645 seconds. 
  Full-batch training loss = 0.599013, test loss = 0.588357
  Training set accuracy = 0.855400, Test set accuracy = 0.857800
 epoch 28/30. Took 0.63199 seconds. 
  Full-batch training loss = 0.582559, test loss = 0.572587
  Training set accuracy = 0.859000, Test set accuracy = 0.860600
 epoch 29/30. Took 0.58829 seconds. 
  Full-batch training loss = 0.567606, test loss = 0.557623
  Training set accuracy = 0.861200, Test set accuracy = 0.863700
 epoch 30/30. Took 0.58912 seconds. 
  Full-batch training loss = 0.554020, test loss = 0.544658
  Training set accuracy = 0.861200, Test set accuracy = 0.863900
Elapsed time is 38.175561 seconds.
End Training
-----
Params 5000 0.001 0.10 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.1694 seconds. 
  Full-batch training loss = 2.287057, test loss = 2.287636
  Training set accuracy = 0.122800, Test set accuracy = 0.134100
 epoch 2/30. Took 0.16613 seconds. 
  Full-batch training loss = 2.271360, test loss = 2.271930
  Training set accuracy = 0.208000, Test set accuracy = 0.220700
 epoch 3/30. Took 0.16142 seconds. 
  Full-batch training loss = 2.254900, test loss = 2.255488
  Training set accuracy = 0.289000, Test set accuracy = 0.291700
 epoch 4/30. Took 0.1678 seconds. 
  Full-batch training loss = 2.237112, test loss = 2.237666
  Training set accuracy = 0.337600, Test set accuracy = 0.339000
 epoch 5/30. Took 0.16229 seconds. 
  Full-batch training loss = 2.216594, test loss = 2.217382
  Training set accuracy = 0.365600, Test set accuracy = 0.366800
 epoch 6/30. Took 0.16189 seconds. 
  Full-batch training loss = 2.192836, test loss = 2.193963
  Training set accuracy = 0.388000, Test set accuracy = 0.385600
 epoch 7/30. Took 0.15574 seconds. 
  Full-batch training loss = 2.164625, test loss = 2.166349
  Training set accuracy = 0.409600, Test set accuracy = 0.408100
 epoch 8/30. Took 0.16154 seconds. 
  Full-batch training loss = 2.131753, test loss = 2.134412
  Training set accuracy = 0.437600, Test set accuracy = 0.432400
 epoch 9/30. Took 0.15018 seconds. 
  Full-batch training loss = 2.094881, test loss = 2.098328
  Training set accuracy = 0.458600, Test set accuracy = 0.454000
 epoch 10/30. Took 0.15147 seconds. 
  Full-batch training loss = 2.054331, test loss = 2.058624
  Training set accuracy = 0.480000, Test set accuracy = 0.474800
 epoch 11/30. Took 0.15087 seconds. 
  Full-batch training loss = 2.009622, test loss = 2.014449
  Training set accuracy = 0.496800, Test set accuracy = 0.489800
 epoch 12/30. Took 0.15096 seconds. 
  Full-batch training loss = 1.961011, test loss = 1.966420
  Training set accuracy = 0.515800, Test set accuracy = 0.502600
 epoch 13/30. Took 0.14991 seconds. 
  Full-batch training loss = 1.908240, test loss = 1.913724
  Training set accuracy = 0.530200, Test set accuracy = 0.518300
 epoch 14/30. Took 0.15787 seconds. 
  Full-batch training loss = 1.851893, test loss = 1.857102
  Training set accuracy = 0.550400, Test set accuracy = 0.535900
 epoch 15/30. Took 0.16314 seconds. 
  Full-batch training loss = 1.791249, test loss = 1.795983
  Training set accuracy = 0.567600, Test set accuracy = 0.550100
 epoch 16/30. Took 0.16211 seconds. 
  Full-batch training loss = 1.726662, test loss = 1.730585
  Training set accuracy = 0.584400, Test set accuracy = 0.567600
 epoch 17/30. Took 0.15504 seconds. 
  Full-batch training loss = 1.657455, test loss = 1.660624
  Training set accuracy = 0.595000, Test set accuracy = 0.585300
 epoch 18/30. Took 0.16036 seconds. 
  Full-batch training loss = 1.584631, test loss = 1.586800
  Training set accuracy = 0.611400, Test set accuracy = 0.603600
 epoch 19/30. Took 0.16203 seconds. 
  Full-batch training loss = 1.508664, test loss = 1.509473
  Training set accuracy = 0.626000, Test set accuracy = 0.623800
 epoch 20/30. Took 0.16145 seconds. 
  Full-batch training loss = 1.430448, test loss = 1.430113
  Training set accuracy = 0.640600, Test set accuracy = 0.640400
 epoch 21/30. Took 0.1524 seconds. 
  Full-batch training loss = 1.352967, test loss = 1.351235
  Training set accuracy = 0.658600, Test set accuracy = 0.659200
 epoch 22/30. Took 0.14935 seconds. 
  Full-batch training loss = 1.276590, test loss = 1.274078
  Training set accuracy = 0.683400, Test set accuracy = 0.683000
 epoch 23/30. Took 0.15069 seconds. 
  Full-batch training loss = 1.204008, test loss = 1.200812
  Training set accuracy = 0.701200, Test set accuracy = 0.702900
 epoch 24/30. Took 0.15483 seconds. 
  Full-batch training loss = 1.136606, test loss = 1.133015
  Training set accuracy = 0.720200, Test set accuracy = 0.718900
 epoch 25/30. Took 0.16297 seconds. 
  Full-batch training loss = 1.073227, test loss = 1.070697
  Training set accuracy = 0.735000, Test set accuracy = 0.732600
 epoch 26/30. Took 0.16231 seconds. 
  Full-batch training loss = 1.016217, test loss = 1.014353
  Training set accuracy = 0.749600, Test set accuracy = 0.747600
 epoch 27/30. Took 0.16135 seconds. 
  Full-batch training loss = 0.964072, test loss = 0.963569
  Training set accuracy = 0.760000, Test set accuracy = 0.758100
 epoch 28/30. Took 0.15961 seconds. 
  Full-batch training loss = 0.917347, test loss = 0.917066
  Training set accuracy = 0.775400, Test set accuracy = 0.771000
 epoch 29/30. Took 0.15347 seconds. 
  Full-batch training loss = 0.875915, test loss = 0.876424
  Training set accuracy = 0.785600, Test set accuracy = 0.781900
 epoch 30/30. Took 0.16236 seconds. 
  Full-batch training loss = 0.837957, test loss = 0.839765
  Training set accuracy = 0.794000, Test set accuracy = 0.792500
Elapsed time is 10.778675 seconds.
End Training
-----
Params 5000 0.001 0.10 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28196 seconds. 
  Full-batch training loss = 2.289463, test loss = 2.286064
  Training set accuracy = 0.153000, Test set accuracy = 0.154400
 epoch 2/30. Took 0.27798 seconds. 
  Full-batch training loss = 2.271728, test loss = 2.267999
  Training set accuracy = 0.203800, Test set accuracy = 0.209500
 epoch 3/30. Took 0.28239 seconds. 
  Full-batch training loss = 2.253436, test loss = 2.249376
  Training set accuracy = 0.264200, Test set accuracy = 0.267900
 epoch 4/30. Took 0.28267 seconds. 
  Full-batch training loss = 2.233859, test loss = 2.229328
  Training set accuracy = 0.320000, Test set accuracy = 0.321200
 epoch 5/30. Took 0.2826 seconds. 
  Full-batch training loss = 2.212445, test loss = 2.207455
  Training set accuracy = 0.370200, Test set accuracy = 0.379700
 epoch 6/30. Took 0.28161 seconds. 
  Full-batch training loss = 2.187988, test loss = 2.182438
  Training set accuracy = 0.432000, Test set accuracy = 0.437000
 epoch 7/30. Took 0.28328 seconds. 
  Full-batch training loss = 2.159977, test loss = 2.153796
  Training set accuracy = 0.484400, Test set accuracy = 0.481900
 epoch 8/30. Took 0.28248 seconds. 
  Full-batch training loss = 2.126860, test loss = 2.119836
  Training set accuracy = 0.531800, Test set accuracy = 0.532000
 epoch 9/30. Took 0.28248 seconds. 
  Full-batch training loss = 2.088067, test loss = 2.080084
  Training set accuracy = 0.569800, Test set accuracy = 0.569300
 epoch 10/30. Took 0.28105 seconds. 
  Full-batch training loss = 2.041957, test loss = 2.033007
  Training set accuracy = 0.606200, Test set accuracy = 0.601400
 epoch 11/30. Took 0.28974 seconds. 
  Full-batch training loss = 1.987953, test loss = 1.977877
  Training set accuracy = 0.621400, Test set accuracy = 0.624700
 epoch 12/30. Took 0.28305 seconds. 
  Full-batch training loss = 1.924891, test loss = 1.913471
  Training set accuracy = 0.642000, Test set accuracy = 0.641200
 epoch 13/30. Took 0.2861 seconds. 
  Full-batch training loss = 1.852819, test loss = 1.840405
  Training set accuracy = 0.653400, Test set accuracy = 0.650900
 epoch 14/30. Took 0.28323 seconds. 
  Full-batch training loss = 1.771621, test loss = 1.758209
  Training set accuracy = 0.662600, Test set accuracy = 0.660100
 epoch 15/30. Took 0.2827 seconds. 
  Full-batch training loss = 1.683017, test loss = 1.668852
  Training set accuracy = 0.675400, Test set accuracy = 0.675200
 epoch 16/30. Took 0.27843 seconds. 
  Full-batch training loss = 1.589406, test loss = 1.574820
  Training set accuracy = 0.687000, Test set accuracy = 0.689100
 epoch 17/30. Took 0.27441 seconds. 
  Full-batch training loss = 1.493522, test loss = 1.478956
  Training set accuracy = 0.701000, Test set accuracy = 0.699600
 epoch 18/30. Took 0.27206 seconds. 
  Full-batch training loss = 1.397835, test loss = 1.383458
  Training set accuracy = 0.716000, Test set accuracy = 0.715900
 epoch 19/30. Took 0.27853 seconds. 
  Full-batch training loss = 1.305774, test loss = 1.292284
  Training set accuracy = 0.730600, Test set accuracy = 0.728900
 epoch 20/30. Took 0.28083 seconds. 
  Full-batch training loss = 1.218552, test loss = 1.205942
  Training set accuracy = 0.747600, Test set accuracy = 0.748000
 epoch 21/30. Took 0.27796 seconds. 
  Full-batch training loss = 1.138501, test loss = 1.126969
  Training set accuracy = 0.754400, Test set accuracy = 0.759300
 epoch 22/30. Took 0.29437 seconds. 
  Full-batch training loss = 1.065630, test loss = 1.054968
  Training set accuracy = 0.768200, Test set accuracy = 0.773800
 epoch 23/30. Took 0.27367 seconds. 
  Full-batch training loss = 1.001044, test loss = 0.991368
  Training set accuracy = 0.779600, Test set accuracy = 0.781400
 epoch 24/30. Took 0.27103 seconds. 
  Full-batch training loss = 0.943581, test loss = 0.935119
  Training set accuracy = 0.786400, Test set accuracy = 0.787000
 epoch 25/30. Took 0.30125 seconds. 
  Full-batch training loss = 0.892812, test loss = 0.885283
  Training set accuracy = 0.792600, Test set accuracy = 0.798200
 epoch 26/30. Took 0.26605 seconds. 
  Full-batch training loss = 0.847485, test loss = 0.840913
  Training set accuracy = 0.803600, Test set accuracy = 0.798500
 epoch 27/30. Took 0.28387 seconds. 
  Full-batch training loss = 0.806415, test loss = 0.800497
  Training set accuracy = 0.804000, Test set accuracy = 0.806500
 epoch 28/30. Took 0.28194 seconds. 
  Full-batch training loss = 0.770996, test loss = 0.765690
  Training set accuracy = 0.807800, Test set accuracy = 0.809300
 epoch 29/30. Took 0.29619 seconds. 
  Full-batch training loss = 0.738304, test loss = 0.733788
  Training set accuracy = 0.817000, Test set accuracy = 0.815200
 epoch 30/30. Took 0.28037 seconds. 
  Full-batch training loss = 0.708960, test loss = 0.705827
  Training set accuracy = 0.823800, Test set accuracy = 0.820800
Elapsed time is 18.574508 seconds.
End Training
-----
Params 5000 0.001 0.10 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.86643 seconds. 
  Full-batch training loss = 2.276130, test loss = 2.277722
  Training set accuracy = 0.148800, Test set accuracy = 0.146600
 epoch 2/30. Took 0.81703 seconds. 
  Full-batch training loss = 2.250894, test loss = 2.253053
  Training set accuracy = 0.317600, Test set accuracy = 0.310500
 epoch 3/30. Took 0.82046 seconds. 
  Full-batch training loss = 2.224672, test loss = 2.227323
  Training set accuracy = 0.417600, Test set accuracy = 0.411900
 epoch 4/30. Took 0.9156 seconds. 
  Full-batch training loss = 2.196000, test loss = 2.198999
  Training set accuracy = 0.468400, Test set accuracy = 0.460700
 epoch 5/30. Took 0.84054 seconds. 
  Full-batch training loss = 2.163790, test loss = 2.167027
  Training set accuracy = 0.519600, Test set accuracy = 0.505200
 epoch 6/30. Took 0.8373 seconds. 
  Full-batch training loss = 2.126855, test loss = 2.130258
  Training set accuracy = 0.558800, Test set accuracy = 0.541100
 epoch 7/30. Took 0.85377 seconds. 
  Full-batch training loss = 2.083752, test loss = 2.087187
  Training set accuracy = 0.581000, Test set accuracy = 0.567000
 epoch 8/30. Took 0.87154 seconds. 
  Full-batch training loss = 2.033023, test loss = 2.036251
  Training set accuracy = 0.604000, Test set accuracy = 0.588300
 epoch 9/30. Took 0.85184 seconds. 
  Full-batch training loss = 1.973479, test loss = 1.976286
  Training set accuracy = 0.628000, Test set accuracy = 0.609300
 epoch 10/30. Took 0.84282 seconds. 
  Full-batch training loss = 1.903910, test loss = 1.906073
  Training set accuracy = 0.644200, Test set accuracy = 0.627800
 epoch 11/30. Took 0.81892 seconds. 
  Full-batch training loss = 1.823946, test loss = 1.824800
  Training set accuracy = 0.664800, Test set accuracy = 0.646800
 epoch 12/30. Took 0.8769 seconds. 
  Full-batch training loss = 1.733406, test loss = 1.732568
  Training set accuracy = 0.678800, Test set accuracy = 0.661200
 epoch 13/30. Took 0.83213 seconds. 
  Full-batch training loss = 1.633095, test loss = 1.629870
  Training set accuracy = 0.688400, Test set accuracy = 0.681200
 epoch 14/30. Took 0.82463 seconds. 
  Full-batch training loss = 1.525214, test loss = 1.519480
  Training set accuracy = 0.700400, Test set accuracy = 0.694400
 epoch 15/30. Took 0.84754 seconds. 
  Full-batch training loss = 1.412826, test loss = 1.404470
  Training set accuracy = 0.713400, Test set accuracy = 0.711300
 epoch 16/30. Took 0.83301 seconds. 
  Full-batch training loss = 1.301449, test loss = 1.290213
  Training set accuracy = 0.731400, Test set accuracy = 0.731600
 epoch 17/30. Took 0.82856 seconds. 
  Full-batch training loss = 1.196044, test loss = 1.182805
  Training set accuracy = 0.747600, Test set accuracy = 0.747800
 epoch 18/30. Took 0.92792 seconds. 
  Full-batch training loss = 1.098778, test loss = 1.082358
  Training set accuracy = 0.766000, Test set accuracy = 0.767700
 epoch 19/30. Took 0.94087 seconds. 
  Full-batch training loss = 1.012390, test loss = 0.994351
  Training set accuracy = 0.779800, Test set accuracy = 0.782000
 epoch 20/30. Took 0.82192 seconds. 
  Full-batch training loss = 0.937463, test loss = 0.917857
  Training set accuracy = 0.801200, Test set accuracy = 0.800700
 epoch 21/30. Took 0.82444 seconds. 
  Full-batch training loss = 0.872680, test loss = 0.853214
  Training set accuracy = 0.806600, Test set accuracy = 0.806500
 epoch 22/30. Took 0.81997 seconds. 
  Full-batch training loss = 0.817526, test loss = 0.797435
  Training set accuracy = 0.819800, Test set accuracy = 0.817200
 epoch 23/30. Took 0.82107 seconds. 
  Full-batch training loss = 0.770488, test loss = 0.752256
  Training set accuracy = 0.822000, Test set accuracy = 0.821200
 epoch 24/30. Took 0.82812 seconds. 
  Full-batch training loss = 0.729491, test loss = 0.710728
  Training set accuracy = 0.830400, Test set accuracy = 0.824700
 epoch 25/30. Took 0.9646 seconds. 
  Full-batch training loss = 0.694437, test loss = 0.676403
  Training set accuracy = 0.836800, Test set accuracy = 0.834400
 epoch 26/30. Took 0.8766 seconds. 
  Full-batch training loss = 0.664194, test loss = 0.646560
  Training set accuracy = 0.841200, Test set accuracy = 0.839500
 epoch 27/30. Took 0.8302 seconds. 
  Full-batch training loss = 0.636937, test loss = 0.621125
  Training set accuracy = 0.848400, Test set accuracy = 0.842300
 epoch 28/30. Took 0.95834 seconds. 
  Full-batch training loss = 0.613121, test loss = 0.597471
  Training set accuracy = 0.850400, Test set accuracy = 0.846500
 epoch 29/30. Took 0.82347 seconds. 
  Full-batch training loss = 0.592190, test loss = 0.577932
  Training set accuracy = 0.852200, Test set accuracy = 0.848200
 epoch 30/30. Took 0.81768 seconds. 
  Full-batch training loss = 0.573022, test loss = 0.559199
  Training set accuracy = 0.856000, Test set accuracy = 0.852700
Elapsed time is 53.269115 seconds.
End Training
-----
Params 5000 0.001 0.20 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11656 seconds. 
  Full-batch training loss = 2.228735, test loss = 2.230183
  Training set accuracy = 0.180200, Test set accuracy = 0.169900
 epoch 2/30. Took 0.10808 seconds. 
  Full-batch training loss = 2.151182, test loss = 2.153412
  Training set accuracy = 0.336600, Test set accuracy = 0.333200
 epoch 3/30. Took 0.10844 seconds. 
  Full-batch training loss = 2.074488, test loss = 2.077149
  Training set accuracy = 0.497800, Test set accuracy = 0.489300
 epoch 4/30. Took 0.10677 seconds. 
  Full-batch training loss = 1.995687, test loss = 1.998686
  Training set accuracy = 0.580000, Test set accuracy = 0.572000
 epoch 5/30. Took 0.1089 seconds. 
  Full-batch training loss = 1.915228, test loss = 1.918201
  Training set accuracy = 0.634800, Test set accuracy = 0.625700
 epoch 6/30. Took 0.10926 seconds. 
  Full-batch training loss = 1.833151, test loss = 1.835938
  Training set accuracy = 0.673400, Test set accuracy = 0.661400
 epoch 7/30. Took 0.11429 seconds. 
  Full-batch training loss = 1.750269, test loss = 1.752394
  Training set accuracy = 0.699200, Test set accuracy = 0.692800
 epoch 8/30. Took 0.11013 seconds. 
  Full-batch training loss = 1.667862, test loss = 1.669865
  Training set accuracy = 0.719400, Test set accuracy = 0.712600
 epoch 9/30. Took 0.11682 seconds. 
  Full-batch training loss = 1.586836, test loss = 1.588308
  Training set accuracy = 0.735400, Test set accuracy = 0.729800
 epoch 10/30. Took 0.11522 seconds. 
  Full-batch training loss = 1.507986, test loss = 1.508799
  Training set accuracy = 0.755000, Test set accuracy = 0.748600
 epoch 11/30. Took 0.11546 seconds. 
  Full-batch training loss = 1.432308, test loss = 1.432418
  Training set accuracy = 0.769600, Test set accuracy = 0.763200
 epoch 12/30. Took 0.10765 seconds. 
  Full-batch training loss = 1.360832, test loss = 1.360564
  Training set accuracy = 0.778400, Test set accuracy = 0.774900
 epoch 13/30. Took 0.10682 seconds. 
  Full-batch training loss = 1.294037, test loss = 1.293520
  Training set accuracy = 0.785400, Test set accuracy = 0.782000
 epoch 14/30. Took 0.10821 seconds. 
  Full-batch training loss = 1.232161, test loss = 1.231533
  Training set accuracy = 0.792000, Test set accuracy = 0.790000
 epoch 15/30. Took 0.1085 seconds. 
  Full-batch training loss = 1.174745, test loss = 1.173734
  Training set accuracy = 0.797600, Test set accuracy = 0.797500
 epoch 16/30. Took 0.10794 seconds. 
  Full-batch training loss = 1.121775, test loss = 1.120818
  Training set accuracy = 0.807200, Test set accuracy = 0.804100
 epoch 17/30. Took 0.10942 seconds. 
  Full-batch training loss = 1.073459, test loss = 1.072461
  Training set accuracy = 0.812400, Test set accuracy = 0.808100
 epoch 18/30. Took 0.10946 seconds. 
  Full-batch training loss = 1.028803, test loss = 1.027871
  Training set accuracy = 0.819400, Test set accuracy = 0.813000
 epoch 19/30. Took 0.10863 seconds. 
  Full-batch training loss = 0.987887, test loss = 0.987083
  Training set accuracy = 0.822400, Test set accuracy = 0.817400
 epoch 20/30. Took 0.10818 seconds. 
  Full-batch training loss = 0.950445, test loss = 0.949775
  Training set accuracy = 0.827600, Test set accuracy = 0.820700
 epoch 21/30. Took 0.10897 seconds. 
  Full-batch training loss = 0.916171, test loss = 0.915595
  Training set accuracy = 0.833200, Test set accuracy = 0.826300
 epoch 22/30. Took 0.10877 seconds. 
  Full-batch training loss = 0.884612, test loss = 0.884447
  Training set accuracy = 0.833800, Test set accuracy = 0.829900
 epoch 23/30. Took 0.10922 seconds. 
  Full-batch training loss = 0.855335, test loss = 0.855635
  Training set accuracy = 0.837600, Test set accuracy = 0.833200
 epoch 24/30. Took 0.11228 seconds. 
  Full-batch training loss = 0.828436, test loss = 0.828755
  Training set accuracy = 0.841000, Test set accuracy = 0.837400
 epoch 25/30. Took 0.10954 seconds. 
  Full-batch training loss = 0.803384, test loss = 0.803939
  Training set accuracy = 0.842400, Test set accuracy = 0.840600
 epoch 26/30. Took 0.10792 seconds. 
  Full-batch training loss = 0.780539, test loss = 0.781515
  Training set accuracy = 0.845800, Test set accuracy = 0.843300
 epoch 27/30. Took 0.10869 seconds. 
  Full-batch training loss = 0.759088, test loss = 0.760548
  Training set accuracy = 0.849400, Test set accuracy = 0.845600
 epoch 28/30. Took 0.10892 seconds. 
  Full-batch training loss = 0.739411, test loss = 0.741485
  Training set accuracy = 0.852200, Test set accuracy = 0.847800
 epoch 29/30. Took 0.10957 seconds. 
  Full-batch training loss = 0.720949, test loss = 0.723453
  Training set accuracy = 0.854000, Test set accuracy = 0.850500
 epoch 30/30. Took 0.1073 seconds. 
  Full-batch training loss = 0.703850, test loss = 0.706741
  Training set accuracy = 0.855800, Test set accuracy = 0.853200
Elapsed time is 8.135647 seconds.
End Training
-----
Params 5000 0.001 0.20 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17561 seconds. 
  Full-batch training loss = 2.248069, test loss = 2.255544
  Training set accuracy = 0.164600, Test set accuracy = 0.152000
 epoch 2/30. Took 0.16468 seconds. 
  Full-batch training loss = 2.162351, test loss = 2.168557
  Training set accuracy = 0.313600, Test set accuracy = 0.304400
 epoch 3/30. Took 0.17009 seconds. 
  Full-batch training loss = 2.079353, test loss = 2.084663
  Training set accuracy = 0.462000, Test set accuracy = 0.448600
 epoch 4/30. Took 0.16914 seconds. 
  Full-batch training loss = 1.995880, test loss = 2.000445
  Training set accuracy = 0.551800, Test set accuracy = 0.545500
 epoch 5/30. Took 0.17489 seconds. 
  Full-batch training loss = 1.910928, test loss = 1.914736
  Training set accuracy = 0.612200, Test set accuracy = 0.605300
 epoch 6/30. Took 0.16937 seconds. 
  Full-batch training loss = 1.824803, test loss = 1.827757
  Training set accuracy = 0.651400, Test set accuracy = 0.639900
 epoch 7/30. Took 0.16929 seconds. 
  Full-batch training loss = 1.738496, test loss = 1.740491
  Training set accuracy = 0.678000, Test set accuracy = 0.671800
 epoch 8/30. Took 0.16901 seconds. 
  Full-batch training loss = 1.653002, test loss = 1.654075
  Training set accuracy = 0.694600, Test set accuracy = 0.693400
 epoch 9/30. Took 0.17384 seconds. 
  Full-batch training loss = 1.569247, test loss = 1.569366
  Training set accuracy = 0.710400, Test set accuracy = 0.712500
 epoch 10/30. Took 0.16651 seconds. 
  Full-batch training loss = 1.488349, test loss = 1.487454
  Training set accuracy = 0.727200, Test set accuracy = 0.729400
 epoch 11/30. Took 0.16737 seconds. 
  Full-batch training loss = 1.410844, test loss = 1.409143
  Training set accuracy = 0.742800, Test set accuracy = 0.741900
 epoch 12/30. Took 0.1796 seconds. 
  Full-batch training loss = 1.337360, test loss = 1.334722
  Training set accuracy = 0.758800, Test set accuracy = 0.757600
 epoch 13/30. Took 0.17634 seconds. 
  Full-batch training loss = 1.269018, test loss = 1.265644
  Training set accuracy = 0.769400, Test set accuracy = 0.771400
 epoch 14/30. Took 0.16284 seconds. 
  Full-batch training loss = 1.205699, test loss = 1.201648
  Training set accuracy = 0.781000, Test set accuracy = 0.782200
 epoch 15/30. Took 0.16849 seconds. 
  Full-batch training loss = 1.147337, test loss = 1.142743
  Training set accuracy = 0.791600, Test set accuracy = 0.791800
 epoch 16/30. Took 0.16903 seconds. 
  Full-batch training loss = 1.094193, test loss = 1.089155
  Training set accuracy = 0.799200, Test set accuracy = 0.800700
 epoch 17/30. Took 0.1692 seconds. 
  Full-batch training loss = 1.045576, test loss = 1.040368
  Training set accuracy = 0.802400, Test set accuracy = 0.805700
 epoch 18/30. Took 0.16908 seconds. 
  Full-batch training loss = 1.001455, test loss = 0.996022
  Training set accuracy = 0.807400, Test set accuracy = 0.809700
 epoch 19/30. Took 0.17971 seconds. 
  Full-batch training loss = 0.960876, test loss = 0.955099
  Training set accuracy = 0.813800, Test set accuracy = 0.816600
 epoch 20/30. Took 0.18699 seconds. 
  Full-batch training loss = 0.924189, test loss = 0.918165
  Training set accuracy = 0.819600, Test set accuracy = 0.822300
 epoch 21/30. Took 0.16453 seconds. 
  Full-batch training loss = 0.890851, test loss = 0.884908
  Training set accuracy = 0.823200, Test set accuracy = 0.827000
 epoch 22/30. Took 0.17791 seconds. 
  Full-batch training loss = 0.860338, test loss = 0.854483
  Training set accuracy = 0.825800, Test set accuracy = 0.830200
 epoch 23/30. Took 0.1687 seconds. 
  Full-batch training loss = 0.832339, test loss = 0.826419
  Training set accuracy = 0.830600, Test set accuracy = 0.834300
 epoch 24/30. Took 0.16537 seconds. 
  Full-batch training loss = 0.806671, test loss = 0.800640
  Training set accuracy = 0.833200, Test set accuracy = 0.838800
 epoch 25/30. Took 0.17871 seconds. 
  Full-batch training loss = 0.783157, test loss = 0.777279
  Training set accuracy = 0.837600, Test set accuracy = 0.841600
 epoch 26/30. Took 0.16769 seconds. 
  Full-batch training loss = 0.761588, test loss = 0.755683
  Training set accuracy = 0.839800, Test set accuracy = 0.844400
 epoch 27/30. Took 0.16934 seconds. 
  Full-batch training loss = 0.741511, test loss = 0.735800
  Training set accuracy = 0.840000, Test set accuracy = 0.845900
 epoch 28/30. Took 0.1682 seconds. 
  Full-batch training loss = 0.723191, test loss = 0.717506
  Training set accuracy = 0.843600, Test set accuracy = 0.848700
 epoch 29/30. Took 0.16861 seconds. 
  Full-batch training loss = 0.706050, test loss = 0.700457
  Training set accuracy = 0.845200, Test set accuracy = 0.851300
 epoch 30/30. Took 0.1689 seconds. 
  Full-batch training loss = 0.690126, test loss = 0.684568
  Training set accuracy = 0.848200, Test set accuracy = 0.854700
Elapsed time is 11.803968 seconds.
End Training
-----
Params 5000 0.001 0.20 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.39842 seconds. 
  Full-batch training loss = 2.228680, test loss = 2.228325
  Training set accuracy = 0.233200, Test set accuracy = 0.230000
 epoch 2/30. Took 0.35652 seconds. 
  Full-batch training loss = 2.129577, test loss = 2.126460
  Training set accuracy = 0.450800, Test set accuracy = 0.453900
 epoch 3/30. Took 0.40392 seconds. 
  Full-batch training loss = 2.035979, test loss = 2.030090
  Training set accuracy = 0.579400, Test set accuracy = 0.585600
 epoch 4/30. Took 0.3566 seconds. 
  Full-batch training loss = 1.943989, test loss = 1.935652
  Training set accuracy = 0.655200, Test set accuracy = 0.668200
 epoch 5/30. Took 0.35776 seconds. 
  Full-batch training loss = 1.852458, test loss = 1.841667
  Training set accuracy = 0.706000, Test set accuracy = 0.717300
 epoch 6/30. Took 0.35634 seconds. 
  Full-batch training loss = 1.761348, test loss = 1.747972
  Training set accuracy = 0.737000, Test set accuracy = 0.751500
 epoch 7/30. Took 0.3562 seconds. 
  Full-batch training loss = 1.670839, test loss = 1.655014
  Training set accuracy = 0.761000, Test set accuracy = 0.772900
 epoch 8/30. Took 0.35574 seconds. 
  Full-batch training loss = 1.582307, test loss = 1.564162
  Training set accuracy = 0.776000, Test set accuracy = 0.788100
 epoch 9/30. Took 0.35671 seconds. 
  Full-batch training loss = 1.496989, test loss = 1.476865
  Training set accuracy = 0.786800, Test set accuracy = 0.798200
 epoch 10/30. Took 0.36349 seconds. 
  Full-batch training loss = 1.415647, test loss = 1.393887
  Training set accuracy = 0.794600, Test set accuracy = 0.807000
 epoch 11/30. Took 0.35266 seconds. 
  Full-batch training loss = 1.339061, test loss = 1.315963
  Training set accuracy = 0.804000, Test set accuracy = 0.812800
 epoch 12/30. Took 0.37263 seconds. 
  Full-batch training loss = 1.268163, test loss = 1.244037
  Training set accuracy = 0.809200, Test set accuracy = 0.818300
 epoch 13/30. Took 0.37386 seconds. 
  Full-batch training loss = 1.202427, test loss = 1.177663
  Training set accuracy = 0.814400, Test set accuracy = 0.822400
 epoch 14/30. Took 0.37891 seconds. 
  Full-batch training loss = 1.142440, test loss = 1.117119
  Training set accuracy = 0.820400, Test set accuracy = 0.826900
 epoch 15/30. Took 0.3699 seconds. 
  Full-batch training loss = 1.087708, test loss = 1.062052
  Training set accuracy = 0.823200, Test set accuracy = 0.830700
 epoch 16/30. Took 0.35744 seconds. 
  Full-batch training loss = 1.037712, test loss = 1.012007
  Training set accuracy = 0.827000, Test set accuracy = 0.834800
 epoch 17/30. Took 0.37178 seconds. 
  Full-batch training loss = 0.992551, test loss = 0.966943
  Training set accuracy = 0.829200, Test set accuracy = 0.837800
 epoch 18/30. Took 0.35721 seconds. 
  Full-batch training loss = 0.951471, test loss = 0.926112
  Training set accuracy = 0.833800, Test set accuracy = 0.841000
 epoch 19/30. Took 0.35604 seconds. 
  Full-batch training loss = 0.914119, test loss = 0.889140
  Training set accuracy = 0.836800, Test set accuracy = 0.844000
 epoch 20/30. Took 0.35168 seconds. 
  Full-batch training loss = 0.880133, test loss = 0.855446
  Training set accuracy = 0.840200, Test set accuracy = 0.847500
 epoch 21/30. Took 0.3559 seconds. 
  Full-batch training loss = 0.849195, test loss = 0.824876
  Training set accuracy = 0.842400, Test set accuracy = 0.850000
 epoch 22/30. Took 0.35482 seconds. 
  Full-batch training loss = 0.820857, test loss = 0.797047
  Training set accuracy = 0.844200, Test set accuracy = 0.851600
 epoch 23/30. Took 0.36989 seconds. 
  Full-batch training loss = 0.795094, test loss = 0.771839
  Training set accuracy = 0.848400, Test set accuracy = 0.854400
 epoch 24/30. Took 0.34869 seconds. 
  Full-batch training loss = 0.771462, test loss = 0.748677
  Training set accuracy = 0.849600, Test set accuracy = 0.856500
 epoch 25/30. Took 0.34919 seconds. 
  Full-batch training loss = 0.749581, test loss = 0.727226
  Training set accuracy = 0.850600, Test set accuracy = 0.858000
 epoch 26/30. Took 0.34847 seconds. 
  Full-batch training loss = 0.729412, test loss = 0.707617
  Training set accuracy = 0.853800, Test set accuracy = 0.860300
 epoch 27/30. Took 0.35398 seconds. 
  Full-batch training loss = 0.710822, test loss = 0.689621
  Training set accuracy = 0.856200, Test set accuracy = 0.861000
 epoch 28/30. Took 0.34909 seconds. 
  Full-batch training loss = 0.693674, test loss = 0.673094
  Training set accuracy = 0.858600, Test set accuracy = 0.863400
 epoch 29/30. Took 0.35043 seconds. 
  Full-batch training loss = 0.677657, test loss = 0.657295
  Training set accuracy = 0.860000, Test set accuracy = 0.864800
 epoch 30/30. Took 0.34927 seconds. 
  Full-batch training loss = 0.662703, test loss = 0.642985
  Training set accuracy = 0.861000, Test set accuracy = 0.866100
Elapsed time is 23.544749 seconds.
End Training
-----
Params 5000 0.001 0.20 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.13789 seconds. 
  Full-batch training loss = 2.288866, test loss = 2.287009
  Training set accuracy = 0.162000, Test set accuracy = 0.169900
 epoch 2/30. Took 0.1391 seconds. 
  Full-batch training loss = 2.264617, test loss = 2.262998
  Training set accuracy = 0.236400, Test set accuracy = 0.243500
 epoch 3/30. Took 0.12929 seconds. 
  Full-batch training loss = 2.240480, test loss = 2.238916
  Training set accuracy = 0.302800, Test set accuracy = 0.305500
 epoch 4/30. Took 0.13089 seconds. 
  Full-batch training loss = 2.215161, test loss = 2.213503
  Training set accuracy = 0.363400, Test set accuracy = 0.360300
 epoch 5/30. Took 0.13665 seconds. 
  Full-batch training loss = 2.187343, test loss = 2.185580
  Training set accuracy = 0.402800, Test set accuracy = 0.404100
 epoch 6/30. Took 0.13725 seconds. 
  Full-batch training loss = 2.156784, test loss = 2.154895
  Training set accuracy = 0.450400, Test set accuracy = 0.449900
 epoch 7/30. Took 0.13711 seconds. 
  Full-batch training loss = 2.123125, test loss = 2.121047
  Training set accuracy = 0.490000, Test set accuracy = 0.491800
 epoch 8/30. Took 0.14017 seconds. 
  Full-batch training loss = 2.086341, test loss = 2.084059
  Training set accuracy = 0.532400, Test set accuracy = 0.534300
 epoch 9/30. Took 0.12939 seconds. 
  Full-batch training loss = 2.046040, test loss = 2.043579
  Training set accuracy = 0.564600, Test set accuracy = 0.572000
 epoch 10/30. Took 0.13709 seconds. 
  Full-batch training loss = 2.001695, test loss = 1.998892
  Training set accuracy = 0.597800, Test set accuracy = 0.603900
 epoch 11/30. Took 0.13724 seconds. 
  Full-batch training loss = 1.953329, test loss = 1.950136
  Training set accuracy = 0.618600, Test set accuracy = 0.624900
 epoch 12/30. Took 0.13724 seconds. 
  Full-batch training loss = 1.902156, test loss = 1.898373
  Training set accuracy = 0.640400, Test set accuracy = 0.644400
 epoch 13/30. Took 0.1375 seconds. 
  Full-batch training loss = 1.847507, test loss = 1.843104
  Training set accuracy = 0.659200, Test set accuracy = 0.663000
 epoch 14/30. Took 0.14156 seconds. 
  Full-batch training loss = 1.789842, test loss = 1.784693
  Training set accuracy = 0.673200, Test set accuracy = 0.675700
 epoch 15/30. Took 0.14501 seconds. 
  Full-batch training loss = 1.730057, test loss = 1.724182
  Training set accuracy = 0.684800, Test set accuracy = 0.687300
 epoch 16/30. Took 0.12995 seconds. 
  Full-batch training loss = 1.668284, test loss = 1.661455
  Training set accuracy = 0.698800, Test set accuracy = 0.698300
 epoch 17/30. Took 0.13682 seconds. 
  Full-batch training loss = 1.605937, test loss = 1.598225
  Training set accuracy = 0.707400, Test set accuracy = 0.707300
 epoch 18/30. Took 0.13533 seconds. 
  Full-batch training loss = 1.542623, test loss = 1.533870
  Training set accuracy = 0.714600, Test set accuracy = 0.715300
 epoch 19/30. Took 0.13734 seconds. 
  Full-batch training loss = 1.479417, test loss = 1.469899
  Training set accuracy = 0.724000, Test set accuracy = 0.725400
 epoch 20/30. Took 0.1366 seconds. 
  Full-batch training loss = 1.417461, test loss = 1.406953
  Training set accuracy = 0.732800, Test set accuracy = 0.733800
 epoch 21/30. Took 0.13604 seconds. 
  Full-batch training loss = 1.357705, test loss = 1.346316
  Training set accuracy = 0.742400, Test set accuracy = 0.743200
 epoch 22/30. Took 0.13655 seconds. 
  Full-batch training loss = 1.298742, test loss = 1.286685
  Training set accuracy = 0.752200, Test set accuracy = 0.753700
 epoch 23/30. Took 0.13694 seconds. 
  Full-batch training loss = 1.242624, test loss = 1.229622
  Training set accuracy = 0.761400, Test set accuracy = 0.763200
 epoch 24/30. Took 0.13942 seconds. 
  Full-batch training loss = 1.189620, test loss = 1.176360
  Training set accuracy = 0.767200, Test set accuracy = 0.768100
 epoch 25/30. Took 0.13582 seconds. 
  Full-batch training loss = 1.138982, test loss = 1.125585
  Training set accuracy = 0.774000, Test set accuracy = 0.774500
 epoch 26/30. Took 0.13649 seconds. 
  Full-batch training loss = 1.091743, test loss = 1.077886
  Training set accuracy = 0.781000, Test set accuracy = 0.780800
 epoch 27/30. Took 0.1369 seconds. 
  Full-batch training loss = 1.046757, test loss = 1.032650
  Training set accuracy = 0.786600, Test set accuracy = 0.786200
 epoch 28/30. Took 0.13539 seconds. 
  Full-batch training loss = 1.005657, test loss = 0.991553
  Training set accuracy = 0.791800, Test set accuracy = 0.792300
 epoch 29/30. Took 0.13645 seconds. 
  Full-batch training loss = 0.967114, test loss = 0.952973
  Training set accuracy = 0.799000, Test set accuracy = 0.799700
 epoch 30/30. Took 0.13628 seconds. 
  Full-batch training loss = 0.931309, test loss = 0.917145
  Training set accuracy = 0.803600, Test set accuracy = 0.803500
Elapsed time is 9.521010 seconds.
End Training
-----
Params 5000 0.001 0.20 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23369 seconds. 
  Full-batch training loss = 2.283601, test loss = 2.283499
  Training set accuracy = 0.144800, Test set accuracy = 0.145600
 epoch 2/30. Took 0.22571 seconds. 
  Full-batch training loss = 2.259826, test loss = 2.259025
  Training set accuracy = 0.212000, Test set accuracy = 0.212000
 epoch 3/30. Took 0.22825 seconds. 
  Full-batch training loss = 2.235175, test loss = 2.233800
  Training set accuracy = 0.292400, Test set accuracy = 0.297800
 epoch 4/30. Took 0.2365 seconds. 
  Full-batch training loss = 2.208998, test loss = 2.207034
  Training set accuracy = 0.377000, Test set accuracy = 0.369800
 epoch 5/30. Took 0.24893 seconds. 
  Full-batch training loss = 2.180552, test loss = 2.178027
  Training set accuracy = 0.436800, Test set accuracy = 0.432200
 epoch 6/30. Took 0.22294 seconds. 
  Full-batch training loss = 2.148804, test loss = 2.145636
  Training set accuracy = 0.485800, Test set accuracy = 0.486000
 epoch 7/30. Took 0.22819 seconds. 
  Full-batch training loss = 2.113438, test loss = 2.109583
  Training set accuracy = 0.534000, Test set accuracy = 0.534200
 epoch 8/30. Took 0.22736 seconds. 
  Full-batch training loss = 2.074099, test loss = 2.069515
  Training set accuracy = 0.569400, Test set accuracy = 0.568400
 epoch 9/30. Took 0.22275 seconds. 
  Full-batch training loss = 2.030080, test loss = 2.024856
  Training set accuracy = 0.602600, Test set accuracy = 0.603700
 epoch 10/30. Took 0.22732 seconds. 
  Full-batch training loss = 1.980737, test loss = 1.974701
  Training set accuracy = 0.630800, Test set accuracy = 0.632500
 epoch 11/30. Took 0.22676 seconds. 
  Full-batch training loss = 1.926936, test loss = 1.920176
  Training set accuracy = 0.654000, Test set accuracy = 0.653900
 epoch 12/30. Took 0.22668 seconds. 
  Full-batch training loss = 1.868425, test loss = 1.860851
  Training set accuracy = 0.671200, Test set accuracy = 0.671300
 epoch 13/30. Took 0.22752 seconds. 
  Full-batch training loss = 1.804833, test loss = 1.796313
  Training set accuracy = 0.688200, Test set accuracy = 0.687000
 epoch 14/30. Took 0.22237 seconds. 
  Full-batch training loss = 1.736596, test loss = 1.727166
  Training set accuracy = 0.700000, Test set accuracy = 0.700500
 epoch 15/30. Took 0.2269 seconds. 
  Full-batch training loss = 1.665321, test loss = 1.655272
  Training set accuracy = 0.711600, Test set accuracy = 0.713700
 epoch 16/30. Took 0.22989 seconds. 
  Full-batch training loss = 1.591510, test loss = 1.580837
  Training set accuracy = 0.718000, Test set accuracy = 0.724800
 epoch 17/30. Took 0.24086 seconds. 
  Full-batch training loss = 1.516134, test loss = 1.505076
  Training set accuracy = 0.728000, Test set accuracy = 0.736300
 epoch 18/30. Took 0.2253 seconds. 
  Full-batch training loss = 1.441221, test loss = 1.429721
  Training set accuracy = 0.737200, Test set accuracy = 0.749100
 epoch 19/30. Took 0.23681 seconds. 
  Full-batch training loss = 1.367003, test loss = 1.355473
  Training set accuracy = 0.754800, Test set accuracy = 0.759500
 epoch 20/30. Took 0.22571 seconds. 
  Full-batch training loss = 1.295910, test loss = 1.284518
  Training set accuracy = 0.761400, Test set accuracy = 0.768300
 epoch 21/30. Took 0.2266 seconds. 
  Full-batch training loss = 1.227944, test loss = 1.216873
  Training set accuracy = 0.770600, Test set accuracy = 0.777900
 epoch 22/30. Took 0.22159 seconds. 
  Full-batch training loss = 1.164082, test loss = 1.153415
  Training set accuracy = 0.780000, Test set accuracy = 0.786100
 epoch 23/30. Took 0.22159 seconds. 
  Full-batch training loss = 1.104444, test loss = 1.094387
  Training set accuracy = 0.785000, Test set accuracy = 0.790300
 epoch 24/30. Took 0.22037 seconds. 
  Full-batch training loss = 1.049626, test loss = 1.040380
  Training set accuracy = 0.792400, Test set accuracy = 0.797600
 epoch 25/30. Took 0.22338 seconds. 
  Full-batch training loss = 0.999854, test loss = 0.991322
  Training set accuracy = 0.798800, Test set accuracy = 0.801000
 epoch 26/30. Took 0.23256 seconds. 
  Full-batch training loss = 0.954062, test loss = 0.946404
  Training set accuracy = 0.802200, Test set accuracy = 0.807400
 epoch 27/30. Took 0.22758 seconds. 
  Full-batch training loss = 0.912006, test loss = 0.904759
  Training set accuracy = 0.809000, Test set accuracy = 0.810400
 epoch 28/30. Took 0.24205 seconds. 
  Full-batch training loss = 0.873629, test loss = 0.867544
  Training set accuracy = 0.814800, Test set accuracy = 0.814500
 epoch 29/30. Took 0.22501 seconds. 
  Full-batch training loss = 0.839244, test loss = 0.834244
  Training set accuracy = 0.820200, Test set accuracy = 0.819500
 epoch 30/30. Took 0.24084 seconds. 
  Full-batch training loss = 0.807548, test loss = 0.803056
  Training set accuracy = 0.822400, Test set accuracy = 0.821800
Elapsed time is 15.225357 seconds.
End Training
-----
Params 5000 0.001 0.20 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.6002 seconds. 
  Full-batch training loss = 2.260454, test loss = 2.261908
  Training set accuracy = 0.205000, Test set accuracy = 0.198200
 epoch 2/30. Took 0.59388 seconds. 
  Full-batch training loss = 2.217400, test loss = 2.218358
  Training set accuracy = 0.337600, Test set accuracy = 0.336700
 epoch 3/30. Took 0.61034 seconds. 
  Full-batch training loss = 2.174204, test loss = 2.174619
  Training set accuracy = 0.458400, Test set accuracy = 0.454800
 epoch 4/30. Took 0.59896 seconds. 
  Full-batch training loss = 2.128985, test loss = 2.128814
  Training set accuracy = 0.538600, Test set accuracy = 0.530900
 epoch 5/30. Took 0.60004 seconds. 
  Full-batch training loss = 2.080331, test loss = 2.079634
  Training set accuracy = 0.580000, Test set accuracy = 0.578300
 epoch 6/30. Took 0.58844 seconds. 
  Full-batch training loss = 2.028622, test loss = 2.027276
  Training set accuracy = 0.610400, Test set accuracy = 0.608400
 epoch 7/30. Took 0.59315 seconds. 
  Full-batch training loss = 1.971793, test loss = 1.969677
  Training set accuracy = 0.636400, Test set accuracy = 0.636200
 epoch 8/30. Took 0.59362 seconds. 
  Full-batch training loss = 1.909888, test loss = 1.906955
  Training set accuracy = 0.657800, Test set accuracy = 0.655800
 epoch 9/30. Took 0.59409 seconds. 
  Full-batch training loss = 1.843408, test loss = 1.839461
  Training set accuracy = 0.679400, Test set accuracy = 0.677900
 epoch 10/30. Took 0.60846 seconds. 
  Full-batch training loss = 1.771641, test loss = 1.766602
  Training set accuracy = 0.697400, Test set accuracy = 0.698200
 epoch 11/30. Took 0.61171 seconds. 
  Full-batch training loss = 1.695417, test loss = 1.689288
  Training set accuracy = 0.710200, Test set accuracy = 0.716200
 epoch 12/30. Took 0.60091 seconds. 
  Full-batch training loss = 1.615993, test loss = 1.608685
  Training set accuracy = 0.722000, Test set accuracy = 0.729400
 epoch 13/30. Took 0.5893 seconds. 
  Full-batch training loss = 1.534555, test loss = 1.526295
  Training set accuracy = 0.739200, Test set accuracy = 0.744300
 epoch 14/30. Took 0.59772 seconds. 
  Full-batch training loss = 1.452857, test loss = 1.443230
  Training set accuracy = 0.755400, Test set accuracy = 0.761500
 epoch 15/30. Took 0.60652 seconds. 
  Full-batch training loss = 1.372314, test loss = 1.361830
  Training set accuracy = 0.765000, Test set accuracy = 0.771400
 epoch 16/30. Took 0.5913 seconds. 
  Full-batch training loss = 1.294785, test loss = 1.283484
  Training set accuracy = 0.773400, Test set accuracy = 0.779500
 epoch 17/30. Took 0.63805 seconds. 
  Full-batch training loss = 1.221502, test loss = 1.209238
  Training set accuracy = 0.783200, Test set accuracy = 0.794100
 epoch 18/30. Took 0.61068 seconds. 
  Full-batch training loss = 1.153810, test loss = 1.140790
  Training set accuracy = 0.790600, Test set accuracy = 0.803700
 epoch 19/30. Took 0.63718 seconds. 
  Full-batch training loss = 1.090712, test loss = 1.077642
  Training set accuracy = 0.799000, Test set accuracy = 0.808800
 epoch 20/30. Took 0.58867 seconds. 
  Full-batch training loss = 1.033302, test loss = 1.019936
  Training set accuracy = 0.804200, Test set accuracy = 0.813700
 epoch 21/30. Took 0.63985 seconds. 
  Full-batch training loss = 0.981207, test loss = 0.967753
  Training set accuracy = 0.808400, Test set accuracy = 0.819900
 epoch 22/30. Took 0.59466 seconds. 
  Full-batch training loss = 0.933741, test loss = 0.920131
  Training set accuracy = 0.818600, Test set accuracy = 0.826500
 epoch 23/30. Took 0.59563 seconds. 
  Full-batch training loss = 0.890941, test loss = 0.877072
  Training set accuracy = 0.824800, Test set accuracy = 0.830900
 epoch 24/30. Took 0.59301 seconds. 
  Full-batch training loss = 0.852836, test loss = 0.839341
  Training set accuracy = 0.829200, Test set accuracy = 0.833800
 epoch 25/30. Took 0.59086 seconds. 
  Full-batch training loss = 0.818128, test loss = 0.804805
  Training set accuracy = 0.831400, Test set accuracy = 0.833900
 epoch 26/30. Took 0.59557 seconds. 
  Full-batch training loss = 0.786287, test loss = 0.773518
  Training set accuracy = 0.834000, Test set accuracy = 0.836500
 epoch 27/30. Took 0.63795 seconds. 
  Full-batch training loss = 0.757536, test loss = 0.744833
  Training set accuracy = 0.837200, Test set accuracy = 0.839900
 epoch 28/30. Took 0.61353 seconds. 
  Full-batch training loss = 0.731419, test loss = 0.719043
  Training set accuracy = 0.840200, Test set accuracy = 0.843100
 epoch 29/30. Took 0.59408 seconds. 
  Full-batch training loss = 0.707552, test loss = 0.695754
  Training set accuracy = 0.842000, Test set accuracy = 0.845100
 epoch 30/30. Took 0.5933 seconds. 
  Full-batch training loss = 0.685741, test loss = 0.674108
  Training set accuracy = 0.845000, Test set accuracy = 0.850100
Elapsed time is 38.246334 seconds.
End Training
-----
Params 5000 0.001 0.20 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.16204 seconds. 
  Full-batch training loss = 2.300251, test loss = 2.300809
  Training set accuracy = 0.083400, Test set accuracy = 0.090500
 epoch 2/30. Took 0.16037 seconds. 
  Full-batch training loss = 2.292228, test loss = 2.292805
  Training set accuracy = 0.115600, Test set accuracy = 0.120500
 epoch 3/30. Took 0.16362 seconds. 
  Full-batch training loss = 2.283842, test loss = 2.284521
  Training set accuracy = 0.151600, Test set accuracy = 0.158000
 epoch 4/30. Took 0.1635 seconds. 
  Full-batch training loss = 2.274956, test loss = 2.275645
  Training set accuracy = 0.195600, Test set accuracy = 0.200600
 epoch 5/30. Took 0.1635 seconds. 
  Full-batch training loss = 2.265480, test loss = 2.266271
  Training set accuracy = 0.246400, Test set accuracy = 0.240900
 epoch 6/30. Took 0.15778 seconds. 
  Full-batch training loss = 2.255548, test loss = 2.256387
  Training set accuracy = 0.280800, Test set accuracy = 0.281500
 epoch 7/30. Took 0.16045 seconds. 
  Full-batch training loss = 2.244280, test loss = 2.245213
  Training set accuracy = 0.315800, Test set accuracy = 0.315400
 epoch 8/30. Took 0.16339 seconds. 
  Full-batch training loss = 2.231902, test loss = 2.232943
  Training set accuracy = 0.343400, Test set accuracy = 0.344900
 epoch 9/30. Took 0.16323 seconds. 
  Full-batch training loss = 2.218111, test loss = 2.219215
  Training set accuracy = 0.373800, Test set accuracy = 0.371400
 epoch 10/30. Took 0.15862 seconds. 
  Full-batch training loss = 2.202520, test loss = 2.203665
  Training set accuracy = 0.390600, Test set accuracy = 0.391500
 epoch 11/30. Took 0.15645 seconds. 
  Full-batch training loss = 2.185050, test loss = 2.186206
  Training set accuracy = 0.409400, Test set accuracy = 0.408800
 epoch 12/30. Took 0.15293 seconds. 
  Full-batch training loss = 2.165577, test loss = 2.166765
  Training set accuracy = 0.422200, Test set accuracy = 0.422700
 epoch 13/30. Took 0.16376 seconds. 
  Full-batch training loss = 2.143590, test loss = 2.144704
  Training set accuracy = 0.442000, Test set accuracy = 0.438200
 epoch 14/30. Took 0.16109 seconds. 
  Full-batch training loss = 2.119307, test loss = 2.120395
  Training set accuracy = 0.452000, Test set accuracy = 0.453900
 epoch 15/30. Took 0.16693 seconds. 
  Full-batch training loss = 2.091965, test loss = 2.093078
  Training set accuracy = 0.462400, Test set accuracy = 0.462500
 epoch 16/30. Took 0.16059 seconds. 
  Full-batch training loss = 2.061286, test loss = 2.062333
  Training set accuracy = 0.469800, Test set accuracy = 0.472400
 epoch 17/30. Took 0.16325 seconds. 
  Full-batch training loss = 2.027223, test loss = 2.028456
  Training set accuracy = 0.481400, Test set accuracy = 0.484700
 epoch 18/30. Took 0.16301 seconds. 
  Full-batch training loss = 1.989905, test loss = 1.991104
  Training set accuracy = 0.490600, Test set accuracy = 0.494300
 epoch 19/30. Took 0.16971 seconds. 
  Full-batch training loss = 1.949486, test loss = 1.950793
  Training set accuracy = 0.498800, Test set accuracy = 0.502400
 epoch 20/30. Took 0.151 seconds. 
  Full-batch training loss = 1.905763, test loss = 1.907080
  Training set accuracy = 0.515200, Test set accuracy = 0.520600
 epoch 21/30. Took 0.16294 seconds. 
  Full-batch training loss = 1.859402, test loss = 1.860605
  Training set accuracy = 0.530600, Test set accuracy = 0.536700
 epoch 22/30. Took 0.16467 seconds. 
  Full-batch training loss = 1.810647, test loss = 1.811766
  Training set accuracy = 0.550400, Test set accuracy = 0.558600
 epoch 23/30. Took 0.1609 seconds. 
  Full-batch training loss = 1.760100, test loss = 1.761016
  Training set accuracy = 0.572400, Test set accuracy = 0.581500
 epoch 24/30. Took 0.15797 seconds. 
  Full-batch training loss = 1.707641, test loss = 1.708167
  Training set accuracy = 0.596600, Test set accuracy = 0.603400
 epoch 25/30. Took 0.16208 seconds. 
  Full-batch training loss = 1.654299, test loss = 1.654401
  Training set accuracy = 0.622000, Test set accuracy = 0.630400
 epoch 26/30. Took 0.16303 seconds. 
  Full-batch training loss = 1.600628, test loss = 1.600065
  Training set accuracy = 0.647000, Test set accuracy = 0.654300
 epoch 27/30. Took 0.15266 seconds. 
  Full-batch training loss = 1.544345, test loss = 1.543126
  Training set accuracy = 0.669800, Test set accuracy = 0.673200
 epoch 28/30. Took 0.16335 seconds. 
  Full-batch training loss = 1.488186, test loss = 1.486155
  Training set accuracy = 0.686800, Test set accuracy = 0.691100
 epoch 29/30. Took 0.15261 seconds. 
  Full-batch training loss = 1.431723, test loss = 1.428659
  Training set accuracy = 0.702600, Test set accuracy = 0.706200
 epoch 30/30. Took 0.1527 seconds. 
  Full-batch training loss = 1.376480, test loss = 1.372293
  Training set accuracy = 0.715400, Test set accuracy = 0.720900
Elapsed time is 10.881410 seconds.
End Training
-----
Params 5000 0.001 0.20 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32084 seconds. 
  Full-batch training loss = 2.297964, test loss = 2.299331
  Training set accuracy = 0.137200, Test set accuracy = 0.136100
 epoch 2/30. Took 0.27082 seconds. 
  Full-batch training loss = 2.289498, test loss = 2.290652
  Training set accuracy = 0.183800, Test set accuracy = 0.185600
 epoch 3/30. Took 0.27565 seconds. 
  Full-batch training loss = 2.280966, test loss = 2.281902
  Training set accuracy = 0.240000, Test set accuracy = 0.242900
 epoch 4/30. Took 0.2695 seconds. 
  Full-batch training loss = 2.272218, test loss = 2.272951
  Training set accuracy = 0.297600, Test set accuracy = 0.294800
 epoch 5/30. Took 0.28474 seconds. 
  Full-batch training loss = 2.262826, test loss = 2.263336
  Training set accuracy = 0.352200, Test set accuracy = 0.348800
 epoch 6/30. Took 0.2686 seconds. 
  Full-batch training loss = 2.252811, test loss = 2.253117
  Training set accuracy = 0.395800, Test set accuracy = 0.391100
 epoch 7/30. Took 0.27103 seconds. 
  Full-batch training loss = 2.241786, test loss = 2.241875
  Training set accuracy = 0.423400, Test set accuracy = 0.418200
 epoch 8/30. Took 0.29894 seconds. 
  Full-batch training loss = 2.229890, test loss = 2.229774
  Training set accuracy = 0.452400, Test set accuracy = 0.447400
 epoch 9/30. Took 0.28785 seconds. 
  Full-batch training loss = 2.216370, test loss = 2.216032
  Training set accuracy = 0.473000, Test set accuracy = 0.471400
 epoch 10/30. Took 0.27037 seconds. 
  Full-batch training loss = 2.201517, test loss = 2.200994
  Training set accuracy = 0.491400, Test set accuracy = 0.490300
 epoch 11/30. Took 0.30174 seconds. 
  Full-batch training loss = 2.184657, test loss = 2.183886
  Training set accuracy = 0.505400, Test set accuracy = 0.504100
 epoch 12/30. Took 0.28211 seconds. 
  Full-batch training loss = 2.165458, test loss = 2.164459
  Training set accuracy = 0.514800, Test set accuracy = 0.516700
 epoch 13/30. Took 0.29131 seconds. 
  Full-batch training loss = 2.144127, test loss = 2.142897
  Training set accuracy = 0.528200, Test set accuracy = 0.532300
 epoch 14/30. Took 0.27737 seconds. 
  Full-batch training loss = 2.119795, test loss = 2.118221
  Training set accuracy = 0.538200, Test set accuracy = 0.545600
 epoch 15/30. Took 0.30861 seconds. 
  Full-batch training loss = 2.091926, test loss = 2.089974
  Training set accuracy = 0.554800, Test set accuracy = 0.564600
 epoch 16/30. Took 0.27977 seconds. 
  Full-batch training loss = 2.060472, test loss = 2.058077
  Training set accuracy = 0.569200, Test set accuracy = 0.576800
 epoch 17/30. Took 0.28315 seconds. 
  Full-batch training loss = 2.024646, test loss = 2.021604
  Training set accuracy = 0.579600, Test set accuracy = 0.587900
 epoch 18/30. Took 0.29816 seconds. 
  Full-batch training loss = 1.984559, test loss = 1.980849
  Training set accuracy = 0.588200, Test set accuracy = 0.596700
 epoch 19/30. Took 0.28124 seconds. 
  Full-batch training loss = 1.939770, test loss = 1.935239
  Training set accuracy = 0.601400, Test set accuracy = 0.605500
 epoch 20/30. Took 0.28408 seconds. 
  Full-batch training loss = 1.890265, test loss = 1.884923
  Training set accuracy = 0.608600, Test set accuracy = 0.613400
 epoch 21/30. Took 0.28379 seconds. 
  Full-batch training loss = 1.836427, test loss = 1.830088
  Training set accuracy = 0.624200, Test set accuracy = 0.628300
 epoch 22/30. Took 0.27774 seconds. 
  Full-batch training loss = 1.778803, test loss = 1.771328
  Training set accuracy = 0.637000, Test set accuracy = 0.642500
 epoch 23/30. Took 0.28981 seconds. 
  Full-batch training loss = 1.717994, test loss = 1.709273
  Training set accuracy = 0.648800, Test set accuracy = 0.654800
 epoch 24/30. Took 0.30281 seconds. 
  Full-batch training loss = 1.653913, test loss = 1.643832
  Training set accuracy = 0.666000, Test set accuracy = 0.673100
 epoch 25/30. Took 0.30629 seconds. 
  Full-batch training loss = 1.588665, test loss = 1.577168
  Training set accuracy = 0.685000, Test set accuracy = 0.687300
 epoch 26/30. Took 0.28897 seconds. 
  Full-batch training loss = 1.521465, test loss = 1.508722
  Training set accuracy = 0.699400, Test set accuracy = 0.703400
 epoch 27/30. Took 0.27635 seconds. 
  Full-batch training loss = 1.454533, test loss = 1.440621
  Training set accuracy = 0.720000, Test set accuracy = 0.719900
 epoch 28/30. Took 0.28316 seconds. 
  Full-batch training loss = 1.387629, test loss = 1.372753
  Training set accuracy = 0.737400, Test set accuracy = 0.733300
 epoch 29/30. Took 0.29676 seconds. 
  Full-batch training loss = 1.322827, test loss = 1.307243
  Training set accuracy = 0.747000, Test set accuracy = 0.743900
 epoch 30/30. Took 0.27615 seconds. 
  Full-batch training loss = 1.259935, test loss = 1.243758
  Training set accuracy = 0.758000, Test set accuracy = 0.755000
Elapsed time is 18.745141 seconds.
End Training
-----
Params 5000 0.001 0.20 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.886 seconds. 
  Full-batch training loss = 2.291819, test loss = 2.293166
  Training set accuracy = 0.108000, Test set accuracy = 0.107000
 epoch 2/30. Took 0.94486 seconds. 
  Full-batch training loss = 2.278011, test loss = 2.279598
  Training set accuracy = 0.174600, Test set accuracy = 0.171100
 epoch 3/30. Took 0.82466 seconds. 
  Full-batch training loss = 2.263981, test loss = 2.265775
  Training set accuracy = 0.240600, Test set accuracy = 0.240600
 epoch 4/30. Took 0.91243 seconds. 
  Full-batch training loss = 2.249433, test loss = 2.251373
  Training set accuracy = 0.326200, Test set accuracy = 0.328700
 epoch 5/30. Took 0.81472 seconds. 
  Full-batch training loss = 2.234072, test loss = 2.236119
  Training set accuracy = 0.398000, Test set accuracy = 0.398600
 epoch 6/30. Took 0.86229 seconds. 
  Full-batch training loss = 2.217339, test loss = 2.219496
  Training set accuracy = 0.438400, Test set accuracy = 0.436700
 epoch 7/30. Took 0.82389 seconds. 
  Full-batch training loss = 2.199170, test loss = 2.201361
  Training set accuracy = 0.465400, Test set accuracy = 0.461600
 epoch 8/30. Took 0.82132 seconds. 
  Full-batch training loss = 2.178994, test loss = 2.181271
  Training set accuracy = 0.486200, Test set accuracy = 0.484100
 epoch 9/30. Took 0.85757 seconds. 
  Full-batch training loss = 2.156513, test loss = 2.158837
  Training set accuracy = 0.509200, Test set accuracy = 0.505900
 epoch 10/30. Took 0.84709 seconds. 
  Full-batch training loss = 2.131322, test loss = 2.133542
  Training set accuracy = 0.532200, Test set accuracy = 0.533400
 epoch 11/30. Took 0.82559 seconds. 
  Full-batch training loss = 2.102255, test loss = 2.104519
  Training set accuracy = 0.546000, Test set accuracy = 0.546400
 epoch 12/30. Took 0.8252 seconds. 
  Full-batch training loss = 2.069774, test loss = 2.071990
  Training set accuracy = 0.560800, Test set accuracy = 0.561400
 epoch 13/30. Took 0.87513 seconds. 
  Full-batch training loss = 2.032648, test loss = 2.034715
  Training set accuracy = 0.578600, Test set accuracy = 0.579400
 epoch 14/30. Took 0.84981 seconds. 
  Full-batch training loss = 1.990640, test loss = 1.992636
  Training set accuracy = 0.595200, Test set accuracy = 0.594400
 epoch 15/30. Took 0.84052 seconds. 
  Full-batch training loss = 1.943494, test loss = 1.945331
  Training set accuracy = 0.619000, Test set accuracy = 0.610700
 epoch 16/30. Took 0.82265 seconds. 
  Full-batch training loss = 1.890189, test loss = 1.891925
  Training set accuracy = 0.632200, Test set accuracy = 0.623400
 epoch 17/30. Took 0.92223 seconds. 
  Full-batch training loss = 1.831333, test loss = 1.832844
  Training set accuracy = 0.646800, Test set accuracy = 0.638700
 epoch 18/30. Took 0.84539 seconds. 
  Full-batch training loss = 1.766918, test loss = 1.768082
  Training set accuracy = 0.661800, Test set accuracy = 0.653900
 epoch 19/30. Took 0.98098 seconds. 
  Full-batch training loss = 1.696557, test loss = 1.697380
  Training set accuracy = 0.671400, Test set accuracy = 0.663600
 epoch 20/30. Took 0.8289 seconds. 
  Full-batch training loss = 1.621259, test loss = 1.621797
  Training set accuracy = 0.681800, Test set accuracy = 0.670300
 epoch 21/30. Took 0.81842 seconds. 
  Full-batch training loss = 1.542533, test loss = 1.542314
  Training set accuracy = 0.695000, Test set accuracy = 0.684200
 epoch 22/30. Took 0.86024 seconds. 
  Full-batch training loss = 1.461486, test loss = 1.460873
  Training set accuracy = 0.703000, Test set accuracy = 0.696000
 epoch 23/30. Took 0.92982 seconds. 
  Full-batch training loss = 1.379884, test loss = 1.378732
  Training set accuracy = 0.712800, Test set accuracy = 0.705400
 epoch 24/30. Took 0.87444 seconds. 
  Full-batch training loss = 1.300078, test loss = 1.298933
  Training set accuracy = 0.722600, Test set accuracy = 0.713100
 epoch 25/30. Took 0.88875 seconds. 
  Full-batch training loss = 1.223682, test loss = 1.221942
  Training set accuracy = 0.738200, Test set accuracy = 0.727400
 epoch 26/30. Took 0.85749 seconds. 
  Full-batch training loss = 1.152131, test loss = 1.150381
  Training set accuracy = 0.748200, Test set accuracy = 0.737000
 epoch 27/30. Took 0.92067 seconds. 
  Full-batch training loss = 1.083924, test loss = 1.081745
  Training set accuracy = 0.767200, Test set accuracy = 0.753000
 epoch 28/30. Took 0.89141 seconds. 
  Full-batch training loss = 1.023419, test loss = 1.020950
  Training set accuracy = 0.777400, Test set accuracy = 0.765400
 epoch 29/30. Took 0.83342 seconds. 
  Full-batch training loss = 0.967899, test loss = 0.965622
  Training set accuracy = 0.787800, Test set accuracy = 0.775500
 epoch 30/30. Took 0.88117 seconds. 
  Full-batch training loss = 0.918124, test loss = 0.916340
  Training set accuracy = 0.794200, Test set accuracy = 0.780300
Elapsed time is 53.590355 seconds.
End Training
-----
Params 5000 0.001 0.30 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.1144 seconds. 
  Full-batch training loss = 2.252456, test loss = 2.250620
  Training set accuracy = 0.163600, Test set accuracy = 0.170000
 epoch 2/30. Took 0.11216 seconds. 
  Full-batch training loss = 2.183334, test loss = 2.181192
  Training set accuracy = 0.350000, Test set accuracy = 0.354300
 epoch 3/30. Took 0.10533 seconds. 
  Full-batch training loss = 2.118035, test loss = 2.115560
  Training set accuracy = 0.494200, Test set accuracy = 0.496200
 epoch 4/30. Took 0.10838 seconds. 
  Full-batch training loss = 2.051569, test loss = 2.048712
  Training set accuracy = 0.577200, Test set accuracy = 0.580900
 epoch 5/30. Took 0.10903 seconds. 
  Full-batch training loss = 1.983438, test loss = 1.980040
  Training set accuracy = 0.638200, Test set accuracy = 0.642600
 epoch 6/30. Took 0.10846 seconds. 
  Full-batch training loss = 1.913546, test loss = 1.909230
  Training set accuracy = 0.672200, Test set accuracy = 0.680900
 epoch 7/30. Took 0.11484 seconds. 
  Full-batch training loss = 1.841785, test loss = 1.836601
  Training set accuracy = 0.702200, Test set accuracy = 0.710000
 epoch 8/30. Took 0.10873 seconds. 
  Full-batch training loss = 1.769932, test loss = 1.763834
  Training set accuracy = 0.722000, Test set accuracy = 0.729700
 epoch 9/30. Took 0.10876 seconds. 
  Full-batch training loss = 1.698854, test loss = 1.691734
  Training set accuracy = 0.742200, Test set accuracy = 0.749000
 epoch 10/30. Took 0.10829 seconds. 
  Full-batch training loss = 1.628279, test loss = 1.620272
  Training set accuracy = 0.752200, Test set accuracy = 0.761700
 epoch 11/30. Took 0.10868 seconds. 
  Full-batch training loss = 1.559467, test loss = 1.550354
  Training set accuracy = 0.763000, Test set accuracy = 0.771000
 epoch 12/30. Took 0.10821 seconds. 
  Full-batch training loss = 1.493198, test loss = 1.483382
  Training set accuracy = 0.769800, Test set accuracy = 0.779900
 epoch 13/30. Took 0.10876 seconds. 
  Full-batch training loss = 1.429604, test loss = 1.419108
  Training set accuracy = 0.778800, Test set accuracy = 0.787100
 epoch 14/30. Took 0.10896 seconds. 
  Full-batch training loss = 1.369020, test loss = 1.357756
  Training set accuracy = 0.787000, Test set accuracy = 0.793900
 epoch 15/30. Took 0.10877 seconds. 
  Full-batch training loss = 1.312018, test loss = 1.300397
  Training set accuracy = 0.792400, Test set accuracy = 0.799400
 epoch 16/30. Took 0.10944 seconds. 
  Full-batch training loss = 1.258051, test loss = 1.245942
  Training set accuracy = 0.800400, Test set accuracy = 0.804300
 epoch 17/30. Took 0.10953 seconds. 
  Full-batch training loss = 1.207689, test loss = 1.195271
  Training set accuracy = 0.806000, Test set accuracy = 0.809400
 epoch 18/30. Took 0.11522 seconds. 
  Full-batch training loss = 1.160965, test loss = 1.148295
  Training set accuracy = 0.809400, Test set accuracy = 0.813200
 epoch 19/30. Took 0.10835 seconds. 
  Full-batch training loss = 1.117101, test loss = 1.104241
  Training set accuracy = 0.814800, Test set accuracy = 0.817600
 epoch 20/30. Took 0.1086 seconds. 
  Full-batch training loss = 1.077193, test loss = 1.064274
  Training set accuracy = 0.818600, Test set accuracy = 0.821100
 epoch 21/30. Took 0.10912 seconds. 
  Full-batch training loss = 1.039981, test loss = 1.026966
  Training set accuracy = 0.824200, Test set accuracy = 0.823800
 epoch 22/30. Took 0.10985 seconds. 
  Full-batch training loss = 1.005155, test loss = 0.992106
  Training set accuracy = 0.826800, Test set accuracy = 0.826600
 epoch 23/30. Took 0.11025 seconds. 
  Full-batch training loss = 0.973084, test loss = 0.960078
  Training set accuracy = 0.829400, Test set accuracy = 0.828100
 epoch 24/30. Took 0.10852 seconds. 
  Full-batch training loss = 0.943212, test loss = 0.930368
  Training set accuracy = 0.832000, Test set accuracy = 0.831800
 epoch 25/30. Took 0.109 seconds. 
  Full-batch training loss = 0.915984, test loss = 0.903233
  Training set accuracy = 0.833200, Test set accuracy = 0.835600
 epoch 26/30. Took 0.11786 seconds. 
  Full-batch training loss = 0.890196, test loss = 0.877656
  Training set accuracy = 0.836400, Test set accuracy = 0.837300
 epoch 27/30. Took 0.10891 seconds. 
  Full-batch training loss = 0.866561, test loss = 0.854215
  Training set accuracy = 0.839600, Test set accuracy = 0.838500
 epoch 28/30. Took 0.10867 seconds. 
  Full-batch training loss = 0.844668, test loss = 0.832595
  Training set accuracy = 0.840200, Test set accuracy = 0.840200
 epoch 29/30. Took 0.10567 seconds. 
  Full-batch training loss = 0.823895, test loss = 0.812006
  Training set accuracy = 0.842600, Test set accuracy = 0.841800
 epoch 30/30. Took 0.10903 seconds. 
  Full-batch training loss = 0.804780, test loss = 0.793315
  Training set accuracy = 0.844400, Test set accuracy = 0.843300
Elapsed time is 8.063990 seconds.
End Training
-----
Params 5000 0.001 0.30 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.1758 seconds. 
  Full-batch training loss = 2.227124, test loss = 2.230395
  Training set accuracy = 0.199800, Test set accuracy = 0.199100
 epoch 2/30. Took 0.16698 seconds. 
  Full-batch training loss = 2.152388, test loss = 2.154636
  Training set accuracy = 0.374800, Test set accuracy = 0.358800
 epoch 3/30. Took 0.16848 seconds. 
  Full-batch training loss = 2.079814, test loss = 2.081411
  Training set accuracy = 0.517600, Test set accuracy = 0.503000
 epoch 4/30. Took 0.16942 seconds. 
  Full-batch training loss = 2.007466, test loss = 2.008623
  Training set accuracy = 0.609000, Test set accuracy = 0.599900
 epoch 5/30. Took 0.16983 seconds. 
  Full-batch training loss = 1.934218, test loss = 1.934964
  Training set accuracy = 0.656800, Test set accuracy = 0.645900
 epoch 6/30. Took 0.16978 seconds. 
  Full-batch training loss = 1.860545, test loss = 1.861067
  Training set accuracy = 0.681000, Test set accuracy = 0.671600
 epoch 7/30. Took 0.17008 seconds. 
  Full-batch training loss = 1.786245, test loss = 1.786560
  Training set accuracy = 0.697400, Test set accuracy = 0.687200
 epoch 8/30. Took 0.17017 seconds. 
  Full-batch training loss = 1.711899, test loss = 1.712182
  Training set accuracy = 0.712000, Test set accuracy = 0.700400
 epoch 9/30. Took 0.16994 seconds. 
  Full-batch training loss = 1.637998, test loss = 1.638040
  Training set accuracy = 0.720200, Test set accuracy = 0.713100
 epoch 10/30. Took 0.19036 seconds. 
  Full-batch training loss = 1.566074, test loss = 1.566129
  Training set accuracy = 0.729200, Test set accuracy = 0.721200
 epoch 11/30. Took 0.17066 seconds. 
  Full-batch training loss = 1.497102, test loss = 1.496819
  Training set accuracy = 0.738000, Test set accuracy = 0.732300
 epoch 12/30. Took 0.16978 seconds. 
  Full-batch training loss = 1.431169, test loss = 1.430877
  Training set accuracy = 0.746800, Test set accuracy = 0.741400
 epoch 13/30. Took 0.16934 seconds. 
  Full-batch training loss = 1.368469, test loss = 1.368205
  Training set accuracy = 0.752400, Test set accuracy = 0.748700
 epoch 14/30. Took 0.16983 seconds. 
  Full-batch training loss = 1.309834, test loss = 1.309282
  Training set accuracy = 0.761000, Test set accuracy = 0.756400
 epoch 15/30. Took 0.16926 seconds. 
  Full-batch training loss = 1.254929, test loss = 1.254209
  Training set accuracy = 0.767600, Test set accuracy = 0.765100
 epoch 16/30. Took 0.16955 seconds. 
  Full-batch training loss = 1.203826, test loss = 1.202750
  Training set accuracy = 0.775800, Test set accuracy = 0.772200
 epoch 17/30. Took 0.16995 seconds. 
  Full-batch training loss = 1.156338, test loss = 1.155118
  Training set accuracy = 0.781800, Test set accuracy = 0.779300
 epoch 18/30. Took 0.18116 seconds. 
  Full-batch training loss = 1.112156, test loss = 1.110786
  Training set accuracy = 0.788000, Test set accuracy = 0.785000
 epoch 19/30. Took 0.18113 seconds. 
  Full-batch training loss = 1.071482, test loss = 1.069621
  Training set accuracy = 0.793600, Test set accuracy = 0.792600
 epoch 20/30. Took 0.16899 seconds. 
  Full-batch training loss = 1.033668, test loss = 1.031769
  Training set accuracy = 0.800200, Test set accuracy = 0.797200
 epoch 21/30. Took 0.17033 seconds. 
  Full-batch training loss = 0.998586, test loss = 0.996533
  Training set accuracy = 0.803200, Test set accuracy = 0.803600
 epoch 22/30. Took 0.17139 seconds. 
  Full-batch training loss = 0.966310, test loss = 0.964156
  Training set accuracy = 0.810800, Test set accuracy = 0.809300
 epoch 23/30. Took 0.17792 seconds. 
  Full-batch training loss = 0.936199, test loss = 0.934107
  Training set accuracy = 0.815000, Test set accuracy = 0.813600
 epoch 24/30. Took 0.16865 seconds. 
  Full-batch training loss = 0.908418, test loss = 0.906290
  Training set accuracy = 0.818000, Test set accuracy = 0.816300
 epoch 25/30. Took 0.17009 seconds. 
  Full-batch training loss = 0.882746, test loss = 0.880633
  Training set accuracy = 0.820400, Test set accuracy = 0.818600
 epoch 26/30. Took 0.16666 seconds. 
  Full-batch training loss = 0.858549, test loss = 0.856451
  Training set accuracy = 0.825400, Test set accuracy = 0.825400
 epoch 27/30. Took 0.16781 seconds. 
  Full-batch training loss = 0.836049, test loss = 0.834024
  Training set accuracy = 0.829200, Test set accuracy = 0.828100
 epoch 28/30. Took 0.16983 seconds. 
  Full-batch training loss = 0.815205, test loss = 0.812940
  Training set accuracy = 0.832600, Test set accuracy = 0.832100
 epoch 29/30. Took 0.16872 seconds. 
  Full-batch training loss = 0.795691, test loss = 0.793353
  Training set accuracy = 0.837200, Test set accuracy = 0.834700
 epoch 30/30. Took 0.17026 seconds. 
  Full-batch training loss = 0.777633, test loss = 0.775338
  Training set accuracy = 0.840000, Test set accuracy = 0.836300
Elapsed time is 11.744694 seconds.
End Training
-----
Params 5000 0.001 0.30 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.36385 seconds. 
  Full-batch training loss = 2.222791, test loss = 2.222540
  Training set accuracy = 0.225800, Test set accuracy = 0.234400
 epoch 2/30. Took 0.38115 seconds. 
  Full-batch training loss = 2.140905, test loss = 2.139690
  Training set accuracy = 0.391800, Test set accuracy = 0.401300
 epoch 3/30. Took 0.36261 seconds. 
  Full-batch training loss = 2.061511, test loss = 2.059201
  Training set accuracy = 0.539600, Test set accuracy = 0.545000
 epoch 4/30. Took 0.35568 seconds. 
  Full-batch training loss = 1.982837, test loss = 1.979212
  Training set accuracy = 0.630600, Test set accuracy = 0.638000
 epoch 5/30. Took 0.37279 seconds. 
  Full-batch training loss = 1.904515, test loss = 1.899732
  Training set accuracy = 0.679400, Test set accuracy = 0.686800
 epoch 6/30. Took 0.36801 seconds. 
  Full-batch training loss = 1.825760, test loss = 1.819578
  Training set accuracy = 0.718000, Test set accuracy = 0.719600
 epoch 7/30. Took 0.38678 seconds. 
  Full-batch training loss = 1.747370, test loss = 1.739841
  Training set accuracy = 0.739800, Test set accuracy = 0.738100
 epoch 8/30. Took 0.35693 seconds. 
  Full-batch training loss = 1.669663, test loss = 1.660944
  Training set accuracy = 0.756200, Test set accuracy = 0.752700
 epoch 9/30. Took 0.35333 seconds. 
  Full-batch training loss = 1.593559, test loss = 1.583664
  Training set accuracy = 0.767600, Test set accuracy = 0.764800
 epoch 10/30. Took 0.36355 seconds. 
  Full-batch training loss = 1.519398, test loss = 1.508352
  Training set accuracy = 0.777800, Test set accuracy = 0.776200
 epoch 11/30. Took 0.37801 seconds. 
  Full-batch training loss = 1.448038, test loss = 1.436074
  Training set accuracy = 0.785200, Test set accuracy = 0.784100
 epoch 12/30. Took 0.35047 seconds. 
  Full-batch training loss = 1.380193, test loss = 1.367381
  Training set accuracy = 0.791200, Test set accuracy = 0.790800
 epoch 13/30. Took 0.35044 seconds. 
  Full-batch training loss = 1.316002, test loss = 1.302655
  Training set accuracy = 0.795000, Test set accuracy = 0.796100
 epoch 14/30. Took 0.37255 seconds. 
  Full-batch training loss = 1.255854, test loss = 1.242053
  Training set accuracy = 0.800000, Test set accuracy = 0.800000
 epoch 15/30. Took 0.34931 seconds. 
  Full-batch training loss = 1.199627, test loss = 1.185600
  Training set accuracy = 0.803800, Test set accuracy = 0.804800
 epoch 16/30. Took 0.36007 seconds. 
  Full-batch training loss = 1.147449, test loss = 1.133300
  Training set accuracy = 0.808800, Test set accuracy = 0.809000
 epoch 17/30. Took 0.35469 seconds. 
  Full-batch training loss = 1.099168, test loss = 1.085000
  Training set accuracy = 0.813400, Test set accuracy = 0.814600
 epoch 18/30. Took 0.36398 seconds. 
  Full-batch training loss = 1.054793, test loss = 1.040782
  Training set accuracy = 0.816000, Test set accuracy = 0.818700
 epoch 19/30. Took 0.36181 seconds. 
  Full-batch training loss = 1.013807, test loss = 1.000027
  Training set accuracy = 0.819400, Test set accuracy = 0.821900
 epoch 20/30. Took 0.35328 seconds. 
  Full-batch training loss = 0.976139, test loss = 0.962634
  Training set accuracy = 0.821200, Test set accuracy = 0.824100
 epoch 21/30. Took 0.36674 seconds. 
  Full-batch training loss = 0.941415, test loss = 0.928259
  Training set accuracy = 0.824800, Test set accuracy = 0.827200
 epoch 22/30. Took 0.35066 seconds. 
  Full-batch training loss = 0.909599, test loss = 0.897106
  Training set accuracy = 0.827200, Test set accuracy = 0.832000
 epoch 23/30. Took 0.35533 seconds. 
  Full-batch training loss = 0.880090, test loss = 0.867868
  Training set accuracy = 0.831800, Test set accuracy = 0.834700
 epoch 24/30. Took 0.35568 seconds. 
  Full-batch training loss = 0.852728, test loss = 0.840989
  Training set accuracy = 0.835800, Test set accuracy = 0.837600
 epoch 25/30. Took 0.35282 seconds. 
  Full-batch training loss = 0.827557, test loss = 0.816313
  Training set accuracy = 0.838200, Test set accuracy = 0.840800
 epoch 26/30. Took 0.36937 seconds. 
  Full-batch training loss = 0.804221, test loss = 0.793483
  Training set accuracy = 0.841400, Test set accuracy = 0.842500
 epoch 27/30. Took 0.35121 seconds. 
  Full-batch training loss = 0.782539, test loss = 0.772332
  Training set accuracy = 0.843600, Test set accuracy = 0.844600
 epoch 28/30. Took 0.35092 seconds. 
  Full-batch training loss = 0.762387, test loss = 0.752760
  Training set accuracy = 0.845800, Test set accuracy = 0.847100
 epoch 29/30. Took 0.35424 seconds. 
  Full-batch training loss = 0.743498, test loss = 0.734354
  Training set accuracy = 0.847400, Test set accuracy = 0.849000
 epoch 30/30. Took 0.35558 seconds. 
  Full-batch training loss = 0.726056, test loss = 0.717453
  Training set accuracy = 0.850400, Test set accuracy = 0.851600
Elapsed time is 23.484873 seconds.
End Training
-----
Params 5000 0.001 0.30 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.1438 seconds. 
  Full-batch training loss = 2.283452, test loss = 2.285843
  Training set accuracy = 0.163000, Test set accuracy = 0.156000
 epoch 2/30. Took 0.13444 seconds. 
  Full-batch training loss = 2.269391, test loss = 2.271844
  Training set accuracy = 0.265200, Test set accuracy = 0.251800
 epoch 3/30. Took 0.12871 seconds. 
  Full-batch training loss = 2.255371, test loss = 2.257870
  Training set accuracy = 0.323200, Test set accuracy = 0.311600
 epoch 4/30. Took 0.13689 seconds. 
  Full-batch training loss = 2.241040, test loss = 2.243569
  Training set accuracy = 0.359600, Test set accuracy = 0.351800
 epoch 5/30. Took 0.14852 seconds. 
  Full-batch training loss = 2.226440, test loss = 2.228913
  Training set accuracy = 0.384800, Test set accuracy = 0.376000
 epoch 6/30. Took 0.13456 seconds. 
  Full-batch training loss = 2.210873, test loss = 2.213336
  Training set accuracy = 0.407400, Test set accuracy = 0.398500
 epoch 7/30. Took 0.13782 seconds. 
  Full-batch training loss = 2.194401, test loss = 2.196849
  Training set accuracy = 0.419600, Test set accuracy = 0.416300
 epoch 8/30. Took 0.13624 seconds. 
  Full-batch training loss = 2.177084, test loss = 2.179449
  Training set accuracy = 0.437800, Test set accuracy = 0.432100
 epoch 9/30. Took 0.13598 seconds. 
  Full-batch training loss = 2.158125, test loss = 2.160479
  Training set accuracy = 0.456600, Test set accuracy = 0.447700
 epoch 10/30. Took 0.13632 seconds. 
  Full-batch training loss = 2.137551, test loss = 2.139892
  Training set accuracy = 0.473000, Test set accuracy = 0.463900
 epoch 11/30. Took 0.1505 seconds. 
  Full-batch training loss = 2.115706, test loss = 2.118066
  Training set accuracy = 0.488400, Test set accuracy = 0.479800
 epoch 12/30. Took 0.13399 seconds. 
  Full-batch training loss = 2.092134, test loss = 2.094434
  Training set accuracy = 0.499400, Test set accuracy = 0.492100
 epoch 13/30. Took 0.13612 seconds. 
  Full-batch training loss = 2.066660, test loss = 2.068932
  Training set accuracy = 0.510200, Test set accuracy = 0.503800
 epoch 14/30. Took 0.13314 seconds. 
  Full-batch training loss = 2.039382, test loss = 2.041605
  Training set accuracy = 0.523000, Test set accuracy = 0.512500
 epoch 15/30. Took 0.13641 seconds. 
  Full-batch training loss = 2.010246, test loss = 2.012373
  Training set accuracy = 0.532000, Test set accuracy = 0.521900
 epoch 16/30. Took 0.1377 seconds. 
  Full-batch training loss = 1.979621, test loss = 1.981654
  Training set accuracy = 0.541200, Test set accuracy = 0.531400
 epoch 17/30. Took 0.1363 seconds. 
  Full-batch training loss = 1.947511, test loss = 1.949427
  Training set accuracy = 0.549200, Test set accuracy = 0.541600
 epoch 18/30. Took 0.13955 seconds. 
  Full-batch training loss = 1.913839, test loss = 1.915643
  Training set accuracy = 0.558200, Test set accuracy = 0.551500
 epoch 19/30. Took 0.13507 seconds. 
  Full-batch training loss = 1.878199, test loss = 1.879920
  Training set accuracy = 0.569400, Test set accuracy = 0.560500
 epoch 20/30. Took 0.13631 seconds. 
  Full-batch training loss = 1.841043, test loss = 1.842595
  Training set accuracy = 0.580600, Test set accuracy = 0.570400
 epoch 21/30. Took 0.13509 seconds. 
  Full-batch training loss = 1.802776, test loss = 1.804243
  Training set accuracy = 0.593800, Test set accuracy = 0.583500
 epoch 22/30. Took 0.13659 seconds. 
  Full-batch training loss = 1.762480, test loss = 1.763791
  Training set accuracy = 0.607400, Test set accuracy = 0.598300
 epoch 23/30. Took 0.13641 seconds. 
  Full-batch training loss = 1.720822, test loss = 1.722105
  Training set accuracy = 0.619800, Test set accuracy = 0.612400
 epoch 24/30. Took 0.13452 seconds. 
  Full-batch training loss = 1.677523, test loss = 1.678803
  Training set accuracy = 0.634400, Test set accuracy = 0.626300
 epoch 25/30. Took 0.13826 seconds. 
  Full-batch training loss = 1.633796, test loss = 1.635021
  Training set accuracy = 0.649000, Test set accuracy = 0.640400
 epoch 26/30. Took 0.13583 seconds. 
  Full-batch training loss = 1.589026, test loss = 1.590080
  Training set accuracy = 0.663200, Test set accuracy = 0.651700
 epoch 27/30. Took 0.13341 seconds. 
  Full-batch training loss = 1.543933, test loss = 1.544930
  Training set accuracy = 0.673400, Test set accuracy = 0.663100
 epoch 28/30. Took 0.12876 seconds. 
  Full-batch training loss = 1.499427, test loss = 1.500340
  Training set accuracy = 0.681400, Test set accuracy = 0.676200
 epoch 29/30. Took 0.1354 seconds. 
  Full-batch training loss = 1.454572, test loss = 1.455501
  Training set accuracy = 0.692600, Test set accuracy = 0.685900
 epoch 30/30. Took 0.13598 seconds. 
  Full-batch training loss = 1.410533, test loss = 1.411413
  Training set accuracy = 0.699600, Test set accuracy = 0.695500
Elapsed time is 9.491753 seconds.
End Training
-----
Params 5000 0.001 0.30 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23265 seconds. 
  Full-batch training loss = 2.279446, test loss = 2.277549
  Training set accuracy = 0.155000, Test set accuracy = 0.155800
 epoch 2/30. Took 0.23247 seconds. 
  Full-batch training loss = 2.261886, test loss = 2.259761
  Training set accuracy = 0.179600, Test set accuracy = 0.183300
 epoch 3/30. Took 0.2244 seconds. 
  Full-batch training loss = 2.243909, test loss = 2.241514
  Training set accuracy = 0.226600, Test set accuracy = 0.232900
 epoch 4/30. Took 0.22808 seconds. 
  Full-batch training loss = 2.225353, test loss = 2.222722
  Training set accuracy = 0.296400, Test set accuracy = 0.304500
 epoch 5/30. Took 0.22833 seconds. 
  Full-batch training loss = 2.205641, test loss = 2.202685
  Training set accuracy = 0.374600, Test set accuracy = 0.384200
 epoch 6/30. Took 0.22786 seconds. 
  Full-batch training loss = 2.184921, test loss = 2.181601
  Training set accuracy = 0.442800, Test set accuracy = 0.451400
 epoch 7/30. Took 0.22827 seconds. 
  Full-batch training loss = 2.162745, test loss = 2.159006
  Training set accuracy = 0.490800, Test set accuracy = 0.503100
 epoch 8/30. Took 0.22778 seconds. 
  Full-batch training loss = 2.138565, test loss = 2.134423
  Training set accuracy = 0.526200, Test set accuracy = 0.540700
 epoch 9/30. Took 0.22405 seconds. 
  Full-batch training loss = 2.112441, test loss = 2.107903
  Training set accuracy = 0.552200, Test set accuracy = 0.564300
 epoch 10/30. Took 0.22728 seconds. 
  Full-batch training loss = 2.084083, test loss = 2.078992
  Training set accuracy = 0.579200, Test set accuracy = 0.588500
 epoch 11/30. Took 0.22674 seconds. 
  Full-batch training loss = 2.053611, test loss = 2.048073
  Training set accuracy = 0.593200, Test set accuracy = 0.607600
 epoch 12/30. Took 0.22658 seconds. 
  Full-batch training loss = 2.020257, test loss = 2.014273
  Training set accuracy = 0.607800, Test set accuracy = 0.621800
 epoch 13/30. Took 0.22838 seconds. 
  Full-batch training loss = 1.984705, test loss = 1.978160
  Training set accuracy = 0.622800, Test set accuracy = 0.634300
 epoch 14/30. Took 0.23163 seconds. 
  Full-batch training loss = 1.946831, test loss = 1.939771
  Training set accuracy = 0.639200, Test set accuracy = 0.646500
 epoch 15/30. Took 0.22786 seconds. 
  Full-batch training loss = 1.906542, test loss = 1.898906
  Training set accuracy = 0.655400, Test set accuracy = 0.662200
 epoch 16/30. Took 0.22781 seconds. 
  Full-batch training loss = 1.863697, test loss = 1.855504
  Training set accuracy = 0.667600, Test set accuracy = 0.675100
 epoch 17/30. Took 0.2279 seconds. 
  Full-batch training loss = 1.818447, test loss = 1.809610
  Training set accuracy = 0.684400, Test set accuracy = 0.690500
 epoch 18/30. Took 0.22881 seconds. 
  Full-batch training loss = 1.771550, test loss = 1.762080
  Training set accuracy = 0.696800, Test set accuracy = 0.702900
 epoch 19/30. Took 0.22747 seconds. 
  Full-batch training loss = 1.722603, test loss = 1.712275
  Training set accuracy = 0.706200, Test set accuracy = 0.713400
 epoch 20/30. Took 0.23857 seconds. 
  Full-batch training loss = 1.671873, test loss = 1.660799
  Training set accuracy = 0.716800, Test set accuracy = 0.725000
 epoch 21/30. Took 0.2385 seconds. 
  Full-batch training loss = 1.619805, test loss = 1.608055
  Training set accuracy = 0.728000, Test set accuracy = 0.737200
 epoch 22/30. Took 0.22007 seconds. 
  Full-batch training loss = 1.567576, test loss = 1.555142
  Training set accuracy = 0.732600, Test set accuracy = 0.743200
 epoch 23/30. Took 0.21966 seconds. 
  Full-batch training loss = 1.514347, test loss = 1.501288
  Training set accuracy = 0.737800, Test set accuracy = 0.748700
 epoch 24/30. Took 0.2322 seconds. 
  Full-batch training loss = 1.460793, test loss = 1.447006
  Training set accuracy = 0.745000, Test set accuracy = 0.753400
 epoch 25/30. Took 0.21951 seconds. 
  Full-batch training loss = 1.408615, test loss = 1.394334
  Training set accuracy = 0.749800, Test set accuracy = 0.758700
 epoch 26/30. Took 0.21965 seconds. 
  Full-batch training loss = 1.357223, test loss = 1.342401
  Training set accuracy = 0.755600, Test set accuracy = 0.762600
 epoch 27/30. Took 0.23954 seconds. 
  Full-batch training loss = 1.306934, test loss = 1.291484
  Training set accuracy = 0.758200, Test set accuracy = 0.768200
 epoch 28/30. Took 0.24652 seconds. 
  Full-batch training loss = 1.258732, test loss = 1.242965
  Training set accuracy = 0.761400, Test set accuracy = 0.773600
 epoch 29/30. Took 0.21864 seconds. 
  Full-batch training loss = 1.211822, test loss = 1.195612
  Training set accuracy = 0.764000, Test set accuracy = 0.777100
 epoch 30/30. Took 0.21974 seconds. 
  Full-batch training loss = 1.167701, test loss = 1.151284
  Training set accuracy = 0.768000, Test set accuracy = 0.782600
Elapsed time is 15.228244 seconds.
End Training
-----
Params 5000 0.001 0.30 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.59766 seconds. 
  Full-batch training loss = 2.287063, test loss = 2.287039
  Training set accuracy = 0.113400, Test set accuracy = 0.119700
 epoch 2/30. Took 0.59811 seconds. 
  Full-batch training loss = 2.263840, test loss = 2.263807
  Training set accuracy = 0.198800, Test set accuracy = 0.216400
 epoch 3/30. Took 0.59175 seconds. 
  Full-batch training loss = 2.240599, test loss = 2.240559
  Training set accuracy = 0.339200, Test set accuracy = 0.353300
 epoch 4/30. Took 0.63739 seconds. 
  Full-batch training loss = 2.216757, test loss = 2.216654
  Training set accuracy = 0.457200, Test set accuracy = 0.463000
 epoch 5/30. Took 0.60376 seconds. 
  Full-batch training loss = 2.191921, test loss = 2.191756
  Training set accuracy = 0.535400, Test set accuracy = 0.546000
 epoch 6/30. Took 0.58786 seconds. 
  Full-batch training loss = 2.165366, test loss = 2.165127
  Training set accuracy = 0.585600, Test set accuracy = 0.592800
 epoch 7/30. Took 0.60171 seconds. 
  Full-batch training loss = 2.136979, test loss = 2.136638
  Training set accuracy = 0.627800, Test set accuracy = 0.626400
 epoch 8/30. Took 0.59783 seconds. 
  Full-batch training loss = 2.106168, test loss = 2.105632
  Training set accuracy = 0.648200, Test set accuracy = 0.646300
 epoch 9/30. Took 0.58644 seconds. 
  Full-batch training loss = 2.072752, test loss = 2.071951
  Training set accuracy = 0.671600, Test set accuracy = 0.667700
 epoch 10/30. Took 0.60207 seconds. 
  Full-batch training loss = 2.035958, test loss = 2.034931
  Training set accuracy = 0.685800, Test set accuracy = 0.682200
 epoch 11/30. Took 0.63393 seconds. 
  Full-batch training loss = 1.995929, test loss = 1.994673
  Training set accuracy = 0.696200, Test set accuracy = 0.694300
 epoch 12/30. Took 0.58774 seconds. 
  Full-batch training loss = 1.952494, test loss = 1.950921
  Training set accuracy = 0.709800, Test set accuracy = 0.705900
 epoch 13/30. Took 0.59323 seconds. 
  Full-batch training loss = 1.905340, test loss = 1.903367
  Training set accuracy = 0.718200, Test set accuracy = 0.716000
 epoch 14/30. Took 0.59698 seconds. 
  Full-batch training loss = 1.854006, test loss = 1.851642
  Training set accuracy = 0.722600, Test set accuracy = 0.721300
 epoch 15/30. Took 0.59186 seconds. 
  Full-batch training loss = 1.798716, test loss = 1.795970
  Training set accuracy = 0.729600, Test set accuracy = 0.729600
 epoch 16/30. Took 0.5946 seconds. 
  Full-batch training loss = 1.740198, test loss = 1.737033
  Training set accuracy = 0.736200, Test set accuracy = 0.736300
 epoch 17/30. Took 0.59144 seconds. 
  Full-batch training loss = 1.679159, test loss = 1.675533
  Training set accuracy = 0.743400, Test set accuracy = 0.743900
 epoch 18/30. Took 0.59359 seconds. 
  Full-batch training loss = 1.615261, test loss = 1.611131
  Training set accuracy = 0.752800, Test set accuracy = 0.750800
 epoch 19/30. Took 0.60354 seconds. 
  Full-batch training loss = 1.549997, test loss = 1.545383
  Training set accuracy = 0.759000, Test set accuracy = 0.757300
 epoch 20/30. Took 0.59331 seconds. 
  Full-batch training loss = 1.484279, test loss = 1.479296
  Training set accuracy = 0.763000, Test set accuracy = 0.761900
 epoch 21/30. Took 0.5989 seconds. 
  Full-batch training loss = 1.419090, test loss = 1.413786
  Training set accuracy = 0.767600, Test set accuracy = 0.767100
 epoch 22/30. Took 0.59576 seconds. 
  Full-batch training loss = 1.355252, test loss = 1.349676
  Training set accuracy = 0.773800, Test set accuracy = 0.773100
 epoch 23/30. Took 0.63638 seconds. 
  Full-batch training loss = 1.293680, test loss = 1.287885
  Training set accuracy = 0.782200, Test set accuracy = 0.779200
 epoch 24/30. Took 0.61218 seconds. 
  Full-batch training loss = 1.235307, test loss = 1.229383
  Training set accuracy = 0.787400, Test set accuracy = 0.784000
 epoch 25/30. Took 0.59532 seconds. 
  Full-batch training loss = 1.180248, test loss = 1.174245
  Training set accuracy = 0.794000, Test set accuracy = 0.792000
 epoch 26/30. Took 0.63967 seconds. 
  Full-batch training loss = 1.128572, test loss = 1.122557
  Training set accuracy = 0.797800, Test set accuracy = 0.796000
 epoch 27/30. Took 0.60978 seconds. 
  Full-batch training loss = 1.080435, test loss = 1.074393
  Training set accuracy = 0.805400, Test set accuracy = 0.805300
 epoch 28/30. Took 0.60779 seconds. 
  Full-batch training loss = 1.036032, test loss = 1.029805
  Training set accuracy = 0.808400, Test set accuracy = 0.807000
 epoch 29/30. Took 0.59464 seconds. 
  Full-batch training loss = 0.994867, test loss = 0.988558
  Training set accuracy = 0.812600, Test set accuracy = 0.812000
 epoch 30/30. Took 0.59269 seconds. 
  Full-batch training loss = 0.957166, test loss = 0.951476
  Training set accuracy = 0.817000, Test set accuracy = 0.816400
Elapsed time is 38.229599 seconds.
End Training
-----
Params 5000 0.001 0.30 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.16143 seconds. 
  Full-batch training loss = 2.301203, test loss = 2.301553
  Training set accuracy = 0.096000, Test set accuracy = 0.098600
 epoch 2/30. Took 0.16261 seconds. 
  Full-batch training loss = 2.297094, test loss = 2.297503
  Training set accuracy = 0.098000, Test set accuracy = 0.100600
 epoch 3/30. Took 0.16215 seconds. 
  Full-batch training loss = 2.293153, test loss = 2.293628
  Training set accuracy = 0.101600, Test set accuracy = 0.104500
 epoch 4/30. Took 0.17085 seconds. 
  Full-batch training loss = 2.289328, test loss = 2.289825
  Training set accuracy = 0.109400, Test set accuracy = 0.110800
 epoch 5/30. Took 0.16053 seconds. 
  Full-batch training loss = 2.285424, test loss = 2.285987
  Training set accuracy = 0.118800, Test set accuracy = 0.120200
 epoch 6/30. Took 0.15216 seconds. 
  Full-batch training loss = 2.281463, test loss = 2.282024
  Training set accuracy = 0.130200, Test set accuracy = 0.133000
 epoch 7/30. Took 0.15102 seconds. 
  Full-batch training loss = 2.277426, test loss = 2.278009
  Training set accuracy = 0.148600, Test set accuracy = 0.151100
 epoch 8/30. Took 0.15675 seconds. 
  Full-batch training loss = 2.273249, test loss = 2.273851
  Training set accuracy = 0.174200, Test set accuracy = 0.173200
 epoch 9/30. Took 0.16297 seconds. 
  Full-batch training loss = 2.268853, test loss = 2.269448
  Training set accuracy = 0.215400, Test set accuracy = 0.211600
 epoch 10/30. Took 0.15831 seconds. 
  Full-batch training loss = 2.264414, test loss = 2.265043
  Training set accuracy = 0.264000, Test set accuracy = 0.259600
 epoch 11/30. Took 0.1526 seconds. 
  Full-batch training loss = 2.259709, test loss = 2.260350
  Training set accuracy = 0.298800, Test set accuracy = 0.298200
 epoch 12/30. Took 0.15188 seconds. 
  Full-batch training loss = 2.254741, test loss = 2.255388
  Training set accuracy = 0.329200, Test set accuracy = 0.330100
 epoch 13/30. Took 0.15233 seconds. 
  Full-batch training loss = 2.249505, test loss = 2.250142
  Training set accuracy = 0.346800, Test set accuracy = 0.347900
 epoch 14/30. Took 0.15191 seconds. 
  Full-batch training loss = 2.244003, test loss = 2.244618
  Training set accuracy = 0.361000, Test set accuracy = 0.362100
 epoch 15/30. Took 0.15744 seconds. 
  Full-batch training loss = 2.238138, test loss = 2.238738
  Training set accuracy = 0.373600, Test set accuracy = 0.371200
 epoch 16/30. Took 0.15938 seconds. 
  Full-batch training loss = 2.231959, test loss = 2.232523
  Training set accuracy = 0.388000, Test set accuracy = 0.380300
 epoch 17/30. Took 0.15556 seconds. 
  Full-batch training loss = 2.225381, test loss = 2.225954
  Training set accuracy = 0.395800, Test set accuracy = 0.389000
 epoch 18/30. Took 0.15344 seconds. 
  Full-batch training loss = 2.218180, test loss = 2.218719
  Training set accuracy = 0.407000, Test set accuracy = 0.396900
 epoch 19/30. Took 0.15725 seconds. 
  Full-batch training loss = 2.210588, test loss = 2.211096
  Training set accuracy = 0.418000, Test set accuracy = 0.410100
 epoch 20/30. Took 0.15291 seconds. 
  Full-batch training loss = 2.202387, test loss = 2.202851
  Training set accuracy = 0.422400, Test set accuracy = 0.416600
 epoch 21/30. Took 0.15268 seconds. 
  Full-batch training loss = 2.193405, test loss = 2.193831
  Training set accuracy = 0.431600, Test set accuracy = 0.426300
 epoch 22/30. Took 0.15201 seconds. 
  Full-batch training loss = 2.183769, test loss = 2.184124
  Training set accuracy = 0.438400, Test set accuracy = 0.437100
 epoch 23/30. Took 0.15196 seconds. 
  Full-batch training loss = 2.173315, test loss = 2.173572
  Training set accuracy = 0.448600, Test set accuracy = 0.443800
 epoch 24/30. Took 0.1541 seconds. 
  Full-batch training loss = 2.162053, test loss = 2.162213
  Training set accuracy = 0.457200, Test set accuracy = 0.452700
 epoch 25/30. Took 0.15177 seconds. 
  Full-batch training loss = 2.149881, test loss = 2.149954
  Training set accuracy = 0.465000, Test set accuracy = 0.460700
 epoch 26/30. Took 0.16478 seconds. 
  Full-batch training loss = 2.136708, test loss = 2.136678
  Training set accuracy = 0.469800, Test set accuracy = 0.464800
 epoch 27/30. Took 0.1635 seconds. 
  Full-batch training loss = 2.122596, test loss = 2.122470
  Training set accuracy = 0.475400, Test set accuracy = 0.470900
 epoch 28/30. Took 0.16323 seconds. 
  Full-batch training loss = 2.107112, test loss = 2.106831
  Training set accuracy = 0.481000, Test set accuracy = 0.477800
 epoch 29/30. Took 0.16414 seconds. 
  Full-batch training loss = 2.090323, test loss = 2.089885
  Training set accuracy = 0.488800, Test set accuracy = 0.484800
 epoch 30/30. Took 0.17469 seconds. 
  Full-batch training loss = 2.072484, test loss = 2.071851
  Training set accuracy = 0.495800, Test set accuracy = 0.490300
Elapsed time is 10.776852 seconds.
End Training
-----
Params 5000 0.001 0.30 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28295 seconds. 
  Full-batch training loss = 2.303754, test loss = 2.304544
  Training set accuracy = 0.090200, Test set accuracy = 0.091500
 epoch 2/30. Took 0.27942 seconds. 
  Full-batch training loss = 2.299829, test loss = 2.300687
  Training set accuracy = 0.104200, Test set accuracy = 0.102400
 epoch 3/30. Took 0.29673 seconds. 
  Full-batch training loss = 2.295921, test loss = 2.296838
  Training set accuracy = 0.115600, Test set accuracy = 0.113400
 epoch 4/30. Took 0.28226 seconds. 
  Full-batch training loss = 2.291992, test loss = 2.292963
  Training set accuracy = 0.133000, Test set accuracy = 0.127300
 epoch 5/30. Took 0.27438 seconds. 
  Full-batch training loss = 2.288079, test loss = 2.289091
  Training set accuracy = 0.158000, Test set accuracy = 0.150300
 epoch 6/30. Took 0.28554 seconds. 
  Full-batch training loss = 2.284051, test loss = 2.285088
  Training set accuracy = 0.188000, Test set accuracy = 0.177900
 epoch 7/30. Took 0.28033 seconds. 
  Full-batch training loss = 2.279880, test loss = 2.280953
  Training set accuracy = 0.213000, Test set accuracy = 0.204000
 epoch 8/30. Took 0.29173 seconds. 
  Full-batch training loss = 2.275553, test loss = 2.276677
  Training set accuracy = 0.238000, Test set accuracy = 0.223200
 epoch 9/30. Took 0.28369 seconds. 
  Full-batch training loss = 2.270986, test loss = 2.272134
  Training set accuracy = 0.258800, Test set accuracy = 0.247100
 epoch 10/30. Took 0.28375 seconds. 
  Full-batch training loss = 2.266245, test loss = 2.267442
  Training set accuracy = 0.280800, Test set accuracy = 0.272400
 epoch 11/30. Took 0.30639 seconds. 
  Full-batch training loss = 2.261257, test loss = 2.262489
  Training set accuracy = 0.305600, Test set accuracy = 0.297700
 epoch 12/30. Took 0.27577 seconds. 
  Full-batch training loss = 2.256005, test loss = 2.257242
  Training set accuracy = 0.325400, Test set accuracy = 0.323500
 epoch 13/30. Took 0.27996 seconds. 
  Full-batch training loss = 2.250416, test loss = 2.251667
  Training set accuracy = 0.339800, Test set accuracy = 0.341600
 epoch 14/30. Took 0.2861 seconds. 
  Full-batch training loss = 2.244396, test loss = 2.245647
  Training set accuracy = 0.354400, Test set accuracy = 0.356900
 epoch 15/30. Took 0.26973 seconds. 
  Full-batch training loss = 2.237939, test loss = 2.239227
  Training set accuracy = 0.366400, Test set accuracy = 0.371600
 epoch 16/30. Took 0.31709 seconds. 
  Full-batch training loss = 2.231012, test loss = 2.232306
  Training set accuracy = 0.381000, Test set accuracy = 0.382700
 epoch 17/30. Took 0.26909 seconds. 
  Full-batch training loss = 2.223378, test loss = 2.224696
  Training set accuracy = 0.394000, Test set accuracy = 0.393500
 epoch 18/30. Took 0.28174 seconds. 
  Full-batch training loss = 2.215222, test loss = 2.216565
  Training set accuracy = 0.401000, Test set accuracy = 0.403200
 epoch 19/30. Took 0.2849 seconds. 
  Full-batch training loss = 2.206362, test loss = 2.207715
  Training set accuracy = 0.408000, Test set accuracy = 0.409600
 epoch 20/30. Took 0.28262 seconds. 
  Full-batch training loss = 2.196377, test loss = 2.197740
  Training set accuracy = 0.409800, Test set accuracy = 0.413300
 epoch 21/30. Took 0.28289 seconds. 
  Full-batch training loss = 2.185885, test loss = 2.187242
  Training set accuracy = 0.415200, Test set accuracy = 0.416700
 epoch 22/30. Took 0.28375 seconds. 
  Full-batch training loss = 2.174280, test loss = 2.175639
  Training set accuracy = 0.418800, Test set accuracy = 0.418100
 epoch 23/30. Took 0.28262 seconds. 
  Full-batch training loss = 2.161398, test loss = 2.162770
  Training set accuracy = 0.423200, Test set accuracy = 0.421500
 epoch 24/30. Took 0.28507 seconds. 
  Full-batch training loss = 2.147346, test loss = 2.148747
  Training set accuracy = 0.427600, Test set accuracy = 0.421800
 epoch 25/30. Took 0.28368 seconds. 
  Full-batch training loss = 2.131883, test loss = 2.133323
  Training set accuracy = 0.435200, Test set accuracy = 0.429400
 epoch 26/30. Took 0.27711 seconds. 
  Full-batch training loss = 2.114857, test loss = 2.116323
  Training set accuracy = 0.439800, Test set accuracy = 0.435800
 epoch 27/30. Took 0.27707 seconds. 
  Full-batch training loss = 2.096338, test loss = 2.097879
  Training set accuracy = 0.442600, Test set accuracy = 0.437300
 epoch 28/30. Took 0.28477 seconds. 
  Full-batch training loss = 2.076200, test loss = 2.077802
  Training set accuracy = 0.445800, Test set accuracy = 0.442600
 epoch 29/30. Took 0.26996 seconds. 
  Full-batch training loss = 2.054486, test loss = 2.056136
  Training set accuracy = 0.454800, Test set accuracy = 0.450500
 epoch 30/30. Took 0.28428 seconds. 
  Full-batch training loss = 2.030893, test loss = 2.032585
  Training set accuracy = 0.463000, Test set accuracy = 0.456300
Elapsed time is 18.630610 seconds.
End Training
-----
Params 5000 0.001 0.30 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.82943 seconds. 
  Full-batch training loss = 2.306531, test loss = 2.305928
  Training set accuracy = 0.085200, Test set accuracy = 0.076600
 epoch 2/30. Took 0.82318 seconds. 
  Full-batch training loss = 2.300039, test loss = 2.299456
  Training set accuracy = 0.097200, Test set accuracy = 0.088700
 epoch 3/30. Took 0.82546 seconds. 
  Full-batch training loss = 2.293521, test loss = 2.292961
  Training set accuracy = 0.123800, Test set accuracy = 0.116300
 epoch 4/30. Took 0.88274 seconds. 
  Full-batch training loss = 2.286976, test loss = 2.286414
  Training set accuracy = 0.176000, Test set accuracy = 0.171000
 epoch 5/30. Took 0.87738 seconds. 
  Full-batch training loss = 2.280491, test loss = 2.279909
  Training set accuracy = 0.230000, Test set accuracy = 0.222100
 epoch 6/30. Took 0.82482 seconds. 
  Full-batch training loss = 2.273880, test loss = 2.273316
  Training set accuracy = 0.271000, Test set accuracy = 0.263700
 epoch 7/30. Took 0.88107 seconds. 
  Full-batch training loss = 2.267018, test loss = 2.266433
  Training set accuracy = 0.308800, Test set accuracy = 0.307400
 epoch 8/30. Took 0.8156 seconds. 
  Full-batch training loss = 2.259965, test loss = 2.259357
  Training set accuracy = 0.360200, Test set accuracy = 0.357200
 epoch 9/30. Took 0.82201 seconds. 
  Full-batch training loss = 2.252592, test loss = 2.251959
  Training set accuracy = 0.393600, Test set accuracy = 0.390700
 epoch 10/30. Took 0.85014 seconds. 
  Full-batch training loss = 2.244915, test loss = 2.244246
  Training set accuracy = 0.434000, Test set accuracy = 0.430300
 epoch 11/30. Took 0.85001 seconds. 
  Full-batch training loss = 2.236781, test loss = 2.236085
  Training set accuracy = 0.460000, Test set accuracy = 0.455000
 epoch 12/30. Took 0.82469 seconds. 
  Full-batch training loss = 2.228183, test loss = 2.227412
  Training set accuracy = 0.485000, Test set accuracy = 0.481100
 epoch 13/30. Took 0.82633 seconds. 
  Full-batch training loss = 2.218884, test loss = 2.218055
  Training set accuracy = 0.495600, Test set accuracy = 0.495000
 epoch 14/30. Took 0.82013 seconds. 
  Full-batch training loss = 2.209091, test loss = 2.208169
  Training set accuracy = 0.507400, Test set accuracy = 0.504300
 epoch 15/30. Took 0.82755 seconds. 
  Full-batch training loss = 2.198556, test loss = 2.197518
  Training set accuracy = 0.512600, Test set accuracy = 0.510300
 epoch 16/30. Took 0.81762 seconds. 
  Full-batch training loss = 2.187058, test loss = 2.185900
  Training set accuracy = 0.519600, Test set accuracy = 0.518000
 epoch 17/30. Took 0.82866 seconds. 
  Full-batch training loss = 2.174456, test loss = 2.173153
  Training set accuracy = 0.528600, Test set accuracy = 0.526400
 epoch 18/30. Took 0.839 seconds. 
  Full-batch training loss = 2.160709, test loss = 2.159317
  Training set accuracy = 0.529000, Test set accuracy = 0.526100
 epoch 19/30. Took 0.82893 seconds. 
  Full-batch training loss = 2.145703, test loss = 2.144150
  Training set accuracy = 0.534600, Test set accuracy = 0.529600
 epoch 20/30. Took 0.82653 seconds. 
  Full-batch training loss = 2.129365, test loss = 2.127570
  Training set accuracy = 0.545600, Test set accuracy = 0.540400
 epoch 21/30. Took 0.82073 seconds. 
  Full-batch training loss = 2.111410, test loss = 2.109370
  Training set accuracy = 0.554800, Test set accuracy = 0.552000
 epoch 22/30. Took 0.82059 seconds. 
  Full-batch training loss = 2.091784, test loss = 2.089521
  Training set accuracy = 0.562000, Test set accuracy = 0.556900
 epoch 23/30. Took 0.82356 seconds. 
  Full-batch training loss = 2.070088, test loss = 2.067533
  Training set accuracy = 0.571400, Test set accuracy = 0.566800
 epoch 24/30. Took 0.82345 seconds. 
  Full-batch training loss = 2.046490, test loss = 2.043554
  Training set accuracy = 0.582000, Test set accuracy = 0.577700
 epoch 25/30. Took 0.8249 seconds. 
  Full-batch training loss = 2.020504, test loss = 2.017152
  Training set accuracy = 0.592000, Test set accuracy = 0.587300
 epoch 26/30. Took 0.83118 seconds. 
  Full-batch training loss = 1.991991, test loss = 1.988185
  Training set accuracy = 0.600400, Test set accuracy = 0.594500
 epoch 27/30. Took 0.87284 seconds. 
  Full-batch training loss = 1.960972, test loss = 1.956643
  Training set accuracy = 0.609400, Test set accuracy = 0.605200
 epoch 28/30. Took 0.82512 seconds. 
  Full-batch training loss = 1.927105, test loss = 1.922194
  Training set accuracy = 0.617800, Test set accuracy = 0.616800
 epoch 29/30. Took 0.82904 seconds. 
  Full-batch training loss = 1.890123, test loss = 1.884479
  Training set accuracy = 0.627600, Test set accuracy = 0.627700
 epoch 30/30. Took 0.82349 seconds. 
  Full-batch training loss = 1.850414, test loss = 1.843976
  Training set accuracy = 0.636600, Test set accuracy = 0.636000
Elapsed time is 52.568532 seconds.
End Training
-----
Params 5000 0.001 0.40 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11635 seconds. 
  Full-batch training loss = 2.278660, test loss = 2.279599
  Training set accuracy = 0.171400, Test set accuracy = 0.166800
 epoch 2/30. Took 0.10969 seconds. 
  Full-batch training loss = 2.230237, test loss = 2.229160
  Training set accuracy = 0.263000, Test set accuracy = 0.258800
 epoch 3/30. Took 0.10894 seconds. 
  Full-batch training loss = 2.182265, test loss = 2.179541
  Training set accuracy = 0.370400, Test set accuracy = 0.373600
 epoch 4/30. Took 0.11707 seconds. 
  Full-batch training loss = 2.134259, test loss = 2.130059
  Training set accuracy = 0.464800, Test set accuracy = 0.469700
 epoch 5/30. Took 0.10861 seconds. 
  Full-batch training loss = 2.085598, test loss = 2.080358
  Training set accuracy = 0.527800, Test set accuracy = 0.532400
 epoch 6/30. Took 0.10692 seconds. 
  Full-batch training loss = 2.035661, test loss = 2.029199
  Training set accuracy = 0.581400, Test set accuracy = 0.587100
 epoch 7/30. Took 0.11736 seconds. 
  Full-batch training loss = 1.984995, test loss = 1.977647
  Training set accuracy = 0.624200, Test set accuracy = 0.630200
 epoch 8/30. Took 0.10688 seconds. 
  Full-batch training loss = 1.932757, test loss = 1.924582
  Training set accuracy = 0.654200, Test set accuracy = 0.661000
 epoch 9/30. Took 0.11115 seconds. 
  Full-batch training loss = 1.878850, test loss = 1.869981
  Training set accuracy = 0.678400, Test set accuracy = 0.686400
 epoch 10/30. Took 0.10954 seconds. 
  Full-batch training loss = 1.823984, test loss = 1.814283
  Training set accuracy = 0.699200, Test set accuracy = 0.703300
 epoch 11/30. Took 0.10973 seconds. 
  Full-batch training loss = 1.768272, test loss = 1.757996
  Training set accuracy = 0.719600, Test set accuracy = 0.723400
 epoch 12/30. Took 0.10868 seconds. 
  Full-batch training loss = 1.712024, test loss = 1.701384
  Training set accuracy = 0.734800, Test set accuracy = 0.738800
 epoch 13/30. Took 0.11449 seconds. 
  Full-batch training loss = 1.655978, test loss = 1.644967
  Training set accuracy = 0.750000, Test set accuracy = 0.752800
 epoch 14/30. Took 0.11289 seconds. 
  Full-batch training loss = 1.600383, test loss = 1.589289
  Training set accuracy = 0.756800, Test set accuracy = 0.763800
 epoch 15/30. Took 0.11312 seconds. 
  Full-batch training loss = 1.546489, test loss = 1.535230
  Training set accuracy = 0.768200, Test set accuracy = 0.773300
 epoch 16/30. Took 0.11254 seconds. 
  Full-batch training loss = 1.493390, test loss = 1.482148
  Training set accuracy = 0.775400, Test set accuracy = 0.781500
 epoch 17/30. Took 0.10922 seconds. 
  Full-batch training loss = 1.442227, test loss = 1.431018
  Training set accuracy = 0.785400, Test set accuracy = 0.788200
 epoch 18/30. Took 0.10931 seconds. 
  Full-batch training loss = 1.392760, test loss = 1.381798
  Training set accuracy = 0.788200, Test set accuracy = 0.793800
 epoch 19/30. Took 0.10875 seconds. 
  Full-batch training loss = 1.345778, test loss = 1.335004
  Training set accuracy = 0.794400, Test set accuracy = 0.798400
 epoch 20/30. Took 0.10819 seconds. 
  Full-batch training loss = 1.300285, test loss = 1.289962
  Training set accuracy = 0.800400, Test set accuracy = 0.803000
 epoch 21/30. Took 0.10932 seconds. 
  Full-batch training loss = 1.257510, test loss = 1.247489
  Training set accuracy = 0.804200, Test set accuracy = 0.806100
 epoch 22/30. Took 0.10758 seconds. 
  Full-batch training loss = 1.216766, test loss = 1.207215
  Training set accuracy = 0.807600, Test set accuracy = 0.809500
 epoch 23/30. Took 0.10586 seconds. 
  Full-batch training loss = 1.177964, test loss = 1.169058
  Training set accuracy = 0.812400, Test set accuracy = 0.812600
 epoch 24/30. Took 0.11836 seconds. 
  Full-batch training loss = 1.141492, test loss = 1.132941
  Training set accuracy = 0.816600, Test set accuracy = 0.815800
 epoch 25/30. Took 0.10985 seconds. 
  Full-batch training loss = 1.106559, test loss = 1.098527
  Training set accuracy = 0.819800, Test set accuracy = 0.817700
 epoch 26/30. Took 0.10949 seconds. 
  Full-batch training loss = 1.073909, test loss = 1.066593
  Training set accuracy = 0.823200, Test set accuracy = 0.820400
 epoch 27/30. Took 0.10985 seconds. 
  Full-batch training loss = 1.043853, test loss = 1.037044
  Training set accuracy = 0.827000, Test set accuracy = 0.821600
 epoch 28/30. Took 0.11022 seconds. 
  Full-batch training loss = 1.015332, test loss = 1.009141
  Training set accuracy = 0.829400, Test set accuracy = 0.825100
 epoch 29/30. Took 0.10982 seconds. 
  Full-batch training loss = 0.988034, test loss = 0.982434
  Training set accuracy = 0.831800, Test set accuracy = 0.826700
 epoch 30/30. Took 0.11223 seconds. 
  Full-batch training loss = 0.962260, test loss = 0.957207
  Training set accuracy = 0.833600, Test set accuracy = 0.828000
Elapsed time is 8.104953 seconds.
End Training
-----
Params 5000 0.001 0.40 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17475 seconds. 
  Full-batch training loss = 2.287610, test loss = 2.285201
  Training set accuracy = 0.140600, Test set accuracy = 0.146300
 epoch 2/30. Took 0.16654 seconds. 
  Full-batch training loss = 2.240979, test loss = 2.238066
  Training set accuracy = 0.178200, Test set accuracy = 0.180900
 epoch 3/30. Took 0.16854 seconds. 
  Full-batch training loss = 2.196497, test loss = 2.193013
  Training set accuracy = 0.275200, Test set accuracy = 0.283600
 epoch 4/30. Took 0.17928 seconds. 
  Full-batch training loss = 2.152193, test loss = 2.148072
  Training set accuracy = 0.387800, Test set accuracy = 0.385200
 epoch 5/30. Took 0.16697 seconds. 
  Full-batch training loss = 2.107384, test loss = 2.102657
  Training set accuracy = 0.469000, Test set accuracy = 0.463700
 epoch 6/30. Took 0.16683 seconds. 
  Full-batch training loss = 2.060700, test loss = 2.055364
  Training set accuracy = 0.534400, Test set accuracy = 0.527000
 epoch 7/30. Took 0.18044 seconds. 
  Full-batch training loss = 2.012518, test loss = 2.006600
  Training set accuracy = 0.584000, Test set accuracy = 0.571100
 epoch 8/30. Took 0.16729 seconds. 
  Full-batch training loss = 1.962734, test loss = 1.956321
  Training set accuracy = 0.614800, Test set accuracy = 0.604100
 epoch 9/30. Took 0.16811 seconds. 
  Full-batch training loss = 1.911542, test loss = 1.904608
  Training set accuracy = 0.644600, Test set accuracy = 0.632700
 epoch 10/30. Took 0.16858 seconds. 
  Full-batch training loss = 1.858901, test loss = 1.851327
  Training set accuracy = 0.661400, Test set accuracy = 0.654600
 epoch 11/30. Took 0.17733 seconds. 
  Full-batch training loss = 1.805535, test loss = 1.797304
  Training set accuracy = 0.679400, Test set accuracy = 0.674800
 epoch 12/30. Took 0.16872 seconds. 
  Full-batch training loss = 1.751242, test loss = 1.742460
  Training set accuracy = 0.698000, Test set accuracy = 0.693800
 epoch 13/30. Took 0.16987 seconds. 
  Full-batch training loss = 1.696645, test loss = 1.687290
  Training set accuracy = 0.715200, Test set accuracy = 0.710400
 epoch 14/30. Took 0.17014 seconds. 
  Full-batch training loss = 1.642136, test loss = 1.632367
  Training set accuracy = 0.723400, Test set accuracy = 0.719400
 epoch 15/30. Took 0.16889 seconds. 
  Full-batch training loss = 1.588538, test loss = 1.578441
  Training set accuracy = 0.735600, Test set accuracy = 0.732000
 epoch 16/30. Took 0.17962 seconds. 
  Full-batch training loss = 1.535815, test loss = 1.525496
  Training set accuracy = 0.747800, Test set accuracy = 0.739900
 epoch 17/30. Took 0.16896 seconds. 
  Full-batch training loss = 1.484343, test loss = 1.473731
  Training set accuracy = 0.758400, Test set accuracy = 0.750600
 epoch 18/30. Took 0.17297 seconds. 
  Full-batch training loss = 1.434301, test loss = 1.423427
  Training set accuracy = 0.766400, Test set accuracy = 0.759700
 epoch 19/30. Took 0.16587 seconds. 
  Full-batch training loss = 1.385978, test loss = 1.374905
  Training set accuracy = 0.776800, Test set accuracy = 0.768900
 epoch 20/30. Took 0.16764 seconds. 
  Full-batch training loss = 1.339977, test loss = 1.328828
  Training set accuracy = 0.780800, Test set accuracy = 0.777000
 epoch 21/30. Took 0.16833 seconds. 
  Full-batch training loss = 1.296323, test loss = 1.285073
  Training set accuracy = 0.789000, Test set accuracy = 0.784500
 epoch 22/30. Took 0.16909 seconds. 
  Full-batch training loss = 1.254375, test loss = 1.243137
  Training set accuracy = 0.794400, Test set accuracy = 0.790500
 epoch 23/30. Took 0.16834 seconds. 
  Full-batch training loss = 1.214447, test loss = 1.203112
  Training set accuracy = 0.800800, Test set accuracy = 0.796400
 epoch 24/30. Took 0.16741 seconds. 
  Full-batch training loss = 1.176597, test loss = 1.165377
  Training set accuracy = 0.802400, Test set accuracy = 0.798200
 epoch 25/30. Took 0.17142 seconds. 
  Full-batch training loss = 1.140867, test loss = 1.129549
  Training set accuracy = 0.806800, Test set accuracy = 0.803700
 epoch 26/30. Took 0.16947 seconds. 
  Full-batch training loss = 1.107308, test loss = 1.096123
  Training set accuracy = 0.808800, Test set accuracy = 0.806400
 epoch 27/30. Took 0.16862 seconds. 
  Full-batch training loss = 1.075649, test loss = 1.064423
  Training set accuracy = 0.813400, Test set accuracy = 0.811200
 epoch 28/30. Took 0.16851 seconds. 
  Full-batch training loss = 1.045951, test loss = 1.034832
  Training set accuracy = 0.818000, Test set accuracy = 0.814300
 epoch 29/30. Took 0.16517 seconds. 
  Full-batch training loss = 1.017913, test loss = 1.006955
  Training set accuracy = 0.821600, Test set accuracy = 0.817400
 epoch 30/30. Took 0.18814 seconds. 
  Full-batch training loss = 0.991369, test loss = 0.980443
  Training set accuracy = 0.825000, Test set accuracy = 0.819400
Elapsed time is 11.717596 seconds.
End Training
-----
Params 5000 0.001 0.40 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.3734 seconds. 
  Full-batch training loss = 2.247321, test loss = 2.246236
  Training set accuracy = 0.204800, Test set accuracy = 0.207800
 epoch 2/30. Took 0.36627 seconds. 
  Full-batch training loss = 2.184843, test loss = 2.183342
  Training set accuracy = 0.378000, Test set accuracy = 0.387400
 epoch 3/30. Took 0.35438 seconds. 
  Full-batch training loss = 2.124475, test loss = 2.122470
  Training set accuracy = 0.510600, Test set accuracy = 0.513400
 epoch 4/30. Took 0.37404 seconds. 
  Full-batch training loss = 2.064884, test loss = 2.062320
  Training set accuracy = 0.585800, Test set accuracy = 0.600000
 epoch 5/30. Took 0.37424 seconds. 
  Full-batch training loss = 2.005092, test loss = 2.001937
  Training set accuracy = 0.633800, Test set accuracy = 0.641500
 epoch 6/30. Took 0.3553 seconds. 
  Full-batch training loss = 1.944656, test loss = 1.940924
  Training set accuracy = 0.662000, Test set accuracy = 0.667000
 epoch 7/30. Took 0.35652 seconds. 
  Full-batch training loss = 1.883385, test loss = 1.878963
  Training set accuracy = 0.684400, Test set accuracy = 0.688200
 epoch 8/30. Took 0.35635 seconds. 
  Full-batch training loss = 1.821548, test loss = 1.816470
  Training set accuracy = 0.701000, Test set accuracy = 0.702100
 epoch 9/30. Took 0.35676 seconds. 
  Full-batch training loss = 1.759216, test loss = 1.753442
  Training set accuracy = 0.715200, Test set accuracy = 0.713700
 epoch 10/30. Took 0.35611 seconds. 
  Full-batch training loss = 1.696479, test loss = 1.690087
  Training set accuracy = 0.727800, Test set accuracy = 0.726200
 epoch 11/30. Took 0.37584 seconds. 
  Full-batch training loss = 1.634661, test loss = 1.627460
  Training set accuracy = 0.738200, Test set accuracy = 0.738800
 epoch 12/30. Took 0.34912 seconds. 
  Full-batch training loss = 1.573544, test loss = 1.565763
  Training set accuracy = 0.745000, Test set accuracy = 0.746200
 epoch 13/30. Took 0.35184 seconds. 
  Full-batch training loss = 1.513920, test loss = 1.505463
  Training set accuracy = 0.751800, Test set accuracy = 0.756400
 epoch 14/30. Took 0.36624 seconds. 
  Full-batch training loss = 1.455975, test loss = 1.447060
  Training set accuracy = 0.759400, Test set accuracy = 0.764100
 epoch 15/30. Took 0.39565 seconds. 
  Full-batch training loss = 1.400094, test loss = 1.390589
  Training set accuracy = 0.767400, Test set accuracy = 0.770600
 epoch 16/30. Took 0.37558 seconds. 
  Full-batch training loss = 1.347004, test loss = 1.337146
  Training set accuracy = 0.774800, Test set accuracy = 0.779700
 epoch 17/30. Took 0.35488 seconds. 
  Full-batch training loss = 1.296178, test loss = 1.285926
  Training set accuracy = 0.782000, Test set accuracy = 0.786000
 epoch 18/30. Took 0.35798 seconds. 
  Full-batch training loss = 1.248042, test loss = 1.237510
  Training set accuracy = 0.792000, Test set accuracy = 0.793700
 epoch 19/30. Took 0.36662 seconds. 
  Full-batch training loss = 1.202604, test loss = 1.191839
  Training set accuracy = 0.793200, Test set accuracy = 0.798400
 epoch 20/30. Took 0.35654 seconds. 
  Full-batch training loss = 1.159859, test loss = 1.148999
  Training set accuracy = 0.798400, Test set accuracy = 0.802700
 epoch 21/30. Took 0.35745 seconds. 
  Full-batch training loss = 1.119849, test loss = 1.108958
  Training set accuracy = 0.802600, Test set accuracy = 0.807500
 epoch 22/30. Took 0.36521 seconds. 
  Full-batch training loss = 1.082310, test loss = 1.071426
  Training set accuracy = 0.804800, Test set accuracy = 0.810800
 epoch 23/30. Took 0.35224 seconds. 
  Full-batch training loss = 1.047264, test loss = 1.036372
  Training set accuracy = 0.808000, Test set accuracy = 0.815000
 epoch 24/30. Took 0.35235 seconds. 
  Full-batch training loss = 1.014653, test loss = 1.004018
  Training set accuracy = 0.811000, Test set accuracy = 0.818900
 epoch 25/30. Took 0.35596 seconds. 
  Full-batch training loss = 0.984114, test loss = 0.973661
  Training set accuracy = 0.815400, Test set accuracy = 0.822300
 epoch 26/30. Took 0.36426 seconds. 
  Full-batch training loss = 0.955494, test loss = 0.945237
  Training set accuracy = 0.819000, Test set accuracy = 0.825700
 epoch 27/30. Took 0.35711 seconds. 
  Full-batch training loss = 0.928770, test loss = 0.918802
  Training set accuracy = 0.822000, Test set accuracy = 0.828500
 epoch 28/30. Took 0.35631 seconds. 
  Full-batch training loss = 0.903812, test loss = 0.893978
  Training set accuracy = 0.824600, Test set accuracy = 0.831000
 epoch 29/30. Took 0.38751 seconds. 
  Full-batch training loss = 0.880485, test loss = 0.870905
  Training set accuracy = 0.827800, Test set accuracy = 0.832400
 epoch 30/30. Took 0.35558 seconds. 
  Full-batch training loss = 0.858643, test loss = 0.849488
  Training set accuracy = 0.830000, Test set accuracy = 0.835400
Elapsed time is 23.533257 seconds.
End Training
-----
Params 5000 0.001 0.40 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14251 seconds. 
  Full-batch training loss = 2.301691, test loss = 2.300570
  Training set accuracy = 0.110400, Test set accuracy = 0.110400
 epoch 2/30. Took 0.13455 seconds. 
  Full-batch training loss = 2.291769, test loss = 2.290504
  Training set accuracy = 0.113800, Test set accuracy = 0.113400
 epoch 3/30. Took 0.13569 seconds. 
  Full-batch training loss = 2.282408, test loss = 2.280994
  Training set accuracy = 0.119200, Test set accuracy = 0.118400
 epoch 4/30. Took 0.13579 seconds. 
  Full-batch training loss = 2.273151, test loss = 2.271575
  Training set accuracy = 0.131600, Test set accuracy = 0.132900
 epoch 5/30. Took 0.1318 seconds. 
  Full-batch training loss = 2.264042, test loss = 2.262320
  Training set accuracy = 0.158000, Test set accuracy = 0.163700
 epoch 6/30. Took 0.1293 seconds. 
  Full-batch training loss = 2.254568, test loss = 2.252670
  Training set accuracy = 0.192600, Test set accuracy = 0.203500
 epoch 7/30. Took 0.12839 seconds. 
  Full-batch training loss = 2.244803, test loss = 2.242739
  Training set accuracy = 0.226200, Test set accuracy = 0.242000
 epoch 8/30. Took 0.13002 seconds. 
  Full-batch training loss = 2.234801, test loss = 2.232499
  Training set accuracy = 0.263600, Test set accuracy = 0.284700
 epoch 9/30. Took 0.13919 seconds. 
  Full-batch training loss = 2.224395, test loss = 2.221823
  Training set accuracy = 0.300800, Test set accuracy = 0.320400
 epoch 10/30. Took 0.13501 seconds. 
  Full-batch training loss = 2.213391, test loss = 2.210546
  Training set accuracy = 0.342200, Test set accuracy = 0.365000
 epoch 11/30. Took 0.13631 seconds. 
  Full-batch training loss = 2.201986, test loss = 2.198891
  Training set accuracy = 0.374000, Test set accuracy = 0.397200
 epoch 12/30. Took 0.13602 seconds. 
  Full-batch training loss = 2.189978, test loss = 2.186625
  Training set accuracy = 0.403600, Test set accuracy = 0.430300
 epoch 13/30. Took 0.13596 seconds. 
  Full-batch training loss = 2.176934, test loss = 2.173266
  Training set accuracy = 0.436200, Test set accuracy = 0.455900
 epoch 14/30. Took 0.13567 seconds. 
  Full-batch training loss = 2.163602, test loss = 2.159603
  Training set accuracy = 0.458400, Test set accuracy = 0.478000
 epoch 15/30. Took 0.13572 seconds. 
  Full-batch training loss = 2.149512, test loss = 2.145169
  Training set accuracy = 0.483200, Test set accuracy = 0.497800
 epoch 16/30. Took 0.14422 seconds. 
  Full-batch training loss = 2.134737, test loss = 2.130002
  Training set accuracy = 0.500600, Test set accuracy = 0.516100
 epoch 17/30. Took 0.14014 seconds. 
  Full-batch training loss = 2.119190, test loss = 2.114015
  Training set accuracy = 0.517200, Test set accuracy = 0.529600
 epoch 18/30. Took 0.13484 seconds. 
  Full-batch training loss = 2.102849, test loss = 2.097300
  Training set accuracy = 0.533200, Test set accuracy = 0.543000
 epoch 19/30. Took 0.13686 seconds. 
  Full-batch training loss = 2.085772, test loss = 2.079763
  Training set accuracy = 0.548400, Test set accuracy = 0.557700
 epoch 20/30. Took 0.13623 seconds. 
  Full-batch training loss = 2.067410, test loss = 2.060939
  Training set accuracy = 0.563600, Test set accuracy = 0.573600
 epoch 21/30. Took 0.13646 seconds. 
  Full-batch training loss = 2.048026, test loss = 2.041064
  Training set accuracy = 0.577400, Test set accuracy = 0.586700
 epoch 22/30. Took 0.13563 seconds. 
  Full-batch training loss = 2.027793, test loss = 2.020367
  Training set accuracy = 0.590000, Test set accuracy = 0.598800
 epoch 23/30. Took 0.13479 seconds. 
  Full-batch training loss = 2.006804, test loss = 1.998912
  Training set accuracy = 0.602000, Test set accuracy = 0.611000
 epoch 24/30. Took 0.13618 seconds. 
  Full-batch training loss = 1.984665, test loss = 1.976256
  Training set accuracy = 0.610400, Test set accuracy = 0.619800
 epoch 25/30. Took 0.13588 seconds. 
  Full-batch training loss = 1.961885, test loss = 1.952888
  Training set accuracy = 0.627000, Test set accuracy = 0.638100
 epoch 26/30. Took 0.13609 seconds. 
  Full-batch training loss = 1.938184, test loss = 1.928698
  Training set accuracy = 0.639600, Test set accuracy = 0.649800
 epoch 27/30. Took 0.13618 seconds. 
  Full-batch training loss = 1.913636, test loss = 1.903593
  Training set accuracy = 0.657600, Test set accuracy = 0.666000
 epoch 28/30. Took 0.1348 seconds. 
  Full-batch training loss = 1.887901, test loss = 1.877343
  Training set accuracy = 0.668200, Test set accuracy = 0.677200
 epoch 29/30. Took 0.1348 seconds. 
  Full-batch training loss = 1.861658, test loss = 1.850551
  Training set accuracy = 0.672400, Test set accuracy = 0.683700
 epoch 30/30. Took 0.13553 seconds. 
  Full-batch training loss = 1.834922, test loss = 1.823329
  Training set accuracy = 0.680400, Test set accuracy = 0.692200
Elapsed time is 9.461922 seconds.
End Training
-----
Params 5000 0.001 0.40 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23295 seconds. 
  Full-batch training loss = 2.299254, test loss = 2.297782
  Training set accuracy = 0.083800, Test set accuracy = 0.083700
 epoch 2/30. Took 0.2245 seconds. 
  Full-batch training loss = 2.290251, test loss = 2.288940
  Training set accuracy = 0.103600, Test set accuracy = 0.105900
 epoch 3/30. Took 0.22779 seconds. 
  Full-batch training loss = 2.281428, test loss = 2.280269
  Training set accuracy = 0.125000, Test set accuracy = 0.126600
 epoch 4/30. Took 0.23637 seconds. 
  Full-batch training loss = 2.272620, test loss = 2.271630
  Training set accuracy = 0.143800, Test set accuracy = 0.145500
 epoch 5/30. Took 0.22784 seconds. 
  Full-batch training loss = 2.263514, test loss = 2.262651
  Training set accuracy = 0.170200, Test set accuracy = 0.170900
 epoch 6/30. Took 0.2273 seconds. 
  Full-batch training loss = 2.254028, test loss = 2.253306
  Training set accuracy = 0.218000, Test set accuracy = 0.215200
 epoch 7/30. Took 0.2281 seconds. 
  Full-batch training loss = 2.244092, test loss = 2.243522
  Training set accuracy = 0.262000, Test set accuracy = 0.257200
 epoch 8/30. Took 0.23967 seconds. 
  Full-batch training loss = 2.233761, test loss = 2.233315
  Training set accuracy = 0.307600, Test set accuracy = 0.306500
 epoch 9/30. Took 0.22403 seconds. 
  Full-batch training loss = 2.222876, test loss = 2.222560
  Training set accuracy = 0.344000, Test set accuracy = 0.337900
 epoch 10/30. Took 0.22203 seconds. 
  Full-batch training loss = 2.211246, test loss = 2.211046
  Training set accuracy = 0.374200, Test set accuracy = 0.372800
 epoch 11/30. Took 0.2353 seconds. 
  Full-batch training loss = 2.198945, test loss = 2.198834
  Training set accuracy = 0.416600, Test set accuracy = 0.413500
 epoch 12/30. Took 0.24057 seconds. 
  Full-batch training loss = 2.185906, test loss = 2.185903
  Training set accuracy = 0.445200, Test set accuracy = 0.446000
 epoch 13/30. Took 0.22962 seconds. 
  Full-batch training loss = 2.172080, test loss = 2.172148
  Training set accuracy = 0.487600, Test set accuracy = 0.480600
 epoch 14/30. Took 0.22797 seconds. 
  Full-batch training loss = 2.157276, test loss = 2.157446
  Training set accuracy = 0.518200, Test set accuracy = 0.511000
 epoch 15/30. Took 0.22783 seconds. 
  Full-batch training loss = 2.141463, test loss = 2.141714
  Training set accuracy = 0.544200, Test set accuracy = 0.538000
 epoch 16/30. Took 0.22651 seconds. 
  Full-batch training loss = 2.124540, test loss = 2.124860
  Training set accuracy = 0.564400, Test set accuracy = 0.562200
 epoch 17/30. Took 0.22817 seconds. 
  Full-batch training loss = 2.106384, test loss = 2.106796
  Training set accuracy = 0.583800, Test set accuracy = 0.582000
 epoch 18/30. Took 0.2237 seconds. 
  Full-batch training loss = 2.087340, test loss = 2.087751
  Training set accuracy = 0.599800, Test set accuracy = 0.597900
 epoch 19/30. Took 0.22955 seconds. 
  Full-batch training loss = 2.066927, test loss = 2.067377
  Training set accuracy = 0.609200, Test set accuracy = 0.609400
 epoch 20/30. Took 0.22775 seconds. 
  Full-batch training loss = 2.045289, test loss = 2.045705
  Training set accuracy = 0.618200, Test set accuracy = 0.621000
 epoch 21/30. Took 0.22842 seconds. 
  Full-batch training loss = 2.022222, test loss = 2.022660
  Training set accuracy = 0.626400, Test set accuracy = 0.627200
 epoch 22/30. Took 0.22867 seconds. 
  Full-batch training loss = 1.998142, test loss = 1.998467
  Training set accuracy = 0.633800, Test set accuracy = 0.633400
 epoch 23/30. Took 0.22799 seconds. 
  Full-batch training loss = 1.972752, test loss = 1.973043
  Training set accuracy = 0.639600, Test set accuracy = 0.638500
 epoch 24/30. Took 0.22931 seconds. 
  Full-batch training loss = 1.945235, test loss = 1.945478
  Training set accuracy = 0.644400, Test set accuracy = 0.643400
 epoch 25/30. Took 0.22804 seconds. 
  Full-batch training loss = 1.916439, test loss = 1.916662
  Training set accuracy = 0.649800, Test set accuracy = 0.648100
 epoch 26/30. Took 0.22852 seconds. 
  Full-batch training loss = 1.886415, test loss = 1.886510
  Training set accuracy = 0.655000, Test set accuracy = 0.653300
 epoch 27/30. Took 0.22787 seconds. 
  Full-batch training loss = 1.855270, test loss = 1.855265
  Training set accuracy = 0.661800, Test set accuracy = 0.662200
 epoch 28/30. Took 0.22915 seconds. 
  Full-batch training loss = 1.822515, test loss = 1.822304
  Training set accuracy = 0.669000, Test set accuracy = 0.669800
 epoch 29/30. Took 0.22174 seconds. 
  Full-batch training loss = 1.788290, test loss = 1.787967
  Training set accuracy = 0.675600, Test set accuracy = 0.674300
 epoch 30/30. Took 0.22883 seconds. 
  Full-batch training loss = 1.753004, test loss = 1.752491
  Training set accuracy = 0.684200, Test set accuracy = 0.682700
Elapsed time is 15.205529 seconds.
End Training
-----
Params 5000 0.001 0.40 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.60173 seconds. 
  Full-batch training loss = 2.287976, test loss = 2.287599
  Training set accuracy = 0.166600, Test set accuracy = 0.154400
 epoch 2/30. Took 0.61779 seconds. 
  Full-batch training loss = 2.275619, test loss = 2.275280
  Training set accuracy = 0.213000, Test set accuracy = 0.199000
 epoch 3/30. Took 0.6089 seconds. 
  Full-batch training loss = 2.263231, test loss = 2.262897
  Training set accuracy = 0.266600, Test set accuracy = 0.254900
 epoch 4/30. Took 0.61019 seconds. 
  Full-batch training loss = 2.250667, test loss = 2.250317
  Training set accuracy = 0.340400, Test set accuracy = 0.328500
 epoch 5/30. Took 0.59066 seconds. 
  Full-batch training loss = 2.237983, test loss = 2.237576
  Training set accuracy = 0.396200, Test set accuracy = 0.383200
 epoch 6/30. Took 0.59285 seconds. 
  Full-batch training loss = 2.224742, test loss = 2.224281
  Training set accuracy = 0.450800, Test set accuracy = 0.429600
 epoch 7/30. Took 0.59423 seconds. 
  Full-batch training loss = 2.211278, test loss = 2.210661
  Training set accuracy = 0.490000, Test set accuracy = 0.472500
 epoch 8/30. Took 0.6119 seconds. 
  Full-batch training loss = 2.196960, test loss = 2.196247
  Training set accuracy = 0.525200, Test set accuracy = 0.517800
 epoch 9/30. Took 0.64138 seconds. 
  Full-batch training loss = 2.181892, test loss = 2.181023
  Training set accuracy = 0.548600, Test set accuracy = 0.545300
 epoch 10/30. Took 0.595 seconds. 
  Full-batch training loss = 2.165668, test loss = 2.164624
  Training set accuracy = 0.575400, Test set accuracy = 0.573800
 epoch 11/30. Took 0.59473 seconds. 
  Full-batch training loss = 2.148473, test loss = 2.147242
  Training set accuracy = 0.589800, Test set accuracy = 0.594000
 epoch 12/30. Took 0.61329 seconds. 
  Full-batch training loss = 2.130070, test loss = 2.128654
  Training set accuracy = 0.603000, Test set accuracy = 0.608500
 epoch 13/30. Took 0.59785 seconds. 
  Full-batch training loss = 2.110400, test loss = 2.108720
  Training set accuracy = 0.616000, Test set accuracy = 0.619600
 epoch 14/30. Took 0.61112 seconds. 
  Full-batch training loss = 2.089256, test loss = 2.087339
  Training set accuracy = 0.624200, Test set accuracy = 0.629000
 epoch 15/30. Took 0.59417 seconds. 
  Full-batch training loss = 2.066507, test loss = 2.064273
  Training set accuracy = 0.635800, Test set accuracy = 0.640100
 epoch 16/30. Took 0.60452 seconds. 
  Full-batch training loss = 2.042246, test loss = 2.039720
  Training set accuracy = 0.645800, Test set accuracy = 0.649000
 epoch 17/30. Took 0.65189 seconds. 
  Full-batch training loss = 2.016228, test loss = 2.013311
  Training set accuracy = 0.655800, Test set accuracy = 0.657600
 epoch 18/30. Took 0.59164 seconds. 
  Full-batch training loss = 1.988395, test loss = 1.985112
  Training set accuracy = 0.660200, Test set accuracy = 0.665300
 epoch 19/30. Took 0.59137 seconds. 
  Full-batch training loss = 1.958622, test loss = 1.954905
  Training set accuracy = 0.667400, Test set accuracy = 0.672800
 epoch 20/30. Took 0.62143 seconds. 
  Full-batch training loss = 1.927232, test loss = 1.923007
  Training set accuracy = 0.675000, Test set accuracy = 0.681900
 epoch 21/30. Took 0.59503 seconds. 
  Full-batch training loss = 1.893904, test loss = 1.889168
  Training set accuracy = 0.683000, Test set accuracy = 0.686900
 epoch 22/30. Took 0.59384 seconds. 
  Full-batch training loss = 1.859006, test loss = 1.853671
  Training set accuracy = 0.687200, Test set accuracy = 0.690200
 epoch 23/30. Took 0.61168 seconds. 
  Full-batch training loss = 1.822238, test loss = 1.816240
  Training set accuracy = 0.693400, Test set accuracy = 0.695400
 epoch 24/30. Took 0.58674 seconds. 
  Full-batch training loss = 1.783837, test loss = 1.777090
  Training set accuracy = 0.697800, Test set accuracy = 0.702100
 epoch 25/30. Took 0.59506 seconds. 
  Full-batch training loss = 1.743841, test loss = 1.736273
  Training set accuracy = 0.703600, Test set accuracy = 0.707600
 epoch 26/30. Took 0.59317 seconds. 
  Full-batch training loss = 1.702492, test loss = 1.693960
  Training set accuracy = 0.706600, Test set accuracy = 0.715600
 epoch 27/30. Took 0.59196 seconds. 
  Full-batch training loss = 1.660019, test loss = 1.650538
  Training set accuracy = 0.709000, Test set accuracy = 0.722500
 epoch 28/30. Took 0.59163 seconds. 
  Full-batch training loss = 1.616572, test loss = 1.606040
  Training set accuracy = 0.716400, Test set accuracy = 0.728700
 epoch 29/30. Took 0.62762 seconds. 
  Full-batch training loss = 1.572497, test loss = 1.560974
  Training set accuracy = 0.722200, Test set accuracy = 0.731400
 epoch 30/30. Took 0.59211 seconds. 
  Full-batch training loss = 1.527871, test loss = 1.515219
  Training set accuracy = 0.725400, Test set accuracy = 0.735800
Elapsed time is 38.169457 seconds.
End Training
-----
Params 5000 0.001 0.40 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.16933 seconds. 
  Full-batch training loss = 2.303335, test loss = 2.304483
  Training set accuracy = 0.149000, Test set accuracy = 0.137400
 epoch 2/30. Took 0.16262 seconds. 
  Full-batch training loss = 2.301530, test loss = 2.302737
  Training set accuracy = 0.157600, Test set accuracy = 0.146500
 epoch 3/30. Took 0.16228 seconds. 
  Full-batch training loss = 2.299735, test loss = 2.300997
  Training set accuracy = 0.165400, Test set accuracy = 0.155200
 epoch 4/30. Took 0.16219 seconds. 
  Full-batch training loss = 2.298037, test loss = 2.299335
  Training set accuracy = 0.173800, Test set accuracy = 0.163900
 epoch 5/30. Took 0.15339 seconds. 
  Full-batch training loss = 2.296305, test loss = 2.297653
  Training set accuracy = 0.178800, Test set accuracy = 0.170700
 epoch 6/30. Took 0.16359 seconds. 
  Full-batch training loss = 2.294583, test loss = 2.295967
  Training set accuracy = 0.187000, Test set accuracy = 0.179900
 epoch 7/30. Took 0.16221 seconds. 
  Full-batch training loss = 2.292843, test loss = 2.294288
  Training set accuracy = 0.192800, Test set accuracy = 0.186500
 epoch 8/30. Took 0.16238 seconds. 
  Full-batch training loss = 2.291172, test loss = 2.292656
  Training set accuracy = 0.198400, Test set accuracy = 0.196700
 epoch 9/30. Took 0.16218 seconds. 
  Full-batch training loss = 2.289478, test loss = 2.291008
  Training set accuracy = 0.206000, Test set accuracy = 0.203900
 epoch 10/30. Took 0.16288 seconds. 
  Full-batch training loss = 2.287763, test loss = 2.289336
  Training set accuracy = 0.211800, Test set accuracy = 0.210700
 epoch 11/30. Took 0.16967 seconds. 
  Full-batch training loss = 2.286015, test loss = 2.287638
  Training set accuracy = 0.220200, Test set accuracy = 0.217300
 epoch 12/30. Took 0.15116 seconds. 
  Full-batch training loss = 2.284245, test loss = 2.285924
  Training set accuracy = 0.225600, Test set accuracy = 0.222800
 epoch 13/30. Took 0.15144 seconds. 
  Full-batch training loss = 2.282444, test loss = 2.284159
  Training set accuracy = 0.233000, Test set accuracy = 0.228800
 epoch 14/30. Took 0.16836 seconds. 
  Full-batch training loss = 2.280575, test loss = 2.282344
  Training set accuracy = 0.239400, Test set accuracy = 0.234100
 epoch 15/30. Took 0.16189 seconds. 
  Full-batch training loss = 2.278726, test loss = 2.280540
  Training set accuracy = 0.245000, Test set accuracy = 0.239100
 epoch 16/30. Took 0.16234 seconds. 
  Full-batch training loss = 2.276858, test loss = 2.278712
  Training set accuracy = 0.251800, Test set accuracy = 0.244200
 epoch 17/30. Took 0.16126 seconds. 
  Full-batch training loss = 2.274859, test loss = 2.276758
  Training set accuracy = 0.257600, Test set accuracy = 0.248100
 epoch 18/30. Took 0.16425 seconds. 
  Full-batch training loss = 2.272887, test loss = 2.274822
  Training set accuracy = 0.264800, Test set accuracy = 0.256700
 epoch 19/30. Took 0.16079 seconds. 
  Full-batch training loss = 2.270849, test loss = 2.272843
  Training set accuracy = 0.271400, Test set accuracy = 0.261400
 epoch 20/30. Took 0.15816 seconds. 
  Full-batch training loss = 2.268786, test loss = 2.270829
  Training set accuracy = 0.279600, Test set accuracy = 0.267500
 epoch 21/30. Took 0.16159 seconds. 
  Full-batch training loss = 2.266633, test loss = 2.268724
  Training set accuracy = 0.284600, Test set accuracy = 0.273300
 epoch 22/30. Took 0.1643 seconds. 
  Full-batch training loss = 2.264354, test loss = 2.266496
  Training set accuracy = 0.290800, Test set accuracy = 0.279400
 epoch 23/30. Took 0.16282 seconds. 
  Full-batch training loss = 2.261982, test loss = 2.264173
  Training set accuracy = 0.293400, Test set accuracy = 0.282100
 epoch 24/30. Took 0.16304 seconds. 
  Full-batch training loss = 2.259560, test loss = 2.261811
  Training set accuracy = 0.298200, Test set accuracy = 0.285400
 epoch 25/30. Took 0.16294 seconds. 
  Full-batch training loss = 2.257093, test loss = 2.259366
  Training set accuracy = 0.306000, Test set accuracy = 0.290700
 epoch 26/30. Took 0.17058 seconds. 
  Full-batch training loss = 2.254412, test loss = 2.256717
  Training set accuracy = 0.314600, Test set accuracy = 0.301300
 epoch 27/30. Took 0.1567 seconds. 
  Full-batch training loss = 2.251752, test loss = 2.254107
  Training set accuracy = 0.333600, Test set accuracy = 0.318400
 epoch 28/30. Took 0.15854 seconds. 
  Full-batch training loss = 2.248934, test loss = 2.251337
  Training set accuracy = 0.343600, Test set accuracy = 0.331300
 epoch 29/30. Took 0.16242 seconds. 
  Full-batch training loss = 2.245990, test loss = 2.248438
  Training set accuracy = 0.353400, Test set accuracy = 0.341200
 epoch 30/30. Took 0.15925 seconds. 
  Full-batch training loss = 2.242882, test loss = 2.245392
  Training set accuracy = 0.361000, Test set accuracy = 0.349700
Elapsed time is 10.905201 seconds.
End Training
-----
Params 5000 0.001 0.40 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28519 seconds. 
  Full-batch training loss = 2.300336, test loss = 2.298957
  Training set accuracy = 0.094400, Test set accuracy = 0.098100
 epoch 2/30. Took 0.30143 seconds. 
  Full-batch training loss = 2.298474, test loss = 2.297183
  Training set accuracy = 0.094600, Test set accuracy = 0.098200
 epoch 3/30. Took 0.28348 seconds. 
  Full-batch training loss = 2.296714, test loss = 2.295491
  Training set accuracy = 0.094600, Test set accuracy = 0.098700
 epoch 4/30. Took 0.28252 seconds. 
  Full-batch training loss = 2.294937, test loss = 2.293778
  Training set accuracy = 0.096600, Test set accuracy = 0.099800
 epoch 5/30. Took 0.28205 seconds. 
  Full-batch training loss = 2.293145, test loss = 2.292060
  Training set accuracy = 0.103800, Test set accuracy = 0.107500
 epoch 6/30. Took 0.28236 seconds. 
  Full-batch training loss = 2.291410, test loss = 2.290399
  Training set accuracy = 0.117200, Test set accuracy = 0.119600
 epoch 7/30. Took 0.27514 seconds. 
  Full-batch training loss = 2.289670, test loss = 2.288721
  Training set accuracy = 0.130000, Test set accuracy = 0.135800
 epoch 8/30. Took 0.27499 seconds. 
  Full-batch training loss = 2.287934, test loss = 2.287027
  Training set accuracy = 0.147400, Test set accuracy = 0.150800
 epoch 9/30. Took 0.28258 seconds. 
  Full-batch training loss = 2.286179, test loss = 2.285325
  Training set accuracy = 0.173200, Test set accuracy = 0.173400
 epoch 10/30. Took 0.2766 seconds. 
  Full-batch training loss = 2.284366, test loss = 2.283570
  Training set accuracy = 0.193400, Test set accuracy = 0.199300
 epoch 11/30. Took 0.28389 seconds. 
  Full-batch training loss = 2.282572, test loss = 2.281811
  Training set accuracy = 0.216800, Test set accuracy = 0.225500
 epoch 12/30. Took 0.27976 seconds. 
  Full-batch training loss = 2.280732, test loss = 2.280015
  Training set accuracy = 0.244400, Test set accuracy = 0.252100
 epoch 13/30. Took 0.28324 seconds. 
  Full-batch training loss = 2.278886, test loss = 2.278195
  Training set accuracy = 0.266600, Test set accuracy = 0.273400
 epoch 14/30. Took 0.28181 seconds. 
  Full-batch training loss = 2.276960, test loss = 2.276307
  Training set accuracy = 0.284400, Test set accuracy = 0.293500
 epoch 15/30. Took 0.28625 seconds. 
  Full-batch training loss = 2.275031, test loss = 2.274412
  Training set accuracy = 0.300000, Test set accuracy = 0.312500
 epoch 16/30. Took 0.31687 seconds. 
  Full-batch training loss = 2.272998, test loss = 2.272412
  Training set accuracy = 0.325400, Test set accuracy = 0.336700
 epoch 17/30. Took 0.28801 seconds. 
  Full-batch training loss = 2.270919, test loss = 2.270355
  Training set accuracy = 0.345800, Test set accuracy = 0.356600
 epoch 18/30. Took 0.29188 seconds. 
  Full-batch training loss = 2.268708, test loss = 2.268179
  Training set accuracy = 0.371400, Test set accuracy = 0.380900
 epoch 19/30. Took 0.28945 seconds. 
  Full-batch training loss = 2.266469, test loss = 2.265983
  Training set accuracy = 0.394800, Test set accuracy = 0.401400
 epoch 20/30. Took 0.29501 seconds. 
  Full-batch training loss = 2.264113, test loss = 2.263650
  Training set accuracy = 0.412000, Test set accuracy = 0.419700
 epoch 21/30. Took 0.28113 seconds. 
  Full-batch training loss = 2.261649, test loss = 2.261211
  Training set accuracy = 0.435400, Test set accuracy = 0.434800
 epoch 22/30. Took 0.28162 seconds. 
  Full-batch training loss = 2.259018, test loss = 2.258596
  Training set accuracy = 0.451800, Test set accuracy = 0.446000
 epoch 23/30. Took 0.2818 seconds. 
  Full-batch training loss = 2.256281, test loss = 2.255867
  Training set accuracy = 0.463200, Test set accuracy = 0.454400
 epoch 24/30. Took 0.28249 seconds. 
  Full-batch training loss = 2.253459, test loss = 2.253055
  Training set accuracy = 0.472000, Test set accuracy = 0.464600
 epoch 25/30. Took 0.2815 seconds. 
  Full-batch training loss = 2.250469, test loss = 2.250075
  Training set accuracy = 0.475600, Test set accuracy = 0.467400
 epoch 26/30. Took 0.27681 seconds. 
  Full-batch training loss = 2.247318, test loss = 2.246939
  Training set accuracy = 0.483400, Test set accuracy = 0.473600
 epoch 27/30. Took 0.28156 seconds. 
  Full-batch training loss = 2.244104, test loss = 2.243729
  Training set accuracy = 0.486400, Test set accuracy = 0.476600
 epoch 28/30. Took 0.28161 seconds. 
  Full-batch training loss = 2.240594, test loss = 2.240236
  Training set accuracy = 0.485800, Test set accuracy = 0.476800
 epoch 29/30. Took 0.28286 seconds. 
  Full-batch training loss = 2.236983, test loss = 2.236618
  Training set accuracy = 0.487400, Test set accuracy = 0.477600
 epoch 30/30. Took 0.27084 seconds. 
  Full-batch training loss = 2.233099, test loss = 2.232729
  Training set accuracy = 0.491200, Test set accuracy = 0.479600
Elapsed time is 18.577339 seconds.
End Training
-----
Params 5000 0.001 0.40 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.82641 seconds. 
  Full-batch training loss = 2.303114, test loss = 2.301893
  Training set accuracy = 0.108600, Test set accuracy = 0.104700
 epoch 2/30. Took 0.8253 seconds. 
  Full-batch training loss = 2.300788, test loss = 2.299750
  Training set accuracy = 0.107400, Test set accuracy = 0.104800
 epoch 3/30. Took 0.85766 seconds. 
  Full-batch training loss = 2.298516, test loss = 2.297656
  Training set accuracy = 0.108000, Test set accuracy = 0.105200
 epoch 4/30. Took 0.818 seconds. 
  Full-batch training loss = 2.296279, test loss = 2.295589
  Training set accuracy = 0.108000, Test set accuracy = 0.105600
 epoch 5/30. Took 0.86696 seconds. 
  Full-batch training loss = 2.294115, test loss = 2.293566
  Training set accuracy = 0.109200, Test set accuracy = 0.106800
 epoch 6/30. Took 0.82186 seconds. 
  Full-batch training loss = 2.291925, test loss = 2.291536
  Training set accuracy = 0.110200, Test set accuracy = 0.109000
 epoch 7/30. Took 0.87347 seconds. 
  Full-batch training loss = 2.289734, test loss = 2.289496
  Training set accuracy = 0.118200, Test set accuracy = 0.118700
 epoch 8/30. Took 0.84236 seconds. 
  Full-batch training loss = 2.287566, test loss = 2.287458
  Training set accuracy = 0.143400, Test set accuracy = 0.143300
 epoch 9/30. Took 0.81972 seconds. 
  Full-batch training loss = 2.285381, test loss = 2.285407
  Training set accuracy = 0.174400, Test set accuracy = 0.170300
 epoch 10/30. Took 0.82591 seconds. 
  Full-batch training loss = 2.283113, test loss = 2.283281
  Training set accuracy = 0.201200, Test set accuracy = 0.196600
 epoch 11/30. Took 0.81827 seconds. 
  Full-batch training loss = 2.280878, test loss = 2.281146
  Training set accuracy = 0.226400, Test set accuracy = 0.220000
 epoch 12/30. Took 0.83703 seconds. 
  Full-batch training loss = 2.278609, test loss = 2.279010
  Training set accuracy = 0.244000, Test set accuracy = 0.240800
 epoch 13/30. Took 0.83982 seconds. 
  Full-batch training loss = 2.276323, test loss = 2.276826
  Training set accuracy = 0.270800, Test set accuracy = 0.268000
 epoch 14/30. Took 0.85105 seconds. 
  Full-batch training loss = 2.273967, test loss = 2.274584
  Training set accuracy = 0.292800, Test set accuracy = 0.290600
 epoch 15/30. Took 0.81616 seconds. 
  Full-batch training loss = 2.271522, test loss = 2.272255
  Training set accuracy = 0.319000, Test set accuracy = 0.313600
 epoch 16/30. Took 0.86106 seconds. 
  Full-batch training loss = 2.269011, test loss = 2.269844
  Training set accuracy = 0.353400, Test set accuracy = 0.343400
 epoch 17/30. Took 0.83913 seconds. 
  Full-batch training loss = 2.266415, test loss = 2.267355
  Training set accuracy = 0.375800, Test set accuracy = 0.364000
 epoch 18/30. Took 0.84338 seconds. 
  Full-batch training loss = 2.263772, test loss = 2.264801
  Training set accuracy = 0.392600, Test set accuracy = 0.378400
 epoch 19/30. Took 0.84598 seconds. 
  Full-batch training loss = 2.261013, test loss = 2.262129
  Training set accuracy = 0.407000, Test set accuracy = 0.393900
 epoch 20/30. Took 0.82861 seconds. 
  Full-batch training loss = 2.258086, test loss = 2.259291
  Training set accuracy = 0.418800, Test set accuracy = 0.406100
 epoch 21/30. Took 0.82066 seconds. 
  Full-batch training loss = 2.255141, test loss = 2.256432
  Training set accuracy = 0.426000, Test set accuracy = 0.413500
 epoch 22/30. Took 0.88478 seconds. 
  Full-batch training loss = 2.251939, test loss = 2.253346
  Training set accuracy = 0.432600, Test set accuracy = 0.422200
 epoch 23/30. Took 0.85896 seconds. 
  Full-batch training loss = 2.248654, test loss = 2.250130
  Training set accuracy = 0.440800, Test set accuracy = 0.430300
 epoch 24/30. Took 0.90148 seconds. 
  Full-batch training loss = 2.245189, test loss = 2.246774
  Training set accuracy = 0.445800, Test set accuracy = 0.432100
 epoch 25/30. Took 0.85965 seconds. 
  Full-batch training loss = 2.241547, test loss = 2.243212
  Training set accuracy = 0.447400, Test set accuracy = 0.430700
 epoch 26/30. Took 0.83442 seconds. 
  Full-batch training loss = 2.237681, test loss = 2.239437
  Training set accuracy = 0.454400, Test set accuracy = 0.434900
 epoch 27/30. Took 0.82785 seconds. 
  Full-batch training loss = 2.233652, test loss = 2.235492
  Training set accuracy = 0.452000, Test set accuracy = 0.432200
 epoch 28/30. Took 0.94482 seconds. 
  Full-batch training loss = 2.229363, test loss = 2.231272
  Training set accuracy = 0.455200, Test set accuracy = 0.436600
 epoch 29/30. Took 0.90306 seconds. 
  Full-batch training loss = 2.224849, test loss = 2.226869
  Training set accuracy = 0.451800, Test set accuracy = 0.436100
 epoch 30/30. Took 0.82699 seconds. 
  Full-batch training loss = 2.220002, test loss = 2.222099
  Training set accuracy = 0.450400, Test set accuracy = 0.434600
Elapsed time is 52.811830 seconds.
End Training
-----
Params 5000 0.001 0.50 1 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.11839 seconds. 
  Full-batch training loss = 2.283725, test loss = 2.282952
  Training set accuracy = 0.132200, Test set accuracy = 0.134700
 epoch 2/30. Took 0.11106 seconds. 
  Full-batch training loss = 2.250362, test loss = 2.249216
  Training set accuracy = 0.212000, Test set accuracy = 0.212500
 epoch 3/30. Took 0.11052 seconds. 
  Full-batch training loss = 2.217267, test loss = 2.215744
  Training set accuracy = 0.297400, Test set accuracy = 0.298700
 epoch 4/30. Took 0.1056 seconds. 
  Full-batch training loss = 2.183414, test loss = 2.181556
  Training set accuracy = 0.374200, Test set accuracy = 0.373900
 epoch 5/30. Took 0.10925 seconds. 
  Full-batch training loss = 2.148763, test loss = 2.146494
  Training set accuracy = 0.447400, Test set accuracy = 0.450100
 epoch 6/30. Took 0.11017 seconds. 
  Full-batch training loss = 2.112689, test loss = 2.109922
  Training set accuracy = 0.516800, Test set accuracy = 0.519200
 epoch 7/30. Took 0.10912 seconds. 
  Full-batch training loss = 2.075534, test loss = 2.072127
  Training set accuracy = 0.576600, Test set accuracy = 0.584400
 epoch 8/30. Took 0.10903 seconds. 
  Full-batch training loss = 2.037035, test loss = 2.033098
  Training set accuracy = 0.621800, Test set accuracy = 0.625100
 epoch 9/30. Took 0.11559 seconds. 
  Full-batch training loss = 1.997780, test loss = 1.993395
  Training set accuracy = 0.650600, Test set accuracy = 0.655500
 epoch 10/30. Took 0.10387 seconds. 
  Full-batch training loss = 1.957533, test loss = 1.952721
  Training set accuracy = 0.675000, Test set accuracy = 0.681600
 epoch 11/30. Took 0.10851 seconds. 
  Full-batch training loss = 1.915911, test loss = 1.910613
  Training set accuracy = 0.693800, Test set accuracy = 0.699400
 epoch 12/30. Took 0.10769 seconds. 
  Full-batch training loss = 1.873174, test loss = 1.867304
  Training set accuracy = 0.707400, Test set accuracy = 0.712500
 epoch 13/30. Took 0.11329 seconds. 
  Full-batch training loss = 1.830479, test loss = 1.824065
  Training set accuracy = 0.717400, Test set accuracy = 0.724500
 epoch 14/30. Took 0.10781 seconds. 
  Full-batch training loss = 1.787615, test loss = 1.780754
  Training set accuracy = 0.729000, Test set accuracy = 0.731200
 epoch 15/30. Took 0.10759 seconds. 
  Full-batch training loss = 1.744852, test loss = 1.737559
  Training set accuracy = 0.738400, Test set accuracy = 0.739300
 epoch 16/30. Took 0.11411 seconds. 
  Full-batch training loss = 1.702280, test loss = 1.694520
  Training set accuracy = 0.747600, Test set accuracy = 0.748300
 epoch 17/30. Took 0.10918 seconds. 
  Full-batch training loss = 1.659588, test loss = 1.651440
  Training set accuracy = 0.754200, Test set accuracy = 0.753200
 epoch 18/30. Took 0.10831 seconds. 
  Full-batch training loss = 1.617295, test loss = 1.608925
  Training set accuracy = 0.759800, Test set accuracy = 0.757900
 epoch 19/30. Took 0.10701 seconds. 
  Full-batch training loss = 1.575782, test loss = 1.567274
  Training set accuracy = 0.764400, Test set accuracy = 0.761300
 epoch 20/30. Took 0.10683 seconds. 
  Full-batch training loss = 1.534949, test loss = 1.526209
  Training set accuracy = 0.768800, Test set accuracy = 0.766600
 epoch 21/30. Took 0.10681 seconds. 
  Full-batch training loss = 1.494978, test loss = 1.486123
  Training set accuracy = 0.771600, Test set accuracy = 0.770300
 epoch 22/30. Took 0.10736 seconds. 
  Full-batch training loss = 1.456306, test loss = 1.447378
  Training set accuracy = 0.775200, Test set accuracy = 0.772400
 epoch 23/30. Took 0.10951 seconds. 
  Full-batch training loss = 1.418876, test loss = 1.409814
  Training set accuracy = 0.776200, Test set accuracy = 0.776000
 epoch 24/30. Took 0.11038 seconds. 
  Full-batch training loss = 1.382518, test loss = 1.373410
  Training set accuracy = 0.781200, Test set accuracy = 0.780600
 epoch 25/30. Took 0.10624 seconds. 
  Full-batch training loss = 1.347337, test loss = 1.338198
  Training set accuracy = 0.786000, Test set accuracy = 0.784100
 epoch 26/30. Took 0.11166 seconds. 
  Full-batch training loss = 1.313900, test loss = 1.304701
  Training set accuracy = 0.790200, Test set accuracy = 0.786100
 epoch 27/30. Took 0.11034 seconds. 
  Full-batch training loss = 1.281480, test loss = 1.272271
  Training set accuracy = 0.793400, Test set accuracy = 0.789700
 epoch 28/30. Took 0.10942 seconds. 
  Full-batch training loss = 1.250417, test loss = 1.241130
  Training set accuracy = 0.796600, Test set accuracy = 0.792700
 epoch 29/30. Took 0.11042 seconds. 
  Full-batch training loss = 1.220699, test loss = 1.211450
  Training set accuracy = 0.798000, Test set accuracy = 0.796000
 epoch 30/30. Took 0.10996 seconds. 
  Full-batch training loss = 1.192029, test loss = 1.182831
  Training set accuracy = 0.802200, Test set accuracy = 0.799100
Elapsed time is 8.061822 seconds.
End Training
-----
Params 5000 0.001 0.50 1 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.17291 seconds. 
  Full-batch training loss = 2.279477, test loss = 2.281320
  Training set accuracy = 0.149400, Test set accuracy = 0.142300
 epoch 2/30. Took 0.15993 seconds. 
  Full-batch training loss = 2.246443, test loss = 2.247968
  Training set accuracy = 0.222800, Test set accuracy = 0.226300
 epoch 3/30. Took 0.16706 seconds. 
  Full-batch training loss = 2.214659, test loss = 2.215712
  Training set accuracy = 0.308800, Test set accuracy = 0.309200
 epoch 4/30. Took 0.1663 seconds. 
  Full-batch training loss = 2.182462, test loss = 2.183060
  Training set accuracy = 0.400400, Test set accuracy = 0.396400
 epoch 5/30. Took 0.16348 seconds. 
  Full-batch training loss = 2.149550, test loss = 2.149802
  Training set accuracy = 0.480800, Test set accuracy = 0.474500
 epoch 6/30. Took 0.16286 seconds. 
  Full-batch training loss = 2.115669, test loss = 2.115513
  Training set accuracy = 0.537000, Test set accuracy = 0.534100
 epoch 7/30. Took 0.16789 seconds. 
  Full-batch training loss = 2.080556, test loss = 2.079996
  Training set accuracy = 0.582000, Test set accuracy = 0.576000
 epoch 8/30. Took 0.16717 seconds. 
  Full-batch training loss = 2.044416, test loss = 2.043490
  Training set accuracy = 0.619000, Test set accuracy = 0.612800
 epoch 9/30. Took 0.16712 seconds. 
  Full-batch training loss = 2.006867, test loss = 2.005512
  Training set accuracy = 0.642800, Test set accuracy = 0.637000
 epoch 10/30. Took 0.16684 seconds. 
  Full-batch training loss = 1.968215, test loss = 1.966275
  Training set accuracy = 0.661800, Test set accuracy = 0.657600
 epoch 11/30. Took 0.16761 seconds. 
  Full-batch training loss = 1.928240, test loss = 1.925852
  Training set accuracy = 0.674800, Test set accuracy = 0.671100
 epoch 12/30. Took 0.16138 seconds. 
  Full-batch training loss = 1.887185, test loss = 1.884207
  Training set accuracy = 0.691600, Test set accuracy = 0.687200
 epoch 13/30. Took 0.16342 seconds. 
  Full-batch training loss = 1.845202, test loss = 1.841728
  Training set accuracy = 0.698000, Test set accuracy = 0.696600
 epoch 14/30. Took 0.16713 seconds. 
  Full-batch training loss = 1.802620, test loss = 1.798493
  Training set accuracy = 0.706800, Test set accuracy = 0.707200
 epoch 15/30. Took 0.16648 seconds. 
  Full-batch training loss = 1.759594, test loss = 1.754982
  Training set accuracy = 0.714400, Test set accuracy = 0.714300
 epoch 16/30. Took 0.1666 seconds. 
  Full-batch training loss = 1.715958, test loss = 1.710812
  Training set accuracy = 0.719400, Test set accuracy = 0.721900
 epoch 17/30. Took 0.16711 seconds. 
  Full-batch training loss = 1.672615, test loss = 1.666950
  Training set accuracy = 0.727400, Test set accuracy = 0.729200
 epoch 18/30. Took 0.16709 seconds. 
  Full-batch training loss = 1.629389, test loss = 1.623127
  Training set accuracy = 0.732400, Test set accuracy = 0.738300
 epoch 19/30. Took 0.16618 seconds. 
  Full-batch training loss = 1.586289, test loss = 1.579483
  Training set accuracy = 0.735400, Test set accuracy = 0.743500
 epoch 20/30. Took 0.17819 seconds. 
  Full-batch training loss = 1.543587, test loss = 1.536370
  Training set accuracy = 0.740400, Test set accuracy = 0.748400
 epoch 21/30. Took 0.16493 seconds. 
  Full-batch training loss = 1.502003, test loss = 1.494310
  Training set accuracy = 0.746600, Test set accuracy = 0.755300
 epoch 22/30. Took 0.16414 seconds. 
  Full-batch training loss = 1.460936, test loss = 1.452720
  Training set accuracy = 0.752200, Test set accuracy = 0.761300
 epoch 23/30. Took 0.16402 seconds. 
  Full-batch training loss = 1.421173, test loss = 1.412652
  Training set accuracy = 0.758200, Test set accuracy = 0.766300
 epoch 24/30. Took 0.16959 seconds. 
  Full-batch training loss = 1.382269, test loss = 1.373200
  Training set accuracy = 0.762000, Test set accuracy = 0.773400
 epoch 25/30. Took 0.1699 seconds. 
  Full-batch training loss = 1.344885, test loss = 1.335431
  Training set accuracy = 0.767600, Test set accuracy = 0.777300
 epoch 26/30. Took 0.17057 seconds. 
  Full-batch training loss = 1.308896, test loss = 1.299059
  Training set accuracy = 0.774200, Test set accuracy = 0.781500
 epoch 27/30. Took 0.17053 seconds. 
  Full-batch training loss = 1.274410, test loss = 1.264285
  Training set accuracy = 0.778400, Test set accuracy = 0.785900
 epoch 28/30. Took 0.17012 seconds. 
  Full-batch training loss = 1.241347, test loss = 1.230968
  Training set accuracy = 0.782800, Test set accuracy = 0.791100
 epoch 29/30. Took 0.16994 seconds. 
  Full-batch training loss = 1.209677, test loss = 1.199075
  Training set accuracy = 0.786800, Test set accuracy = 0.794600
 epoch 30/30. Took 0.16912 seconds. 
  Full-batch training loss = 1.179250, test loss = 1.168351
  Training set accuracy = 0.791400, Test set accuracy = 0.797800
Elapsed time is 11.613356 seconds.
End Training
-----
Params 5000 0.001 0.50 1 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.36712 seconds. 
  Full-batch training loss = 2.250293, test loss = 2.249545
  Training set accuracy = 0.214000, Test set accuracy = 0.208700
 epoch 2/30. Took 0.36906 seconds. 
  Full-batch training loss = 2.207264, test loss = 2.205620
  Training set accuracy = 0.344400, Test set accuracy = 0.342300
 epoch 3/30. Took 0.36409 seconds. 
  Full-batch training loss = 2.164735, test loss = 2.162177
  Training set accuracy = 0.479000, Test set accuracy = 0.484900
 epoch 4/30. Took 0.35765 seconds. 
  Full-batch training loss = 2.122489, test loss = 2.119054
  Training set accuracy = 0.572400, Test set accuracy = 0.574500
 epoch 5/30. Took 0.3513 seconds. 
  Full-batch training loss = 2.079642, test loss = 2.075151
  Training set accuracy = 0.632400, Test set accuracy = 0.634800
 epoch 6/30. Took 0.35403 seconds. 
  Full-batch training loss = 2.036079, test loss = 2.030460
  Training set accuracy = 0.666400, Test set accuracy = 0.670500
 epoch 7/30. Took 0.3574 seconds. 
  Full-batch training loss = 1.991627, test loss = 1.984961
  Training set accuracy = 0.688200, Test set accuracy = 0.691000
 epoch 8/30. Took 0.35668 seconds. 
  Full-batch training loss = 1.945812, test loss = 1.938008
  Training set accuracy = 0.706400, Test set accuracy = 0.706900
 epoch 9/30. Took 0.37494 seconds. 
  Full-batch training loss = 1.899867, test loss = 1.890873
  Training set accuracy = 0.721600, Test set accuracy = 0.718700
 epoch 10/30. Took 0.35897 seconds. 
  Full-batch training loss = 1.852674, test loss = 1.842579
  Training set accuracy = 0.729000, Test set accuracy = 0.729800
 epoch 11/30. Took 0.3561 seconds. 
  Full-batch training loss = 1.805020, test loss = 1.793749
  Training set accuracy = 0.735400, Test set accuracy = 0.737300
 epoch 12/30. Took 0.3755 seconds. 
  Full-batch training loss = 1.756695, test loss = 1.744252
  Training set accuracy = 0.743200, Test set accuracy = 0.743300
 epoch 13/30. Took 0.35629 seconds. 
  Full-batch training loss = 1.707970, test loss = 1.694396
  Training set accuracy = 0.750200, Test set accuracy = 0.749200
 epoch 14/30. Took 0.37865 seconds. 
  Full-batch training loss = 1.659334, test loss = 1.644715
  Training set accuracy = 0.756800, Test set accuracy = 0.757400
 epoch 15/30. Took 0.35687 seconds. 
  Full-batch training loss = 1.611147, test loss = 1.595567
  Training set accuracy = 0.762200, Test set accuracy = 0.761400
 epoch 16/30. Took 0.34976 seconds. 
  Full-batch training loss = 1.563731, test loss = 1.547266
  Training set accuracy = 0.766400, Test set accuracy = 0.766500
 epoch 17/30. Took 0.34978 seconds. 
  Full-batch training loss = 1.517057, test loss = 1.499673
  Training set accuracy = 0.771800, Test set accuracy = 0.773700
 epoch 18/30. Took 0.36176 seconds. 
  Full-batch training loss = 1.471327, test loss = 1.453240
  Training set accuracy = 0.776800, Test set accuracy = 0.777800
 epoch 19/30. Took 0.3534 seconds. 
  Full-batch training loss = 1.426793, test loss = 1.408051
  Training set accuracy = 0.780800, Test set accuracy = 0.780500
 epoch 20/30. Took 0.34944 seconds. 
  Full-batch training loss = 1.383594, test loss = 1.364278
  Training set accuracy = 0.783800, Test set accuracy = 0.784600
 epoch 21/30. Took 0.35567 seconds. 
  Full-batch training loss = 1.341870, test loss = 1.321935
  Training set accuracy = 0.788000, Test set accuracy = 0.788600
 epoch 22/30. Took 0.36167 seconds. 
  Full-batch training loss = 1.301660, test loss = 1.281257
  Training set accuracy = 0.792600, Test set accuracy = 0.793600
 epoch 23/30. Took 0.38366 seconds. 
  Full-batch training loss = 1.263154, test loss = 1.242419
  Training set accuracy = 0.796400, Test set accuracy = 0.796900
 epoch 24/30. Took 0.35205 seconds. 
  Full-batch training loss = 1.226413, test loss = 1.205327
  Training set accuracy = 0.798200, Test set accuracy = 0.800900
 epoch 25/30. Took 0.35335 seconds. 
  Full-batch training loss = 1.191486, test loss = 1.170193
  Training set accuracy = 0.802400, Test set accuracy = 0.803900
 epoch 26/30. Took 0.35455 seconds. 
  Full-batch training loss = 1.157994, test loss = 1.136564
  Training set accuracy = 0.806800, Test set accuracy = 0.808700
 epoch 27/30. Took 0.35677 seconds. 
  Full-batch training loss = 1.126301, test loss = 1.104688
  Training set accuracy = 0.810400, Test set accuracy = 0.811100
 epoch 28/30. Took 0.35728 seconds. 
  Full-batch training loss = 1.096213, test loss = 1.074422
  Training set accuracy = 0.812800, Test set accuracy = 0.813800
 epoch 29/30. Took 0.35594 seconds. 
  Full-batch training loss = 1.067658, test loss = 1.045860
  Training set accuracy = 0.816000, Test set accuracy = 0.815400
 epoch 30/30. Took 0.38152 seconds. 
  Full-batch training loss = 1.040534, test loss = 1.018757
  Training set accuracy = 0.818600, Test set accuracy = 0.817500
Elapsed time is 23.467983 seconds.
End Training
-----
Params 5000 0.001 0.50 2 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.14057 seconds. 
  Full-batch training loss = 2.310762, test loss = 2.314152
  Training set accuracy = 0.086600, Test set accuracy = 0.079200
 epoch 2/30. Took 0.13487 seconds. 
  Full-batch training loss = 2.306878, test loss = 2.310087
  Training set accuracy = 0.095000, Test set accuracy = 0.089700
 epoch 3/30. Took 0.13594 seconds. 
  Full-batch training loss = 2.303055, test loss = 2.306125
  Training set accuracy = 0.104000, Test set accuracy = 0.099700
 epoch 4/30. Took 0.12989 seconds. 
  Full-batch training loss = 2.299278, test loss = 2.302217
  Training set accuracy = 0.112800, Test set accuracy = 0.108800
 epoch 5/30. Took 0.12881 seconds. 
  Full-batch training loss = 2.295548, test loss = 2.298384
  Training set accuracy = 0.123000, Test set accuracy = 0.118300
 epoch 6/30. Took 0.13632 seconds. 
  Full-batch training loss = 2.291713, test loss = 2.294438
  Training set accuracy = 0.134800, Test set accuracy = 0.127200
 epoch 7/30. Took 0.13563 seconds. 
  Full-batch training loss = 2.287941, test loss = 2.290563
  Training set accuracy = 0.145000, Test set accuracy = 0.137700
 epoch 8/30. Took 0.1397 seconds. 
  Full-batch training loss = 2.283970, test loss = 2.286496
  Training set accuracy = 0.158200, Test set accuracy = 0.150900
 epoch 9/30. Took 0.13634 seconds. 
  Full-batch training loss = 2.280023, test loss = 2.282444
  Training set accuracy = 0.171000, Test set accuracy = 0.165100
 epoch 10/30. Took 0.13654 seconds. 
  Full-batch training loss = 2.275911, test loss = 2.278254
  Training set accuracy = 0.186000, Test set accuracy = 0.181900
 epoch 11/30. Took 0.13582 seconds. 
  Full-batch training loss = 2.271546, test loss = 2.273793
  Training set accuracy = 0.205000, Test set accuracy = 0.203300
 epoch 12/30. Took 0.13685 seconds. 
  Full-batch training loss = 2.267130, test loss = 2.269286
  Training set accuracy = 0.221000, Test set accuracy = 0.220000
 epoch 13/30. Took 0.13019 seconds. 
  Full-batch training loss = 2.262628, test loss = 2.264690
  Training set accuracy = 0.239600, Test set accuracy = 0.244200
 epoch 14/30. Took 0.13539 seconds. 
  Full-batch training loss = 2.257850, test loss = 2.259857
  Training set accuracy = 0.263000, Test set accuracy = 0.261200
 epoch 15/30. Took 0.13547 seconds. 
  Full-batch training loss = 2.252875, test loss = 2.254808
  Training set accuracy = 0.281400, Test set accuracy = 0.276900
 epoch 16/30. Took 0.13713 seconds. 
  Full-batch training loss = 2.247585, test loss = 2.249471
  Training set accuracy = 0.296400, Test set accuracy = 0.296000
 epoch 17/30. Took 0.13657 seconds. 
  Full-batch training loss = 2.242115, test loss = 2.243959
  Training set accuracy = 0.305400, Test set accuracy = 0.304600
 epoch 18/30. Took 0.13595 seconds. 
  Full-batch training loss = 2.236350, test loss = 2.238145
  Training set accuracy = 0.314400, Test set accuracy = 0.313700
 epoch 19/30. Took 0.14091 seconds. 
  Full-batch training loss = 2.230340, test loss = 2.232063
  Training set accuracy = 0.321600, Test set accuracy = 0.320400
 epoch 20/30. Took 0.1405 seconds. 
  Full-batch training loss = 2.224173, test loss = 2.225835
  Training set accuracy = 0.325800, Test set accuracy = 0.326600
 epoch 21/30. Took 0.134 seconds. 
  Full-batch training loss = 2.217701, test loss = 2.219319
  Training set accuracy = 0.333400, Test set accuracy = 0.332600
 epoch 22/30. Took 0.13609 seconds. 
  Full-batch training loss = 2.210940, test loss = 2.212522
  Training set accuracy = 0.341400, Test set accuracy = 0.338400
 epoch 23/30. Took 0.13555 seconds. 
  Full-batch training loss = 2.203866, test loss = 2.205416
  Training set accuracy = 0.346400, Test set accuracy = 0.344000
 epoch 24/30. Took 0.13642 seconds. 
  Full-batch training loss = 2.196336, test loss = 2.197833
  Training set accuracy = 0.354200, Test set accuracy = 0.352800
 epoch 25/30. Took 0.13644 seconds. 
  Full-batch training loss = 2.188543, test loss = 2.189986
  Training set accuracy = 0.365400, Test set accuracy = 0.363100
 epoch 26/30. Took 0.136 seconds. 
  Full-batch training loss = 2.180420, test loss = 2.181800
  Training set accuracy = 0.380400, Test set accuracy = 0.377300
 epoch 27/30. Took 0.13545 seconds. 
  Full-batch training loss = 2.171577, test loss = 2.172893
  Training set accuracy = 0.396000, Test set accuracy = 0.391600
 epoch 28/30. Took 0.1359 seconds. 
  Full-batch training loss = 2.162622, test loss = 2.163876
  Training set accuracy = 0.408400, Test set accuracy = 0.405900
 epoch 29/30. Took 0.12842 seconds. 
  Full-batch training loss = 2.153237, test loss = 2.154425
  Training set accuracy = 0.424000, Test set accuracy = 0.423800
 epoch 30/30. Took 0.12899 seconds. 
  Full-batch training loss = 2.143460, test loss = 2.144567
  Training set accuracy = 0.437800, Test set accuracy = 0.437900
Elapsed time is 9.432686 seconds.
End Training
-----
Params 5000 0.001 0.50 2 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.24429 seconds. 
  Full-batch training loss = 2.302453, test loss = 2.302116
  Training set accuracy = 0.075600, Test set accuracy = 0.082000
 epoch 2/30. Took 0.22589 seconds. 
  Full-batch training loss = 2.298327, test loss = 2.297967
  Training set accuracy = 0.090400, Test set accuracy = 0.093000
 epoch 3/30. Took 0.22836 seconds. 
  Full-batch training loss = 2.294182, test loss = 2.293803
  Training set accuracy = 0.103800, Test set accuracy = 0.107200
 epoch 4/30. Took 0.251 seconds. 
  Full-batch training loss = 2.289953, test loss = 2.289559
  Training set accuracy = 0.117200, Test set accuracy = 0.123100
 epoch 5/30. Took 0.25258 seconds. 
  Full-batch training loss = 2.285776, test loss = 2.285357
  Training set accuracy = 0.130600, Test set accuracy = 0.136300
 epoch 6/30. Took 0.21781 seconds. 
  Full-batch training loss = 2.281550, test loss = 2.281087
  Training set accuracy = 0.154000, Test set accuracy = 0.159200
 epoch 7/30. Took 0.22671 seconds. 
  Full-batch training loss = 2.277250, test loss = 2.276750
  Training set accuracy = 0.180800, Test set accuracy = 0.190200
 epoch 8/30. Took 0.22691 seconds. 
  Full-batch training loss = 2.272765, test loss = 2.272241
  Training set accuracy = 0.214400, Test set accuracy = 0.225500
 epoch 9/30. Took 0.23003 seconds. 
  Full-batch training loss = 2.268263, test loss = 2.267704
  Training set accuracy = 0.249600, Test set accuracy = 0.256400
 epoch 10/30. Took 0.21896 seconds. 
  Full-batch training loss = 2.263585, test loss = 2.263008
  Training set accuracy = 0.282000, Test set accuracy = 0.286200
 epoch 11/30. Took 0.22246 seconds. 
  Full-batch training loss = 2.258706, test loss = 2.258088
  Training set accuracy = 0.306200, Test set accuracy = 0.308900
 epoch 12/30. Took 0.22706 seconds. 
  Full-batch training loss = 2.253614, test loss = 2.252947
  Training set accuracy = 0.326800, Test set accuracy = 0.332500
 epoch 13/30. Took 0.22566 seconds. 
  Full-batch training loss = 2.248303, test loss = 2.247601
  Training set accuracy = 0.344600, Test set accuracy = 0.349500
 epoch 14/30. Took 0.22741 seconds. 
  Full-batch training loss = 2.242875, test loss = 2.242142
  Training set accuracy = 0.364400, Test set accuracy = 0.370600
 epoch 15/30. Took 0.22841 seconds. 
  Full-batch training loss = 2.237182, test loss = 2.236403
  Training set accuracy = 0.373600, Test set accuracy = 0.382600
 epoch 16/30. Took 0.22556 seconds. 
  Full-batch training loss = 2.231171, test loss = 2.230351
  Training set accuracy = 0.391000, Test set accuracy = 0.397700
 epoch 17/30. Took 0.22038 seconds. 
  Full-batch training loss = 2.225097, test loss = 2.224221
  Training set accuracy = 0.406000, Test set accuracy = 0.410500
 epoch 18/30. Took 0.21827 seconds. 
  Full-batch training loss = 2.218547, test loss = 2.217624
  Training set accuracy = 0.414800, Test set accuracy = 0.423200
 epoch 19/30. Took 0.21856 seconds. 
  Full-batch training loss = 2.211766, test loss = 2.210800
  Training set accuracy = 0.429400, Test set accuracy = 0.437300
 epoch 20/30. Took 0.21912 seconds. 
  Full-batch training loss = 2.204620, test loss = 2.203594
  Training set accuracy = 0.448000, Test set accuracy = 0.452200
 epoch 21/30. Took 0.22778 seconds. 
  Full-batch training loss = 2.197100, test loss = 2.196021
  Training set accuracy = 0.456800, Test set accuracy = 0.461800
 epoch 22/30. Took 0.22745 seconds. 
  Full-batch training loss = 2.189245, test loss = 2.188098
  Training set accuracy = 0.470000, Test set accuracy = 0.474500
 epoch 23/30. Took 0.22751 seconds. 
  Full-batch training loss = 2.181133, test loss = 2.179916
  Training set accuracy = 0.483400, Test set accuracy = 0.484600
 epoch 24/30. Took 0.22664 seconds. 
  Full-batch training loss = 2.172573, test loss = 2.171276
  Training set accuracy = 0.496400, Test set accuracy = 0.497200
 epoch 25/30. Took 0.21941 seconds. 
  Full-batch training loss = 2.163543, test loss = 2.162182
  Training set accuracy = 0.510600, Test set accuracy = 0.507200
 epoch 26/30. Took 0.22531 seconds. 
  Full-batch training loss = 2.154030, test loss = 2.152579
  Training set accuracy = 0.522600, Test set accuracy = 0.516800
 epoch 27/30. Took 0.22089 seconds. 
  Full-batch training loss = 2.144063, test loss = 2.142517
  Training set accuracy = 0.533000, Test set accuracy = 0.526300
 epoch 28/30. Took 0.22629 seconds. 
  Full-batch training loss = 2.133845, test loss = 2.132180
  Training set accuracy = 0.544000, Test set accuracy = 0.537000
 epoch 29/30. Took 0.24889 seconds. 
  Full-batch training loss = 2.123130, test loss = 2.121348
  Training set accuracy = 0.556200, Test set accuracy = 0.546200
 epoch 30/30. Took 0.22476 seconds. 
  Full-batch training loss = 2.111810, test loss = 2.109898
  Training set accuracy = 0.564800, Test set accuracy = 0.555300
Elapsed time is 15.204402 seconds.
End Training
-----
Params 5000 0.001 0.50 2 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.62409 seconds. 
  Full-batch training loss = 2.297826, test loss = 2.299125
  Training set accuracy = 0.128000, Test set accuracy = 0.125800
 epoch 2/30. Took 0.59415 seconds. 
  Full-batch training loss = 2.292854, test loss = 2.294219
  Training set accuracy = 0.140000, Test set accuracy = 0.140300
 epoch 3/30. Took 0.60215 seconds. 
  Full-batch training loss = 2.287921, test loss = 2.289344
  Training set accuracy = 0.157400, Test set accuracy = 0.158900
 epoch 4/30. Took 0.60684 seconds. 
  Full-batch training loss = 2.283025, test loss = 2.284500
  Training set accuracy = 0.184600, Test set accuracy = 0.184400
 epoch 5/30. Took 0.60823 seconds. 
  Full-batch training loss = 2.278043, test loss = 2.279555
  Training set accuracy = 0.217800, Test set accuracy = 0.220400
 epoch 6/30. Took 0.62 seconds. 
  Full-batch training loss = 2.272926, test loss = 2.274489
  Training set accuracy = 0.270000, Test set accuracy = 0.265400
 epoch 7/30. Took 0.61488 seconds. 
  Full-batch training loss = 2.267724, test loss = 2.269327
  Training set accuracy = 0.309200, Test set accuracy = 0.302900
 epoch 8/30. Took 0.58895 seconds. 
  Full-batch training loss = 2.262493, test loss = 2.264143
  Training set accuracy = 0.339600, Test set accuracy = 0.335900
 epoch 9/30. Took 0.59898 seconds. 
  Full-batch training loss = 2.256987, test loss = 2.258694
  Training set accuracy = 0.367800, Test set accuracy = 0.360800
 epoch 10/30. Took 0.59506 seconds. 
  Full-batch training loss = 2.251366, test loss = 2.253109
  Training set accuracy = 0.400000, Test set accuracy = 0.387400
 epoch 11/30. Took 0.59217 seconds. 
  Full-batch training loss = 2.245538, test loss = 2.247305
  Training set accuracy = 0.429800, Test set accuracy = 0.418100
 epoch 12/30. Took 0.59298 seconds. 
  Full-batch training loss = 2.239472, test loss = 2.241263
  Training set accuracy = 0.463000, Test set accuracy = 0.453800
 epoch 13/30. Took 0.5963 seconds. 
  Full-batch training loss = 2.233115, test loss = 2.234942
  Training set accuracy = 0.485400, Test set accuracy = 0.479000
 epoch 14/30. Took 0.59144 seconds. 
  Full-batch training loss = 2.226563, test loss = 2.228424
  Training set accuracy = 0.502000, Test set accuracy = 0.495200
 epoch 15/30. Took 0.59384 seconds. 
  Full-batch training loss = 2.219568, test loss = 2.221439
  Training set accuracy = 0.521400, Test set accuracy = 0.515800
 epoch 16/30. Took 0.59312 seconds. 
  Full-batch training loss = 2.212224, test loss = 2.214127
  Training set accuracy = 0.539000, Test set accuracy = 0.533200
 epoch 17/30. Took 0.58926 seconds. 
  Full-batch training loss = 2.204502, test loss = 2.206444
  Training set accuracy = 0.555200, Test set accuracy = 0.547700
 epoch 18/30. Took 0.6113 seconds. 
  Full-batch training loss = 2.196310, test loss = 2.198285
  Training set accuracy = 0.563200, Test set accuracy = 0.556000
 epoch 19/30. Took 0.59117 seconds. 
  Full-batch training loss = 2.187663, test loss = 2.189686
  Training set accuracy = 0.572200, Test set accuracy = 0.562200
 epoch 20/30. Took 0.59851 seconds. 
  Full-batch training loss = 2.178651, test loss = 2.180693
  Training set accuracy = 0.581400, Test set accuracy = 0.570800
 epoch 21/30. Took 0.58877 seconds. 
  Full-batch training loss = 2.169072, test loss = 2.171146
  Training set accuracy = 0.587200, Test set accuracy = 0.576600
 epoch 22/30. Took 0.61612 seconds. 
  Full-batch training loss = 2.158953, test loss = 2.161063
  Training set accuracy = 0.592400, Test set accuracy = 0.581000
 epoch 23/30. Took 0.59585 seconds. 
  Full-batch training loss = 2.148229, test loss = 2.150362
  Training set accuracy = 0.598400, Test set accuracy = 0.585600
 epoch 24/30. Took 0.5951 seconds. 
  Full-batch training loss = 2.136923, test loss = 2.139062
  Training set accuracy = 0.603600, Test set accuracy = 0.589200
 epoch 25/30. Took 0.58879 seconds. 
  Full-batch training loss = 2.125070, test loss = 2.127232
  Training set accuracy = 0.604400, Test set accuracy = 0.590500
 epoch 26/30. Took 0.61796 seconds. 
  Full-batch training loss = 2.112260, test loss = 2.114464
  Training set accuracy = 0.607600, Test set accuracy = 0.591600
 epoch 27/30. Took 0.61362 seconds. 
  Full-batch training loss = 2.098788, test loss = 2.101023
  Training set accuracy = 0.609200, Test set accuracy = 0.594400
 epoch 28/30. Took 0.59854 seconds. 
  Full-batch training loss = 2.084511, test loss = 2.086771
  Training set accuracy = 0.611000, Test set accuracy = 0.596600
 epoch 29/30. Took 0.59127 seconds. 
  Full-batch training loss = 2.069488, test loss = 2.071783
  Training set accuracy = 0.613800, Test set accuracy = 0.599000
 epoch 30/30. Took 0.61431 seconds. 
  Full-batch training loss = 2.053489, test loss = 2.055804
  Training set accuracy = 0.618200, Test set accuracy = 0.603600
Elapsed time is 38.078370 seconds.
End Training
-----
Params 5000 0.001 0.50 3 100
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.16815 seconds. 
  Full-batch training loss = 2.318953, test loss = 2.319065
  Training set accuracy = 0.093000, Test set accuracy = 0.089200
 epoch 2/30. Took 0.17272 seconds. 
  Full-batch training loss = 2.317466, test loss = 2.317646
  Training set accuracy = 0.093000, Test set accuracy = 0.089200
 epoch 3/30. Took 0.16077 seconds. 
  Full-batch training loss = 2.316019, test loss = 2.316289
  Training set accuracy = 0.093200, Test set accuracy = 0.089200
 epoch 4/30. Took 0.162 seconds. 
  Full-batch training loss = 2.314633, test loss = 2.314980
  Training set accuracy = 0.093400, Test set accuracy = 0.089200
 epoch 5/30. Took 0.16255 seconds. 
  Full-batch training loss = 2.313321, test loss = 2.313744
  Training set accuracy = 0.093400, Test set accuracy = 0.089700
 epoch 6/30. Took 0.16224 seconds. 
  Full-batch training loss = 2.312043, test loss = 2.312541
  Training set accuracy = 0.093600, Test set accuracy = 0.090000
 epoch 7/30. Took 0.15103 seconds. 
  Full-batch training loss = 2.310815, test loss = 2.311386
  Training set accuracy = 0.095400, Test set accuracy = 0.090800
 epoch 8/30. Took 0.156 seconds. 
  Full-batch training loss = 2.309705, test loss = 2.310340
  Training set accuracy = 0.096800, Test set accuracy = 0.092300
 epoch 9/30. Took 0.1631 seconds. 
  Full-batch training loss = 2.308578, test loss = 2.309292
  Training set accuracy = 0.099000, Test set accuracy = 0.094700
 epoch 10/30. Took 0.16966 seconds. 
  Full-batch training loss = 2.307507, test loss = 2.308293
  Training set accuracy = 0.102000, Test set accuracy = 0.096200
 epoch 11/30. Took 0.16197 seconds. 
  Full-batch training loss = 2.306484, test loss = 2.307328
  Training set accuracy = 0.105400, Test set accuracy = 0.099300
 epoch 12/30. Took 0.1624 seconds. 
  Full-batch training loss = 2.305487, test loss = 2.306399
  Training set accuracy = 0.113400, Test set accuracy = 0.105000
 epoch 13/30. Took 0.16325 seconds. 
  Full-batch training loss = 2.304497, test loss = 2.305484
  Training set accuracy = 0.121000, Test set accuracy = 0.111000
 epoch 14/30. Took 0.16296 seconds. 
  Full-batch training loss = 2.303604, test loss = 2.304645
  Training set accuracy = 0.131600, Test set accuracy = 0.121700
 epoch 15/30. Took 0.16096 seconds. 
  Full-batch training loss = 2.302706, test loss = 2.303811
  Training set accuracy = 0.146600, Test set accuracy = 0.137600
 epoch 16/30. Took 0.16465 seconds. 
  Full-batch training loss = 2.301846, test loss = 2.303015
  Training set accuracy = 0.168000, Test set accuracy = 0.162400
 epoch 17/30. Took 0.16257 seconds. 
  Full-batch training loss = 2.301000, test loss = 2.302231
  Training set accuracy = 0.193200, Test set accuracy = 0.187600
 epoch 18/30. Took 0.16254 seconds. 
  Full-batch training loss = 2.300208, test loss = 2.301496
  Training set accuracy = 0.222800, Test set accuracy = 0.215800
 epoch 19/30. Took 0.16232 seconds. 
  Full-batch training loss = 2.299436, test loss = 2.300779
  Training set accuracy = 0.241800, Test set accuracy = 0.235000
 epoch 20/30. Took 0.15772 seconds. 
  Full-batch training loss = 2.298664, test loss = 2.300067
  Training set accuracy = 0.244200, Test set accuracy = 0.240700
 epoch 21/30. Took 0.15401 seconds. 
  Full-batch training loss = 2.297912, test loss = 2.299375
  Training set accuracy = 0.239600, Test set accuracy = 0.229200
 epoch 22/30. Took 0.16266 seconds. 
  Full-batch training loss = 2.297195, test loss = 2.298710
  Training set accuracy = 0.227400, Test set accuracy = 0.214900
 epoch 23/30. Took 0.16423 seconds. 
  Full-batch training loss = 2.296502, test loss = 2.298063
  Training set accuracy = 0.209800, Test set accuracy = 0.201000
 epoch 24/30. Took 0.15839 seconds. 
  Full-batch training loss = 2.295811, test loss = 2.297429
  Training set accuracy = 0.197200, Test set accuracy = 0.187900
 epoch 25/30. Took 0.17406 seconds. 
  Full-batch training loss = 2.295143, test loss = 2.296810
  Training set accuracy = 0.187400, Test set accuracy = 0.175400
 epoch 26/30. Took 0.15866 seconds. 
  Full-batch training loss = 2.294494, test loss = 2.296212
  Training set accuracy = 0.180800, Test set accuracy = 0.166900
 epoch 27/30. Took 0.1629 seconds. 
  Full-batch training loss = 2.293859, test loss = 2.295621
  Training set accuracy = 0.176600, Test set accuracy = 0.161600
 epoch 28/30. Took 0.15763 seconds. 
  Full-batch training loss = 2.293192, test loss = 2.294989
  Training set accuracy = 0.166800, Test set accuracy = 0.153700
 epoch 29/30. Took 0.16965 seconds. 
  Full-batch training loss = 2.292577, test loss = 2.294428
  Training set accuracy = 0.162400, Test set accuracy = 0.149300
 epoch 30/30. Took 0.16157 seconds. 
  Full-batch training loss = 2.291962, test loss = 2.293859
  Training set accuracy = 0.156200, Test set accuracy = 0.143800
Elapsed time is 10.851109 seconds.
End Training
-----
Params 5000 0.001 0.50 3 200
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28492 seconds. 
  Full-batch training loss = 2.302303, test loss = 2.301524
  Training set accuracy = 0.110200, Test set accuracy = 0.108200
 epoch 2/30. Took 0.26789 seconds. 
  Full-batch training loss = 2.301736, test loss = 2.301028
  Training set accuracy = 0.111800, Test set accuracy = 0.110200
 epoch 3/30. Took 0.28748 seconds. 
  Full-batch training loss = 2.301202, test loss = 2.300551
  Training set accuracy = 0.112600, Test set accuracy = 0.108800
 epoch 4/30. Took 0.30483 seconds. 
  Full-batch training loss = 2.300663, test loss = 2.300078
  Training set accuracy = 0.111600, Test set accuracy = 0.108900
 epoch 5/30. Took 0.30514 seconds. 
  Full-batch training loss = 2.300123, test loss = 2.299597
  Training set accuracy = 0.111600, Test set accuracy = 0.108700
 epoch 6/30. Took 0.2799 seconds. 
  Full-batch training loss = 2.299607, test loss = 2.299131
  Training set accuracy = 0.126200, Test set accuracy = 0.127300
 epoch 7/30. Took 0.30295 seconds. 
  Full-batch training loss = 2.299090, test loss = 2.298666
  Training set accuracy = 0.167200, Test set accuracy = 0.166800
 epoch 8/30. Took 0.29421 seconds. 
  Full-batch training loss = 2.298588, test loss = 2.298215
  Training set accuracy = 0.190000, Test set accuracy = 0.188700
 epoch 9/30. Took 0.2761 seconds. 
  Full-batch training loss = 2.298076, test loss = 2.297755
  Training set accuracy = 0.198400, Test set accuracy = 0.195400
 epoch 10/30. Took 0.27853 seconds. 
  Full-batch training loss = 2.297577, test loss = 2.297308
  Training set accuracy = 0.196000, Test set accuracy = 0.193300
 epoch 11/30. Took 0.27136 seconds. 
  Full-batch training loss = 2.297088, test loss = 2.296862
  Training set accuracy = 0.188000, Test set accuracy = 0.185800
 epoch 12/30. Took 0.27024 seconds. 
  Full-batch training loss = 2.296600, test loss = 2.296420
  Training set accuracy = 0.175000, Test set accuracy = 0.173800
 epoch 13/30. Took 0.27435 seconds. 
  Full-batch training loss = 2.296113, test loss = 2.295977
  Training set accuracy = 0.166200, Test set accuracy = 0.163400
 epoch 14/30. Took 0.28313 seconds. 
  Full-batch training loss = 2.295632, test loss = 2.295531
  Training set accuracy = 0.156000, Test set accuracy = 0.154900
 epoch 15/30. Took 0.2773 seconds. 
  Full-batch training loss = 2.295151, test loss = 2.295088
  Training set accuracy = 0.147600, Test set accuracy = 0.144500
 epoch 16/30. Took 0.27158 seconds. 
  Full-batch training loss = 2.294648, test loss = 2.294627
  Training set accuracy = 0.134800, Test set accuracy = 0.135000
 epoch 17/30. Took 0.28167 seconds. 
  Full-batch training loss = 2.294162, test loss = 2.294177
  Training set accuracy = 0.129600, Test set accuracy = 0.131300
 epoch 18/30. Took 0.27589 seconds. 
  Full-batch training loss = 2.293659, test loss = 2.293713
  Training set accuracy = 0.123800, Test set accuracy = 0.125500
 epoch 19/30. Took 0.28327 seconds. 
  Full-batch training loss = 2.293164, test loss = 2.293246
  Training set accuracy = 0.122000, Test set accuracy = 0.123300
 epoch 20/30. Took 0.28281 seconds. 
  Full-batch training loss = 2.292660, test loss = 2.292777
  Training set accuracy = 0.120200, Test set accuracy = 0.120100
 epoch 21/30. Took 0.28235 seconds. 
  Full-batch training loss = 2.292164, test loss = 2.292324
  Training set accuracy = 0.119400, Test set accuracy = 0.118200
 epoch 22/30. Took 0.29463 seconds. 
  Full-batch training loss = 2.291658, test loss = 2.291843
  Training set accuracy = 0.118200, Test set accuracy = 0.117000
 epoch 23/30. Took 0.28212 seconds. 
  Full-batch training loss = 2.291153, test loss = 2.291367
  Training set accuracy = 0.117200, Test set accuracy = 0.116500
 epoch 24/30. Took 0.28049 seconds. 
  Full-batch training loss = 2.290638, test loss = 2.290880
  Training set accuracy = 0.117200, Test set accuracy = 0.116000
 epoch 25/30. Took 0.27903 seconds. 
  Full-batch training loss = 2.290110, test loss = 2.290379
  Training set accuracy = 0.117000, Test set accuracy = 0.115900
 epoch 26/30. Took 0.28194 seconds. 
  Full-batch training loss = 2.289582, test loss = 2.289872
  Training set accuracy = 0.116600, Test set accuracy = 0.115500
 epoch 27/30. Took 0.28297 seconds. 
  Full-batch training loss = 2.289045, test loss = 2.289363
  Training set accuracy = 0.117200, Test set accuracy = 0.115400
 epoch 28/30. Took 0.29263 seconds. 
  Full-batch training loss = 2.288496, test loss = 2.288837
  Training set accuracy = 0.117400, Test set accuracy = 0.115700
 epoch 29/30. Took 0.3081 seconds. 
  Full-batch training loss = 2.287950, test loss = 2.288308
  Training set accuracy = 0.117600, Test set accuracy = 0.115700
 epoch 30/30. Took 0.27176 seconds. 
  Full-batch training loss = 2.287391, test loss = 2.287766
  Training set accuracy = 0.117600, Test set accuracy = 0.116100
Elapsed time is 18.526463 seconds.
End Training
-----
Params 5000 0.001 0.50 3 500
Setting parameters
Start Training
Number of training examples: 5000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.8451 seconds. 
  Full-batch training loss = 2.304539, test loss = 2.305455
  Training set accuracy = 0.099600, Test set accuracy = 0.095400
 epoch 2/30. Took 0.82036 seconds. 
  Full-batch training loss = 2.303664, test loss = 2.304591
  Training set accuracy = 0.098400, Test set accuracy = 0.096000
 epoch 3/30. Took 0.82374 seconds. 
  Full-batch training loss = 2.302829, test loss = 2.303768
  Training set accuracy = 0.099600, Test set accuracy = 0.097100
 epoch 4/30. Took 0.82315 seconds. 
  Full-batch training loss = 2.301957, test loss = 2.302904
  Training set accuracy = 0.101200, Test set accuracy = 0.097800
 epoch 5/30. Took 0.82586 seconds. 
  Full-batch training loss = 2.301115, test loss = 2.302078
  Training set accuracy = 0.102600, Test set accuracy = 0.099200
 epoch 6/30. Took 0.82593 seconds. 
  Full-batch training loss = 2.300286, test loss = 2.301258
  Training set accuracy = 0.103800, Test set accuracy = 0.101100
 epoch 7/30. Took 0.82524 seconds. 
  Full-batch training loss = 2.299469, test loss = 2.300443
  Training set accuracy = 0.106000, Test set accuracy = 0.104400
 epoch 8/30. Took 0.82005 seconds. 
  Full-batch training loss = 2.298668, test loss = 2.299655
  Training set accuracy = 0.109600, Test set accuracy = 0.108200
 epoch 9/30. Took 0.82829 seconds. 
  Full-batch training loss = 2.297845, test loss = 2.298842
  Training set accuracy = 0.112600, Test set accuracy = 0.111900
 epoch 10/30. Took 0.82919 seconds. 
  Full-batch training loss = 2.297023, test loss = 2.298020
  Training set accuracy = 0.115200, Test set accuracy = 0.114600
 epoch 11/30. Took 0.82633 seconds. 
  Full-batch training loss = 2.296237, test loss = 2.297244
  Training set accuracy = 0.118800, Test set accuracy = 0.117800
 epoch 12/30. Took 0.85222 seconds. 
  Full-batch training loss = 2.295425, test loss = 2.296443
  Training set accuracy = 0.126600, Test set accuracy = 0.123200
 epoch 13/30. Took 0.85746 seconds. 
  Full-batch training loss = 2.294608, test loss = 2.295631
  Training set accuracy = 0.129800, Test set accuracy = 0.127600
 epoch 14/30. Took 0.82259 seconds. 
  Full-batch training loss = 2.293797, test loss = 2.294838
  Training set accuracy = 0.135400, Test set accuracy = 0.130800
 epoch 15/30. Took 0.83727 seconds. 
  Full-batch training loss = 2.292984, test loss = 2.294032
  Training set accuracy = 0.138400, Test set accuracy = 0.134800
 epoch 16/30. Took 0.84018 seconds. 
  Full-batch training loss = 2.292164, test loss = 2.293217
  Training set accuracy = 0.143600, Test set accuracy = 0.140700
 epoch 17/30. Took 0.82529 seconds. 
  Full-batch training loss = 2.291343, test loss = 2.292401
  Training set accuracy = 0.147000, Test set accuracy = 0.143700
 epoch 18/30. Took 0.84963 seconds. 
  Full-batch training loss = 2.290520, test loss = 2.291586
  Training set accuracy = 0.153400, Test set accuracy = 0.149200
 epoch 19/30. Took 0.8281 seconds. 
  Full-batch training loss = 2.289679, test loss = 2.290748
  Training set accuracy = 0.158000, Test set accuracy = 0.153700
 epoch 20/30. Took 0.88549 seconds. 
  Full-batch training loss = 2.288847, test loss = 2.289929
  Training set accuracy = 0.170600, Test set accuracy = 0.162900
 epoch 21/30. Took 0.85639 seconds. 
  Full-batch training loss = 2.288012, test loss = 2.289103
  Training set accuracy = 0.184400, Test set accuracy = 0.175900
 epoch 22/30. Took 0.82411 seconds. 
  Full-batch training loss = 2.287154, test loss = 2.288255
  Training set accuracy = 0.208800, Test set accuracy = 0.200900
 epoch 23/30. Took 0.87527 seconds. 
  Full-batch training loss = 2.286271, test loss = 2.287379
  Training set accuracy = 0.237600, Test set accuracy = 0.227700
 epoch 24/30. Took 0.85638 seconds. 
  Full-batch training loss = 2.285386, test loss = 2.286502
  Training set accuracy = 0.259200, Test set accuracy = 0.250600
 epoch 25/30. Took 0.87079 seconds. 
  Full-batch training loss = 2.284487, test loss = 2.285617
  Training set accuracy = 0.275400, Test set accuracy = 0.264500
 epoch 26/30. Took 0.82533 seconds. 
  Full-batch training loss = 2.283572, test loss = 2.284702
  Training set accuracy = 0.288600, Test set accuracy = 0.276600
 epoch 27/30. Took 0.82202 seconds. 
  Full-batch training loss = 2.282638, test loss = 2.283787
  Training set accuracy = 0.293600, Test set accuracy = 0.282100
 epoch 28/30. Took 0.8415 seconds. 
  Full-batch training loss = 2.281678, test loss = 2.282834
  Training set accuracy = 0.300800, Test set accuracy = 0.289400
 epoch 29/30. Took 0.8553 seconds. 
  Full-batch training loss = 2.280678, test loss = 2.281855
  Training set accuracy = 0.306400, Test set accuracy = 0.295900
 epoch 30/30. Took 0.82131 seconds. 
  Full-batch training loss = 2.279692, test loss = 2.280872
  Training set accuracy = 0.309800, Test set accuracy = 0.300200
Elapsed time is 52.591140 seconds.
End Training
-----
Params 10000 0.100 0.00 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.20607 seconds. 
  Full-batch training loss = 0.300854, test loss = 0.321079
  Training set accuracy = 0.909700, Test set accuracy = 0.905600
 epoch 2/30. Took 0.20476 seconds. 
  Full-batch training loss = 0.220481, test loss = 0.268601
  Training set accuracy = 0.934500, Test set accuracy = 0.920500
 epoch 3/30. Took 0.21938 seconds. 
  Full-batch training loss = 0.162576, test loss = 0.219137
  Training set accuracy = 0.952400, Test set accuracy = 0.935900
 epoch 4/30. Took 0.19898 seconds. 
  Full-batch training loss = 0.123725, test loss = 0.189514
  Training set accuracy = 0.962600, Test set accuracy = 0.942100
 epoch 5/30. Took 0.20061 seconds. 
  Full-batch training loss = 0.102312, test loss = 0.178293
  Training set accuracy = 0.971000, Test set accuracy = 0.945200
 epoch 6/30. Took 0.20473 seconds. 
  Full-batch training loss = 0.085614, test loss = 0.172826
  Training set accuracy = 0.976300, Test set accuracy = 0.947300
 epoch 7/30. Took 0.20961 seconds. 
  Full-batch training loss = 0.068053, test loss = 0.172629
  Training set accuracy = 0.982500, Test set accuracy = 0.948800
 epoch 8/30. Took 0.2004 seconds. 
  Full-batch training loss = 0.056556, test loss = 0.165064
  Training set accuracy = 0.985400, Test set accuracy = 0.952100
 epoch 9/30. Took 0.2007 seconds. 
  Full-batch training loss = 0.046070, test loss = 0.147314
  Training set accuracy = 0.990700, Test set accuracy = 0.956100
 epoch 10/30. Took 0.2093 seconds. 
  Full-batch training loss = 0.037520, test loss = 0.156629
  Training set accuracy = 0.993700, Test set accuracy = 0.953000
 epoch 11/30. Took 0.20757 seconds. 
  Full-batch training loss = 0.030940, test loss = 0.149851
  Training set accuracy = 0.993800, Test set accuracy = 0.956300
 epoch 12/30. Took 0.201 seconds. 
  Full-batch training loss = 0.023844, test loss = 0.144471
  Training set accuracy = 0.997200, Test set accuracy = 0.956700
 epoch 13/30. Took 0.20212 seconds. 
  Full-batch training loss = 0.020058, test loss = 0.147908
  Training set accuracy = 0.997600, Test set accuracy = 0.957000
 epoch 14/30. Took 0.20234 seconds. 
  Full-batch training loss = 0.018113, test loss = 0.142969
  Training set accuracy = 0.998500, Test set accuracy = 0.958400
 epoch 15/30. Took 0.19986 seconds. 
  Full-batch training loss = 0.014781, test loss = 0.148851
  Training set accuracy = 0.999200, Test set accuracy = 0.958400
 epoch 16/30. Took 0.21974 seconds. 
  Full-batch training loss = 0.012604, test loss = 0.147048
  Training set accuracy = 0.999500, Test set accuracy = 0.959200
 epoch 17/30. Took 0.20027 seconds. 
  Full-batch training loss = 0.012384, test loss = 0.152537
  Training set accuracy = 0.999300, Test set accuracy = 0.955800
 epoch 18/30. Took 0.22343 seconds. 
  Full-batch training loss = 0.009986, test loss = 0.149037
  Training set accuracy = 0.999800, Test set accuracy = 0.957900
 epoch 19/30. Took 0.20326 seconds. 
  Full-batch training loss = 0.009889, test loss = 0.155105
  Training set accuracy = 0.999900, Test set accuracy = 0.956400
 epoch 20/30. Took 0.20688 seconds. 
  Full-batch training loss = 0.008008, test loss = 0.149792
  Training set accuracy = 0.999900, Test set accuracy = 0.959000
 epoch 21/30. Took 0.20503 seconds. 
  Full-batch training loss = 0.007222, test loss = 0.152248
  Training set accuracy = 0.999900, Test set accuracy = 0.958700
 epoch 22/30. Took 0.20366 seconds. 
  Full-batch training loss = 0.006744, test loss = 0.152169
  Training set accuracy = 1.000000, Test set accuracy = 0.958800
 epoch 23/30. Took 0.20154 seconds. 
  Full-batch training loss = 0.006150, test loss = 0.151651
  Training set accuracy = 0.999900, Test set accuracy = 0.959500
 epoch 24/30. Took 0.20511 seconds. 
  Full-batch training loss = 0.005738, test loss = 0.153515
  Training set accuracy = 1.000000, Test set accuracy = 0.958500
 epoch 25/30. Took 0.20503 seconds. 
  Full-batch training loss = 0.005373, test loss = 0.155664
  Training set accuracy = 0.999900, Test set accuracy = 0.959100
 epoch 26/30. Took 0.20511 seconds. 
  Full-batch training loss = 0.004945, test loss = 0.156239
  Training set accuracy = 1.000000, Test set accuracy = 0.959100
 epoch 27/30. Took 0.20501 seconds. 
  Full-batch training loss = 0.004593, test loss = 0.155713
  Training set accuracy = 1.000000, Test set accuracy = 0.959300
 epoch 28/30. Took 0.20745 seconds. 
  Full-batch training loss = 0.004456, test loss = 0.159123
  Training set accuracy = 1.000000, Test set accuracy = 0.958200
 epoch 29/30. Took 0.20653 seconds. 
  Full-batch training loss = 0.004043, test loss = 0.157271
  Training set accuracy = 1.000000, Test set accuracy = 0.960000
 epoch 30/30. Took 0.2044 seconds. 
  Full-batch training loss = 0.003954, test loss = 0.159631
  Training set accuracy = 1.000000, Test set accuracy = 0.958300
Elapsed time is 12.398307 seconds.
End Training
-----
Params 10000 0.100 0.00 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.3372 seconds. 
  Full-batch training loss = 0.349723, test loss = 0.371646
  Training set accuracy = 0.890200, Test set accuracy = 0.882700
 epoch 2/30. Took 0.32295 seconds. 
  Full-batch training loss = 0.218981, test loss = 0.261294
  Training set accuracy = 0.935300, Test set accuracy = 0.924900
 epoch 3/30. Took 0.30947 seconds. 
  Full-batch training loss = 0.176690, test loss = 0.233988
  Training set accuracy = 0.946100, Test set accuracy = 0.926200
 epoch 4/30. Took 0.31203 seconds. 
  Full-batch training loss = 0.131309, test loss = 0.193339
  Training set accuracy = 0.964000, Test set accuracy = 0.941600
 epoch 5/30. Took 0.3123 seconds. 
  Full-batch training loss = 0.104978, test loss = 0.180726
  Training set accuracy = 0.968800, Test set accuracy = 0.945500
 epoch 6/30. Took 0.32567 seconds. 
  Full-batch training loss = 0.085117, test loss = 0.167057
  Training set accuracy = 0.976500, Test set accuracy = 0.949200
 epoch 7/30. Took 0.33008 seconds. 
  Full-batch training loss = 0.061450, test loss = 0.152166
  Training set accuracy = 0.985400, Test set accuracy = 0.954400
 epoch 8/30. Took 0.30717 seconds. 
  Full-batch training loss = 0.054696, test loss = 0.154329
  Training set accuracy = 0.987500, Test set accuracy = 0.955500
 epoch 9/30. Took 0.31137 seconds. 
  Full-batch training loss = 0.038486, test loss = 0.141486
  Training set accuracy = 0.993800, Test set accuracy = 0.958000
 epoch 10/30. Took 0.31335 seconds. 
  Full-batch training loss = 0.034143, test loss = 0.146054
  Training set accuracy = 0.993300, Test set accuracy = 0.956300
 epoch 11/30. Took 0.32634 seconds. 
  Full-batch training loss = 0.027394, test loss = 0.139159
  Training set accuracy = 0.996100, Test set accuracy = 0.960400
 epoch 12/30. Took 0.31554 seconds. 
  Full-batch training loss = 0.022535, test loss = 0.142030
  Training set accuracy = 0.997700, Test set accuracy = 0.959300
 epoch 13/30. Took 0.3139 seconds. 
  Full-batch training loss = 0.018363, test loss = 0.141737
  Training set accuracy = 0.998200, Test set accuracy = 0.960000
 epoch 14/30. Took 0.31214 seconds. 
  Full-batch training loss = 0.015401, test loss = 0.134004
  Training set accuracy = 0.998900, Test set accuracy = 0.962100
 epoch 15/30. Took 0.30966 seconds. 
  Full-batch training loss = 0.013353, test loss = 0.135827
  Training set accuracy = 0.999300, Test set accuracy = 0.962400
 epoch 16/30. Took 0.31177 seconds. 
  Full-batch training loss = 0.012770, test loss = 0.139581
  Training set accuracy = 0.999500, Test set accuracy = 0.961000
 epoch 17/30. Took 0.31111 seconds. 
  Full-batch training loss = 0.011264, test loss = 0.137005
  Training set accuracy = 0.999700, Test set accuracy = 0.963200
 epoch 18/30. Took 0.30996 seconds. 
  Full-batch training loss = 0.008995, test loss = 0.138385
  Training set accuracy = 0.999700, Test set accuracy = 0.963700
 epoch 19/30. Took 0.32537 seconds. 
  Full-batch training loss = 0.008101, test loss = 0.137453
  Training set accuracy = 1.000000, Test set accuracy = 0.963500
 epoch 20/30. Took 0.31104 seconds. 
  Full-batch training loss = 0.007203, test loss = 0.138533
  Training set accuracy = 1.000000, Test set accuracy = 0.963500
 epoch 21/30. Took 0.30816 seconds. 
  Full-batch training loss = 0.006698, test loss = 0.139844
  Training set accuracy = 1.000000, Test set accuracy = 0.963400
 epoch 22/30. Took 0.30799 seconds. 
  Full-batch training loss = 0.006768, test loss = 0.141368
  Training set accuracy = 1.000000, Test set accuracy = 0.963100
 epoch 23/30. Took 0.31037 seconds. 
  Full-batch training loss = 0.005747, test loss = 0.140593
  Training set accuracy = 1.000000, Test set accuracy = 0.963900
 epoch 24/30. Took 0.30452 seconds. 
  Full-batch training loss = 0.005222, test loss = 0.141208
  Training set accuracy = 1.000000, Test set accuracy = 0.964400
 epoch 25/30. Took 0.31117 seconds. 
  Full-batch training loss = 0.005106, test loss = 0.145607
  Training set accuracy = 1.000000, Test set accuracy = 0.963500
 epoch 26/30. Took 0.30924 seconds. 
  Full-batch training loss = 0.004688, test loss = 0.142804
  Training set accuracy = 1.000000, Test set accuracy = 0.964500
 epoch 27/30. Took 0.32211 seconds. 
  Full-batch training loss = 0.004304, test loss = 0.143208
  Training set accuracy = 1.000000, Test set accuracy = 0.964100
 epoch 28/30. Took 0.31332 seconds. 
  Full-batch training loss = 0.004009, test loss = 0.143556
  Training set accuracy = 1.000000, Test set accuracy = 0.964000
 epoch 29/30. Took 0.311 seconds. 
  Full-batch training loss = 0.003828, test loss = 0.142922
  Training set accuracy = 1.000000, Test set accuracy = 0.964500
 epoch 30/30. Took 0.3084 seconds. 
  Full-batch training loss = 0.003613, test loss = 0.144912
  Training set accuracy = 1.000000, Test set accuracy = 0.964600
Elapsed time is 17.532741 seconds.
End Training
-----
Params 10000 0.100 0.00 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.67417 seconds. 
  Full-batch training loss = 0.276073, test loss = 0.301677
  Training set accuracy = 0.922700, Test set accuracy = 0.912500
 epoch 2/30. Took 0.65279 seconds. 
  Full-batch training loss = 0.194419, test loss = 0.243433
  Training set accuracy = 0.945500, Test set accuracy = 0.927500
 epoch 3/30. Took 0.64974 seconds. 
  Full-batch training loss = 0.142752, test loss = 0.211298
  Training set accuracy = 0.962100, Test set accuracy = 0.938700
 epoch 4/30. Took 0.66202 seconds. 
  Full-batch training loss = 0.124798, test loss = 0.200186
  Training set accuracy = 0.964100, Test set accuracy = 0.939000
 epoch 5/30. Took 0.65379 seconds. 
  Full-batch training loss = 0.089555, test loss = 0.175340
  Training set accuracy = 0.977900, Test set accuracy = 0.947000
 epoch 6/30. Took 0.65157 seconds. 
  Full-batch training loss = 0.065243, test loss = 0.157099
  Training set accuracy = 0.986600, Test set accuracy = 0.953900
 epoch 7/30. Took 0.65589 seconds. 
  Full-batch training loss = 0.051906, test loss = 0.151243
  Training set accuracy = 0.990400, Test set accuracy = 0.954800
 epoch 8/30. Took 0.64807 seconds. 
  Full-batch training loss = 0.041908, test loss = 0.145892
  Training set accuracy = 0.992100, Test set accuracy = 0.957200
 epoch 9/30. Took 0.6475 seconds. 
  Full-batch training loss = 0.033503, test loss = 0.145783
  Training set accuracy = 0.994100, Test set accuracy = 0.956100
 epoch 10/30. Took 0.65029 seconds. 
  Full-batch training loss = 0.025287, test loss = 0.136968
  Training set accuracy = 0.997300, Test set accuracy = 0.958300
 epoch 11/30. Took 0.65882 seconds. 
  Full-batch training loss = 0.020867, test loss = 0.135975
  Training set accuracy = 0.998200, Test set accuracy = 0.959100
 epoch 12/30. Took 0.64825 seconds. 
  Full-batch training loss = 0.017542, test loss = 0.138861
  Training set accuracy = 0.999300, Test set accuracy = 0.957100
 epoch 13/30. Took 0.65628 seconds. 
  Full-batch training loss = 0.014636, test loss = 0.136275
  Training set accuracy = 0.999400, Test set accuracy = 0.960500
 epoch 14/30. Took 0.65869 seconds. 
  Full-batch training loss = 0.013414, test loss = 0.137396
  Training set accuracy = 0.999000, Test set accuracy = 0.960400
 epoch 15/30. Took 0.68897 seconds. 
  Full-batch training loss = 0.010586, test loss = 0.137896
  Training set accuracy = 0.999800, Test set accuracy = 0.959600
 epoch 16/30. Took 0.65021 seconds. 
  Full-batch training loss = 0.010068, test loss = 0.137047
  Training set accuracy = 0.999600, Test set accuracy = 0.960600
 epoch 17/30. Took 0.65092 seconds. 
  Full-batch training loss = 0.008974, test loss = 0.138580
  Training set accuracy = 0.999900, Test set accuracy = 0.960500
 epoch 18/30. Took 0.65776 seconds. 
  Full-batch training loss = 0.007487, test loss = 0.137204
  Training set accuracy = 1.000000, Test set accuracy = 0.960800
 epoch 19/30. Took 0.65507 seconds. 
  Full-batch training loss = 0.006671, test loss = 0.137529
  Training set accuracy = 0.999900, Test set accuracy = 0.961400
 epoch 20/30. Took 0.65131 seconds. 
  Full-batch training loss = 0.005923, test loss = 0.138226
  Training set accuracy = 1.000000, Test set accuracy = 0.961100
 epoch 21/30. Took 0.64843 seconds. 
  Full-batch training loss = 0.005599, test loss = 0.140214
  Training set accuracy = 1.000000, Test set accuracy = 0.960900
 epoch 22/30. Took 0.65026 seconds. 
  Full-batch training loss = 0.005219, test loss = 0.140577
  Training set accuracy = 1.000000, Test set accuracy = 0.961100
 epoch 23/30. Took 0.65572 seconds. 
  Full-batch training loss = 0.004923, test loss = 0.139715
  Training set accuracy = 0.999900, Test set accuracy = 0.961300
 epoch 24/30. Took 0.64857 seconds. 
  Full-batch training loss = 0.004538, test loss = 0.141033
  Training set accuracy = 1.000000, Test set accuracy = 0.961800
 epoch 25/30. Took 0.65008 seconds. 
  Full-batch training loss = 0.004227, test loss = 0.142773
  Training set accuracy = 1.000000, Test set accuracy = 0.960700
 epoch 26/30. Took 0.65054 seconds. 
  Full-batch training loss = 0.003909, test loss = 0.141492
  Training set accuracy = 1.000000, Test set accuracy = 0.962300
 epoch 27/30. Took 0.65144 seconds. 
  Full-batch training loss = 0.003646, test loss = 0.141916
  Training set accuracy = 1.000000, Test set accuracy = 0.961800
 epoch 28/30. Took 0.65224 seconds. 
  Full-batch training loss = 0.003471, test loss = 0.142291
  Training set accuracy = 1.000000, Test set accuracy = 0.961500
 epoch 29/30. Took 0.65087 seconds. 
  Full-batch training loss = 0.003273, test loss = 0.144039
  Training set accuracy = 1.000000, Test set accuracy = 0.961600
 epoch 30/30. Took 0.6565 seconds. 
  Full-batch training loss = 0.003207, test loss = 0.144094
  Training set accuracy = 1.000000, Test set accuracy = 0.961600
Elapsed time is 34.663655 seconds.
End Training
-----
Params 10000 0.100 0.00 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23439 seconds. 
  Full-batch training loss = 0.280242, test loss = 0.313612
  Training set accuracy = 0.917000, Test set accuracy = 0.905000
 epoch 2/30. Took 0.23377 seconds. 
  Full-batch training loss = 0.195768, test loss = 0.249679
  Training set accuracy = 0.941200, Test set accuracy = 0.921300
 epoch 3/30. Took 0.2342 seconds. 
  Full-batch training loss = 0.118998, test loss = 0.188899
  Training set accuracy = 0.966700, Test set accuracy = 0.941700
 epoch 4/30. Took 0.23494 seconds. 
  Full-batch training loss = 0.110361, test loss = 0.199998
  Training set accuracy = 0.966500, Test set accuracy = 0.939500
 epoch 5/30. Took 0.22969 seconds. 
  Full-batch training loss = 0.065675, test loss = 0.156517
  Training set accuracy = 0.980900, Test set accuracy = 0.951600
 epoch 6/30. Took 0.22741 seconds. 
  Full-batch training loss = 0.047848, test loss = 0.152492
  Training set accuracy = 0.987400, Test set accuracy = 0.956700
 epoch 7/30. Took 0.23367 seconds. 
  Full-batch training loss = 0.037552, test loss = 0.166217
  Training set accuracy = 0.989000, Test set accuracy = 0.952800
 epoch 8/30. Took 0.23458 seconds. 
  Full-batch training loss = 0.027091, test loss = 0.158045
  Training set accuracy = 0.993200, Test set accuracy = 0.955200
 epoch 9/30. Took 0.2344 seconds. 
  Full-batch training loss = 0.028891, test loss = 0.159982
  Training set accuracy = 0.992400, Test set accuracy = 0.956500
 epoch 10/30. Took 0.23457 seconds. 
  Full-batch training loss = 0.015364, test loss = 0.158476
  Training set accuracy = 0.996500, Test set accuracy = 0.958100
 epoch 11/30. Took 0.2297 seconds. 
  Full-batch training loss = 0.007735, test loss = 0.153692
  Training set accuracy = 0.999500, Test set accuracy = 0.959000
 epoch 12/30. Took 0.23374 seconds. 
  Full-batch training loss = 0.004948, test loss = 0.156535
  Training set accuracy = 0.999700, Test set accuracy = 0.962200
 epoch 13/30. Took 0.23491 seconds. 
  Full-batch training loss = 0.003408, test loss = 0.159131
  Training set accuracy = 0.999900, Test set accuracy = 0.962500
 epoch 14/30. Took 0.22789 seconds. 
  Full-batch training loss = 0.002183, test loss = 0.158597
  Training set accuracy = 1.000000, Test set accuracy = 0.962700
 epoch 15/30. Took 0.23422 seconds. 
  Full-batch training loss = 0.001759, test loss = 0.159555
  Training set accuracy = 1.000000, Test set accuracy = 0.964000
 epoch 16/30. Took 0.23373 seconds. 
  Full-batch training loss = 0.001660, test loss = 0.162883
  Training set accuracy = 1.000000, Test set accuracy = 0.963600
 epoch 17/30. Took 0.23356 seconds. 
  Full-batch training loss = 0.001431, test loss = 0.165417
  Training set accuracy = 1.000000, Test set accuracy = 0.963800
 epoch 18/30. Took 0.2449 seconds. 
  Full-batch training loss = 0.001259, test loss = 0.166647
  Training set accuracy = 1.000000, Test set accuracy = 0.964000
 epoch 19/30. Took 0.23231 seconds. 
  Full-batch training loss = 0.001166, test loss = 0.167660
  Training set accuracy = 1.000000, Test set accuracy = 0.964000
 epoch 20/30. Took 0.23237 seconds. 
  Full-batch training loss = 0.001054, test loss = 0.168923
  Training set accuracy = 1.000000, Test set accuracy = 0.964300
 epoch 21/30. Took 0.23454 seconds. 
  Full-batch training loss = 0.000977, test loss = 0.171587
  Training set accuracy = 1.000000, Test set accuracy = 0.963500
 epoch 22/30. Took 0.23368 seconds. 
  Full-batch training loss = 0.000898, test loss = 0.171866
  Training set accuracy = 1.000000, Test set accuracy = 0.964300
 epoch 23/30. Took 0.2312 seconds. 
  Full-batch training loss = 0.000848, test loss = 0.174104
  Training set accuracy = 1.000000, Test set accuracy = 0.964100
 epoch 24/30. Took 0.23367 seconds. 
  Full-batch training loss = 0.000804, test loss = 0.174634
  Training set accuracy = 1.000000, Test set accuracy = 0.964100
 epoch 25/30. Took 0.24366 seconds. 
  Full-batch training loss = 0.000756, test loss = 0.177173
  Training set accuracy = 1.000000, Test set accuracy = 0.963600
 epoch 26/30. Took 0.23729 seconds. 
  Full-batch training loss = 0.000721, test loss = 0.176192
  Training set accuracy = 1.000000, Test set accuracy = 0.964000
 epoch 27/30. Took 0.23431 seconds. 
  Full-batch training loss = 0.000668, test loss = 0.178449
  Training set accuracy = 1.000000, Test set accuracy = 0.964100
 epoch 28/30. Took 0.23438 seconds. 
  Full-batch training loss = 0.000635, test loss = 0.178295
  Training set accuracy = 1.000000, Test set accuracy = 0.964100
 epoch 29/30. Took 0.23413 seconds. 
  Full-batch training loss = 0.000605, test loss = 0.178965
  Training set accuracy = 1.000000, Test set accuracy = 0.964000
 epoch 30/30. Took 0.23396 seconds. 
  Full-batch training loss = 0.000577, test loss = 0.180774
  Training set accuracy = 1.000000, Test set accuracy = 0.963900
Elapsed time is 13.934715 seconds.
End Training
-----
Params 10000 0.100 0.00 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.40182 seconds. 
  Full-batch training loss = 0.270502, test loss = 0.295186
  Training set accuracy = 0.918000, Test set accuracy = 0.909800
 epoch 2/30. Took 0.40036 seconds. 
  Full-batch training loss = 0.155387, test loss = 0.194798
  Training set accuracy = 0.955500, Test set accuracy = 0.939600
 epoch 3/30. Took 0.40087 seconds. 
  Full-batch training loss = 0.134076, test loss = 0.197822
  Training set accuracy = 0.959700, Test set accuracy = 0.939400
 epoch 4/30. Took 0.40405 seconds. 
  Full-batch training loss = 0.096681, test loss = 0.172701
  Training set accuracy = 0.970700, Test set accuracy = 0.946100
 epoch 5/30. Took 0.41371 seconds. 
  Full-batch training loss = 0.071865, test loss = 0.169896
  Training set accuracy = 0.978400, Test set accuracy = 0.945200
 epoch 6/30. Took 0.39267 seconds. 
  Full-batch training loss = 0.041533, test loss = 0.141333
  Training set accuracy = 0.989600, Test set accuracy = 0.955700
 epoch 7/30. Took 0.39679 seconds. 
  Full-batch training loss = 0.039112, test loss = 0.166881
  Training set accuracy = 0.988000, Test set accuracy = 0.951000
 epoch 8/30. Took 0.39903 seconds. 
  Full-batch training loss = 0.024363, test loss = 0.157030
  Training set accuracy = 0.994200, Test set accuracy = 0.954800
 epoch 9/30. Took 0.41338 seconds. 
  Full-batch training loss = 0.013908, test loss = 0.144852
  Training set accuracy = 0.997400, Test set accuracy = 0.959000
 epoch 10/30. Took 0.39875 seconds. 
  Full-batch training loss = 0.009083, test loss = 0.141219
  Training set accuracy = 0.998900, Test set accuracy = 0.963000
 epoch 11/30. Took 0.4007 seconds. 
  Full-batch training loss = 0.004523, test loss = 0.142645
  Training set accuracy = 0.999800, Test set accuracy = 0.963100
 epoch 12/30. Took 0.40028 seconds. 
  Full-batch training loss = 0.003353, test loss = 0.147326
  Training set accuracy = 0.999900, Test set accuracy = 0.962500
 epoch 13/30. Took 0.40061 seconds. 
  Full-batch training loss = 0.002771, test loss = 0.149391
  Training set accuracy = 1.000000, Test set accuracy = 0.963200
 epoch 14/30. Took 0.40974 seconds. 
  Full-batch training loss = 0.002050, test loss = 0.150782
  Training set accuracy = 1.000000, Test set accuracy = 0.963700
 epoch 15/30. Took 0.39939 seconds. 
  Full-batch training loss = 0.001699, test loss = 0.153374
  Training set accuracy = 1.000000, Test set accuracy = 0.963000
 epoch 16/30. Took 0.39947 seconds. 
  Full-batch training loss = 0.001727, test loss = 0.157816
  Training set accuracy = 1.000000, Test set accuracy = 0.963400
 epoch 17/30. Took 0.39738 seconds. 
  Full-batch training loss = 0.001349, test loss = 0.156458
  Training set accuracy = 1.000000, Test set accuracy = 0.963300
 epoch 18/30. Took 0.41394 seconds. 
  Full-batch training loss = 0.001225, test loss = 0.158882
  Training set accuracy = 1.000000, Test set accuracy = 0.963000
 epoch 19/30. Took 0.40092 seconds. 
  Full-batch training loss = 0.001141, test loss = 0.160708
  Training set accuracy = 1.000000, Test set accuracy = 0.963200
 epoch 20/30. Took 0.43067 seconds. 
  Full-batch training loss = 0.001029, test loss = 0.160671
  Training set accuracy = 1.000000, Test set accuracy = 0.962700
 epoch 21/30. Took 0.39929 seconds. 
  Full-batch training loss = 0.000961, test loss = 0.161942
  Training set accuracy = 1.000000, Test set accuracy = 0.962900
 epoch 22/30. Took 0.40056 seconds. 
  Full-batch training loss = 0.000914, test loss = 0.164535
  Training set accuracy = 1.000000, Test set accuracy = 0.963300
 epoch 23/30. Took 0.4032 seconds. 
  Full-batch training loss = 0.000847, test loss = 0.165556
  Training set accuracy = 1.000000, Test set accuracy = 0.963200
 epoch 24/30. Took 0.43113 seconds. 
  Full-batch training loss = 0.000771, test loss = 0.165693
  Training set accuracy = 1.000000, Test set accuracy = 0.962700
 epoch 25/30. Took 0.39246 seconds. 
  Full-batch training loss = 0.000742, test loss = 0.166656
  Training set accuracy = 1.000000, Test set accuracy = 0.962900
 epoch 26/30. Took 0.39478 seconds. 
  Full-batch training loss = 0.000694, test loss = 0.167640
  Training set accuracy = 1.000000, Test set accuracy = 0.963300
 epoch 27/30. Took 0.40079 seconds. 
  Full-batch training loss = 0.000661, test loss = 0.169331
  Training set accuracy = 1.000000, Test set accuracy = 0.962300
 epoch 28/30. Took 0.39811 seconds. 
  Full-batch training loss = 0.000624, test loss = 0.170073
  Training set accuracy = 1.000000, Test set accuracy = 0.963200
 epoch 29/30. Took 0.42346 seconds. 
  Full-batch training loss = 0.000594, test loss = 0.170404
  Training set accuracy = 1.000000, Test set accuracy = 0.963200
 epoch 30/30. Took 0.41057 seconds. 
  Full-batch training loss = 0.000568, test loss = 0.171031
  Training set accuracy = 1.000000, Test set accuracy = 0.962600
Elapsed time is 21.794015 seconds.
End Training
-----
Params 10000 0.100 0.00 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.0561 seconds. 
  Full-batch training loss = 0.227955, test loss = 0.255515
  Training set accuracy = 0.934100, Test set accuracy = 0.923600
 epoch 2/30. Took 1.0951 seconds. 
  Full-batch training loss = 0.141510, test loss = 0.207818
  Training set accuracy = 0.961100, Test set accuracy = 0.934400
 epoch 3/30. Took 1.0753 seconds. 
  Full-batch training loss = 0.084025, test loss = 0.165628
  Training set accuracy = 0.978100, Test set accuracy = 0.948700
 epoch 4/30. Took 1.0847 seconds. 
  Full-batch training loss = 0.087146, test loss = 0.187571
  Training set accuracy = 0.975900, Test set accuracy = 0.943200
 epoch 5/30. Took 1.0512 seconds. 
  Full-batch training loss = 0.048268, test loss = 0.154353
  Training set accuracy = 0.987800, Test set accuracy = 0.952300
 epoch 6/30. Took 1.0415 seconds. 
  Full-batch training loss = 0.031412, test loss = 0.153159
  Training set accuracy = 0.992300, Test set accuracy = 0.956100
 epoch 7/30. Took 1.0469 seconds. 
  Full-batch training loss = 0.015989, test loss = 0.133833
  Training set accuracy = 0.997100, Test set accuracy = 0.960100
 epoch 8/30. Took 1.0423 seconds. 
  Full-batch training loss = 0.009545, test loss = 0.137661
  Training set accuracy = 0.999200, Test set accuracy = 0.962000
 epoch 9/30. Took 1.045 seconds. 
  Full-batch training loss = 0.007775, test loss = 0.143511
  Training set accuracy = 0.999600, Test set accuracy = 0.961100
 epoch 10/30. Took 1.0636 seconds. 
  Full-batch training loss = 0.003853, test loss = 0.137960
  Training set accuracy = 1.000000, Test set accuracy = 0.961900
 epoch 11/30. Took 1.0425 seconds. 
  Full-batch training loss = 0.003285, test loss = 0.138134
  Training set accuracy = 0.999900, Test set accuracy = 0.962600
 epoch 12/30. Took 1.0616 seconds. 
  Full-batch training loss = 0.002534, test loss = 0.142960
  Training set accuracy = 1.000000, Test set accuracy = 0.963300
 epoch 13/30. Took 1.0496 seconds. 
  Full-batch training loss = 0.001899, test loss = 0.144020
  Training set accuracy = 1.000000, Test set accuracy = 0.964700
 epoch 14/30. Took 1.0637 seconds. 
  Full-batch training loss = 0.001733, test loss = 0.145624
  Training set accuracy = 1.000000, Test set accuracy = 0.963600
 epoch 15/30. Took 1.0712 seconds. 
  Full-batch training loss = 0.001463, test loss = 0.146329
  Training set accuracy = 1.000000, Test set accuracy = 0.963600
 epoch 16/30. Took 1.0666 seconds. 
  Full-batch training loss = 0.001311, test loss = 0.147696
  Training set accuracy = 1.000000, Test set accuracy = 0.964100
 epoch 17/30. Took 1.0424 seconds. 
  Full-batch training loss = 0.001189, test loss = 0.148650
  Training set accuracy = 1.000000, Test set accuracy = 0.964800
 epoch 18/30. Took 1.1209 seconds. 
  Full-batch training loss = 0.001093, test loss = 0.150616
  Training set accuracy = 1.000000, Test set accuracy = 0.964400
 epoch 19/30. Took 1.0495 seconds. 
  Full-batch training loss = 0.001018, test loss = 0.150750
  Training set accuracy = 1.000000, Test set accuracy = 0.964300
 epoch 20/30. Took 1.0689 seconds. 
  Full-batch training loss = 0.000928, test loss = 0.152673
  Training set accuracy = 1.000000, Test set accuracy = 0.964900
 epoch 21/30. Took 1.0457 seconds. 
  Full-batch training loss = 0.000859, test loss = 0.153282
  Training set accuracy = 1.000000, Test set accuracy = 0.964400
 epoch 22/30. Took 1.0471 seconds. 
  Full-batch training loss = 0.000817, test loss = 0.153624
  Training set accuracy = 1.000000, Test set accuracy = 0.964700
 epoch 23/30. Took 1.0448 seconds. 
  Full-batch training loss = 0.000757, test loss = 0.155218
  Training set accuracy = 1.000000, Test set accuracy = 0.964600
 epoch 24/30. Took 1.0525 seconds. 
  Full-batch training loss = 0.000710, test loss = 0.155649
  Training set accuracy = 1.000000, Test set accuracy = 0.965000
 epoch 25/30. Took 1.0458 seconds. 
  Full-batch training loss = 0.000671, test loss = 0.156834
  Training set accuracy = 1.000000, Test set accuracy = 0.965300
 epoch 26/30. Took 1.042 seconds. 
  Full-batch training loss = 0.000632, test loss = 0.157323
  Training set accuracy = 1.000000, Test set accuracy = 0.965000
 epoch 27/30. Took 1.0436 seconds. 
  Full-batch training loss = 0.000603, test loss = 0.157999
  Training set accuracy = 1.000000, Test set accuracy = 0.965300
 epoch 28/30. Took 1.0801 seconds. 
  Full-batch training loss = 0.000584, test loss = 0.159111
  Training set accuracy = 1.000000, Test set accuracy = 0.964700
 epoch 29/30. Took 1.043 seconds. 
  Full-batch training loss = 0.000553, test loss = 0.159888
  Training set accuracy = 1.000000, Test set accuracy = 0.965400
 epoch 30/30. Took 1.0441 seconds. 
  Full-batch training loss = 0.000533, test loss = 0.160691
  Training set accuracy = 1.000000, Test set accuracy = 0.965200
Elapsed time is 55.433611 seconds.
End Training
-----
Params 10000 0.100 0.00 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27415 seconds. 
  Full-batch training loss = 0.273968, test loss = 0.300278
  Training set accuracy = 0.918400, Test set accuracy = 0.909100
 epoch 2/30. Took 0.25322 seconds. 
  Full-batch training loss = 0.194788, test loss = 0.235345
  Training set accuracy = 0.944000, Test set accuracy = 0.930800
 epoch 3/30. Took 0.25478 seconds. 
  Full-batch training loss = 0.125486, test loss = 0.195494
  Training set accuracy = 0.962300, Test set accuracy = 0.941700
 epoch 4/30. Took 0.26125 seconds. 
  Full-batch training loss = 0.095959, test loss = 0.190249
  Training set accuracy = 0.969800, Test set accuracy = 0.942800
 epoch 5/30. Took 0.26209 seconds. 
  Full-batch training loss = 0.058495, test loss = 0.166461
  Training set accuracy = 0.981600, Test set accuracy = 0.952400
 epoch 6/30. Took 0.26499 seconds. 
  Full-batch training loss = 0.059711, test loss = 0.182793
  Training set accuracy = 0.981900, Test set accuracy = 0.950700
 epoch 7/30. Took 0.25994 seconds. 
  Full-batch training loss = 0.098119, test loss = 0.242544
  Training set accuracy = 0.971500, Test set accuracy = 0.939600
 epoch 8/30. Took 0.26108 seconds. 
  Full-batch training loss = 0.042195, test loss = 0.184006
  Training set accuracy = 0.986500, Test set accuracy = 0.949400
 epoch 9/30. Took 0.25235 seconds. 
  Full-batch training loss = 0.031807, test loss = 0.199192
  Training set accuracy = 0.990200, Test set accuracy = 0.950800
 epoch 10/30. Took 0.25381 seconds. 
  Full-batch training loss = 0.031349, test loss = 0.200968
  Training set accuracy = 0.988700, Test set accuracy = 0.952400
 epoch 11/30. Took 0.25914 seconds. 
  Full-batch training loss = 0.107434, test loss = 0.311694
  Training set accuracy = 0.975000, Test set accuracy = 0.933200
 epoch 12/30. Took 0.25611 seconds. 
  Full-batch training loss = 0.007030, test loss = 0.187520
  Training set accuracy = 0.998100, Test set accuracy = 0.959800
 epoch 13/30. Took 0.25431 seconds. 
  Full-batch training loss = 0.001526, test loss = 0.182578
  Training set accuracy = 0.999900, Test set accuracy = 0.961300
 epoch 14/30. Took 0.26138 seconds. 
  Full-batch training loss = 0.000889, test loss = 0.186289
  Training set accuracy = 1.000000, Test set accuracy = 0.961200
 epoch 15/30. Took 0.26783 seconds. 
  Full-batch training loss = 0.000528, test loss = 0.188837
  Training set accuracy = 1.000000, Test set accuracy = 0.962300
 epoch 16/30. Took 0.26477 seconds. 
  Full-batch training loss = 0.000435, test loss = 0.192095
  Training set accuracy = 1.000000, Test set accuracy = 0.963100
 epoch 17/30. Took 0.25612 seconds. 
  Full-batch training loss = 0.000376, test loss = 0.194773
  Training set accuracy = 1.000000, Test set accuracy = 0.963200
 epoch 18/30. Took 0.26192 seconds. 
  Full-batch training loss = 0.000339, test loss = 0.197019
  Training set accuracy = 1.000000, Test set accuracy = 0.962300
 epoch 19/30. Took 0.26333 seconds. 
  Full-batch training loss = 0.000307, test loss = 0.198704
  Training set accuracy = 1.000000, Test set accuracy = 0.963000
 epoch 20/30. Took 0.2641 seconds. 
  Full-batch training loss = 0.000277, test loss = 0.201752
  Training set accuracy = 1.000000, Test set accuracy = 0.962700
 epoch 21/30. Took 0.2611 seconds. 
  Full-batch training loss = 0.000254, test loss = 0.202951
  Training set accuracy = 1.000000, Test set accuracy = 0.962800
 epoch 22/30. Took 0.25444 seconds. 
  Full-batch training loss = 0.000235, test loss = 0.204879
  Training set accuracy = 1.000000, Test set accuracy = 0.962900
 epoch 23/30. Took 0.25925 seconds. 
  Full-batch training loss = 0.000219, test loss = 0.206399
  Training set accuracy = 1.000000, Test set accuracy = 0.962800
 epoch 24/30. Took 0.26082 seconds. 
  Full-batch training loss = 0.000206, test loss = 0.208158
  Training set accuracy = 1.000000, Test set accuracy = 0.962700
 epoch 25/30. Took 0.26185 seconds. 
  Full-batch training loss = 0.000193, test loss = 0.208941
  Training set accuracy = 1.000000, Test set accuracy = 0.963000
 epoch 26/30. Took 0.26332 seconds. 
  Full-batch training loss = 0.000182, test loss = 0.210420
  Training set accuracy = 1.000000, Test set accuracy = 0.962900
 epoch 27/30. Took 0.26278 seconds. 
  Full-batch training loss = 0.000173, test loss = 0.211318
  Training set accuracy = 1.000000, Test set accuracy = 0.963100
 epoch 28/30. Took 0.26789 seconds. 
  Full-batch training loss = 0.000164, test loss = 0.212528
  Training set accuracy = 1.000000, Test set accuracy = 0.963000
 epoch 29/30. Took 0.2633 seconds. 
  Full-batch training loss = 0.000156, test loss = 0.213860
  Training set accuracy = 1.000000, Test set accuracy = 0.963000
 epoch 30/30. Took 0.26347 seconds. 
  Full-batch training loss = 0.000149, test loss = 0.214530
  Training set accuracy = 1.000000, Test set accuracy = 0.963300
Elapsed time is 15.519826 seconds.
End Training
-----
Params 10000 0.100 0.00 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.48579 seconds. 
  Full-batch training loss = 0.267814, test loss = 0.286896
  Training set accuracy = 0.916100, Test set accuracy = 0.911700
 epoch 2/30. Took 0.48101 seconds. 
  Full-batch training loss = 0.156151, test loss = 0.199359
  Training set accuracy = 0.951800, Test set accuracy = 0.934900
 epoch 3/30. Took 0.4648 seconds. 
  Full-batch training loss = 0.102162, test loss = 0.179867
  Training set accuracy = 0.969400, Test set accuracy = 0.944200
 epoch 4/30. Took 0.47092 seconds. 
  Full-batch training loss = 0.074776, test loss = 0.169664
  Training set accuracy = 0.975700, Test set accuracy = 0.948500
 epoch 5/30. Took 0.46613 seconds. 
  Full-batch training loss = 0.062040, test loss = 0.162518
  Training set accuracy = 0.980500, Test set accuracy = 0.952000
 epoch 6/30. Took 0.46599 seconds. 
  Full-batch training loss = 0.046121, test loss = 0.167192
  Training set accuracy = 0.985200, Test set accuracy = 0.949700
 epoch 7/30. Took 0.46917 seconds. 
  Full-batch training loss = 0.027164, test loss = 0.161451
  Training set accuracy = 0.991700, Test set accuracy = 0.953700
 epoch 8/30. Took 0.46843 seconds. 
  Full-batch training loss = 0.026649, test loss = 0.156566
  Training set accuracy = 0.991700, Test set accuracy = 0.955800
 epoch 9/30. Took 0.46505 seconds. 
  Full-batch training loss = 0.015233, test loss = 0.156171
  Training set accuracy = 0.995000, Test set accuracy = 0.958500
 epoch 10/30. Took 0.45849 seconds. 
  Full-batch training loss = 0.008017, test loss = 0.166756
  Training set accuracy = 0.998500, Test set accuracy = 0.960100
 epoch 11/30. Took 0.46244 seconds. 
  Full-batch training loss = 0.004555, test loss = 0.157314
  Training set accuracy = 0.999300, Test set accuracy = 0.961700
 epoch 12/30. Took 0.4733 seconds. 
  Full-batch training loss = 0.000996, test loss = 0.143913
  Training set accuracy = 1.000000, Test set accuracy = 0.967000
 epoch 13/30. Took 0.4689 seconds. 
  Full-batch training loss = 0.000837, test loss = 0.145966
  Training set accuracy = 1.000000, Test set accuracy = 0.966900
 epoch 14/30. Took 0.46616 seconds. 
  Full-batch training loss = 0.000500, test loss = 0.148033
  Training set accuracy = 1.000000, Test set accuracy = 0.966800
 epoch 15/30. Took 0.46715 seconds. 
  Full-batch training loss = 0.000436, test loss = 0.150573
  Training set accuracy = 1.000000, Test set accuracy = 0.966900
 epoch 16/30. Took 0.46416 seconds. 
  Full-batch training loss = 0.000369, test loss = 0.152400
  Training set accuracy = 1.000000, Test set accuracy = 0.967200
 epoch 17/30. Took 0.46713 seconds. 
  Full-batch training loss = 0.000329, test loss = 0.154345
  Training set accuracy = 1.000000, Test set accuracy = 0.967000
 epoch 18/30. Took 0.46374 seconds. 
  Full-batch training loss = 0.000301, test loss = 0.156690
  Training set accuracy = 1.000000, Test set accuracy = 0.966900
 epoch 19/30. Took 0.46167 seconds. 
  Full-batch training loss = 0.000272, test loss = 0.158200
  Training set accuracy = 1.000000, Test set accuracy = 0.966700
 epoch 20/30. Took 0.46729 seconds. 
  Full-batch training loss = 0.000250, test loss = 0.159617
  Training set accuracy = 1.000000, Test set accuracy = 0.966300
 epoch 21/30. Took 0.48457 seconds. 
  Full-batch training loss = 0.000232, test loss = 0.160702
  Training set accuracy = 1.000000, Test set accuracy = 0.966900
 epoch 22/30. Took 0.46568 seconds. 
  Full-batch training loss = 0.000216, test loss = 0.161956
  Training set accuracy = 1.000000, Test set accuracy = 0.966700
 epoch 23/30. Took 0.49654 seconds. 
  Full-batch training loss = 0.000203, test loss = 0.163079
  Training set accuracy = 1.000000, Test set accuracy = 0.966300
 epoch 24/30. Took 0.49108 seconds. 
  Full-batch training loss = 0.000191, test loss = 0.164397
  Training set accuracy = 1.000000, Test set accuracy = 0.966700
 epoch 25/30. Took 0.47841 seconds. 
  Full-batch training loss = 0.000180, test loss = 0.165027
  Training set accuracy = 1.000000, Test set accuracy = 0.966600
 epoch 26/30. Took 0.48377 seconds. 
  Full-batch training loss = 0.000171, test loss = 0.165969
  Training set accuracy = 1.000000, Test set accuracy = 0.966600
 epoch 27/30. Took 0.46881 seconds. 
  Full-batch training loss = 0.000162, test loss = 0.166799
  Training set accuracy = 1.000000, Test set accuracy = 0.966400
 epoch 28/30. Took 0.46502 seconds. 
  Full-batch training loss = 0.000155, test loss = 0.167776
  Training set accuracy = 1.000000, Test set accuracy = 0.966300
 epoch 29/30. Took 0.46249 seconds. 
  Full-batch training loss = 0.000148, test loss = 0.168576
  Training set accuracy = 1.000000, Test set accuracy = 0.966400
 epoch 30/30. Took 0.46526 seconds. 
  Full-batch training loss = 0.000141, test loss = 0.169077
  Training set accuracy = 1.000000, Test set accuracy = 0.966400
Elapsed time is 27.353110 seconds.
End Training
-----
Params 10000 0.100 0.00 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.4549 seconds. 
  Full-batch training loss = 0.242139, test loss = 0.262963
  Training set accuracy = 0.921900, Test set accuracy = 0.917700
 epoch 2/30. Took 1.4371 seconds. 
  Full-batch training loss = 0.146954, test loss = 0.196164
  Training set accuracy = 0.957700, Test set accuracy = 0.937500
 epoch 3/30. Took 1.4373 seconds. 
  Full-batch training loss = 0.100087, test loss = 0.178320
  Training set accuracy = 0.969100, Test set accuracy = 0.943600
 epoch 4/30. Took 1.4275 seconds. 
  Full-batch training loss = 0.053153, test loss = 0.130477
  Training set accuracy = 0.985900, Test set accuracy = 0.958400
 epoch 5/30. Took 1.4216 seconds. 
  Full-batch training loss = 0.040887, test loss = 0.140648
  Training set accuracy = 0.988500, Test set accuracy = 0.955000
 epoch 6/30. Took 1.4267 seconds. 
  Full-batch training loss = 0.052171, test loss = 0.177840
  Training set accuracy = 0.983100, Test set accuracy = 0.949300
 epoch 7/30. Took 1.4242 seconds. 
  Full-batch training loss = 0.023189, test loss = 0.149476
  Training set accuracy = 0.993100, Test set accuracy = 0.957000
 epoch 8/30. Took 1.4299 seconds. 
  Full-batch training loss = 0.004866, test loss = 0.126186
  Training set accuracy = 0.999100, Test set accuracy = 0.966500
 epoch 9/30. Took 1.4235 seconds. 
  Full-batch training loss = 0.005709, test loss = 0.140014
  Training set accuracy = 0.998100, Test set accuracy = 0.963100
 epoch 10/30. Took 1.4487 seconds. 
  Full-batch training loss = 0.002556, test loss = 0.135887
  Training set accuracy = 0.999600, Test set accuracy = 0.965400
 epoch 11/30. Took 1.4273 seconds. 
  Full-batch training loss = 0.001368, test loss = 0.133115
  Training set accuracy = 0.999800, Test set accuracy = 0.966100
 epoch 12/30. Took 1.4236 seconds. 
  Full-batch training loss = 0.000613, test loss = 0.133808
  Training set accuracy = 1.000000, Test set accuracy = 0.966500
 epoch 13/30. Took 1.4255 seconds. 
  Full-batch training loss = 0.000514, test loss = 0.134509
  Training set accuracy = 1.000000, Test set accuracy = 0.967200
 epoch 14/30. Took 1.4608 seconds. 
  Full-batch training loss = 0.000418, test loss = 0.137430
  Training set accuracy = 1.000000, Test set accuracy = 0.967300
 epoch 15/30. Took 1.4224 seconds. 
  Full-batch training loss = 0.000370, test loss = 0.139736
  Training set accuracy = 1.000000, Test set accuracy = 0.967100
 epoch 16/30. Took 1.4428 seconds. 
  Full-batch training loss = 0.000329, test loss = 0.140708
  Training set accuracy = 1.000000, Test set accuracy = 0.967300
 epoch 17/30. Took 1.4235 seconds. 
  Full-batch training loss = 0.000301, test loss = 0.142022
  Training set accuracy = 1.000000, Test set accuracy = 0.967300
 epoch 18/30. Took 1.429 seconds. 
  Full-batch training loss = 0.000275, test loss = 0.142532
  Training set accuracy = 1.000000, Test set accuracy = 0.967500
 epoch 19/30. Took 1.4245 seconds. 
  Full-batch training loss = 0.000251, test loss = 0.144409
  Training set accuracy = 1.000000, Test set accuracy = 0.967100
 epoch 20/30. Took 1.4169 seconds. 
  Full-batch training loss = 0.000234, test loss = 0.144621
  Training set accuracy = 1.000000, Test set accuracy = 0.968000
 epoch 21/30. Took 1.4225 seconds. 
  Full-batch training loss = 0.000219, test loss = 0.145310
  Training set accuracy = 1.000000, Test set accuracy = 0.968000
 epoch 22/30. Took 1.4191 seconds. 
  Full-batch training loss = 0.000206, test loss = 0.146401
  Training set accuracy = 1.000000, Test set accuracy = 0.967700
 epoch 23/30. Took 1.4828 seconds. 
  Full-batch training loss = 0.000194, test loss = 0.147877
  Training set accuracy = 1.000000, Test set accuracy = 0.967300
 epoch 24/30. Took 1.4366 seconds. 
  Full-batch training loss = 0.000184, test loss = 0.148550
  Training set accuracy = 1.000000, Test set accuracy = 0.967800
 epoch 25/30. Took 1.4125 seconds. 
  Full-batch training loss = 0.000174, test loss = 0.148904
  Training set accuracy = 1.000000, Test set accuracy = 0.967300
 epoch 26/30. Took 1.4553 seconds. 
  Full-batch training loss = 0.000166, test loss = 0.149655
  Training set accuracy = 1.000000, Test set accuracy = 0.967600
 epoch 27/30. Took 1.4269 seconds. 
  Full-batch training loss = 0.000158, test loss = 0.150792
  Training set accuracy = 1.000000, Test set accuracy = 0.967300
 epoch 28/30. Took 1.4259 seconds. 
  Full-batch training loss = 0.000151, test loss = 0.150884
  Training set accuracy = 1.000000, Test set accuracy = 0.967800
 epoch 29/30. Took 1.4249 seconds. 
  Full-batch training loss = 0.000144, test loss = 0.152011
  Training set accuracy = 1.000000, Test set accuracy = 0.967300
 epoch 30/30. Took 1.4241 seconds. 
  Full-batch training loss = 0.000139, test loss = 0.152873
  Training set accuracy = 1.000000, Test set accuracy = 0.967200
Elapsed time is 75.534357 seconds.
End Training
-----
Params 10000 0.100 0.10 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23687 seconds. 
  Full-batch training loss = 0.327832, test loss = 0.321267
  Training set accuracy = 0.907500, Test set accuracy = 0.907400
 epoch 2/30. Took 0.23119 seconds. 
  Full-batch training loss = 0.234612, test loss = 0.255466
  Training set accuracy = 0.930600, Test set accuracy = 0.923100
 epoch 3/30. Took 0.22597 seconds. 
  Full-batch training loss = 0.190476, test loss = 0.224055
  Training set accuracy = 0.947400, Test set accuracy = 0.933900
 epoch 4/30. Took 0.227 seconds. 
  Full-batch training loss = 0.145408, test loss = 0.191234
  Training set accuracy = 0.962000, Test set accuracy = 0.942300
 epoch 5/30. Took 0.23355 seconds. 
  Full-batch training loss = 0.125123, test loss = 0.181459
  Training set accuracy = 0.964200, Test set accuracy = 0.943600
 epoch 6/30. Took 0.23368 seconds. 
  Full-batch training loss = 0.102643, test loss = 0.166789
  Training set accuracy = 0.973000, Test set accuracy = 0.949000
 epoch 7/30. Took 0.23152 seconds. 
  Full-batch training loss = 0.092467, test loss = 0.168668
  Training set accuracy = 0.974400, Test set accuracy = 0.946100
 epoch 8/30. Took 0.22995 seconds. 
  Full-batch training loss = 0.072919, test loss = 0.153514
  Training set accuracy = 0.980500, Test set accuracy = 0.952400
 epoch 9/30. Took 0.22586 seconds. 
  Full-batch training loss = 0.070086, test loss = 0.154884
  Training set accuracy = 0.981000, Test set accuracy = 0.951100
 epoch 10/30. Took 0.23266 seconds. 
  Full-batch training loss = 0.059436, test loss = 0.150707
  Training set accuracy = 0.984300, Test set accuracy = 0.952500
 epoch 11/30. Took 0.2336 seconds. 
  Full-batch training loss = 0.054494, test loss = 0.150943
  Training set accuracy = 0.986500, Test set accuracy = 0.953800
 epoch 12/30. Took 0.22527 seconds. 
  Full-batch training loss = 0.039673, test loss = 0.142292
  Training set accuracy = 0.991000, Test set accuracy = 0.957300
 epoch 13/30. Took 0.23592 seconds. 
  Full-batch training loss = 0.034444, test loss = 0.139595
  Training set accuracy = 0.993800, Test set accuracy = 0.956200
 epoch 14/30. Took 0.24473 seconds. 
  Full-batch training loss = 0.031592, test loss = 0.136365
  Training set accuracy = 0.994200, Test set accuracy = 0.959200
 epoch 15/30. Took 0.25864 seconds. 
  Full-batch training loss = 0.025580, test loss = 0.136837
  Training set accuracy = 0.996100, Test set accuracy = 0.958200
 epoch 16/30. Took 0.22845 seconds. 
  Full-batch training loss = 0.024797, test loss = 0.132998
  Training set accuracy = 0.996900, Test set accuracy = 0.959400
 epoch 17/30. Took 0.22694 seconds. 
  Full-batch training loss = 0.022745, test loss = 0.139619
  Training set accuracy = 0.996800, Test set accuracy = 0.959900
 epoch 18/30. Took 0.22929 seconds. 
  Full-batch training loss = 0.018625, test loss = 0.130697
  Training set accuracy = 0.997600, Test set accuracy = 0.961900
 epoch 19/30. Took 0.23136 seconds. 
  Full-batch training loss = 0.017906, test loss = 0.139266
  Training set accuracy = 0.997300, Test set accuracy = 0.959500
 epoch 20/30. Took 0.23111 seconds. 
  Full-batch training loss = 0.015081, test loss = 0.132051
  Training set accuracy = 0.998700, Test set accuracy = 0.961900
 epoch 21/30. Took 0.24086 seconds. 
  Full-batch training loss = 0.012693, test loss = 0.130951
  Training set accuracy = 0.999400, Test set accuracy = 0.961900
 epoch 22/30. Took 0.23164 seconds. 
  Full-batch training loss = 0.011545, test loss = 0.136009
  Training set accuracy = 0.999300, Test set accuracy = 0.959600
 epoch 23/30. Took 0.22861 seconds. 
  Full-batch training loss = 0.011860, test loss = 0.138906
  Training set accuracy = 0.999100, Test set accuracy = 0.960700
 epoch 24/30. Took 0.24214 seconds. 
  Full-batch training loss = 0.009841, test loss = 0.133490
  Training set accuracy = 0.999700, Test set accuracy = 0.962800
 epoch 25/30. Took 0.24108 seconds. 
  Full-batch training loss = 0.010396, test loss = 0.142819
  Training set accuracy = 0.999300, Test set accuracy = 0.959400
 epoch 26/30. Took 0.22878 seconds. 
  Full-batch training loss = 0.007845, test loss = 0.130617
  Training set accuracy = 0.999900, Test set accuracy = 0.962900
 epoch 27/30. Took 0.23835 seconds. 
  Full-batch training loss = 0.008561, test loss = 0.140486
  Training set accuracy = 0.999600, Test set accuracy = 0.960900
 epoch 28/30. Took 0.23312 seconds. 
  Full-batch training loss = 0.008301, test loss = 0.143695
  Training set accuracy = 0.999500, Test set accuracy = 0.960800
 epoch 29/30. Took 0.23233 seconds. 
  Full-batch training loss = 0.007241, test loss = 0.133892
  Training set accuracy = 0.999600, Test set accuracy = 0.962400
 epoch 30/30. Took 0.23433 seconds. 
  Full-batch training loss = 0.006604, test loss = 0.134473
  Training set accuracy = 0.999900, Test set accuracy = 0.962300
Elapsed time is 13.405023 seconds.
End Training
-----
Params 10000 0.100 0.10 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.40418 seconds. 
  Full-batch training loss = 0.311590, test loss = 0.343811
  Training set accuracy = 0.908700, Test set accuracy = 0.901700
 epoch 2/30. Took 0.38489 seconds. 
  Full-batch training loss = 0.235735, test loss = 0.279794
  Training set accuracy = 0.926900, Test set accuracy = 0.914400
 epoch 3/30. Took 0.35909 seconds. 
  Full-batch training loss = 0.157393, test loss = 0.215028
  Training set accuracy = 0.958000, Test set accuracy = 0.935800
 epoch 4/30. Took 0.35493 seconds. 
  Full-batch training loss = 0.127944, test loss = 0.191846
  Training set accuracy = 0.963300, Test set accuracy = 0.941700
 epoch 5/30. Took 0.35236 seconds. 
  Full-batch training loss = 0.107044, test loss = 0.179970
  Training set accuracy = 0.971200, Test set accuracy = 0.946300
 epoch 6/30. Took 0.36516 seconds. 
  Full-batch training loss = 0.087112, test loss = 0.169421
  Training set accuracy = 0.976700, Test set accuracy = 0.947100
 epoch 7/30. Took 0.35087 seconds. 
  Full-batch training loss = 0.069817, test loss = 0.154865
  Training set accuracy = 0.984000, Test set accuracy = 0.951100
 epoch 8/30. Took 0.35475 seconds. 
  Full-batch training loss = 0.058459, test loss = 0.153375
  Training set accuracy = 0.986800, Test set accuracy = 0.952300
 epoch 9/30. Took 0.35347 seconds. 
  Full-batch training loss = 0.049137, test loss = 0.143583
  Training set accuracy = 0.989400, Test set accuracy = 0.952800
 epoch 10/30. Took 0.35484 seconds. 
  Full-batch training loss = 0.043245, test loss = 0.148266
  Training set accuracy = 0.990700, Test set accuracy = 0.955500
 epoch 11/30. Took 0.35215 seconds. 
  Full-batch training loss = 0.036363, test loss = 0.144309
  Training set accuracy = 0.993700, Test set accuracy = 0.954600
 epoch 12/30. Took 0.35349 seconds. 
  Full-batch training loss = 0.029107, test loss = 0.137934
  Training set accuracy = 0.996000, Test set accuracy = 0.957700
 epoch 13/30. Took 0.34747 seconds. 
  Full-batch training loss = 0.025619, test loss = 0.139948
  Training set accuracy = 0.997100, Test set accuracy = 0.957000
 epoch 14/30. Took 0.35602 seconds. 
  Full-batch training loss = 0.020850, test loss = 0.135148
  Training set accuracy = 0.998100, Test set accuracy = 0.958700
 epoch 15/30. Took 0.35187 seconds. 
  Full-batch training loss = 0.019484, test loss = 0.135559
  Training set accuracy = 0.997800, Test set accuracy = 0.958000
 epoch 16/30. Took 0.35916 seconds. 
  Full-batch training loss = 0.016164, test loss = 0.133561
  Training set accuracy = 0.998900, Test set accuracy = 0.959200
 epoch 17/30. Took 0.35335 seconds. 
  Full-batch training loss = 0.013577, test loss = 0.130132
  Training set accuracy = 0.999100, Test set accuracy = 0.960600
 epoch 18/30. Took 0.35329 seconds. 
  Full-batch training loss = 0.013132, test loss = 0.137544
  Training set accuracy = 0.999600, Test set accuracy = 0.959500
 epoch 19/30. Took 0.35126 seconds. 
  Full-batch training loss = 0.011607, test loss = 0.135639
  Training set accuracy = 0.999500, Test set accuracy = 0.960100
 epoch 20/30. Took 0.35457 seconds. 
  Full-batch training loss = 0.010621, test loss = 0.134885
  Training set accuracy = 0.999700, Test set accuracy = 0.959400
 epoch 21/30. Took 0.347 seconds. 
  Full-batch training loss = 0.008683, test loss = 0.133220
  Training set accuracy = 0.999700, Test set accuracy = 0.960700
 epoch 22/30. Took 0.35575 seconds. 
  Full-batch training loss = 0.009240, test loss = 0.138867
  Training set accuracy = 0.999700, Test set accuracy = 0.957700
 epoch 23/30. Took 0.35276 seconds. 
  Full-batch training loss = 0.007224, test loss = 0.135602
  Training set accuracy = 0.999900, Test set accuracy = 0.959700
 epoch 24/30. Took 0.35495 seconds. 
  Full-batch training loss = 0.006695, test loss = 0.136174
  Training set accuracy = 1.000000, Test set accuracy = 0.959400
 epoch 25/30. Took 0.36143 seconds. 
  Full-batch training loss = 0.006306, test loss = 0.140536
  Training set accuracy = 1.000000, Test set accuracy = 0.959900
 epoch 26/30. Took 0.35454 seconds. 
  Full-batch training loss = 0.006010, test loss = 0.144098
  Training set accuracy = 0.999600, Test set accuracy = 0.959500
 epoch 27/30. Took 0.3523 seconds. 
  Full-batch training loss = 0.005219, test loss = 0.138490
  Training set accuracy = 1.000000, Test set accuracy = 0.961000
 epoch 28/30. Took 0.35612 seconds. 
  Full-batch training loss = 0.004652, test loss = 0.136483
  Training set accuracy = 1.000000, Test set accuracy = 0.961200
 epoch 29/30. Took 0.35025 seconds. 
  Full-batch training loss = 0.004467, test loss = 0.139190
  Training set accuracy = 1.000000, Test set accuracy = 0.960900
 epoch 30/30. Took 0.37649 seconds. 
  Full-batch training loss = 0.003917, test loss = 0.136463
  Training set accuracy = 1.000000, Test set accuracy = 0.961200
Elapsed time is 19.384145 seconds.
End Training
-----
Params 10000 0.100 0.10 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.76487 seconds. 
  Full-batch training loss = 0.297512, test loss = 0.319446
  Training set accuracy = 0.917200, Test set accuracy = 0.905600
 epoch 2/30. Took 0.73046 seconds. 
  Full-batch training loss = 0.219540, test loss = 0.255899
  Training set accuracy = 0.936100, Test set accuracy = 0.926000
 epoch 3/30. Took 0.73294 seconds. 
  Full-batch training loss = 0.164823, test loss = 0.216396
  Training set accuracy = 0.954200, Test set accuracy = 0.935400
 epoch 4/30. Took 0.74325 seconds. 
  Full-batch training loss = 0.129168, test loss = 0.189627
  Training set accuracy = 0.964500, Test set accuracy = 0.944800
 epoch 5/30. Took 0.73172 seconds. 
  Full-batch training loss = 0.108352, test loss = 0.182534
  Training set accuracy = 0.970100, Test set accuracy = 0.945400
 epoch 6/30. Took 0.73467 seconds. 
  Full-batch training loss = 0.073308, test loss = 0.149240
  Training set accuracy = 0.984100, Test set accuracy = 0.953700
 epoch 7/30. Took 0.73453 seconds. 
  Full-batch training loss = 0.065984, test loss = 0.150557
  Training set accuracy = 0.984800, Test set accuracy = 0.951500
 epoch 8/30. Took 0.73761 seconds. 
  Full-batch training loss = 0.055823, test loss = 0.145652
  Training set accuracy = 0.986700, Test set accuracy = 0.955200
 epoch 9/30. Took 0.73461 seconds. 
  Full-batch training loss = 0.041853, test loss = 0.138057
  Training set accuracy = 0.993000, Test set accuracy = 0.958300
 epoch 10/30. Took 0.7514 seconds. 
  Full-batch training loss = 0.034544, test loss = 0.137023
  Training set accuracy = 0.994300, Test set accuracy = 0.958600
 epoch 11/30. Took 0.80823 seconds. 
  Full-batch training loss = 0.027284, test loss = 0.131754
  Training set accuracy = 0.996900, Test set accuracy = 0.959600
 epoch 12/30. Took 0.73921 seconds. 
  Full-batch training loss = 0.023570, test loss = 0.131022
  Training set accuracy = 0.997600, Test set accuracy = 0.958000
 epoch 13/30. Took 0.74249 seconds. 
  Full-batch training loss = 0.018706, test loss = 0.125061
  Training set accuracy = 0.998800, Test set accuracy = 0.961500
 epoch 14/30. Took 0.75779 seconds. 
  Full-batch training loss = 0.017681, test loss = 0.129400
  Training set accuracy = 0.998700, Test set accuracy = 0.961100
 epoch 15/30. Took 0.78301 seconds. 
  Full-batch training loss = 0.014309, test loss = 0.124141
  Training set accuracy = 0.999500, Test set accuracy = 0.961800
 epoch 16/30. Took 0.74483 seconds. 
  Full-batch training loss = 0.013507, test loss = 0.128314
  Training set accuracy = 0.998900, Test set accuracy = 0.962000
 epoch 17/30. Took 0.73674 seconds. 
  Full-batch training loss = 0.010759, test loss = 0.127602
  Training set accuracy = 0.999700, Test set accuracy = 0.962500
 epoch 18/30. Took 0.73543 seconds. 
  Full-batch training loss = 0.009938, test loss = 0.127144
  Training set accuracy = 0.999700, Test set accuracy = 0.963000
 epoch 19/30. Took 0.75419 seconds. 
  Full-batch training loss = 0.008339, test loss = 0.126222
  Training set accuracy = 0.999800, Test set accuracy = 0.963200
 epoch 20/30. Took 0.73355 seconds. 
  Full-batch training loss = 0.008027, test loss = 0.129595
  Training set accuracy = 0.999900, Test set accuracy = 0.962300
 epoch 21/30. Took 0.75679 seconds. 
  Full-batch training loss = 0.006948, test loss = 0.126947
  Training set accuracy = 0.999900, Test set accuracy = 0.962600
 epoch 22/30. Took 0.73906 seconds. 
  Full-batch training loss = 0.006481, test loss = 0.127711
  Training set accuracy = 1.000000, Test set accuracy = 0.962900
 epoch 23/30. Took 0.76357 seconds. 
  Full-batch training loss = 0.005722, test loss = 0.127502
  Training set accuracy = 0.999900, Test set accuracy = 0.963200
 epoch 24/30. Took 0.73739 seconds. 
  Full-batch training loss = 0.005326, test loss = 0.126326
  Training set accuracy = 0.999900, Test set accuracy = 0.965100
 epoch 25/30. Took 0.73045 seconds. 
  Full-batch training loss = 0.005392, test loss = 0.128073
  Training set accuracy = 0.999900, Test set accuracy = 0.963400
 epoch 26/30. Took 0.73459 seconds. 
  Full-batch training loss = 0.004509, test loss = 0.127298
  Training set accuracy = 0.999900, Test set accuracy = 0.964400
 epoch 27/30. Took 0.72968 seconds. 
  Full-batch training loss = 0.004247, test loss = 0.127421
  Training set accuracy = 0.999900, Test set accuracy = 0.964300
 epoch 28/30. Took 0.73973 seconds. 
  Full-batch training loss = 0.004290, test loss = 0.130060
  Training set accuracy = 1.000000, Test set accuracy = 0.963600
 epoch 29/30. Took 0.76665 seconds. 
  Full-batch training loss = 0.003590, test loss = 0.128468
  Training set accuracy = 1.000000, Test set accuracy = 0.964500
 epoch 30/30. Took 0.73035 seconds. 
  Full-batch training loss = 0.003467, test loss = 0.128507
  Training set accuracy = 1.000000, Test set accuracy = 0.963200
Elapsed time is 38.754307 seconds.
End Training
-----
Params 10000 0.100 0.10 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27379 seconds. 
  Full-batch training loss = 0.304520, test loss = 0.322757
  Training set accuracy = 0.906700, Test set accuracy = 0.900500
 epoch 2/30. Took 0.26983 seconds. 
  Full-batch training loss = 0.218774, test loss = 0.247871
  Training set accuracy = 0.933400, Test set accuracy = 0.921400
 epoch 3/30. Took 0.2833 seconds. 
  Full-batch training loss = 0.151877, test loss = 0.209500
  Training set accuracy = 0.952800, Test set accuracy = 0.936100
 epoch 4/30. Took 0.28937 seconds. 
  Full-batch training loss = 0.106701, test loss = 0.179813
  Training set accuracy = 0.967500, Test set accuracy = 0.945700
 epoch 5/30. Took 0.27543 seconds. 
  Full-batch training loss = 0.074301, test loss = 0.157280
  Training set accuracy = 0.977600, Test set accuracy = 0.951800
 epoch 6/30. Took 0.28295 seconds. 
  Full-batch training loss = 0.066539, test loss = 0.156458
  Training set accuracy = 0.979700, Test set accuracy = 0.952600
 epoch 7/30. Took 0.2993 seconds. 
  Full-batch training loss = 0.054774, test loss = 0.163127
  Training set accuracy = 0.983700, Test set accuracy = 0.951100
 epoch 8/30. Took 0.28391 seconds. 
  Full-batch training loss = 0.043965, test loss = 0.157628
  Training set accuracy = 0.987400, Test set accuracy = 0.954400
 epoch 9/30. Took 0.28461 seconds. 
  Full-batch training loss = 0.037528, test loss = 0.159842
  Training set accuracy = 0.988800, Test set accuracy = 0.956800
 epoch 10/30. Took 0.28402 seconds. 
  Full-batch training loss = 0.029321, test loss = 0.148635
  Training set accuracy = 0.992700, Test set accuracy = 0.958100
 epoch 11/30. Took 0.28475 seconds. 
  Full-batch training loss = 0.024943, test loss = 0.152345
  Training set accuracy = 0.994600, Test set accuracy = 0.957500
 epoch 12/30. Took 0.28219 seconds. 
  Full-batch training loss = 0.023712, test loss = 0.164572
  Training set accuracy = 0.993600, Test set accuracy = 0.956400
 epoch 13/30. Took 0.2759 seconds. 
  Full-batch training loss = 0.022425, test loss = 0.159591
  Training set accuracy = 0.994700, Test set accuracy = 0.956500
 epoch 14/30. Took 0.27792 seconds. 
  Full-batch training loss = 0.014010, test loss = 0.152545
  Training set accuracy = 0.996800, Test set accuracy = 0.960000
 epoch 15/30. Took 0.27001 seconds. 
  Full-batch training loss = 0.012148, test loss = 0.145909
  Training set accuracy = 0.997400, Test set accuracy = 0.962400
 epoch 16/30. Took 0.26992 seconds. 
  Full-batch training loss = 0.014414, test loss = 0.168514
  Training set accuracy = 0.995700, Test set accuracy = 0.957400
 epoch 17/30. Took 0.27976 seconds. 
  Full-batch training loss = 0.008769, test loss = 0.158361
  Training set accuracy = 0.998900, Test set accuracy = 0.959100
 epoch 18/30. Took 0.28384 seconds. 
  Full-batch training loss = 0.009543, test loss = 0.157968
  Training set accuracy = 0.997900, Test set accuracy = 0.960500
 epoch 19/30. Took 0.28496 seconds. 
  Full-batch training loss = 0.010910, test loss = 0.159046
  Training set accuracy = 0.997300, Test set accuracy = 0.960100
 epoch 20/30. Took 0.2816 seconds. 
  Full-batch training loss = 0.004498, test loss = 0.159695
  Training set accuracy = 0.999700, Test set accuracy = 0.960200
 epoch 21/30. Took 0.28261 seconds. 
  Full-batch training loss = 0.008246, test loss = 0.177210
  Training set accuracy = 0.998100, Test set accuracy = 0.957500
 epoch 22/30. Took 0.28386 seconds. 
  Full-batch training loss = 0.005651, test loss = 0.159944
  Training set accuracy = 0.999200, Test set accuracy = 0.961100
 epoch 23/30. Took 0.28522 seconds. 
  Full-batch training loss = 0.005018, test loss = 0.161094
  Training set accuracy = 0.999100, Test set accuracy = 0.962000
 epoch 24/30. Took 0.28416 seconds. 
  Full-batch training loss = 0.005001, test loss = 0.168259
  Training set accuracy = 0.999200, Test set accuracy = 0.960600
 epoch 25/30. Took 0.28497 seconds. 
  Full-batch training loss = 0.002671, test loss = 0.164724
  Training set accuracy = 0.999800, Test set accuracy = 0.961800
 epoch 26/30. Took 0.2761 seconds. 
  Full-batch training loss = 0.002299, test loss = 0.170264
  Training set accuracy = 0.999900, Test set accuracy = 0.962600
 epoch 27/30. Took 0.2839 seconds. 
  Full-batch training loss = 0.003988, test loss = 0.167875
  Training set accuracy = 0.999400, Test set accuracy = 0.960600
 epoch 28/30. Took 0.27077 seconds. 
  Full-batch training loss = 0.003086, test loss = 0.177516
  Training set accuracy = 0.999700, Test set accuracy = 0.960700
 epoch 29/30. Took 0.27569 seconds. 
  Full-batch training loss = 0.002620, test loss = 0.165871
  Training set accuracy = 0.999600, Test set accuracy = 0.962600
 epoch 30/30. Took 0.28621 seconds. 
  Full-batch training loss = 0.002672, test loss = 0.183621
  Training set accuracy = 0.999700, Test set accuracy = 0.960000
Elapsed time is 15.652902 seconds.
End Training
-----
Params 10000 0.100 0.10 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.4784 seconds. 
  Full-batch training loss = 0.279880, test loss = 0.302525
  Training set accuracy = 0.915000, Test set accuracy = 0.907000
 epoch 2/30. Took 0.46317 seconds. 
  Full-batch training loss = 0.179683, test loss = 0.226963
  Training set accuracy = 0.943800, Test set accuracy = 0.929100
 epoch 3/30. Took 0.4885 seconds. 
  Full-batch training loss = 0.125207, test loss = 0.180339
  Training set accuracy = 0.962500, Test set accuracy = 0.942900
 epoch 4/30. Took 0.47412 seconds. 
  Full-batch training loss = 0.102929, test loss = 0.179570
  Training set accuracy = 0.969700, Test set accuracy = 0.943200
 epoch 5/30. Took 0.47145 seconds. 
  Full-batch training loss = 0.071095, test loss = 0.157283
  Training set accuracy = 0.979400, Test set accuracy = 0.952200
 epoch 6/30. Took 0.46368 seconds. 
  Full-batch training loss = 0.052812, test loss = 0.150058
  Training set accuracy = 0.984600, Test set accuracy = 0.955400
 epoch 7/30. Took 0.47635 seconds. 
  Full-batch training loss = 0.051539, test loss = 0.153913
  Training set accuracy = 0.984900, Test set accuracy = 0.952500
 epoch 8/30. Took 0.47808 seconds. 
  Full-batch training loss = 0.025118, test loss = 0.129939
  Training set accuracy = 0.995000, Test set accuracy = 0.961600
 epoch 9/30. Took 0.47281 seconds. 
  Full-batch training loss = 0.024669, test loss = 0.137953
  Training set accuracy = 0.995000, Test set accuracy = 0.959400
 epoch 10/30. Took 0.48374 seconds. 
  Full-batch training loss = 0.023230, test loss = 0.148357
  Training set accuracy = 0.994700, Test set accuracy = 0.957900
 epoch 11/30. Took 0.46546 seconds. 
  Full-batch training loss = 0.017303, test loss = 0.145788
  Training set accuracy = 0.995700, Test set accuracy = 0.959600
 epoch 12/30. Took 0.48937 seconds. 
  Full-batch training loss = 0.010597, test loss = 0.138572
  Training set accuracy = 0.998200, Test set accuracy = 0.964000
 epoch 13/30. Took 0.47284 seconds. 
  Full-batch training loss = 0.009985, test loss = 0.140524
  Training set accuracy = 0.998400, Test set accuracy = 0.961900
 epoch 14/30. Took 0.47378 seconds. 
  Full-batch training loss = 0.006664, test loss = 0.141800
  Training set accuracy = 0.999500, Test set accuracy = 0.963400
 epoch 15/30. Took 0.50842 seconds. 
  Full-batch training loss = 0.011262, test loss = 0.155027
  Training set accuracy = 0.997800, Test set accuracy = 0.959500
 epoch 16/30. Took 0.48181 seconds. 
  Full-batch training loss = 0.006318, test loss = 0.147610
  Training set accuracy = 0.999100, Test set accuracy = 0.959500
 epoch 17/30. Took 0.48098 seconds. 
  Full-batch training loss = 0.003445, test loss = 0.146707
  Training set accuracy = 0.999600, Test set accuracy = 0.964200
 epoch 18/30. Took 0.47394 seconds. 
  Full-batch training loss = 0.002764, test loss = 0.147216
  Training set accuracy = 0.999800, Test set accuracy = 0.963800
 epoch 19/30. Took 0.47553 seconds. 
  Full-batch training loss = 0.003500, test loss = 0.149006
  Training set accuracy = 0.999500, Test set accuracy = 0.963200
 epoch 20/30. Took 0.47702 seconds. 
  Full-batch training loss = 0.001822, test loss = 0.140877
  Training set accuracy = 0.999900, Test set accuracy = 0.966800
 epoch 21/30. Took 0.47584 seconds. 
  Full-batch training loss = 0.004052, test loss = 0.158405
  Training set accuracy = 0.999500, Test set accuracy = 0.961200
 epoch 22/30. Took 0.48197 seconds. 
  Full-batch training loss = 0.002433, test loss = 0.151134
  Training set accuracy = 0.999700, Test set accuracy = 0.964400
 epoch 23/30. Took 0.51837 seconds. 
  Full-batch training loss = 0.003069, test loss = 0.150364
  Training set accuracy = 0.999800, Test set accuracy = 0.962600
 epoch 24/30. Took 0.48247 seconds. 
  Full-batch training loss = 0.003315, test loss = 0.154917
  Training set accuracy = 0.999600, Test set accuracy = 0.963900
 epoch 25/30. Took 0.47415 seconds. 
  Full-batch training loss = 0.002710, test loss = 0.149295
  Training set accuracy = 0.999700, Test set accuracy = 0.965200
 epoch 26/30. Took 0.47536 seconds. 
  Full-batch training loss = 0.001295, test loss = 0.144511
  Training set accuracy = 1.000000, Test set accuracy = 0.965500
 epoch 27/30. Took 0.47489 seconds. 
  Full-batch training loss = 0.000994, test loss = 0.149170
  Training set accuracy = 1.000000, Test set accuracy = 0.965700
 epoch 28/30. Took 0.47469 seconds. 
  Full-batch training loss = 0.001100, test loss = 0.154671
  Training set accuracy = 0.999900, Test set accuracy = 0.967500
 epoch 29/30. Took 0.49084 seconds. 
  Full-batch training loss = 0.001259, test loss = 0.160978
  Training set accuracy = 0.999900, Test set accuracy = 0.965800
 epoch 30/30. Took 0.4768 seconds. 
  Full-batch training loss = 0.001033, test loss = 0.150565
  Training set accuracy = 1.000000, Test set accuracy = 0.967300
Elapsed time is 25.215855 seconds.
End Training
-----
Params 10000 0.100 0.10 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2573 seconds. 
  Full-batch training loss = 0.254512, test loss = 0.275961
  Training set accuracy = 0.926800, Test set accuracy = 0.920000
 epoch 2/30. Took 1.2069 seconds. 
  Full-batch training loss = 0.147522, test loss = 0.195360
  Training set accuracy = 0.959500, Test set accuracy = 0.941800
 epoch 3/30. Took 1.267 seconds. 
  Full-batch training loss = 0.117897, test loss = 0.185518
  Training set accuracy = 0.966700, Test set accuracy = 0.942300
 epoch 4/30. Took 1.207 seconds. 
  Full-batch training loss = 0.098481, test loss = 0.184194
  Training set accuracy = 0.971500, Test set accuracy = 0.942800
 epoch 5/30. Took 1.2201 seconds. 
  Full-batch training loss = 0.057099, test loss = 0.141485
  Training set accuracy = 0.984900, Test set accuracy = 0.956300
 epoch 6/30. Took 1.1985 seconds. 
  Full-batch training loss = 0.046274, test loss = 0.140170
  Training set accuracy = 0.987100, Test set accuracy = 0.954200
 epoch 7/30. Took 1.2462 seconds. 
  Full-batch training loss = 0.033567, test loss = 0.140726
  Training set accuracy = 0.991800, Test set accuracy = 0.955900
 epoch 8/30. Took 1.224 seconds. 
  Full-batch training loss = 0.022381, test loss = 0.132001
  Training set accuracy = 0.994600, Test set accuracy = 0.960900
 epoch 9/30. Took 1.2562 seconds. 
  Full-batch training loss = 0.020579, test loss = 0.143094
  Training set accuracy = 0.995400, Test set accuracy = 0.958700
 epoch 10/30. Took 1.2252 seconds. 
  Full-batch training loss = 0.008893, test loss = 0.132501
  Training set accuracy = 0.999400, Test set accuracy = 0.961900
 epoch 11/30. Took 1.2006 seconds. 
  Full-batch training loss = 0.009544, test loss = 0.138611
  Training set accuracy = 0.998500, Test set accuracy = 0.961500
 epoch 12/30. Took 1.261 seconds. 
  Full-batch training loss = 0.003825, test loss = 0.127812
  Training set accuracy = 1.000000, Test set accuracy = 0.963700
 epoch 13/30. Took 1.2013 seconds. 
  Full-batch training loss = 0.004433, test loss = 0.135548
  Training set accuracy = 0.999800, Test set accuracy = 0.962400
 epoch 14/30. Took 1.2116 seconds. 
  Full-batch training loss = 0.002761, test loss = 0.133021
  Training set accuracy = 0.999900, Test set accuracy = 0.963200
 epoch 15/30. Took 1.2112 seconds. 
  Full-batch training loss = 0.003692, test loss = 0.145771
  Training set accuracy = 0.999800, Test set accuracy = 0.962100
 epoch 16/30. Took 1.2784 seconds. 
  Full-batch training loss = 0.004055, test loss = 0.146001
  Training set accuracy = 0.999800, Test set accuracy = 0.962800
 epoch 17/30. Took 1.2027 seconds. 
  Full-batch training loss = 0.001822, test loss = 0.129139
  Training set accuracy = 1.000000, Test set accuracy = 0.965500
 epoch 18/30. Took 1.2016 seconds. 
  Full-batch training loss = 0.001249, test loss = 0.133558
  Training set accuracy = 1.000000, Test set accuracy = 0.963800
 epoch 19/30. Took 1.2183 seconds. 
  Full-batch training loss = 0.002000, test loss = 0.140068
  Training set accuracy = 0.999800, Test set accuracy = 0.963600
 epoch 20/30. Took 1.2438 seconds. 
  Full-batch training loss = 0.001461, test loss = 0.142966
  Training set accuracy = 1.000000, Test set accuracy = 0.962400
 epoch 21/30. Took 1.2013 seconds. 
  Full-batch training loss = 0.000866, test loss = 0.137170
  Training set accuracy = 1.000000, Test set accuracy = 0.965800
 epoch 22/30. Took 1.2134 seconds. 
  Full-batch training loss = 0.001538, test loss = 0.139713
  Training set accuracy = 1.000000, Test set accuracy = 0.964900
 epoch 23/30. Took 1.2141 seconds. 
  Full-batch training loss = 0.000704, test loss = 0.134382
  Training set accuracy = 1.000000, Test set accuracy = 0.966100
 epoch 24/30. Took 1.2054 seconds. 
  Full-batch training loss = 0.000625, test loss = 0.137700
  Training set accuracy = 1.000000, Test set accuracy = 0.964500
 epoch 25/30. Took 1.2082 seconds. 
  Full-batch training loss = 0.000463, test loss = 0.139331
  Training set accuracy = 1.000000, Test set accuracy = 0.966000
 epoch 26/30. Took 1.2174 seconds. 
  Full-batch training loss = 0.000412, test loss = 0.141230
  Training set accuracy = 1.000000, Test set accuracy = 0.965100
 epoch 27/30. Took 1.2645 seconds. 
  Full-batch training loss = 0.000393, test loss = 0.140244
  Training set accuracy = 1.000000, Test set accuracy = 0.965700
 epoch 28/30. Took 1.2263 seconds. 
  Full-batch training loss = 0.000410, test loss = 0.145999
  Training set accuracy = 1.000000, Test set accuracy = 0.964900
 epoch 29/30. Took 1.2054 seconds. 
  Full-batch training loss = 0.000435, test loss = 0.141248
  Training set accuracy = 1.000000, Test set accuracy = 0.965200
 epoch 30/30. Took 1.2032 seconds. 
  Full-batch training loss = 0.000754, test loss = 0.150943
  Training set accuracy = 0.999900, Test set accuracy = 0.962900
Elapsed time is 62.718840 seconds.
End Training
-----
Params 10000 0.100 0.10 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.34738 seconds. 
  Full-batch training loss = 0.322888, test loss = 0.321671
  Training set accuracy = 0.903300, Test set accuracy = 0.901000
 epoch 2/30. Took 0.3468 seconds. 
  Full-batch training loss = 0.189206, test loss = 0.212903
  Training set accuracy = 0.943900, Test set accuracy = 0.935200
 epoch 3/30. Took 0.35368 seconds. 
  Full-batch training loss = 0.138480, test loss = 0.190195
  Training set accuracy = 0.956600, Test set accuracy = 0.939400
 epoch 4/30. Took 0.33615 seconds. 
  Full-batch training loss = 0.113214, test loss = 0.175100
  Training set accuracy = 0.964400, Test set accuracy = 0.945600
 epoch 5/30. Took 0.33297 seconds. 
  Full-batch training loss = 0.103282, test loss = 0.188980
  Training set accuracy = 0.966700, Test set accuracy = 0.940700
 epoch 6/30. Took 0.35375 seconds. 
  Full-batch training loss = 0.066391, test loss = 0.154324
  Training set accuracy = 0.979800, Test set accuracy = 0.951100
 epoch 7/30. Took 0.33613 seconds. 
  Full-batch training loss = 0.058112, test loss = 0.159700
  Training set accuracy = 0.982600, Test set accuracy = 0.951300
 epoch 8/30. Took 0.33601 seconds. 
  Full-batch training loss = 0.051657, test loss = 0.167000
  Training set accuracy = 0.983600, Test set accuracy = 0.949600
 epoch 9/30. Took 0.33544 seconds. 
  Full-batch training loss = 0.032539, test loss = 0.143107
  Training set accuracy = 0.991400, Test set accuracy = 0.958500
 epoch 10/30. Took 0.33657 seconds. 
  Full-batch training loss = 0.027513, test loss = 0.145788
  Training set accuracy = 0.991600, Test set accuracy = 0.957500
 epoch 11/30. Took 0.34597 seconds. 
  Full-batch training loss = 0.038975, test loss = 0.163368
  Training set accuracy = 0.985700, Test set accuracy = 0.953900
 epoch 12/30. Took 0.35095 seconds. 
  Full-batch training loss = 0.025006, test loss = 0.150502
  Training set accuracy = 0.993700, Test set accuracy = 0.954700
 epoch 13/30. Took 0.33351 seconds. 
  Full-batch training loss = 0.029454, test loss = 0.171528
  Training set accuracy = 0.991400, Test set accuracy = 0.954600
 epoch 14/30. Took 0.33582 seconds. 
  Full-batch training loss = 0.016908, test loss = 0.149263
  Training set accuracy = 0.994500, Test set accuracy = 0.958800
 epoch 15/30. Took 0.33729 seconds. 
  Full-batch training loss = 0.011915, test loss = 0.143684
  Training set accuracy = 0.997100, Test set accuracy = 0.960500
 epoch 16/30. Took 0.3373 seconds. 
  Full-batch training loss = 0.013522, test loss = 0.147977
  Training set accuracy = 0.996600, Test set accuracy = 0.962100
 epoch 17/30. Took 0.31991 seconds. 
  Full-batch training loss = 0.014411, test loss = 0.149362
  Training set accuracy = 0.996100, Test set accuracy = 0.959800
 epoch 18/30. Took 0.34567 seconds. 
  Full-batch training loss = 0.012946, test loss = 0.161664
  Training set accuracy = 0.996000, Test set accuracy = 0.961300
 epoch 19/30. Took 0.32332 seconds. 
  Full-batch training loss = 0.012514, test loss = 0.155380
  Training set accuracy = 0.996700, Test set accuracy = 0.961100
 epoch 20/30. Took 0.31432 seconds. 
  Full-batch training loss = 0.015037, test loss = 0.170739
  Training set accuracy = 0.995800, Test set accuracy = 0.959700
 epoch 21/30. Took 0.32434 seconds. 
  Full-batch training loss = 0.008645, test loss = 0.152083
  Training set accuracy = 0.997800, Test set accuracy = 0.961900
 epoch 22/30. Took 0.35626 seconds. 
  Full-batch training loss = 0.008505, test loss = 0.163069
  Training set accuracy = 0.997800, Test set accuracy = 0.960100
 epoch 23/30. Took 0.33591 seconds. 
  Full-batch training loss = 0.008989, test loss = 0.174513
  Training set accuracy = 0.997500, Test set accuracy = 0.960000
 epoch 24/30. Took 0.34363 seconds. 
  Full-batch training loss = 0.005214, test loss = 0.166883
  Training set accuracy = 0.998800, Test set accuracy = 0.963200
 epoch 25/30. Took 0.31914 seconds. 
  Full-batch training loss = 0.006571, test loss = 0.176458
  Training set accuracy = 0.998200, Test set accuracy = 0.959700
 epoch 26/30. Took 0.35578 seconds. 
  Full-batch training loss = 0.008229, test loss = 0.194852
  Training set accuracy = 0.998200, Test set accuracy = 0.959900
 epoch 27/30. Took 0.35438 seconds. 
  Full-batch training loss = 0.008789, test loss = 0.181793
  Training set accuracy = 0.997000, Test set accuracy = 0.958800
 epoch 28/30. Took 0.34337 seconds. 
  Full-batch training loss = 0.010046, test loss = 0.192719
  Training set accuracy = 0.996200, Test set accuracy = 0.959200
 epoch 29/30. Took 0.33511 seconds. 
  Full-batch training loss = 0.007288, test loss = 0.189636
  Training set accuracy = 0.997800, Test set accuracy = 0.959600
 epoch 30/30. Took 0.33597 seconds. 
  Full-batch training loss = 0.004595, test loss = 0.181675
  Training set accuracy = 0.998400, Test set accuracy = 0.962000
Elapsed time is 18.388216 seconds.
End Training
-----
Params 10000 0.100 0.10 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.57726 seconds. 
  Full-batch training loss = 0.290517, test loss = 0.301716
  Training set accuracy = 0.912700, Test set accuracy = 0.911000
 epoch 2/30. Took 0.57485 seconds. 
  Full-batch training loss = 0.186974, test loss = 0.219193
  Training set accuracy = 0.940900, Test set accuracy = 0.931100
 epoch 3/30. Took 0.55938 seconds. 
  Full-batch training loss = 0.132890, test loss = 0.183570
  Training set accuracy = 0.960400, Test set accuracy = 0.942400
 epoch 4/30. Took 0.56015 seconds. 
  Full-batch training loss = 0.108854, test loss = 0.185234
  Training set accuracy = 0.965700, Test set accuracy = 0.946300
 epoch 5/30. Took 0.58136 seconds. 
  Full-batch training loss = 0.063152, test loss = 0.153326
  Training set accuracy = 0.981900, Test set accuracy = 0.953700
 epoch 6/30. Took 0.57836 seconds. 
  Full-batch training loss = 0.057462, test loss = 0.141603
  Training set accuracy = 0.982600, Test set accuracy = 0.957400
 epoch 7/30. Took 0.57678 seconds. 
  Full-batch training loss = 0.035751, test loss = 0.138984
  Training set accuracy = 0.989700, Test set accuracy = 0.959500
 epoch 8/30. Took 0.58006 seconds. 
  Full-batch training loss = 0.039541, test loss = 0.155402
  Training set accuracy = 0.989100, Test set accuracy = 0.955100
 epoch 9/30. Took 0.60854 seconds. 
  Full-batch training loss = 0.024819, test loss = 0.145958
  Training set accuracy = 0.993100, Test set accuracy = 0.959000
 epoch 10/30. Took 0.57773 seconds. 
  Full-batch training loss = 0.018944, test loss = 0.142386
  Training set accuracy = 0.994700, Test set accuracy = 0.959700
 epoch 11/30. Took 0.57776 seconds. 
  Full-batch training loss = 0.019290, test loss = 0.137700
  Training set accuracy = 0.994600, Test set accuracy = 0.961000
 epoch 12/30. Took 0.57778 seconds. 
  Full-batch training loss = 0.019858, test loss = 0.170847
  Training set accuracy = 0.993100, Test set accuracy = 0.961100
 epoch 13/30. Took 0.60683 seconds. 
  Full-batch training loss = 0.011191, test loss = 0.144634
  Training set accuracy = 0.997300, Test set accuracy = 0.961900
 epoch 14/30. Took 0.58783 seconds. 
  Full-batch training loss = 0.009095, test loss = 0.151617
  Training set accuracy = 0.997600, Test set accuracy = 0.963000
 epoch 15/30. Took 0.57664 seconds. 
  Full-batch training loss = 0.007617, test loss = 0.158327
  Training set accuracy = 0.998000, Test set accuracy = 0.963700
 epoch 16/30. Took 0.55946 seconds. 
  Full-batch training loss = 0.005905, test loss = 0.145845
  Training set accuracy = 0.998900, Test set accuracy = 0.967100
 epoch 17/30. Took 0.55579 seconds. 
  Full-batch training loss = 0.004281, test loss = 0.155291
  Training set accuracy = 0.999200, Test set accuracy = 0.966400
 epoch 18/30. Took 0.63423 seconds. 
  Full-batch training loss = 0.013206, test loss = 0.197391
  Training set accuracy = 0.996100, Test set accuracy = 0.959300
 epoch 19/30. Took 0.57801 seconds. 
  Full-batch training loss = 0.008445, test loss = 0.176930
  Training set accuracy = 0.997600, Test set accuracy = 0.962200
 epoch 20/30. Took 0.55298 seconds. 
  Full-batch training loss = 0.003343, test loss = 0.149221
  Training set accuracy = 0.999500, Test set accuracy = 0.967900
 epoch 21/30. Took 0.58474 seconds. 
  Full-batch training loss = 0.005984, test loss = 0.164312
  Training set accuracy = 0.998200, Test set accuracy = 0.963400
 epoch 22/30. Took 0.58274 seconds. 
  Full-batch training loss = 0.001816, test loss = 0.158205
  Training set accuracy = 0.999900, Test set accuracy = 0.965500
 epoch 23/30. Took 0.57148 seconds. 
  Full-batch training loss = 0.004382, test loss = 0.170713
  Training set accuracy = 0.998900, Test set accuracy = 0.964800
 epoch 24/30. Took 0.55975 seconds. 
  Full-batch training loss = 0.007124, test loss = 0.181435
  Training set accuracy = 0.997300, Test set accuracy = 0.963000
 epoch 25/30. Took 0.56556 seconds. 
  Full-batch training loss = 0.000760, test loss = 0.155586
  Training set accuracy = 1.000000, Test set accuracy = 0.970400
 epoch 26/30. Took 0.56557 seconds. 
  Full-batch training loss = 0.001513, test loss = 0.177827
  Training set accuracy = 0.999700, Test set accuracy = 0.966600
 epoch 27/30. Took 0.60742 seconds. 
  Full-batch training loss = 0.005129, test loss = 0.190159
  Training set accuracy = 0.998300, Test set accuracy = 0.964300
 epoch 28/30. Took 0.56255 seconds. 
  Full-batch training loss = 0.010675, test loss = 0.198818
  Training set accuracy = 0.996800, Test set accuracy = 0.961000
 epoch 29/30. Took 0.57802 seconds. 
  Full-batch training loss = 0.010393, test loss = 0.203740
  Training set accuracy = 0.996700, Test set accuracy = 0.961400
 epoch 30/30. Took 0.57831 seconds. 
  Full-batch training loss = 0.004128, test loss = 0.193485
  Training set accuracy = 0.998800, Test set accuracy = 0.961300
Elapsed time is 30.660946 seconds.
End Training
-----
Params 10000 0.100 0.10 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.663 seconds. 
  Full-batch training loss = 0.257353, test loss = 0.272066
  Training set accuracy = 0.923300, Test set accuracy = 0.917000
 epoch 2/30. Took 1.659 seconds. 
  Full-batch training loss = 0.163144, test loss = 0.212003
  Training set accuracy = 0.948900, Test set accuracy = 0.932000
 epoch 3/30. Took 1.6692 seconds. 
  Full-batch training loss = 0.091051, test loss = 0.157000
  Training set accuracy = 0.973900, Test set accuracy = 0.951800
 epoch 4/30. Took 1.6675 seconds. 
  Full-batch training loss = 0.068501, test loss = 0.142815
  Training set accuracy = 0.978900, Test set accuracy = 0.955300
 epoch 5/30. Took 1.6712 seconds. 
  Full-batch training loss = 0.048990, test loss = 0.148393
  Training set accuracy = 0.986100, Test set accuracy = 0.955600
 epoch 6/30. Took 1.6828 seconds. 
  Full-batch training loss = 0.047208, test loss = 0.163433
  Training set accuracy = 0.986200, Test set accuracy = 0.952300
 epoch 7/30. Took 1.6672 seconds. 
  Full-batch training loss = 0.029649, test loss = 0.146921
  Training set accuracy = 0.992300, Test set accuracy = 0.959600
 epoch 8/30. Took 1.7033 seconds. 
  Full-batch training loss = 0.030810, test loss = 0.154826
  Training set accuracy = 0.990200, Test set accuracy = 0.957000
 epoch 9/30. Took 1.6863 seconds. 
  Full-batch training loss = 0.014544, test loss = 0.148402
  Training set accuracy = 0.996600, Test set accuracy = 0.959100
 epoch 10/30. Took 1.8276 seconds. 
  Full-batch training loss = 0.024508, test loss = 0.176296
  Training set accuracy = 0.992000, Test set accuracy = 0.955400
 epoch 11/30. Took 1.7352 seconds. 
  Full-batch training loss = 0.007137, test loss = 0.136860
  Training set accuracy = 0.998300, Test set accuracy = 0.965900
 epoch 12/30. Took 1.7152 seconds. 
  Full-batch training loss = 0.015064, test loss = 0.179360
  Training set accuracy = 0.994500, Test set accuracy = 0.955800
 epoch 13/30. Took 1.6929 seconds. 
  Full-batch training loss = 0.008942, test loss = 0.163549
  Training set accuracy = 0.997500, Test set accuracy = 0.961700
 epoch 14/30. Took 1.681 seconds. 
  Full-batch training loss = 0.009897, test loss = 0.164531
  Training set accuracy = 0.997200, Test set accuracy = 0.963400
 epoch 15/30. Took 1.6998 seconds. 
  Full-batch training loss = 0.007402, test loss = 0.165220
  Training set accuracy = 0.998100, Test set accuracy = 0.962600
 epoch 16/30. Took 1.6917 seconds. 
  Full-batch training loss = 0.002555, test loss = 0.153321
  Training set accuracy = 0.999700, Test set accuracy = 0.965500
 epoch 17/30. Took 1.6703 seconds. 
  Full-batch training loss = 0.016119, test loss = 0.210769
  Training set accuracy = 0.994200, Test set accuracy = 0.956300
 epoch 18/30. Took 1.6702 seconds. 
  Full-batch training loss = 0.001702, test loss = 0.159830
  Training set accuracy = 0.999700, Test set accuracy = 0.965200
 epoch 19/30. Took 1.6612 seconds. 
  Full-batch training loss = 0.001930, test loss = 0.163418
  Training set accuracy = 0.999500, Test set accuracy = 0.965400
 epoch 20/30. Took 1.6829 seconds. 
  Full-batch training loss = 0.000986, test loss = 0.164025
  Training set accuracy = 0.999900, Test set accuracy = 0.966100
 epoch 21/30. Took 1.6594 seconds. 
  Full-batch training loss = 0.000475, test loss = 0.159040
  Training set accuracy = 1.000000, Test set accuracy = 0.967700
 epoch 22/30. Took 1.6682 seconds. 
  Full-batch training loss = 0.000303, test loss = 0.163668
  Training set accuracy = 1.000000, Test set accuracy = 0.967100
 epoch 23/30. Took 1.6551 seconds. 
  Full-batch training loss = 0.000327, test loss = 0.167769
  Training set accuracy = 1.000000, Test set accuracy = 0.967300
 epoch 24/30. Took 1.6645 seconds. 
  Full-batch training loss = 0.000145, test loss = 0.162541
  Training set accuracy = 1.000000, Test set accuracy = 0.968400
 epoch 25/30. Took 1.6643 seconds. 
  Full-batch training loss = 0.000100, test loss = 0.160614
  Training set accuracy = 1.000000, Test set accuracy = 0.968500
 epoch 26/30. Took 1.7347 seconds. 
  Full-batch training loss = 0.000102, test loss = 0.164916
  Training set accuracy = 1.000000, Test set accuracy = 0.967800
 epoch 27/30. Took 1.6716 seconds. 
  Full-batch training loss = 0.000172, test loss = 0.176318
  Training set accuracy = 1.000000, Test set accuracy = 0.967000
 epoch 28/30. Took 1.6525 seconds. 
  Full-batch training loss = 0.000321, test loss = 0.170431
  Training set accuracy = 1.000000, Test set accuracy = 0.967200
 epoch 29/30. Took 1.734 seconds. 
  Full-batch training loss = 0.001452, test loss = 0.184235
  Training set accuracy = 0.999500, Test set accuracy = 0.964800
 epoch 30/30. Took 1.6729 seconds. 
  Full-batch training loss = 0.000181, test loss = 0.179489
  Training set accuracy = 1.000000, Test set accuracy = 0.966800
Elapsed time is 86.409191 seconds.
End Training
-----
Params 10000 0.100 0.20 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.2525 seconds. 
  Full-batch training loss = 0.332156, test loss = 0.338637
  Training set accuracy = 0.909100, Test set accuracy = 0.906500
 epoch 2/30. Took 0.23662 seconds. 
  Full-batch training loss = 0.252383, test loss = 0.276529
  Training set accuracy = 0.929800, Test set accuracy = 0.921500
 epoch 3/30. Took 0.23583 seconds. 
  Full-batch training loss = 0.200819, test loss = 0.243805
  Training set accuracy = 0.941500, Test set accuracy = 0.927700
 epoch 4/30. Took 0.23116 seconds. 
  Full-batch training loss = 0.171665, test loss = 0.215751
  Training set accuracy = 0.952400, Test set accuracy = 0.937100
 epoch 5/30. Took 0.23119 seconds. 
  Full-batch training loss = 0.146159, test loss = 0.204369
  Training set accuracy = 0.957200, Test set accuracy = 0.938800
 epoch 6/30. Took 0.22616 seconds. 
  Full-batch training loss = 0.120125, test loss = 0.189932
  Training set accuracy = 0.966800, Test set accuracy = 0.946100
 epoch 7/30. Took 0.23199 seconds. 
  Full-batch training loss = 0.104427, test loss = 0.184265
  Training set accuracy = 0.971600, Test set accuracy = 0.946200
 epoch 8/30. Took 0.23093 seconds. 
  Full-batch training loss = 0.090557, test loss = 0.169888
  Training set accuracy = 0.976300, Test set accuracy = 0.950400
 epoch 9/30. Took 0.23142 seconds. 
  Full-batch training loss = 0.084460, test loss = 0.168333
  Training set accuracy = 0.977900, Test set accuracy = 0.949800
 epoch 10/30. Took 0.23197 seconds. 
  Full-batch training loss = 0.072472, test loss = 0.168978
  Training set accuracy = 0.982100, Test set accuracy = 0.951700
 epoch 11/30. Took 0.23089 seconds. 
  Full-batch training loss = 0.061633, test loss = 0.163496
  Training set accuracy = 0.984400, Test set accuracy = 0.952900
 epoch 12/30. Took 0.23176 seconds. 
  Full-batch training loss = 0.060058, test loss = 0.167969
  Training set accuracy = 0.982900, Test set accuracy = 0.951700
 epoch 13/30. Took 0.2264 seconds. 
  Full-batch training loss = 0.046424, test loss = 0.155969
  Training set accuracy = 0.990300, Test set accuracy = 0.955200
 epoch 14/30. Took 0.23069 seconds. 
  Full-batch training loss = 0.044048, test loss = 0.154072
  Training set accuracy = 0.990600, Test set accuracy = 0.957100
 epoch 15/30. Took 0.22996 seconds. 
  Full-batch training loss = 0.037630, test loss = 0.153866
  Training set accuracy = 0.991200, Test set accuracy = 0.957500
 epoch 16/30. Took 0.23175 seconds. 
  Full-batch training loss = 0.031792, test loss = 0.150655
  Training set accuracy = 0.993400, Test set accuracy = 0.958800
 epoch 17/30. Took 0.23126 seconds. 
  Full-batch training loss = 0.032555, test loss = 0.148664
  Training set accuracy = 0.994000, Test set accuracy = 0.956900
 epoch 18/30. Took 0.22441 seconds. 
  Full-batch training loss = 0.025370, test loss = 0.151849
  Training set accuracy = 0.996900, Test set accuracy = 0.958300
 epoch 19/30. Took 0.22953 seconds. 
  Full-batch training loss = 0.024207, test loss = 0.147792
  Training set accuracy = 0.996000, Test set accuracy = 0.959500
 epoch 20/30. Took 0.23097 seconds. 
  Full-batch training loss = 0.024168, test loss = 0.151411
  Training set accuracy = 0.995600, Test set accuracy = 0.958400
 epoch 21/30. Took 0.23245 seconds. 
  Full-batch training loss = 0.021070, test loss = 0.154969
  Training set accuracy = 0.997300, Test set accuracy = 0.958800
 epoch 22/30. Took 0.22752 seconds. 
  Full-batch training loss = 0.018641, test loss = 0.148489
  Training set accuracy = 0.997800, Test set accuracy = 0.959200
 epoch 23/30. Took 0.22498 seconds. 
  Full-batch training loss = 0.015595, test loss = 0.148946
  Training set accuracy = 0.998200, Test set accuracy = 0.960500
 epoch 24/30. Took 0.23605 seconds. 
  Full-batch training loss = 0.015134, test loss = 0.152736
  Training set accuracy = 0.998400, Test set accuracy = 0.960300
 epoch 25/30. Took 0.23004 seconds. 
  Full-batch training loss = 0.014971, test loss = 0.156809
  Training set accuracy = 0.997700, Test set accuracy = 0.960000
 epoch 26/30. Took 0.22915 seconds. 
  Full-batch training loss = 0.012521, test loss = 0.151187
  Training set accuracy = 0.999100, Test set accuracy = 0.959400
 epoch 27/30. Took 0.2308 seconds. 
  Full-batch training loss = 0.013538, test loss = 0.156361
  Training set accuracy = 0.998500, Test set accuracy = 0.957700
 epoch 28/30. Took 0.23524 seconds. 
  Full-batch training loss = 0.012371, test loss = 0.154650
  Training set accuracy = 0.998400, Test set accuracy = 0.959400
 epoch 29/30. Took 0.22919 seconds. 
  Full-batch training loss = 0.011648, test loss = 0.152752
  Training set accuracy = 0.999200, Test set accuracy = 0.959800
 epoch 30/30. Took 0.23057 seconds. 
  Full-batch training loss = 0.010504, test loss = 0.151434
  Training set accuracy = 0.999300, Test set accuracy = 0.961400
Elapsed time is 13.298355 seconds.
End Training
-----
Params 10000 0.100 0.20 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.37218 seconds. 
  Full-batch training loss = 0.309723, test loss = 0.333812
  Training set accuracy = 0.909900, Test set accuracy = 0.904400
 epoch 2/30. Took 0.34672 seconds. 
  Full-batch training loss = 0.239762, test loss = 0.279317
  Training set accuracy = 0.932700, Test set accuracy = 0.918700
 epoch 3/30. Took 0.34696 seconds. 
  Full-batch training loss = 0.174014, test loss = 0.230075
  Training set accuracy = 0.952000, Test set accuracy = 0.931900
 epoch 4/30. Took 0.34548 seconds. 
  Full-batch training loss = 0.160599, test loss = 0.223699
  Training set accuracy = 0.951000, Test set accuracy = 0.929300
 epoch 5/30. Took 0.34965 seconds. 
  Full-batch training loss = 0.126106, test loss = 0.196531
  Training set accuracy = 0.966600, Test set accuracy = 0.942100
 epoch 6/30. Took 0.34737 seconds. 
  Full-batch training loss = 0.106392, test loss = 0.180938
  Training set accuracy = 0.971500, Test set accuracy = 0.945200
 epoch 7/30. Took 0.34898 seconds. 
  Full-batch training loss = 0.090106, test loss = 0.171580
  Training set accuracy = 0.977200, Test set accuracy = 0.947500
 epoch 8/30. Took 0.35269 seconds. 
  Full-batch training loss = 0.071715, test loss = 0.155809
  Training set accuracy = 0.980500, Test set accuracy = 0.952900
 epoch 9/30. Took 0.34913 seconds. 
  Full-batch training loss = 0.062632, test loss = 0.150488
  Training set accuracy = 0.985400, Test set accuracy = 0.954200
 epoch 10/30. Took 0.34873 seconds. 
  Full-batch training loss = 0.051975, test loss = 0.146025
  Training set accuracy = 0.987900, Test set accuracy = 0.955700
 epoch 11/30. Took 0.34871 seconds. 
  Full-batch training loss = 0.043203, test loss = 0.139284
  Training set accuracy = 0.991700, Test set accuracy = 0.958400
 epoch 12/30. Took 0.35032 seconds. 
  Full-batch training loss = 0.038202, test loss = 0.135292
  Training set accuracy = 0.993600, Test set accuracy = 0.960700
 epoch 13/30. Took 0.35042 seconds. 
  Full-batch training loss = 0.034917, test loss = 0.138509
  Training set accuracy = 0.993800, Test set accuracy = 0.957700
 epoch 14/30. Took 0.36111 seconds. 
  Full-batch training loss = 0.029760, test loss = 0.133143
  Training set accuracy = 0.994400, Test set accuracy = 0.958400
 epoch 15/30. Took 0.34904 seconds. 
  Full-batch training loss = 0.026403, test loss = 0.136989
  Training set accuracy = 0.995700, Test set accuracy = 0.961200
 epoch 16/30. Took 0.35845 seconds. 
  Full-batch training loss = 0.022902, test loss = 0.132445
  Training set accuracy = 0.996200, Test set accuracy = 0.962900
 epoch 17/30. Took 0.34963 seconds. 
  Full-batch training loss = 0.018904, test loss = 0.133540
  Training set accuracy = 0.997300, Test set accuracy = 0.962200
 epoch 18/30. Took 0.37267 seconds. 
  Full-batch training loss = 0.018403, test loss = 0.131174
  Training set accuracy = 0.997200, Test set accuracy = 0.962200
 epoch 19/30. Took 0.35609 seconds. 
  Full-batch training loss = 0.015336, test loss = 0.130893
  Training set accuracy = 0.998200, Test set accuracy = 0.961800
 epoch 20/30. Took 0.35046 seconds. 
  Full-batch training loss = 0.015139, test loss = 0.126185
  Training set accuracy = 0.997700, Test set accuracy = 0.963800
 epoch 21/30. Took 0.35209 seconds. 
  Full-batch training loss = 0.012409, test loss = 0.128336
  Training set accuracy = 0.999200, Test set accuracy = 0.962800
 epoch 22/30. Took 0.35683 seconds. 
  Full-batch training loss = 0.012752, test loss = 0.133814
  Training set accuracy = 0.998700, Test set accuracy = 0.962300
 epoch 23/30. Took 0.36735 seconds. 
  Full-batch training loss = 0.010170, test loss = 0.129671
  Training set accuracy = 0.999300, Test set accuracy = 0.962700
 epoch 24/30. Took 0.34972 seconds. 
  Full-batch training loss = 0.009165, test loss = 0.133572
  Training set accuracy = 0.999500, Test set accuracy = 0.963100
 epoch 25/30. Took 0.3756 seconds. 
  Full-batch training loss = 0.008882, test loss = 0.130852
  Training set accuracy = 0.999600, Test set accuracy = 0.962900
 epoch 26/30. Took 0.3682 seconds. 
  Full-batch training loss = 0.008259, test loss = 0.132768
  Training set accuracy = 0.999600, Test set accuracy = 0.962600
 epoch 27/30. Took 0.34656 seconds. 
  Full-batch training loss = 0.007153, test loss = 0.131193
  Training set accuracy = 0.999800, Test set accuracy = 0.961900
 epoch 28/30. Took 0.34931 seconds. 
  Full-batch training loss = 0.006532, test loss = 0.132898
  Training set accuracy = 0.999900, Test set accuracy = 0.961900
 epoch 29/30. Took 0.34965 seconds. 
  Full-batch training loss = 0.006703, test loss = 0.136230
  Training set accuracy = 0.999700, Test set accuracy = 0.962200
 epoch 30/30. Took 0.34815 seconds. 
  Full-batch training loss = 0.005527, test loss = 0.133881
  Training set accuracy = 0.999900, Test set accuracy = 0.964100
Elapsed time is 19.321271 seconds.
End Training
-----
Params 10000 0.100 0.20 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.73197 seconds. 
  Full-batch training loss = 0.322644, test loss = 0.335164
  Training set accuracy = 0.906500, Test set accuracy = 0.903500
 epoch 2/30. Took 0.733 seconds. 
  Full-batch training loss = 0.231991, test loss = 0.258528
  Training set accuracy = 0.929100, Test set accuracy = 0.923300
 epoch 3/30. Took 0.73282 seconds. 
  Full-batch training loss = 0.174685, test loss = 0.220671
  Training set accuracy = 0.950600, Test set accuracy = 0.933700
 epoch 4/30. Took 0.8093 seconds. 
  Full-batch training loss = 0.144065, test loss = 0.197535
  Training set accuracy = 0.961700, Test set accuracy = 0.940400
 epoch 5/30. Took 0.7418 seconds. 
  Full-batch training loss = 0.106594, test loss = 0.169383
  Training set accuracy = 0.972400, Test set accuracy = 0.950700
 epoch 6/30. Took 0.7435 seconds. 
  Full-batch training loss = 0.098116, test loss = 0.165689
  Training set accuracy = 0.976200, Test set accuracy = 0.950300
 epoch 7/30. Took 0.75466 seconds. 
  Full-batch training loss = 0.076903, test loss = 0.150865
  Training set accuracy = 0.981900, Test set accuracy = 0.954000
 epoch 8/30. Took 0.74682 seconds. 
  Full-batch training loss = 0.061129, test loss = 0.139581
  Training set accuracy = 0.987000, Test set accuracy = 0.959000
 epoch 9/30. Took 0.7322 seconds. 
  Full-batch training loss = 0.056023, test loss = 0.149953
  Training set accuracy = 0.989000, Test set accuracy = 0.954100
 epoch 10/30. Took 0.74941 seconds. 
  Full-batch training loss = 0.039561, test loss = 0.133138
  Training set accuracy = 0.992500, Test set accuracy = 0.961600
 epoch 11/30. Took 0.74065 seconds. 
  Full-batch training loss = 0.035305, test loss = 0.133003
  Training set accuracy = 0.994100, Test set accuracy = 0.961000
 epoch 12/30. Took 0.73075 seconds. 
  Full-batch training loss = 0.029236, test loss = 0.126858
  Training set accuracy = 0.995600, Test set accuracy = 0.962000
 epoch 13/30. Took 0.76153 seconds. 
  Full-batch training loss = 0.024040, test loss = 0.127431
  Training set accuracy = 0.997500, Test set accuracy = 0.962600
 epoch 14/30. Took 0.73125 seconds. 
  Full-batch training loss = 0.021253, test loss = 0.125446
  Training set accuracy = 0.998100, Test set accuracy = 0.963800
 epoch 15/30. Took 0.745 seconds. 
  Full-batch training loss = 0.018580, test loss = 0.125745
  Training set accuracy = 0.998600, Test set accuracy = 0.963700
 epoch 16/30. Took 0.73199 seconds. 
  Full-batch training loss = 0.016296, test loss = 0.124734
  Training set accuracy = 0.999200, Test set accuracy = 0.963800
 epoch 17/30. Took 0.7328 seconds. 
  Full-batch training loss = 0.015184, test loss = 0.121072
  Training set accuracy = 0.998600, Test set accuracy = 0.963200
 epoch 18/30. Took 0.75632 seconds. 
  Full-batch training loss = 0.013646, test loss = 0.128708
  Training set accuracy = 0.999300, Test set accuracy = 0.962800
 epoch 19/30. Took 0.75405 seconds. 
  Full-batch training loss = 0.010621, test loss = 0.122540
  Training set accuracy = 0.999900, Test set accuracy = 0.965200
 epoch 20/30. Took 0.73103 seconds. 
  Full-batch training loss = 0.009333, test loss = 0.119550
  Training set accuracy = 0.999800, Test set accuracy = 0.963900
 epoch 21/30. Took 0.74008 seconds. 
  Full-batch training loss = 0.008617, test loss = 0.122396
  Training set accuracy = 0.999800, Test set accuracy = 0.965200
 epoch 22/30. Took 0.79618 seconds. 
  Full-batch training loss = 0.007670, test loss = 0.118931
  Training set accuracy = 1.000000, Test set accuracy = 0.966600
 epoch 23/30. Took 0.73037 seconds. 
  Full-batch training loss = 0.006677, test loss = 0.119661
  Training set accuracy = 0.999900, Test set accuracy = 0.966700
 epoch 24/30. Took 0.73087 seconds. 
  Full-batch training loss = 0.006706, test loss = 0.124304
  Training set accuracy = 0.999900, Test set accuracy = 0.964000
 epoch 25/30. Took 0.73164 seconds. 
  Full-batch training loss = 0.005820, test loss = 0.120255
  Training set accuracy = 1.000000, Test set accuracy = 0.966000
 epoch 26/30. Took 0.73455 seconds. 
  Full-batch training loss = 0.005355, test loss = 0.125507
  Training set accuracy = 1.000000, Test set accuracy = 0.966300
 epoch 27/30. Took 0.74141 seconds. 
  Full-batch training loss = 0.005127, test loss = 0.125109
  Training set accuracy = 0.999900, Test set accuracy = 0.966700
 epoch 28/30. Took 0.73625 seconds. 
  Full-batch training loss = 0.004530, test loss = 0.121292
  Training set accuracy = 1.000000, Test set accuracy = 0.966500
 epoch 29/30. Took 0.76681 seconds. 
  Full-batch training loss = 0.004504, test loss = 0.124090
  Training set accuracy = 1.000000, Test set accuracy = 0.967500
 epoch 30/30. Took 0.78086 seconds. 
  Full-batch training loss = 0.004214, test loss = 0.126630
  Training set accuracy = 1.000000, Test set accuracy = 0.965800
Elapsed time is 38.779008 seconds.
End Training
-----
Params 10000 0.100 0.20 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.30735 seconds. 
  Full-batch training loss = 0.349042, test loss = 0.363158
  Training set accuracy = 0.898000, Test set accuracy = 0.893100
 epoch 2/30. Took 0.28464 seconds. 
  Full-batch training loss = 0.235335, test loss = 0.259354
  Training set accuracy = 0.932200, Test set accuracy = 0.922300
 epoch 3/30. Took 0.29703 seconds. 
  Full-batch training loss = 0.173299, test loss = 0.218149
  Training set accuracy = 0.949300, Test set accuracy = 0.932400
 epoch 4/30. Took 0.28671 seconds. 
  Full-batch training loss = 0.143740, test loss = 0.201255
  Training set accuracy = 0.955900, Test set accuracy = 0.938900
 epoch 5/30. Took 0.27954 seconds. 
  Full-batch training loss = 0.120801, test loss = 0.190329
  Training set accuracy = 0.964500, Test set accuracy = 0.942700
 epoch 6/30. Took 0.28649 seconds. 
  Full-batch training loss = 0.095733, test loss = 0.176257
  Training set accuracy = 0.970700, Test set accuracy = 0.942300
 epoch 7/30. Took 0.29541 seconds. 
  Full-batch training loss = 0.085576, test loss = 0.161631
  Training set accuracy = 0.973500, Test set accuracy = 0.947500
 epoch 8/30. Took 0.28669 seconds. 
  Full-batch training loss = 0.065680, test loss = 0.151490
  Training set accuracy = 0.980700, Test set accuracy = 0.954800
 epoch 9/30. Took 0.28727 seconds. 
  Full-batch training loss = 0.054512, test loss = 0.147303
  Training set accuracy = 0.984900, Test set accuracy = 0.954400
 epoch 10/30. Took 0.2868 seconds. 
  Full-batch training loss = 0.045283, test loss = 0.145904
  Training set accuracy = 0.987600, Test set accuracy = 0.953900
 epoch 11/30. Took 0.28622 seconds. 
  Full-batch training loss = 0.040192, test loss = 0.147041
  Training set accuracy = 0.990000, Test set accuracy = 0.954400
 epoch 12/30. Took 0.27992 seconds. 
  Full-batch training loss = 0.037089, test loss = 0.159078
  Training set accuracy = 0.988200, Test set accuracy = 0.952600
 epoch 13/30. Took 0.28086 seconds. 
  Full-batch training loss = 0.030625, test loss = 0.153921
  Training set accuracy = 0.991500, Test set accuracy = 0.953300
 epoch 14/30. Took 0.28899 seconds. 
  Full-batch training loss = 0.027736, test loss = 0.145438
  Training set accuracy = 0.992600, Test set accuracy = 0.957600
 epoch 15/30. Took 0.28495 seconds. 
  Full-batch training loss = 0.021313, test loss = 0.143682
  Training set accuracy = 0.995100, Test set accuracy = 0.959300
 epoch 16/30. Took 0.28656 seconds. 
  Full-batch training loss = 0.036960, test loss = 0.180101
  Training set accuracy = 0.987700, Test set accuracy = 0.948900
 epoch 17/30. Took 0.27435 seconds. 
  Full-batch training loss = 0.020156, test loss = 0.143955
  Training set accuracy = 0.994700, Test set accuracy = 0.958200
 epoch 18/30. Took 0.27532 seconds. 
  Full-batch training loss = 0.016380, test loss = 0.146078
  Training set accuracy = 0.996200, Test set accuracy = 0.958900
 epoch 19/30. Took 0.27216 seconds. 
  Full-batch training loss = 0.012806, test loss = 0.143317
  Training set accuracy = 0.996500, Test set accuracy = 0.961600
 epoch 20/30. Took 0.2889 seconds. 
  Full-batch training loss = 0.011472, test loss = 0.151200
  Training set accuracy = 0.997100, Test set accuracy = 0.959800
 epoch 21/30. Took 0.28474 seconds. 
  Full-batch training loss = 0.012783, test loss = 0.154186
  Training set accuracy = 0.996700, Test set accuracy = 0.960100
 epoch 22/30. Took 0.28169 seconds. 
  Full-batch training loss = 0.008715, test loss = 0.160018
  Training set accuracy = 0.998200, Test set accuracy = 0.959800
 epoch 23/30. Took 0.28593 seconds. 
  Full-batch training loss = 0.009201, test loss = 0.154513
  Training set accuracy = 0.997900, Test set accuracy = 0.960700
 epoch 24/30. Took 0.28425 seconds. 
  Full-batch training loss = 0.014247, test loss = 0.147545
  Training set accuracy = 0.995900, Test set accuracy = 0.959900
 epoch 25/30. Took 0.28646 seconds. 
  Full-batch training loss = 0.007426, test loss = 0.150098
  Training set accuracy = 0.999100, Test set accuracy = 0.960500
 epoch 26/30. Took 0.30068 seconds. 
  Full-batch training loss = 0.007694, test loss = 0.147428
  Training set accuracy = 0.998300, Test set accuracy = 0.961600
 epoch 27/30. Took 0.29054 seconds. 
  Full-batch training loss = 0.006596, test loss = 0.151568
  Training set accuracy = 0.998700, Test set accuracy = 0.960300
 epoch 28/30. Took 0.27886 seconds. 
  Full-batch training loss = 0.005307, test loss = 0.162201
  Training set accuracy = 0.999300, Test set accuracy = 0.960700
 epoch 29/30. Took 0.27403 seconds. 
  Full-batch training loss = 0.003752, test loss = 0.163322
  Training set accuracy = 0.999400, Test set accuracy = 0.961400
 epoch 30/30. Took 0.28411 seconds. 
  Full-batch training loss = 0.003717, test loss = 0.147708
  Training set accuracy = 0.999800, Test set accuracy = 0.961800
Elapsed time is 15.878255 seconds.
End Training
-----
Params 10000 0.100 0.20 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.48407 seconds. 
  Full-batch training loss = 0.339465, test loss = 0.347761
  Training set accuracy = 0.900800, Test set accuracy = 0.897400
 epoch 2/30. Took 0.47373 seconds. 
  Full-batch training loss = 0.229826, test loss = 0.262456
  Training set accuracy = 0.929200, Test set accuracy = 0.915800
 epoch 3/30. Took 0.47519 seconds. 
  Full-batch training loss = 0.163642, test loss = 0.198547
  Training set accuracy = 0.953000, Test set accuracy = 0.939300
 epoch 4/30. Took 0.48544 seconds. 
  Full-batch training loss = 0.122058, test loss = 0.173197
  Training set accuracy = 0.966900, Test set accuracy = 0.945900
 epoch 5/30. Took 0.47421 seconds. 
  Full-batch training loss = 0.093840, test loss = 0.154832
  Training set accuracy = 0.972800, Test set accuracy = 0.951700
 epoch 6/30. Took 0.47285 seconds. 
  Full-batch training loss = 0.082072, test loss = 0.160110
  Training set accuracy = 0.975600, Test set accuracy = 0.949500
 epoch 7/30. Took 0.46834 seconds. 
  Full-batch training loss = 0.067901, test loss = 0.154788
  Training set accuracy = 0.981100, Test set accuracy = 0.951500
 epoch 8/30. Took 0.47807 seconds. 
  Full-batch training loss = 0.045059, test loss = 0.140818
  Training set accuracy = 0.987500, Test set accuracy = 0.957000
 epoch 9/30. Took 0.47114 seconds. 
  Full-batch training loss = 0.040886, test loss = 0.143608
  Training set accuracy = 0.988800, Test set accuracy = 0.958200
 epoch 10/30. Took 0.47093 seconds. 
  Full-batch training loss = 0.038731, test loss = 0.151466
  Training set accuracy = 0.988100, Test set accuracy = 0.957100
 epoch 11/30. Took 0.46877 seconds. 
  Full-batch training loss = 0.028582, test loss = 0.140240
  Training set accuracy = 0.992300, Test set accuracy = 0.957500
 epoch 12/30. Took 0.48012 seconds. 
  Full-batch training loss = 0.019613, test loss = 0.140596
  Training set accuracy = 0.995800, Test set accuracy = 0.959600
 epoch 13/30. Took 0.46462 seconds. 
  Full-batch training loss = 0.017150, test loss = 0.125608
  Training set accuracy = 0.996700, Test set accuracy = 0.963300
 epoch 14/30. Took 0.4673 seconds. 
  Full-batch training loss = 0.014767, test loss = 0.133383
  Training set accuracy = 0.997200, Test set accuracy = 0.962400
 epoch 15/30. Took 0.51546 seconds. 
  Full-batch training loss = 0.012530, test loss = 0.137429
  Training set accuracy = 0.998300, Test set accuracy = 0.962000
 epoch 16/30. Took 0.51611 seconds. 
  Full-batch training loss = 0.011346, test loss = 0.136902
  Training set accuracy = 0.998400, Test set accuracy = 0.963600
 epoch 17/30. Took 0.47412 seconds. 
  Full-batch training loss = 0.010134, test loss = 0.138628
  Training set accuracy = 0.997900, Test set accuracy = 0.961900
 epoch 18/30. Took 0.47418 seconds. 
  Full-batch training loss = 0.008144, test loss = 0.135799
  Training set accuracy = 0.998800, Test set accuracy = 0.963700
 epoch 19/30. Took 0.46817 seconds. 
  Full-batch training loss = 0.006922, test loss = 0.135193
  Training set accuracy = 0.999000, Test set accuracy = 0.963400
 epoch 20/30. Took 0.46964 seconds. 
  Full-batch training loss = 0.006336, test loss = 0.140745
  Training set accuracy = 0.999500, Test set accuracy = 0.963700
 epoch 21/30. Took 0.47627 seconds. 
  Full-batch training loss = 0.004138, test loss = 0.129332
  Training set accuracy = 0.999800, Test set accuracy = 0.965700
 epoch 22/30. Took 0.47007 seconds. 
  Full-batch training loss = 0.005516, test loss = 0.138910
  Training set accuracy = 0.999200, Test set accuracy = 0.963600
 epoch 23/30. Took 0.47184 seconds. 
  Full-batch training loss = 0.004427, test loss = 0.141546
  Training set accuracy = 0.999400, Test set accuracy = 0.963800
 epoch 24/30. Took 0.47167 seconds. 
  Full-batch training loss = 0.004310, test loss = 0.135248
  Training set accuracy = 0.999100, Test set accuracy = 0.964100
 epoch 25/30. Took 0.4847 seconds. 
  Full-batch training loss = 0.003721, test loss = 0.141552
  Training set accuracy = 0.999300, Test set accuracy = 0.965900
 epoch 26/30. Took 0.48564 seconds. 
  Full-batch training loss = 0.002451, test loss = 0.141624
  Training set accuracy = 0.999900, Test set accuracy = 0.963800
 epoch 27/30. Took 0.47841 seconds. 
  Full-batch training loss = 0.002762, test loss = 0.142390
  Training set accuracy = 0.999700, Test set accuracy = 0.964400
 epoch 28/30. Took 0.48144 seconds. 
  Full-batch training loss = 0.002698, test loss = 0.146736
  Training set accuracy = 0.999600, Test set accuracy = 0.965400
 epoch 29/30. Took 0.47805 seconds. 
  Full-batch training loss = 0.002443, test loss = 0.139269
  Training set accuracy = 0.999700, Test set accuracy = 0.965600
 epoch 30/30. Took 0.47432 seconds. 
  Full-batch training loss = 0.002187, test loss = 0.141807
  Training set accuracy = 0.999600, Test set accuracy = 0.965700
Elapsed time is 25.219502 seconds.
End Training
-----
Params 10000 0.100 0.20 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2046 seconds. 
  Full-batch training loss = 0.286458, test loss = 0.301576
  Training set accuracy = 0.916900, Test set accuracy = 0.910700
 epoch 2/30. Took 1.2107 seconds. 
  Full-batch training loss = 0.201353, test loss = 0.234698
  Training set accuracy = 0.942000, Test set accuracy = 0.930000
 epoch 3/30. Took 1.2131 seconds. 
  Full-batch training loss = 0.141021, test loss = 0.191504
  Training set accuracy = 0.960300, Test set accuracy = 0.942000
 epoch 4/30. Took 1.2148 seconds. 
  Full-batch training loss = 0.111228, test loss = 0.161131
  Training set accuracy = 0.969600, Test set accuracy = 0.949400
 epoch 5/30. Took 1.1992 seconds. 
  Full-batch training loss = 0.081863, test loss = 0.151792
  Training set accuracy = 0.977700, Test set accuracy = 0.953000
 epoch 6/30. Took 1.201 seconds. 
  Full-batch training loss = 0.058323, test loss = 0.135619
  Training set accuracy = 0.985800, Test set accuracy = 0.958300
 epoch 7/30. Took 1.2017 seconds. 
  Full-batch training loss = 0.049882, test loss = 0.137937
  Training set accuracy = 0.987300, Test set accuracy = 0.959300
 epoch 8/30. Took 1.2042 seconds. 
  Full-batch training loss = 0.034977, test loss = 0.127790
  Training set accuracy = 0.992200, Test set accuracy = 0.960800
 epoch 9/30. Took 1.2371 seconds. 
  Full-batch training loss = 0.023822, test loss = 0.124442
  Training set accuracy = 0.994200, Test set accuracy = 0.962900
 epoch 10/30. Took 1.255 seconds. 
  Full-batch training loss = 0.035988, test loss = 0.152303
  Training set accuracy = 0.990900, Test set accuracy = 0.958100
 epoch 11/30. Took 1.1999 seconds. 
  Full-batch training loss = 0.014115, test loss = 0.126529
  Training set accuracy = 0.997200, Test set accuracy = 0.963900
 epoch 12/30. Took 1.1986 seconds. 
  Full-batch training loss = 0.012480, test loss = 0.129191
  Training set accuracy = 0.997800, Test set accuracy = 0.963900
 epoch 13/30. Took 1.2175 seconds. 
  Full-batch training loss = 0.012194, test loss = 0.132936
  Training set accuracy = 0.998300, Test set accuracy = 0.962600
 epoch 14/30. Took 1.2046 seconds. 
  Full-batch training loss = 0.008478, test loss = 0.128811
  Training set accuracy = 0.999000, Test set accuracy = 0.964600
 epoch 15/30. Took 1.2145 seconds. 
  Full-batch training loss = 0.010823, test loss = 0.138443
  Training set accuracy = 0.998100, Test set accuracy = 0.961900
 epoch 16/30. Took 1.1992 seconds. 
  Full-batch training loss = 0.004500, test loss = 0.124861
  Training set accuracy = 0.999600, Test set accuracy = 0.967100
 epoch 17/30. Took 1.2235 seconds. 
  Full-batch training loss = 0.004975, test loss = 0.128421
  Training set accuracy = 0.999500, Test set accuracy = 0.965900
 epoch 18/30. Took 1.2703 seconds. 
  Full-batch training loss = 0.003042, test loss = 0.124057
  Training set accuracy = 0.999800, Test set accuracy = 0.967500
 epoch 19/30. Took 1.2235 seconds. 
  Full-batch training loss = 0.004012, test loss = 0.135816
  Training set accuracy = 0.999700, Test set accuracy = 0.964300
 epoch 20/30. Took 1.2055 seconds. 
  Full-batch training loss = 0.002388, test loss = 0.125707
  Training set accuracy = 0.999900, Test set accuracy = 0.967500
 epoch 21/30. Took 1.2673 seconds. 
  Full-batch training loss = 0.002283, test loss = 0.131288
  Training set accuracy = 1.000000, Test set accuracy = 0.966800
 epoch 22/30. Took 1.2142 seconds. 
  Full-batch training loss = 0.001906, test loss = 0.130874
  Training set accuracy = 0.999900, Test set accuracy = 0.966400
 epoch 23/30. Took 1.2119 seconds. 
  Full-batch training loss = 0.001106, test loss = 0.128694
  Training set accuracy = 1.000000, Test set accuracy = 0.968200
 epoch 24/30. Took 1.2039 seconds. 
  Full-batch training loss = 0.001750, test loss = 0.138134
  Training set accuracy = 1.000000, Test set accuracy = 0.966700
 epoch 25/30. Took 1.2017 seconds. 
  Full-batch training loss = 0.000987, test loss = 0.133080
  Training set accuracy = 1.000000, Test set accuracy = 0.967800
 epoch 26/30. Took 1.3168 seconds. 
  Full-batch training loss = 0.001974, test loss = 0.145789
  Training set accuracy = 0.999900, Test set accuracy = 0.965800
 epoch 27/30. Took 1.1975 seconds. 
  Full-batch training loss = 0.001162, test loss = 0.136828
  Training set accuracy = 1.000000, Test set accuracy = 0.968300
 epoch 28/30. Took 1.2651 seconds. 
  Full-batch training loss = 0.001185, test loss = 0.135526
  Training set accuracy = 0.999900, Test set accuracy = 0.968600
 epoch 29/30. Took 1.2164 seconds. 
  Full-batch training loss = 0.000712, test loss = 0.130015
  Training set accuracy = 1.000000, Test set accuracy = 0.968400
 epoch 30/30. Took 1.2192 seconds. 
  Full-batch training loss = 0.000476, test loss = 0.131050
  Training set accuracy = 1.000000, Test set accuracy = 0.970100
Elapsed time is 62.665374 seconds.
End Training
-----
Params 10000 0.100 0.20 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32782 seconds. 
  Full-batch training loss = 0.391411, test loss = 0.392737
  Training set accuracy = 0.877000, Test set accuracy = 0.879600
 epoch 2/30. Took 0.35192 seconds. 
  Full-batch training loss = 0.232393, test loss = 0.270626
  Training set accuracy = 0.930400, Test set accuracy = 0.917000
 epoch 3/30. Took 0.3291 seconds. 
  Full-batch training loss = 0.168238, test loss = 0.210587
  Training set accuracy = 0.948700, Test set accuracy = 0.935300
 epoch 4/30. Took 0.31498 seconds. 
  Full-batch training loss = 0.141259, test loss = 0.200994
  Training set accuracy = 0.959500, Test set accuracy = 0.938600
 epoch 5/30. Took 0.33296 seconds. 
  Full-batch training loss = 0.121721, test loss = 0.192657
  Training set accuracy = 0.964300, Test set accuracy = 0.941400
 epoch 6/30. Took 0.33413 seconds. 
  Full-batch training loss = 0.095509, test loss = 0.177837
  Training set accuracy = 0.971800, Test set accuracy = 0.945600
 epoch 7/30. Took 0.34296 seconds. 
  Full-batch training loss = 0.074614, test loss = 0.159314
  Training set accuracy = 0.976900, Test set accuracy = 0.953600
 epoch 8/30. Took 0.33764 seconds. 
  Full-batch training loss = 0.072580, test loss = 0.161736
  Training set accuracy = 0.978200, Test set accuracy = 0.950200
 epoch 9/30. Took 0.33848 seconds. 
  Full-batch training loss = 0.055530, test loss = 0.163593
  Training set accuracy = 0.983700, Test set accuracy = 0.953200
 epoch 10/30. Took 0.33796 seconds. 
  Full-batch training loss = 0.046499, test loss = 0.159011
  Training set accuracy = 0.986800, Test set accuracy = 0.955900
 epoch 11/30. Took 0.33862 seconds. 
  Full-batch training loss = 0.042469, test loss = 0.156457
  Training set accuracy = 0.988500, Test set accuracy = 0.954600
 epoch 12/30. Took 0.33028 seconds. 
  Full-batch training loss = 0.038020, test loss = 0.154643
  Training set accuracy = 0.990300, Test set accuracy = 0.955300
 epoch 13/30. Took 0.33388 seconds. 
  Full-batch training loss = 0.037480, test loss = 0.172501
  Training set accuracy = 0.988700, Test set accuracy = 0.953500
 epoch 14/30. Took 0.33753 seconds. 
  Full-batch training loss = 0.038144, test loss = 0.168024
  Training set accuracy = 0.988600, Test set accuracy = 0.954700
 epoch 15/30. Took 0.33713 seconds. 
  Full-batch training loss = 0.027408, test loss = 0.173174
  Training set accuracy = 0.991800, Test set accuracy = 0.956100
 epoch 16/30. Took 0.32224 seconds. 
  Full-batch training loss = 0.027117, test loss = 0.162943
  Training set accuracy = 0.992100, Test set accuracy = 0.957400
 epoch 17/30. Took 0.33097 seconds. 
  Full-batch training loss = 0.023267, test loss = 0.165649
  Training set accuracy = 0.992600, Test set accuracy = 0.957100
 epoch 18/30. Took 0.3339 seconds. 
  Full-batch training loss = 0.019464, test loss = 0.164466
  Training set accuracy = 0.994200, Test set accuracy = 0.958000
 epoch 19/30. Took 0.33837 seconds. 
  Full-batch training loss = 0.016208, test loss = 0.150954
  Training set accuracy = 0.995700, Test set accuracy = 0.960400
 epoch 20/30. Took 0.34778 seconds. 
  Full-batch training loss = 0.014841, test loss = 0.169418
  Training set accuracy = 0.996400, Test set accuracy = 0.958000
 epoch 21/30. Took 0.33799 seconds. 
  Full-batch training loss = 0.021757, test loss = 0.167045
  Training set accuracy = 0.992900, Test set accuracy = 0.958300
 epoch 22/30. Took 0.33886 seconds. 
  Full-batch training loss = 0.016366, test loss = 0.181863
  Training set accuracy = 0.995400, Test set accuracy = 0.958700
 epoch 23/30. Took 0.33851 seconds. 
  Full-batch training loss = 0.012329, test loss = 0.171681
  Training set accuracy = 0.997000, Test set accuracy = 0.961700
 epoch 24/30. Took 0.33934 seconds. 
  Full-batch training loss = 0.009527, test loss = 0.171383
  Training set accuracy = 0.998100, Test set accuracy = 0.961000
 epoch 25/30. Took 0.32505 seconds. 
  Full-batch training loss = 0.013159, test loss = 0.173920
  Training set accuracy = 0.995900, Test set accuracy = 0.961000
 epoch 26/30. Took 0.33795 seconds. 
  Full-batch training loss = 0.008162, test loss = 0.167316
  Training set accuracy = 0.997900, Test set accuracy = 0.963400
 epoch 27/30. Took 0.31936 seconds. 
  Full-batch training loss = 0.011096, test loss = 0.175244
  Training set accuracy = 0.997100, Test set accuracy = 0.960100
 epoch 28/30. Took 0.33868 seconds. 
  Full-batch training loss = 0.006671, test loss = 0.163220
  Training set accuracy = 0.998000, Test set accuracy = 0.962300
 epoch 29/30. Took 0.33708 seconds. 
  Full-batch training loss = 0.010463, test loss = 0.176541
  Training set accuracy = 0.996400, Test set accuracy = 0.960400
 epoch 30/30. Took 0.33859 seconds. 
  Full-batch training loss = 0.012720, test loss = 0.198743
  Training set accuracy = 0.995900, Test set accuracy = 0.959200
Elapsed time is 18.244392 seconds.
End Training
-----
Params 10000 0.100 0.20 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.57749 seconds. 
  Full-batch training loss = 0.351809, test loss = 0.349263
  Training set accuracy = 0.892200, Test set accuracy = 0.895700
 epoch 2/30. Took 0.57626 seconds. 
  Full-batch training loss = 0.218555, test loss = 0.236239
  Training set accuracy = 0.932300, Test set accuracy = 0.928100
 epoch 3/30. Took 0.57117 seconds. 
  Full-batch training loss = 0.151920, test loss = 0.185657
  Training set accuracy = 0.952600, Test set accuracy = 0.940900
 epoch 4/30. Took 0.579 seconds. 
  Full-batch training loss = 0.126095, test loss = 0.180055
  Training set accuracy = 0.962800, Test set accuracy = 0.943700
 epoch 5/30. Took 0.5921 seconds. 
  Full-batch training loss = 0.095966, test loss = 0.164418
  Training set accuracy = 0.970300, Test set accuracy = 0.950700
 epoch 6/30. Took 0.58169 seconds. 
  Full-batch training loss = 0.098585, test loss = 0.181016
  Training set accuracy = 0.970600, Test set accuracy = 0.944100
 epoch 7/30. Took 0.5929 seconds. 
  Full-batch training loss = 0.068591, test loss = 0.161318
  Training set accuracy = 0.979500, Test set accuracy = 0.949600
 epoch 8/30. Took 0.58354 seconds. 
  Full-batch training loss = 0.049698, test loss = 0.142967
  Training set accuracy = 0.985800, Test set accuracy = 0.955300
 epoch 9/30. Took 0.58086 seconds. 
  Full-batch training loss = 0.044615, test loss = 0.147427
  Training set accuracy = 0.986900, Test set accuracy = 0.956700
 epoch 10/30. Took 0.58241 seconds. 
  Full-batch training loss = 0.042874, test loss = 0.143812
  Training set accuracy = 0.987200, Test set accuracy = 0.956500
 epoch 11/30. Took 0.58227 seconds. 
  Full-batch training loss = 0.038673, test loss = 0.166805
  Training set accuracy = 0.987900, Test set accuracy = 0.953600
 epoch 12/30. Took 0.58 seconds. 
  Full-batch training loss = 0.024015, test loss = 0.129953
  Training set accuracy = 0.993800, Test set accuracy = 0.962700
 epoch 13/30. Took 0.58173 seconds. 
  Full-batch training loss = 0.025056, test loss = 0.142157
  Training set accuracy = 0.992800, Test set accuracy = 0.959700
 epoch 14/30. Took 0.58502 seconds. 
  Full-batch training loss = 0.026330, test loss = 0.171429
  Training set accuracy = 0.990400, Test set accuracy = 0.955100
 epoch 15/30. Took 0.57105 seconds. 
  Full-batch training loss = 0.015448, test loss = 0.137464
  Training set accuracy = 0.995600, Test set accuracy = 0.961400
 epoch 16/30. Took 0.57989 seconds. 
  Full-batch training loss = 0.015639, test loss = 0.150562
  Training set accuracy = 0.995500, Test set accuracy = 0.960300
 epoch 17/30. Took 0.59772 seconds. 
  Full-batch training loss = 0.016889, test loss = 0.168743
  Training set accuracy = 0.994900, Test set accuracy = 0.959100
 epoch 18/30. Took 0.58386 seconds. 
  Full-batch training loss = 0.010725, test loss = 0.143594
  Training set accuracy = 0.997100, Test set accuracy = 0.962100
 epoch 19/30. Took 0.58235 seconds. 
  Full-batch training loss = 0.008548, test loss = 0.134060
  Training set accuracy = 0.998000, Test set accuracy = 0.963300
 epoch 20/30. Took 0.58359 seconds. 
  Full-batch training loss = 0.013216, test loss = 0.161337
  Training set accuracy = 0.996600, Test set accuracy = 0.960100
 epoch 21/30. Took 0.58009 seconds. 
  Full-batch training loss = 0.014216, test loss = 0.173534
  Training set accuracy = 0.996000, Test set accuracy = 0.958700
 epoch 22/30. Took 0.58142 seconds. 
  Full-batch training loss = 0.013060, test loss = 0.154910
  Training set accuracy = 0.995600, Test set accuracy = 0.961800
 epoch 23/30. Took 0.58045 seconds. 
  Full-batch training loss = 0.005823, test loss = 0.163093
  Training set accuracy = 0.998100, Test set accuracy = 0.960800
 epoch 24/30. Took 0.58073 seconds. 
  Full-batch training loss = 0.009422, test loss = 0.176519
  Training set accuracy = 0.997400, Test set accuracy = 0.957500
 epoch 25/30. Took 0.62815 seconds. 
  Full-batch training loss = 0.005861, test loss = 0.143911
  Training set accuracy = 0.998500, Test set accuracy = 0.965500
 epoch 26/30. Took 0.59932 seconds. 
  Full-batch training loss = 0.004632, test loss = 0.160436
  Training set accuracy = 0.999100, Test set accuracy = 0.962000
 epoch 27/30. Took 0.57418 seconds. 
  Full-batch training loss = 0.004081, test loss = 0.154662
  Training set accuracy = 0.999100, Test set accuracy = 0.962700
 epoch 28/30. Took 0.57623 seconds. 
  Full-batch training loss = 0.004266, test loss = 0.154740
  Training set accuracy = 0.999000, Test set accuracy = 0.965200
 epoch 29/30. Took 0.57454 seconds. 
  Full-batch training loss = 0.003428, test loss = 0.161841
  Training set accuracy = 0.999100, Test set accuracy = 0.962500
 epoch 30/30. Took 0.57993 seconds. 
  Full-batch training loss = 0.005335, test loss = 0.166612
  Training set accuracy = 0.998300, Test set accuracy = 0.964000
Elapsed time is 30.791309 seconds.
End Training
-----
Params 10000 0.100 0.20 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.7174 seconds. 
  Full-batch training loss = 0.351879, test loss = 0.348101
  Training set accuracy = 0.886400, Test set accuracy = 0.888400
 epoch 2/30. Took 1.6655 seconds. 
  Full-batch training loss = 0.179970, test loss = 0.219434
  Training set accuracy = 0.944900, Test set accuracy = 0.931200
 epoch 3/30. Took 1.7126 seconds. 
  Full-batch training loss = 0.134813, test loss = 0.186026
  Training set accuracy = 0.960300, Test set accuracy = 0.943400
 epoch 4/30. Took 1.7307 seconds. 
  Full-batch training loss = 0.075132, test loss = 0.142507
  Training set accuracy = 0.979800, Test set accuracy = 0.957000
 epoch 5/30. Took 1.6823 seconds. 
  Full-batch training loss = 0.076727, test loss = 0.155051
  Training set accuracy = 0.977900, Test set accuracy = 0.952400
 epoch 6/30. Took 1.7371 seconds. 
  Full-batch training loss = 0.042019, test loss = 0.132759
  Training set accuracy = 0.988200, Test set accuracy = 0.962300
 epoch 7/30. Took 1.6586 seconds. 
  Full-batch training loss = 0.031425, test loss = 0.125173
  Training set accuracy = 0.991700, Test set accuracy = 0.963300
 epoch 8/30. Took 1.7882 seconds. 
  Full-batch training loss = 0.023326, test loss = 0.127310
  Training set accuracy = 0.994400, Test set accuracy = 0.960800
 epoch 9/30. Took 1.7045 seconds. 
  Full-batch training loss = 0.024209, test loss = 0.141718
  Training set accuracy = 0.993200, Test set accuracy = 0.960600
 epoch 10/30. Took 1.6708 seconds. 
  Full-batch training loss = 0.020573, test loss = 0.153284
  Training set accuracy = 0.994000, Test set accuracy = 0.959100
 epoch 11/30. Took 1.66 seconds. 
  Full-batch training loss = 0.014764, test loss = 0.149740
  Training set accuracy = 0.996100, Test set accuracy = 0.961500
 epoch 12/30. Took 1.7012 seconds. 
  Full-batch training loss = 0.011278, test loss = 0.146533
  Training set accuracy = 0.997900, Test set accuracy = 0.961400
 epoch 13/30. Took 1.6872 seconds. 
  Full-batch training loss = 0.005874, test loss = 0.133314
  Training set accuracy = 0.998700, Test set accuracy = 0.967100
 epoch 14/30. Took 1.6955 seconds. 
  Full-batch training loss = 0.009406, test loss = 0.156786
  Training set accuracy = 0.997200, Test set accuracy = 0.960600
 epoch 15/30. Took 1.6904 seconds. 
  Full-batch training loss = 0.003489, test loss = 0.141695
  Training set accuracy = 0.999400, Test set accuracy = 0.966800
 epoch 16/30. Took 1.7494 seconds. 
  Full-batch training loss = 0.007422, test loss = 0.177815
  Training set accuracy = 0.998000, Test set accuracy = 0.958400
 epoch 17/30. Took 1.7015 seconds. 
  Full-batch training loss = 0.004817, test loss = 0.156286
  Training set accuracy = 0.998900, Test set accuracy = 0.963700
 epoch 18/30. Took 1.6871 seconds. 
  Full-batch training loss = 0.010544, test loss = 0.165881
  Training set accuracy = 0.996700, Test set accuracy = 0.961500
 epoch 19/30. Took 1.6713 seconds. 
  Full-batch training loss = 0.005116, test loss = 0.175915
  Training set accuracy = 0.998400, Test set accuracy = 0.961800
 epoch 20/30. Took 1.6667 seconds. 
  Full-batch training loss = 0.002577, test loss = 0.155836
  Training set accuracy = 0.999600, Test set accuracy = 0.965900
 epoch 21/30. Took 1.6579 seconds. 
  Full-batch training loss = 0.001449, test loss = 0.154499
  Training set accuracy = 0.999800, Test set accuracy = 0.966700
 epoch 22/30. Took 1.7572 seconds. 
  Full-batch training loss = 0.012097, test loss = 0.178089
  Training set accuracy = 0.995700, Test set accuracy = 0.958300
 epoch 23/30. Took 1.6798 seconds. 
  Full-batch training loss = 0.005395, test loss = 0.171861
  Training set accuracy = 0.998500, Test set accuracy = 0.962100
 epoch 24/30. Took 1.6634 seconds. 
  Full-batch training loss = 0.001076, test loss = 0.152601
  Training set accuracy = 0.999900, Test set accuracy = 0.967900
 epoch 25/30. Took 1.7604 seconds. 
  Full-batch training loss = 0.001216, test loss = 0.155805
  Training set accuracy = 0.999700, Test set accuracy = 0.966600
 epoch 26/30. Took 1.6588 seconds. 
  Full-batch training loss = 0.001118, test loss = 0.160703
  Training set accuracy = 0.999800, Test set accuracy = 0.968500
 epoch 27/30. Took 1.6929 seconds. 
  Full-batch training loss = 0.001008, test loss = 0.157240
  Training set accuracy = 0.999800, Test set accuracy = 0.968400
 epoch 28/30. Took 1.6831 seconds. 
  Full-batch training loss = 0.001787, test loss = 0.155979
  Training set accuracy = 0.999500, Test set accuracy = 0.969700
 epoch 29/30. Took 1.6988 seconds. 
  Full-batch training loss = 0.001272, test loss = 0.167889
  Training set accuracy = 0.999500, Test set accuracy = 0.966900
 epoch 30/30. Took 1.6819 seconds. 
  Full-batch training loss = 0.001924, test loss = 0.177049
  Training set accuracy = 0.999400, Test set accuracy = 0.964300
Elapsed time is 86.766872 seconds.
End Training
-----
Params 10000 0.100 0.30 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23661 seconds. 
  Full-batch training loss = 0.370654, test loss = 0.372517
  Training set accuracy = 0.895200, Test set accuracy = 0.895500
 epoch 2/30. Took 0.23325 seconds. 
  Full-batch training loss = 0.270455, test loss = 0.282192
  Training set accuracy = 0.923600, Test set accuracy = 0.922800
 epoch 3/30. Took 0.23198 seconds. 
  Full-batch training loss = 0.224096, test loss = 0.257339
  Training set accuracy = 0.936100, Test set accuracy = 0.925300
 epoch 4/30. Took 0.2305 seconds. 
  Full-batch training loss = 0.187620, test loss = 0.222957
  Training set accuracy = 0.947500, Test set accuracy = 0.934000
 epoch 5/30. Took 0.23193 seconds. 
  Full-batch training loss = 0.154650, test loss = 0.199732
  Training set accuracy = 0.958200, Test set accuracy = 0.941100
 epoch 6/30. Took 0.23579 seconds. 
  Full-batch training loss = 0.138602, test loss = 0.191784
  Training set accuracy = 0.961400, Test set accuracy = 0.943000
 epoch 7/30. Took 0.23095 seconds. 
  Full-batch training loss = 0.123333, test loss = 0.186246
  Training set accuracy = 0.964500, Test set accuracy = 0.942700
 epoch 8/30. Took 0.23204 seconds. 
  Full-batch training loss = 0.111063, test loss = 0.175622
  Training set accuracy = 0.970200, Test set accuracy = 0.947400
 epoch 9/30. Took 0.23822 seconds. 
  Full-batch training loss = 0.092203, test loss = 0.165569
  Training set accuracy = 0.977000, Test set accuracy = 0.951500
 epoch 10/30. Took 0.23556 seconds. 
  Full-batch training loss = 0.082399, test loss = 0.159915
  Training set accuracy = 0.979400, Test set accuracy = 0.952600
 epoch 11/30. Took 0.22947 seconds. 
  Full-batch training loss = 0.076074, test loss = 0.158012
  Training set accuracy = 0.980900, Test set accuracy = 0.952300
 epoch 12/30. Took 0.23071 seconds. 
  Full-batch training loss = 0.070516, test loss = 0.151112
  Training set accuracy = 0.982000, Test set accuracy = 0.955500
 epoch 13/30. Took 0.23014 seconds. 
  Full-batch training loss = 0.061240, test loss = 0.144689
  Training set accuracy = 0.985800, Test set accuracy = 0.957300
 epoch 14/30. Took 0.22817 seconds. 
  Full-batch training loss = 0.053404, test loss = 0.142453
  Training set accuracy = 0.987100, Test set accuracy = 0.959100
 epoch 15/30. Took 0.22872 seconds. 
  Full-batch training loss = 0.050747, test loss = 0.145862
  Training set accuracy = 0.988700, Test set accuracy = 0.957800
 epoch 16/30. Took 0.23127 seconds. 
  Full-batch training loss = 0.044240, test loss = 0.141564
  Training set accuracy = 0.990100, Test set accuracy = 0.959000
 epoch 17/30. Took 0.23036 seconds. 
  Full-batch training loss = 0.044527, test loss = 0.146872
  Training set accuracy = 0.989800, Test set accuracy = 0.956900
 epoch 18/30. Took 0.24197 seconds. 
  Full-batch training loss = 0.038527, test loss = 0.146734
  Training set accuracy = 0.991500, Test set accuracy = 0.958100
 epoch 19/30. Took 0.22973 seconds. 
  Full-batch training loss = 0.034190, test loss = 0.139483
  Training set accuracy = 0.992700, Test set accuracy = 0.960400
 epoch 20/30. Took 0.23499 seconds. 
  Full-batch training loss = 0.031532, test loss = 0.146362
  Training set accuracy = 0.993500, Test set accuracy = 0.957800
 epoch 21/30. Took 0.23036 seconds. 
  Full-batch training loss = 0.029427, test loss = 0.142461
  Training set accuracy = 0.993700, Test set accuracy = 0.957400
 epoch 22/30. Took 0.23669 seconds. 
  Full-batch training loss = 0.025452, test loss = 0.139073
  Training set accuracy = 0.995100, Test set accuracy = 0.960300
 epoch 23/30. Took 0.23131 seconds. 
  Full-batch training loss = 0.028127, test loss = 0.144402
  Training set accuracy = 0.994900, Test set accuracy = 0.957500
 epoch 24/30. Took 0.23146 seconds. 
  Full-batch training loss = 0.023507, test loss = 0.138641
  Training set accuracy = 0.996600, Test set accuracy = 0.959200
 epoch 25/30. Took 0.22625 seconds. 
  Full-batch training loss = 0.019441, test loss = 0.133458
  Training set accuracy = 0.997200, Test set accuracy = 0.961800
 epoch 26/30. Took 0.23198 seconds. 
  Full-batch training loss = 0.019751, test loss = 0.139774
  Training set accuracy = 0.996700, Test set accuracy = 0.960100
 epoch 27/30. Took 0.23083 seconds. 
  Full-batch training loss = 0.020508, test loss = 0.145536
  Training set accuracy = 0.997100, Test set accuracy = 0.958000
 epoch 28/30. Took 0.24033 seconds. 
  Full-batch training loss = 0.017077, test loss = 0.139971
  Training set accuracy = 0.997500, Test set accuracy = 0.961900
 epoch 29/30. Took 0.22815 seconds. 
  Full-batch training loss = 0.014605, test loss = 0.139293
  Training set accuracy = 0.998000, Test set accuracy = 0.962500
 epoch 30/30. Took 0.23071 seconds. 
  Full-batch training loss = 0.014327, test loss = 0.141073
  Training set accuracy = 0.998000, Test set accuracy = 0.961900
Elapsed time is 13.362101 seconds.
End Training
-----
Params 10000 0.100 0.30 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35418 seconds. 
  Full-batch training loss = 0.336562, test loss = 0.339496
  Training set accuracy = 0.903500, Test set accuracy = 0.904500
 epoch 2/30. Took 0.34526 seconds. 
  Full-batch training loss = 0.249109, test loss = 0.276395
  Training set accuracy = 0.929800, Test set accuracy = 0.917700
 epoch 3/30. Took 0.35221 seconds. 
  Full-batch training loss = 0.197707, test loss = 0.232092
  Training set accuracy = 0.943500, Test set accuracy = 0.931000
 epoch 4/30. Took 0.34963 seconds. 
  Full-batch training loss = 0.162838, test loss = 0.206286
  Training set accuracy = 0.954200, Test set accuracy = 0.938600
 epoch 5/30. Took 0.35229 seconds. 
  Full-batch training loss = 0.141867, test loss = 0.200274
  Training set accuracy = 0.961400, Test set accuracy = 0.939100
 epoch 6/30. Took 0.34946 seconds. 
  Full-batch training loss = 0.123646, test loss = 0.180683
  Training set accuracy = 0.967200, Test set accuracy = 0.944600
 epoch 7/30. Took 0.35236 seconds. 
  Full-batch training loss = 0.102384, test loss = 0.163562
  Training set accuracy = 0.973300, Test set accuracy = 0.949300
 epoch 8/30. Took 0.35331 seconds. 
  Full-batch training loss = 0.093521, test loss = 0.160471
  Training set accuracy = 0.975300, Test set accuracy = 0.951400
 epoch 9/30. Took 0.36783 seconds. 
  Full-batch training loss = 0.074922, test loss = 0.149818
  Training set accuracy = 0.981500, Test set accuracy = 0.955200
 epoch 10/30. Took 0.34869 seconds. 
  Full-batch training loss = 0.068654, test loss = 0.145909
  Training set accuracy = 0.982700, Test set accuracy = 0.957000
 epoch 11/30. Took 0.36003 seconds. 
  Full-batch training loss = 0.059170, test loss = 0.142282
  Training set accuracy = 0.984900, Test set accuracy = 0.958400
 epoch 12/30. Took 0.35309 seconds. 
  Full-batch training loss = 0.052564, test loss = 0.140625
  Training set accuracy = 0.988000, Test set accuracy = 0.958100
 epoch 13/30. Took 0.35403 seconds. 
  Full-batch training loss = 0.046322, test loss = 0.136124
  Training set accuracy = 0.990600, Test set accuracy = 0.959800
 epoch 14/30. Took 0.34818 seconds. 
  Full-batch training loss = 0.041478, test loss = 0.131847
  Training set accuracy = 0.990800, Test set accuracy = 0.961300
 epoch 15/30. Took 0.3496 seconds. 
  Full-batch training loss = 0.037338, test loss = 0.135399
  Training set accuracy = 0.992600, Test set accuracy = 0.959900
 epoch 16/30. Took 0.34598 seconds. 
  Full-batch training loss = 0.035162, test loss = 0.132243
  Training set accuracy = 0.992500, Test set accuracy = 0.960100
 epoch 17/30. Took 0.35168 seconds. 
  Full-batch training loss = 0.031005, test loss = 0.130073
  Training set accuracy = 0.994100, Test set accuracy = 0.961200
 epoch 18/30. Took 0.35635 seconds. 
  Full-batch training loss = 0.026675, test loss = 0.128640
  Training set accuracy = 0.994700, Test set accuracy = 0.963000
 epoch 19/30. Took 0.35075 seconds. 
  Full-batch training loss = 0.023884, test loss = 0.125445
  Training set accuracy = 0.996000, Test set accuracy = 0.963100
 epoch 20/30. Took 0.35074 seconds. 
  Full-batch training loss = 0.020727, test loss = 0.123957
  Training set accuracy = 0.996900, Test set accuracy = 0.963400
 epoch 21/30. Took 0.3515 seconds. 
  Full-batch training loss = 0.019026, test loss = 0.122367
  Training set accuracy = 0.997300, Test set accuracy = 0.964600
 epoch 22/30. Took 0.35037 seconds. 
  Full-batch training loss = 0.018120, test loss = 0.124384
  Training set accuracy = 0.997900, Test set accuracy = 0.963300
 epoch 23/30. Took 0.35121 seconds. 
  Full-batch training loss = 0.017417, test loss = 0.127451
  Training set accuracy = 0.997800, Test set accuracy = 0.963600
 epoch 24/30. Took 0.37026 seconds. 
  Full-batch training loss = 0.014974, test loss = 0.129758
  Training set accuracy = 0.998300, Test set accuracy = 0.962000
 epoch 25/30. Took 0.35054 seconds. 
  Full-batch training loss = 0.014084, test loss = 0.125508
  Training set accuracy = 0.998500, Test set accuracy = 0.964700
 epoch 26/30. Took 0.34924 seconds. 
  Full-batch training loss = 0.012349, test loss = 0.124071
  Training set accuracy = 0.999000, Test set accuracy = 0.965100
 epoch 27/30. Took 0.35169 seconds. 
  Full-batch training loss = 0.012289, test loss = 0.122122
  Training set accuracy = 0.999200, Test set accuracy = 0.965200
 epoch 28/30. Took 0.35011 seconds. 
  Full-batch training loss = 0.010519, test loss = 0.125440
  Training set accuracy = 0.999400, Test set accuracy = 0.964000
 epoch 29/30. Took 0.35162 seconds. 
  Full-batch training loss = 0.010353, test loss = 0.125248
  Training set accuracy = 0.999300, Test set accuracy = 0.964000
 epoch 30/30. Took 0.34952 seconds. 
  Full-batch training loss = 0.009651, test loss = 0.124410
  Training set accuracy = 0.999100, Test set accuracy = 0.964900
Elapsed time is 19.260293 seconds.
End Training
-----
Params 10000 0.100 0.30 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.73223 seconds. 
  Full-batch training loss = 0.324194, test loss = 0.331303
  Training set accuracy = 0.911000, Test set accuracy = 0.904900
 epoch 2/30. Took 0.73212 seconds. 
  Full-batch training loss = 0.239643, test loss = 0.268483
  Training set accuracy = 0.931800, Test set accuracy = 0.920900
 epoch 3/30. Took 0.73033 seconds. 
  Full-batch training loss = 0.197798, test loss = 0.240244
  Training set accuracy = 0.942300, Test set accuracy = 0.926300
 epoch 4/30. Took 0.78365 seconds. 
  Full-batch training loss = 0.156255, test loss = 0.205246
  Training set accuracy = 0.959000, Test set accuracy = 0.939900
 epoch 5/30. Took 0.74237 seconds. 
  Full-batch training loss = 0.127266, test loss = 0.183400
  Training set accuracy = 0.968300, Test set accuracy = 0.945400
 epoch 6/30. Took 0.81131 seconds. 
  Full-batch training loss = 0.103620, test loss = 0.168304
  Training set accuracy = 0.973800, Test set accuracy = 0.950100
 epoch 7/30. Took 0.7268 seconds. 
  Full-batch training loss = 0.089885, test loss = 0.161232
  Training set accuracy = 0.976900, Test set accuracy = 0.952200
 epoch 8/30. Took 0.75178 seconds. 
  Full-batch training loss = 0.078867, test loss = 0.151635
  Training set accuracy = 0.982000, Test set accuracy = 0.953900
 epoch 9/30. Took 0.77347 seconds. 
  Full-batch training loss = 0.064004, test loss = 0.141304
  Training set accuracy = 0.986100, Test set accuracy = 0.957100
 epoch 10/30. Took 0.73024 seconds. 
  Full-batch training loss = 0.056273, test loss = 0.141605
  Training set accuracy = 0.987200, Test set accuracy = 0.957800
 epoch 11/30. Took 0.72757 seconds. 
  Full-batch training loss = 0.049635, test loss = 0.137084
  Training set accuracy = 0.989200, Test set accuracy = 0.957500
 epoch 12/30. Took 0.73352 seconds. 
  Full-batch training loss = 0.041613, test loss = 0.129817
  Training set accuracy = 0.991600, Test set accuracy = 0.962000
 epoch 13/30. Took 0.75377 seconds. 
  Full-batch training loss = 0.037786, test loss = 0.129896
  Training set accuracy = 0.993000, Test set accuracy = 0.960500
 epoch 14/30. Took 0.72808 seconds. 
  Full-batch training loss = 0.032171, test loss = 0.127808
  Training set accuracy = 0.994400, Test set accuracy = 0.960500
 epoch 15/30. Took 0.72846 seconds. 
  Full-batch training loss = 0.027867, test loss = 0.123485
  Training set accuracy = 0.995800, Test set accuracy = 0.961800
 epoch 16/30. Took 0.7391 seconds. 
  Full-batch training loss = 0.026156, test loss = 0.123592
  Training set accuracy = 0.996900, Test set accuracy = 0.961900
 epoch 17/30. Took 0.72839 seconds. 
  Full-batch training loss = 0.021004, test loss = 0.122655
  Training set accuracy = 0.997800, Test set accuracy = 0.962900
 epoch 18/30. Took 0.73017 seconds. 
  Full-batch training loss = 0.018137, test loss = 0.119447
  Training set accuracy = 0.998000, Test set accuracy = 0.964300
 epoch 19/30. Took 0.74184 seconds. 
  Full-batch training loss = 0.017909, test loss = 0.122722
  Training set accuracy = 0.998300, Test set accuracy = 0.963900
 epoch 20/30. Took 0.72965 seconds. 
  Full-batch training loss = 0.016091, test loss = 0.122524
  Training set accuracy = 0.998000, Test set accuracy = 0.963600
 epoch 21/30. Took 0.74557 seconds. 
  Full-batch training loss = 0.013091, test loss = 0.122647
  Training set accuracy = 0.999400, Test set accuracy = 0.962800
 epoch 22/30. Took 0.75357 seconds. 
  Full-batch training loss = 0.012441, test loss = 0.122620
  Training set accuracy = 0.999500, Test set accuracy = 0.963100
 epoch 23/30. Took 0.7369 seconds. 
  Full-batch training loss = 0.011401, test loss = 0.123135
  Training set accuracy = 0.999600, Test set accuracy = 0.963100
 epoch 24/30. Took 0.76432 seconds. 
  Full-batch training loss = 0.009853, test loss = 0.118380
  Training set accuracy = 0.999600, Test set accuracy = 0.966200
 epoch 25/30. Took 0.73438 seconds. 
  Full-batch training loss = 0.009418, test loss = 0.120950
  Training set accuracy = 0.999800, Test set accuracy = 0.965600
 epoch 26/30. Took 0.7291 seconds. 
  Full-batch training loss = 0.008436, test loss = 0.117630
  Training set accuracy = 0.999600, Test set accuracy = 0.964700
 epoch 27/30. Took 0.72836 seconds. 
  Full-batch training loss = 0.007570, test loss = 0.119673
  Training set accuracy = 0.999700, Test set accuracy = 0.965200
 epoch 28/30. Took 0.73195 seconds. 
  Full-batch training loss = 0.006842, test loss = 0.118623
  Training set accuracy = 0.999800, Test set accuracy = 0.965700
 epoch 29/30. Took 0.74424 seconds. 
  Full-batch training loss = 0.006576, test loss = 0.121296
  Training set accuracy = 0.999800, Test set accuracy = 0.965800
 epoch 30/30. Took 0.72772 seconds. 
  Full-batch training loss = 0.005841, test loss = 0.120111
  Training set accuracy = 0.999900, Test set accuracy = 0.966200
Elapsed time is 38.622232 seconds.
End Training
-----
Params 10000 0.100 0.30 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28285 seconds. 
  Full-batch training loss = 0.387433, test loss = 0.386635
  Training set accuracy = 0.887800, Test set accuracy = 0.887400
 epoch 2/30. Took 0.28209 seconds. 
  Full-batch training loss = 0.277373, test loss = 0.298068
  Training set accuracy = 0.916800, Test set accuracy = 0.911500
 epoch 3/30. Took 0.28387 seconds. 
  Full-batch training loss = 0.213460, test loss = 0.243468
  Training set accuracy = 0.936800, Test set accuracy = 0.928100
 epoch 4/30. Took 0.28166 seconds. 
  Full-batch training loss = 0.166806, test loss = 0.209964
  Training set accuracy = 0.950200, Test set accuracy = 0.937400
 epoch 5/30. Took 0.27714 seconds. 
  Full-batch training loss = 0.140504, test loss = 0.195462
  Training set accuracy = 0.958500, Test set accuracy = 0.940700
 epoch 6/30. Took 0.28423 seconds. 
  Full-batch training loss = 0.120141, test loss = 0.184402
  Training set accuracy = 0.963300, Test set accuracy = 0.942900
 epoch 7/30. Took 0.28416 seconds. 
  Full-batch training loss = 0.104462, test loss = 0.182295
  Training set accuracy = 0.967900, Test set accuracy = 0.944800
 epoch 8/30. Took 0.27053 seconds. 
  Full-batch training loss = 0.099638, test loss = 0.185714
  Training set accuracy = 0.968900, Test set accuracy = 0.943000
 epoch 9/30. Took 0.28364 seconds. 
  Full-batch training loss = 0.080978, test loss = 0.170303
  Training set accuracy = 0.974800, Test set accuracy = 0.950700
 epoch 10/30. Took 0.27102 seconds. 
  Full-batch training loss = 0.073632, test loss = 0.170386
  Training set accuracy = 0.978600, Test set accuracy = 0.947900
 epoch 11/30. Took 0.27126 seconds. 
  Full-batch training loss = 0.065840, test loss = 0.170028
  Training set accuracy = 0.980600, Test set accuracy = 0.948600
 epoch 12/30. Took 0.27846 seconds. 
  Full-batch training loss = 0.049091, test loss = 0.156099
  Training set accuracy = 0.986000, Test set accuracy = 0.955800
 epoch 13/30. Took 0.28321 seconds. 
  Full-batch training loss = 0.048748, test loss = 0.151298
  Training set accuracy = 0.985500, Test set accuracy = 0.954800
 epoch 14/30. Took 0.27389 seconds. 
  Full-batch training loss = 0.044191, test loss = 0.156892
  Training set accuracy = 0.987200, Test set accuracy = 0.955800
 epoch 15/30. Took 0.29635 seconds. 
  Full-batch training loss = 0.037942, test loss = 0.159112
  Training set accuracy = 0.988300, Test set accuracy = 0.954700
 epoch 16/30. Took 0.27083 seconds. 
  Full-batch training loss = 0.030394, test loss = 0.145125
  Training set accuracy = 0.992500, Test set accuracy = 0.958500
 epoch 17/30. Took 0.27059 seconds. 
  Full-batch training loss = 0.029696, test loss = 0.149293
  Training set accuracy = 0.992100, Test set accuracy = 0.957700
 epoch 18/30. Took 0.27397 seconds. 
  Full-batch training loss = 0.035203, test loss = 0.164521
  Training set accuracy = 0.989500, Test set accuracy = 0.954900
 epoch 19/30. Took 0.27032 seconds. 
  Full-batch training loss = 0.026444, test loss = 0.151196
  Training set accuracy = 0.993000, Test set accuracy = 0.958000
 epoch 20/30. Took 0.29939 seconds. 
  Full-batch training loss = 0.021090, test loss = 0.152966
  Training set accuracy = 0.995100, Test set accuracy = 0.959100
 epoch 21/30. Took 0.2821 seconds. 
  Full-batch training loss = 0.022349, test loss = 0.160169
  Training set accuracy = 0.994300, Test set accuracy = 0.958000
 epoch 22/30. Took 0.28019 seconds. 
  Full-batch training loss = 0.018653, test loss = 0.166581
  Training set accuracy = 0.995500, Test set accuracy = 0.956000
 epoch 23/30. Took 0.28309 seconds. 
  Full-batch training loss = 0.021399, test loss = 0.171016
  Training set accuracy = 0.993900, Test set accuracy = 0.954200
 epoch 24/30. Took 0.28473 seconds. 
  Full-batch training loss = 0.014568, test loss = 0.149219
  Training set accuracy = 0.996500, Test set accuracy = 0.958800
 epoch 25/30. Took 0.28855 seconds. 
  Full-batch training loss = 0.013431, test loss = 0.150819
  Training set accuracy = 0.997600, Test set accuracy = 0.959600
 epoch 26/30. Took 0.29933 seconds. 
  Full-batch training loss = 0.011598, test loss = 0.160009
  Training set accuracy = 0.997700, Test set accuracy = 0.960200
 epoch 27/30. Took 0.28233 seconds. 
  Full-batch training loss = 0.017172, test loss = 0.161562
  Training set accuracy = 0.995200, Test set accuracy = 0.956600
 epoch 28/30. Took 0.28511 seconds. 
  Full-batch training loss = 0.012686, test loss = 0.171347
  Training set accuracy = 0.997300, Test set accuracy = 0.957700
 epoch 29/30. Took 0.29598 seconds. 
  Full-batch training loss = 0.007941, test loss = 0.149964
  Training set accuracy = 0.998700, Test set accuracy = 0.961600
 epoch 30/30. Took 0.27645 seconds. 
  Full-batch training loss = 0.009098, test loss = 0.155306
  Training set accuracy = 0.998600, Test set accuracy = 0.960000
Elapsed time is 15.686133 seconds.
End Training
-----
Params 10000 0.100 0.30 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.47368 seconds. 
  Full-batch training loss = 0.380507, test loss = 0.383524
  Training set accuracy = 0.886500, Test set accuracy = 0.886800
 epoch 2/30. Took 0.46545 seconds. 
  Full-batch training loss = 0.251660, test loss = 0.281302
  Training set accuracy = 0.923000, Test set accuracy = 0.915000
 epoch 3/30. Took 0.46663 seconds. 
  Full-batch training loss = 0.174349, test loss = 0.216773
  Training set accuracy = 0.947800, Test set accuracy = 0.934800
 epoch 4/30. Took 0.46727 seconds. 
  Full-batch training loss = 0.145840, test loss = 0.203722
  Training set accuracy = 0.956600, Test set accuracy = 0.937100
 epoch 5/30. Took 0.46924 seconds. 
  Full-batch training loss = 0.122966, test loss = 0.192873
  Training set accuracy = 0.962700, Test set accuracy = 0.939000
 epoch 6/30. Took 0.52462 seconds. 
  Full-batch training loss = 0.096346, test loss = 0.168159
  Training set accuracy = 0.970100, Test set accuracy = 0.947600
 epoch 7/30. Took 0.46845 seconds. 
  Full-batch training loss = 0.079914, test loss = 0.163906
  Training set accuracy = 0.978000, Test set accuracy = 0.951700
 epoch 8/30. Took 0.4693 seconds. 
  Full-batch training loss = 0.072571, test loss = 0.164015
  Training set accuracy = 0.979500, Test set accuracy = 0.951000
 epoch 9/30. Took 0.47401 seconds. 
  Full-batch training loss = 0.053941, test loss = 0.145787
  Training set accuracy = 0.985700, Test set accuracy = 0.956300
 epoch 10/30. Took 0.47105 seconds. 
  Full-batch training loss = 0.043013, test loss = 0.137915
  Training set accuracy = 0.989500, Test set accuracy = 0.958000
 epoch 11/30. Took 0.48802 seconds. 
  Full-batch training loss = 0.035248, test loss = 0.136648
  Training set accuracy = 0.991100, Test set accuracy = 0.958800
 epoch 12/30. Took 0.46757 seconds. 
  Full-batch training loss = 0.035939, test loss = 0.141398
  Training set accuracy = 0.991000, Test set accuracy = 0.958700
 epoch 13/30. Took 0.47013 seconds. 
  Full-batch training loss = 0.027706, test loss = 0.141967
  Training set accuracy = 0.993000, Test set accuracy = 0.958700
 epoch 14/30. Took 0.46408 seconds. 
  Full-batch training loss = 0.025988, test loss = 0.132690
  Training set accuracy = 0.993400, Test set accuracy = 0.959900
 epoch 15/30. Took 0.47172 seconds. 
  Full-batch training loss = 0.020645, test loss = 0.138662
  Training set accuracy = 0.994900, Test set accuracy = 0.959900
 epoch 16/30. Took 0.47497 seconds. 
  Full-batch training loss = 0.014623, test loss = 0.133821
  Training set accuracy = 0.996500, Test set accuracy = 0.962900
 epoch 17/30. Took 0.47401 seconds. 
  Full-batch training loss = 0.015728, test loss = 0.137071
  Training set accuracy = 0.996000, Test set accuracy = 0.962200
 epoch 18/30. Took 0.49462 seconds. 
  Full-batch training loss = 0.011497, test loss = 0.141875
  Training set accuracy = 0.997400, Test set accuracy = 0.962500
 epoch 19/30. Took 0.51043 seconds. 
  Full-batch training loss = 0.012335, test loss = 0.135727
  Training set accuracy = 0.997200, Test set accuracy = 0.963800
 epoch 20/30. Took 0.48018 seconds. 
  Full-batch training loss = 0.011110, test loss = 0.128681
  Training set accuracy = 0.998000, Test set accuracy = 0.964600
 epoch 21/30. Took 0.47281 seconds. 
  Full-batch training loss = 0.011440, test loss = 0.140078
  Training set accuracy = 0.997400, Test set accuracy = 0.961300
 epoch 22/30. Took 0.47157 seconds. 
  Full-batch training loss = 0.009217, test loss = 0.137838
  Training set accuracy = 0.997900, Test set accuracy = 0.963300
 epoch 23/30. Took 0.49068 seconds. 
  Full-batch training loss = 0.009449, test loss = 0.142452
  Training set accuracy = 0.998200, Test set accuracy = 0.961900
 epoch 24/30. Took 0.4632 seconds. 
  Full-batch training loss = 0.007940, test loss = 0.151594
  Training set accuracy = 0.998500, Test set accuracy = 0.960600
 epoch 25/30. Took 0.46831 seconds. 
  Full-batch training loss = 0.005689, test loss = 0.137938
  Training set accuracy = 0.999200, Test set accuracy = 0.962900
 epoch 26/30. Took 0.47552 seconds. 
  Full-batch training loss = 0.006181, test loss = 0.147696
  Training set accuracy = 0.998600, Test set accuracy = 0.961500
 epoch 27/30. Took 0.49094 seconds. 
  Full-batch training loss = 0.004013, test loss = 0.136484
  Training set accuracy = 0.999500, Test set accuracy = 0.963500
 epoch 28/30. Took 0.48493 seconds. 
  Full-batch training loss = 0.004249, test loss = 0.140321
  Training set accuracy = 0.999500, Test set accuracy = 0.965700
 epoch 29/30. Took 0.47764 seconds. 
  Full-batch training loss = 0.003613, test loss = 0.139648
  Training set accuracy = 0.999500, Test set accuracy = 0.963600
 epoch 30/30. Took 0.47327 seconds. 
  Full-batch training loss = 0.004137, test loss = 0.139012
  Training set accuracy = 0.999300, Test set accuracy = 0.965600
Elapsed time is 25.182012 seconds.
End Training
-----
Params 10000 0.100 0.30 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2013 seconds. 
  Full-batch training loss = 0.336540, test loss = 0.342179
  Training set accuracy = 0.901100, Test set accuracy = 0.899200
 epoch 2/30. Took 1.224 seconds. 
  Full-batch training loss = 0.217173, test loss = 0.251277
  Training set accuracy = 0.938000, Test set accuracy = 0.923300
 epoch 3/30. Took 1.2323 seconds. 
  Full-batch training loss = 0.167171, test loss = 0.213280
  Training set accuracy = 0.950400, Test set accuracy = 0.933400
 epoch 4/30. Took 1.2174 seconds. 
  Full-batch training loss = 0.124158, test loss = 0.184965
  Training set accuracy = 0.964600, Test set accuracy = 0.944000
 epoch 5/30. Took 1.2973 seconds. 
  Full-batch training loss = 0.092663, test loss = 0.162129
  Training set accuracy = 0.973800, Test set accuracy = 0.949000
 epoch 6/30. Took 1.202 seconds. 
  Full-batch training loss = 0.069097, test loss = 0.140315
  Training set accuracy = 0.981200, Test set accuracy = 0.957300
 epoch 7/30. Took 1.2006 seconds. 
  Full-batch training loss = 0.055693, test loss = 0.135665
  Training set accuracy = 0.984700, Test set accuracy = 0.959100
 epoch 8/30. Took 1.2167 seconds. 
  Full-batch training loss = 0.043810, test loss = 0.127709
  Training set accuracy = 0.989500, Test set accuracy = 0.961000
 epoch 9/30. Took 1.3064 seconds. 
  Full-batch training loss = 0.036293, test loss = 0.134285
  Training set accuracy = 0.991000, Test set accuracy = 0.958800
 epoch 10/30. Took 1.2019 seconds. 
  Full-batch training loss = 0.026026, test loss = 0.121050
  Training set accuracy = 0.993400, Test set accuracy = 0.964600
 epoch 11/30. Took 1.2198 seconds. 
  Full-batch training loss = 0.022039, test loss = 0.128791
  Training set accuracy = 0.996000, Test set accuracy = 0.960700
 epoch 12/30. Took 1.2039 seconds. 
  Full-batch training loss = 0.017833, test loss = 0.124443
  Training set accuracy = 0.996700, Test set accuracy = 0.961900
 epoch 13/30. Took 1.2411 seconds. 
  Full-batch training loss = 0.013773, test loss = 0.121966
  Training set accuracy = 0.997600, Test set accuracy = 0.964600
 epoch 14/30. Took 1.2018 seconds. 
  Full-batch training loss = 0.010064, test loss = 0.125437
  Training set accuracy = 0.999200, Test set accuracy = 0.964000
 epoch 15/30. Took 1.2231 seconds. 
  Full-batch training loss = 0.008076, test loss = 0.128343
  Training set accuracy = 0.998500, Test set accuracy = 0.963800
 epoch 16/30. Took 1.2004 seconds. 
  Full-batch training loss = 0.007311, test loss = 0.129734
  Training set accuracy = 0.999000, Test set accuracy = 0.964300
 epoch 17/30. Took 1.1977 seconds. 
  Full-batch training loss = 0.005510, test loss = 0.127169
  Training set accuracy = 0.999400, Test set accuracy = 0.966100
 epoch 18/30. Took 1.2378 seconds. 
  Full-batch training loss = 0.004720, test loss = 0.128298
  Training set accuracy = 0.999700, Test set accuracy = 0.965200
 epoch 19/30. Took 1.2831 seconds. 
  Full-batch training loss = 0.005174, test loss = 0.127865
  Training set accuracy = 0.999400, Test set accuracy = 0.966600
 epoch 20/30. Took 1.2029 seconds. 
  Full-batch training loss = 0.003517, test loss = 0.121082
  Training set accuracy = 0.999800, Test set accuracy = 0.967200
 epoch 21/30. Took 1.202 seconds. 
  Full-batch training loss = 0.003368, test loss = 0.127008
  Training set accuracy = 1.000000, Test set accuracy = 0.967900
 epoch 22/30. Took 1.2032 seconds. 
  Full-batch training loss = 0.002960, test loss = 0.130324
  Training set accuracy = 0.999800, Test set accuracy = 0.967000
 epoch 23/30. Took 1.229 seconds. 
  Full-batch training loss = 0.002243, test loss = 0.129371
  Training set accuracy = 1.000000, Test set accuracy = 0.968300
 epoch 24/30. Took 1.2028 seconds. 
  Full-batch training loss = 0.001819, test loss = 0.129679
  Training set accuracy = 1.000000, Test set accuracy = 0.968600
 epoch 25/30. Took 1.2471 seconds. 
  Full-batch training loss = 0.001829, test loss = 0.133499
  Training set accuracy = 1.000000, Test set accuracy = 0.966900
 epoch 26/30. Took 1.2123 seconds. 
  Full-batch training loss = 0.001534, test loss = 0.139884
  Training set accuracy = 1.000000, Test set accuracy = 0.966200
 epoch 27/30. Took 1.2006 seconds. 
  Full-batch training loss = 0.001428, test loss = 0.140012
  Training set accuracy = 1.000000, Test set accuracy = 0.966200
 epoch 28/30. Took 1.2031 seconds. 
  Full-batch training loss = 0.001698, test loss = 0.134929
  Training set accuracy = 0.999800, Test set accuracy = 0.966900
 epoch 29/30. Took 1.2081 seconds. 
  Full-batch training loss = 0.001233, test loss = 0.137709
  Training set accuracy = 1.000000, Test set accuracy = 0.966700
 epoch 30/30. Took 1.2019 seconds. 
  Full-batch training loss = 0.000792, test loss = 0.134612
  Training set accuracy = 1.000000, Test set accuracy = 0.968600
Elapsed time is 62.621087 seconds.
End Training
-----
Params 10000 0.100 0.30 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.33378 seconds. 
  Full-batch training loss = 0.533763, test loss = 0.563222
  Training set accuracy = 0.843400, Test set accuracy = 0.828800
 epoch 2/30. Took 0.33648 seconds. 
  Full-batch training loss = 0.301076, test loss = 0.334986
  Training set accuracy = 0.912100, Test set accuracy = 0.899600
 epoch 3/30. Took 0.33706 seconds. 
  Full-batch training loss = 0.219730, test loss = 0.274313
  Training set accuracy = 0.934400, Test set accuracy = 0.920300
 epoch 4/30. Took 0.32652 seconds. 
  Full-batch training loss = 0.172007, test loss = 0.239777
  Training set accuracy = 0.948200, Test set accuracy = 0.927000
 epoch 5/30. Took 0.3637 seconds. 
  Full-batch training loss = 0.146548, test loss = 0.208776
  Training set accuracy = 0.958200, Test set accuracy = 0.939400
 epoch 6/30. Took 0.33851 seconds. 
  Full-batch training loss = 0.130134, test loss = 0.223725
  Training set accuracy = 0.960900, Test set accuracy = 0.935300
 epoch 7/30. Took 0.33857 seconds. 
  Full-batch training loss = 0.111934, test loss = 0.202068
  Training set accuracy = 0.966700, Test set accuracy = 0.940500
 epoch 8/30. Took 0.33782 seconds. 
  Full-batch training loss = 0.090775, test loss = 0.180617
  Training set accuracy = 0.974200, Test set accuracy = 0.947400
 epoch 9/30. Took 0.32473 seconds. 
  Full-batch training loss = 0.077324, test loss = 0.171641
  Training set accuracy = 0.978400, Test set accuracy = 0.949500
 epoch 10/30. Took 0.3343 seconds. 
  Full-batch training loss = 0.067574, test loss = 0.180290
  Training set accuracy = 0.980500, Test set accuracy = 0.950100
 epoch 11/30. Took 0.33783 seconds. 
  Full-batch training loss = 0.072722, test loss = 0.189172
  Training set accuracy = 0.978900, Test set accuracy = 0.949100
 epoch 12/30. Took 0.33722 seconds. 
  Full-batch training loss = 0.062086, test loss = 0.183738
  Training set accuracy = 0.981100, Test set accuracy = 0.950300
 epoch 13/30. Took 0.33839 seconds. 
  Full-batch training loss = 0.050853, test loss = 0.178640
  Training set accuracy = 0.985900, Test set accuracy = 0.951100
 epoch 14/30. Took 0.34765 seconds. 
  Full-batch training loss = 0.045348, test loss = 0.176741
  Training set accuracy = 0.986900, Test set accuracy = 0.952400
 epoch 15/30. Took 0.33644 seconds. 
  Full-batch training loss = 0.044071, test loss = 0.173404
  Training set accuracy = 0.986000, Test set accuracy = 0.952300
 epoch 16/30. Took 0.31775 seconds. 
  Full-batch training loss = 0.037459, test loss = 0.174121
  Training set accuracy = 0.988700, Test set accuracy = 0.953200
 epoch 17/30. Took 0.33753 seconds. 
  Full-batch training loss = 0.036930, test loss = 0.174217
  Training set accuracy = 0.989200, Test set accuracy = 0.953600
 epoch 18/30. Took 0.31603 seconds. 
  Full-batch training loss = 0.029908, test loss = 0.165761
  Training set accuracy = 0.991600, Test set accuracy = 0.954600
 epoch 19/30. Took 0.33706 seconds. 
  Full-batch training loss = 0.029726, test loss = 0.175556
  Training set accuracy = 0.990300, Test set accuracy = 0.956000
 epoch 20/30. Took 0.33773 seconds. 
  Full-batch training loss = 0.029462, test loss = 0.189439
  Training set accuracy = 0.991000, Test set accuracy = 0.953500
 epoch 21/30. Took 0.33864 seconds. 
  Full-batch training loss = 0.025083, test loss = 0.179844
  Training set accuracy = 0.993000, Test set accuracy = 0.954400
 epoch 22/30. Took 0.33689 seconds. 
  Full-batch training loss = 0.021426, test loss = 0.180378
  Training set accuracy = 0.994200, Test set accuracy = 0.954200
 epoch 23/30. Took 0.32524 seconds. 
  Full-batch training loss = 0.021325, test loss = 0.168447
  Training set accuracy = 0.993800, Test set accuracy = 0.956000
 epoch 24/30. Took 0.31955 seconds. 
  Full-batch training loss = 0.017145, test loss = 0.179668
  Training set accuracy = 0.994300, Test set accuracy = 0.957200
 epoch 25/30. Took 0.31541 seconds. 
  Full-batch training loss = 0.019258, test loss = 0.187076
  Training set accuracy = 0.994500, Test set accuracy = 0.955800
 epoch 26/30. Took 0.31725 seconds. 
  Full-batch training loss = 0.032817, test loss = 0.197852
  Training set accuracy = 0.989100, Test set accuracy = 0.951600
 epoch 27/30. Took 0.33127 seconds. 
  Full-batch training loss = 0.019512, test loss = 0.186010
  Training set accuracy = 0.994600, Test set accuracy = 0.957200
 epoch 28/30. Took 0.3425 seconds. 
  Full-batch training loss = 0.018908, test loss = 0.184062
  Training set accuracy = 0.994500, Test set accuracy = 0.955300
 epoch 29/30. Took 0.32894 seconds. 
  Full-batch training loss = 0.011547, test loss = 0.179507
  Training set accuracy = 0.996500, Test set accuracy = 0.957000
 epoch 30/30. Took 0.33093 seconds. 
  Full-batch training loss = 0.013228, test loss = 0.177569
  Training set accuracy = 0.996400, Test set accuracy = 0.957100
Elapsed time is 18.216396 seconds.
End Training
-----
Params 10000 0.100 0.30 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.57432 seconds. 
  Full-batch training loss = 0.422206, test loss = 0.421864
  Training set accuracy = 0.874200, Test set accuracy = 0.873100
 epoch 2/30. Took 0.57445 seconds. 
  Full-batch training loss = 0.262171, test loss = 0.285900
  Training set accuracy = 0.919400, Test set accuracy = 0.912400
 epoch 3/30. Took 0.5596 seconds. 
  Full-batch training loss = 0.190013, test loss = 0.229805
  Training set accuracy = 0.941900, Test set accuracy = 0.927100
 epoch 4/30. Took 0.57757 seconds. 
  Full-batch training loss = 0.167519, test loss = 0.215972
  Training set accuracy = 0.948100, Test set accuracy = 0.934800
 epoch 5/30. Took 0.55858 seconds. 
  Full-batch training loss = 0.109333, test loss = 0.169059
  Training set accuracy = 0.968200, Test set accuracy = 0.948800
 epoch 6/30. Took 0.56246 seconds. 
  Full-batch training loss = 0.098404, test loss = 0.162451
  Training set accuracy = 0.970900, Test set accuracy = 0.948400
 epoch 7/30. Took 0.56316 seconds. 
  Full-batch training loss = 0.073506, test loss = 0.154610
  Training set accuracy = 0.978600, Test set accuracy = 0.951900
 epoch 8/30. Took 0.58504 seconds. 
  Full-batch training loss = 0.073438, test loss = 0.166960
  Training set accuracy = 0.977800, Test set accuracy = 0.949300
 epoch 9/30. Took 0.56297 seconds. 
  Full-batch training loss = 0.058607, test loss = 0.147835
  Training set accuracy = 0.980800, Test set accuracy = 0.956700
 epoch 10/30. Took 0.57084 seconds. 
  Full-batch training loss = 0.058298, test loss = 0.152776
  Training set accuracy = 0.982700, Test set accuracy = 0.955300
 epoch 11/30. Took 0.57786 seconds. 
  Full-batch training loss = 0.050342, test loss = 0.160700
  Training set accuracy = 0.985100, Test set accuracy = 0.952100
 epoch 12/30. Took 0.57207 seconds. 
  Full-batch training loss = 0.037681, test loss = 0.145460
  Training set accuracy = 0.989200, Test set accuracy = 0.959200
 epoch 13/30. Took 0.56668 seconds. 
  Full-batch training loss = 0.028383, test loss = 0.144529
  Training set accuracy = 0.991700, Test set accuracy = 0.959700
 epoch 14/30. Took 0.57815 seconds. 
  Full-batch training loss = 0.024376, test loss = 0.148460
  Training set accuracy = 0.991500, Test set accuracy = 0.959500
 epoch 15/30. Took 0.59219 seconds. 
  Full-batch training loss = 0.025643, test loss = 0.137840
  Training set accuracy = 0.991800, Test set accuracy = 0.962500
 epoch 16/30. Took 0.56943 seconds. 
  Full-batch training loss = 0.023155, test loss = 0.140908
  Training set accuracy = 0.993300, Test set accuracy = 0.961600
 epoch 17/30. Took 0.57036 seconds. 
  Full-batch training loss = 0.021732, test loss = 0.142144
  Training set accuracy = 0.992400, Test set accuracy = 0.961200
 epoch 18/30. Took 0.56913 seconds. 
  Full-batch training loss = 0.015079, test loss = 0.144109
  Training set accuracy = 0.995100, Test set accuracy = 0.962500
 epoch 19/30. Took 0.57818 seconds. 
  Full-batch training loss = 0.015755, test loss = 0.142601
  Training set accuracy = 0.995600, Test set accuracy = 0.962800
 epoch 20/30. Took 0.56027 seconds. 
  Full-batch training loss = 0.016174, test loss = 0.148184
  Training set accuracy = 0.995700, Test set accuracy = 0.960200
 epoch 21/30. Took 0.55535 seconds. 
  Full-batch training loss = 0.016350, test loss = 0.143597
  Training set accuracy = 0.994700, Test set accuracy = 0.961600
 epoch 22/30. Took 0.5981 seconds. 
  Full-batch training loss = 0.010526, test loss = 0.148066
  Training set accuracy = 0.997300, Test set accuracy = 0.962600
 epoch 23/30. Took 0.56137 seconds. 
  Full-batch training loss = 0.012733, test loss = 0.155608
  Training set accuracy = 0.997100, Test set accuracy = 0.960800
 epoch 24/30. Took 0.56951 seconds. 
  Full-batch training loss = 0.008615, test loss = 0.143936
  Training set accuracy = 0.998100, Test set accuracy = 0.964900
 epoch 25/30. Took 0.57973 seconds. 
  Full-batch training loss = 0.008131, test loss = 0.155229
  Training set accuracy = 0.997600, Test set accuracy = 0.963600
 epoch 26/30. Took 0.57255 seconds. 
  Full-batch training loss = 0.006463, test loss = 0.150803
  Training set accuracy = 0.998300, Test set accuracy = 0.964100
 epoch 27/30. Took 0.61048 seconds. 
  Full-batch training loss = 0.006839, test loss = 0.137468
  Training set accuracy = 0.998200, Test set accuracy = 0.965500
 epoch 28/30. Took 0.57156 seconds. 
  Full-batch training loss = 0.006225, test loss = 0.149643
  Training set accuracy = 0.998400, Test set accuracy = 0.965200
 epoch 29/30. Took 0.57166 seconds. 
  Full-batch training loss = 0.007946, test loss = 0.158063
  Training set accuracy = 0.997900, Test set accuracy = 0.963000
 epoch 30/30. Took 0.56283 seconds. 
  Full-batch training loss = 0.004718, test loss = 0.145811
  Training set accuracy = 0.998600, Test set accuracy = 0.965600
Elapsed time is 30.475387 seconds.
End Training
-----
Params 10000 0.100 0.30 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.666 seconds. 
  Full-batch training loss = 0.392229, test loss = 0.397584
  Training set accuracy = 0.883800, Test set accuracy = 0.883600
 epoch 2/30. Took 1.7867 seconds. 
  Full-batch training loss = 0.213071, test loss = 0.245444
  Training set accuracy = 0.936200, Test set accuracy = 0.925100
 epoch 3/30. Took 1.6739 seconds. 
  Full-batch training loss = 0.156778, test loss = 0.208594
  Training set accuracy = 0.954000, Test set accuracy = 0.939100
 epoch 4/30. Took 1.6609 seconds. 
  Full-batch training loss = 0.115895, test loss = 0.181354
  Training set accuracy = 0.964600, Test set accuracy = 0.943500
 epoch 5/30. Took 1.6557 seconds. 
  Full-batch training loss = 0.092107, test loss = 0.169109
  Training set accuracy = 0.971000, Test set accuracy = 0.946300
 epoch 6/30. Took 1.685 seconds. 
  Full-batch training loss = 0.071076, test loss = 0.150932
  Training set accuracy = 0.979000, Test set accuracy = 0.953900
 epoch 7/30. Took 1.706 seconds. 
  Full-batch training loss = 0.046424, test loss = 0.137369
  Training set accuracy = 0.986900, Test set accuracy = 0.959800
 epoch 8/30. Took 1.7723 seconds. 
  Full-batch training loss = 0.039904, test loss = 0.134899
  Training set accuracy = 0.988600, Test set accuracy = 0.960500
 epoch 9/30. Took 1.6695 seconds. 
  Full-batch training loss = 0.035593, test loss = 0.136837
  Training set accuracy = 0.990000, Test set accuracy = 0.958600
 epoch 10/30. Took 1.6928 seconds. 
  Full-batch training loss = 0.028255, test loss = 0.132293
  Training set accuracy = 0.991400, Test set accuracy = 0.960700
 epoch 11/30. Took 1.7025 seconds. 
  Full-batch training loss = 0.022521, test loss = 0.141119
  Training set accuracy = 0.993600, Test set accuracy = 0.959200
 epoch 12/30. Took 1.6625 seconds. 
  Full-batch training loss = 0.016622, test loss = 0.131416
  Training set accuracy = 0.997100, Test set accuracy = 0.960500
 epoch 13/30. Took 1.7024 seconds. 
  Full-batch training loss = 0.019056, test loss = 0.150842
  Training set accuracy = 0.994600, Test set accuracy = 0.958800
 epoch 14/30. Took 1.7012 seconds. 
  Full-batch training loss = 0.015352, test loss = 0.130962
  Training set accuracy = 0.995700, Test set accuracy = 0.962700
 epoch 15/30. Took 1.6845 seconds. 
  Full-batch training loss = 0.010980, test loss = 0.147151
  Training set accuracy = 0.997100, Test set accuracy = 0.961500
 epoch 16/30. Took 1.6827 seconds. 
  Full-batch training loss = 0.010139, test loss = 0.146674
  Training set accuracy = 0.997100, Test set accuracy = 0.962100
 epoch 17/30. Took 1.6943 seconds. 
  Full-batch training loss = 0.005448, test loss = 0.132734
  Training set accuracy = 0.999000, Test set accuracy = 0.966600
 epoch 18/30. Took 1.6919 seconds. 
  Full-batch training loss = 0.009421, test loss = 0.153739
  Training set accuracy = 0.997300, Test set accuracy = 0.961500
 epoch 19/30. Took 1.6568 seconds. 
  Full-batch training loss = 0.005843, test loss = 0.149688
  Training set accuracy = 0.998300, Test set accuracy = 0.965900
 epoch 20/30. Took 1.7179 seconds. 
  Full-batch training loss = 0.005784, test loss = 0.145187
  Training set accuracy = 0.998500, Test set accuracy = 0.964500
 epoch 21/30. Took 1.6707 seconds. 
  Full-batch training loss = 0.004610, test loss = 0.148565
  Training set accuracy = 0.999000, Test set accuracy = 0.964300
 epoch 22/30. Took 1.7553 seconds. 
  Full-batch training loss = 0.010655, test loss = 0.170232
  Training set accuracy = 0.996800, Test set accuracy = 0.960700
 epoch 23/30. Took 1.6985 seconds. 
  Full-batch training loss = 0.003795, test loss = 0.151802
  Training set accuracy = 0.999100, Test set accuracy = 0.965000
 epoch 24/30. Took 1.6635 seconds. 
  Full-batch training loss = 0.002595, test loss = 0.146141
  Training set accuracy = 0.999600, Test set accuracy = 0.965400
 epoch 25/30. Took 1.6853 seconds. 
  Full-batch training loss = 0.002661, test loss = 0.150903
  Training set accuracy = 0.999500, Test set accuracy = 0.965400
 epoch 26/30. Took 1.6659 seconds. 
  Full-batch training loss = 0.002446, test loss = 0.150379
  Training set accuracy = 0.999700, Test set accuracy = 0.966100
 epoch 27/30. Took 1.6972 seconds. 
  Full-batch training loss = 0.001685, test loss = 0.153170
  Training set accuracy = 0.999500, Test set accuracy = 0.964300
 epoch 28/30. Took 1.6837 seconds. 
  Full-batch training loss = 0.001824, test loss = 0.154257
  Training set accuracy = 0.999600, Test set accuracy = 0.966100
 epoch 29/30. Took 1.6944 seconds. 
  Full-batch training loss = 0.001169, test loss = 0.148960
  Training set accuracy = 0.999800, Test set accuracy = 0.967000
 epoch 30/30. Took 1.6935 seconds. 
  Full-batch training loss = 0.001081, test loss = 0.156131
  Training set accuracy = 0.999800, Test set accuracy = 0.966200
Elapsed time is 86.608875 seconds.
End Training
-----
Params 10000 0.100 0.40 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23585 seconds. 
  Full-batch training loss = 0.392414, test loss = 0.381294
  Training set accuracy = 0.891400, Test set accuracy = 0.895800
 epoch 2/30. Took 0.22973 seconds. 
  Full-batch training loss = 0.301335, test loss = 0.305585
  Training set accuracy = 0.913200, Test set accuracy = 0.913500
 epoch 3/30. Took 0.22441 seconds. 
  Full-batch training loss = 0.249642, test loss = 0.263525
  Training set accuracy = 0.931300, Test set accuracy = 0.926000
 epoch 4/30. Took 0.24133 seconds. 
  Full-batch training loss = 0.206315, test loss = 0.225092
  Training set accuracy = 0.943500, Test set accuracy = 0.936600
 epoch 5/30. Took 0.24323 seconds. 
  Full-batch training loss = 0.179608, test loss = 0.207368
  Training set accuracy = 0.950000, Test set accuracy = 0.940800
 epoch 6/30. Took 0.22279 seconds. 
  Full-batch training loss = 0.163692, test loss = 0.198977
  Training set accuracy = 0.954400, Test set accuracy = 0.942400
 epoch 7/30. Took 0.2236 seconds. 
  Full-batch training loss = 0.141647, test loss = 0.184408
  Training set accuracy = 0.961300, Test set accuracy = 0.947300
 epoch 8/30. Took 0.23398 seconds. 
  Full-batch training loss = 0.132004, test loss = 0.176869
  Training set accuracy = 0.964600, Test set accuracy = 0.949700
 epoch 9/30. Took 0.22877 seconds. 
  Full-batch training loss = 0.118835, test loss = 0.173545
  Training set accuracy = 0.967100, Test set accuracy = 0.949400
 epoch 10/30. Took 0.23217 seconds. 
  Full-batch training loss = 0.111684, test loss = 0.172640
  Training set accuracy = 0.968500, Test set accuracy = 0.950000
 epoch 11/30. Took 0.23037 seconds. 
  Full-batch training loss = 0.098744, test loss = 0.162103
  Training set accuracy = 0.973900, Test set accuracy = 0.951800
 epoch 12/30. Took 0.24424 seconds. 
  Full-batch training loss = 0.091448, test loss = 0.158955
  Training set accuracy = 0.975000, Test set accuracy = 0.953800
 epoch 13/30. Took 0.23488 seconds. 
  Full-batch training loss = 0.083524, test loss = 0.155916
  Training set accuracy = 0.978300, Test set accuracy = 0.953400
 epoch 14/30. Took 0.23095 seconds. 
  Full-batch training loss = 0.076330, test loss = 0.151416
  Training set accuracy = 0.980800, Test set accuracy = 0.955100
 epoch 15/30. Took 0.22781 seconds. 
  Full-batch training loss = 0.071074, test loss = 0.148542
  Training set accuracy = 0.981500, Test set accuracy = 0.955300
 epoch 16/30. Took 0.22923 seconds. 
  Full-batch training loss = 0.067105, test loss = 0.148613
  Training set accuracy = 0.982500, Test set accuracy = 0.957000
 epoch 17/30. Took 0.23396 seconds. 
  Full-batch training loss = 0.065002, test loss = 0.152394
  Training set accuracy = 0.983700, Test set accuracy = 0.956000
 epoch 18/30. Took 0.22648 seconds. 
  Full-batch training loss = 0.056720, test loss = 0.142948
  Training set accuracy = 0.987300, Test set accuracy = 0.957400
 epoch 19/30. Took 0.23003 seconds. 
  Full-batch training loss = 0.052835, test loss = 0.144321
  Training set accuracy = 0.986900, Test set accuracy = 0.958200
 epoch 20/30. Took 0.22529 seconds. 
  Full-batch training loss = 0.051695, test loss = 0.145783
  Training set accuracy = 0.987100, Test set accuracy = 0.957600
 epoch 21/30. Took 0.22731 seconds. 
  Full-batch training loss = 0.048427, test loss = 0.144152
  Training set accuracy = 0.988100, Test set accuracy = 0.958000
 epoch 22/30. Took 0.23097 seconds. 
  Full-batch training loss = 0.047808, test loss = 0.144993
  Training set accuracy = 0.987100, Test set accuracy = 0.958100
 epoch 23/30. Took 0.22884 seconds. 
  Full-batch training loss = 0.042037, test loss = 0.144975
  Training set accuracy = 0.990800, Test set accuracy = 0.958000
 epoch 24/30. Took 0.23167 seconds. 
  Full-batch training loss = 0.044339, test loss = 0.146222
  Training set accuracy = 0.988900, Test set accuracy = 0.957300
 epoch 25/30. Took 0.22891 seconds. 
  Full-batch training loss = 0.037256, test loss = 0.139526
  Training set accuracy = 0.992200, Test set accuracy = 0.959900
 epoch 26/30. Took 0.23699 seconds. 
  Full-batch training loss = 0.037559, test loss = 0.149039
  Training set accuracy = 0.991300, Test set accuracy = 0.958600
 epoch 27/30. Took 0.2297 seconds. 
  Full-batch training loss = 0.032868, test loss = 0.142050
  Training set accuracy = 0.991900, Test set accuracy = 0.959000
 epoch 28/30. Took 0.22944 seconds. 
  Full-batch training loss = 0.030157, test loss = 0.138954
  Training set accuracy = 0.994300, Test set accuracy = 0.961100
 epoch 29/30. Took 0.22601 seconds. 
  Full-batch training loss = 0.029373, test loss = 0.140774
  Training set accuracy = 0.994400, Test set accuracy = 0.959500
 epoch 30/30. Took 0.22366 seconds. 
  Full-batch training loss = 0.029278, test loss = 0.145349
  Training set accuracy = 0.994800, Test set accuracy = 0.959800
Elapsed time is 13.320047 seconds.
End Training
-----
Params 10000 0.100 0.40 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35702 seconds. 
  Full-batch training loss = 0.363702, test loss = 0.366903
  Training set accuracy = 0.897900, Test set accuracy = 0.897100
 epoch 2/30. Took 0.36211 seconds. 
  Full-batch training loss = 0.278445, test loss = 0.297240
  Training set accuracy = 0.923300, Test set accuracy = 0.913000
 epoch 3/30. Took 0.36304 seconds. 
  Full-batch training loss = 0.224916, test loss = 0.249023
  Training set accuracy = 0.940200, Test set accuracy = 0.924900
 epoch 4/30. Took 0.36957 seconds. 
  Full-batch training loss = 0.187501, test loss = 0.222842
  Training set accuracy = 0.948000, Test set accuracy = 0.932400
 epoch 5/30. Took 0.36259 seconds. 
  Full-batch training loss = 0.158088, test loss = 0.207045
  Training set accuracy = 0.955500, Test set accuracy = 0.938400
 epoch 6/30. Took 0.36557 seconds. 
  Full-batch training loss = 0.138496, test loss = 0.192321
  Training set accuracy = 0.961600, Test set accuracy = 0.942400
 epoch 7/30. Took 0.36588 seconds. 
  Full-batch training loss = 0.116642, test loss = 0.175654
  Training set accuracy = 0.970600, Test set accuracy = 0.948700
 epoch 8/30. Took 0.36473 seconds. 
  Full-batch training loss = 0.104228, test loss = 0.169324
  Training set accuracy = 0.971600, Test set accuracy = 0.949600
 epoch 9/30. Took 0.36111 seconds. 
  Full-batch training loss = 0.091541, test loss = 0.156878
  Training set accuracy = 0.976400, Test set accuracy = 0.951800
 epoch 10/30. Took 0.36363 seconds. 
  Full-batch training loss = 0.086938, test loss = 0.157559
  Training set accuracy = 0.978500, Test set accuracy = 0.952300
 epoch 11/30. Took 0.36234 seconds. 
  Full-batch training loss = 0.075285, test loss = 0.149653
  Training set accuracy = 0.980300, Test set accuracy = 0.954000
 epoch 12/30. Took 0.36186 seconds. 
  Full-batch training loss = 0.069093, test loss = 0.148772
  Training set accuracy = 0.982800, Test set accuracy = 0.956500
 epoch 13/30. Took 0.36447 seconds. 
  Full-batch training loss = 0.060466, test loss = 0.142305
  Training set accuracy = 0.985400, Test set accuracy = 0.955900
 epoch 14/30. Took 0.36435 seconds. 
  Full-batch training loss = 0.055400, test loss = 0.141343
  Training set accuracy = 0.986700, Test set accuracy = 0.958600
 epoch 15/30. Took 0.3654 seconds. 
  Full-batch training loss = 0.048029, test loss = 0.136161
  Training set accuracy = 0.989600, Test set accuracy = 0.959300
 epoch 16/30. Took 0.36448 seconds. 
  Full-batch training loss = 0.045881, test loss = 0.133684
  Training set accuracy = 0.989400, Test set accuracy = 0.960000
 epoch 17/30. Took 0.36402 seconds. 
  Full-batch training loss = 0.042569, test loss = 0.138322
  Training set accuracy = 0.990700, Test set accuracy = 0.957300
 epoch 18/30. Took 0.36474 seconds. 
  Full-batch training loss = 0.039661, test loss = 0.134350
  Training set accuracy = 0.992200, Test set accuracy = 0.959100
 epoch 19/30. Took 0.36382 seconds. 
  Full-batch training loss = 0.033078, test loss = 0.131433
  Training set accuracy = 0.993100, Test set accuracy = 0.960600
 epoch 20/30. Took 0.36285 seconds. 
  Full-batch training loss = 0.030778, test loss = 0.130139
  Training set accuracy = 0.994000, Test set accuracy = 0.960400
 epoch 21/30. Took 0.36119 seconds. 
  Full-batch training loss = 0.029059, test loss = 0.128834
  Training set accuracy = 0.995200, Test set accuracy = 0.961300
 epoch 22/30. Took 0.37984 seconds. 
  Full-batch training loss = 0.026442, test loss = 0.125894
  Training set accuracy = 0.996800, Test set accuracy = 0.961700
 epoch 23/30. Took 0.36308 seconds. 
  Full-batch training loss = 0.024138, test loss = 0.129116
  Training set accuracy = 0.995700, Test set accuracy = 0.961400
 epoch 24/30. Took 0.36422 seconds. 
  Full-batch training loss = 0.022495, test loss = 0.123625
  Training set accuracy = 0.996300, Test set accuracy = 0.962400
 epoch 25/30. Took 0.3648 seconds. 
  Full-batch training loss = 0.019920, test loss = 0.124827
  Training set accuracy = 0.997700, Test set accuracy = 0.962200
 epoch 26/30. Took 0.38027 seconds. 
  Full-batch training loss = 0.018519, test loss = 0.126370
  Training set accuracy = 0.997700, Test set accuracy = 0.960400
 epoch 27/30. Took 0.36176 seconds. 
  Full-batch training loss = 0.018249, test loss = 0.123713
  Training set accuracy = 0.997800, Test set accuracy = 0.962100
 epoch 28/30. Took 0.36403 seconds. 
  Full-batch training loss = 0.016504, test loss = 0.124802
  Training set accuracy = 0.998300, Test set accuracy = 0.962800
 epoch 29/30. Took 0.38229 seconds. 
  Full-batch training loss = 0.014664, test loss = 0.124460
  Training set accuracy = 0.998500, Test set accuracy = 0.962500
 epoch 30/30. Took 0.36703 seconds. 
  Full-batch training loss = 0.014737, test loss = 0.127983
  Training set accuracy = 0.998400, Test set accuracy = 0.962100
Elapsed time is 19.348810 seconds.
End Training
-----
Params 10000 0.100 0.40 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.75347 seconds. 
  Full-batch training loss = 0.359584, test loss = 0.361018
  Training set accuracy = 0.898200, Test set accuracy = 0.894900
 epoch 2/30. Took 0.74166 seconds. 
  Full-batch training loss = 0.269522, test loss = 0.283691
  Training set accuracy = 0.925100, Test set accuracy = 0.918300
 epoch 3/30. Took 0.72711 seconds. 
  Full-batch training loss = 0.222417, test loss = 0.249310
  Training set accuracy = 0.937400, Test set accuracy = 0.925900
 epoch 4/30. Took 0.74771 seconds. 
  Full-batch training loss = 0.175224, test loss = 0.211895
  Training set accuracy = 0.950200, Test set accuracy = 0.936100
 epoch 5/30. Took 0.75332 seconds. 
  Full-batch training loss = 0.147640, test loss = 0.192511
  Training set accuracy = 0.959900, Test set accuracy = 0.941800
 epoch 6/30. Took 0.76815 seconds. 
  Full-batch training loss = 0.121070, test loss = 0.174054
  Training set accuracy = 0.969200, Test set accuracy = 0.946600
 epoch 7/30. Took 0.7845 seconds. 
  Full-batch training loss = 0.108520, test loss = 0.162560
  Training set accuracy = 0.972300, Test set accuracy = 0.949200
 epoch 8/30. Took 0.72971 seconds. 
  Full-batch training loss = 0.092614, test loss = 0.153886
  Training set accuracy = 0.977500, Test set accuracy = 0.952900
 epoch 9/30. Took 0.73787 seconds. 
  Full-batch training loss = 0.082273, test loss = 0.150601
  Training set accuracy = 0.980100, Test set accuracy = 0.954900
 epoch 10/30. Took 0.73672 seconds. 
  Full-batch training loss = 0.070291, test loss = 0.144378
  Training set accuracy = 0.981900, Test set accuracy = 0.954700
 epoch 11/30. Took 0.72933 seconds. 
  Full-batch training loss = 0.059159, test loss = 0.136542
  Training set accuracy = 0.986100, Test set accuracy = 0.957400
 epoch 12/30. Took 0.74087 seconds. 
  Full-batch training loss = 0.052977, test loss = 0.134587
  Training set accuracy = 0.988100, Test set accuracy = 0.959000
 epoch 13/30. Took 0.7369 seconds. 
  Full-batch training loss = 0.044540, test loss = 0.127861
  Training set accuracy = 0.991000, Test set accuracy = 0.959500
 epoch 14/30. Took 0.75412 seconds. 
  Full-batch training loss = 0.040811, test loss = 0.126935
  Training set accuracy = 0.992700, Test set accuracy = 0.961600
 epoch 15/30. Took 0.72839 seconds. 
  Full-batch training loss = 0.036749, test loss = 0.120383
  Training set accuracy = 0.993700, Test set accuracy = 0.963900
 epoch 16/30. Took 0.73308 seconds. 
  Full-batch training loss = 0.031045, test loss = 0.120498
  Training set accuracy = 0.996200, Test set accuracy = 0.964000
 epoch 17/30. Took 0.73472 seconds. 
  Full-batch training loss = 0.028971, test loss = 0.121727
  Training set accuracy = 0.996400, Test set accuracy = 0.962400
 epoch 18/30. Took 0.75625 seconds. 
  Full-batch training loss = 0.026003, test loss = 0.119584
  Training set accuracy = 0.997000, Test set accuracy = 0.962600
 epoch 19/30. Took 0.73288 seconds. 
  Full-batch training loss = 0.021544, test loss = 0.116270
  Training set accuracy = 0.998100, Test set accuracy = 0.964000
 epoch 20/30. Took 0.73506 seconds. 
  Full-batch training loss = 0.021156, test loss = 0.114997
  Training set accuracy = 0.998200, Test set accuracy = 0.965000
 epoch 21/30. Took 0.77183 seconds. 
  Full-batch training loss = 0.018074, test loss = 0.117403
  Training set accuracy = 0.998800, Test set accuracy = 0.965100
 epoch 22/30. Took 0.72937 seconds. 
  Full-batch training loss = 0.016865, test loss = 0.116733
  Training set accuracy = 0.998700, Test set accuracy = 0.964700
 epoch 23/30. Took 0.72743 seconds. 
  Full-batch training loss = 0.014938, test loss = 0.114546
  Training set accuracy = 0.999200, Test set accuracy = 0.964700
 epoch 24/30. Took 0.72912 seconds. 
  Full-batch training loss = 0.013573, test loss = 0.112604
  Training set accuracy = 0.999300, Test set accuracy = 0.965400
 epoch 25/30. Took 0.7456 seconds. 
  Full-batch training loss = 0.012049, test loss = 0.112279
  Training set accuracy = 0.999800, Test set accuracy = 0.965900
 epoch 26/30. Took 0.73082 seconds. 
  Full-batch training loss = 0.010885, test loss = 0.110590
  Training set accuracy = 0.999700, Test set accuracy = 0.966000
 epoch 27/30. Took 0.76173 seconds. 
  Full-batch training loss = 0.010289, test loss = 0.111830
  Training set accuracy = 0.999800, Test set accuracy = 0.965400
 epoch 28/30. Took 0.74413 seconds. 
  Full-batch training loss = 0.009668, test loss = 0.112236
  Training set accuracy = 0.999800, Test set accuracy = 0.964900
 epoch 29/30. Took 0.73621 seconds. 
  Full-batch training loss = 0.008985, test loss = 0.112409
  Training set accuracy = 0.999800, Test set accuracy = 0.965600
 epoch 30/30. Took 0.72619 seconds. 
  Full-batch training loss = 0.009146, test loss = 0.112459
  Training set accuracy = 0.999900, Test set accuracy = 0.965400
Elapsed time is 38.668034 seconds.
End Training
-----
Params 10000 0.100 0.40 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27875 seconds. 
  Full-batch training loss = 0.460128, test loss = 0.463462
  Training set accuracy = 0.864200, Test set accuracy = 0.865600
 epoch 2/30. Took 0.2704 seconds. 
  Full-batch training loss = 0.305943, test loss = 0.319518
  Training set accuracy = 0.910900, Test set accuracy = 0.905900
 epoch 3/30. Took 0.29794 seconds. 
  Full-batch training loss = 0.244191, test loss = 0.269816
  Training set accuracy = 0.926500, Test set accuracy = 0.921300
 epoch 4/30. Took 0.28482 seconds. 
  Full-batch training loss = 0.204335, test loss = 0.245402
  Training set accuracy = 0.935900, Test set accuracy = 0.924800
 epoch 5/30. Took 0.30122 seconds. 
  Full-batch training loss = 0.170896, test loss = 0.216334
  Training set accuracy = 0.947600, Test set accuracy = 0.935200
 epoch 6/30. Took 0.27986 seconds. 
  Full-batch training loss = 0.151468, test loss = 0.205865
  Training set accuracy = 0.954200, Test set accuracy = 0.938200
 epoch 7/30. Took 0.2834 seconds. 
  Full-batch training loss = 0.130107, test loss = 0.188094
  Training set accuracy = 0.960800, Test set accuracy = 0.943600
 epoch 8/30. Took 0.27151 seconds. 
  Full-batch training loss = 0.119676, test loss = 0.186829
  Training set accuracy = 0.965200, Test set accuracy = 0.944800
 epoch 9/30. Took 0.27661 seconds. 
  Full-batch training loss = 0.102483, test loss = 0.173833
  Training set accuracy = 0.968900, Test set accuracy = 0.946600
 epoch 10/30. Took 0.2827 seconds. 
  Full-batch training loss = 0.093858, test loss = 0.171749
  Training set accuracy = 0.973000, Test set accuracy = 0.948200
 epoch 11/30. Took 0.27096 seconds. 
  Full-batch training loss = 0.088354, test loss = 0.168944
  Training set accuracy = 0.976900, Test set accuracy = 0.949400
 epoch 12/30. Took 0.27578 seconds. 
  Full-batch training loss = 0.078085, test loss = 0.160307
  Training set accuracy = 0.978500, Test set accuracy = 0.951900
 epoch 13/30. Took 0.27957 seconds. 
  Full-batch training loss = 0.071238, test loss = 0.158750
  Training set accuracy = 0.980200, Test set accuracy = 0.953400
 epoch 14/30. Took 0.26984 seconds. 
  Full-batch training loss = 0.078918, test loss = 0.167833
  Training set accuracy = 0.977200, Test set accuracy = 0.949400
 epoch 15/30. Took 0.27145 seconds. 
  Full-batch training loss = 0.065551, test loss = 0.160165
  Training set accuracy = 0.982000, Test set accuracy = 0.954000
 epoch 16/30. Took 0.28443 seconds. 
  Full-batch training loss = 0.055093, test loss = 0.145406
  Training set accuracy = 0.985200, Test set accuracy = 0.954700
 epoch 17/30. Took 0.29355 seconds. 
  Full-batch training loss = 0.054950, test loss = 0.161546
  Training set accuracy = 0.983800, Test set accuracy = 0.954800
 epoch 18/30. Took 0.28722 seconds. 
  Full-batch training loss = 0.053738, test loss = 0.166151
  Training set accuracy = 0.984800, Test set accuracy = 0.951300
 epoch 19/30. Took 0.27236 seconds. 
  Full-batch training loss = 0.047420, test loss = 0.158521
  Training set accuracy = 0.987900, Test set accuracy = 0.955700
 epoch 20/30. Took 0.29357 seconds. 
  Full-batch training loss = 0.040675, test loss = 0.151167
  Training set accuracy = 0.989600, Test set accuracy = 0.956200
 epoch 21/30. Took 0.26963 seconds. 
  Full-batch training loss = 0.041242, test loss = 0.155410
  Training set accuracy = 0.988600, Test set accuracy = 0.956700
 epoch 22/30. Took 0.28987 seconds. 
  Full-batch training loss = 0.044592, test loss = 0.167187
  Training set accuracy = 0.987600, Test set accuracy = 0.953500
 epoch 23/30. Took 0.28486 seconds. 
  Full-batch training loss = 0.034835, test loss = 0.151778
  Training set accuracy = 0.990200, Test set accuracy = 0.958500
 epoch 24/30. Took 0.2838 seconds. 
  Full-batch training loss = 0.036367, test loss = 0.156496
  Training set accuracy = 0.989500, Test set accuracy = 0.957200
 epoch 25/30. Took 0.27514 seconds. 
  Full-batch training loss = 0.035044, test loss = 0.157751
  Training set accuracy = 0.989800, Test set accuracy = 0.957800
 epoch 26/30. Took 0.28194 seconds. 
  Full-batch training loss = 0.031668, test loss = 0.157357
  Training set accuracy = 0.990500, Test set accuracy = 0.956000
 epoch 27/30. Took 0.28379 seconds. 
  Full-batch training loss = 0.028536, test loss = 0.147514
  Training set accuracy = 0.992700, Test set accuracy = 0.960500
 epoch 28/30. Took 0.28383 seconds. 
  Full-batch training loss = 0.028283, test loss = 0.153466
  Training set accuracy = 0.991900, Test set accuracy = 0.959400
 epoch 29/30. Took 0.28476 seconds. 
  Full-batch training loss = 0.030453, test loss = 0.162152
  Training set accuracy = 0.991400, Test set accuracy = 0.955700
 epoch 30/30. Took 0.28456 seconds. 
  Full-batch training loss = 0.025350, test loss = 0.158188
  Training set accuracy = 0.993600, Test set accuracy = 0.958700
Elapsed time is 15.728134 seconds.
End Training
-----
Params 10000 0.100 0.40 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.47065 seconds. 
  Full-batch training loss = 0.411246, test loss = 0.404017
  Training set accuracy = 0.885300, Test set accuracy = 0.887900
 epoch 2/30. Took 0.50423 seconds. 
  Full-batch training loss = 0.283109, test loss = 0.291871
  Training set accuracy = 0.916400, Test set accuracy = 0.915400
 epoch 3/30. Took 0.48118 seconds. 
  Full-batch training loss = 0.222386, test loss = 0.251724
  Training set accuracy = 0.933700, Test set accuracy = 0.925400
 epoch 4/30. Took 0.47897 seconds. 
  Full-batch training loss = 0.180604, test loss = 0.216241
  Training set accuracy = 0.944000, Test set accuracy = 0.931700
 epoch 5/30. Took 0.47085 seconds. 
  Full-batch training loss = 0.149716, test loss = 0.193822
  Training set accuracy = 0.954000, Test set accuracy = 0.939600
 epoch 6/30. Took 0.47611 seconds. 
  Full-batch training loss = 0.122364, test loss = 0.177578
  Training set accuracy = 0.962200, Test set accuracy = 0.945200
 epoch 7/30. Took 0.48161 seconds. 
  Full-batch training loss = 0.109733, test loss = 0.171869
  Training set accuracy = 0.968000, Test set accuracy = 0.947000
 epoch 8/30. Took 0.47814 seconds. 
  Full-batch training loss = 0.094681, test loss = 0.160914
  Training set accuracy = 0.973500, Test set accuracy = 0.950500
 epoch 9/30. Took 0.4743 seconds. 
  Full-batch training loss = 0.076648, test loss = 0.146779
  Training set accuracy = 0.977700, Test set accuracy = 0.956100
 epoch 10/30. Took 0.46093 seconds. 
  Full-batch training loss = 0.071498, test loss = 0.148326
  Training set accuracy = 0.977100, Test set accuracy = 0.954400
 epoch 11/30. Took 0.47254 seconds. 
  Full-batch training loss = 0.060150, test loss = 0.142783
  Training set accuracy = 0.983200, Test set accuracy = 0.956900
 epoch 12/30. Took 0.4737 seconds. 
  Full-batch training loss = 0.050811, test loss = 0.141319
  Training set accuracy = 0.985200, Test set accuracy = 0.956700
 epoch 13/30. Took 0.47664 seconds. 
  Full-batch training loss = 0.047542, test loss = 0.139285
  Training set accuracy = 0.987000, Test set accuracy = 0.958800
 epoch 14/30. Took 0.47441 seconds. 
  Full-batch training loss = 0.046528, test loss = 0.139326
  Training set accuracy = 0.985800, Test set accuracy = 0.959700
 epoch 15/30. Took 0.47661 seconds. 
  Full-batch training loss = 0.035482, test loss = 0.132994
  Training set accuracy = 0.989700, Test set accuracy = 0.960700
 epoch 16/30. Took 0.47333 seconds. 
  Full-batch training loss = 0.034722, test loss = 0.132156
  Training set accuracy = 0.992000, Test set accuracy = 0.962100
 epoch 17/30. Took 0.4957 seconds. 
  Full-batch training loss = 0.029940, test loss = 0.132222
  Training set accuracy = 0.992000, Test set accuracy = 0.961000
 epoch 18/30. Took 0.4758 seconds. 
  Full-batch training loss = 0.026485, test loss = 0.128448
  Training set accuracy = 0.993300, Test set accuracy = 0.964600
 epoch 19/30. Took 0.4763 seconds. 
  Full-batch training loss = 0.025383, test loss = 0.130719
  Training set accuracy = 0.994400, Test set accuracy = 0.962500
 epoch 20/30. Took 0.47587 seconds. 
  Full-batch training loss = 0.020150, test loss = 0.130288
  Training set accuracy = 0.995300, Test set accuracy = 0.964200
 epoch 21/30. Took 0.49011 seconds. 
  Full-batch training loss = 0.019418, test loss = 0.129857
  Training set accuracy = 0.996000, Test set accuracy = 0.964800
 epoch 22/30. Took 0.4635 seconds. 
  Full-batch training loss = 0.018224, test loss = 0.127614
  Training set accuracy = 0.995800, Test set accuracy = 0.965300
 epoch 23/30. Took 0.47057 seconds. 
  Full-batch training loss = 0.017225, test loss = 0.136397
  Training set accuracy = 0.996100, Test set accuracy = 0.963400
 epoch 24/30. Took 0.47523 seconds. 
  Full-batch training loss = 0.015399, test loss = 0.128389
  Training set accuracy = 0.996700, Test set accuracy = 0.966100
 epoch 25/30. Took 0.4858 seconds. 
  Full-batch training loss = 0.012513, test loss = 0.128374
  Training set accuracy = 0.997700, Test set accuracy = 0.964200
 epoch 26/30. Took 0.46996 seconds. 
  Full-batch training loss = 0.011474, test loss = 0.121687
  Training set accuracy = 0.997800, Test set accuracy = 0.965800
 epoch 27/30. Took 0.48162 seconds. 
  Full-batch training loss = 0.010287, test loss = 0.130613
  Training set accuracy = 0.998200, Test set accuracy = 0.964400
 epoch 28/30. Took 0.47225 seconds. 
  Full-batch training loss = 0.009601, test loss = 0.133865
  Training set accuracy = 0.998300, Test set accuracy = 0.965900
 epoch 29/30. Took 0.4655 seconds. 
  Full-batch training loss = 0.008605, test loss = 0.136661
  Training set accuracy = 0.998100, Test set accuracy = 0.965400
 epoch 30/30. Took 0.49494 seconds. 
  Full-batch training loss = 0.010784, test loss = 0.148439
  Training set accuracy = 0.997400, Test set accuracy = 0.963300
Elapsed time is 25.151903 seconds.
End Training
-----
Params 10000 0.100 0.40 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.3057 seconds. 
  Full-batch training loss = 0.437682, test loss = 0.431706
  Training set accuracy = 0.864300, Test set accuracy = 0.864900
 epoch 2/30. Took 1.2454 seconds. 
  Full-batch training loss = 0.273339, test loss = 0.276354
  Training set accuracy = 0.916800, Test set accuracy = 0.914800
 epoch 3/30. Took 1.2006 seconds. 
  Full-batch training loss = 0.211222, test loss = 0.233047
  Training set accuracy = 0.938500, Test set accuracy = 0.929800
 epoch 4/30. Took 1.1989 seconds. 
  Full-batch training loss = 0.151662, test loss = 0.187590
  Training set accuracy = 0.957600, Test set accuracy = 0.941300
 epoch 5/30. Took 1.2044 seconds. 
  Full-batch training loss = 0.129291, test loss = 0.176113
  Training set accuracy = 0.963200, Test set accuracy = 0.943600
 epoch 6/30. Took 1.2015 seconds. 
  Full-batch training loss = 0.105154, test loss = 0.158917
  Training set accuracy = 0.971400, Test set accuracy = 0.949700
 epoch 7/30. Took 1.2245 seconds. 
  Full-batch training loss = 0.087302, test loss = 0.146374
  Training set accuracy = 0.975800, Test set accuracy = 0.953000
 epoch 8/30. Took 1.2116 seconds. 
  Full-batch training loss = 0.073266, test loss = 0.142466
  Training set accuracy = 0.978800, Test set accuracy = 0.953100
 epoch 9/30. Took 1.2141 seconds. 
  Full-batch training loss = 0.059961, test loss = 0.131515
  Training set accuracy = 0.984400, Test set accuracy = 0.958900
 epoch 10/30. Took 1.2008 seconds. 
  Full-batch training loss = 0.049103, test loss = 0.129304
  Training set accuracy = 0.985400, Test set accuracy = 0.960100
 epoch 11/30. Took 1.2049 seconds. 
  Full-batch training loss = 0.043851, test loss = 0.133102
  Training set accuracy = 0.988700, Test set accuracy = 0.958300
 epoch 12/30. Took 1.2117 seconds. 
  Full-batch training loss = 0.035789, test loss = 0.124713
  Training set accuracy = 0.991200, Test set accuracy = 0.960800
 epoch 13/30. Took 1.2632 seconds. 
  Full-batch training loss = 0.033319, test loss = 0.127837
  Training set accuracy = 0.992000, Test set accuracy = 0.960400
 epoch 14/30. Took 1.2009 seconds. 
  Full-batch training loss = 0.026851, test loss = 0.127295
  Training set accuracy = 0.994500, Test set accuracy = 0.960800
 epoch 15/30. Took 1.2078 seconds. 
  Full-batch training loss = 0.023951, test loss = 0.126037
  Training set accuracy = 0.994600, Test set accuracy = 0.962100
 epoch 16/30. Took 1.2201 seconds. 
  Full-batch training loss = 0.017247, test loss = 0.117532
  Training set accuracy = 0.996700, Test set accuracy = 0.965300
 epoch 17/30. Took 1.2007 seconds. 
  Full-batch training loss = 0.016218, test loss = 0.124845
  Training set accuracy = 0.997000, Test set accuracy = 0.963000
 epoch 18/30. Took 1.1994 seconds. 
  Full-batch training loss = 0.012670, test loss = 0.120962
  Training set accuracy = 0.998200, Test set accuracy = 0.964300
 epoch 19/30. Took 1.2022 seconds. 
  Full-batch training loss = 0.011788, test loss = 0.120306
  Training set accuracy = 0.997900, Test set accuracy = 0.965300
 epoch 20/30. Took 1.2736 seconds. 
  Full-batch training loss = 0.008875, test loss = 0.120101
  Training set accuracy = 0.998600, Test set accuracy = 0.965300
 epoch 21/30. Took 1.2207 seconds. 
  Full-batch training loss = 0.008136, test loss = 0.118801
  Training set accuracy = 0.998900, Test set accuracy = 0.966300
 epoch 22/30. Took 1.2106 seconds. 
  Full-batch training loss = 0.009188, test loss = 0.124077
  Training set accuracy = 0.998300, Test set accuracy = 0.966800
 epoch 23/30. Took 1.2043 seconds. 
  Full-batch training loss = 0.007658, test loss = 0.126521
  Training set accuracy = 0.998700, Test set accuracy = 0.966000
 epoch 24/30. Took 1.2014 seconds. 
  Full-batch training loss = 0.006020, test loss = 0.123392
  Training set accuracy = 0.998800, Test set accuracy = 0.966500
 epoch 25/30. Took 1.202 seconds. 
  Full-batch training loss = 0.004626, test loss = 0.125110
  Training set accuracy = 0.999600, Test set accuracy = 0.965900
 epoch 26/30. Took 1.4192 seconds. 
  Full-batch training loss = 0.004838, test loss = 0.120690
  Training set accuracy = 0.999500, Test set accuracy = 0.965900
 epoch 27/30. Took 1.2276 seconds. 
  Full-batch training loss = 0.004662, test loss = 0.123487
  Training set accuracy = 0.999500, Test set accuracy = 0.966600
 epoch 28/30. Took 1.1985 seconds. 
  Full-batch training loss = 0.003614, test loss = 0.123881
  Training set accuracy = 0.999900, Test set accuracy = 0.967100
 epoch 29/30. Took 1.206 seconds. 
  Full-batch training loss = 0.002967, test loss = 0.123256
  Training set accuracy = 0.999500, Test set accuracy = 0.967200
 epoch 30/30. Took 1.2012 seconds. 
  Full-batch training loss = 0.002662, test loss = 0.126086
  Training set accuracy = 1.000000, Test set accuracy = 0.967100
Elapsed time is 62.699730 seconds.
End Training
-----
Params 10000 0.100 0.40 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.31897 seconds. 
  Full-batch training loss = 0.660212, test loss = 0.666716
  Training set accuracy = 0.804100, Test set accuracy = 0.802000
 epoch 2/30. Took 0.33976 seconds. 
  Full-batch training loss = 0.370810, test loss = 0.379766
  Training set accuracy = 0.890600, Test set accuracy = 0.887000
 epoch 3/30. Took 0.34102 seconds. 
  Full-batch training loss = 0.291524, test loss = 0.311411
  Training set accuracy = 0.919700, Test set accuracy = 0.910600
 epoch 4/30. Took 0.33815 seconds. 
  Full-batch training loss = 0.242975, test loss = 0.265714
  Training set accuracy = 0.929500, Test set accuracy = 0.922600
 epoch 5/30. Took 0.3569 seconds. 
  Full-batch training loss = 0.203201, test loss = 0.252130
  Training set accuracy = 0.940200, Test set accuracy = 0.924500
 epoch 6/30. Took 0.33926 seconds. 
  Full-batch training loss = 0.175819, test loss = 0.230674
  Training set accuracy = 0.948400, Test set accuracy = 0.929900
 epoch 7/30. Took 0.32929 seconds. 
  Full-batch training loss = 0.156534, test loss = 0.216598
  Training set accuracy = 0.955100, Test set accuracy = 0.937700
 epoch 8/30. Took 0.3348 seconds. 
  Full-batch training loss = 0.146845, test loss = 0.211159
  Training set accuracy = 0.955800, Test set accuracy = 0.938200
 epoch 9/30. Took 0.34017 seconds. 
  Full-batch training loss = 0.125722, test loss = 0.198748
  Training set accuracy = 0.962800, Test set accuracy = 0.944100
 epoch 10/30. Took 0.3386 seconds. 
  Full-batch training loss = 0.116075, test loss = 0.193523
  Training set accuracy = 0.965200, Test set accuracy = 0.944600
 epoch 11/30. Took 0.34499 seconds. 
  Full-batch training loss = 0.103137, test loss = 0.187086
  Training set accuracy = 0.971100, Test set accuracy = 0.945500
 epoch 12/30. Took 0.33887 seconds. 
  Full-batch training loss = 0.094626, test loss = 0.194962
  Training set accuracy = 0.971000, Test set accuracy = 0.948000
 epoch 13/30. Took 0.33875 seconds. 
  Full-batch training loss = 0.087669, test loss = 0.185058
  Training set accuracy = 0.975700, Test set accuracy = 0.948300
 epoch 14/30. Took 0.34104 seconds. 
  Full-batch training loss = 0.084987, test loss = 0.181728
  Training set accuracy = 0.975600, Test set accuracy = 0.948400
 epoch 15/30. Took 0.34084 seconds. 
  Full-batch training loss = 0.077912, test loss = 0.183683
  Training set accuracy = 0.976500, Test set accuracy = 0.948500
 epoch 16/30. Took 0.33987 seconds. 
  Full-batch training loss = 0.073569, test loss = 0.173607
  Training set accuracy = 0.976700, Test set accuracy = 0.948500
 epoch 17/30. Took 0.3398 seconds. 
  Full-batch training loss = 0.062734, test loss = 0.173668
  Training set accuracy = 0.981200, Test set accuracy = 0.954100
 epoch 18/30. Took 0.33897 seconds. 
  Full-batch training loss = 0.067100, test loss = 0.181493
  Training set accuracy = 0.979700, Test set accuracy = 0.953300
 epoch 19/30. Took 0.34006 seconds. 
  Full-batch training loss = 0.062628, test loss = 0.192456
  Training set accuracy = 0.980100, Test set accuracy = 0.949200
 epoch 20/30. Took 0.32751 seconds. 
  Full-batch training loss = 0.054800, test loss = 0.187979
  Training set accuracy = 0.984100, Test set accuracy = 0.951400
 epoch 21/30. Took 0.33378 seconds. 
  Full-batch training loss = 0.049158, test loss = 0.168136
  Training set accuracy = 0.986100, Test set accuracy = 0.955200
 epoch 22/30. Took 0.34166 seconds. 
  Full-batch training loss = 0.050582, test loss = 0.168490
  Training set accuracy = 0.984300, Test set accuracy = 0.955900
 epoch 23/30. Took 0.33293 seconds. 
  Full-batch training loss = 0.051033, test loss = 0.186612
  Training set accuracy = 0.983400, Test set accuracy = 0.953400
 epoch 24/30. Took 0.32506 seconds. 
  Full-batch training loss = 0.042407, test loss = 0.175297
  Training set accuracy = 0.987700, Test set accuracy = 0.955700
 epoch 25/30. Took 0.3387 seconds. 
  Full-batch training loss = 0.041114, test loss = 0.175152
  Training set accuracy = 0.989200, Test set accuracy = 0.954900
 epoch 26/30. Took 0.34078 seconds. 
  Full-batch training loss = 0.042130, test loss = 0.182208
  Training set accuracy = 0.987700, Test set accuracy = 0.955700
 epoch 27/30. Took 0.32099 seconds. 
  Full-batch training loss = 0.037189, test loss = 0.176917
  Training set accuracy = 0.989500, Test set accuracy = 0.958800
 epoch 28/30. Took 0.32614 seconds. 
  Full-batch training loss = 0.034386, test loss = 0.177413
  Training set accuracy = 0.989200, Test set accuracy = 0.958300
 epoch 29/30. Took 0.33708 seconds. 
  Full-batch training loss = 0.039649, test loss = 0.180840
  Training set accuracy = 0.987800, Test set accuracy = 0.954100
 epoch 30/30. Took 0.33902 seconds. 
  Full-batch training loss = 0.035287, test loss = 0.174142
  Training set accuracy = 0.990000, Test set accuracy = 0.955500
Elapsed time is 18.306315 seconds.
End Training
-----
Params 10000 0.100 0.40 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.57293 seconds. 
  Full-batch training loss = 0.592139, test loss = 0.585812
  Training set accuracy = 0.814400, Test set accuracy = 0.816500
 epoch 2/30. Took 0.56994 seconds. 
  Full-batch training loss = 0.337888, test loss = 0.342839
  Training set accuracy = 0.902100, Test set accuracy = 0.901700
 epoch 3/30. Took 0.58249 seconds. 
  Full-batch training loss = 0.235529, test loss = 0.265906
  Training set accuracy = 0.926700, Test set accuracy = 0.919500
 epoch 4/30. Took 0.5799 seconds. 
  Full-batch training loss = 0.206165, test loss = 0.255907
  Training set accuracy = 0.936100, Test set accuracy = 0.920500
 epoch 5/30. Took 0.57982 seconds. 
  Full-batch training loss = 0.156563, test loss = 0.217156
  Training set accuracy = 0.951100, Test set accuracy = 0.937300
 epoch 6/30. Took 0.57917 seconds. 
  Full-batch training loss = 0.125338, test loss = 0.191260
  Training set accuracy = 0.961000, Test set accuracy = 0.943700
 epoch 7/30. Took 0.60071 seconds. 
  Full-batch training loss = 0.113702, test loss = 0.189418
  Training set accuracy = 0.966800, Test set accuracy = 0.946000
 epoch 8/30. Took 0.57206 seconds. 
  Full-batch training loss = 0.097831, test loss = 0.176244
  Training set accuracy = 0.969400, Test set accuracy = 0.947700
 epoch 9/30. Took 0.60173 seconds. 
  Full-batch training loss = 0.084808, test loss = 0.174731
  Training set accuracy = 0.974100, Test set accuracy = 0.950300
 epoch 10/30. Took 0.57135 seconds. 
  Full-batch training loss = 0.072457, test loss = 0.166429
  Training set accuracy = 0.976800, Test set accuracy = 0.950000
 epoch 11/30. Took 0.57755 seconds. 
  Full-batch training loss = 0.068584, test loss = 0.161371
  Training set accuracy = 0.977600, Test set accuracy = 0.952400
 epoch 12/30. Took 0.57914 seconds. 
  Full-batch training loss = 0.062712, test loss = 0.169431
  Training set accuracy = 0.980300, Test set accuracy = 0.952000
 epoch 13/30. Took 0.59956 seconds. 
  Full-batch training loss = 0.053336, test loss = 0.153823
  Training set accuracy = 0.984200, Test set accuracy = 0.954700
 epoch 14/30. Took 0.57981 seconds. 
  Full-batch training loss = 0.050193, test loss = 0.155756
  Training set accuracy = 0.984900, Test set accuracy = 0.954700
 epoch 15/30. Took 0.62075 seconds. 
  Full-batch training loss = 0.043449, test loss = 0.154558
  Training set accuracy = 0.986500, Test set accuracy = 0.956000
 epoch 16/30. Took 0.58916 seconds. 
  Full-batch training loss = 0.033187, test loss = 0.154310
  Training set accuracy = 0.990600, Test set accuracy = 0.958500
 epoch 17/30. Took 0.57692 seconds. 
  Full-batch training loss = 0.028272, test loss = 0.147724
  Training set accuracy = 0.991600, Test set accuracy = 0.960600
 epoch 18/30. Took 0.58157 seconds. 
  Full-batch training loss = 0.030972, test loss = 0.151129
  Training set accuracy = 0.991000, Test set accuracy = 0.957600
 epoch 19/30. Took 0.5974 seconds. 
  Full-batch training loss = 0.026935, test loss = 0.154034
  Training set accuracy = 0.992200, Test set accuracy = 0.960500
 epoch 20/30. Took 0.56536 seconds. 
  Full-batch training loss = 0.023845, test loss = 0.156188
  Training set accuracy = 0.993200, Test set accuracy = 0.959800
 epoch 21/30. Took 0.57743 seconds. 
  Full-batch training loss = 0.025829, test loss = 0.157970
  Training set accuracy = 0.992900, Test set accuracy = 0.959600
 epoch 22/30. Took 0.55953 seconds. 
  Full-batch training loss = 0.018256, test loss = 0.156716
  Training set accuracy = 0.994500, Test set accuracy = 0.959900
 epoch 23/30. Took 0.57732 seconds. 
  Full-batch training loss = 0.021036, test loss = 0.153062
  Training set accuracy = 0.994100, Test set accuracy = 0.960300
 epoch 24/30. Took 0.58276 seconds. 
  Full-batch training loss = 0.017196, test loss = 0.165255
  Training set accuracy = 0.994600, Test set accuracy = 0.958800
 epoch 25/30. Took 0.58913 seconds. 
  Full-batch training loss = 0.013693, test loss = 0.156093
  Training set accuracy = 0.996700, Test set accuracy = 0.961500
 epoch 26/30. Took 0.57935 seconds. 
  Full-batch training loss = 0.014003, test loss = 0.156118
  Training set accuracy = 0.995900, Test set accuracy = 0.962900
 epoch 27/30. Took 0.57779 seconds. 
  Full-batch training loss = 0.014400, test loss = 0.152685
  Training set accuracy = 0.996000, Test set accuracy = 0.961700
 epoch 28/30. Took 0.56119 seconds. 
  Full-batch training loss = 0.009558, test loss = 0.153199
  Training set accuracy = 0.997700, Test set accuracy = 0.963300
 epoch 29/30. Took 0.57684 seconds. 
  Full-batch training loss = 0.009550, test loss = 0.151259
  Training set accuracy = 0.997900, Test set accuracy = 0.964000
 epoch 30/30. Took 0.57825 seconds. 
  Full-batch training loss = 0.011028, test loss = 0.180863
  Training set accuracy = 0.997000, Test set accuracy = 0.958900
Elapsed time is 30.809911 seconds.
End Training
-----
Params 10000 0.100 0.40 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.6559 seconds. 
  Full-batch training loss = 0.451671, test loss = 0.455829
  Training set accuracy = 0.870300, Test set accuracy = 0.871800
 epoch 2/30. Took 1.6712 seconds. 
  Full-batch training loss = 0.274423, test loss = 0.302199
  Training set accuracy = 0.918900, Test set accuracy = 0.909800
 epoch 3/30. Took 1.6994 seconds. 
  Full-batch training loss = 0.187260, test loss = 0.230745
  Training set accuracy = 0.944700, Test set accuracy = 0.929100
 epoch 4/30. Took 1.7002 seconds. 
  Full-batch training loss = 0.141463, test loss = 0.195822
  Training set accuracy = 0.956100, Test set accuracy = 0.938900
 epoch 5/30. Took 1.6926 seconds. 
  Full-batch training loss = 0.110165, test loss = 0.181705
  Training set accuracy = 0.966400, Test set accuracy = 0.942500
 epoch 6/30. Took 1.7128 seconds. 
  Full-batch training loss = 0.086719, test loss = 0.164991
  Training set accuracy = 0.973500, Test set accuracy = 0.950400
 epoch 7/30. Took 1.6589 seconds. 
  Full-batch training loss = 0.087231, test loss = 0.174503
  Training set accuracy = 0.973200, Test set accuracy = 0.947200
 epoch 8/30. Took 1.683 seconds. 
  Full-batch training loss = 0.062141, test loss = 0.158970
  Training set accuracy = 0.981100, Test set accuracy = 0.953200
 epoch 9/30. Took 1.6664 seconds. 
  Full-batch training loss = 0.048079, test loss = 0.143994
  Training set accuracy = 0.985800, Test set accuracy = 0.957400
 epoch 10/30. Took 1.7063 seconds. 
  Full-batch training loss = 0.042177, test loss = 0.144336
  Training set accuracy = 0.988300, Test set accuracy = 0.958400
 epoch 11/30. Took 1.8507 seconds. 
  Full-batch training loss = 0.034700, test loss = 0.142336
  Training set accuracy = 0.991100, Test set accuracy = 0.958900
 epoch 12/30. Took 1.6646 seconds. 
  Full-batch training loss = 0.030020, test loss = 0.144465
  Training set accuracy = 0.992100, Test set accuracy = 0.960400
 epoch 13/30. Took 1.7456 seconds. 
  Full-batch training loss = 0.021936, test loss = 0.138966
  Training set accuracy = 0.994300, Test set accuracy = 0.961800
 epoch 14/30. Took 1.7185 seconds. 
  Full-batch training loss = 0.021795, test loss = 0.147381
  Training set accuracy = 0.993100, Test set accuracy = 0.959200
 epoch 15/30. Took 1.7401 seconds. 
  Full-batch training loss = 0.014482, test loss = 0.142813
  Training set accuracy = 0.996400, Test set accuracy = 0.963100
 epoch 16/30. Took 1.6648 seconds. 
  Full-batch training loss = 0.014163, test loss = 0.146962
  Training set accuracy = 0.996500, Test set accuracy = 0.962200
 epoch 17/30. Took 1.6821 seconds. 
  Full-batch training loss = 0.012991, test loss = 0.145736
  Training set accuracy = 0.996800, Test set accuracy = 0.961700
 epoch 18/30. Took 1.6728 seconds. 
  Full-batch training loss = 0.013242, test loss = 0.141884
  Training set accuracy = 0.996500, Test set accuracy = 0.962100
 epoch 19/30. Took 1.7068 seconds. 
  Full-batch training loss = 0.010163, test loss = 0.150950
  Training set accuracy = 0.997600, Test set accuracy = 0.962200
 epoch 20/30. Took 1.6659 seconds. 
  Full-batch training loss = 0.007989, test loss = 0.151760
  Training set accuracy = 0.998400, Test set accuracy = 0.963800
 epoch 21/30. Took 1.6666 seconds. 
  Full-batch training loss = 0.006740, test loss = 0.141170
  Training set accuracy = 0.997900, Test set accuracy = 0.965000
 epoch 22/30. Took 1.6842 seconds. 
  Full-batch training loss = 0.005248, test loss = 0.137089
  Training set accuracy = 0.998500, Test set accuracy = 0.966200
 epoch 23/30. Took 1.6555 seconds. 
  Full-batch training loss = 0.005114, test loss = 0.155203
  Training set accuracy = 0.998700, Test set accuracy = 0.964300
 epoch 24/30. Took 1.6543 seconds. 
  Full-batch training loss = 0.007247, test loss = 0.150051
  Training set accuracy = 0.998100, Test set accuracy = 0.963800
 epoch 25/30. Took 1.6836 seconds. 
  Full-batch training loss = 0.004320, test loss = 0.147081
  Training set accuracy = 0.999200, Test set accuracy = 0.965000
 epoch 26/30. Took 1.6795 seconds. 
  Full-batch training loss = 0.002780, test loss = 0.147629
  Training set accuracy = 0.999600, Test set accuracy = 0.965700
 epoch 27/30. Took 1.6926 seconds. 
  Full-batch training loss = 0.002828, test loss = 0.140358
  Training set accuracy = 0.999600, Test set accuracy = 0.967900
 epoch 28/30. Took 1.6625 seconds. 
  Full-batch training loss = 0.002145, test loss = 0.145270
  Training set accuracy = 0.999600, Test set accuracy = 0.966000
 epoch 29/30. Took 1.6769 seconds. 
  Full-batch training loss = 0.005687, test loss = 0.170166
  Training set accuracy = 0.998400, Test set accuracy = 0.962300
 epoch 30/30. Took 1.6702 seconds. 
  Full-batch training loss = 0.002997, test loss = 0.151795
  Training set accuracy = 0.999400, Test set accuracy = 0.966100
Elapsed time is 86.528940 seconds.
End Training
-----
Params 10000 0.100 0.50 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.24431 seconds. 
  Full-batch training loss = 0.434229, test loss = 0.417904
  Training set accuracy = 0.881400, Test set accuracy = 0.892200
 epoch 2/30. Took 0.24912 seconds. 
  Full-batch training loss = 0.337744, test loss = 0.334348
  Training set accuracy = 0.902600, Test set accuracy = 0.906500
 epoch 3/30. Took 0.22886 seconds. 
  Full-batch training loss = 0.267194, test loss = 0.278808
  Training set accuracy = 0.923300, Test set accuracy = 0.920100
 epoch 4/30. Took 0.24102 seconds. 
  Full-batch training loss = 0.232266, test loss = 0.251260
  Training set accuracy = 0.934300, Test set accuracy = 0.927400
 epoch 5/30. Took 0.2315 seconds. 
  Full-batch training loss = 0.206212, test loss = 0.233832
  Training set accuracy = 0.941300, Test set accuracy = 0.931000
 epoch 6/30. Took 0.24611 seconds. 
  Full-batch training loss = 0.183918, test loss = 0.219276
  Training set accuracy = 0.946300, Test set accuracy = 0.934800
 epoch 7/30. Took 0.22561 seconds. 
  Full-batch training loss = 0.168756, test loss = 0.206292
  Training set accuracy = 0.952800, Test set accuracy = 0.937000
 epoch 8/30. Took 0.22873 seconds. 
  Full-batch training loss = 0.158050, test loss = 0.199106
  Training set accuracy = 0.955600, Test set accuracy = 0.941600
 epoch 9/30. Took 0.23253 seconds. 
  Full-batch training loss = 0.137400, test loss = 0.188877
  Training set accuracy = 0.961200, Test set accuracy = 0.940700
 epoch 10/30. Took 0.23291 seconds. 
  Full-batch training loss = 0.128876, test loss = 0.183120
  Training set accuracy = 0.963800, Test set accuracy = 0.943800
 epoch 11/30. Took 0.23235 seconds. 
  Full-batch training loss = 0.117463, test loss = 0.177915
  Training set accuracy = 0.966700, Test set accuracy = 0.943500
 epoch 12/30. Took 0.2309 seconds. 
  Full-batch training loss = 0.111857, test loss = 0.175219
  Training set accuracy = 0.969000, Test set accuracy = 0.946900
 epoch 13/30. Took 0.23449 seconds. 
  Full-batch training loss = 0.104246, test loss = 0.169875
  Training set accuracy = 0.971700, Test set accuracy = 0.946500
 epoch 14/30. Took 0.23356 seconds. 
  Full-batch training loss = 0.099080, test loss = 0.164771
  Training set accuracy = 0.973900, Test set accuracy = 0.948700
 epoch 15/30. Took 0.23238 seconds. 
  Full-batch training loss = 0.091236, test loss = 0.159981
  Training set accuracy = 0.977200, Test set accuracy = 0.951400
 epoch 16/30. Took 0.2386 seconds. 
  Full-batch training loss = 0.083669, test loss = 0.156426
  Training set accuracy = 0.978400, Test set accuracy = 0.952500
 epoch 17/30. Took 0.22967 seconds. 
  Full-batch training loss = 0.080809, test loss = 0.156078
  Training set accuracy = 0.979800, Test set accuracy = 0.950300
 epoch 18/30. Took 0.23241 seconds. 
  Full-batch training loss = 0.075533, test loss = 0.153559
  Training set accuracy = 0.981500, Test set accuracy = 0.953000
 epoch 19/30. Took 0.23259 seconds. 
  Full-batch training loss = 0.071569, test loss = 0.153769
  Training set accuracy = 0.982500, Test set accuracy = 0.951800
 epoch 20/30. Took 0.23212 seconds. 
  Full-batch training loss = 0.072133, test loss = 0.155860
  Training set accuracy = 0.981400, Test set accuracy = 0.952700
 epoch 21/30. Took 0.23288 seconds. 
  Full-batch training loss = 0.065628, test loss = 0.150809
  Training set accuracy = 0.982200, Test set accuracy = 0.953100
 epoch 22/30. Took 0.23263 seconds. 
  Full-batch training loss = 0.061232, test loss = 0.149222
  Training set accuracy = 0.985500, Test set accuracy = 0.954000
 epoch 23/30. Took 0.232 seconds. 
  Full-batch training loss = 0.060455, test loss = 0.152315
  Training set accuracy = 0.984200, Test set accuracy = 0.954200
 epoch 24/30. Took 0.23268 seconds. 
  Full-batch training loss = 0.054092, test loss = 0.148681
  Training set accuracy = 0.986800, Test set accuracy = 0.953000
 epoch 25/30. Took 0.23056 seconds. 
  Full-batch training loss = 0.050444, test loss = 0.148361
  Training set accuracy = 0.987900, Test set accuracy = 0.955000
 epoch 26/30. Took 0.23131 seconds. 
  Full-batch training loss = 0.050334, test loss = 0.149125
  Training set accuracy = 0.988600, Test set accuracy = 0.955100
 epoch 27/30. Took 0.24801 seconds. 
  Full-batch training loss = 0.050009, test loss = 0.151916
  Training set accuracy = 0.987900, Test set accuracy = 0.954000
 epoch 28/30. Took 0.24111 seconds. 
  Full-batch training loss = 0.046155, test loss = 0.146860
  Training set accuracy = 0.988300, Test set accuracy = 0.955800
 epoch 29/30. Took 0.2319 seconds. 
  Full-batch training loss = 0.043929, test loss = 0.147393
  Training set accuracy = 0.990600, Test set accuracy = 0.956100
 epoch 30/30. Took 0.22796 seconds. 
  Full-batch training loss = 0.041028, test loss = 0.143467
  Training set accuracy = 0.991400, Test set accuracy = 0.956900
Elapsed time is 13.423592 seconds.
End Training
-----
Params 10000 0.100 0.50 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35565 seconds. 
  Full-batch training loss = 0.402139, test loss = 0.400994
  Training set accuracy = 0.890700, Test set accuracy = 0.889300
 epoch 2/30. Took 0.3522 seconds. 
  Full-batch training loss = 0.312053, test loss = 0.322980
  Training set accuracy = 0.909600, Test set accuracy = 0.908500
 epoch 3/30. Took 0.35043 seconds. 
  Full-batch training loss = 0.248628, test loss = 0.273703
  Training set accuracy = 0.930300, Test set accuracy = 0.921700
 epoch 4/30. Took 0.35517 seconds. 
  Full-batch training loss = 0.210354, test loss = 0.242020
  Training set accuracy = 0.939100, Test set accuracy = 0.930200
 epoch 5/30. Took 0.35189 seconds. 
  Full-batch training loss = 0.195337, test loss = 0.236578
  Training set accuracy = 0.944700, Test set accuracy = 0.930500
 epoch 6/30. Took 0.35346 seconds. 
  Full-batch training loss = 0.168437, test loss = 0.215115
  Training set accuracy = 0.950400, Test set accuracy = 0.936100
 epoch 7/30. Took 0.3518 seconds. 
  Full-batch training loss = 0.150440, test loss = 0.201082
  Training set accuracy = 0.958900, Test set accuracy = 0.940400
 epoch 8/30. Took 0.35506 seconds. 
  Full-batch training loss = 0.135464, test loss = 0.187419
  Training set accuracy = 0.964000, Test set accuracy = 0.945100
 epoch 9/30. Took 0.34985 seconds. 
  Full-batch training loss = 0.118656, test loss = 0.177555
  Training set accuracy = 0.968900, Test set accuracy = 0.947700
 epoch 10/30. Took 0.3522 seconds. 
  Full-batch training loss = 0.108308, test loss = 0.169420
  Training set accuracy = 0.969800, Test set accuracy = 0.949700
 epoch 11/30. Took 0.35154 seconds. 
  Full-batch training loss = 0.101167, test loss = 0.166789
  Training set accuracy = 0.972400, Test set accuracy = 0.950400
 epoch 12/30. Took 0.36189 seconds. 
  Full-batch training loss = 0.093127, test loss = 0.161934
  Training set accuracy = 0.975000, Test set accuracy = 0.952000
 epoch 13/30. Took 0.35389 seconds. 
  Full-batch training loss = 0.085167, test loss = 0.159789
  Training set accuracy = 0.977600, Test set accuracy = 0.951600
 epoch 14/30. Took 0.36498 seconds. 
  Full-batch training loss = 0.077865, test loss = 0.157077
  Training set accuracy = 0.980200, Test set accuracy = 0.953100
 epoch 15/30. Took 0.35348 seconds. 
  Full-batch training loss = 0.071045, test loss = 0.150424
  Training set accuracy = 0.981500, Test set accuracy = 0.954900
 epoch 16/30. Took 0.35145 seconds. 
  Full-batch training loss = 0.063906, test loss = 0.145111
  Training set accuracy = 0.985100, Test set accuracy = 0.957100
 epoch 17/30. Took 0.35215 seconds. 
  Full-batch training loss = 0.061521, test loss = 0.144839
  Training set accuracy = 0.985000, Test set accuracy = 0.955900
 epoch 18/30. Took 0.36594 seconds. 
  Full-batch training loss = 0.054325, test loss = 0.140167
  Training set accuracy = 0.987300, Test set accuracy = 0.958900
 epoch 19/30. Took 0.35083 seconds. 
  Full-batch training loss = 0.051529, test loss = 0.137466
  Training set accuracy = 0.988000, Test set accuracy = 0.959900
 epoch 20/30. Took 0.35505 seconds. 
  Full-batch training loss = 0.047575, test loss = 0.138389
  Training set accuracy = 0.988600, Test set accuracy = 0.959600
 epoch 21/30. Took 0.36456 seconds. 
  Full-batch training loss = 0.046346, test loss = 0.141990
  Training set accuracy = 0.989600, Test set accuracy = 0.959300
 epoch 22/30. Took 0.35298 seconds. 
  Full-batch training loss = 0.042916, test loss = 0.135701
  Training set accuracy = 0.991000, Test set accuracy = 0.958900
 epoch 23/30. Took 0.3794 seconds. 
  Full-batch training loss = 0.039191, test loss = 0.136525
  Training set accuracy = 0.991300, Test set accuracy = 0.959800
 epoch 24/30. Took 0.35637 seconds. 
  Full-batch training loss = 0.036359, test loss = 0.136129
  Training set accuracy = 0.992200, Test set accuracy = 0.959200
 epoch 25/30. Took 0.38065 seconds. 
  Full-batch training loss = 0.033861, test loss = 0.137421
  Training set accuracy = 0.992700, Test set accuracy = 0.959900
 epoch 26/30. Took 0.35298 seconds. 
  Full-batch training loss = 0.031498, test loss = 0.132873
  Training set accuracy = 0.993100, Test set accuracy = 0.959900
 epoch 27/30. Took 0.35283 seconds. 
  Full-batch training loss = 0.031438, test loss = 0.131704
  Training set accuracy = 0.992700, Test set accuracy = 0.960800
 epoch 28/30. Took 0.35295 seconds. 
  Full-batch training loss = 0.028650, test loss = 0.132316
  Training set accuracy = 0.994400, Test set accuracy = 0.962200
 epoch 29/30. Took 0.35336 seconds. 
  Full-batch training loss = 0.026428, test loss = 0.134185
  Training set accuracy = 0.994700, Test set accuracy = 0.960600
 epoch 30/30. Took 0.35233 seconds. 
  Full-batch training loss = 0.024477, test loss = 0.131378
  Training set accuracy = 0.995200, Test set accuracy = 0.960600
Elapsed time is 19.381714 seconds.
End Training
-----
Params 10000 0.100 0.50 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.73126 seconds. 
  Full-batch training loss = 0.373586, test loss = 0.373783
  Training set accuracy = 0.895500, Test set accuracy = 0.896800
 epoch 2/30. Took 0.72591 seconds. 
  Full-batch training loss = 0.295501, test loss = 0.305331
  Training set accuracy = 0.915300, Test set accuracy = 0.911000
 epoch 3/30. Took 0.73961 seconds. 
  Full-batch training loss = 0.231841, test loss = 0.253699
  Training set accuracy = 0.934100, Test set accuracy = 0.926500
 epoch 4/30. Took 0.72721 seconds. 
  Full-batch training loss = 0.194597, test loss = 0.228122
  Training set accuracy = 0.942400, Test set accuracy = 0.933400
 epoch 5/30. Took 0.74674 seconds. 
  Full-batch training loss = 0.165752, test loss = 0.205182
  Training set accuracy = 0.954800, Test set accuracy = 0.941200
 epoch 6/30. Took 0.73038 seconds. 
  Full-batch training loss = 0.143443, test loss = 0.187577
  Training set accuracy = 0.962500, Test set accuracy = 0.945500
 epoch 7/30. Took 0.72916 seconds. 
  Full-batch training loss = 0.129279, test loss = 0.182172
  Training set accuracy = 0.966200, Test set accuracy = 0.946300
 epoch 8/30. Took 0.72809 seconds. 
  Full-batch training loss = 0.113615, test loss = 0.171225
  Training set accuracy = 0.968200, Test set accuracy = 0.947900
 epoch 9/30. Took 0.74835 seconds. 
  Full-batch training loss = 0.100435, test loss = 0.161539
  Training set accuracy = 0.973900, Test set accuracy = 0.951400
 epoch 10/30. Took 0.77639 seconds. 
  Full-batch training loss = 0.090887, test loss = 0.152996
  Training set accuracy = 0.977300, Test set accuracy = 0.952700
 epoch 11/30. Took 0.73208 seconds. 
  Full-batch training loss = 0.079392, test loss = 0.145787
  Training set accuracy = 0.979600, Test set accuracy = 0.955800
 epoch 12/30. Took 0.73083 seconds. 
  Full-batch training loss = 0.072379, test loss = 0.147233
  Training set accuracy = 0.982400, Test set accuracy = 0.954500
 epoch 13/30. Took 0.76061 seconds. 
  Full-batch training loss = 0.064222, test loss = 0.139902
  Training set accuracy = 0.984800, Test set accuracy = 0.956100
 epoch 14/30. Took 0.7298 seconds. 
  Full-batch training loss = 0.060090, test loss = 0.136640
  Training set accuracy = 0.985500, Test set accuracy = 0.956800
 epoch 15/30. Took 0.73116 seconds. 
  Full-batch training loss = 0.052931, test loss = 0.134558
  Training set accuracy = 0.988700, Test set accuracy = 0.957700
 epoch 16/30. Took 0.72978 seconds. 
  Full-batch training loss = 0.048796, test loss = 0.131857
  Training set accuracy = 0.989300, Test set accuracy = 0.959200
 epoch 17/30. Took 0.72994 seconds. 
  Full-batch training loss = 0.044912, test loss = 0.132057
  Training set accuracy = 0.989800, Test set accuracy = 0.959100
 epoch 18/30. Took 0.72793 seconds. 
  Full-batch training loss = 0.042333, test loss = 0.131261
  Training set accuracy = 0.990900, Test set accuracy = 0.959000
 epoch 19/30. Took 0.76135 seconds. 
  Full-batch training loss = 0.036703, test loss = 0.126902
  Training set accuracy = 0.992900, Test set accuracy = 0.960500
 epoch 20/30. Took 0.72428 seconds. 
  Full-batch training loss = 0.034003, test loss = 0.125953
  Training set accuracy = 0.993400, Test set accuracy = 0.960800
 epoch 21/30. Took 0.73441 seconds. 
  Full-batch training loss = 0.030479, test loss = 0.121176
  Training set accuracy = 0.995000, Test set accuracy = 0.961700
 epoch 22/30. Took 0.72806 seconds. 
  Full-batch training loss = 0.028154, test loss = 0.125339
  Training set accuracy = 0.995900, Test set accuracy = 0.960800
 epoch 23/30. Took 0.72794 seconds. 
  Full-batch training loss = 0.026223, test loss = 0.123832
  Training set accuracy = 0.995400, Test set accuracy = 0.961400
 epoch 24/30. Took 0.72844 seconds. 
  Full-batch training loss = 0.024102, test loss = 0.123124
  Training set accuracy = 0.996300, Test set accuracy = 0.962600
 epoch 25/30. Took 0.7335 seconds. 
  Full-batch training loss = 0.022981, test loss = 0.124350
  Training set accuracy = 0.997300, Test set accuracy = 0.961500
 epoch 26/30. Took 0.72675 seconds. 
  Full-batch training loss = 0.020931, test loss = 0.118727
  Training set accuracy = 0.997600, Test set accuracy = 0.963900
 epoch 27/30. Took 0.72978 seconds. 
  Full-batch training loss = 0.021343, test loss = 0.121561
  Training set accuracy = 0.997800, Test set accuracy = 0.962800
 epoch 28/30. Took 0.72735 seconds. 
  Full-batch training loss = 0.019597, test loss = 0.124611
  Training set accuracy = 0.997800, Test set accuracy = 0.961700
 epoch 29/30. Took 0.7299 seconds. 
  Full-batch training loss = 0.017100, test loss = 0.121713
  Training set accuracy = 0.998000, Test set accuracy = 0.963200
 epoch 30/30. Took 0.74405 seconds. 
  Full-batch training loss = 0.015378, test loss = 0.121614
  Training set accuracy = 0.998100, Test set accuracy = 0.962900
Elapsed time is 38.451403 seconds.
End Training
-----
Params 10000 0.100 0.50 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.29442 seconds. 
  Full-batch training loss = 0.609646, test loss = 0.598480
  Training set accuracy = 0.836500, Test set accuracy = 0.844900
 epoch 2/30. Took 0.28655 seconds. 
  Full-batch training loss = 0.390988, test loss = 0.387080
  Training set accuracy = 0.885600, Test set accuracy = 0.892600
 epoch 3/30. Took 0.29785 seconds. 
  Full-batch training loss = 0.311609, test loss = 0.324694
  Training set accuracy = 0.911300, Test set accuracy = 0.902900
 epoch 4/30. Took 0.29816 seconds. 
  Full-batch training loss = 0.260016, test loss = 0.280742
  Training set accuracy = 0.923800, Test set accuracy = 0.916900
 epoch 5/30. Took 0.2784 seconds. 
  Full-batch training loss = 0.226952, test loss = 0.258955
  Training set accuracy = 0.931700, Test set accuracy = 0.920700
 epoch 6/30. Took 0.29028 seconds. 
  Full-batch training loss = 0.200169, test loss = 0.236932
  Training set accuracy = 0.942800, Test set accuracy = 0.928600
 epoch 7/30. Took 0.28833 seconds. 
  Full-batch training loss = 0.180330, test loss = 0.228344
  Training set accuracy = 0.948700, Test set accuracy = 0.929000
 epoch 8/30. Took 0.28817 seconds. 
  Full-batch training loss = 0.166165, test loss = 0.216638
  Training set accuracy = 0.953700, Test set accuracy = 0.934100
 epoch 9/30. Took 0.28602 seconds. 
  Full-batch training loss = 0.152294, test loss = 0.204792
  Training set accuracy = 0.954100, Test set accuracy = 0.936900
 epoch 10/30. Took 0.2931 seconds. 
  Full-batch training loss = 0.135143, test loss = 0.196769
  Training set accuracy = 0.960600, Test set accuracy = 0.939500
 epoch 11/30. Took 0.28641 seconds. 
  Full-batch training loss = 0.131097, test loss = 0.195430
  Training set accuracy = 0.962600, Test set accuracy = 0.939500
 epoch 12/30. Took 0.28714 seconds. 
  Full-batch training loss = 0.123788, test loss = 0.191620
  Training set accuracy = 0.961900, Test set accuracy = 0.940500
 epoch 13/30. Took 0.27367 seconds. 
  Full-batch training loss = 0.112685, test loss = 0.182811
  Training set accuracy = 0.968300, Test set accuracy = 0.942900
 epoch 14/30. Took 0.30473 seconds. 
  Full-batch training loss = 0.110002, test loss = 0.186032
  Training set accuracy = 0.966300, Test set accuracy = 0.941300
 epoch 15/30. Took 0.28504 seconds. 
  Full-batch training loss = 0.097922, test loss = 0.177766
  Training set accuracy = 0.972100, Test set accuracy = 0.945800
 epoch 16/30. Took 0.28651 seconds. 
  Full-batch training loss = 0.094355, test loss = 0.172876
  Training set accuracy = 0.972400, Test set accuracy = 0.944000
 epoch 17/30. Took 0.27439 seconds. 
  Full-batch training loss = 0.084995, test loss = 0.175822
  Training set accuracy = 0.975700, Test set accuracy = 0.944900
 epoch 18/30. Took 0.28643 seconds. 
  Full-batch training loss = 0.089426, test loss = 0.182281
  Training set accuracy = 0.973600, Test set accuracy = 0.944200
 epoch 19/30. Took 0.28503 seconds. 
  Full-batch training loss = 0.078824, test loss = 0.170645
  Training set accuracy = 0.976900, Test set accuracy = 0.945400
 epoch 20/30. Took 0.29174 seconds. 
  Full-batch training loss = 0.075348, test loss = 0.166580
  Training set accuracy = 0.979500, Test set accuracy = 0.947700
 epoch 21/30. Took 0.28159 seconds. 
  Full-batch training loss = 0.071994, test loss = 0.168435
  Training set accuracy = 0.980600, Test set accuracy = 0.950800
 epoch 22/30. Took 0.29461 seconds. 
  Full-batch training loss = 0.064162, test loss = 0.162265
  Training set accuracy = 0.980700, Test set accuracy = 0.948800
 epoch 23/30. Took 0.28564 seconds. 
  Full-batch training loss = 0.066987, test loss = 0.169044
  Training set accuracy = 0.981200, Test set accuracy = 0.949100
 epoch 24/30. Took 0.28593 seconds. 
  Full-batch training loss = 0.061154, test loss = 0.167419
  Training set accuracy = 0.983500, Test set accuracy = 0.951500
 epoch 25/30. Took 0.28734 seconds. 
  Full-batch training loss = 0.057230, test loss = 0.160180
  Training set accuracy = 0.983800, Test set accuracy = 0.951700
 epoch 26/30. Took 0.28551 seconds. 
  Full-batch training loss = 0.057886, test loss = 0.166469
  Training set accuracy = 0.983400, Test set accuracy = 0.950800
 epoch 27/30. Took 0.2863 seconds. 
  Full-batch training loss = 0.051896, test loss = 0.161774
  Training set accuracy = 0.984800, Test set accuracy = 0.952600
 epoch 28/30. Took 0.28619 seconds. 
  Full-batch training loss = 0.049819, test loss = 0.159321
  Training set accuracy = 0.985700, Test set accuracy = 0.951400
 epoch 29/30. Took 0.28804 seconds. 
  Full-batch training loss = 0.050584, test loss = 0.161961
  Training set accuracy = 0.984500, Test set accuracy = 0.949700
 epoch 30/30. Took 0.28779 seconds. 
  Full-batch training loss = 0.042346, test loss = 0.158285
  Training set accuracy = 0.987700, Test set accuracy = 0.953500
Elapsed time is 15.924506 seconds.
End Training
-----
Params 10000 0.100 0.50 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.48187 seconds. 
  Full-batch training loss = 0.526738, test loss = 0.530448
  Training set accuracy = 0.853100, Test set accuracy = 0.849700
 epoch 2/30. Took 0.48352 seconds. 
  Full-batch training loss = 0.337522, test loss = 0.353076
  Training set accuracy = 0.901900, Test set accuracy = 0.898100
 epoch 3/30. Took 0.47425 seconds. 
  Full-batch training loss = 0.267775, test loss = 0.284334
  Training set accuracy = 0.921400, Test set accuracy = 0.917500
 epoch 4/30. Took 0.47307 seconds. 
  Full-batch training loss = 0.220620, test loss = 0.252202
  Training set accuracy = 0.932100, Test set accuracy = 0.924300
 epoch 5/30. Took 0.47329 seconds. 
  Full-batch training loss = 0.189863, test loss = 0.227620
  Training set accuracy = 0.942800, Test set accuracy = 0.932600
 epoch 6/30. Took 0.47428 seconds. 
  Full-batch training loss = 0.156394, test loss = 0.201956
  Training set accuracy = 0.952600, Test set accuracy = 0.936500
 epoch 7/30. Took 0.47029 seconds. 
  Full-batch training loss = 0.135697, test loss = 0.183940
  Training set accuracy = 0.959600, Test set accuracy = 0.945400
 epoch 8/30. Took 0.47907 seconds. 
  Full-batch training loss = 0.122896, test loss = 0.176754
  Training set accuracy = 0.963400, Test set accuracy = 0.943000
 epoch 9/30. Took 0.47342 seconds. 
  Full-batch training loss = 0.107476, test loss = 0.167507
  Training set accuracy = 0.968600, Test set accuracy = 0.948900
 epoch 10/30. Took 0.47565 seconds. 
  Full-batch training loss = 0.103790, test loss = 0.166550
  Training set accuracy = 0.969400, Test set accuracy = 0.948200
 epoch 11/30. Took 0.47768 seconds. 
  Full-batch training loss = 0.088522, test loss = 0.163980
  Training set accuracy = 0.974100, Test set accuracy = 0.948300
 epoch 12/30. Took 0.4746 seconds. 
  Full-batch training loss = 0.078195, test loss = 0.156055
  Training set accuracy = 0.977400, Test set accuracy = 0.952300
 epoch 13/30. Took 0.47999 seconds. 
  Full-batch training loss = 0.076400, test loss = 0.152003
  Training set accuracy = 0.978400, Test set accuracy = 0.954200
 epoch 14/30. Took 0.48464 seconds. 
  Full-batch training loss = 0.067811, test loss = 0.151795
  Training set accuracy = 0.978700, Test set accuracy = 0.953900
 epoch 15/30. Took 0.46575 seconds. 
  Full-batch training loss = 0.057965, test loss = 0.144000
  Training set accuracy = 0.982800, Test set accuracy = 0.955800
 epoch 16/30. Took 0.47182 seconds. 
  Full-batch training loss = 0.052493, test loss = 0.137222
  Training set accuracy = 0.985100, Test set accuracy = 0.959100
 epoch 17/30. Took 0.49892 seconds. 
  Full-batch training loss = 0.047641, test loss = 0.133644
  Training set accuracy = 0.986600, Test set accuracy = 0.960400
 epoch 18/30. Took 0.48361 seconds. 
  Full-batch training loss = 0.040949, test loss = 0.135443
  Training set accuracy = 0.988400, Test set accuracy = 0.959900
 epoch 19/30. Took 0.47404 seconds. 
  Full-batch training loss = 0.036882, test loss = 0.133268
  Training set accuracy = 0.990200, Test set accuracy = 0.960500
 epoch 20/30. Took 0.47338 seconds. 
  Full-batch training loss = 0.033834, test loss = 0.131959
  Training set accuracy = 0.991200, Test set accuracy = 0.960300
 epoch 21/30. Took 0.51009 seconds. 
  Full-batch training loss = 0.034906, test loss = 0.130735
  Training set accuracy = 0.989800, Test set accuracy = 0.960600
 epoch 22/30. Took 0.50148 seconds. 
  Full-batch training loss = 0.028802, test loss = 0.133303
  Training set accuracy = 0.992100, Test set accuracy = 0.961300
 epoch 23/30. Took 0.48802 seconds. 
  Full-batch training loss = 0.025639, test loss = 0.132715
  Training set accuracy = 0.993500, Test set accuracy = 0.960400
 epoch 24/30. Took 0.48243 seconds. 
  Full-batch training loss = 0.028334, test loss = 0.137220
  Training set accuracy = 0.991700, Test set accuracy = 0.960400
 epoch 25/30. Took 0.51301 seconds. 
  Full-batch training loss = 0.021852, test loss = 0.129464
  Training set accuracy = 0.994800, Test set accuracy = 0.963400
 epoch 26/30. Took 0.48569 seconds. 
  Full-batch training loss = 0.020919, test loss = 0.128688
  Training set accuracy = 0.994400, Test set accuracy = 0.964700
 epoch 27/30. Took 0.47402 seconds. 
  Full-batch training loss = 0.020298, test loss = 0.134451
  Training set accuracy = 0.995200, Test set accuracy = 0.961700
 epoch 28/30. Took 0.4788 seconds. 
  Full-batch training loss = 0.019280, test loss = 0.133863
  Training set accuracy = 0.995600, Test set accuracy = 0.962600
 epoch 29/30. Took 0.48006 seconds. 
  Full-batch training loss = 0.016613, test loss = 0.133243
  Training set accuracy = 0.996000, Test set accuracy = 0.962100
 epoch 30/30. Took 0.49403 seconds. 
  Full-batch training loss = 0.014610, test loss = 0.130931
  Training set accuracy = 0.996300, Test set accuracy = 0.964100
Elapsed time is 25.209568 seconds.
End Training
-----
Params 10000 0.100 0.50 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2171 seconds. 
  Full-batch training loss = 0.461218, test loss = 0.452498
  Training set accuracy = 0.867200, Test set accuracy = 0.866700
 epoch 2/30. Took 1.2222 seconds. 
  Full-batch training loss = 0.315155, test loss = 0.324603
  Training set accuracy = 0.905500, Test set accuracy = 0.903400
 epoch 3/30. Took 1.2003 seconds. 
  Full-batch training loss = 0.251326, test loss = 0.268106
  Training set accuracy = 0.922800, Test set accuracy = 0.919700
 epoch 4/30. Took 1.2993 seconds. 
  Full-batch training loss = 0.198019, test loss = 0.226022
  Training set accuracy = 0.941400, Test set accuracy = 0.932100
 epoch 5/30. Took 1.2367 seconds. 
  Full-batch training loss = 0.156566, test loss = 0.194763
  Training set accuracy = 0.953400, Test set accuracy = 0.941900
 epoch 6/30. Took 1.2047 seconds. 
  Full-batch training loss = 0.134455, test loss = 0.175854
  Training set accuracy = 0.961300, Test set accuracy = 0.946900
 epoch 7/30. Took 1.2432 seconds. 
  Full-batch training loss = 0.121961, test loss = 0.173928
  Training set accuracy = 0.963600, Test set accuracy = 0.946200
 epoch 8/30. Took 1.2083 seconds. 
  Full-batch training loss = 0.097035, test loss = 0.157841
  Training set accuracy = 0.970500, Test set accuracy = 0.952600
 epoch 9/30. Took 1.2084 seconds. 
  Full-batch training loss = 0.085607, test loss = 0.146481
  Training set accuracy = 0.975000, Test set accuracy = 0.956200
 epoch 10/30. Took 1.2017 seconds. 
  Full-batch training loss = 0.074534, test loss = 0.142388
  Training set accuracy = 0.978200, Test set accuracy = 0.955300
 epoch 11/30. Took 1.1977 seconds. 
  Full-batch training loss = 0.067333, test loss = 0.142082
  Training set accuracy = 0.979800, Test set accuracy = 0.956200
 epoch 12/30. Took 1.1963 seconds. 
  Full-batch training loss = 0.060887, test loss = 0.139207
  Training set accuracy = 0.983400, Test set accuracy = 0.955900
 epoch 13/30. Took 1.2009 seconds. 
  Full-batch training loss = 0.051125, test loss = 0.130293
  Training set accuracy = 0.985900, Test set accuracy = 0.959300
 epoch 14/30. Took 1.2244 seconds. 
  Full-batch training loss = 0.045605, test loss = 0.136999
  Training set accuracy = 0.985800, Test set accuracy = 0.957300
 epoch 15/30. Took 1.2296 seconds. 
  Full-batch training loss = 0.038285, test loss = 0.131228
  Training set accuracy = 0.989000, Test set accuracy = 0.961000
 epoch 16/30. Took 1.2017 seconds. 
  Full-batch training loss = 0.032913, test loss = 0.128676
  Training set accuracy = 0.991600, Test set accuracy = 0.961600
 epoch 17/30. Took 1.3433 seconds. 
  Full-batch training loss = 0.033140, test loss = 0.132661
  Training set accuracy = 0.990700, Test set accuracy = 0.961000
 epoch 18/30. Took 1.2022 seconds. 
  Full-batch training loss = 0.026348, test loss = 0.125287
  Training set accuracy = 0.993100, Test set accuracy = 0.962800
 epoch 19/30. Took 1.2154 seconds. 
  Full-batch training loss = 0.022620, test loss = 0.122760
  Training set accuracy = 0.995000, Test set accuracy = 0.964100
 epoch 20/30. Took 1.2046 seconds. 
  Full-batch training loss = 0.019168, test loss = 0.121629
  Training set accuracy = 0.995900, Test set accuracy = 0.963600
 epoch 21/30. Took 1.2053 seconds. 
  Full-batch training loss = 0.018247, test loss = 0.123904
  Training set accuracy = 0.995800, Test set accuracy = 0.963700
 epoch 22/30. Took 1.2105 seconds. 
  Full-batch training loss = 0.014619, test loss = 0.122157
  Training set accuracy = 0.997100, Test set accuracy = 0.964500
 epoch 23/30. Took 1.2043 seconds. 
  Full-batch training loss = 0.013804, test loss = 0.121185
  Training set accuracy = 0.997200, Test set accuracy = 0.964300
 epoch 24/30. Took 1.2133 seconds. 
  Full-batch training loss = 0.013972, test loss = 0.129076
  Training set accuracy = 0.996600, Test set accuracy = 0.962800
 epoch 25/30. Took 1.2319 seconds. 
  Full-batch training loss = 0.010913, test loss = 0.121546
  Training set accuracy = 0.998500, Test set accuracy = 0.965300
 epoch 26/30. Took 1.2077 seconds. 
  Full-batch training loss = 0.008781, test loss = 0.118731
  Training set accuracy = 0.998900, Test set accuracy = 0.966400
 epoch 27/30. Took 1.2031 seconds. 
  Full-batch training loss = 0.010505, test loss = 0.123828
  Training set accuracy = 0.998000, Test set accuracy = 0.963700
 epoch 28/30. Took 1.2571 seconds. 
  Full-batch training loss = 0.007060, test loss = 0.128060
  Training set accuracy = 0.999100, Test set accuracy = 0.965000
 epoch 29/30. Took 1.2624 seconds. 
  Full-batch training loss = 0.006934, test loss = 0.118614
  Training set accuracy = 0.999700, Test set accuracy = 0.967000
 epoch 30/30. Took 1.2018 seconds. 
  Full-batch training loss = 0.005700, test loss = 0.124602
  Training set accuracy = 0.999300, Test set accuracy = 0.966600
Elapsed time is 62.716731 seconds.
End Training
-----
Params 10000 0.100 0.50 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.34161 seconds. 
  Full-batch training loss = 1.619739, test loss = 1.618504
  Training set accuracy = 0.478800, Test set accuracy = 0.468900
 epoch 2/30. Took 0.34013 seconds. 
  Full-batch training loss = 0.676949, test loss = 0.679664
  Training set accuracy = 0.819400, Test set accuracy = 0.822400
 epoch 3/30. Took 0.32978 seconds. 
  Full-batch training loss = 0.472504, test loss = 0.480968
  Training set accuracy = 0.866300, Test set accuracy = 0.868100
 epoch 4/30. Took 0.31956 seconds. 
  Full-batch training loss = 0.373003, test loss = 0.381714
  Training set accuracy = 0.896100, Test set accuracy = 0.891000
 epoch 5/30. Took 0.31724 seconds. 
  Full-batch training loss = 0.317943, test loss = 0.337999
  Training set accuracy = 0.909100, Test set accuracy = 0.902000
 epoch 6/30. Took 0.32046 seconds. 
  Full-batch training loss = 0.266759, test loss = 0.289857
  Training set accuracy = 0.925000, Test set accuracy = 0.920500
 epoch 7/30. Took 0.3174 seconds. 
  Full-batch training loss = 0.232223, test loss = 0.268820
  Training set accuracy = 0.933800, Test set accuracy = 0.924700
 epoch 8/30. Took 0.31945 seconds. 
  Full-batch training loss = 0.222962, test loss = 0.262685
  Training set accuracy = 0.934800, Test set accuracy = 0.925000
 epoch 9/30. Took 0.34031 seconds. 
  Full-batch training loss = 0.202214, test loss = 0.246003
  Training set accuracy = 0.941500, Test set accuracy = 0.930800
 epoch 10/30. Took 0.33991 seconds. 
  Full-batch training loss = 0.191519, test loss = 0.240619
  Training set accuracy = 0.945800, Test set accuracy = 0.934100
 epoch 11/30. Took 0.3427 seconds. 
  Full-batch training loss = 0.176080, test loss = 0.232434
  Training set accuracy = 0.949600, Test set accuracy = 0.931600
 epoch 12/30. Took 0.33845 seconds. 
  Full-batch training loss = 0.155073, test loss = 0.220119
  Training set accuracy = 0.953800, Test set accuracy = 0.938000
 epoch 13/30. Took 0.34731 seconds. 
  Full-batch training loss = 0.140591, test loss = 0.215732
  Training set accuracy = 0.959800, Test set accuracy = 0.939100
 epoch 14/30. Took 0.32445 seconds. 
  Full-batch training loss = 0.147128, test loss = 0.226383
  Training set accuracy = 0.956500, Test set accuracy = 0.934000
 epoch 15/30. Took 0.31851 seconds. 
  Full-batch training loss = 0.122412, test loss = 0.198933
  Training set accuracy = 0.963100, Test set accuracy = 0.945000
 epoch 16/30. Took 0.339 seconds. 
  Full-batch training loss = 0.119143, test loss = 0.202569
  Training set accuracy = 0.965200, Test set accuracy = 0.941900
 epoch 17/30. Took 0.32884 seconds. 
  Full-batch training loss = 0.109683, test loss = 0.198790
  Training set accuracy = 0.967200, Test set accuracy = 0.947400
 epoch 18/30. Took 0.33911 seconds. 
  Full-batch training loss = 0.107263, test loss = 0.204087
  Training set accuracy = 0.968800, Test set accuracy = 0.946300
 epoch 19/30. Took 0.34082 seconds. 
  Full-batch training loss = 0.107022, test loss = 0.199353
  Training set accuracy = 0.969400, Test set accuracy = 0.944200
 epoch 20/30. Took 0.33891 seconds. 
  Full-batch training loss = 0.100136, test loss = 0.202445
  Training set accuracy = 0.969800, Test set accuracy = 0.944700
 epoch 21/30. Took 0.33899 seconds. 
  Full-batch training loss = 0.095385, test loss = 0.202212
  Training set accuracy = 0.971600, Test set accuracy = 0.947700
 epoch 22/30. Took 0.33758 seconds. 
  Full-batch training loss = 0.095040, test loss = 0.210197
  Training set accuracy = 0.970700, Test set accuracy = 0.943900
 epoch 23/30. Took 0.33963 seconds. 
  Full-batch training loss = 0.080882, test loss = 0.192318
  Training set accuracy = 0.976600, Test set accuracy = 0.947400
 epoch 24/30. Took 0.34046 seconds. 
  Full-batch training loss = 0.082162, test loss = 0.190191
  Training set accuracy = 0.976700, Test set accuracy = 0.948400
 epoch 25/30. Took 0.32457 seconds. 
  Full-batch training loss = 0.080011, test loss = 0.198005
  Training set accuracy = 0.975900, Test set accuracy = 0.946700
 epoch 26/30. Took 0.34899 seconds. 
  Full-batch training loss = 0.075568, test loss = 0.196394
  Training set accuracy = 0.977700, Test set accuracy = 0.948500
 epoch 27/30. Took 0.32774 seconds. 
  Full-batch training loss = 0.076673, test loss = 0.202314
  Training set accuracy = 0.977400, Test set accuracy = 0.948200
 epoch 28/30. Took 0.33954 seconds. 
  Full-batch training loss = 0.070662, test loss = 0.194457
  Training set accuracy = 0.978900, Test set accuracy = 0.948800
 epoch 29/30. Took 0.32625 seconds. 
  Full-batch training loss = 0.067401, test loss = 0.199693
  Training set accuracy = 0.979300, Test set accuracy = 0.950400
 epoch 30/30. Took 0.3351 seconds. 
  Full-batch training loss = 0.060078, test loss = 0.187937
  Training set accuracy = 0.982900, Test set accuracy = 0.951200
Elapsed time is 18.185625 seconds.
End Training
-----
Params 10000 0.100 0.50 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.5709 seconds. 
  Full-batch training loss = 1.141422, test loss = 1.125126
  Training set accuracy = 0.633600, Test set accuracy = 0.643500
 epoch 2/30. Took 0.57043 seconds. 
  Full-batch training loss = 0.519786, test loss = 0.509321
  Training set accuracy = 0.858800, Test set accuracy = 0.861500
 epoch 3/30. Took 0.57911 seconds. 
  Full-batch training loss = 0.362534, test loss = 0.358872
  Training set accuracy = 0.894300, Test set accuracy = 0.896200
 epoch 4/30. Took 0.58041 seconds. 
  Full-batch training loss = 0.269883, test loss = 0.285010
  Training set accuracy = 0.920700, Test set accuracy = 0.918300
 epoch 5/30. Took 0.62275 seconds. 
  Full-batch training loss = 0.232865, test loss = 0.268814
  Training set accuracy = 0.933300, Test set accuracy = 0.921900
 epoch 6/30. Took 0.5639 seconds. 
  Full-batch training loss = 0.193059, test loss = 0.232934
  Training set accuracy = 0.942900, Test set accuracy = 0.930200
 epoch 7/30. Took 0.56754 seconds. 
  Full-batch training loss = 0.168548, test loss = 0.217362
  Training set accuracy = 0.950700, Test set accuracy = 0.936300
 epoch 8/30. Took 0.58025 seconds. 
  Full-batch training loss = 0.147274, test loss = 0.205435
  Training set accuracy = 0.958200, Test set accuracy = 0.940100
 epoch 9/30. Took 0.57901 seconds. 
  Full-batch training loss = 0.126726, test loss = 0.191931
  Training set accuracy = 0.963400, Test set accuracy = 0.943900
 epoch 10/30. Took 0.57966 seconds. 
  Full-batch training loss = 0.116773, test loss = 0.188666
  Training set accuracy = 0.966500, Test set accuracy = 0.944200
 epoch 11/30. Took 0.57345 seconds. 
  Full-batch training loss = 0.103013, test loss = 0.184932
  Training set accuracy = 0.971300, Test set accuracy = 0.947200
 epoch 12/30. Took 0.56936 seconds. 
  Full-batch training loss = 0.093792, test loss = 0.173691
  Training set accuracy = 0.973000, Test set accuracy = 0.951600
 epoch 13/30. Took 0.6187 seconds. 
  Full-batch training loss = 0.085211, test loss = 0.166949
  Training set accuracy = 0.974700, Test set accuracy = 0.954000
 epoch 14/30. Took 0.57377 seconds. 
  Full-batch training loss = 0.080048, test loss = 0.173603
  Training set accuracy = 0.976700, Test set accuracy = 0.950500
 epoch 15/30. Took 0.57793 seconds. 
  Full-batch training loss = 0.079785, test loss = 0.172630
  Training set accuracy = 0.976400, Test set accuracy = 0.950800
 epoch 16/30. Took 0.57759 seconds. 
  Full-batch training loss = 0.065271, test loss = 0.163335
  Training set accuracy = 0.981600, Test set accuracy = 0.953500
 epoch 17/30. Took 0.58764 seconds. 
  Full-batch training loss = 0.059864, test loss = 0.153311
  Training set accuracy = 0.982300, Test set accuracy = 0.955600
 epoch 18/30. Took 0.57576 seconds. 
  Full-batch training loss = 0.056362, test loss = 0.157911
  Training set accuracy = 0.983400, Test set accuracy = 0.956400
 epoch 19/30. Took 0.57784 seconds. 
  Full-batch training loss = 0.048946, test loss = 0.152612
  Training set accuracy = 0.986900, Test set accuracy = 0.957200
 epoch 20/30. Took 0.57827 seconds. 
  Full-batch training loss = 0.053816, test loss = 0.167163
  Training set accuracy = 0.984800, Test set accuracy = 0.953600
 epoch 21/30. Took 0.55793 seconds. 
  Full-batch training loss = 0.047012, test loss = 0.152681
  Training set accuracy = 0.986200, Test set accuracy = 0.958600
 epoch 22/30. Took 0.5937 seconds. 
  Full-batch training loss = 0.040141, test loss = 0.150018
  Training set accuracy = 0.990000, Test set accuracy = 0.959500
 epoch 23/30. Took 0.55686 seconds. 
  Full-batch training loss = 0.044459, test loss = 0.165458
  Training set accuracy = 0.987500, Test set accuracy = 0.953000
 epoch 24/30. Took 0.55381 seconds. 
  Full-batch training loss = 0.038248, test loss = 0.157026
  Training set accuracy = 0.990200, Test set accuracy = 0.958000
 epoch 25/30. Took 0.57693 seconds. 
  Full-batch training loss = 0.036604, test loss = 0.159090
  Training set accuracy = 0.989400, Test set accuracy = 0.957300
 epoch 26/30. Took 0.5728 seconds. 
  Full-batch training loss = 0.033733, test loss = 0.153036
  Training set accuracy = 0.989900, Test set accuracy = 0.959700
 epoch 27/30. Took 0.57548 seconds. 
  Full-batch training loss = 0.030881, test loss = 0.155947
  Training set accuracy = 0.991600, Test set accuracy = 0.960000
 epoch 28/30. Took 0.59547 seconds. 
  Full-batch training loss = 0.028895, test loss = 0.154837
  Training set accuracy = 0.992200, Test set accuracy = 0.960400
 epoch 29/30. Took 0.57177 seconds. 
  Full-batch training loss = 0.029890, test loss = 0.154986
  Training set accuracy = 0.992000, Test set accuracy = 0.958600
 epoch 30/30. Took 0.61467 seconds. 
  Full-batch training loss = 0.026167, test loss = 0.159912
  Training set accuracy = 0.992100, Test set accuracy = 0.959300
Elapsed time is 30.769519 seconds.
End Training
-----
Params 10000 0.100 0.50 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.7078 seconds. 
  Full-batch training loss = 0.822752, test loss = 0.813781
  Training set accuracy = 0.740200, Test set accuracy = 0.751400
 epoch 2/30. Took 1.7162 seconds. 
  Full-batch training loss = 0.399516, test loss = 0.402612
  Training set accuracy = 0.874000, Test set accuracy = 0.874600
 epoch 3/30. Took 1.6604 seconds. 
  Full-batch training loss = 0.280511, test loss = 0.299297
  Training set accuracy = 0.916600, Test set accuracy = 0.910100
 epoch 4/30. Took 1.696 seconds. 
  Full-batch training loss = 0.220801, test loss = 0.255982
  Training set accuracy = 0.930300, Test set accuracy = 0.922100
 epoch 5/30. Took 1.6595 seconds. 
  Full-batch training loss = 0.172519, test loss = 0.215950
  Training set accuracy = 0.947100, Test set accuracy = 0.935500
 epoch 6/30. Took 1.7004 seconds. 
  Full-batch training loss = 0.146203, test loss = 0.196345
  Training set accuracy = 0.953900, Test set accuracy = 0.940900
 epoch 7/30. Took 1.6919 seconds. 
  Full-batch training loss = 0.120055, test loss = 0.181974
  Training set accuracy = 0.965000, Test set accuracy = 0.943800
 epoch 8/30. Took 1.7137 seconds. 
  Full-batch training loss = 0.106030, test loss = 0.173506
  Training set accuracy = 0.969200, Test set accuracy = 0.946300
 epoch 9/30. Took 1.6634 seconds. 
  Full-batch training loss = 0.085862, test loss = 0.168866
  Training set accuracy = 0.974200, Test set accuracy = 0.948700
 epoch 10/30. Took 1.6664 seconds. 
  Full-batch training loss = 0.074619, test loss = 0.158537
  Training set accuracy = 0.978000, Test set accuracy = 0.952400
 epoch 11/30. Took 1.6948 seconds. 
  Full-batch training loss = 0.062544, test loss = 0.151698
  Training set accuracy = 0.980900, Test set accuracy = 0.955900
 epoch 12/30. Took 1.7447 seconds. 
  Full-batch training loss = 0.055320, test loss = 0.149624
  Training set accuracy = 0.983900, Test set accuracy = 0.955800
 epoch 13/30. Took 1.6568 seconds. 
  Full-batch training loss = 0.046717, test loss = 0.139366
  Training set accuracy = 0.986500, Test set accuracy = 0.957800
 epoch 14/30. Took 1.7069 seconds. 
  Full-batch training loss = 0.040271, test loss = 0.141494
  Training set accuracy = 0.988900, Test set accuracy = 0.957800
 epoch 15/30. Took 1.69 seconds. 
  Full-batch training loss = 0.034940, test loss = 0.136245
  Training set accuracy = 0.990400, Test set accuracy = 0.958900
 epoch 16/30. Took 1.6668 seconds. 
  Full-batch training loss = 0.036184, test loss = 0.153276
  Training set accuracy = 0.990400, Test set accuracy = 0.957900
 epoch 17/30. Took 1.7048 seconds. 
  Full-batch training loss = 0.025508, test loss = 0.141556
  Training set accuracy = 0.993500, Test set accuracy = 0.961100
 epoch 18/30. Took 1.7322 seconds. 
  Full-batch training loss = 0.021645, test loss = 0.138138
  Training set accuracy = 0.994500, Test set accuracy = 0.961200
 epoch 19/30. Took 1.66 seconds. 
  Full-batch training loss = 0.019490, test loss = 0.140004
  Training set accuracy = 0.994400, Test set accuracy = 0.963900
 epoch 20/30. Took 1.6981 seconds. 
  Full-batch training loss = 0.016915, test loss = 0.140271
  Training set accuracy = 0.994900, Test set accuracy = 0.962200
 epoch 21/30. Took 1.6784 seconds. 
  Full-batch training loss = 0.016054, test loss = 0.145803
  Training set accuracy = 0.995700, Test set accuracy = 0.962500
 epoch 22/30. Took 1.6645 seconds. 
  Full-batch training loss = 0.013921, test loss = 0.141408
  Training set accuracy = 0.996800, Test set accuracy = 0.961600
 epoch 23/30. Took 1.7184 seconds. 
  Full-batch training loss = 0.010640, test loss = 0.138125
  Training set accuracy = 0.997400, Test set accuracy = 0.963700
 epoch 24/30. Took 1.732 seconds. 
  Full-batch training loss = 0.010231, test loss = 0.142096
  Training set accuracy = 0.997200, Test set accuracy = 0.963900
 epoch 25/30. Took 1.6708 seconds. 
  Full-batch training loss = 0.008018, test loss = 0.139716
  Training set accuracy = 0.998100, Test set accuracy = 0.963400
 epoch 26/30. Took 1.669 seconds. 
  Full-batch training loss = 0.011266, test loss = 0.151305
  Training set accuracy = 0.997100, Test set accuracy = 0.962000
 epoch 27/30. Took 1.6859 seconds. 
  Full-batch training loss = 0.008077, test loss = 0.140873
  Training set accuracy = 0.998000, Test set accuracy = 0.964200
 epoch 28/30. Took 1.86 seconds. 
  Full-batch training loss = 0.006473, test loss = 0.140157
  Training set accuracy = 0.998400, Test set accuracy = 0.964400
 epoch 29/30. Took 1.6791 seconds. 
  Full-batch training loss = 0.006217, test loss = 0.146067
  Training set accuracy = 0.998700, Test set accuracy = 0.964400
 epoch 30/30. Took 1.6602 seconds. 
  Full-batch training loss = 0.005541, test loss = 0.146095
  Training set accuracy = 0.998600, Test set accuracy = 0.963300
Elapsed time is 86.761576 seconds.
End Training
-----
Params 10000 0.010 0.00 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.21015 seconds. 
  Full-batch training loss = 0.768194, test loss = 0.755864
  Training set accuracy = 0.832800, Test set accuracy = 0.835500
 epoch 2/30. Took 0.20602 seconds. 
  Full-batch training loss = 0.500187, test loss = 0.491704
  Training set accuracy = 0.876200, Test set accuracy = 0.882000
 epoch 3/30. Took 0.20472 seconds. 
  Full-batch training loss = 0.418416, test loss = 0.416326
  Training set accuracy = 0.886100, Test set accuracy = 0.889800
 epoch 4/30. Took 0.20617 seconds. 
  Full-batch training loss = 0.374220, test loss = 0.375261
  Training set accuracy = 0.896900, Test set accuracy = 0.898600
 epoch 5/30. Took 0.20716 seconds. 
  Full-batch training loss = 0.344184, test loss = 0.349591
  Training set accuracy = 0.903400, Test set accuracy = 0.903600
 epoch 6/30. Took 0.20219 seconds. 
  Full-batch training loss = 0.328680, test loss = 0.335969
  Training set accuracy = 0.910300, Test set accuracy = 0.905300
 epoch 7/30. Took 0.20145 seconds. 
  Full-batch training loss = 0.308854, test loss = 0.322101
  Training set accuracy = 0.914500, Test set accuracy = 0.908500
 epoch 8/30. Took 0.2012 seconds. 
  Full-batch training loss = 0.294292, test loss = 0.311756
  Training set accuracy = 0.917400, Test set accuracy = 0.913300
 epoch 9/30. Took 0.2024 seconds. 
  Full-batch training loss = 0.282583, test loss = 0.301892
  Training set accuracy = 0.922800, Test set accuracy = 0.913600
 epoch 10/30. Took 0.20185 seconds. 
  Full-batch training loss = 0.271572, test loss = 0.294338
  Training set accuracy = 0.924900, Test set accuracy = 0.917100
 epoch 11/30. Took 0.2075 seconds. 
  Full-batch training loss = 0.262466, test loss = 0.289245
  Training set accuracy = 0.929200, Test set accuracy = 0.917700
 epoch 12/30. Took 0.20208 seconds. 
  Full-batch training loss = 0.252307, test loss = 0.281730
  Training set accuracy = 0.931000, Test set accuracy = 0.921700
 epoch 13/30. Took 0.21864 seconds. 
  Full-batch training loss = 0.246562, test loss = 0.276139
  Training set accuracy = 0.931700, Test set accuracy = 0.921900
 epoch 14/30. Took 0.20039 seconds. 
  Full-batch training loss = 0.239494, test loss = 0.272662
  Training set accuracy = 0.932000, Test set accuracy = 0.921900
 epoch 15/30. Took 0.20468 seconds. 
  Full-batch training loss = 0.229514, test loss = 0.264860
  Training set accuracy = 0.935500, Test set accuracy = 0.924500
 epoch 16/30. Took 0.21103 seconds. 
  Full-batch training loss = 0.222820, test loss = 0.261449
  Training set accuracy = 0.939200, Test set accuracy = 0.923800
 epoch 17/30. Took 0.21115 seconds. 
  Full-batch training loss = 0.216234, test loss = 0.257789
  Training set accuracy = 0.940600, Test set accuracy = 0.926600
 epoch 18/30. Took 0.20541 seconds. 
  Full-batch training loss = 0.210353, test loss = 0.254629
  Training set accuracy = 0.942200, Test set accuracy = 0.926500
 epoch 19/30. Took 0.20634 seconds. 
  Full-batch training loss = 0.202566, test loss = 0.247375
  Training set accuracy = 0.945600, Test set accuracy = 0.928200
 epoch 20/30. Took 0.20805 seconds. 
  Full-batch training loss = 0.201009, test loss = 0.250162
  Training set accuracy = 0.946700, Test set accuracy = 0.928000
 epoch 21/30. Took 0.20675 seconds. 
  Full-batch training loss = 0.191823, test loss = 0.240314
  Training set accuracy = 0.949800, Test set accuracy = 0.930200
 epoch 22/30. Took 0.20468 seconds. 
  Full-batch training loss = 0.187994, test loss = 0.236394
  Training set accuracy = 0.948100, Test set accuracy = 0.928600
 epoch 23/30. Took 0.20659 seconds. 
  Full-batch training loss = 0.184639, test loss = 0.238321
  Training set accuracy = 0.949900, Test set accuracy = 0.930900
 epoch 24/30. Took 0.20623 seconds. 
  Full-batch training loss = 0.176608, test loss = 0.231331
  Training set accuracy = 0.953300, Test set accuracy = 0.930700
 epoch 25/30. Took 0.22145 seconds. 
  Full-batch training loss = 0.172814, test loss = 0.228326
  Training set accuracy = 0.954100, Test set accuracy = 0.932600
 epoch 26/30. Took 0.20417 seconds. 
  Full-batch training loss = 0.167923, test loss = 0.223531
  Training set accuracy = 0.956000, Test set accuracy = 0.933500
 epoch 27/30. Took 0.20193 seconds. 
  Full-batch training loss = 0.164254, test loss = 0.221819
  Training set accuracy = 0.957400, Test set accuracy = 0.935200
 epoch 28/30. Took 0.20332 seconds. 
  Full-batch training loss = 0.160016, test loss = 0.219577
  Training set accuracy = 0.960800, Test set accuracy = 0.936000
 epoch 29/30. Took 0.20535 seconds. 
  Full-batch training loss = 0.155739, test loss = 0.217638
  Training set accuracy = 0.958700, Test set accuracy = 0.934900
 epoch 30/30. Took 0.20603 seconds. 
  Full-batch training loss = 0.151405, test loss = 0.213456
  Training set accuracy = 0.961000, Test set accuracy = 0.935300
Elapsed time is 12.420721 seconds.
End Training
-----
Params 10000 0.010 0.00 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32029 seconds. 
  Full-batch training loss = 0.739512, test loss = 0.731861
  Training set accuracy = 0.837500, Test set accuracy = 0.834700
 epoch 2/30. Took 0.31674 seconds. 
  Full-batch training loss = 0.491082, test loss = 0.490268
  Training set accuracy = 0.877100, Test set accuracy = 0.875800
 epoch 3/30. Took 0.31712 seconds. 
  Full-batch training loss = 0.407629, test loss = 0.412189
  Training set accuracy = 0.890900, Test set accuracy = 0.892200
 epoch 4/30. Took 0.31565 seconds. 
  Full-batch training loss = 0.365767, test loss = 0.374022
  Training set accuracy = 0.903100, Test set accuracy = 0.898800
 epoch 5/30. Took 0.31684 seconds. 
  Full-batch training loss = 0.339779, test loss = 0.353558
  Training set accuracy = 0.907900, Test set accuracy = 0.903000
 epoch 6/30. Took 0.32083 seconds. 
  Full-batch training loss = 0.315344, test loss = 0.330372
  Training set accuracy = 0.910800, Test set accuracy = 0.907200
 epoch 7/30. Took 0.31311 seconds. 
  Full-batch training loss = 0.299667, test loss = 0.317646
  Training set accuracy = 0.914000, Test set accuracy = 0.911200
 epoch 8/30. Took 0.31757 seconds. 
  Full-batch training loss = 0.287548, test loss = 0.310529
  Training set accuracy = 0.918100, Test set accuracy = 0.910700
 epoch 9/30. Took 0.3165 seconds. 
  Full-batch training loss = 0.271451, test loss = 0.296529
  Training set accuracy = 0.923400, Test set accuracy = 0.915900
 epoch 10/30. Took 0.31424 seconds. 
  Full-batch training loss = 0.266352, test loss = 0.295979
  Training set accuracy = 0.923800, Test set accuracy = 0.916500
 epoch 11/30. Took 0.32513 seconds. 
  Full-batch training loss = 0.251095, test loss = 0.283033
  Training set accuracy = 0.928900, Test set accuracy = 0.920700
 epoch 12/30. Took 0.31545 seconds. 
  Full-batch training loss = 0.241590, test loss = 0.275314
  Training set accuracy = 0.932300, Test set accuracy = 0.922800
 epoch 13/30. Took 0.31562 seconds. 
  Full-batch training loss = 0.232860, test loss = 0.269863
  Training set accuracy = 0.935300, Test set accuracy = 0.924600
 epoch 14/30. Took 0.31483 seconds. 
  Full-batch training loss = 0.226538, test loss = 0.264868
  Training set accuracy = 0.935400, Test set accuracy = 0.925100
 epoch 15/30. Took 0.31413 seconds. 
  Full-batch training loss = 0.217972, test loss = 0.258579
  Training set accuracy = 0.939900, Test set accuracy = 0.927200
 epoch 16/30. Took 0.31558 seconds. 
  Full-batch training loss = 0.212943, test loss = 0.257214
  Training set accuracy = 0.939700, Test set accuracy = 0.926300
 epoch 17/30. Took 0.31401 seconds. 
  Full-batch training loss = 0.206291, test loss = 0.250866
  Training set accuracy = 0.943100, Test set accuracy = 0.928100
 epoch 18/30. Took 0.31592 seconds. 
  Full-batch training loss = 0.198488, test loss = 0.246336
  Training set accuracy = 0.945400, Test set accuracy = 0.929200
 epoch 19/30. Took 0.31767 seconds. 
  Full-batch training loss = 0.193350, test loss = 0.242593
  Training set accuracy = 0.947400, Test set accuracy = 0.932300
 epoch 20/30. Took 0.3275 seconds. 
  Full-batch training loss = 0.187291, test loss = 0.238587
  Training set accuracy = 0.948100, Test set accuracy = 0.933300
 epoch 21/30. Took 0.31342 seconds. 
  Full-batch training loss = 0.182451, test loss = 0.236906
  Training set accuracy = 0.951400, Test set accuracy = 0.933200
 epoch 22/30. Took 0.31445 seconds. 
  Full-batch training loss = 0.176529, test loss = 0.230970
  Training set accuracy = 0.952600, Test set accuracy = 0.932500
 epoch 23/30. Took 0.31656 seconds. 
  Full-batch training loss = 0.172138, test loss = 0.231482
  Training set accuracy = 0.953300, Test set accuracy = 0.935900
 epoch 24/30. Took 0.31707 seconds. 
  Full-batch training loss = 0.168597, test loss = 0.227102
  Training set accuracy = 0.954000, Test set accuracy = 0.934800
 epoch 25/30. Took 0.31609 seconds. 
  Full-batch training loss = 0.162694, test loss = 0.223758
  Training set accuracy = 0.958100, Test set accuracy = 0.935700
 epoch 26/30. Took 0.31848 seconds. 
  Full-batch training loss = 0.157908, test loss = 0.220154
  Training set accuracy = 0.958800, Test set accuracy = 0.937800
 epoch 27/30. Took 0.31547 seconds. 
  Full-batch training loss = 0.154088, test loss = 0.216819
  Training set accuracy = 0.959800, Test set accuracy = 0.937700
 epoch 28/30. Took 0.3162 seconds. 
  Full-batch training loss = 0.150314, test loss = 0.215329
  Training set accuracy = 0.961400, Test set accuracy = 0.936000
 epoch 29/30. Took 0.3136 seconds. 
  Full-batch training loss = 0.145509, test loss = 0.213215
  Training set accuracy = 0.961200, Test set accuracy = 0.938900
 epoch 30/30. Took 0.32462 seconds. 
  Full-batch training loss = 0.141184, test loss = 0.209038
  Training set accuracy = 0.963800, Test set accuracy = 0.939500
Elapsed time is 17.546444 seconds.
End Training
-----
Params 10000 0.010 0.00 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.65491 seconds. 
  Full-batch training loss = 0.698174, test loss = 0.680084
  Training set accuracy = 0.855400, Test set accuracy = 0.856800
 epoch 2/30. Took 0.65406 seconds. 
  Full-batch training loss = 0.476033, test loss = 0.463874
  Training set accuracy = 0.881600, Test set accuracy = 0.883100
 epoch 3/30. Took 0.65389 seconds. 
  Full-batch training loss = 0.402188, test loss = 0.393786
  Training set accuracy = 0.894900, Test set accuracy = 0.892600
 epoch 4/30. Took 0.65402 seconds. 
  Full-batch training loss = 0.361007, test loss = 0.359249
  Training set accuracy = 0.906200, Test set accuracy = 0.900200
 epoch 5/30. Took 0.66705 seconds. 
  Full-batch training loss = 0.339049, test loss = 0.340514
  Training set accuracy = 0.910300, Test set accuracy = 0.904400
 epoch 6/30. Took 0.65002 seconds. 
  Full-batch training loss = 0.315403, test loss = 0.320377
  Training set accuracy = 0.913900, Test set accuracy = 0.909800
 epoch 7/30. Took 0.64924 seconds. 
  Full-batch training loss = 0.299551, test loss = 0.310346
  Training set accuracy = 0.920600, Test set accuracy = 0.910900
 epoch 8/30. Took 0.65024 seconds. 
  Full-batch training loss = 0.285708, test loss = 0.299693
  Training set accuracy = 0.923100, Test set accuracy = 0.913800
 epoch 9/30. Took 0.65315 seconds. 
  Full-batch training loss = 0.273311, test loss = 0.289210
  Training set accuracy = 0.927300, Test set accuracy = 0.916700
 epoch 10/30. Took 0.64939 seconds. 
  Full-batch training loss = 0.262326, test loss = 0.281206
  Training set accuracy = 0.930400, Test set accuracy = 0.919400
 epoch 11/30. Took 0.65763 seconds. 
  Full-batch training loss = 0.253878, test loss = 0.279089
  Training set accuracy = 0.931200, Test set accuracy = 0.919100
 epoch 12/30. Took 0.64826 seconds. 
  Full-batch training loss = 0.242329, test loss = 0.268822
  Training set accuracy = 0.936100, Test set accuracy = 0.923500
 epoch 13/30. Took 0.65243 seconds. 
  Full-batch training loss = 0.237580, test loss = 0.265800
  Training set accuracy = 0.935900, Test set accuracy = 0.923100
 epoch 14/30. Took 0.68804 seconds. 
  Full-batch training loss = 0.226726, test loss = 0.257475
  Training set accuracy = 0.939400, Test set accuracy = 0.925200
 epoch 15/30. Took 0.65058 seconds. 
  Full-batch training loss = 0.220615, test loss = 0.252141
  Training set accuracy = 0.941000, Test set accuracy = 0.925900
 epoch 16/30. Took 0.64921 seconds. 
  Full-batch training loss = 0.213996, test loss = 0.249599
  Training set accuracy = 0.943100, Test set accuracy = 0.926100
 epoch 17/30. Took 0.64953 seconds. 
  Full-batch training loss = 0.205464, test loss = 0.244059
  Training set accuracy = 0.945900, Test set accuracy = 0.927400
 epoch 18/30. Took 0.67147 seconds. 
  Full-batch training loss = 0.199431, test loss = 0.239403
  Training set accuracy = 0.945300, Test set accuracy = 0.929900
 epoch 19/30. Took 0.64754 seconds. 
  Full-batch training loss = 0.194141, test loss = 0.237660
  Training set accuracy = 0.947200, Test set accuracy = 0.929100
 epoch 20/30. Took 0.65075 seconds. 
  Full-batch training loss = 0.186175, test loss = 0.230382
  Training set accuracy = 0.950000, Test set accuracy = 0.932000
 epoch 21/30. Took 0.65081 seconds. 
  Full-batch training loss = 0.181528, test loss = 0.228856
  Training set accuracy = 0.951300, Test set accuracy = 0.931600
 epoch 22/30. Took 0.66821 seconds. 
  Full-batch training loss = 0.175709, test loss = 0.222629
  Training set accuracy = 0.953400, Test set accuracy = 0.933400
 epoch 23/30. Took 0.6498 seconds. 
  Full-batch training loss = 0.171354, test loss = 0.221730
  Training set accuracy = 0.954500, Test set accuracy = 0.933800
 epoch 24/30. Took 0.65 seconds. 
  Full-batch training loss = 0.165799, test loss = 0.216596
  Training set accuracy = 0.958500, Test set accuracy = 0.935900
 epoch 25/30. Took 0.64913 seconds. 
  Full-batch training loss = 0.160195, test loss = 0.214664
  Training set accuracy = 0.959700, Test set accuracy = 0.935400
 epoch 26/30. Took 0.64863 seconds. 
  Full-batch training loss = 0.159328, test loss = 0.216141
  Training set accuracy = 0.959800, Test set accuracy = 0.934700
 epoch 27/30. Took 0.64872 seconds. 
  Full-batch training loss = 0.153281, test loss = 0.210080
  Training set accuracy = 0.961400, Test set accuracy = 0.938000
 epoch 28/30. Took 0.65075 seconds. 
  Full-batch training loss = 0.147790, test loss = 0.208036
  Training set accuracy = 0.961400, Test set accuracy = 0.939000
 epoch 29/30. Took 0.65845 seconds. 
  Full-batch training loss = 0.144555, test loss = 0.205177
  Training set accuracy = 0.962900, Test set accuracy = 0.938800
 epoch 30/30. Took 0.65152 seconds. 
  Full-batch training loss = 0.141249, test loss = 0.203685
  Training set accuracy = 0.964600, Test set accuracy = 0.938700
Elapsed time is 34.670096 seconds.
End Training
-----
Params 10000 0.010 0.00 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23606 seconds. 
  Full-batch training loss = 0.760438, test loss = 0.745941
  Training set accuracy = 0.824800, Test set accuracy = 0.827000
 epoch 2/30. Took 0.23454 seconds. 
  Full-batch training loss = 0.442588, test loss = 0.438917
  Training set accuracy = 0.879800, Test set accuracy = 0.880600
 epoch 3/30. Took 0.23637 seconds. 
  Full-batch training loss = 0.363011, test loss = 0.368040
  Training set accuracy = 0.897600, Test set accuracy = 0.894000
 epoch 4/30. Took 0.23687 seconds. 
  Full-batch training loss = 0.329696, test loss = 0.346318
  Training set accuracy = 0.904900, Test set accuracy = 0.897000
 epoch 5/30. Took 0.2385 seconds. 
  Full-batch training loss = 0.289760, test loss = 0.314139
  Training set accuracy = 0.918000, Test set accuracy = 0.908500
 epoch 6/30. Took 0.23658 seconds. 
  Full-batch training loss = 0.269190, test loss = 0.296838
  Training set accuracy = 0.922100, Test set accuracy = 0.913700
 epoch 7/30. Took 0.23537 seconds. 
  Full-batch training loss = 0.253021, test loss = 0.288034
  Training set accuracy = 0.928000, Test set accuracy = 0.916200
 epoch 8/30. Took 0.22872 seconds. 
  Full-batch training loss = 0.235361, test loss = 0.274832
  Training set accuracy = 0.931800, Test set accuracy = 0.920100
 epoch 9/30. Took 0.23608 seconds. 
  Full-batch training loss = 0.221050, test loss = 0.266511
  Training set accuracy = 0.934400, Test set accuracy = 0.919600
 epoch 10/30. Took 0.23251 seconds. 
  Full-batch training loss = 0.220673, test loss = 0.268801
  Training set accuracy = 0.934500, Test set accuracy = 0.920900
 epoch 11/30. Took 0.23589 seconds. 
  Full-batch training loss = 0.198382, test loss = 0.249861
  Training set accuracy = 0.942500, Test set accuracy = 0.926800
 epoch 12/30. Took 0.25614 seconds. 
  Full-batch training loss = 0.190390, test loss = 0.248291
  Training set accuracy = 0.944100, Test set accuracy = 0.928700
 epoch 13/30. Took 0.24651 seconds. 
  Full-batch training loss = 0.180460, test loss = 0.242334
  Training set accuracy = 0.948800, Test set accuracy = 0.929600
 epoch 14/30. Took 0.2323 seconds. 
  Full-batch training loss = 0.171780, test loss = 0.237353
  Training set accuracy = 0.951100, Test set accuracy = 0.929300
 epoch 15/30. Took 0.23842 seconds. 
  Full-batch training loss = 0.166889, test loss = 0.236545
  Training set accuracy = 0.952400, Test set accuracy = 0.930800
 epoch 16/30. Took 0.23029 seconds. 
  Full-batch training loss = 0.157241, test loss = 0.231353
  Training set accuracy = 0.957200, Test set accuracy = 0.931900
 epoch 17/30. Took 0.2472 seconds. 
  Full-batch training loss = 0.150190, test loss = 0.228849
  Training set accuracy = 0.959000, Test set accuracy = 0.934700
 epoch 18/30. Took 0.24158 seconds. 
  Full-batch training loss = 0.143119, test loss = 0.223444
  Training set accuracy = 0.959800, Test set accuracy = 0.934300
 epoch 19/30. Took 0.23503 seconds. 
  Full-batch training loss = 0.137799, test loss = 0.223960
  Training set accuracy = 0.962200, Test set accuracy = 0.935100
 epoch 20/30. Took 0.23569 seconds. 
  Full-batch training loss = 0.126733, test loss = 0.214121
  Training set accuracy = 0.965800, Test set accuracy = 0.938400
 epoch 21/30. Took 0.25056 seconds. 
  Full-batch training loss = 0.117322, test loss = 0.207920
  Training set accuracy = 0.968800, Test set accuracy = 0.938600
 epoch 22/30. Took 0.24954 seconds. 
  Full-batch training loss = 0.110663, test loss = 0.204103
  Training set accuracy = 0.971600, Test set accuracy = 0.941800
 epoch 23/30. Took 0.24521 seconds. 
  Full-batch training loss = 0.108623, test loss = 0.205740
  Training set accuracy = 0.972800, Test set accuracy = 0.941200
 epoch 24/30. Took 0.2339 seconds. 
  Full-batch training loss = 0.109493, test loss = 0.209343
  Training set accuracy = 0.971400, Test set accuracy = 0.940400
 epoch 25/30. Took 0.23651 seconds. 
  Full-batch training loss = 0.099580, test loss = 0.199581
  Training set accuracy = 0.976100, Test set accuracy = 0.942200
 epoch 26/30. Took 0.2355 seconds. 
  Full-batch training loss = 0.090920, test loss = 0.196075
  Training set accuracy = 0.979600, Test set accuracy = 0.944300
 epoch 27/30. Took 0.23623 seconds. 
  Full-batch training loss = 0.085437, test loss = 0.190493
  Training set accuracy = 0.981800, Test set accuracy = 0.945500
 epoch 28/30. Took 0.23659 seconds. 
  Full-batch training loss = 0.086067, test loss = 0.196653
  Training set accuracy = 0.980900, Test set accuracy = 0.943500
 epoch 29/30. Took 0.23461 seconds. 
  Full-batch training loss = 0.080712, test loss = 0.193716
  Training set accuracy = 0.981500, Test set accuracy = 0.944500
 epoch 30/30. Took 0.23673 seconds. 
  Full-batch training loss = 0.075866, test loss = 0.190667
  Training set accuracy = 0.983500, Test set accuracy = 0.945200
Elapsed time is 14.130975 seconds.
End Training
-----
Params 10000 0.010 0.00 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.41076 seconds. 
  Full-batch training loss = 0.742915, test loss = 0.737843
  Training set accuracy = 0.824400, Test set accuracy = 0.824700
 epoch 2/30. Took 0.39691 seconds. 
  Full-batch training loss = 0.429974, test loss = 0.430418
  Training set accuracy = 0.885100, Test set accuracy = 0.885100
 epoch 3/30. Took 0.40099 seconds. 
  Full-batch training loss = 0.350256, test loss = 0.358629
  Training set accuracy = 0.898800, Test set accuracy = 0.899700
 epoch 4/30. Took 0.44536 seconds. 
  Full-batch training loss = 0.313647, test loss = 0.328925
  Training set accuracy = 0.906300, Test set accuracy = 0.904300
 epoch 5/30. Took 0.39978 seconds. 
  Full-batch training loss = 0.286537, test loss = 0.310858
  Training set accuracy = 0.915700, Test set accuracy = 0.909600
 epoch 6/30. Took 0.4024 seconds. 
  Full-batch training loss = 0.263515, test loss = 0.290664
  Training set accuracy = 0.920900, Test set accuracy = 0.913800
 epoch 7/30. Took 0.4009 seconds. 
  Full-batch training loss = 0.250292, test loss = 0.289938
  Training set accuracy = 0.925800, Test set accuracy = 0.915600
 epoch 8/30. Took 0.41921 seconds. 
  Full-batch training loss = 0.225361, test loss = 0.264063
  Training set accuracy = 0.934400, Test set accuracy = 0.923800
 epoch 9/30. Took 0.39836 seconds. 
  Full-batch training loss = 0.215926, test loss = 0.263169
  Training set accuracy = 0.938800, Test set accuracy = 0.924700
 epoch 10/30. Took 0.39959 seconds. 
  Full-batch training loss = 0.205898, test loss = 0.254309
  Training set accuracy = 0.939300, Test set accuracy = 0.926200
 epoch 11/30. Took 0.41268 seconds. 
  Full-batch training loss = 0.188589, test loss = 0.239832
  Training set accuracy = 0.949500, Test set accuracy = 0.931100
 epoch 12/30. Took 0.41768 seconds. 
  Full-batch training loss = 0.187769, test loss = 0.245187
  Training set accuracy = 0.942900, Test set accuracy = 0.925800
 epoch 13/30. Took 0.40071 seconds. 
  Full-batch training loss = 0.167270, test loss = 0.227146
  Training set accuracy = 0.955100, Test set accuracy = 0.933300
 epoch 14/30. Took 0.40027 seconds. 
  Full-batch training loss = 0.158604, test loss = 0.222223
  Training set accuracy = 0.956400, Test set accuracy = 0.935400
 epoch 15/30. Took 0.43137 seconds. 
  Full-batch training loss = 0.151646, test loss = 0.223071
  Training set accuracy = 0.958000, Test set accuracy = 0.935600
 epoch 16/30. Took 0.40688 seconds. 
  Full-batch training loss = 0.141783, test loss = 0.215452
  Training set accuracy = 0.962200, Test set accuracy = 0.936400
 epoch 17/30. Took 0.39417 seconds. 
  Full-batch training loss = 0.137587, test loss = 0.214019
  Training set accuracy = 0.962200, Test set accuracy = 0.937400
 epoch 18/30. Took 0.40187 seconds. 
  Full-batch training loss = 0.127223, test loss = 0.203866
  Training set accuracy = 0.966900, Test set accuracy = 0.940900
 epoch 19/30. Took 0.40002 seconds. 
  Full-batch training loss = 0.123177, test loss = 0.202386
  Training set accuracy = 0.966100, Test set accuracy = 0.939500
 epoch 20/30. Took 0.40293 seconds. 
  Full-batch training loss = 0.116886, test loss = 0.203227
  Training set accuracy = 0.969300, Test set accuracy = 0.940900
 epoch 21/30. Took 0.4355 seconds. 
  Full-batch training loss = 0.109601, test loss = 0.196778
  Training set accuracy = 0.970200, Test set accuracy = 0.942000
 epoch 22/30. Took 0.39876 seconds. 
  Full-batch training loss = 0.103363, test loss = 0.193124
  Training set accuracy = 0.973700, Test set accuracy = 0.943400
 epoch 23/30. Took 0.39988 seconds. 
  Full-batch training loss = 0.101040, test loss = 0.194524
  Training set accuracy = 0.973300, Test set accuracy = 0.942600
 epoch 24/30. Took 0.4004 seconds. 
  Full-batch training loss = 0.093901, test loss = 0.188881
  Training set accuracy = 0.975400, Test set accuracy = 0.943600
 epoch 25/30. Took 0.40538 seconds. 
  Full-batch training loss = 0.090166, test loss = 0.188661
  Training set accuracy = 0.978300, Test set accuracy = 0.943900
 epoch 26/30. Took 0.39855 seconds. 
  Full-batch training loss = 0.087513, test loss = 0.187240
  Training set accuracy = 0.978600, Test set accuracy = 0.942900
 epoch 27/30. Took 0.40054 seconds. 
  Full-batch training loss = 0.081147, test loss = 0.184825
  Training set accuracy = 0.980500, Test set accuracy = 0.945000
 epoch 28/30. Took 0.40103 seconds. 
  Full-batch training loss = 0.077188, test loss = 0.182363
  Training set accuracy = 0.982400, Test set accuracy = 0.946100
 epoch 29/30. Took 0.39601 seconds. 
  Full-batch training loss = 0.073170, test loss = 0.182336
  Training set accuracy = 0.983200, Test set accuracy = 0.947300
 epoch 30/30. Took 0.39329 seconds. 
  Full-batch training loss = 0.069030, test loss = 0.179095
  Training set accuracy = 0.985400, Test set accuracy = 0.947400
Elapsed time is 22.006268 seconds.
End Training
-----
Params 10000 0.010 0.00 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2491 seconds. 
  Full-batch training loss = 0.655863, test loss = 0.643264
  Training set accuracy = 0.844300, Test set accuracy = 0.846500
 epoch 2/30. Took 1.0477 seconds. 
  Full-batch training loss = 0.416869, test loss = 0.413035
  Training set accuracy = 0.883800, Test set accuracy = 0.885200
 epoch 3/30. Took 1.05 seconds. 
  Full-batch training loss = 0.351126, test loss = 0.357451
  Training set accuracy = 0.902300, Test set accuracy = 0.893500
 epoch 4/30. Took 1.0452 seconds. 
  Full-batch training loss = 0.301423, test loss = 0.310923
  Training set accuracy = 0.911100, Test set accuracy = 0.909700
 epoch 5/30. Took 1.0503 seconds. 
  Full-batch training loss = 0.283846, test loss = 0.300415
  Training set accuracy = 0.916800, Test set accuracy = 0.910600
 epoch 6/30. Took 1.0466 seconds. 
  Full-batch training loss = 0.249004, test loss = 0.270265
  Training set accuracy = 0.927800, Test set accuracy = 0.920800
 epoch 7/30. Took 1.0425 seconds. 
  Full-batch training loss = 0.236045, test loss = 0.266418
  Training set accuracy = 0.930900, Test set accuracy = 0.922600
 epoch 8/30. Took 1.0496 seconds. 
  Full-batch training loss = 0.221628, test loss = 0.258689
  Training set accuracy = 0.934400, Test set accuracy = 0.923100
 epoch 9/30. Took 1.062 seconds. 
  Full-batch training loss = 0.204001, test loss = 0.241913
  Training set accuracy = 0.938900, Test set accuracy = 0.927700
 epoch 10/30. Took 1.063 seconds. 
  Full-batch training loss = 0.191863, test loss = 0.235519
  Training set accuracy = 0.944800, Test set accuracy = 0.933600
 epoch 11/30. Took 1.0585 seconds. 
  Full-batch training loss = 0.179041, test loss = 0.226278
  Training set accuracy = 0.948900, Test set accuracy = 0.934900
 epoch 12/30. Took 1.0519 seconds. 
  Full-batch training loss = 0.166782, test loss = 0.217617
  Training set accuracy = 0.952300, Test set accuracy = 0.937000
 epoch 13/30. Took 1.0442 seconds. 
  Full-batch training loss = 0.162400, test loss = 0.212877
  Training set accuracy = 0.954800, Test set accuracy = 0.937600
 epoch 14/30. Took 1.0655 seconds. 
  Full-batch training loss = 0.145135, test loss = 0.202495
  Training set accuracy = 0.959100, Test set accuracy = 0.940800
 epoch 15/30. Took 1.046 seconds. 
  Full-batch training loss = 0.140920, test loss = 0.205205
  Training set accuracy = 0.959800, Test set accuracy = 0.940000
 epoch 16/30. Took 1.0459 seconds. 
  Full-batch training loss = 0.130869, test loss = 0.195927
  Training set accuracy = 0.964100, Test set accuracy = 0.941700
 epoch 17/30. Took 1.0465 seconds. 
  Full-batch training loss = 0.120467, test loss = 0.190467
  Training set accuracy = 0.967600, Test set accuracy = 0.943700
 epoch 18/30. Took 1.0633 seconds. 
  Full-batch training loss = 0.114856, test loss = 0.190068
  Training set accuracy = 0.969800, Test set accuracy = 0.942900
 epoch 19/30. Took 1.0739 seconds. 
  Full-batch training loss = 0.110892, test loss = 0.189434
  Training set accuracy = 0.970500, Test set accuracy = 0.944600
 epoch 20/30. Took 1.0548 seconds. 
  Full-batch training loss = 0.108277, test loss = 0.191374
  Training set accuracy = 0.971400, Test set accuracy = 0.945000
 epoch 21/30. Took 1.1466 seconds. 
  Full-batch training loss = 0.096849, test loss = 0.178444
  Training set accuracy = 0.976800, Test set accuracy = 0.946300
 epoch 22/30. Took 1.0456 seconds. 
  Full-batch training loss = 0.090081, test loss = 0.173861
  Training set accuracy = 0.977400, Test set accuracy = 0.949500
 epoch 23/30. Took 1.0459 seconds. 
  Full-batch training loss = 0.083343, test loss = 0.169776
  Training set accuracy = 0.981600, Test set accuracy = 0.950200
 epoch 24/30. Took 1.0561 seconds. 
  Full-batch training loss = 0.078658, test loss = 0.167967
  Training set accuracy = 0.982800, Test set accuracy = 0.951300
 epoch 25/30. Took 1.0477 seconds. 
  Full-batch training loss = 0.075933, test loss = 0.171705
  Training set accuracy = 0.982800, Test set accuracy = 0.949800
 epoch 26/30. Took 1.0452 seconds. 
  Full-batch training loss = 0.070154, test loss = 0.165906
  Training set accuracy = 0.984400, Test set accuracy = 0.951800
 epoch 27/30. Took 1.0521 seconds. 
  Full-batch training loss = 0.065590, test loss = 0.161947
  Training set accuracy = 0.986000, Test set accuracy = 0.952800
 epoch 28/30. Took 1.0478 seconds. 
  Full-batch training loss = 0.062612, test loss = 0.161900
  Training set accuracy = 0.987000, Test set accuracy = 0.952900
 epoch 29/30. Took 1.0536 seconds. 
  Full-batch training loss = 0.058915, test loss = 0.161161
  Training set accuracy = 0.987700, Test set accuracy = 0.952600
 epoch 30/30. Took 1.0463 seconds. 
  Full-batch training loss = 0.054556, test loss = 0.156083
  Training set accuracy = 0.989700, Test set accuracy = 0.954700
Elapsed time is 55.649124 seconds.
End Training
-----
Params 10000 0.010 0.00 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28482 seconds. 
  Full-batch training loss = 1.036896, test loss = 1.025188
  Training set accuracy = 0.777900, Test set accuracy = 0.773800
 epoch 2/30. Took 0.26379 seconds. 
  Full-batch training loss = 0.474742, test loss = 0.475502
  Training set accuracy = 0.863300, Test set accuracy = 0.860200
 epoch 3/30. Took 0.25822 seconds. 
  Full-batch training loss = 0.354790, test loss = 0.375155
  Training set accuracy = 0.900500, Test set accuracy = 0.891300
 epoch 4/30. Took 0.26084 seconds. 
  Full-batch training loss = 0.299753, test loss = 0.323926
  Training set accuracy = 0.915700, Test set accuracy = 0.905400
 epoch 5/30. Took 0.28512 seconds. 
  Full-batch training loss = 0.265151, test loss = 0.298163
  Training set accuracy = 0.925200, Test set accuracy = 0.913300
 epoch 6/30. Took 0.26584 seconds. 
  Full-batch training loss = 0.239839, test loss = 0.279092
  Training set accuracy = 0.931200, Test set accuracy = 0.919200
 epoch 7/30. Took 0.27391 seconds. 
  Full-batch training loss = 0.223110, test loss = 0.266636
  Training set accuracy = 0.934400, Test set accuracy = 0.923800
 epoch 8/30. Took 0.27199 seconds. 
  Full-batch training loss = 0.207779, test loss = 0.253846
  Training set accuracy = 0.939100, Test set accuracy = 0.927100
 epoch 9/30. Took 0.26499 seconds. 
  Full-batch training loss = 0.191408, test loss = 0.251809
  Training set accuracy = 0.944400, Test set accuracy = 0.926200
 epoch 10/30. Took 0.28953 seconds. 
  Full-batch training loss = 0.178951, test loss = 0.243300
  Training set accuracy = 0.946200, Test set accuracy = 0.929100
 epoch 11/30. Took 0.26432 seconds. 
  Full-batch training loss = 0.158718, test loss = 0.232360
  Training set accuracy = 0.953700, Test set accuracy = 0.930700
 epoch 12/30. Took 0.26481 seconds. 
  Full-batch training loss = 0.151776, test loss = 0.225560
  Training set accuracy = 0.957500, Test set accuracy = 0.935200
 epoch 13/30. Took 0.2653 seconds. 
  Full-batch training loss = 0.147432, test loss = 0.225383
  Training set accuracy = 0.956400, Test set accuracy = 0.934100
 epoch 14/30. Took 0.26592 seconds. 
  Full-batch training loss = 0.133363, test loss = 0.219649
  Training set accuracy = 0.963200, Test set accuracy = 0.934900
 epoch 15/30. Took 0.27194 seconds. 
  Full-batch training loss = 0.115945, test loss = 0.202234
  Training set accuracy = 0.968800, Test set accuracy = 0.940800
 epoch 16/30. Took 0.2727 seconds. 
  Full-batch training loss = 0.112264, test loss = 0.210174
  Training set accuracy = 0.969400, Test set accuracy = 0.938900
 epoch 17/30. Took 0.27091 seconds. 
  Full-batch training loss = 0.099606, test loss = 0.195739
  Training set accuracy = 0.973000, Test set accuracy = 0.941900
 epoch 18/30. Took 0.25762 seconds. 
  Full-batch training loss = 0.092576, test loss = 0.194068
  Training set accuracy = 0.976200, Test set accuracy = 0.944200
 epoch 19/30. Took 0.25806 seconds. 
  Full-batch training loss = 0.085647, test loss = 0.190861
  Training set accuracy = 0.978100, Test set accuracy = 0.945000
 epoch 20/30. Took 0.26393 seconds. 
  Full-batch training loss = 0.094051, test loss = 0.207707
  Training set accuracy = 0.974100, Test set accuracy = 0.940500
 epoch 21/30. Took 0.26507 seconds. 
  Full-batch training loss = 0.076952, test loss = 0.193370
  Training set accuracy = 0.981000, Test set accuracy = 0.944800
 epoch 22/30. Took 0.26256 seconds. 
  Full-batch training loss = 0.066061, test loss = 0.185101
  Training set accuracy = 0.986000, Test set accuracy = 0.946800
 epoch 23/30. Took 0.26561 seconds. 
  Full-batch training loss = 0.062514, test loss = 0.182665
  Training set accuracy = 0.986900, Test set accuracy = 0.947700
 epoch 24/30. Took 0.26424 seconds. 
  Full-batch training loss = 0.062058, test loss = 0.192681
  Training set accuracy = 0.986000, Test set accuracy = 0.943700
 epoch 25/30. Took 0.26535 seconds. 
  Full-batch training loss = 0.052116, test loss = 0.184865
  Training set accuracy = 0.989800, Test set accuracy = 0.948100
 epoch 26/30. Took 0.26137 seconds. 
  Full-batch training loss = 0.053188, test loss = 0.193919
  Training set accuracy = 0.989500, Test set accuracy = 0.944700
 epoch 27/30. Took 0.26755 seconds. 
  Full-batch training loss = 0.044781, test loss = 0.184299
  Training set accuracy = 0.991400, Test set accuracy = 0.946300
 epoch 28/30. Took 0.2808 seconds. 
  Full-batch training loss = 0.044377, test loss = 0.189283
  Training set accuracy = 0.990500, Test set accuracy = 0.945700
 epoch 29/30. Took 0.26271 seconds. 
  Full-batch training loss = 0.041737, test loss = 0.190775
  Training set accuracy = 0.991100, Test set accuracy = 0.946000
 epoch 30/30. Took 0.27374 seconds. 
  Full-batch training loss = 0.033695, test loss = 0.180597
  Training set accuracy = 0.995500, Test set accuracy = 0.948600
Elapsed time is 15.771731 seconds.
End Training
-----
Params 10000 0.010 0.00 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.47754 seconds. 
  Full-batch training loss = 0.840942, test loss = 0.831637
  Training set accuracy = 0.758100, Test set accuracy = 0.761600
 epoch 2/30. Took 0.47182 seconds. 
  Full-batch training loss = 0.440985, test loss = 0.427634
  Training set accuracy = 0.873100, Test set accuracy = 0.879800
 epoch 3/30. Took 0.47102 seconds. 
  Full-batch training loss = 0.358744, test loss = 0.361822
  Training set accuracy = 0.896600, Test set accuracy = 0.894200
 epoch 4/30. Took 0.47981 seconds. 
  Full-batch training loss = 0.317284, test loss = 0.325337
  Training set accuracy = 0.907800, Test set accuracy = 0.907000
 epoch 5/30. Took 0.46935 seconds. 
  Full-batch training loss = 0.267412, test loss = 0.282577
  Training set accuracy = 0.922100, Test set accuracy = 0.916600
 epoch 6/30. Took 0.46536 seconds. 
  Full-batch training loss = 0.239725, test loss = 0.267348
  Training set accuracy = 0.931000, Test set accuracy = 0.923600
 epoch 7/30. Took 0.46393 seconds. 
  Full-batch training loss = 0.221170, test loss = 0.248734
  Training set accuracy = 0.936600, Test set accuracy = 0.928200
 epoch 8/30. Took 0.50187 seconds. 
  Full-batch training loss = 0.213261, test loss = 0.250960
  Training set accuracy = 0.939000, Test set accuracy = 0.924800
 epoch 9/30. Took 0.47008 seconds. 
  Full-batch training loss = 0.188928, test loss = 0.229322
  Training set accuracy = 0.946300, Test set accuracy = 0.933700
 epoch 10/30. Took 0.47176 seconds. 
  Full-batch training loss = 0.177099, test loss = 0.230509
  Training set accuracy = 0.948200, Test set accuracy = 0.929300
 epoch 11/30. Took 0.48896 seconds. 
  Full-batch training loss = 0.161197, test loss = 0.217500
  Training set accuracy = 0.952100, Test set accuracy = 0.934700
 epoch 12/30. Took 0.4707 seconds. 
  Full-batch training loss = 0.150552, test loss = 0.215108
  Training set accuracy = 0.956500, Test set accuracy = 0.935400
 epoch 13/30. Took 0.47333 seconds. 
  Full-batch training loss = 0.134755, test loss = 0.205774
  Training set accuracy = 0.962100, Test set accuracy = 0.937900
 epoch 14/30. Took 0.47306 seconds. 
  Full-batch training loss = 0.118456, test loss = 0.194662
  Training set accuracy = 0.969500, Test set accuracy = 0.942500
 epoch 15/30. Took 0.47217 seconds. 
  Full-batch training loss = 0.122581, test loss = 0.203361
  Training set accuracy = 0.964300, Test set accuracy = 0.940300
 epoch 16/30. Took 0.47373 seconds. 
  Full-batch training loss = 0.100507, test loss = 0.183164
  Training set accuracy = 0.973500, Test set accuracy = 0.944100
 epoch 17/30. Took 0.47757 seconds. 
  Full-batch training loss = 0.093803, test loss = 0.183475
  Training set accuracy = 0.977800, Test set accuracy = 0.944400
 epoch 18/30. Took 0.4608 seconds. 
  Full-batch training loss = 0.089834, test loss = 0.183440
  Training set accuracy = 0.977800, Test set accuracy = 0.944400
 epoch 19/30. Took 0.46873 seconds. 
  Full-batch training loss = 0.082199, test loss = 0.183093
  Training set accuracy = 0.979800, Test set accuracy = 0.944900
 epoch 20/30. Took 0.47449 seconds. 
  Full-batch training loss = 0.078490, test loss = 0.181553
  Training set accuracy = 0.981500, Test set accuracy = 0.945000
 epoch 21/30. Took 0.46326 seconds. 
  Full-batch training loss = 0.068523, test loss = 0.177700
  Training set accuracy = 0.983400, Test set accuracy = 0.946400
 epoch 22/30. Took 0.47604 seconds. 
  Full-batch training loss = 0.061529, test loss = 0.168700
  Training set accuracy = 0.987200, Test set accuracy = 0.949000
 epoch 23/30. Took 0.46811 seconds. 
  Full-batch training loss = 0.054798, test loss = 0.168241
  Training set accuracy = 0.988500, Test set accuracy = 0.950300
 epoch 24/30. Took 0.48873 seconds. 
  Full-batch training loss = 0.048794, test loss = 0.166670
  Training set accuracy = 0.991600, Test set accuracy = 0.950000
 epoch 25/30. Took 0.48377 seconds. 
  Full-batch training loss = 0.049473, test loss = 0.174071
  Training set accuracy = 0.989900, Test set accuracy = 0.946800
 epoch 26/30. Took 0.48633 seconds. 
  Full-batch training loss = 0.044736, test loss = 0.169860
  Training set accuracy = 0.991200, Test set accuracy = 0.948900
 epoch 27/30. Took 0.46897 seconds. 
  Full-batch training loss = 0.040586, test loss = 0.167240
  Training set accuracy = 0.993900, Test set accuracy = 0.950600
 epoch 28/30. Took 0.46032 seconds. 
  Full-batch training loss = 0.036509, test loss = 0.165054
  Training set accuracy = 0.994300, Test set accuracy = 0.951100
 epoch 29/30. Took 0.46598 seconds. 
  Full-batch training loss = 0.032194, test loss = 0.166132
  Training set accuracy = 0.995400, Test set accuracy = 0.951300
 epoch 30/30. Took 0.47863 seconds. 
  Full-batch training loss = 0.033986, test loss = 0.171130
  Training set accuracy = 0.994100, Test set accuracy = 0.949400
Elapsed time is 27.550059 seconds.
End Training
-----
Params 10000 0.010 0.00 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.447 seconds. 
  Full-batch training loss = 0.654639, test loss = 0.639678
  Training set accuracy = 0.848500, Test set accuracy = 0.851900
 epoch 2/30. Took 1.4219 seconds. 
  Full-batch training loss = 0.411132, test loss = 0.415678
  Training set accuracy = 0.879500, Test set accuracy = 0.876700
 epoch 3/30. Took 1.4206 seconds. 
  Full-batch training loss = 0.312059, test loss = 0.320577
  Training set accuracy = 0.912300, Test set accuracy = 0.906500
 epoch 4/30. Took 1.4249 seconds. 
  Full-batch training loss = 0.279739, test loss = 0.300470
  Training set accuracy = 0.920700, Test set accuracy = 0.912400
 epoch 5/30. Took 1.4202 seconds. 
  Full-batch training loss = 0.247578, test loss = 0.270467
  Training set accuracy = 0.928500, Test set accuracy = 0.921000
 epoch 6/30. Took 1.4239 seconds. 
  Full-batch training loss = 0.215950, test loss = 0.250183
  Training set accuracy = 0.938200, Test set accuracy = 0.926500
 epoch 7/30. Took 1.4316 seconds. 
  Full-batch training loss = 0.190348, test loss = 0.233109
  Training set accuracy = 0.947400, Test set accuracy = 0.931200
 epoch 8/30. Took 1.4241 seconds. 
  Full-batch training loss = 0.184791, test loss = 0.229194
  Training set accuracy = 0.948600, Test set accuracy = 0.932800
 epoch 9/30. Took 1.4256 seconds. 
  Full-batch training loss = 0.163333, test loss = 0.215895
  Training set accuracy = 0.957300, Test set accuracy = 0.937000
 epoch 10/30. Took 1.4246 seconds. 
  Full-batch training loss = 0.148400, test loss = 0.208323
  Training set accuracy = 0.961500, Test set accuracy = 0.936500
 epoch 11/30. Took 1.4216 seconds. 
  Full-batch training loss = 0.138927, test loss = 0.201267
  Training set accuracy = 0.962100, Test set accuracy = 0.938100
 epoch 12/30. Took 1.4217 seconds. 
  Full-batch training loss = 0.133025, test loss = 0.210056
  Training set accuracy = 0.963200, Test set accuracy = 0.935500
 epoch 13/30. Took 1.4274 seconds. 
  Full-batch training loss = 0.111806, test loss = 0.190679
  Training set accuracy = 0.970500, Test set accuracy = 0.943000
 epoch 14/30. Took 1.4297 seconds. 
  Full-batch training loss = 0.102518, test loss = 0.180091
  Training set accuracy = 0.973700, Test set accuracy = 0.945100
 epoch 15/30. Took 1.4254 seconds. 
  Full-batch training loss = 0.092812, test loss = 0.179381
  Training set accuracy = 0.976100, Test set accuracy = 0.944200
 epoch 16/30. Took 1.4276 seconds. 
  Full-batch training loss = 0.081462, test loss = 0.173049
  Training set accuracy = 0.979900, Test set accuracy = 0.946200
 epoch 17/30. Took 1.4254 seconds. 
  Full-batch training loss = 0.078239, test loss = 0.166956
  Training set accuracy = 0.980700, Test set accuracy = 0.949200
 epoch 18/30. Took 1.4196 seconds. 
  Full-batch training loss = 0.067129, test loss = 0.165029
  Training set accuracy = 0.985500, Test set accuracy = 0.949300
 epoch 19/30. Took 1.432 seconds. 
  Full-batch training loss = 0.059296, test loss = 0.162050
  Training set accuracy = 0.987400, Test set accuracy = 0.949600
 epoch 20/30. Took 1.4262 seconds. 
  Full-batch training loss = 0.059054, test loss = 0.171437
  Training set accuracy = 0.986200, Test set accuracy = 0.947100
 epoch 21/30. Took 1.4176 seconds. 
  Full-batch training loss = 0.051861, test loss = 0.162028
  Training set accuracy = 0.988000, Test set accuracy = 0.951200
 epoch 22/30. Took 1.4299 seconds. 
  Full-batch training loss = 0.045113, test loss = 0.159531
  Training set accuracy = 0.991700, Test set accuracy = 0.952000
 epoch 23/30. Took 1.4245 seconds. 
  Full-batch training loss = 0.040630, test loss = 0.155851
  Training set accuracy = 0.992700, Test set accuracy = 0.952900
 epoch 24/30. Took 1.4266 seconds. 
  Full-batch training loss = 0.036330, test loss = 0.155619
  Training set accuracy = 0.993700, Test set accuracy = 0.954300
 epoch 25/30. Took 1.4259 seconds. 
  Full-batch training loss = 0.031522, test loss = 0.155022
  Training set accuracy = 0.995900, Test set accuracy = 0.953900
 epoch 26/30. Took 1.4244 seconds. 
  Full-batch training loss = 0.028830, test loss = 0.157072
  Training set accuracy = 0.996800, Test set accuracy = 0.952900
 epoch 27/30. Took 1.457 seconds. 
  Full-batch training loss = 0.028711, test loss = 0.157605
  Training set accuracy = 0.995800, Test set accuracy = 0.954700
 epoch 28/30. Took 1.4231 seconds. 
  Full-batch training loss = 0.026374, test loss = 0.159264
  Training set accuracy = 0.995300, Test set accuracy = 0.952500
 epoch 29/30. Took 1.4756 seconds. 
  Full-batch training loss = 0.020991, test loss = 0.152441
  Training set accuracy = 0.997600, Test set accuracy = 0.955400
 epoch 30/30. Took 1.4195 seconds. 
  Full-batch training loss = 0.021900, test loss = 0.157594
  Training set accuracy = 0.997300, Test set accuracy = 0.955700
Elapsed time is 75.508632 seconds.
End Training
-----
Params 10000 0.010 0.10 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23264 seconds. 
  Full-batch training loss = 0.916177, test loss = 0.897945
  Training set accuracy = 0.816700, Test set accuracy = 0.819700
 epoch 2/30. Took 0.22864 seconds. 
  Full-batch training loss = 0.573400, test loss = 0.556539
  Training set accuracy = 0.863900, Test set accuracy = 0.866800
 epoch 3/30. Took 0.23039 seconds. 
  Full-batch training loss = 0.466366, test loss = 0.451943
  Training set accuracy = 0.883600, Test set accuracy = 0.886500
 epoch 4/30. Took 0.22898 seconds. 
  Full-batch training loss = 0.412678, test loss = 0.401214
  Training set accuracy = 0.894300, Test set accuracy = 0.894700
 epoch 5/30. Took 0.22739 seconds. 
  Full-batch training loss = 0.378926, test loss = 0.371279
  Training set accuracy = 0.898900, Test set accuracy = 0.901600
 epoch 6/30. Took 0.22927 seconds. 
  Full-batch training loss = 0.353625, test loss = 0.348467
  Training set accuracy = 0.903800, Test set accuracy = 0.904500
 epoch 7/30. Took 0.22865 seconds. 
  Full-batch training loss = 0.333669, test loss = 0.333401
  Training set accuracy = 0.909500, Test set accuracy = 0.908600
 epoch 8/30. Took 0.23013 seconds. 
  Full-batch training loss = 0.315932, test loss = 0.317460
  Training set accuracy = 0.915100, Test set accuracy = 0.913500
 epoch 9/30. Took 0.23317 seconds. 
  Full-batch training loss = 0.303153, test loss = 0.308364
  Training set accuracy = 0.918000, Test set accuracy = 0.915100
 epoch 10/30. Took 0.22347 seconds. 
  Full-batch training loss = 0.290528, test loss = 0.298320
  Training set accuracy = 0.922200, Test set accuracy = 0.917700
 epoch 11/30. Took 0.22319 seconds. 
  Full-batch training loss = 0.280063, test loss = 0.289532
  Training set accuracy = 0.925400, Test set accuracy = 0.920700
 epoch 12/30. Took 0.22745 seconds. 
  Full-batch training loss = 0.271612, test loss = 0.282449
  Training set accuracy = 0.925400, Test set accuracy = 0.921600
 epoch 13/30. Took 0.22664 seconds. 
  Full-batch training loss = 0.261632, test loss = 0.274772
  Training set accuracy = 0.930700, Test set accuracy = 0.924000
 epoch 14/30. Took 0.2233 seconds. 
  Full-batch training loss = 0.253648, test loss = 0.268794
  Training set accuracy = 0.931100, Test set accuracy = 0.925000
 epoch 15/30. Took 0.22821 seconds. 
  Full-batch training loss = 0.245140, test loss = 0.262269
  Training set accuracy = 0.933100, Test set accuracy = 0.926100
 epoch 16/30. Took 0.22858 seconds. 
  Full-batch training loss = 0.238811, test loss = 0.258770
  Training set accuracy = 0.936100, Test set accuracy = 0.928800
 epoch 17/30. Took 0.22423 seconds. 
  Full-batch training loss = 0.230727, test loss = 0.252839
  Training set accuracy = 0.938000, Test set accuracy = 0.928300
 epoch 18/30. Took 0.22801 seconds. 
  Full-batch training loss = 0.224317, test loss = 0.247402
  Training set accuracy = 0.939500, Test set accuracy = 0.930200
 epoch 19/30. Took 0.23032 seconds. 
  Full-batch training loss = 0.217668, test loss = 0.241902
  Training set accuracy = 0.940800, Test set accuracy = 0.931200
 epoch 20/30. Took 0.22388 seconds. 
  Full-batch training loss = 0.213423, test loss = 0.239356
  Training set accuracy = 0.941800, Test set accuracy = 0.932500
 epoch 21/30. Took 0.22727 seconds. 
  Full-batch training loss = 0.206529, test loss = 0.234273
  Training set accuracy = 0.943900, Test set accuracy = 0.933000
 epoch 22/30. Took 0.22903 seconds. 
  Full-batch training loss = 0.201140, test loss = 0.231628
  Training set accuracy = 0.944900, Test set accuracy = 0.933300
 epoch 23/30. Took 0.22928 seconds. 
  Full-batch training loss = 0.196679, test loss = 0.228433
  Training set accuracy = 0.945700, Test set accuracy = 0.934100
 epoch 24/30. Took 0.229 seconds. 
  Full-batch training loss = 0.192394, test loss = 0.226395
  Training set accuracy = 0.948100, Test set accuracy = 0.935100
 epoch 25/30. Took 0.22213 seconds. 
  Full-batch training loss = 0.186529, test loss = 0.221264
  Training set accuracy = 0.948700, Test set accuracy = 0.936700
 epoch 26/30. Took 0.2244 seconds. 
  Full-batch training loss = 0.181948, test loss = 0.218302
  Training set accuracy = 0.949400, Test set accuracy = 0.937600
 epoch 27/30. Took 0.22596 seconds. 
  Full-batch training loss = 0.177921, test loss = 0.215646
  Training set accuracy = 0.951700, Test set accuracy = 0.937300
 epoch 28/30. Took 0.22845 seconds. 
  Full-batch training loss = 0.173780, test loss = 0.213237
  Training set accuracy = 0.950600, Test set accuracy = 0.937500
 epoch 29/30. Took 0.23184 seconds. 
  Full-batch training loss = 0.169333, test loss = 0.210652
  Training set accuracy = 0.954000, Test set accuracy = 0.938300
 epoch 30/30. Took 0.22748 seconds. 
  Full-batch training loss = 0.165004, test loss = 0.206823
  Training set accuracy = 0.954200, Test set accuracy = 0.939300
Elapsed time is 13.223935 seconds.
End Training
-----
Params 10000 0.010 0.10 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.37692 seconds. 
  Full-batch training loss = 0.830668, test loss = 0.817731
  Training set accuracy = 0.831700, Test set accuracy = 0.837300
 epoch 2/30. Took 0.3488 seconds. 
  Full-batch training loss = 0.525865, test loss = 0.520445
  Training set accuracy = 0.871600, Test set accuracy = 0.877800
 epoch 3/30. Took 0.36145 seconds. 
  Full-batch training loss = 0.429786, test loss = 0.430011
  Training set accuracy = 0.888500, Test set accuracy = 0.889400
 epoch 4/30. Took 0.37491 seconds. 
  Full-batch training loss = 0.379967, test loss = 0.383761
  Training set accuracy = 0.897500, Test set accuracy = 0.896900
 epoch 5/30. Took 0.35548 seconds. 
  Full-batch training loss = 0.345971, test loss = 0.356051
  Training set accuracy = 0.904700, Test set accuracy = 0.901500
 epoch 6/30. Took 0.35478 seconds. 
  Full-batch training loss = 0.322199, test loss = 0.335595
  Training set accuracy = 0.910100, Test set accuracy = 0.908400
 epoch 7/30. Took 0.35467 seconds. 
  Full-batch training loss = 0.303672, test loss = 0.322274
  Training set accuracy = 0.915600, Test set accuracy = 0.911100
 epoch 8/30. Took 0.35694 seconds. 
  Full-batch training loss = 0.287965, test loss = 0.310194
  Training set accuracy = 0.920800, Test set accuracy = 0.912500
 epoch 9/30. Took 0.35695 seconds. 
  Full-batch training loss = 0.276343, test loss = 0.301368
  Training set accuracy = 0.921500, Test set accuracy = 0.915000
 epoch 10/30. Took 0.37261 seconds. 
  Full-batch training loss = 0.265964, test loss = 0.292569
  Training set accuracy = 0.923100, Test set accuracy = 0.917300
 epoch 11/30. Took 0.39887 seconds. 
  Full-batch training loss = 0.255925, test loss = 0.284172
  Training set accuracy = 0.930300, Test set accuracy = 0.919900
 epoch 12/30. Took 0.38876 seconds. 
  Full-batch training loss = 0.245442, test loss = 0.277293
  Training set accuracy = 0.932600, Test set accuracy = 0.921800
 epoch 13/30. Took 0.35541 seconds. 
  Full-batch training loss = 0.235756, test loss = 0.269723
  Training set accuracy = 0.934100, Test set accuracy = 0.923700
 epoch 14/30. Took 0.35359 seconds. 
  Full-batch training loss = 0.228634, test loss = 0.264199
  Training set accuracy = 0.936100, Test set accuracy = 0.924900
 epoch 15/30. Took 0.35385 seconds. 
  Full-batch training loss = 0.222430, test loss = 0.260076
  Training set accuracy = 0.938500, Test set accuracy = 0.925600
 epoch 16/30. Took 0.3551 seconds. 
  Full-batch training loss = 0.213571, test loss = 0.255263
  Training set accuracy = 0.941100, Test set accuracy = 0.927500
 epoch 17/30. Took 0.38747 seconds. 
  Full-batch training loss = 0.207223, test loss = 0.248179
  Training set accuracy = 0.942600, Test set accuracy = 0.928500
 epoch 18/30. Took 0.35317 seconds. 
  Full-batch training loss = 0.201528, test loss = 0.243910
  Training set accuracy = 0.942600, Test set accuracy = 0.929300
 epoch 19/30. Took 0.35394 seconds. 
  Full-batch training loss = 0.195562, test loss = 0.241413
  Training set accuracy = 0.945700, Test set accuracy = 0.931000
 epoch 20/30. Took 0.35311 seconds. 
  Full-batch training loss = 0.191216, test loss = 0.238660
  Training set accuracy = 0.945400, Test set accuracy = 0.932000
 epoch 21/30. Took 0.35141 seconds. 
  Full-batch training loss = 0.184191, test loss = 0.233092
  Training set accuracy = 0.948900, Test set accuracy = 0.931600
 epoch 22/30. Took 0.35432 seconds. 
  Full-batch training loss = 0.178282, test loss = 0.228922
  Training set accuracy = 0.950000, Test set accuracy = 0.933700
 epoch 23/30. Took 0.3543 seconds. 
  Full-batch training loss = 0.173683, test loss = 0.225985
  Training set accuracy = 0.951300, Test set accuracy = 0.935000
 epoch 24/30. Took 0.35371 seconds. 
  Full-batch training loss = 0.169461, test loss = 0.223993
  Training set accuracy = 0.952900, Test set accuracy = 0.935300
 epoch 25/30. Took 0.35653 seconds. 
  Full-batch training loss = 0.164838, test loss = 0.220479
  Training set accuracy = 0.953300, Test set accuracy = 0.936600
 epoch 26/30. Took 0.35215 seconds. 
  Full-batch training loss = 0.161019, test loss = 0.217533
  Training set accuracy = 0.955100, Test set accuracy = 0.937000
 epoch 27/30. Took 0.35881 seconds. 
  Full-batch training loss = 0.156216, test loss = 0.214154
  Training set accuracy = 0.956800, Test set accuracy = 0.938700
 epoch 28/30. Took 0.38259 seconds. 
  Full-batch training loss = 0.152011, test loss = 0.210846
  Training set accuracy = 0.958200, Test set accuracy = 0.939600
 epoch 29/30. Took 0.35175 seconds. 
  Full-batch training loss = 0.147786, test loss = 0.207735
  Training set accuracy = 0.959900, Test set accuracy = 0.940200
 epoch 30/30. Took 0.35438 seconds. 
  Full-batch training loss = 0.144160, test loss = 0.204821
  Training set accuracy = 0.961600, Test set accuracy = 0.941300
Elapsed time is 19.493551 seconds.
End Training
-----
Params 10000 0.010 0.10 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.72846 seconds. 
  Full-batch training loss = 0.778443, test loss = 0.764966
  Training set accuracy = 0.838800, Test set accuracy = 0.841800
 epoch 2/30. Took 0.74934 seconds. 
  Full-batch training loss = 0.514754, test loss = 0.505874
  Training set accuracy = 0.872100, Test set accuracy = 0.874300
 epoch 3/30. Took 0.74666 seconds. 
  Full-batch training loss = 0.422088, test loss = 0.418083
  Training set accuracy = 0.891800, Test set accuracy = 0.890400
 epoch 4/30. Took 0.72889 seconds. 
  Full-batch training loss = 0.376181, test loss = 0.376067
  Training set accuracy = 0.899900, Test set accuracy = 0.900600
 epoch 5/30. Took 0.73251 seconds. 
  Full-batch training loss = 0.346259, test loss = 0.352143
  Training set accuracy = 0.906800, Test set accuracy = 0.904400
 epoch 6/30. Took 0.73061 seconds. 
  Full-batch training loss = 0.327386, test loss = 0.336258
  Training set accuracy = 0.911400, Test set accuracy = 0.908400
 epoch 7/30. Took 0.72137 seconds. 
  Full-batch training loss = 0.305724, test loss = 0.319174
  Training set accuracy = 0.915700, Test set accuracy = 0.910400
 epoch 8/30. Took 0.72432 seconds. 
  Full-batch training loss = 0.293087, test loss = 0.309575
  Training set accuracy = 0.917500, Test set accuracy = 0.912200
 epoch 9/30. Took 0.73103 seconds. 
  Full-batch training loss = 0.279801, test loss = 0.301465
  Training set accuracy = 0.922900, Test set accuracy = 0.914200
 epoch 10/30. Took 0.75026 seconds. 
  Full-batch training loss = 0.268076, test loss = 0.291230
  Training set accuracy = 0.926200, Test set accuracy = 0.916900
 epoch 11/30. Took 0.73513 seconds. 
  Full-batch training loss = 0.257426, test loss = 0.284504
  Training set accuracy = 0.929500, Test set accuracy = 0.919100
 epoch 12/30. Took 0.72692 seconds. 
  Full-batch training loss = 0.246979, test loss = 0.275860
  Training set accuracy = 0.932200, Test set accuracy = 0.921200
 epoch 13/30. Took 0.7259 seconds. 
  Full-batch training loss = 0.240018, test loss = 0.271969
  Training set accuracy = 0.934100, Test set accuracy = 0.921900
 epoch 14/30. Took 0.7244 seconds. 
  Full-batch training loss = 0.230216, test loss = 0.264144
  Training set accuracy = 0.938400, Test set accuracy = 0.924600
 epoch 15/30. Took 0.74916 seconds. 
  Full-batch training loss = 0.223745, test loss = 0.260863
  Training set accuracy = 0.938000, Test set accuracy = 0.923800
 epoch 16/30. Took 0.726 seconds. 
  Full-batch training loss = 0.216570, test loss = 0.257238
  Training set accuracy = 0.940500, Test set accuracy = 0.926400
 epoch 17/30. Took 0.73148 seconds. 
  Full-batch training loss = 0.207900, test loss = 0.248776
  Training set accuracy = 0.943300, Test set accuracy = 0.928300
 epoch 18/30. Took 0.75221 seconds. 
  Full-batch training loss = 0.201235, test loss = 0.244829
  Training set accuracy = 0.945400, Test set accuracy = 0.927700
 epoch 19/30. Took 0.73734 seconds. 
  Full-batch training loss = 0.195004, test loss = 0.239880
  Training set accuracy = 0.948700, Test set accuracy = 0.930700
 epoch 20/30. Took 0.74365 seconds. 
  Full-batch training loss = 0.189017, test loss = 0.235705
  Training set accuracy = 0.950700, Test set accuracy = 0.932400
 epoch 21/30. Took 0.72432 seconds. 
  Full-batch training loss = 0.182783, test loss = 0.233102
  Training set accuracy = 0.951400, Test set accuracy = 0.932500
 epoch 22/30. Took 0.7272 seconds. 
  Full-batch training loss = 0.177928, test loss = 0.229255
  Training set accuracy = 0.952100, Test set accuracy = 0.933000
 epoch 23/30. Took 0.72789 seconds. 
  Full-batch training loss = 0.171458, test loss = 0.224400
  Training set accuracy = 0.954300, Test set accuracy = 0.933800
 epoch 24/30. Took 0.72439 seconds. 
  Full-batch training loss = 0.166151, test loss = 0.220396
  Training set accuracy = 0.956200, Test set accuracy = 0.935400
 epoch 25/30. Took 0.72757 seconds. 
  Full-batch training loss = 0.161322, test loss = 0.218129
  Training set accuracy = 0.958100, Test set accuracy = 0.934300
 epoch 26/30. Took 0.72857 seconds. 
  Full-batch training loss = 0.156277, test loss = 0.214686
  Training set accuracy = 0.960100, Test set accuracy = 0.935400
 epoch 27/30. Took 0.73052 seconds. 
  Full-batch training loss = 0.152649, test loss = 0.213045
  Training set accuracy = 0.959700, Test set accuracy = 0.936700
 epoch 28/30. Took 0.74443 seconds. 
  Full-batch training loss = 0.148430, test loss = 0.209361
  Training set accuracy = 0.961600, Test set accuracy = 0.936900
 epoch 29/30. Took 0.73424 seconds. 
  Full-batch training loss = 0.143358, test loss = 0.205976
  Training set accuracy = 0.962600, Test set accuracy = 0.937700
 epoch 30/30. Took 0.7267 seconds. 
  Full-batch training loss = 0.139145, test loss = 0.203330
  Training set accuracy = 0.964400, Test set accuracy = 0.938700
Elapsed time is 38.404826 seconds.
End Training
-----
Params 10000 0.010 0.10 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28403 seconds. 
  Full-batch training loss = 1.134404, test loss = 1.119780
  Training set accuracy = 0.755200, Test set accuracy = 0.757500
 epoch 2/30. Took 0.27232 seconds. 
  Full-batch training loss = 0.572174, test loss = 0.558432
  Training set accuracy = 0.849300, Test set accuracy = 0.851400
 epoch 3/30. Took 0.28772 seconds. 
  Full-batch training loss = 0.440062, test loss = 0.431765
  Training set accuracy = 0.885300, Test set accuracy = 0.885400
 epoch 4/30. Took 0.27137 seconds. 
  Full-batch training loss = 0.378238, test loss = 0.378980
  Training set accuracy = 0.897700, Test set accuracy = 0.894400
 epoch 5/30. Took 0.2857 seconds. 
  Full-batch training loss = 0.338731, test loss = 0.342964
  Training set accuracy = 0.907800, Test set accuracy = 0.904400
 epoch 6/30. Took 0.27168 seconds. 
  Full-batch training loss = 0.315393, test loss = 0.327295
  Training set accuracy = 0.913500, Test set accuracy = 0.908500
 epoch 7/30. Took 0.28338 seconds. 
  Full-batch training loss = 0.291936, test loss = 0.304950
  Training set accuracy = 0.920200, Test set accuracy = 0.914100
 epoch 8/30. Took 0.2693 seconds. 
  Full-batch training loss = 0.273809, test loss = 0.291827
  Training set accuracy = 0.923400, Test set accuracy = 0.918100
 epoch 9/30. Took 0.27497 seconds. 
  Full-batch training loss = 0.260551, test loss = 0.281651
  Training set accuracy = 0.928100, Test set accuracy = 0.919100
 epoch 10/30. Took 0.28376 seconds. 
  Full-batch training loss = 0.244094, test loss = 0.270112
  Training set accuracy = 0.931600, Test set accuracy = 0.922700
 epoch 11/30. Took 0.28588 seconds. 
  Full-batch training loss = 0.231497, test loss = 0.260632
  Training set accuracy = 0.934800, Test set accuracy = 0.925100
 epoch 12/30. Took 0.28196 seconds. 
  Full-batch training loss = 0.222332, test loss = 0.253502
  Training set accuracy = 0.936000, Test set accuracy = 0.926000
 epoch 13/30. Took 0.28533 seconds. 
  Full-batch training loss = 0.210643, test loss = 0.246104
  Training set accuracy = 0.941000, Test set accuracy = 0.928800
 epoch 14/30. Took 0.28299 seconds. 
  Full-batch training loss = 0.200487, test loss = 0.238524
  Training set accuracy = 0.943100, Test set accuracy = 0.930700
 epoch 15/30. Took 0.28471 seconds. 
  Full-batch training loss = 0.191232, test loss = 0.231867
  Training set accuracy = 0.946300, Test set accuracy = 0.931500
 epoch 16/30. Took 0.30593 seconds. 
  Full-batch training loss = 0.183442, test loss = 0.227804
  Training set accuracy = 0.948300, Test set accuracy = 0.932700
 epoch 17/30. Took 0.28769 seconds. 
  Full-batch training loss = 0.177806, test loss = 0.224657
  Training set accuracy = 0.949500, Test set accuracy = 0.933900
 epoch 18/30. Took 0.28623 seconds. 
  Full-batch training loss = 0.167846, test loss = 0.216643
  Training set accuracy = 0.953200, Test set accuracy = 0.937300
 epoch 19/30. Took 0.30087 seconds. 
  Full-batch training loss = 0.162179, test loss = 0.213386
  Training set accuracy = 0.955000, Test set accuracy = 0.936500
 epoch 20/30. Took 0.27182 seconds. 
  Full-batch training loss = 0.156701, test loss = 0.210887
  Training set accuracy = 0.958000, Test set accuracy = 0.937700
 epoch 21/30. Took 0.29962 seconds. 
  Full-batch training loss = 0.149483, test loss = 0.204576
  Training set accuracy = 0.959500, Test set accuracy = 0.938100
 epoch 22/30. Took 0.29796 seconds. 
  Full-batch training loss = 0.142344, test loss = 0.199040
  Training set accuracy = 0.961600, Test set accuracy = 0.939800
 epoch 23/30. Took 0.28038 seconds. 
  Full-batch training loss = 0.139746, test loss = 0.200208
  Training set accuracy = 0.962500, Test set accuracy = 0.939400
 epoch 24/30. Took 0.27195 seconds. 
  Full-batch training loss = 0.131107, test loss = 0.193278
  Training set accuracy = 0.965200, Test set accuracy = 0.941600
 epoch 25/30. Took 0.27786 seconds. 
  Full-batch training loss = 0.126987, test loss = 0.191213
  Training set accuracy = 0.966300, Test set accuracy = 0.941300
 epoch 26/30. Took 0.28411 seconds. 
  Full-batch training loss = 0.121634, test loss = 0.187925
  Training set accuracy = 0.967200, Test set accuracy = 0.942200
 epoch 27/30. Took 0.28153 seconds. 
  Full-batch training loss = 0.117421, test loss = 0.185026
  Training set accuracy = 0.969100, Test set accuracy = 0.944600
 epoch 28/30. Took 0.28422 seconds. 
  Full-batch training loss = 0.111907, test loss = 0.183171
  Training set accuracy = 0.970600, Test set accuracy = 0.944500
 epoch 29/30. Took 0.27746 seconds. 
  Full-batch training loss = 0.108075, test loss = 0.179146
  Training set accuracy = 0.971400, Test set accuracy = 0.946600
 epoch 30/30. Took 0.28503 seconds. 
  Full-batch training loss = 0.104154, test loss = 0.178575
  Training set accuracy = 0.972300, Test set accuracy = 0.947400
Elapsed time is 15.821111 seconds.
End Training
-----
Params 10000 0.010 0.10 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.48701 seconds. 
  Full-batch training loss = 1.111856, test loss = 1.099516
  Training set accuracy = 0.796700, Test set accuracy = 0.799000
 epoch 2/30. Took 0.46596 seconds. 
  Full-batch training loss = 0.538658, test loss = 0.527898
  Training set accuracy = 0.860500, Test set accuracy = 0.863500
 epoch 3/30. Took 0.47072 seconds. 
  Full-batch training loss = 0.410851, test loss = 0.412929
  Training set accuracy = 0.887800, Test set accuracy = 0.886400
 epoch 4/30. Took 0.52197 seconds. 
  Full-batch training loss = 0.358049, test loss = 0.362695
  Training set accuracy = 0.903100, Test set accuracy = 0.898700
 epoch 5/30. Took 0.48052 seconds. 
  Full-batch training loss = 0.320922, test loss = 0.334341
  Training set accuracy = 0.910500, Test set accuracy = 0.906700
 epoch 6/30. Took 0.47123 seconds. 
  Full-batch training loss = 0.293999, test loss = 0.313163
  Training set accuracy = 0.917600, Test set accuracy = 0.910800
 epoch 7/30. Took 0.4764 seconds. 
  Full-batch training loss = 0.275351, test loss = 0.297766
  Training set accuracy = 0.923400, Test set accuracy = 0.913400
 epoch 8/30. Took 0.52625 seconds. 
  Full-batch training loss = 0.257470, test loss = 0.286275
  Training set accuracy = 0.927100, Test set accuracy = 0.915100
 epoch 9/30. Took 0.49818 seconds. 
  Full-batch training loss = 0.242880, test loss = 0.277023
  Training set accuracy = 0.931000, Test set accuracy = 0.919800
 epoch 10/30. Took 0.4988 seconds. 
  Full-batch training loss = 0.228689, test loss = 0.262586
  Training set accuracy = 0.935400, Test set accuracy = 0.922600
 epoch 11/30. Took 0.48365 seconds. 
  Full-batch training loss = 0.216718, test loss = 0.253788
  Training set accuracy = 0.939400, Test set accuracy = 0.925600
 epoch 12/30. Took 0.47409 seconds. 
  Full-batch training loss = 0.206234, test loss = 0.249514
  Training set accuracy = 0.942200, Test set accuracy = 0.926100
 epoch 13/30. Took 0.47286 seconds. 
  Full-batch training loss = 0.195635, test loss = 0.240097
  Training set accuracy = 0.945400, Test set accuracy = 0.928900
 epoch 14/30. Took 0.48419 seconds. 
  Full-batch training loss = 0.188384, test loss = 0.236002
  Training set accuracy = 0.947300, Test set accuracy = 0.932100
 epoch 15/30. Took 0.49045 seconds. 
  Full-batch training loss = 0.177055, test loss = 0.225932
  Training set accuracy = 0.951600, Test set accuracy = 0.933800
 epoch 16/30. Took 0.47333 seconds. 
  Full-batch training loss = 0.170201, test loss = 0.223400
  Training set accuracy = 0.952400, Test set accuracy = 0.934700
 epoch 17/30. Took 0.52392 seconds. 
  Full-batch training loss = 0.160140, test loss = 0.213325
  Training set accuracy = 0.955800, Test set accuracy = 0.936400
 epoch 18/30. Took 0.46906 seconds. 
  Full-batch training loss = 0.153491, test loss = 0.209457
  Training set accuracy = 0.957200, Test set accuracy = 0.939000
 epoch 19/30. Took 0.49599 seconds. 
  Full-batch training loss = 0.148042, test loss = 0.205411
  Training set accuracy = 0.958400, Test set accuracy = 0.937800
 epoch 20/30. Took 0.47787 seconds. 
  Full-batch training loss = 0.141037, test loss = 0.201553
  Training set accuracy = 0.961300, Test set accuracy = 0.939800
 epoch 21/30. Took 0.47438 seconds. 
  Full-batch training loss = 0.134856, test loss = 0.197392
  Training set accuracy = 0.962500, Test set accuracy = 0.942100
 epoch 22/30. Took 0.49214 seconds. 
  Full-batch training loss = 0.128450, test loss = 0.193539
  Training set accuracy = 0.965000, Test set accuracy = 0.942200
 epoch 23/30. Took 0.47792 seconds. 
  Full-batch training loss = 0.123263, test loss = 0.189218
  Training set accuracy = 0.967100, Test set accuracy = 0.944500
 epoch 24/30. Took 0.48276 seconds. 
  Full-batch training loss = 0.118742, test loss = 0.189608
  Training set accuracy = 0.968400, Test set accuracy = 0.944200
 epoch 25/30. Took 0.46502 seconds. 
  Full-batch training loss = 0.114518, test loss = 0.183410
  Training set accuracy = 0.968800, Test set accuracy = 0.944400
 epoch 26/30. Took 0.47023 seconds. 
  Full-batch training loss = 0.107886, test loss = 0.182515
  Training set accuracy = 0.972000, Test set accuracy = 0.944600
 epoch 27/30. Took 0.4808 seconds. 
  Full-batch training loss = 0.103394, test loss = 0.176474
  Training set accuracy = 0.972500, Test set accuracy = 0.946000
 epoch 28/30. Took 0.47123 seconds. 
  Full-batch training loss = 0.098520, test loss = 0.174648
  Training set accuracy = 0.974000, Test set accuracy = 0.946600
 epoch 29/30. Took 0.47833 seconds. 
  Full-batch training loss = 0.093750, test loss = 0.170413
  Training set accuracy = 0.976400, Test set accuracy = 0.948100
 epoch 30/30. Took 0.47145 seconds. 
  Full-batch training loss = 0.089966, test loss = 0.168806
  Training set accuracy = 0.977100, Test set accuracy = 0.948800
Elapsed time is 25.383328 seconds.
End Training
-----
Params 10000 0.010 0.10 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2248 seconds. 
  Full-batch training loss = 0.868518, test loss = 0.844375
  Training set accuracy = 0.818700, Test set accuracy = 0.833600
 epoch 2/30. Took 1.2057 seconds. 
  Full-batch training loss = 0.482172, test loss = 0.469501
  Training set accuracy = 0.872400, Test set accuracy = 0.878300
 epoch 3/30. Took 1.2189 seconds. 
  Full-batch training loss = 0.377477, test loss = 0.374250
  Training set accuracy = 0.894000, Test set accuracy = 0.896100
 epoch 4/30. Took 1.2138 seconds. 
  Full-batch training loss = 0.331303, test loss = 0.336806
  Training set accuracy = 0.905700, Test set accuracy = 0.903800
 epoch 5/30. Took 1.2031 seconds. 
  Full-batch training loss = 0.300644, test loss = 0.311485
  Training set accuracy = 0.912200, Test set accuracy = 0.908000
 epoch 6/30. Took 1.2041 seconds. 
  Full-batch training loss = 0.273079, test loss = 0.292201
  Training set accuracy = 0.922000, Test set accuracy = 0.913500
 epoch 7/30. Took 1.2041 seconds. 
  Full-batch training loss = 0.255649, test loss = 0.279727
  Training set accuracy = 0.925700, Test set accuracy = 0.920700
 epoch 8/30. Took 1.2065 seconds. 
  Full-batch training loss = 0.237519, test loss = 0.268389
  Training set accuracy = 0.930900, Test set accuracy = 0.921600
 epoch 9/30. Took 1.1995 seconds. 
  Full-batch training loss = 0.225937, test loss = 0.259460
  Training set accuracy = 0.936400, Test set accuracy = 0.925800
 epoch 10/30. Took 1.1988 seconds. 
  Full-batch training loss = 0.208637, test loss = 0.248373
  Training set accuracy = 0.942000, Test set accuracy = 0.927100
 epoch 11/30. Took 1.2305 seconds. 
  Full-batch training loss = 0.196398, test loss = 0.240916
  Training set accuracy = 0.944900, Test set accuracy = 0.930000
 epoch 12/30. Took 1.321 seconds. 
  Full-batch training loss = 0.187460, test loss = 0.231930
  Training set accuracy = 0.946900, Test set accuracy = 0.932300
 epoch 13/30. Took 1.2116 seconds. 
  Full-batch training loss = 0.178580, test loss = 0.227730
  Training set accuracy = 0.949300, Test set accuracy = 0.932800
 epoch 14/30. Took 1.2428 seconds. 
  Full-batch training loss = 0.166997, test loss = 0.220514
  Training set accuracy = 0.955000, Test set accuracy = 0.934400
 epoch 15/30. Took 1.2219 seconds. 
  Full-batch training loss = 0.159802, test loss = 0.215424
  Training set accuracy = 0.954400, Test set accuracy = 0.936200
 epoch 16/30. Took 1.2585 seconds. 
  Full-batch training loss = 0.147996, test loss = 0.206808
  Training set accuracy = 0.959900, Test set accuracy = 0.939400
 epoch 17/30. Took 1.2002 seconds. 
  Full-batch training loss = 0.141024, test loss = 0.201749
  Training set accuracy = 0.961400, Test set accuracy = 0.942200
 epoch 18/30. Took 1.2032 seconds. 
  Full-batch training loss = 0.133083, test loss = 0.197848
  Training set accuracy = 0.964600, Test set accuracy = 0.940400
 epoch 19/30. Took 1.2119 seconds. 
  Full-batch training loss = 0.126481, test loss = 0.191441
  Training set accuracy = 0.964500, Test set accuracy = 0.943100
 epoch 20/30. Took 1.2067 seconds. 
  Full-batch training loss = 0.120472, test loss = 0.189993
  Training set accuracy = 0.967900, Test set accuracy = 0.942800
 epoch 21/30. Took 1.3397 seconds. 
  Full-batch training loss = 0.113370, test loss = 0.182157
  Training set accuracy = 0.970100, Test set accuracy = 0.945400
 epoch 22/30. Took 1.2034 seconds. 
  Full-batch training loss = 0.109386, test loss = 0.182492
  Training set accuracy = 0.971200, Test set accuracy = 0.944800
 epoch 23/30. Took 1.2376 seconds. 
  Full-batch training loss = 0.101763, test loss = 0.176956
  Training set accuracy = 0.973700, Test set accuracy = 0.946800
 epoch 24/30. Took 1.2053 seconds. 
  Full-batch training loss = 0.099508, test loss = 0.177398
  Training set accuracy = 0.973600, Test set accuracy = 0.947100
 epoch 25/30. Took 1.2666 seconds. 
  Full-batch training loss = 0.093938, test loss = 0.173493
  Training set accuracy = 0.975600, Test set accuracy = 0.946900
 epoch 26/30. Took 1.2132 seconds. 
  Full-batch training loss = 0.088134, test loss = 0.170946
  Training set accuracy = 0.978500, Test set accuracy = 0.948200
 epoch 27/30. Took 1.2019 seconds. 
  Full-batch training loss = 0.084270, test loss = 0.168076
  Training set accuracy = 0.979500, Test set accuracy = 0.948800
 epoch 28/30. Took 1.201 seconds. 
  Full-batch training loss = 0.079720, test loss = 0.165238
  Training set accuracy = 0.981000, Test set accuracy = 0.949700
 epoch 29/30. Took 1.2365 seconds. 
  Full-batch training loss = 0.075202, test loss = 0.162945
  Training set accuracy = 0.982000, Test set accuracy = 0.950600
 epoch 30/30. Took 1.1991 seconds. 
  Full-batch training loss = 0.070892, test loss = 0.159957
  Training set accuracy = 0.983900, Test set accuracy = 0.949700
Elapsed time is 62.810652 seconds.
End Training
-----
Params 10000 0.010 0.10 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35084 seconds. 
  Full-batch training loss = 1.576979, test loss = 1.569472
  Training set accuracy = 0.656900, Test set accuracy = 0.662700
 epoch 2/30. Took 0.32817 seconds. 
  Full-batch training loss = 0.631091, test loss = 0.614558
  Training set accuracy = 0.830100, Test set accuracy = 0.836500
 epoch 3/30. Took 0.33563 seconds. 
  Full-batch training loss = 0.461145, test loss = 0.452583
  Training set accuracy = 0.873600, Test set accuracy = 0.876800
 epoch 4/30. Took 0.33069 seconds. 
  Full-batch training loss = 0.392491, test loss = 0.387583
  Training set accuracy = 0.887400, Test set accuracy = 0.889200
 epoch 5/30. Took 0.33676 seconds. 
  Full-batch training loss = 0.343332, test loss = 0.346362
  Training set accuracy = 0.901400, Test set accuracy = 0.896600
 epoch 6/30. Took 0.31796 seconds. 
  Full-batch training loss = 0.306915, test loss = 0.313780
  Training set accuracy = 0.912300, Test set accuracy = 0.908600
 epoch 7/30. Took 0.33151 seconds. 
  Full-batch training loss = 0.284756, test loss = 0.300800
  Training set accuracy = 0.916900, Test set accuracy = 0.914300
 epoch 8/30. Took 0.3307 seconds. 
  Full-batch training loss = 0.259508, test loss = 0.276596
  Training set accuracy = 0.925000, Test set accuracy = 0.916900
 epoch 9/30. Took 0.31843 seconds. 
  Full-batch training loss = 0.238967, test loss = 0.259779
  Training set accuracy = 0.933300, Test set accuracy = 0.922600
 epoch 10/30. Took 0.31829 seconds. 
  Full-batch training loss = 0.220172, test loss = 0.248235
  Training set accuracy = 0.937900, Test set accuracy = 0.927000
 epoch 11/30. Took 0.33124 seconds. 
  Full-batch training loss = 0.203059, test loss = 0.235688
  Training set accuracy = 0.942400, Test set accuracy = 0.930100
 epoch 12/30. Took 0.33139 seconds. 
  Full-batch training loss = 0.194332, test loss = 0.232404
  Training set accuracy = 0.944400, Test set accuracy = 0.931500
 epoch 13/30. Took 0.338 seconds. 
  Full-batch training loss = 0.178992, test loss = 0.218511
  Training set accuracy = 0.949100, Test set accuracy = 0.933500
 epoch 14/30. Took 0.33773 seconds. 
  Full-batch training loss = 0.168344, test loss = 0.213250
  Training set accuracy = 0.952500, Test set accuracy = 0.935000
 epoch 15/30. Took 0.31687 seconds. 
  Full-batch training loss = 0.155277, test loss = 0.202936
  Training set accuracy = 0.955900, Test set accuracy = 0.939200
 epoch 16/30. Took 0.33313 seconds. 
  Full-batch training loss = 0.149763, test loss = 0.203185
  Training set accuracy = 0.956100, Test set accuracy = 0.939900
 epoch 17/30. Took 0.33751 seconds. 
  Full-batch training loss = 0.135978, test loss = 0.188644
  Training set accuracy = 0.961900, Test set accuracy = 0.943400
 epoch 18/30. Took 0.33252 seconds. 
  Full-batch training loss = 0.129157, test loss = 0.190476
  Training set accuracy = 0.964200, Test set accuracy = 0.943300
 epoch 19/30. Took 0.34042 seconds. 
  Full-batch training loss = 0.118625, test loss = 0.181766
  Training set accuracy = 0.966900, Test set accuracy = 0.944300
 epoch 20/30. Took 0.34026 seconds. 
  Full-batch training loss = 0.112875, test loss = 0.180425
  Training set accuracy = 0.968500, Test set accuracy = 0.946000
 epoch 21/30. Took 0.35903 seconds. 
  Full-batch training loss = 0.108073, test loss = 0.180290
  Training set accuracy = 0.969300, Test set accuracy = 0.944900
 epoch 22/30. Took 0.33543 seconds. 
  Full-batch training loss = 0.101421, test loss = 0.173940
  Training set accuracy = 0.971200, Test set accuracy = 0.946600
 epoch 23/30. Took 0.33652 seconds. 
  Full-batch training loss = 0.093469, test loss = 0.168051
  Training set accuracy = 0.974300, Test set accuracy = 0.948500
 epoch 24/30. Took 0.33397 seconds. 
  Full-batch training loss = 0.088657, test loss = 0.166106
  Training set accuracy = 0.974600, Test set accuracy = 0.949200
 epoch 25/30. Took 0.34038 seconds. 
  Full-batch training loss = 0.084495, test loss = 0.166316
  Training set accuracy = 0.978200, Test set accuracy = 0.949800
 epoch 26/30. Took 0.33658 seconds. 
  Full-batch training loss = 0.079130, test loss = 0.163500
  Training set accuracy = 0.978400, Test set accuracy = 0.950800
 epoch 27/30. Took 0.33791 seconds. 
  Full-batch training loss = 0.076687, test loss = 0.162941
  Training set accuracy = 0.980500, Test set accuracy = 0.949800
 epoch 28/30. Took 0.32865 seconds. 
  Full-batch training loss = 0.072261, test loss = 0.163566
  Training set accuracy = 0.981400, Test set accuracy = 0.950400
 epoch 29/30. Took 0.33123 seconds. 
  Full-batch training loss = 0.067978, test loss = 0.159826
  Training set accuracy = 0.982100, Test set accuracy = 0.951100
 epoch 30/30. Took 0.33988 seconds. 
  Full-batch training loss = 0.063159, test loss = 0.158172
  Training set accuracy = 0.984000, Test set accuracy = 0.952800
Elapsed time is 18.218906 seconds.
End Training
-----
Params 10000 0.010 0.10 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.55834 seconds. 
  Full-batch training loss = 1.440320, test loss = 1.426608
  Training set accuracy = 0.696200, Test set accuracy = 0.693800
 epoch 2/30. Took 0.57795 seconds. 
  Full-batch training loss = 0.562074, test loss = 0.555434
  Training set accuracy = 0.849400, Test set accuracy = 0.852200
 epoch 3/30. Took 0.57886 seconds. 
  Full-batch training loss = 0.426815, test loss = 0.433866
  Training set accuracy = 0.880200, Test set accuracy = 0.872900
 epoch 4/30. Took 0.57586 seconds. 
  Full-batch training loss = 0.346419, test loss = 0.359588
  Training set accuracy = 0.900700, Test set accuracy = 0.897200
 epoch 5/30. Took 0.58066 seconds. 
  Full-batch training loss = 0.308133, test loss = 0.326782
  Training set accuracy = 0.907700, Test set accuracy = 0.903200
 epoch 6/30. Took 0.61958 seconds. 
  Full-batch training loss = 0.277928, test loss = 0.299387
  Training set accuracy = 0.919500, Test set accuracy = 0.912800
 epoch 7/30. Took 0.55919 seconds. 
  Full-batch training loss = 0.260013, test loss = 0.289918
  Training set accuracy = 0.924500, Test set accuracy = 0.912700
 epoch 8/30. Took 0.58133 seconds. 
  Full-batch training loss = 0.235604, test loss = 0.266588
  Training set accuracy = 0.931700, Test set accuracy = 0.920700
 epoch 9/30. Took 0.57274 seconds. 
  Full-batch training loss = 0.217848, test loss = 0.256648
  Training set accuracy = 0.936300, Test set accuracy = 0.922600
 epoch 10/30. Took 0.58073 seconds. 
  Full-batch training loss = 0.211473, test loss = 0.254980
  Training set accuracy = 0.937700, Test set accuracy = 0.923600
 epoch 11/30. Took 0.57528 seconds. 
  Full-batch training loss = 0.187273, test loss = 0.233362
  Training set accuracy = 0.946400, Test set accuracy = 0.930900
 epoch 12/30. Took 0.57537 seconds. 
  Full-batch training loss = 0.174667, test loss = 0.227706
  Training set accuracy = 0.949000, Test set accuracy = 0.932300
 epoch 13/30. Took 0.58405 seconds. 
  Full-batch training loss = 0.162206, test loss = 0.217082
  Training set accuracy = 0.953800, Test set accuracy = 0.933800
 epoch 14/30. Took 0.58017 seconds. 
  Full-batch training loss = 0.151871, test loss = 0.208581
  Training set accuracy = 0.955800, Test set accuracy = 0.934900
 epoch 15/30. Took 0.57933 seconds. 
  Full-batch training loss = 0.140405, test loss = 0.202226
  Training set accuracy = 0.960700, Test set accuracy = 0.938700
 epoch 16/30. Took 0.56664 seconds. 
  Full-batch training loss = 0.130577, test loss = 0.194274
  Training set accuracy = 0.963700, Test set accuracy = 0.940600
 epoch 17/30. Took 0.59225 seconds. 
  Full-batch training loss = 0.124001, test loss = 0.192735
  Training set accuracy = 0.964600, Test set accuracy = 0.941800
 epoch 18/30. Took 0.58723 seconds. 
  Full-batch training loss = 0.114232, test loss = 0.186297
  Training set accuracy = 0.968200, Test set accuracy = 0.942600
 epoch 19/30. Took 0.60928 seconds. 
  Full-batch training loss = 0.105094, test loss = 0.177985
  Training set accuracy = 0.970700, Test set accuracy = 0.944500
 epoch 20/30. Took 0.5819 seconds. 
  Full-batch training loss = 0.099026, test loss = 0.175799
  Training set accuracy = 0.972100, Test set accuracy = 0.945700
 epoch 21/30. Took 0.60094 seconds. 
  Full-batch training loss = 0.094505, test loss = 0.173339
  Training set accuracy = 0.975300, Test set accuracy = 0.947100
 epoch 22/30. Took 0.57731 seconds. 
  Full-batch training loss = 0.085823, test loss = 0.168563
  Training set accuracy = 0.977800, Test set accuracy = 0.948300
 epoch 23/30. Took 0.57336 seconds. 
  Full-batch training loss = 0.078927, test loss = 0.163964
  Training set accuracy = 0.978700, Test set accuracy = 0.950400
 epoch 24/30. Took 0.55911 seconds. 
  Full-batch training loss = 0.072769, test loss = 0.158755
  Training set accuracy = 0.981700, Test set accuracy = 0.952100
 epoch 25/30. Took 0.57213 seconds. 
  Full-batch training loss = 0.068029, test loss = 0.158053
  Training set accuracy = 0.983100, Test set accuracy = 0.951000
 epoch 26/30. Took 0.57633 seconds. 
  Full-batch training loss = 0.064744, test loss = 0.157589
  Training set accuracy = 0.982600, Test set accuracy = 0.951600
 epoch 27/30. Took 0.57929 seconds. 
  Full-batch training loss = 0.058509, test loss = 0.151728
  Training set accuracy = 0.985800, Test set accuracy = 0.953100
 epoch 28/30. Took 0.57766 seconds. 
  Full-batch training loss = 0.056213, test loss = 0.154053
  Training set accuracy = 0.986200, Test set accuracy = 0.952700
 epoch 29/30. Took 0.58117 seconds. 
  Full-batch training loss = 0.052492, test loss = 0.150139
  Training set accuracy = 0.987500, Test set accuracy = 0.953600
 epoch 30/30. Took 0.58205 seconds. 
  Full-batch training loss = 0.046333, test loss = 0.148258
  Training set accuracy = 0.988700, Test set accuracy = 0.953800
Elapsed time is 30.732986 seconds.
End Training
-----
Params 10000 0.010 0.10 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.6669 seconds. 
  Full-batch training loss = 1.077121, test loss = 1.066307
  Training set accuracy = 0.757100, Test set accuracy = 0.758800
 epoch 2/30. Took 1.6712 seconds. 
  Full-batch training loss = 0.486964, test loss = 0.484808
  Training set accuracy = 0.861500, Test set accuracy = 0.860900
 epoch 3/30. Took 1.6696 seconds. 
  Full-batch training loss = 0.384365, test loss = 0.387725
  Training set accuracy = 0.890500, Test set accuracy = 0.889200
 epoch 4/30. Took 1.7804 seconds. 
  Full-batch training loss = 0.333946, test loss = 0.341973
  Training set accuracy = 0.903000, Test set accuracy = 0.900400
 epoch 5/30. Took 1.6596 seconds. 
  Full-batch training loss = 0.289481, test loss = 0.309184
  Training set accuracy = 0.919000, Test set accuracy = 0.908200
 epoch 6/30. Took 1.6927 seconds. 
  Full-batch training loss = 0.258469, test loss = 0.282894
  Training set accuracy = 0.928400, Test set accuracy = 0.918400
 epoch 7/30. Took 1.7125 seconds. 
  Full-batch training loss = 0.239523, test loss = 0.272291
  Training set accuracy = 0.930700, Test set accuracy = 0.919700
 epoch 8/30. Took 1.6615 seconds. 
  Full-batch training loss = 0.214438, test loss = 0.254104
  Training set accuracy = 0.939600, Test set accuracy = 0.925500
 epoch 9/30. Took 1.6665 seconds. 
  Full-batch training loss = 0.197632, test loss = 0.243587
  Training set accuracy = 0.943900, Test set accuracy = 0.928200
 epoch 10/30. Took 1.6815 seconds. 
  Full-batch training loss = 0.182281, test loss = 0.229628
  Training set accuracy = 0.946800, Test set accuracy = 0.930900
 epoch 11/30. Took 1.7098 seconds. 
  Full-batch training loss = 0.165833, test loss = 0.220335
  Training set accuracy = 0.951600, Test set accuracy = 0.932800
 epoch 12/30. Took 1.6579 seconds. 
  Full-batch training loss = 0.151744, test loss = 0.208614
  Training set accuracy = 0.958500, Test set accuracy = 0.937100
 epoch 13/30. Took 1.6543 seconds. 
  Full-batch training loss = 0.139284, test loss = 0.199539
  Training set accuracy = 0.961800, Test set accuracy = 0.939000
 epoch 14/30. Took 1.6757 seconds. 
  Full-batch training loss = 0.131006, test loss = 0.193760
  Training set accuracy = 0.961700, Test set accuracy = 0.940500
 epoch 15/30. Took 1.6705 seconds. 
  Full-batch training loss = 0.119617, test loss = 0.185593
  Training set accuracy = 0.965300, Test set accuracy = 0.942000
 epoch 16/30. Took 1.6628 seconds. 
  Full-batch training loss = 0.109118, test loss = 0.180334
  Training set accuracy = 0.970200, Test set accuracy = 0.944600
 epoch 17/30. Took 1.6676 seconds. 
  Full-batch training loss = 0.098533, test loss = 0.174053
  Training set accuracy = 0.973900, Test set accuracy = 0.946000
 epoch 18/30. Took 1.7073 seconds. 
  Full-batch training loss = 0.093647, test loss = 0.173895
  Training set accuracy = 0.974600, Test set accuracy = 0.945800
 epoch 19/30. Took 1.6814 seconds. 
  Full-batch training loss = 0.086957, test loss = 0.167906
  Training set accuracy = 0.977000, Test set accuracy = 0.948700
 epoch 20/30. Took 1.6643 seconds. 
  Full-batch training loss = 0.078365, test loss = 0.163118
  Training set accuracy = 0.979500, Test set accuracy = 0.951200
 epoch 21/30. Took 1.6476 seconds. 
  Full-batch training loss = 0.076233, test loss = 0.165188
  Training set accuracy = 0.980100, Test set accuracy = 0.948300
 epoch 22/30. Took 1.6701 seconds. 
  Full-batch training loss = 0.066325, test loss = 0.158272
  Training set accuracy = 0.982600, Test set accuracy = 0.951200
 epoch 23/30. Took 1.7683 seconds. 
  Full-batch training loss = 0.063371, test loss = 0.155971
  Training set accuracy = 0.983400, Test set accuracy = 0.950900
 epoch 24/30. Took 1.6562 seconds. 
  Full-batch training loss = 0.058670, test loss = 0.154537
  Training set accuracy = 0.986200, Test set accuracy = 0.952300
 epoch 25/30. Took 1.7473 seconds. 
  Full-batch training loss = 0.051193, test loss = 0.152958
  Training set accuracy = 0.988400, Test set accuracy = 0.953800
 epoch 26/30. Took 1.7027 seconds. 
  Full-batch training loss = 0.049059, test loss = 0.152626
  Training set accuracy = 0.988500, Test set accuracy = 0.953700
 epoch 27/30. Took 1.6692 seconds. 
  Full-batch training loss = 0.043810, test loss = 0.145800
  Training set accuracy = 0.990300, Test set accuracy = 0.956000
 epoch 28/30. Took 1.756 seconds. 
  Full-batch training loss = 0.041900, test loss = 0.149098
  Training set accuracy = 0.990600, Test set accuracy = 0.956200
 epoch 29/30. Took 1.6713 seconds. 
  Full-batch training loss = 0.037601, test loss = 0.147315
  Training set accuracy = 0.992600, Test set accuracy = 0.954900
 epoch 30/30. Took 1.7629 seconds. 
  Full-batch training loss = 0.034693, test loss = 0.146207
  Training set accuracy = 0.993300, Test set accuracy = 0.955900
Elapsed time is 86.656086 seconds.
End Training
-----
Params 10000 0.010 0.20 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.22935 seconds. 
  Full-batch training loss = 1.058147, test loss = 1.035345
  Training set accuracy = 0.813200, Test set accuracy = 0.814300
 epoch 2/30. Took 0.23322 seconds. 
  Full-batch training loss = 0.627837, test loss = 0.606634
  Training set accuracy = 0.853400, Test set accuracy = 0.861100
 epoch 3/30. Took 0.23 seconds. 
  Full-batch training loss = 0.500531, test loss = 0.484216
  Training set accuracy = 0.873500, Test set accuracy = 0.879300
 epoch 4/30. Took 0.23337 seconds. 
  Full-batch training loss = 0.437140, test loss = 0.426199
  Training set accuracy = 0.884700, Test set accuracy = 0.890100
 epoch 5/30. Took 0.23337 seconds. 
  Full-batch training loss = 0.397724, test loss = 0.390046
  Training set accuracy = 0.892700, Test set accuracy = 0.897100
 epoch 6/30. Took 0.23172 seconds. 
  Full-batch training loss = 0.372784, test loss = 0.369234
  Training set accuracy = 0.899200, Test set accuracy = 0.900400
 epoch 7/30. Took 0.23309 seconds. 
  Full-batch training loss = 0.350953, test loss = 0.349509
  Training set accuracy = 0.904200, Test set accuracy = 0.904700
 epoch 8/30. Took 0.23751 seconds. 
  Full-batch training loss = 0.333650, test loss = 0.336084
  Training set accuracy = 0.909900, Test set accuracy = 0.907600
 epoch 9/30. Took 0.2299 seconds. 
  Full-batch training loss = 0.318444, test loss = 0.323036
  Training set accuracy = 0.912100, Test set accuracy = 0.909900
 epoch 10/30. Took 0.23184 seconds. 
  Full-batch training loss = 0.307046, test loss = 0.313711
  Training set accuracy = 0.914500, Test set accuracy = 0.913000
 epoch 11/30. Took 0.2339 seconds. 
  Full-batch training loss = 0.295027, test loss = 0.304085
  Training set accuracy = 0.917400, Test set accuracy = 0.914000
 epoch 12/30. Took 0.23067 seconds. 
  Full-batch training loss = 0.285395, test loss = 0.296377
  Training set accuracy = 0.922300, Test set accuracy = 0.917100
 epoch 13/30. Took 0.23213 seconds. 
  Full-batch training loss = 0.276173, test loss = 0.289098
  Training set accuracy = 0.923800, Test set accuracy = 0.919000
 epoch 14/30. Took 0.23002 seconds. 
  Full-batch training loss = 0.267206, test loss = 0.282206
  Training set accuracy = 0.927200, Test set accuracy = 0.921100
 epoch 15/30. Took 0.23598 seconds. 
  Full-batch training loss = 0.259414, test loss = 0.277577
  Training set accuracy = 0.929800, Test set accuracy = 0.920900
 epoch 16/30. Took 0.2294 seconds. 
  Full-batch training loss = 0.251367, test loss = 0.270184
  Training set accuracy = 0.932100, Test set accuracy = 0.924300
 epoch 17/30. Took 0.22894 seconds. 
  Full-batch training loss = 0.244570, test loss = 0.265120
  Training set accuracy = 0.932900, Test set accuracy = 0.923700
 epoch 18/30. Took 0.2325 seconds. 
  Full-batch training loss = 0.238449, test loss = 0.261491
  Training set accuracy = 0.935400, Test set accuracy = 0.926500
 epoch 19/30. Took 0.23291 seconds. 
  Full-batch training loss = 0.231329, test loss = 0.256364
  Training set accuracy = 0.937200, Test set accuracy = 0.926900
 epoch 20/30. Took 0.22733 seconds. 
  Full-batch training loss = 0.225953, test loss = 0.251660
  Training set accuracy = 0.939000, Test set accuracy = 0.928000
 epoch 21/30. Took 0.23927 seconds. 
  Full-batch training loss = 0.220130, test loss = 0.245877
  Training set accuracy = 0.941100, Test set accuracy = 0.929600
 epoch 22/30. Took 0.23878 seconds. 
  Full-batch training loss = 0.214023, test loss = 0.242138
  Training set accuracy = 0.941900, Test set accuracy = 0.929800
 epoch 23/30. Took 0.22827 seconds. 
  Full-batch training loss = 0.209045, test loss = 0.239122
  Training set accuracy = 0.944000, Test set accuracy = 0.929800
 epoch 24/30. Took 0.24296 seconds. 
  Full-batch training loss = 0.203897, test loss = 0.235054
  Training set accuracy = 0.944800, Test set accuracy = 0.932100
 epoch 25/30. Took 0.23158 seconds. 
  Full-batch training loss = 0.199653, test loss = 0.232163
  Training set accuracy = 0.945500, Test set accuracy = 0.933600
 epoch 26/30. Took 0.23062 seconds. 
  Full-batch training loss = 0.194794, test loss = 0.229304
  Training set accuracy = 0.947400, Test set accuracy = 0.933900
 epoch 27/30. Took 0.23207 seconds. 
  Full-batch training loss = 0.190205, test loss = 0.225672
  Training set accuracy = 0.949800, Test set accuracy = 0.934100
 epoch 28/30. Took 0.22988 seconds. 
  Full-batch training loss = 0.187019, test loss = 0.223429
  Training set accuracy = 0.949500, Test set accuracy = 0.935600
 epoch 29/30. Took 0.23281 seconds. 
  Full-batch training loss = 0.182721, test loss = 0.219349
  Training set accuracy = 0.951200, Test set accuracy = 0.937300
 epoch 30/30. Took 0.2343 seconds. 
  Full-batch training loss = 0.178093, test loss = 0.217008
  Training set accuracy = 0.951900, Test set accuracy = 0.937900
Elapsed time is 13.398052 seconds.
End Training
-----
Params 10000 0.010 0.20 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35495 seconds. 
  Full-batch training loss = 0.964083, test loss = 0.951759
  Training set accuracy = 0.818400, Test set accuracy = 0.819500
 epoch 2/30. Took 0.36297 seconds. 
  Full-batch training loss = 0.589439, test loss = 0.584417
  Training set accuracy = 0.864200, Test set accuracy = 0.864400
 epoch 3/30. Took 0.35128 seconds. 
  Full-batch training loss = 0.473741, test loss = 0.474677
  Training set accuracy = 0.881000, Test set accuracy = 0.881100
 epoch 4/30. Took 0.35145 seconds. 
  Full-batch training loss = 0.410679, test loss = 0.414687
  Training set accuracy = 0.894200, Test set accuracy = 0.890200
 epoch 5/30. Took 0.35186 seconds. 
  Full-batch training loss = 0.373915, test loss = 0.382057
  Training set accuracy = 0.901300, Test set accuracy = 0.896000
 epoch 6/30. Took 0.35678 seconds. 
  Full-batch training loss = 0.346848, test loss = 0.359762
  Training set accuracy = 0.904600, Test set accuracy = 0.900000
 epoch 7/30. Took 0.34597 seconds. 
  Full-batch training loss = 0.327361, test loss = 0.345088
  Training set accuracy = 0.908100, Test set accuracy = 0.904700
 epoch 8/30. Took 0.35035 seconds. 
  Full-batch training loss = 0.310653, test loss = 0.329530
  Training set accuracy = 0.912300, Test set accuracy = 0.908500
 epoch 9/30. Took 0.35142 seconds. 
  Full-batch training loss = 0.296988, test loss = 0.319641
  Training set accuracy = 0.915200, Test set accuracy = 0.911800
 epoch 10/30. Took 0.34874 seconds. 
  Full-batch training loss = 0.285623, test loss = 0.310280
  Training set accuracy = 0.918600, Test set accuracy = 0.912200
 epoch 11/30. Took 0.34666 seconds. 
  Full-batch training loss = 0.273573, test loss = 0.299278
  Training set accuracy = 0.921600, Test set accuracy = 0.915000
 epoch 12/30. Took 0.39172 seconds. 
  Full-batch training loss = 0.265523, test loss = 0.295608
  Training set accuracy = 0.925400, Test set accuracy = 0.914100
 epoch 13/30. Took 0.34681 seconds. 
  Full-batch training loss = 0.255242, test loss = 0.287827
  Training set accuracy = 0.927600, Test set accuracy = 0.918100
 epoch 14/30. Took 0.34733 seconds. 
  Full-batch training loss = 0.247083, test loss = 0.282507
  Training set accuracy = 0.931200, Test set accuracy = 0.919500
 epoch 15/30. Took 0.35393 seconds. 
  Full-batch training loss = 0.239206, test loss = 0.275774
  Training set accuracy = 0.933400, Test set accuracy = 0.922600
 epoch 16/30. Took 0.34532 seconds. 
  Full-batch training loss = 0.232752, test loss = 0.270736
  Training set accuracy = 0.933800, Test set accuracy = 0.922000
 epoch 17/30. Took 0.35009 seconds. 
  Full-batch training loss = 0.226287, test loss = 0.266334
  Training set accuracy = 0.934900, Test set accuracy = 0.923400
 epoch 18/30. Took 0.34756 seconds. 
  Full-batch training loss = 0.219010, test loss = 0.260279
  Training set accuracy = 0.939400, Test set accuracy = 0.926500
 epoch 19/30. Took 0.34917 seconds. 
  Full-batch training loss = 0.212830, test loss = 0.256180
  Training set accuracy = 0.939500, Test set accuracy = 0.927200
 epoch 20/30. Took 0.37481 seconds. 
  Full-batch training loss = 0.206716, test loss = 0.252788
  Training set accuracy = 0.942700, Test set accuracy = 0.928900
 epoch 21/30. Took 0.3508 seconds. 
  Full-batch training loss = 0.201709, test loss = 0.247405
  Training set accuracy = 0.942700, Test set accuracy = 0.928600
 epoch 22/30. Took 0.34934 seconds. 
  Full-batch training loss = 0.195989, test loss = 0.244227
  Training set accuracy = 0.946300, Test set accuracy = 0.932100
 epoch 23/30. Took 0.37128 seconds. 
  Full-batch training loss = 0.190811, test loss = 0.241904
  Training set accuracy = 0.946300, Test set accuracy = 0.930900
 epoch 24/30. Took 0.35024 seconds. 
  Full-batch training loss = 0.186030, test loss = 0.238312
  Training set accuracy = 0.948000, Test set accuracy = 0.931900
 epoch 25/30. Took 0.3733 seconds. 
  Full-batch training loss = 0.181033, test loss = 0.233921
  Training set accuracy = 0.949100, Test set accuracy = 0.934000
 epoch 26/30. Took 0.35021 seconds. 
  Full-batch training loss = 0.177012, test loss = 0.231203
  Training set accuracy = 0.951400, Test set accuracy = 0.933700
 epoch 27/30. Took 0.36934 seconds. 
  Full-batch training loss = 0.173527, test loss = 0.228544
  Training set accuracy = 0.952200, Test set accuracy = 0.935300
 epoch 28/30. Took 0.3476 seconds. 
  Full-batch training loss = 0.169660, test loss = 0.226751
  Training set accuracy = 0.952900, Test set accuracy = 0.934900
 epoch 29/30. Took 0.35084 seconds. 
  Full-batch training loss = 0.164535, test loss = 0.223322
  Training set accuracy = 0.954800, Test set accuracy = 0.937200
 epoch 30/30. Took 0.34923 seconds. 
  Full-batch training loss = 0.160271, test loss = 0.219972
  Training set accuracy = 0.956400, Test set accuracy = 0.937700
Elapsed time is 19.323711 seconds.
End Training
-----
Params 10000 0.010 0.20 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.77364 seconds. 
  Full-batch training loss = 0.883526, test loss = 0.864460
  Training set accuracy = 0.819900, Test set accuracy = 0.824800
 epoch 2/30. Took 0.77069 seconds. 
  Full-batch training loss = 0.564926, test loss = 0.546748
  Training set accuracy = 0.864000, Test set accuracy = 0.871300
 epoch 3/30. Took 0.7326 seconds. 
  Full-batch training loss = 0.463027, test loss = 0.447699
  Training set accuracy = 0.881700, Test set accuracy = 0.885300
 epoch 4/30. Took 0.76673 seconds. 
  Full-batch training loss = 0.409314, test loss = 0.396035
  Training set accuracy = 0.892900, Test set accuracy = 0.897400
 epoch 5/30. Took 0.76983 seconds. 
  Full-batch training loss = 0.378841, test loss = 0.367237
  Training set accuracy = 0.897600, Test set accuracy = 0.900300
 epoch 6/30. Took 0.73278 seconds. 
  Full-batch training loss = 0.352264, test loss = 0.344668
  Training set accuracy = 0.905400, Test set accuracy = 0.907500
 epoch 7/30. Took 0.73273 seconds. 
  Full-batch training loss = 0.333588, test loss = 0.328156
  Training set accuracy = 0.908800, Test set accuracy = 0.911300
 epoch 8/30. Took 0.73816 seconds. 
  Full-batch training loss = 0.318000, test loss = 0.317266
  Training set accuracy = 0.911600, Test set accuracy = 0.912400
 epoch 9/30. Took 0.75167 seconds. 
  Full-batch training loss = 0.302687, test loss = 0.305059
  Training set accuracy = 0.914700, Test set accuracy = 0.915500
 epoch 10/30. Took 0.75007 seconds. 
  Full-batch training loss = 0.291805, test loss = 0.296038
  Training set accuracy = 0.919200, Test set accuracy = 0.919200
 epoch 11/30. Took 0.74609 seconds. 
  Full-batch training loss = 0.282269, test loss = 0.289697
  Training set accuracy = 0.920200, Test set accuracy = 0.920300
 epoch 12/30. Took 0.73879 seconds. 
  Full-batch training loss = 0.275371, test loss = 0.287114
  Training set accuracy = 0.926400, Test set accuracy = 0.919200
 epoch 13/30. Took 0.73398 seconds. 
  Full-batch training loss = 0.263053, test loss = 0.275725
  Training set accuracy = 0.928300, Test set accuracy = 0.923200
 epoch 14/30. Took 0.73296 seconds. 
  Full-batch training loss = 0.255078, test loss = 0.271433
  Training set accuracy = 0.928800, Test set accuracy = 0.922600
 epoch 15/30. Took 0.73256 seconds. 
  Full-batch training loss = 0.246588, test loss = 0.262695
  Training set accuracy = 0.930400, Test set accuracy = 0.925500
 epoch 16/30. Took 0.74402 seconds. 
  Full-batch training loss = 0.238815, test loss = 0.257872
  Training set accuracy = 0.934600, Test set accuracy = 0.927500
 epoch 17/30. Took 0.7321 seconds. 
  Full-batch training loss = 0.231754, test loss = 0.252695
  Training set accuracy = 0.936700, Test set accuracy = 0.929400
 epoch 18/30. Took 0.73306 seconds. 
  Full-batch training loss = 0.226364, test loss = 0.248431
  Training set accuracy = 0.938600, Test set accuracy = 0.931400
 epoch 19/30. Took 0.73516 seconds. 
  Full-batch training loss = 0.220352, test loss = 0.245737
  Training set accuracy = 0.939500, Test set accuracy = 0.929200
 epoch 20/30. Took 0.7342 seconds. 
  Full-batch training loss = 0.214691, test loss = 0.243504
  Training set accuracy = 0.940200, Test set accuracy = 0.930600
 epoch 21/30. Took 0.75476 seconds. 
  Full-batch training loss = 0.207044, test loss = 0.235219
  Training set accuracy = 0.942700, Test set accuracy = 0.933400
 epoch 22/30. Took 0.74155 seconds. 
  Full-batch training loss = 0.201975, test loss = 0.231855
  Training set accuracy = 0.943900, Test set accuracy = 0.934300
 epoch 23/30. Took 0.73914 seconds. 
  Full-batch training loss = 0.197186, test loss = 0.229463
  Training set accuracy = 0.946100, Test set accuracy = 0.934500
 epoch 24/30. Took 0.74524 seconds. 
  Full-batch training loss = 0.190563, test loss = 0.224744
  Training set accuracy = 0.946800, Test set accuracy = 0.935600
 epoch 25/30. Took 0.73559 seconds. 
  Full-batch training loss = 0.186170, test loss = 0.222233
  Training set accuracy = 0.948800, Test set accuracy = 0.936600
 epoch 26/30. Took 0.7445 seconds. 
  Full-batch training loss = 0.181163, test loss = 0.217620
  Training set accuracy = 0.951300, Test set accuracy = 0.937900
 epoch 27/30. Took 0.73421 seconds. 
  Full-batch training loss = 0.176199, test loss = 0.215166
  Training set accuracy = 0.952200, Test set accuracy = 0.938400
 epoch 28/30. Took 0.7526 seconds. 
  Full-batch training loss = 0.174473, test loss = 0.214366
  Training set accuracy = 0.952200, Test set accuracy = 0.938200
 epoch 29/30. Took 0.76871 seconds. 
  Full-batch training loss = 0.167989, test loss = 0.209488
  Training set accuracy = 0.956400, Test set accuracy = 0.939000
 epoch 30/30. Took 0.77741 seconds. 
  Full-batch training loss = 0.164887, test loss = 0.207468
  Training set accuracy = 0.956900, Test set accuracy = 0.939600
Elapsed time is 38.782386 seconds.
End Training
-----
Params 10000 0.010 0.20 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27997 seconds. 
  Full-batch training loss = 1.494413, test loss = 1.483523
  Training set accuracy = 0.655000, Test set accuracy = 0.666300
 epoch 2/30. Took 0.29865 seconds. 
  Full-batch training loss = 0.753590, test loss = 0.738646
  Training set accuracy = 0.811500, Test set accuracy = 0.818300
 epoch 3/30. Took 0.29055 seconds. 
  Full-batch training loss = 0.536970, test loss = 0.527016
  Training set accuracy = 0.859400, Test set accuracy = 0.860000
 epoch 4/30. Took 0.27314 seconds. 
  Full-batch training loss = 0.443847, test loss = 0.440661
  Training set accuracy = 0.885400, Test set accuracy = 0.884200
 epoch 5/30. Took 0.28648 seconds. 
  Full-batch training loss = 0.394536, test loss = 0.392967
  Training set accuracy = 0.894000, Test set accuracy = 0.890800
 epoch 6/30. Took 0.28729 seconds. 
  Full-batch training loss = 0.357864, test loss = 0.359319
  Training set accuracy = 0.903200, Test set accuracy = 0.898600
 epoch 7/30. Took 0.28708 seconds. 
  Full-batch training loss = 0.332707, test loss = 0.338131
  Training set accuracy = 0.908800, Test set accuracy = 0.905700
 epoch 8/30. Took 0.2964 seconds. 
  Full-batch training loss = 0.312942, test loss = 0.321971
  Training set accuracy = 0.912100, Test set accuracy = 0.907600
 epoch 9/30. Took 0.28635 seconds. 
  Full-batch training loss = 0.294999, test loss = 0.308025
  Training set accuracy = 0.915400, Test set accuracy = 0.912600
 epoch 10/30. Took 0.2875 seconds. 
  Full-batch training loss = 0.283667, test loss = 0.296615
  Training set accuracy = 0.919400, Test set accuracy = 0.913600
 epoch 11/30. Took 0.28765 seconds. 
  Full-batch training loss = 0.272225, test loss = 0.291574
  Training set accuracy = 0.923700, Test set accuracy = 0.915700
 epoch 12/30. Took 0.28556 seconds. 
  Full-batch training loss = 0.258327, test loss = 0.280680
  Training set accuracy = 0.927600, Test set accuracy = 0.920400
 epoch 13/30. Took 0.28655 seconds. 
  Full-batch training loss = 0.246059, test loss = 0.267888
  Training set accuracy = 0.930100, Test set accuracy = 0.921500
 epoch 14/30. Took 0.28553 seconds. 
  Full-batch training loss = 0.234781, test loss = 0.260698
  Training set accuracy = 0.933500, Test set accuracy = 0.923300
 epoch 15/30. Took 0.26903 seconds. 
  Full-batch training loss = 0.225867, test loss = 0.255766
  Training set accuracy = 0.935500, Test set accuracy = 0.926100
 epoch 16/30. Took 0.28663 seconds. 
  Full-batch training loss = 0.216264, test loss = 0.248284
  Training set accuracy = 0.937800, Test set accuracy = 0.927000
 epoch 17/30. Took 0.2867 seconds. 
  Full-batch training loss = 0.210568, test loss = 0.243113
  Training set accuracy = 0.939500, Test set accuracy = 0.929700
 epoch 18/30. Took 0.28681 seconds. 
  Full-batch training loss = 0.200883, test loss = 0.241576
  Training set accuracy = 0.942000, Test set accuracy = 0.929200
 epoch 19/30. Took 0.29 seconds. 
  Full-batch training loss = 0.194029, test loss = 0.233250
  Training set accuracy = 0.944500, Test set accuracy = 0.932400
 epoch 20/30. Took 0.29047 seconds. 
  Full-batch training loss = 0.185771, test loss = 0.227386
  Training set accuracy = 0.946500, Test set accuracy = 0.932200
 epoch 21/30. Took 0.28795 seconds. 
  Full-batch training loss = 0.183836, test loss = 0.224684
  Training set accuracy = 0.947800, Test set accuracy = 0.932000
 epoch 22/30. Took 0.29287 seconds. 
  Full-batch training loss = 0.173348, test loss = 0.219880
  Training set accuracy = 0.950100, Test set accuracy = 0.935300
 epoch 23/30. Took 0.28457 seconds. 
  Full-batch training loss = 0.166116, test loss = 0.213712
  Training set accuracy = 0.952200, Test set accuracy = 0.936400
 epoch 24/30. Took 0.27211 seconds. 
  Full-batch training loss = 0.161802, test loss = 0.214647
  Training set accuracy = 0.954800, Test set accuracy = 0.936400
 epoch 25/30. Took 0.3476 seconds. 
  Full-batch training loss = 0.155321, test loss = 0.207461
  Training set accuracy = 0.956000, Test set accuracy = 0.937900
 epoch 26/30. Took 0.28833 seconds. 
  Full-batch training loss = 0.151853, test loss = 0.207213
  Training set accuracy = 0.957300, Test set accuracy = 0.937000
 epoch 27/30. Took 0.29428 seconds. 
  Full-batch training loss = 0.144981, test loss = 0.199640
  Training set accuracy = 0.959100, Test set accuracy = 0.938900
 epoch 28/30. Took 0.28719 seconds. 
  Full-batch training loss = 0.141682, test loss = 0.198773
  Training set accuracy = 0.960400, Test set accuracy = 0.942000
 epoch 29/30. Took 0.27807 seconds. 
  Full-batch training loss = 0.136379, test loss = 0.197621
  Training set accuracy = 0.961900, Test set accuracy = 0.940400
 epoch 30/30. Took 0.28415 seconds. 
  Full-batch training loss = 0.130870, test loss = 0.193638
  Training set accuracy = 0.965400, Test set accuracy = 0.943400
Elapsed time is 16.055075 seconds.
End Training
-----
Params 10000 0.010 0.20 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.50413 seconds. 
  Full-batch training loss = 1.444364, test loss = 1.429485
  Training set accuracy = 0.720500, Test set accuracy = 0.732000
 epoch 2/30. Took 0.50203 seconds. 
  Full-batch training loss = 0.668598, test loss = 0.659007
  Training set accuracy = 0.815300, Test set accuracy = 0.819000
 epoch 3/30. Took 0.47841 seconds. 
  Full-batch training loss = 0.494140, test loss = 0.490273
  Training set accuracy = 0.866400, Test set accuracy = 0.868300
 epoch 4/30. Took 0.48209 seconds. 
  Full-batch training loss = 0.419810, test loss = 0.416450
  Training set accuracy = 0.885200, Test set accuracy = 0.884200
 epoch 5/30. Took 0.47425 seconds. 
  Full-batch training loss = 0.369206, test loss = 0.374902
  Training set accuracy = 0.896300, Test set accuracy = 0.895300
 epoch 6/30. Took 0.47487 seconds. 
  Full-batch training loss = 0.339203, test loss = 0.348850
  Training set accuracy = 0.902800, Test set accuracy = 0.900700
 epoch 7/30. Took 0.47152 seconds. 
  Full-batch training loss = 0.316807, test loss = 0.327889
  Training set accuracy = 0.908500, Test set accuracy = 0.905300
 epoch 8/30. Took 0.5138 seconds. 
  Full-batch training loss = 0.297491, test loss = 0.315306
  Training set accuracy = 0.912900, Test set accuracy = 0.908300
 epoch 9/30. Took 0.50563 seconds. 
  Full-batch training loss = 0.279697, test loss = 0.299512
  Training set accuracy = 0.918900, Test set accuracy = 0.913300
 epoch 10/30. Took 0.46893 seconds. 
  Full-batch training loss = 0.265162, test loss = 0.288042
  Training set accuracy = 0.921500, Test set accuracy = 0.915700
 epoch 11/30. Took 0.47235 seconds. 
  Full-batch training loss = 0.252701, test loss = 0.279268
  Training set accuracy = 0.925600, Test set accuracy = 0.919800
 epoch 12/30. Took 0.47734 seconds. 
  Full-batch training loss = 0.241553, test loss = 0.269213
  Training set accuracy = 0.927900, Test set accuracy = 0.922200
 epoch 13/30. Took 0.46981 seconds. 
  Full-batch training loss = 0.232285, test loss = 0.263734
  Training set accuracy = 0.932600, Test set accuracy = 0.923000
 epoch 14/30. Took 0.47027 seconds. 
  Full-batch training loss = 0.220076, test loss = 0.255867
  Training set accuracy = 0.936500, Test set accuracy = 0.925600
 epoch 15/30. Took 0.46703 seconds. 
  Full-batch training loss = 0.209444, test loss = 0.245457
  Training set accuracy = 0.940000, Test set accuracy = 0.927200
 epoch 16/30. Took 0.46706 seconds. 
  Full-batch training loss = 0.201752, test loss = 0.241026
  Training set accuracy = 0.941400, Test set accuracy = 0.928700
 epoch 17/30. Took 0.46986 seconds. 
  Full-batch training loss = 0.191573, test loss = 0.233312
  Training set accuracy = 0.945900, Test set accuracy = 0.931400
 epoch 18/30. Took 0.4733 seconds. 
  Full-batch training loss = 0.185315, test loss = 0.229642
  Training set accuracy = 0.948500, Test set accuracy = 0.931500
 epoch 19/30. Took 0.48619 seconds. 
  Full-batch training loss = 0.176806, test loss = 0.222938
  Training set accuracy = 0.949900, Test set accuracy = 0.932000
 epoch 20/30. Took 0.47072 seconds. 
  Full-batch training loss = 0.168701, test loss = 0.218393
  Training set accuracy = 0.953900, Test set accuracy = 0.933400
 epoch 21/30. Took 0.47824 seconds. 
  Full-batch training loss = 0.164175, test loss = 0.214622
  Training set accuracy = 0.954700, Test set accuracy = 0.934600
 epoch 22/30. Took 0.46852 seconds. 
  Full-batch training loss = 0.159377, test loss = 0.211414
  Training set accuracy = 0.955000, Test set accuracy = 0.936600
 epoch 23/30. Took 0.47301 seconds. 
  Full-batch training loss = 0.152145, test loss = 0.207588
  Training set accuracy = 0.956600, Test set accuracy = 0.937000
 epoch 24/30. Took 0.49102 seconds. 
  Full-batch training loss = 0.143781, test loss = 0.203212
  Training set accuracy = 0.959300, Test set accuracy = 0.938200
 epoch 25/30. Took 0.47801 seconds. 
  Full-batch training loss = 0.140358, test loss = 0.199677
  Training set accuracy = 0.961500, Test set accuracy = 0.940000
 epoch 26/30. Took 0.47923 seconds. 
  Full-batch training loss = 0.135644, test loss = 0.196711
  Training set accuracy = 0.962700, Test set accuracy = 0.940900
 epoch 27/30. Took 0.4686 seconds. 
  Full-batch training loss = 0.128176, test loss = 0.191429
  Training set accuracy = 0.965100, Test set accuracy = 0.942000
 epoch 28/30. Took 0.47609 seconds. 
  Full-batch training loss = 0.123548, test loss = 0.189138
  Training set accuracy = 0.965900, Test set accuracy = 0.942700
 epoch 29/30. Took 0.47309 seconds. 
  Full-batch training loss = 0.119429, test loss = 0.185966
  Training set accuracy = 0.966600, Test set accuracy = 0.943400
 epoch 30/30. Took 0.48025 seconds. 
  Full-batch training loss = 0.115284, test loss = 0.184859
  Training set accuracy = 0.968400, Test set accuracy = 0.943900
Elapsed time is 25.116455 seconds.
End Training
-----
Params 10000 0.010 0.20 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2169 seconds. 
  Full-batch training loss = 1.243362, test loss = 1.219491
  Training set accuracy = 0.771100, Test set accuracy = 0.784100
 epoch 2/30. Took 1.2206 seconds. 
  Full-batch training loss = 0.591595, test loss = 0.574114
  Training set accuracy = 0.852600, Test set accuracy = 0.857300
 epoch 3/30. Took 1.2582 seconds. 
  Full-batch training loss = 0.457125, test loss = 0.448311
  Training set accuracy = 0.872200, Test set accuracy = 0.876800
 epoch 4/30. Took 1.2432 seconds. 
  Full-batch training loss = 0.385153, test loss = 0.375941
  Training set accuracy = 0.889800, Test set accuracy = 0.896000
 epoch 5/30. Took 1.2079 seconds. 
  Full-batch training loss = 0.343496, test loss = 0.343872
  Training set accuracy = 0.900100, Test set accuracy = 0.902400
 epoch 6/30. Took 1.2026 seconds. 
  Full-batch training loss = 0.313511, test loss = 0.319402
  Training set accuracy = 0.909200, Test set accuracy = 0.907600
 epoch 7/30. Took 1.2896 seconds. 
  Full-batch training loss = 0.296452, test loss = 0.308663
  Training set accuracy = 0.912200, Test set accuracy = 0.912500
 epoch 8/30. Took 1.1998 seconds. 
  Full-batch training loss = 0.275197, test loss = 0.289439
  Training set accuracy = 0.920600, Test set accuracy = 0.915100
 epoch 9/30. Took 1.1991 seconds. 
  Full-batch training loss = 0.258143, test loss = 0.279015
  Training set accuracy = 0.924200, Test set accuracy = 0.920300
 epoch 10/30. Took 1.1997 seconds. 
  Full-batch training loss = 0.244564, test loss = 0.265738
  Training set accuracy = 0.928800, Test set accuracy = 0.923400
 epoch 11/30. Took 1.2119 seconds. 
  Full-batch training loss = 0.229860, test loss = 0.255336
  Training set accuracy = 0.934300, Test set accuracy = 0.927600
 epoch 12/30. Took 1.2365 seconds. 
  Full-batch training loss = 0.222263, test loss = 0.252446
  Training set accuracy = 0.935000, Test set accuracy = 0.926200
 epoch 13/30. Took 1.1967 seconds. 
  Full-batch training loss = 0.206419, test loss = 0.238507
  Training set accuracy = 0.940000, Test set accuracy = 0.930900
 epoch 14/30. Took 1.2595 seconds. 
  Full-batch training loss = 0.197917, test loss = 0.234010
  Training set accuracy = 0.944100, Test set accuracy = 0.930600
 epoch 15/30. Took 1.2147 seconds. 
  Full-batch training loss = 0.189064, test loss = 0.229011
  Training set accuracy = 0.945600, Test set accuracy = 0.932800
 epoch 16/30. Took 1.2606 seconds. 
  Full-batch training loss = 0.181454, test loss = 0.222548
  Training set accuracy = 0.947700, Test set accuracy = 0.932600
 epoch 17/30. Took 1.2033 seconds. 
  Full-batch training loss = 0.172266, test loss = 0.216475
  Training set accuracy = 0.950300, Test set accuracy = 0.936600
 epoch 18/30. Took 1.2113 seconds. 
  Full-batch training loss = 0.166452, test loss = 0.211424
  Training set accuracy = 0.951700, Test set accuracy = 0.937800
 epoch 19/30. Took 1.2011 seconds. 
  Full-batch training loss = 0.157203, test loss = 0.205890
  Training set accuracy = 0.955400, Test set accuracy = 0.938800
 epoch 20/30. Took 1.2376 seconds. 
  Full-batch training loss = 0.150593, test loss = 0.202035
  Training set accuracy = 0.958200, Test set accuracy = 0.941000
 epoch 21/30. Took 1.2227 seconds. 
  Full-batch training loss = 0.143684, test loss = 0.198490
  Training set accuracy = 0.959500, Test set accuracy = 0.940300
 epoch 22/30. Took 1.2196 seconds. 
  Full-batch training loss = 0.137799, test loss = 0.193805
  Training set accuracy = 0.961300, Test set accuracy = 0.942300
 epoch 23/30. Took 1.2034 seconds. 
  Full-batch training loss = 0.131362, test loss = 0.190047
  Training set accuracy = 0.963000, Test set accuracy = 0.943600
 epoch 24/30. Took 1.2049 seconds. 
  Full-batch training loss = 0.126314, test loss = 0.185459
  Training set accuracy = 0.965500, Test set accuracy = 0.944800
 epoch 25/30. Took 1.2393 seconds. 
  Full-batch training loss = 0.122733, test loss = 0.184306
  Training set accuracy = 0.965800, Test set accuracy = 0.945000
 epoch 26/30. Took 1.2012 seconds. 
  Full-batch training loss = 0.115010, test loss = 0.178277
  Training set accuracy = 0.969000, Test set accuracy = 0.947700
 epoch 27/30. Took 1.2184 seconds. 
  Full-batch training loss = 0.111975, test loss = 0.177652
  Training set accuracy = 0.970400, Test set accuracy = 0.946800
 epoch 28/30. Took 1.2007 seconds. 
  Full-batch training loss = 0.108745, test loss = 0.176039
  Training set accuracy = 0.970800, Test set accuracy = 0.947800
 epoch 29/30. Took 1.1976 seconds. 
  Full-batch training loss = 0.101586, test loss = 0.171857
  Training set accuracy = 0.973800, Test set accuracy = 0.948800
 epoch 30/30. Took 1.1999 seconds. 
  Full-batch training loss = 0.098030, test loss = 0.170767
  Training set accuracy = 0.974900, Test set accuracy = 0.949000
Elapsed time is 62.597519 seconds.
End Training
-----
Params 10000 0.010 0.20 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.33316 seconds. 
  Full-batch training loss = 2.124778, test loss = 2.123613
  Training set accuracy = 0.488700, Test set accuracy = 0.489300
 epoch 2/30. Took 0.3345 seconds. 
  Full-batch training loss = 1.249528, test loss = 1.237332
  Training set accuracy = 0.712300, Test set accuracy = 0.726300
 epoch 3/30. Took 0.35021 seconds. 
  Full-batch training loss = 0.731807, test loss = 0.719460
  Training set accuracy = 0.800600, Test set accuracy = 0.804300
 epoch 4/30. Took 0.31834 seconds. 
  Full-batch training loss = 0.572218, test loss = 0.554753
  Training set accuracy = 0.835000, Test set accuracy = 0.841400
 epoch 5/30. Took 0.33451 seconds. 
  Full-batch training loss = 0.474245, test loss = 0.464559
  Training set accuracy = 0.863400, Test set accuracy = 0.866000
 epoch 6/30. Took 0.33728 seconds. 
  Full-batch training loss = 0.421270, test loss = 0.413532
  Training set accuracy = 0.877800, Test set accuracy = 0.881100
 epoch 7/30. Took 0.34748 seconds. 
  Full-batch training loss = 0.383147, test loss = 0.378219
  Training set accuracy = 0.889500, Test set accuracy = 0.891300
 epoch 8/30. Took 0.33832 seconds. 
  Full-batch training loss = 0.354464, test loss = 0.353621
  Training set accuracy = 0.897900, Test set accuracy = 0.897800
 epoch 9/30. Took 0.33811 seconds. 
  Full-batch training loss = 0.328371, test loss = 0.328309
  Training set accuracy = 0.903300, Test set accuracy = 0.903900
 epoch 10/30. Took 0.33824 seconds. 
  Full-batch training loss = 0.306248, test loss = 0.310948
  Training set accuracy = 0.909000, Test set accuracy = 0.906700
 epoch 11/30. Took 0.33043 seconds. 
  Full-batch training loss = 0.286305, test loss = 0.293926
  Training set accuracy = 0.914500, Test set accuracy = 0.910300
 epoch 12/30. Took 0.33996 seconds. 
  Full-batch training loss = 0.267813, test loss = 0.280542
  Training set accuracy = 0.919200, Test set accuracy = 0.916200
 epoch 13/30. Took 0.33023 seconds. 
  Full-batch training loss = 0.251660, test loss = 0.267355
  Training set accuracy = 0.924400, Test set accuracy = 0.918900
 epoch 14/30. Took 0.34641 seconds. 
  Full-batch training loss = 0.239366, test loss = 0.260641
  Training set accuracy = 0.927800, Test set accuracy = 0.921600
 epoch 15/30. Took 0.31676 seconds. 
  Full-batch training loss = 0.225755, test loss = 0.250466
  Training set accuracy = 0.931400, Test set accuracy = 0.924400
 epoch 16/30. Took 0.33582 seconds. 
  Full-batch training loss = 0.219844, test loss = 0.246315
  Training set accuracy = 0.934100, Test set accuracy = 0.926500
 epoch 17/30. Took 0.33692 seconds. 
  Full-batch training loss = 0.203891, test loss = 0.235484
  Training set accuracy = 0.940500, Test set accuracy = 0.930400
 epoch 18/30. Took 0.33651 seconds. 
  Full-batch training loss = 0.196574, test loss = 0.231290
  Training set accuracy = 0.940400, Test set accuracy = 0.929700
 epoch 19/30. Took 0.33892 seconds. 
  Full-batch training loss = 0.182500, test loss = 0.218927
  Training set accuracy = 0.945100, Test set accuracy = 0.934200
 epoch 20/30. Took 0.34131 seconds. 
  Full-batch training loss = 0.178467, test loss = 0.218632
  Training set accuracy = 0.946600, Test set accuracy = 0.933800
 epoch 21/30. Took 0.32283 seconds. 
  Full-batch training loss = 0.166435, test loss = 0.210895
  Training set accuracy = 0.950800, Test set accuracy = 0.936400
 epoch 22/30. Took 0.31553 seconds. 
  Full-batch training loss = 0.158918, test loss = 0.206460
  Training set accuracy = 0.953400, Test set accuracy = 0.937300
 epoch 23/30. Took 0.31643 seconds. 
  Full-batch training loss = 0.150910, test loss = 0.200804
  Training set accuracy = 0.955200, Test set accuracy = 0.937700
 epoch 24/30. Took 0.3379 seconds. 
  Full-batch training loss = 0.143670, test loss = 0.196601
  Training set accuracy = 0.958300, Test set accuracy = 0.940500
 epoch 25/30. Took 0.31584 seconds. 
  Full-batch training loss = 0.136303, test loss = 0.190977
  Training set accuracy = 0.959100, Test set accuracy = 0.940400
 epoch 26/30. Took 0.31914 seconds. 
  Full-batch training loss = 0.131089, test loss = 0.189191
  Training set accuracy = 0.961500, Test set accuracy = 0.941500
 epoch 27/30. Took 0.33629 seconds. 
  Full-batch training loss = 0.127931, test loss = 0.189195
  Training set accuracy = 0.961900, Test set accuracy = 0.942100
 epoch 28/30. Took 0.31808 seconds. 
  Full-batch training loss = 0.118972, test loss = 0.180730
  Training set accuracy = 0.964800, Test set accuracy = 0.943600
 epoch 29/30. Took 0.33909 seconds. 
  Full-batch training loss = 0.115016, test loss = 0.177796
  Training set accuracy = 0.966700, Test set accuracy = 0.943300
 epoch 30/30. Took 0.3379 seconds. 
  Full-batch training loss = 0.110386, test loss = 0.175978
  Training set accuracy = 0.968500, Test set accuracy = 0.946500
Elapsed time is 18.133683 seconds.
End Training
-----
Params 10000 0.010 0.20 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.57002 seconds. 
  Full-batch training loss = 2.013858, test loss = 2.010216
  Training set accuracy = 0.599800, Test set accuracy = 0.600200
 epoch 2/30. Took 0.58674 seconds. 
  Full-batch training loss = 0.903016, test loss = 0.889071
  Training set accuracy = 0.767300, Test set accuracy = 0.772700
 epoch 3/30. Took 0.56422 seconds. 
  Full-batch training loss = 0.547038, test loss = 0.538921
  Training set accuracy = 0.854300, Test set accuracy = 0.851400
 epoch 4/30. Took 0.55878 seconds. 
  Full-batch training loss = 0.439668, test loss = 0.439842
  Training set accuracy = 0.878100, Test set accuracy = 0.873500
 epoch 5/30. Took 0.60823 seconds. 
  Full-batch training loss = 0.377934, test loss = 0.385115
  Training set accuracy = 0.896000, Test set accuracy = 0.889100
 epoch 6/30. Took 0.57305 seconds. 
  Full-batch training loss = 0.337756, test loss = 0.348184
  Training set accuracy = 0.904600, Test set accuracy = 0.899900
 epoch 7/30. Took 0.56494 seconds. 
  Full-batch training loss = 0.315567, test loss = 0.329622
  Training set accuracy = 0.911200, Test set accuracy = 0.904400
 epoch 8/30. Took 0.55962 seconds. 
  Full-batch training loss = 0.288856, test loss = 0.309358
  Training set accuracy = 0.918400, Test set accuracy = 0.908600
 epoch 9/30. Took 0.58496 seconds. 
  Full-batch training loss = 0.268780, test loss = 0.292946
  Training set accuracy = 0.924800, Test set accuracy = 0.915400
 epoch 10/30. Took 0.57696 seconds. 
  Full-batch training loss = 0.253158, test loss = 0.283723
  Training set accuracy = 0.927800, Test set accuracy = 0.914700
 epoch 11/30. Took 0.57559 seconds. 
  Full-batch training loss = 0.239736, test loss = 0.272202
  Training set accuracy = 0.930800, Test set accuracy = 0.919800
 epoch 12/30. Took 0.57234 seconds. 
  Full-batch training loss = 0.222948, test loss = 0.257678
  Training set accuracy = 0.939400, Test set accuracy = 0.924000
 epoch 13/30. Took 0.62038 seconds. 
  Full-batch training loss = 0.210540, test loss = 0.248779
  Training set accuracy = 0.941700, Test set accuracy = 0.926400
 epoch 14/30. Took 0.57956 seconds. 
  Full-batch training loss = 0.197206, test loss = 0.238588
  Training set accuracy = 0.945400, Test set accuracy = 0.929000
 epoch 15/30. Took 0.57985 seconds. 
  Full-batch training loss = 0.189768, test loss = 0.235974
  Training set accuracy = 0.947600, Test set accuracy = 0.929700
 epoch 16/30. Took 0.60171 seconds. 
  Full-batch training loss = 0.175859, test loss = 0.225354
  Training set accuracy = 0.952400, Test set accuracy = 0.932900
 epoch 17/30. Took 0.57171 seconds. 
  Full-batch training loss = 0.167195, test loss = 0.219167
  Training set accuracy = 0.953300, Test set accuracy = 0.934500
 epoch 18/30. Took 0.56499 seconds. 
  Full-batch training loss = 0.155722, test loss = 0.208042
  Training set accuracy = 0.958600, Test set accuracy = 0.937200
 epoch 19/30. Took 0.56849 seconds. 
  Full-batch training loss = 0.146602, test loss = 0.201334
  Training set accuracy = 0.959900, Test set accuracy = 0.938100
 epoch 20/30. Took 0.56443 seconds. 
  Full-batch training loss = 0.137846, test loss = 0.197350
  Training set accuracy = 0.962100, Test set accuracy = 0.939100
 epoch 21/30. Took 0.55502 seconds. 
  Full-batch training loss = 0.133887, test loss = 0.197842
  Training set accuracy = 0.963000, Test set accuracy = 0.940100
 epoch 22/30. Took 0.57162 seconds. 
  Full-batch training loss = 0.125329, test loss = 0.188781
  Training set accuracy = 0.966300, Test set accuracy = 0.943300
 epoch 23/30. Took 0.57661 seconds. 
  Full-batch training loss = 0.120073, test loss = 0.190791
  Training set accuracy = 0.967400, Test set accuracy = 0.942800
 epoch 24/30. Took 0.55541 seconds. 
  Full-batch training loss = 0.113460, test loss = 0.185241
  Training set accuracy = 0.969000, Test set accuracy = 0.943300
 epoch 25/30. Took 0.55746 seconds. 
  Full-batch training loss = 0.107651, test loss = 0.180008
  Training set accuracy = 0.968700, Test set accuracy = 0.945700
 epoch 26/30. Took 0.5735 seconds. 
  Full-batch training loss = 0.100096, test loss = 0.177874
  Training set accuracy = 0.973100, Test set accuracy = 0.945700
 epoch 27/30. Took 0.57503 seconds. 
  Full-batch training loss = 0.093920, test loss = 0.174073
  Training set accuracy = 0.973500, Test set accuracy = 0.946200
 epoch 28/30. Took 0.57627 seconds. 
  Full-batch training loss = 0.091819, test loss = 0.170047
  Training set accuracy = 0.974800, Test set accuracy = 0.948100
 epoch 29/30. Took 0.58877 seconds. 
  Full-batch training loss = 0.087405, test loss = 0.168073
  Training set accuracy = 0.975700, Test set accuracy = 0.946900
 epoch 30/30. Took 0.61032 seconds. 
  Full-batch training loss = 0.079811, test loss = 0.163812
  Training set accuracy = 0.978100, Test set accuracy = 0.951000
Elapsed time is 30.643345 seconds.
End Training
-----
Params 10000 0.010 0.20 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.7384 seconds. 
  Full-batch training loss = 1.821759, test loss = 1.811802
  Training set accuracy = 0.678600, Test set accuracy = 0.683400
 epoch 2/30. Took 1.6586 seconds. 
  Full-batch training loss = 0.710207, test loss = 0.696543
  Training set accuracy = 0.818500, Test set accuracy = 0.821200
 epoch 3/30. Took 1.6624 seconds. 
  Full-batch training loss = 0.478267, test loss = 0.467594
  Training set accuracy = 0.873400, Test set accuracy = 0.875100
 epoch 4/30. Took 1.66 seconds. 
  Full-batch training loss = 0.394897, test loss = 0.390070
  Training set accuracy = 0.889200, Test set accuracy = 0.891000
 epoch 5/30. Took 1.679 seconds. 
  Full-batch training loss = 0.347663, test loss = 0.350562
  Training set accuracy = 0.902400, Test set accuracy = 0.899600
 epoch 6/30. Took 1.7552 seconds. 
  Full-batch training loss = 0.321144, test loss = 0.324800
  Training set accuracy = 0.908600, Test set accuracy = 0.908000
 epoch 7/30. Took 1.6594 seconds. 
  Full-batch training loss = 0.292375, test loss = 0.301744
  Training set accuracy = 0.916700, Test set accuracy = 0.915600
 epoch 8/30. Took 1.6651 seconds. 
  Full-batch training loss = 0.275390, test loss = 0.292174
  Training set accuracy = 0.920500, Test set accuracy = 0.915700
 epoch 9/30. Took 1.6906 seconds. 
  Full-batch training loss = 0.253313, test loss = 0.271524
  Training set accuracy = 0.927900, Test set accuracy = 0.922000
 epoch 10/30. Took 1.6629 seconds. 
  Full-batch training loss = 0.236484, test loss = 0.259418
  Training set accuracy = 0.930900, Test set accuracy = 0.924900
 epoch 11/30. Took 1.6544 seconds. 
  Full-batch training loss = 0.221775, test loss = 0.247580
  Training set accuracy = 0.936400, Test set accuracy = 0.928500
 epoch 12/30. Took 1.6702 seconds. 
  Full-batch training loss = 0.209051, test loss = 0.239687
  Training set accuracy = 0.939700, Test set accuracy = 0.931700
 epoch 13/30. Took 1.6667 seconds. 
  Full-batch training loss = 0.196731, test loss = 0.229267
  Training set accuracy = 0.943100, Test set accuracy = 0.935300
 epoch 14/30. Took 1.7732 seconds. 
  Full-batch training loss = 0.184426, test loss = 0.221322
  Training set accuracy = 0.946200, Test set accuracy = 0.936500
 epoch 15/30. Took 1.6754 seconds. 
  Full-batch training loss = 0.171581, test loss = 0.212321
  Training set accuracy = 0.950000, Test set accuracy = 0.939100
 epoch 16/30. Took 1.6758 seconds. 
  Full-batch training loss = 0.160771, test loss = 0.206500
  Training set accuracy = 0.952400, Test set accuracy = 0.940900
 epoch 17/30. Took 1.7033 seconds. 
  Full-batch training loss = 0.152473, test loss = 0.198943
  Training set accuracy = 0.955200, Test set accuracy = 0.942800
 epoch 18/30. Took 1.6572 seconds. 
  Full-batch training loss = 0.144166, test loss = 0.192813
  Training set accuracy = 0.958400, Test set accuracy = 0.943700
 epoch 19/30. Took 1.7477 seconds. 
  Full-batch training loss = 0.134025, test loss = 0.186847
  Training set accuracy = 0.961300, Test set accuracy = 0.944900
 epoch 20/30. Took 1.719 seconds. 
  Full-batch training loss = 0.125856, test loss = 0.179911
  Training set accuracy = 0.963800, Test set accuracy = 0.947600
 epoch 21/30. Took 1.7345 seconds. 
  Full-batch training loss = 0.119319, test loss = 0.179195
  Training set accuracy = 0.966900, Test set accuracy = 0.946500
 epoch 22/30. Took 1.7063 seconds. 
  Full-batch training loss = 0.113744, test loss = 0.172086
  Training set accuracy = 0.967400, Test set accuracy = 0.948900
 epoch 23/30. Took 1.6971 seconds. 
  Full-batch training loss = 0.102317, test loss = 0.166503
  Training set accuracy = 0.971600, Test set accuracy = 0.950800
 epoch 24/30. Took 1.6827 seconds. 
  Full-batch training loss = 0.098065, test loss = 0.164510
  Training set accuracy = 0.972400, Test set accuracy = 0.950300
 epoch 25/30. Took 1.7301 seconds. 
  Full-batch training loss = 0.092628, test loss = 0.161770
  Training set accuracy = 0.974400, Test set accuracy = 0.952300
 epoch 26/30. Took 1.6912 seconds. 
  Full-batch training loss = 0.085277, test loss = 0.159333
  Training set accuracy = 0.977800, Test set accuracy = 0.951800
 epoch 27/30. Took 1.6675 seconds. 
  Full-batch training loss = 0.082340, test loss = 0.157442
  Training set accuracy = 0.976700, Test set accuracy = 0.951600
 epoch 28/30. Took 1.7186 seconds. 
  Full-batch training loss = 0.077738, test loss = 0.158130
  Training set accuracy = 0.978600, Test set accuracy = 0.952200
 epoch 29/30. Took 1.6717 seconds. 
  Full-batch training loss = 0.071003, test loss = 0.152822
  Training set accuracy = 0.982000, Test set accuracy = 0.953300
 epoch 30/30. Took 1.674 seconds. 
  Full-batch training loss = 0.066005, test loss = 0.149313
  Training set accuracy = 0.982900, Test set accuracy = 0.955300
Elapsed time is 86.568489 seconds.
End Training
-----
Params 10000 0.010 0.30 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23433 seconds. 
  Full-batch training loss = 1.249191, test loss = 1.235014
  Training set accuracy = 0.770100, Test set accuracy = 0.778000
 epoch 2/30. Took 0.22997 seconds. 
  Full-batch training loss = 0.720187, test loss = 0.705810
  Training set accuracy = 0.850800, Test set accuracy = 0.854500
 epoch 3/30. Took 0.23147 seconds. 
  Full-batch training loss = 0.557818, test loss = 0.548273
  Training set accuracy = 0.864800, Test set accuracy = 0.870900
 epoch 4/30. Took 0.22543 seconds. 
  Full-batch training loss = 0.476299, test loss = 0.470312
  Training set accuracy = 0.881900, Test set accuracy = 0.885000
 epoch 5/30. Took 0.23004 seconds. 
  Full-batch training loss = 0.430189, test loss = 0.427569
  Training set accuracy = 0.890600, Test set accuracy = 0.891400
 epoch 6/30. Took 0.23126 seconds. 
  Full-batch training loss = 0.397036, test loss = 0.397071
  Training set accuracy = 0.897600, Test set accuracy = 0.895900
 epoch 7/30. Took 0.22992 seconds. 
  Full-batch training loss = 0.374839, test loss = 0.377888
  Training set accuracy = 0.901100, Test set accuracy = 0.899000
 epoch 8/30. Took 0.2313 seconds. 
  Full-batch training loss = 0.355231, test loss = 0.359585
  Training set accuracy = 0.904700, Test set accuracy = 0.903200
 epoch 9/30. Took 0.22897 seconds. 
  Full-batch training loss = 0.341178, test loss = 0.348384
  Training set accuracy = 0.908700, Test set accuracy = 0.905600
 epoch 10/30. Took 0.23042 seconds. 
  Full-batch training loss = 0.327112, test loss = 0.337031
  Training set accuracy = 0.909400, Test set accuracy = 0.906600
 epoch 11/30. Took 0.22958 seconds. 
  Full-batch training loss = 0.314112, test loss = 0.327247
  Training set accuracy = 0.913700, Test set accuracy = 0.910200
 epoch 12/30. Took 0.23181 seconds. 
  Full-batch training loss = 0.302578, test loss = 0.317398
  Training set accuracy = 0.917700, Test set accuracy = 0.912300
 epoch 13/30. Took 0.23149 seconds. 
  Full-batch training loss = 0.293592, test loss = 0.309513
  Training set accuracy = 0.919200, Test set accuracy = 0.913500
 epoch 14/30. Took 0.23114 seconds. 
  Full-batch training loss = 0.284089, test loss = 0.302182
  Training set accuracy = 0.922400, Test set accuracy = 0.915400
 epoch 15/30. Took 0.22956 seconds. 
  Full-batch training loss = 0.276612, test loss = 0.296412
  Training set accuracy = 0.923500, Test set accuracy = 0.917400
 epoch 16/30. Took 0.23094 seconds. 
  Full-batch training loss = 0.269583, test loss = 0.291242
  Training set accuracy = 0.925200, Test set accuracy = 0.917600
 epoch 17/30. Took 0.23225 seconds. 
  Full-batch training loss = 0.262389, test loss = 0.285681
  Training set accuracy = 0.928100, Test set accuracy = 0.920100
 epoch 18/30. Took 0.23511 seconds. 
  Full-batch training loss = 0.254430, test loss = 0.278423
  Training set accuracy = 0.930100, Test set accuracy = 0.921900
 epoch 19/30. Took 0.2314 seconds. 
  Full-batch training loss = 0.248923, test loss = 0.275688
  Training set accuracy = 0.930700, Test set accuracy = 0.921000
 epoch 20/30. Took 0.23199 seconds. 
  Full-batch training loss = 0.242485, test loss = 0.269066
  Training set accuracy = 0.933100, Test set accuracy = 0.922700
 epoch 21/30. Took 0.22992 seconds. 
  Full-batch training loss = 0.236716, test loss = 0.265051
  Training set accuracy = 0.934400, Test set accuracy = 0.923900
 epoch 22/30. Took 0.23003 seconds. 
  Full-batch training loss = 0.231903, test loss = 0.261826
  Training set accuracy = 0.935900, Test set accuracy = 0.924600
 epoch 23/30. Took 0.23475 seconds. 
  Full-batch training loss = 0.227463, test loss = 0.257455
  Training set accuracy = 0.938600, Test set accuracy = 0.925100
 epoch 24/30. Took 0.24164 seconds. 
  Full-batch training loss = 0.221587, test loss = 0.253341
  Training set accuracy = 0.939800, Test set accuracy = 0.926900
 epoch 25/30. Took 0.2448 seconds. 
  Full-batch training loss = 0.215698, test loss = 0.249847
  Training set accuracy = 0.942200, Test set accuracy = 0.928000
 epoch 26/30. Took 0.24207 seconds. 
  Full-batch training loss = 0.211189, test loss = 0.245475
  Training set accuracy = 0.942700, Test set accuracy = 0.929100
 epoch 27/30. Took 0.22967 seconds. 
  Full-batch training loss = 0.207530, test loss = 0.243965
  Training set accuracy = 0.943600, Test set accuracy = 0.928900
 epoch 28/30. Took 0.23101 seconds. 
  Full-batch training loss = 0.202810, test loss = 0.239080
  Training set accuracy = 0.945000, Test set accuracy = 0.930600
 epoch 29/30. Took 0.23106 seconds. 
  Full-batch training loss = 0.199033, test loss = 0.236246
  Training set accuracy = 0.946900, Test set accuracy = 0.931400
 epoch 30/30. Took 0.23101 seconds. 
  Full-batch training loss = 0.195077, test loss = 0.233531
  Training set accuracy = 0.946700, Test set accuracy = 0.931400
Elapsed time is 13.356412 seconds.
End Training
-----
Params 10000 0.010 0.30 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35847 seconds. 
  Full-batch training loss = 1.165188, test loss = 1.144040
  Training set accuracy = 0.787400, Test set accuracy = 0.798400
 epoch 2/30. Took 0.35929 seconds. 
  Full-batch training loss = 0.681406, test loss = 0.661652
  Training set accuracy = 0.851800, Test set accuracy = 0.856800
 epoch 3/30. Took 0.35684 seconds. 
  Full-batch training loss = 0.528901, test loss = 0.516091
  Training set accuracy = 0.872400, Test set accuracy = 0.877600
 epoch 4/30. Took 0.36057 seconds. 
  Full-batch training loss = 0.456905, test loss = 0.448482
  Training set accuracy = 0.885300, Test set accuracy = 0.888900
 epoch 5/30. Took 0.35785 seconds. 
  Full-batch training loss = 0.411179, test loss = 0.404969
  Training set accuracy = 0.893800, Test set accuracy = 0.896300
 epoch 6/30. Took 0.36624 seconds. 
  Full-batch training loss = 0.382939, test loss = 0.381125
  Training set accuracy = 0.896800, Test set accuracy = 0.897600
 epoch 7/30. Took 0.3609 seconds. 
  Full-batch training loss = 0.361347, test loss = 0.361450
  Training set accuracy = 0.902700, Test set accuracy = 0.904900
 epoch 8/30. Took 0.35877 seconds. 
  Full-batch training loss = 0.341761, test loss = 0.345179
  Training set accuracy = 0.906000, Test set accuracy = 0.907600
 epoch 9/30. Took 0.35703 seconds. 
  Full-batch training loss = 0.326533, test loss = 0.331923
  Training set accuracy = 0.909600, Test set accuracy = 0.909500
 epoch 10/30. Took 0.3575 seconds. 
  Full-batch training loss = 0.313926, test loss = 0.322074
  Training set accuracy = 0.912900, Test set accuracy = 0.911800
 epoch 11/30. Took 0.38881 seconds. 
  Full-batch training loss = 0.302884, test loss = 0.314498
  Training set accuracy = 0.914800, Test set accuracy = 0.913200
 epoch 12/30. Took 0.3574 seconds. 
  Full-batch training loss = 0.293417, test loss = 0.307284
  Training set accuracy = 0.916600, Test set accuracy = 0.914600
 epoch 13/30. Took 0.35601 seconds. 
  Full-batch training loss = 0.283610, test loss = 0.297485
  Training set accuracy = 0.922600, Test set accuracy = 0.919100
 epoch 14/30. Took 0.35478 seconds. 
  Full-batch training loss = 0.274911, test loss = 0.291406
  Training set accuracy = 0.923500, Test set accuracy = 0.920400
 epoch 15/30. Took 0.35736 seconds. 
  Full-batch training loss = 0.267694, test loss = 0.287371
  Training set accuracy = 0.926100, Test set accuracy = 0.920800
 epoch 16/30. Took 0.35704 seconds. 
  Full-batch training loss = 0.259641, test loss = 0.280554
  Training set accuracy = 0.928200, Test set accuracy = 0.922900
 epoch 17/30. Took 0.35667 seconds. 
  Full-batch training loss = 0.252571, test loss = 0.274446
  Training set accuracy = 0.931200, Test set accuracy = 0.923000
 epoch 18/30. Took 0.38983 seconds. 
  Full-batch training loss = 0.245573, test loss = 0.268027
  Training set accuracy = 0.932600, Test set accuracy = 0.924900
 epoch 19/30. Took 0.35644 seconds. 
  Full-batch training loss = 0.240561, test loss = 0.264806
  Training set accuracy = 0.933400, Test set accuracy = 0.926000
 epoch 20/30. Took 0.3589 seconds. 
  Full-batch training loss = 0.234250, test loss = 0.261227
  Training set accuracy = 0.935500, Test set accuracy = 0.928500
 epoch 21/30. Took 0.3606 seconds. 
  Full-batch training loss = 0.228314, test loss = 0.255296
  Training set accuracy = 0.936400, Test set accuracy = 0.927800
 epoch 22/30. Took 0.35943 seconds. 
  Full-batch training loss = 0.223869, test loss = 0.250803
  Training set accuracy = 0.938200, Test set accuracy = 0.929200
 epoch 23/30. Took 0.35695 seconds. 
  Full-batch training loss = 0.218343, test loss = 0.246871
  Training set accuracy = 0.940500, Test set accuracy = 0.930900
 epoch 24/30. Took 0.3624 seconds. 
  Full-batch training loss = 0.213716, test loss = 0.243691
  Training set accuracy = 0.942700, Test set accuracy = 0.932000
 epoch 25/30. Took 0.35875 seconds. 
  Full-batch training loss = 0.209347, test loss = 0.241484
  Training set accuracy = 0.943700, Test set accuracy = 0.930000
 epoch 26/30. Took 0.35904 seconds. 
  Full-batch training loss = 0.204139, test loss = 0.238301
  Training set accuracy = 0.944100, Test set accuracy = 0.933100
 epoch 27/30. Took 0.35902 seconds. 
  Full-batch training loss = 0.200487, test loss = 0.235092
  Training set accuracy = 0.944900, Test set accuracy = 0.934400
 epoch 28/30. Took 0.35872 seconds. 
  Full-batch training loss = 0.195837, test loss = 0.231009
  Training set accuracy = 0.947400, Test set accuracy = 0.933100
 epoch 29/30. Took 0.35709 seconds. 
  Full-batch training loss = 0.192883, test loss = 0.228710
  Training set accuracy = 0.948200, Test set accuracy = 0.935500
 epoch 30/30. Took 0.38482 seconds. 
  Full-batch training loss = 0.188525, test loss = 0.226167
  Training set accuracy = 0.947800, Test set accuracy = 0.934500
Elapsed time is 19.389659 seconds.
End Training
-----
Params 10000 0.010 0.30 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.74282 seconds. 
  Full-batch training loss = 1.057570, test loss = 1.034490
  Training set accuracy = 0.802800, Test set accuracy = 0.808200
 epoch 2/30. Took 0.77112 seconds. 
  Full-batch training loss = 0.637476, test loss = 0.614717
  Training set accuracy = 0.856600, Test set accuracy = 0.863800
 epoch 3/30. Took 0.7597 seconds. 
  Full-batch training loss = 0.505431, test loss = 0.487973
  Training set accuracy = 0.874400, Test set accuracy = 0.880900
 epoch 4/30. Took 0.73158 seconds. 
  Full-batch training loss = 0.439649, test loss = 0.426346
  Training set accuracy = 0.884900, Test set accuracy = 0.890500
 epoch 5/30. Took 0.74423 seconds. 
  Full-batch training loss = 0.398415, test loss = 0.387961
  Training set accuracy = 0.895400, Test set accuracy = 0.898500
 epoch 6/30. Took 0.72884 seconds. 
  Full-batch training loss = 0.370416, test loss = 0.364978
  Training set accuracy = 0.899100, Test set accuracy = 0.901600
 epoch 7/30. Took 0.73825 seconds. 
  Full-batch training loss = 0.349599, test loss = 0.347396
  Training set accuracy = 0.904300, Test set accuracy = 0.905200
 epoch 8/30. Took 0.73677 seconds. 
  Full-batch training loss = 0.331598, test loss = 0.333149
  Training set accuracy = 0.909500, Test set accuracy = 0.908000
 epoch 9/30. Took 0.73432 seconds. 
  Full-batch training loss = 0.317186, test loss = 0.320910
  Training set accuracy = 0.911900, Test set accuracy = 0.910700
 epoch 10/30. Took 0.73052 seconds. 
  Full-batch training loss = 0.305054, test loss = 0.310833
  Training set accuracy = 0.913900, Test set accuracy = 0.911900
 epoch 11/30. Took 0.74177 seconds. 
  Full-batch training loss = 0.294038, test loss = 0.304385
  Training set accuracy = 0.916200, Test set accuracy = 0.913300
 epoch 12/30. Took 0.73137 seconds. 
  Full-batch training loss = 0.283996, test loss = 0.295476
  Training set accuracy = 0.919700, Test set accuracy = 0.916100
 epoch 13/30. Took 0.74323 seconds. 
  Full-batch training loss = 0.273580, test loss = 0.288805
  Training set accuracy = 0.923500, Test set accuracy = 0.918300
 epoch 14/30. Took 0.73301 seconds. 
  Full-batch training loss = 0.266199, test loss = 0.282834
  Training set accuracy = 0.924300, Test set accuracy = 0.920200
 epoch 15/30. Took 0.73249 seconds. 
  Full-batch training loss = 0.259641, test loss = 0.280332
  Training set accuracy = 0.928600, Test set accuracy = 0.920800
 epoch 16/30. Took 0.76989 seconds. 
  Full-batch training loss = 0.250881, test loss = 0.271612
  Training set accuracy = 0.930000, Test set accuracy = 0.923700
 epoch 17/30. Took 0.72832 seconds. 
  Full-batch training loss = 0.243754, test loss = 0.267112
  Training set accuracy = 0.931000, Test set accuracy = 0.922700
 epoch 18/30. Took 0.75563 seconds. 
  Full-batch training loss = 0.236640, test loss = 0.262713
  Training set accuracy = 0.933600, Test set accuracy = 0.924100
 epoch 19/30. Took 0.75629 seconds. 
  Full-batch training loss = 0.230075, test loss = 0.257699
  Training set accuracy = 0.936200, Test set accuracy = 0.926500
 epoch 20/30. Took 0.73083 seconds. 
  Full-batch training loss = 0.224072, test loss = 0.253715
  Training set accuracy = 0.938400, Test set accuracy = 0.927400
 epoch 21/30. Took 0.76731 seconds. 
  Full-batch training loss = 0.218998, test loss = 0.249403
  Training set accuracy = 0.938100, Test set accuracy = 0.927500
 epoch 22/30. Took 0.72888 seconds. 
  Full-batch training loss = 0.213654, test loss = 0.245708
  Training set accuracy = 0.940300, Test set accuracy = 0.929300
 epoch 23/30. Took 0.73904 seconds. 
  Full-batch training loss = 0.207678, test loss = 0.241746
  Training set accuracy = 0.944100, Test set accuracy = 0.931100
 epoch 24/30. Took 0.73109 seconds. 
  Full-batch training loss = 0.202897, test loss = 0.238007
  Training set accuracy = 0.943900, Test set accuracy = 0.931200
 epoch 25/30. Took 0.73135 seconds. 
  Full-batch training loss = 0.197828, test loss = 0.233969
  Training set accuracy = 0.945900, Test set accuracy = 0.932500
 epoch 26/30. Took 0.76848 seconds. 
  Full-batch training loss = 0.193580, test loss = 0.230753
  Training set accuracy = 0.947200, Test set accuracy = 0.931700
 epoch 27/30. Took 0.75002 seconds. 
  Full-batch training loss = 0.188600, test loss = 0.227330
  Training set accuracy = 0.948300, Test set accuracy = 0.934600
 epoch 28/30. Took 0.73425 seconds. 
  Full-batch training loss = 0.184690, test loss = 0.224371
  Training set accuracy = 0.950400, Test set accuracy = 0.936000
 epoch 29/30. Took 0.74027 seconds. 
  Full-batch training loss = 0.180524, test loss = 0.221471
  Training set accuracy = 0.950800, Test set accuracy = 0.935900
 epoch 30/30. Took 0.73391 seconds. 
  Full-batch training loss = 0.176210, test loss = 0.218953
  Training set accuracy = 0.952800, Test set accuracy = 0.935700
Elapsed time is 38.610947 seconds.
End Training
-----
Params 10000 0.010 0.30 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28236 seconds. 
  Full-batch training loss = 1.834357, test loss = 1.827016
  Training set accuracy = 0.645700, Test set accuracy = 0.642500
 epoch 2/30. Took 0.28726 seconds. 
  Full-batch training loss = 0.980156, test loss = 0.972799
  Training set accuracy = 0.789200, Test set accuracy = 0.787000
 epoch 3/30. Took 0.28631 seconds. 
  Full-batch training loss = 0.671242, test loss = 0.667812
  Training set accuracy = 0.837900, Test set accuracy = 0.834700
 epoch 4/30. Took 0.28632 seconds. 
  Full-batch training loss = 0.547042, test loss = 0.543612
  Training set accuracy = 0.858800, Test set accuracy = 0.858200
 epoch 5/30. Took 0.28665 seconds. 
  Full-batch training loss = 0.478600, test loss = 0.475532
  Training set accuracy = 0.872900, Test set accuracy = 0.872900
 epoch 6/30. Took 0.28627 seconds. 
  Full-batch training loss = 0.430093, test loss = 0.431631
  Training set accuracy = 0.882800, Test set accuracy = 0.883100
 epoch 7/30. Took 0.28364 seconds. 
  Full-batch training loss = 0.398832, test loss = 0.402983
  Training set accuracy = 0.889600, Test set accuracy = 0.887400
 epoch 8/30. Took 0.28715 seconds. 
  Full-batch training loss = 0.367666, test loss = 0.376464
  Training set accuracy = 0.896700, Test set accuracy = 0.895200
 epoch 9/30. Took 0.28621 seconds. 
  Full-batch training loss = 0.348248, test loss = 0.358579
  Training set accuracy = 0.901700, Test set accuracy = 0.898000
 epoch 10/30. Took 0.28641 seconds. 
  Full-batch training loss = 0.330768, test loss = 0.342319
  Training set accuracy = 0.906400, Test set accuracy = 0.902300
 epoch 11/30. Took 0.29001 seconds. 
  Full-batch training loss = 0.315915, test loss = 0.329872
  Training set accuracy = 0.908100, Test set accuracy = 0.906600
 epoch 12/30. Took 0.28673 seconds. 
  Full-batch training loss = 0.301575, test loss = 0.317983
  Training set accuracy = 0.912800, Test set accuracy = 0.908300
 epoch 13/30. Took 0.28529 seconds. 
  Full-batch training loss = 0.287595, test loss = 0.307628
  Training set accuracy = 0.917600, Test set accuracy = 0.913700
 epoch 14/30. Took 0.28633 seconds. 
  Full-batch training loss = 0.276270, test loss = 0.299805
  Training set accuracy = 0.919900, Test set accuracy = 0.914100
 epoch 15/30. Took 0.28509 seconds. 
  Full-batch training loss = 0.266011, test loss = 0.291752
  Training set accuracy = 0.923100, Test set accuracy = 0.915500
 epoch 16/30. Took 0.28506 seconds. 
  Full-batch training loss = 0.256035, test loss = 0.283338
  Training set accuracy = 0.926900, Test set accuracy = 0.918000
 epoch 17/30. Took 0.27633 seconds. 
  Full-batch training loss = 0.246799, test loss = 0.276568
  Training set accuracy = 0.929100, Test set accuracy = 0.919300
 epoch 18/30. Took 0.28642 seconds. 
  Full-batch training loss = 0.238535, test loss = 0.268998
  Training set accuracy = 0.931600, Test set accuracy = 0.921400
 epoch 19/30. Took 0.2863 seconds. 
  Full-batch training loss = 0.232359, test loss = 0.263510
  Training set accuracy = 0.932100, Test set accuracy = 0.923200
 epoch 20/30. Took 0.28532 seconds. 
  Full-batch training loss = 0.223654, test loss = 0.257744
  Training set accuracy = 0.934900, Test set accuracy = 0.924200
 epoch 21/30. Took 0.28641 seconds. 
  Full-batch training loss = 0.215069, test loss = 0.251414
  Training set accuracy = 0.939400, Test set accuracy = 0.927100
 epoch 22/30. Took 0.29899 seconds. 
  Full-batch training loss = 0.210725, test loss = 0.248212
  Training set accuracy = 0.938800, Test set accuracy = 0.927500
 epoch 23/30. Took 0.28504 seconds. 
  Full-batch training loss = 0.202479, test loss = 0.240978
  Training set accuracy = 0.942700, Test set accuracy = 0.928900
 epoch 24/30. Took 0.2926 seconds. 
  Full-batch training loss = 0.197305, test loss = 0.239902
  Training set accuracy = 0.944100, Test set accuracy = 0.928000
 epoch 25/30. Took 0.29092 seconds. 
  Full-batch training loss = 0.191697, test loss = 0.235108
  Training set accuracy = 0.945200, Test set accuracy = 0.929500
 epoch 26/30. Took 0.27448 seconds. 
  Full-batch training loss = 0.184411, test loss = 0.229176
  Training set accuracy = 0.946900, Test set accuracy = 0.932000
 epoch 27/30. Took 0.28619 seconds. 
  Full-batch training loss = 0.179614, test loss = 0.226283
  Training set accuracy = 0.947900, Test set accuracy = 0.932600
 epoch 28/30. Took 0.28662 seconds. 
  Full-batch training loss = 0.173704, test loss = 0.221023
  Training set accuracy = 0.949900, Test set accuracy = 0.933000
 epoch 29/30. Took 0.27769 seconds. 
  Full-batch training loss = 0.168650, test loss = 0.218328
  Training set accuracy = 0.950800, Test set accuracy = 0.934400
 epoch 30/30. Took 0.27582 seconds. 
  Full-batch training loss = 0.164915, test loss = 0.218542
  Training set accuracy = 0.951500, Test set accuracy = 0.932600
Elapsed time is 15.850769 seconds.
End Training
-----
Params 10000 0.010 0.30 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.47577 seconds. 
  Full-batch training loss = 1.785627, test loss = 1.780186
  Training set accuracy = 0.658700, Test set accuracy = 0.665000
 epoch 2/30. Took 0.47277 seconds. 
  Full-batch training loss = 0.916408, test loss = 0.901270
  Training set accuracy = 0.808000, Test set accuracy = 0.811100
 epoch 3/30. Took 0.46983 seconds. 
  Full-batch training loss = 0.623216, test loss = 0.606792
  Training set accuracy = 0.838400, Test set accuracy = 0.845000
 epoch 4/30. Took 0.46814 seconds. 
  Full-batch training loss = 0.508629, test loss = 0.494173
  Training set accuracy = 0.863500, Test set accuracy = 0.868400
 epoch 5/30. Took 0.46883 seconds. 
  Full-batch training loss = 0.444101, test loss = 0.430415
  Training set accuracy = 0.878800, Test set accuracy = 0.884200
 epoch 6/30. Took 0.47209 seconds. 
  Full-batch training loss = 0.402520, test loss = 0.393489
  Training set accuracy = 0.889700, Test set accuracy = 0.891800
 epoch 7/30. Took 0.47103 seconds. 
  Full-batch training loss = 0.372312, test loss = 0.367353
  Training set accuracy = 0.896500, Test set accuracy = 0.895800
 epoch 8/30. Took 0.47525 seconds. 
  Full-batch training loss = 0.347700, test loss = 0.344020
  Training set accuracy = 0.905100, Test set accuracy = 0.904100
 epoch 9/30. Took 0.48391 seconds. 
  Full-batch training loss = 0.327740, test loss = 0.328539
  Training set accuracy = 0.906600, Test set accuracy = 0.907400
 epoch 10/30. Took 0.47876 seconds. 
  Full-batch training loss = 0.310926, test loss = 0.316140
  Training set accuracy = 0.912600, Test set accuracy = 0.910200
 epoch 11/30. Took 0.48472 seconds. 
  Full-batch training loss = 0.296685, test loss = 0.304200
  Training set accuracy = 0.916300, Test set accuracy = 0.911600
 epoch 12/30. Took 0.52271 seconds. 
  Full-batch training loss = 0.283986, test loss = 0.294088
  Training set accuracy = 0.919000, Test set accuracy = 0.915000
 epoch 13/30. Took 0.49679 seconds. 
  Full-batch training loss = 0.269268, test loss = 0.283338
  Training set accuracy = 0.925200, Test set accuracy = 0.919900
 epoch 14/30. Took 0.49507 seconds. 
  Full-batch training loss = 0.258432, test loss = 0.275063
  Training set accuracy = 0.926800, Test set accuracy = 0.919500
 epoch 15/30. Took 0.48252 seconds. 
  Full-batch training loss = 0.247682, test loss = 0.265822
  Training set accuracy = 0.931500, Test set accuracy = 0.924500
 epoch 16/30. Took 0.48802 seconds. 
  Full-batch training loss = 0.239014, test loss = 0.260403
  Training set accuracy = 0.933200, Test set accuracy = 0.925000
 epoch 17/30. Took 0.47877 seconds. 
  Full-batch training loss = 0.228577, test loss = 0.253805
  Training set accuracy = 0.935800, Test set accuracy = 0.927500
 epoch 18/30. Took 0.47916 seconds. 
  Full-batch training loss = 0.218467, test loss = 0.244107
  Training set accuracy = 0.940700, Test set accuracy = 0.928900
 epoch 19/30. Took 0.4756 seconds. 
  Full-batch training loss = 0.212162, test loss = 0.240387
  Training set accuracy = 0.941000, Test set accuracy = 0.930300
 epoch 20/30. Took 0.48337 seconds. 
  Full-batch training loss = 0.204777, test loss = 0.235219
  Training set accuracy = 0.944200, Test set accuracy = 0.930600
 epoch 21/30. Took 0.50046 seconds. 
  Full-batch training loss = 0.196726, test loss = 0.230025
  Training set accuracy = 0.946100, Test set accuracy = 0.931500
 epoch 22/30. Took 0.49234 seconds. 
  Full-batch training loss = 0.189981, test loss = 0.224701
  Training set accuracy = 0.949300, Test set accuracy = 0.933100
 epoch 23/30. Took 0.48061 seconds. 
  Full-batch training loss = 0.183465, test loss = 0.219483
  Training set accuracy = 0.950600, Test set accuracy = 0.934500
 epoch 24/30. Took 0.48618 seconds. 
  Full-batch training loss = 0.176841, test loss = 0.215199
  Training set accuracy = 0.952200, Test set accuracy = 0.935900
 epoch 25/30. Took 0.47897 seconds. 
  Full-batch training loss = 0.169794, test loss = 0.210005
  Training set accuracy = 0.955300, Test set accuracy = 0.936200
 epoch 26/30. Took 0.4808 seconds. 
  Full-batch training loss = 0.165343, test loss = 0.207771
  Training set accuracy = 0.954900, Test set accuracy = 0.937600
 epoch 27/30. Took 0.51748 seconds. 
  Full-batch training loss = 0.159315, test loss = 0.203461
  Training set accuracy = 0.957300, Test set accuracy = 0.938900
 epoch 28/30. Took 0.48529 seconds. 
  Full-batch training loss = 0.154764, test loss = 0.200543
  Training set accuracy = 0.958000, Test set accuracy = 0.939900
 epoch 29/30. Took 0.49452 seconds. 
  Full-batch training loss = 0.150302, test loss = 0.198842
  Training set accuracy = 0.960000, Test set accuracy = 0.940000
 epoch 30/30. Took 0.50575 seconds. 
  Full-batch training loss = 0.146083, test loss = 0.195599
  Training set accuracy = 0.961000, Test set accuracy = 0.941500
Elapsed time is 25.205299 seconds.
End Training
-----
Params 10000 0.010 0.30 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.244 seconds. 
  Full-batch training loss = 1.627565, test loss = 1.619522
  Training set accuracy = 0.723700, Test set accuracy = 0.721900
 epoch 2/30. Took 1.2078 seconds. 
  Full-batch training loss = 0.762644, test loss = 0.749302
  Training set accuracy = 0.821500, Test set accuracy = 0.823400
 epoch 3/30. Took 1.2177 seconds. 
  Full-batch training loss = 0.534275, test loss = 0.531309
  Training set accuracy = 0.863600, Test set accuracy = 0.859500
 epoch 4/30. Took 1.1942 seconds. 
  Full-batch training loss = 0.441146, test loss = 0.441602
  Training set accuracy = 0.881900, Test set accuracy = 0.879500
 epoch 5/30. Took 1.2219 seconds. 
  Full-batch training loss = 0.389566, test loss = 0.393378
  Training set accuracy = 0.895500, Test set accuracy = 0.891400
 epoch 6/30. Took 1.2253 seconds. 
  Full-batch training loss = 0.358778, test loss = 0.365711
  Training set accuracy = 0.900200, Test set accuracy = 0.896800
 epoch 7/30. Took 1.2238 seconds. 
  Full-batch training loss = 0.329222, test loss = 0.342370
  Training set accuracy = 0.906300, Test set accuracy = 0.902400
 epoch 8/30. Took 1.2458 seconds. 
  Full-batch training loss = 0.308895, test loss = 0.323926
  Training set accuracy = 0.912200, Test set accuracy = 0.907000
 epoch 9/30. Took 1.2146 seconds. 
  Full-batch training loss = 0.294059, test loss = 0.314119
  Training set accuracy = 0.917100, Test set accuracy = 0.911700
 epoch 10/30. Took 1.2167 seconds. 
  Full-batch training loss = 0.277575, test loss = 0.299845
  Training set accuracy = 0.921100, Test set accuracy = 0.913400
 epoch 11/30. Took 1.2117 seconds. 
  Full-batch training loss = 0.265632, test loss = 0.289464
  Training set accuracy = 0.922000, Test set accuracy = 0.916100
 epoch 12/30. Took 1.3504 seconds. 
  Full-batch training loss = 0.257148, test loss = 0.283124
  Training set accuracy = 0.926000, Test set accuracy = 0.918500
 epoch 13/30. Took 1.2005 seconds. 
  Full-batch training loss = 0.243212, test loss = 0.273680
  Training set accuracy = 0.930500, Test set accuracy = 0.920500
 epoch 14/30. Took 1.2158 seconds. 
  Full-batch training loss = 0.234116, test loss = 0.265299
  Training set accuracy = 0.931500, Test set accuracy = 0.923400
 epoch 15/30. Took 1.2001 seconds. 
  Full-batch training loss = 0.224540, test loss = 0.258762
  Training set accuracy = 0.933300, Test set accuracy = 0.924300
 epoch 16/30. Took 1.2193 seconds. 
  Full-batch training loss = 0.215137, test loss = 0.251575
  Training set accuracy = 0.937800, Test set accuracy = 0.926400
 epoch 17/30. Took 1.2213 seconds. 
  Full-batch training loss = 0.207937, test loss = 0.245118
  Training set accuracy = 0.939800, Test set accuracy = 0.928300
 epoch 18/30. Took 1.2012 seconds. 
  Full-batch training loss = 0.201753, test loss = 0.241016
  Training set accuracy = 0.941300, Test set accuracy = 0.928800
 epoch 19/30. Took 1.1995 seconds. 
  Full-batch training loss = 0.194541, test loss = 0.237081
  Training set accuracy = 0.944600, Test set accuracy = 0.930500
 epoch 20/30. Took 1.2437 seconds. 
  Full-batch training loss = 0.185498, test loss = 0.230272
  Training set accuracy = 0.946000, Test set accuracy = 0.932400
 epoch 21/30. Took 1.2165 seconds. 
  Full-batch training loss = 0.180637, test loss = 0.225610
  Training set accuracy = 0.946100, Test set accuracy = 0.933600
 epoch 22/30. Took 1.2034 seconds. 
  Full-batch training loss = 0.172926, test loss = 0.220800
  Training set accuracy = 0.950200, Test set accuracy = 0.935700
 epoch 23/30. Took 1.2094 seconds. 
  Full-batch training loss = 0.165612, test loss = 0.214243
  Training set accuracy = 0.952000, Test set accuracy = 0.936300
 epoch 24/30. Took 1.2224 seconds. 
  Full-batch training loss = 0.161452, test loss = 0.212769
  Training set accuracy = 0.952400, Test set accuracy = 0.937200
 epoch 25/30. Took 1.2 seconds. 
  Full-batch training loss = 0.155320, test loss = 0.208738
  Training set accuracy = 0.954900, Test set accuracy = 0.937700
 epoch 26/30. Took 1.2312 seconds. 
  Full-batch training loss = 0.149516, test loss = 0.204522
  Training set accuracy = 0.957700, Test set accuracy = 0.938300
 epoch 27/30. Took 1.2057 seconds. 
  Full-batch training loss = 0.144027, test loss = 0.200023
  Training set accuracy = 0.958700, Test set accuracy = 0.940500
 epoch 28/30. Took 1.2038 seconds. 
  Full-batch training loss = 0.138596, test loss = 0.195768
  Training set accuracy = 0.959400, Test set accuracy = 0.941700
 epoch 29/30. Took 1.1994 seconds. 
  Full-batch training loss = 0.133742, test loss = 0.194055
  Training set accuracy = 0.961900, Test set accuracy = 0.941700
 epoch 30/30. Took 1.2011 seconds. 
  Full-batch training loss = 0.129776, test loss = 0.190065
  Training set accuracy = 0.962800, Test set accuracy = 0.944300
Elapsed time is 62.535525 seconds.
End Training
-----
Params 10000 0.010 0.30 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.34696 seconds. 
  Full-batch training loss = 2.219857, test loss = 2.219825
  Training set accuracy = 0.457200, Test set accuracy = 0.460100
 epoch 2/30. Took 0.34772 seconds. 
  Full-batch training loss = 1.877688, test loss = 1.876907
  Training set accuracy = 0.503700, Test set accuracy = 0.496100
 epoch 3/30. Took 0.33985 seconds. 
  Full-batch training loss = 1.244658, test loss = 1.242494
  Training set accuracy = 0.679300, Test set accuracy = 0.678400
 epoch 4/30. Took 0.34696 seconds. 
  Full-batch training loss = 0.836342, test loss = 0.831778
  Training set accuracy = 0.782400, Test set accuracy = 0.780800
 epoch 5/30. Took 0.3145 seconds. 
  Full-batch training loss = 0.645440, test loss = 0.640421
  Training set accuracy = 0.824400, Test set accuracy = 0.822900
 epoch 6/30. Took 0.33837 seconds. 
  Full-batch training loss = 0.542891, test loss = 0.537797
  Training set accuracy = 0.850100, Test set accuracy = 0.848600
 epoch 7/30. Took 0.32664 seconds. 
  Full-batch training loss = 0.476380, test loss = 0.472965
  Training set accuracy = 0.867500, Test set accuracy = 0.864900
 epoch 8/30. Took 0.31552 seconds. 
  Full-batch training loss = 0.425675, test loss = 0.424236
  Training set accuracy = 0.881800, Test set accuracy = 0.879800
 epoch 9/30. Took 0.34719 seconds. 
  Full-batch training loss = 0.391588, test loss = 0.392561
  Training set accuracy = 0.890300, Test set accuracy = 0.889800
 epoch 10/30. Took 0.32875 seconds. 
  Full-batch training loss = 0.363595, test loss = 0.367044
  Training set accuracy = 0.897100, Test set accuracy = 0.895400
 epoch 11/30. Took 0.32796 seconds. 
  Full-batch training loss = 0.337131, test loss = 0.342887
  Training set accuracy = 0.902800, Test set accuracy = 0.900700
 epoch 12/30. Took 0.33846 seconds. 
  Full-batch training loss = 0.318370, test loss = 0.326710
  Training set accuracy = 0.908100, Test set accuracy = 0.905400
 epoch 13/30. Took 0.33853 seconds. 
  Full-batch training loss = 0.302895, test loss = 0.316706
  Training set accuracy = 0.911700, Test set accuracy = 0.905900
 epoch 14/30. Took 0.3289 seconds. 
  Full-batch training loss = 0.286937, test loss = 0.302168
  Training set accuracy = 0.915700, Test set accuracy = 0.912200
 epoch 15/30. Took 0.33747 seconds. 
  Full-batch training loss = 0.272329, test loss = 0.289499
  Training set accuracy = 0.922700, Test set accuracy = 0.916500
 epoch 16/30. Took 0.33833 seconds. 
  Full-batch training loss = 0.256397, test loss = 0.278465
  Training set accuracy = 0.925300, Test set accuracy = 0.917500
 epoch 17/30. Took 0.32939 seconds. 
  Full-batch training loss = 0.244810, test loss = 0.270794
  Training set accuracy = 0.929100, Test set accuracy = 0.919700
 epoch 18/30. Took 0.33861 seconds. 
  Full-batch training loss = 0.234476, test loss = 0.262853
  Training set accuracy = 0.931900, Test set accuracy = 0.922700
 epoch 19/30. Took 0.32756 seconds. 
  Full-batch training loss = 0.225337, test loss = 0.257286
  Training set accuracy = 0.935200, Test set accuracy = 0.924200
 epoch 20/30. Took 0.33819 seconds. 
  Full-batch training loss = 0.214781, test loss = 0.248715
  Training set accuracy = 0.937900, Test set accuracy = 0.924800
 epoch 21/30. Took 0.33157 seconds. 
  Full-batch training loss = 0.203897, test loss = 0.241439
  Training set accuracy = 0.940900, Test set accuracy = 0.926700
 epoch 22/30. Took 0.34342 seconds. 
  Full-batch training loss = 0.197675, test loss = 0.240531
  Training set accuracy = 0.942600, Test set accuracy = 0.926900
 epoch 23/30. Took 0.32277 seconds. 
  Full-batch training loss = 0.189432, test loss = 0.230659
  Training set accuracy = 0.946900, Test set accuracy = 0.930300
 epoch 24/30. Took 0.33189 seconds. 
  Full-batch training loss = 0.179760, test loss = 0.226703
  Training set accuracy = 0.948700, Test set accuracy = 0.930900
 epoch 25/30. Took 0.33912 seconds. 
  Full-batch training loss = 0.171806, test loss = 0.221279
  Training set accuracy = 0.951200, Test set accuracy = 0.932800
 epoch 26/30. Took 0.33988 seconds. 
  Full-batch training loss = 0.169501, test loss = 0.222995
  Training set accuracy = 0.952200, Test set accuracy = 0.931800
 epoch 27/30. Took 0.33837 seconds. 
  Full-batch training loss = 0.158022, test loss = 0.213538
  Training set accuracy = 0.954900, Test set accuracy = 0.934900
 epoch 28/30. Took 0.33111 seconds. 
  Full-batch training loss = 0.152848, test loss = 0.209185
  Training set accuracy = 0.956500, Test set accuracy = 0.935900
 epoch 29/30. Took 0.33952 seconds. 
  Full-batch training loss = 0.145780, test loss = 0.204880
  Training set accuracy = 0.957800, Test set accuracy = 0.938200
 epoch 30/30. Took 0.33443 seconds. 
  Full-batch training loss = 0.141059, test loss = 0.200824
  Training set accuracy = 0.960200, Test set accuracy = 0.939200
Elapsed time is 18.214166 seconds.
End Training
-----
Params 10000 0.010 0.30 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.57251 seconds. 
  Full-batch training loss = 2.193700, test loss = 2.192067
  Training set accuracy = 0.416700, Test set accuracy = 0.409800
 epoch 2/30. Took 0.5743 seconds. 
  Full-batch training loss = 1.754746, test loss = 1.743895
  Training set accuracy = 0.605000, Test set accuracy = 0.618700
 epoch 3/30. Took 0.64526 seconds. 
  Full-batch training loss = 0.964185, test loss = 0.945466
  Training set accuracy = 0.757200, Test set accuracy = 0.758600
 epoch 4/30. Took 0.58215 seconds. 
  Full-batch training loss = 0.675698, test loss = 0.666604
  Training set accuracy = 0.815000, Test set accuracy = 0.819400
 epoch 5/30. Took 0.5543 seconds. 
  Full-batch training loss = 0.552315, test loss = 0.548122
  Training set accuracy = 0.837000, Test set accuracy = 0.836800
 epoch 6/30. Took 0.57073 seconds. 
  Full-batch training loss = 0.463996, test loss = 0.465380
  Training set accuracy = 0.869000, Test set accuracy = 0.867800
 epoch 7/30. Took 0.58553 seconds. 
  Full-batch training loss = 0.407563, test loss = 0.413136
  Training set accuracy = 0.884600, Test set accuracy = 0.882800
 epoch 8/30. Took 0.57257 seconds. 
  Full-batch training loss = 0.370333, test loss = 0.380261
  Training set accuracy = 0.896000, Test set accuracy = 0.893500
 epoch 9/30. Took 0.59189 seconds. 
  Full-batch training loss = 0.347032, test loss = 0.359802
  Training set accuracy = 0.901000, Test set accuracy = 0.895400
 epoch 10/30. Took 0.58591 seconds. 
  Full-batch training loss = 0.317424, test loss = 0.333632
  Training set accuracy = 0.907900, Test set accuracy = 0.903200
 epoch 11/30. Took 0.57705 seconds. 
  Full-batch training loss = 0.301192, test loss = 0.320757
  Training set accuracy = 0.910100, Test set accuracy = 0.905500
 epoch 12/30. Took 0.59426 seconds. 
  Full-batch training loss = 0.280562, test loss = 0.300844
  Training set accuracy = 0.918400, Test set accuracy = 0.912100
 epoch 13/30. Took 0.60274 seconds. 
  Full-batch training loss = 0.271628, test loss = 0.295054
  Training set accuracy = 0.918700, Test set accuracy = 0.912900
 epoch 14/30. Took 0.58345 seconds. 
  Full-batch training loss = 0.251707, test loss = 0.281524
  Training set accuracy = 0.924700, Test set accuracy = 0.917900
 epoch 15/30. Took 0.56415 seconds. 
  Full-batch training loss = 0.238501, test loss = 0.269882
  Training set accuracy = 0.929800, Test set accuracy = 0.920300
 epoch 16/30. Took 0.57881 seconds. 
  Full-batch training loss = 0.229102, test loss = 0.263495
  Training set accuracy = 0.931500, Test set accuracy = 0.922300
 epoch 17/30. Took 0.55988 seconds. 
  Full-batch training loss = 0.213492, test loss = 0.249533
  Training set accuracy = 0.936600, Test set accuracy = 0.926200
 epoch 18/30. Took 0.5676 seconds. 
  Full-batch training loss = 0.205834, test loss = 0.242518
  Training set accuracy = 0.938800, Test set accuracy = 0.926100
 epoch 19/30. Took 0.58271 seconds. 
  Full-batch training loss = 0.197591, test loss = 0.240234
  Training set accuracy = 0.939800, Test set accuracy = 0.927600
 epoch 20/30. Took 0.57829 seconds. 
  Full-batch training loss = 0.184334, test loss = 0.229357
  Training set accuracy = 0.945200, Test set accuracy = 0.930900
 epoch 21/30. Took 0.57978 seconds. 
  Full-batch training loss = 0.177713, test loss = 0.222772
  Training set accuracy = 0.947700, Test set accuracy = 0.932700
 epoch 22/30. Took 0.60491 seconds. 
  Full-batch training loss = 0.169769, test loss = 0.218928
  Training set accuracy = 0.948800, Test set accuracy = 0.933200
 epoch 23/30. Took 0.57495 seconds. 
  Full-batch training loss = 0.160620, test loss = 0.214326
  Training set accuracy = 0.952400, Test set accuracy = 0.935400
 epoch 24/30. Took 0.5689 seconds. 
  Full-batch training loss = 0.155010, test loss = 0.211181
  Training set accuracy = 0.954800, Test set accuracy = 0.936400
 epoch 25/30. Took 0.57873 seconds. 
  Full-batch training loss = 0.146871, test loss = 0.205870
  Training set accuracy = 0.956900, Test set accuracy = 0.938000
 epoch 26/30. Took 0.5761 seconds. 
  Full-batch training loss = 0.143468, test loss = 0.203628
  Training set accuracy = 0.958300, Test set accuracy = 0.938300
 epoch 27/30. Took 0.58288 seconds. 
  Full-batch training loss = 0.136917, test loss = 0.199752
  Training set accuracy = 0.959400, Test set accuracy = 0.940400
 epoch 28/30. Took 0.58313 seconds. 
  Full-batch training loss = 0.128995, test loss = 0.191739
  Training set accuracy = 0.961900, Test set accuracy = 0.943200
 epoch 29/30. Took 0.58141 seconds. 
  Full-batch training loss = 0.125058, test loss = 0.188990
  Training set accuracy = 0.963300, Test set accuracy = 0.943900
 epoch 30/30. Took 0.58232 seconds. 
  Full-batch training loss = 0.118923, test loss = 0.185795
  Training set accuracy = 0.966400, Test set accuracy = 0.944300
Elapsed time is 30.708966 seconds.
End Training
-----
Params 10000 0.010 0.30 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.7535 seconds. 
  Full-batch training loss = 2.139790, test loss = 2.139090
  Training set accuracy = 0.600200, Test set accuracy = 0.599100
 epoch 2/30. Took 1.6646 seconds. 
  Full-batch training loss = 1.373248, test loss = 1.364553
  Training set accuracy = 0.716400, Test set accuracy = 0.719300
 epoch 3/30. Took 1.6959 seconds. 
  Full-batch training loss = 0.721269, test loss = 0.715963
  Training set accuracy = 0.820000, Test set accuracy = 0.822000
 epoch 4/30. Took 1.7901 seconds. 
  Full-batch training loss = 0.534471, test loss = 0.534416
  Training set accuracy = 0.847400, Test set accuracy = 0.851000
 epoch 5/30. Took 1.6768 seconds. 
  Full-batch training loss = 0.443693, test loss = 0.444763
  Training set accuracy = 0.874900, Test set accuracy = 0.873800
 epoch 6/30. Took 1.746 seconds. 
  Full-batch training loss = 0.390858, test loss = 0.399150
  Training set accuracy = 0.888000, Test set accuracy = 0.886000
 epoch 7/30. Took 1.6693 seconds. 
  Full-batch training loss = 0.350619, test loss = 0.362665
  Training set accuracy = 0.898600, Test set accuracy = 0.895700
 epoch 8/30. Took 1.824 seconds. 
  Full-batch training loss = 0.327990, test loss = 0.338932
  Training set accuracy = 0.902800, Test set accuracy = 0.901000
 epoch 9/30. Took 1.6966 seconds. 
  Full-batch training loss = 0.302196, test loss = 0.319115
  Training set accuracy = 0.911200, Test set accuracy = 0.906900
 epoch 10/30. Took 1.7721 seconds. 
  Full-batch training loss = 0.286506, test loss = 0.307203
  Training set accuracy = 0.915800, Test set accuracy = 0.911200
 epoch 11/30. Took 1.661 seconds. 
  Full-batch training loss = 0.267894, test loss = 0.291283
  Training set accuracy = 0.919800, Test set accuracy = 0.916400
 epoch 12/30. Took 1.7595 seconds. 
  Full-batch training loss = 0.252082, test loss = 0.278615
  Training set accuracy = 0.924300, Test set accuracy = 0.920900
 epoch 13/30. Took 1.6898 seconds. 
  Full-batch training loss = 0.240605, test loss = 0.272015
  Training set accuracy = 0.927700, Test set accuracy = 0.922200
 epoch 14/30. Took 1.6882 seconds. 
  Full-batch training loss = 0.226387, test loss = 0.263116
  Training set accuracy = 0.932100, Test set accuracy = 0.925600
 epoch 15/30. Took 1.6569 seconds. 
  Full-batch training loss = 0.214188, test loss = 0.252187
  Training set accuracy = 0.936300, Test set accuracy = 0.929000
 epoch 16/30. Took 1.6702 seconds. 
  Full-batch training loss = 0.204880, test loss = 0.245705
  Training set accuracy = 0.936700, Test set accuracy = 0.928100
 epoch 17/30. Took 1.6623 seconds. 
  Full-batch training loss = 0.195042, test loss = 0.235002
  Training set accuracy = 0.939700, Test set accuracy = 0.931000
 epoch 18/30. Took 1.6505 seconds. 
  Full-batch training loss = 0.183568, test loss = 0.229801
  Training set accuracy = 0.943400, Test set accuracy = 0.932600
 epoch 19/30. Took 1.7189 seconds. 
  Full-batch training loss = 0.174591, test loss = 0.223663
  Training set accuracy = 0.947400, Test set accuracy = 0.934800
 epoch 20/30. Took 1.6656 seconds. 
  Full-batch training loss = 0.163823, test loss = 0.213883
  Training set accuracy = 0.949500, Test set accuracy = 0.937800
 epoch 21/30. Took 1.6755 seconds. 
  Full-batch training loss = 0.155464, test loss = 0.208318
  Training set accuracy = 0.951700, Test set accuracy = 0.937400
 epoch 22/30. Took 1.6698 seconds. 
  Full-batch training loss = 0.147668, test loss = 0.201821
  Training set accuracy = 0.955300, Test set accuracy = 0.939600
 epoch 23/30. Took 1.6711 seconds. 
  Full-batch training loss = 0.141365, test loss = 0.201305
  Training set accuracy = 0.956500, Test set accuracy = 0.940200
 epoch 24/30. Took 1.6762 seconds. 
  Full-batch training loss = 0.134262, test loss = 0.198629
  Training set accuracy = 0.958600, Test set accuracy = 0.938400
 epoch 25/30. Took 1.6816 seconds. 
  Full-batch training loss = 0.125038, test loss = 0.187758
  Training set accuracy = 0.963000, Test set accuracy = 0.944700
 epoch 26/30. Took 1.687 seconds. 
  Full-batch training loss = 0.119897, test loss = 0.187189
  Training set accuracy = 0.962500, Test set accuracy = 0.944300
 epoch 27/30. Took 1.663 seconds. 
  Full-batch training loss = 0.114188, test loss = 0.181803
  Training set accuracy = 0.966200, Test set accuracy = 0.945300
 epoch 28/30. Took 1.6614 seconds. 
  Full-batch training loss = 0.109520, test loss = 0.179260
  Training set accuracy = 0.966100, Test set accuracy = 0.947000
 epoch 29/30. Took 1.7011 seconds. 
  Full-batch training loss = 0.104739, test loss = 0.177023
  Training set accuracy = 0.970500, Test set accuracy = 0.948300
 epoch 30/30. Took 1.6691 seconds. 
  Full-batch training loss = 0.097679, test loss = 0.172300
  Training set accuracy = 0.973100, Test set accuracy = 0.948800
Elapsed time is 86.601730 seconds.
End Training
-----
Params 10000 0.010 0.40 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.22742 seconds. 
  Full-batch training loss = 1.429090, test loss = 1.419440
  Training set accuracy = 0.742500, Test set accuracy = 0.744500
 epoch 2/30. Took 0.23876 seconds. 
  Full-batch training loss = 0.852564, test loss = 0.842352
  Training set accuracy = 0.819800, Test set accuracy = 0.826100
 epoch 3/30. Took 0.23137 seconds. 
  Full-batch training loss = 0.642023, test loss = 0.633976
  Training set accuracy = 0.854800, Test set accuracy = 0.857300
 epoch 4/30. Took 0.22971 seconds. 
  Full-batch training loss = 0.539874, test loss = 0.533949
  Training set accuracy = 0.875800, Test set accuracy = 0.878400
 epoch 5/30. Took 0.22967 seconds. 
  Full-batch training loss = 0.480881, test loss = 0.476095
  Training set accuracy = 0.881200, Test set accuracy = 0.883900
 epoch 6/30. Took 0.23039 seconds. 
  Full-batch training loss = 0.439828, test loss = 0.437373
  Training set accuracy = 0.890500, Test set accuracy = 0.890600
 epoch 7/30. Took 0.22766 seconds. 
  Full-batch training loss = 0.410815, test loss = 0.411063
  Training set accuracy = 0.895600, Test set accuracy = 0.894600
 epoch 8/30. Took 0.23007 seconds. 
  Full-batch training loss = 0.388792, test loss = 0.390928
  Training set accuracy = 0.898900, Test set accuracy = 0.897700
 epoch 9/30. Took 0.22951 seconds. 
  Full-batch training loss = 0.370951, test loss = 0.373968
  Training set accuracy = 0.902000, Test set accuracy = 0.900300
 epoch 10/30. Took 0.23013 seconds. 
  Full-batch training loss = 0.356233, test loss = 0.361058
  Training set accuracy = 0.905400, Test set accuracy = 0.902400
 epoch 11/30. Took 0.22925 seconds. 
  Full-batch training loss = 0.341984, test loss = 0.348349
  Training set accuracy = 0.907400, Test set accuracy = 0.906000
 epoch 12/30. Took 0.22927 seconds. 
  Full-batch training loss = 0.330772, test loss = 0.339850
  Training set accuracy = 0.910300, Test set accuracy = 0.907100
 epoch 13/30. Took 0.23115 seconds. 
  Full-batch training loss = 0.322697, test loss = 0.332392
  Training set accuracy = 0.911300, Test set accuracy = 0.909300
 epoch 14/30. Took 0.23484 seconds. 
  Full-batch training loss = 0.311758, test loss = 0.322890
  Training set accuracy = 0.915400, Test set accuracy = 0.910000
 epoch 15/30. Took 0.22918 seconds. 
  Full-batch training loss = 0.303372, test loss = 0.315609
  Training set accuracy = 0.917800, Test set accuracy = 0.911600
 epoch 16/30. Took 0.22896 seconds. 
  Full-batch training loss = 0.295195, test loss = 0.308879
  Training set accuracy = 0.921000, Test set accuracy = 0.914000
 epoch 17/30. Took 0.23088 seconds. 
  Full-batch training loss = 0.289039, test loss = 0.303787
  Training set accuracy = 0.921400, Test set accuracy = 0.915600
 epoch 18/30. Took 0.24506 seconds. 
  Full-batch training loss = 0.281977, test loss = 0.297814
  Training set accuracy = 0.924200, Test set accuracy = 0.915100
 epoch 19/30. Took 0.22893 seconds. 
  Full-batch training loss = 0.275510, test loss = 0.292561
  Training set accuracy = 0.925100, Test set accuracy = 0.916600
 epoch 20/30. Took 0.23016 seconds. 
  Full-batch training loss = 0.268923, test loss = 0.287873
  Training set accuracy = 0.927100, Test set accuracy = 0.918100
 epoch 21/30. Took 0.2302 seconds. 
  Full-batch training loss = 0.262707, test loss = 0.283009
  Training set accuracy = 0.928800, Test set accuracy = 0.920800
 epoch 22/30. Took 0.23078 seconds. 
  Full-batch training loss = 0.259116, test loss = 0.279857
  Training set accuracy = 0.928800, Test set accuracy = 0.920600
 epoch 23/30. Took 0.23043 seconds. 
  Full-batch training loss = 0.252616, test loss = 0.274392
  Training set accuracy = 0.930900, Test set accuracy = 0.922100
 epoch 24/30. Took 0.22954 seconds. 
  Full-batch training loss = 0.248573, test loss = 0.270941
  Training set accuracy = 0.933400, Test set accuracy = 0.923600
 epoch 25/30. Took 0.22951 seconds. 
  Full-batch training loss = 0.242777, test loss = 0.267517
  Training set accuracy = 0.934200, Test set accuracy = 0.923700
 epoch 26/30. Took 0.23087 seconds. 
  Full-batch training loss = 0.237673, test loss = 0.262765
  Training set accuracy = 0.936200, Test set accuracy = 0.925000
 epoch 27/30. Took 0.22794 seconds. 
  Full-batch training loss = 0.233867, test loss = 0.259366
  Training set accuracy = 0.936200, Test set accuracy = 0.926200
 epoch 28/30. Took 0.22987 seconds. 
  Full-batch training loss = 0.229179, test loss = 0.255903
  Training set accuracy = 0.936900, Test set accuracy = 0.926900
 epoch 29/30. Took 0.22984 seconds. 
  Full-batch training loss = 0.225450, test loss = 0.253165
  Training set accuracy = 0.938100, Test set accuracy = 0.927000
 epoch 30/30. Took 0.22988 seconds. 
  Full-batch training loss = 0.221471, test loss = 0.250221
  Training set accuracy = 0.940100, Test set accuracy = 0.929300
Elapsed time is 13.266494 seconds.
End Training
-----
Params 10000 0.010 0.40 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35444 seconds. 
  Full-batch training loss = 1.372185, test loss = 1.360534
  Training set accuracy = 0.743600, Test set accuracy = 0.748800
 epoch 2/30. Took 0.35068 seconds. 
  Full-batch training loss = 0.801276, test loss = 0.787630
  Training set accuracy = 0.832900, Test set accuracy = 0.835800
 epoch 3/30. Took 0.37581 seconds. 
  Full-batch training loss = 0.606538, test loss = 0.597558
  Training set accuracy = 0.858000, Test set accuracy = 0.857800
 epoch 4/30. Took 0.36199 seconds. 
  Full-batch training loss = 0.511412, test loss = 0.504644
  Training set accuracy = 0.876500, Test set accuracy = 0.877200
 epoch 5/30. Took 0.34937 seconds. 
  Full-batch training loss = 0.457894, test loss = 0.454456
  Training set accuracy = 0.883500, Test set accuracy = 0.885100
 epoch 6/30. Took 0.34836 seconds. 
  Full-batch training loss = 0.419889, test loss = 0.419249
  Training set accuracy = 0.891800, Test set accuracy = 0.892800
 epoch 7/30. Took 0.34974 seconds. 
  Full-batch training loss = 0.394151, test loss = 0.396502
  Training set accuracy = 0.897100, Test set accuracy = 0.894500
 epoch 8/30. Took 0.34967 seconds. 
  Full-batch training loss = 0.371463, test loss = 0.375369
  Training set accuracy = 0.901600, Test set accuracy = 0.898000
 epoch 9/30. Took 0.34885 seconds. 
  Full-batch training loss = 0.354057, test loss = 0.361871
  Training set accuracy = 0.905700, Test set accuracy = 0.901000
 epoch 10/30. Took 0.35094 seconds. 
  Full-batch training loss = 0.340143, test loss = 0.350164
  Training set accuracy = 0.909100, Test set accuracy = 0.903100
 epoch 11/30. Took 0.35038 seconds. 
  Full-batch training loss = 0.327020, test loss = 0.339549
  Training set accuracy = 0.912400, Test set accuracy = 0.905300
 epoch 12/30. Took 0.371 seconds. 
  Full-batch training loss = 0.315823, test loss = 0.329048
  Training set accuracy = 0.914300, Test set accuracy = 0.908800
 epoch 13/30. Took 0.34955 seconds. 
  Full-batch training loss = 0.305492, test loss = 0.320203
  Training set accuracy = 0.916100, Test set accuracy = 0.911200
 epoch 14/30. Took 0.35079 seconds. 
  Full-batch training loss = 0.295916, test loss = 0.312505
  Training set accuracy = 0.919600, Test set accuracy = 0.912700
 epoch 15/30. Took 0.3491 seconds. 
  Full-batch training loss = 0.288528, test loss = 0.308382
  Training set accuracy = 0.920200, Test set accuracy = 0.914200
 epoch 16/30. Took 0.35103 seconds. 
  Full-batch training loss = 0.281126, test loss = 0.300657
  Training set accuracy = 0.920900, Test set accuracy = 0.915100
 epoch 17/30. Took 0.34831 seconds. 
  Full-batch training loss = 0.273981, test loss = 0.295973
  Training set accuracy = 0.924500, Test set accuracy = 0.915200
 epoch 18/30. Took 0.35156 seconds. 
  Full-batch training loss = 0.266901, test loss = 0.290422
  Training set accuracy = 0.925500, Test set accuracy = 0.916400
 epoch 19/30. Took 0.34747 seconds. 
  Full-batch training loss = 0.262798, test loss = 0.286414
  Training set accuracy = 0.925500, Test set accuracy = 0.919300
 epoch 20/30. Took 0.35163 seconds. 
  Full-batch training loss = 0.255077, test loss = 0.280255
  Training set accuracy = 0.929300, Test set accuracy = 0.920900
 epoch 21/30. Took 0.3481 seconds. 
  Full-batch training loss = 0.249769, test loss = 0.276012
  Training set accuracy = 0.929000, Test set accuracy = 0.920900
 epoch 22/30. Took 0.3506 seconds. 
  Full-batch training loss = 0.245020, test loss = 0.274318
  Training set accuracy = 0.931500, Test set accuracy = 0.921000
 epoch 23/30. Took 0.35116 seconds. 
  Full-batch training loss = 0.238737, test loss = 0.268415
  Training set accuracy = 0.934000, Test set accuracy = 0.923200
 epoch 24/30. Took 0.38227 seconds. 
  Full-batch training loss = 0.234457, test loss = 0.266138
  Training set accuracy = 0.934600, Test set accuracy = 0.923800
 epoch 25/30. Took 0.3471 seconds. 
  Full-batch training loss = 0.229022, test loss = 0.261299
  Training set accuracy = 0.936900, Test set accuracy = 0.924800
 epoch 26/30. Took 0.35977 seconds. 
  Full-batch training loss = 0.224107, test loss = 0.258247
  Training set accuracy = 0.937000, Test set accuracy = 0.925800
 epoch 27/30. Took 0.34546 seconds. 
  Full-batch training loss = 0.219931, test loss = 0.254741
  Training set accuracy = 0.939500, Test set accuracy = 0.927300
 epoch 28/30. Took 0.35187 seconds. 
  Full-batch training loss = 0.214934, test loss = 0.250847
  Training set accuracy = 0.940600, Test set accuracy = 0.928600
 epoch 29/30. Took 0.34873 seconds. 
  Full-batch training loss = 0.211824, test loss = 0.248604
  Training set accuracy = 0.940600, Test set accuracy = 0.929000
 epoch 30/30. Took 0.34897 seconds. 
  Full-batch training loss = 0.206976, test loss = 0.245204
  Training set accuracy = 0.943700, Test set accuracy = 0.930700
Elapsed time is 19.248744 seconds.
End Training
-----
Params 10000 0.010 0.40 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.77911 seconds. 
  Full-batch training loss = 1.192218, test loss = 1.176075
  Training set accuracy = 0.790600, Test set accuracy = 0.799400
 epoch 2/30. Took 0.74276 seconds. 
  Full-batch training loss = 0.712463, test loss = 0.695595
  Training set accuracy = 0.843100, Test set accuracy = 0.850600
 epoch 3/30. Took 0.73183 seconds. 
  Full-batch training loss = 0.557844, test loss = 0.544929
  Training set accuracy = 0.867300, Test set accuracy = 0.868400
 epoch 4/30. Took 0.72949 seconds. 
  Full-batch training loss = 0.480489, test loss = 0.468793
  Training set accuracy = 0.879100, Test set accuracy = 0.880700
 epoch 5/30. Took 0.73145 seconds. 
  Full-batch training loss = 0.438902, test loss = 0.431485
  Training set accuracy = 0.881900, Test set accuracy = 0.890100
 epoch 6/30. Took 0.72899 seconds. 
  Full-batch training loss = 0.402382, test loss = 0.397217
  Training set accuracy = 0.893000, Test set accuracy = 0.894100
 epoch 7/30. Took 0.73695 seconds. 
  Full-batch training loss = 0.378110, test loss = 0.375221
  Training set accuracy = 0.899200, Test set accuracy = 0.897400
 epoch 8/30. Took 0.73281 seconds. 
  Full-batch training loss = 0.358628, test loss = 0.358084
  Training set accuracy = 0.901900, Test set accuracy = 0.901500
 epoch 9/30. Took 0.74877 seconds. 
  Full-batch training loss = 0.344394, test loss = 0.346114
  Training set accuracy = 0.904300, Test set accuracy = 0.905000
 epoch 10/30. Took 0.75457 seconds. 
  Full-batch training loss = 0.330813, test loss = 0.335364
  Training set accuracy = 0.908600, Test set accuracy = 0.908100
 epoch 11/30. Took 0.74001 seconds. 
  Full-batch training loss = 0.318673, test loss = 0.325588
  Training set accuracy = 0.911000, Test set accuracy = 0.910000
 epoch 12/30. Took 0.74073 seconds. 
  Full-batch training loss = 0.309363, test loss = 0.318012
  Training set accuracy = 0.912000, Test set accuracy = 0.912700
 epoch 13/30. Took 0.76985 seconds. 
  Full-batch training loss = 0.299565, test loss = 0.310342
  Training set accuracy = 0.914800, Test set accuracy = 0.913800
 epoch 14/30. Took 0.7285 seconds. 
  Full-batch training loss = 0.289988, test loss = 0.303297
  Training set accuracy = 0.916400, Test set accuracy = 0.914400
 epoch 15/30. Took 0.75369 seconds. 
  Full-batch training loss = 0.282162, test loss = 0.296754
  Training set accuracy = 0.919200, Test set accuracy = 0.916400
 epoch 16/30. Took 0.73272 seconds. 
  Full-batch training loss = 0.274413, test loss = 0.292222
  Training set accuracy = 0.921800, Test set accuracy = 0.917800
 epoch 17/30. Took 0.73808 seconds. 
  Full-batch training loss = 0.267269, test loss = 0.285583
  Training set accuracy = 0.924200, Test set accuracy = 0.919500
 epoch 18/30. Took 0.73753 seconds. 
  Full-batch training loss = 0.260831, test loss = 0.280233
  Training set accuracy = 0.927000, Test set accuracy = 0.921600
 epoch 19/30. Took 0.75482 seconds. 
  Full-batch training loss = 0.255750, test loss = 0.278189
  Training set accuracy = 0.928800, Test set accuracy = 0.922200
 epoch 20/30. Took 0.73127 seconds. 
  Full-batch training loss = 0.248407, test loss = 0.272467
  Training set accuracy = 0.930000, Test set accuracy = 0.923200
 epoch 21/30. Took 0.73158 seconds. 
  Full-batch training loss = 0.242664, test loss = 0.268149
  Training set accuracy = 0.932000, Test set accuracy = 0.924200
 epoch 22/30. Took 0.79026 seconds. 
  Full-batch training loss = 0.237087, test loss = 0.263305
  Training set accuracy = 0.933900, Test set accuracy = 0.926000
 epoch 23/30. Took 0.74152 seconds. 
  Full-batch training loss = 0.232764, test loss = 0.261246
  Training set accuracy = 0.934600, Test set accuracy = 0.925200
 epoch 24/30. Took 0.74494 seconds. 
  Full-batch training loss = 0.226738, test loss = 0.255789
  Training set accuracy = 0.935800, Test set accuracy = 0.928000
 epoch 25/30. Took 0.73262 seconds. 
  Full-batch training loss = 0.222530, test loss = 0.253390
  Training set accuracy = 0.937400, Test set accuracy = 0.927900
 epoch 26/30. Took 0.73723 seconds. 
  Full-batch training loss = 0.217032, test loss = 0.249837
  Training set accuracy = 0.938600, Test set accuracy = 0.928600
 epoch 27/30. Took 0.73679 seconds. 
  Full-batch training loss = 0.212537, test loss = 0.246089
  Training set accuracy = 0.939900, Test set accuracy = 0.929700
 epoch 28/30. Took 0.72935 seconds. 
  Full-batch training loss = 0.208060, test loss = 0.242887
  Training set accuracy = 0.941400, Test set accuracy = 0.931300
 epoch 29/30. Took 0.73644 seconds. 
  Full-batch training loss = 0.203941, test loss = 0.240430
  Training set accuracy = 0.942700, Test set accuracy = 0.931400
 epoch 30/30. Took 0.73713 seconds. 
  Full-batch training loss = 0.200453, test loss = 0.237272
  Training set accuracy = 0.944200, Test set accuracy = 0.932600
Elapsed time is 38.615236 seconds.
End Training
-----
Params 10000 0.010 0.40 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27626 seconds. 
  Full-batch training loss = 2.109904, test loss = 2.110695
  Training set accuracy = 0.374300, Test set accuracy = 0.369500
 epoch 2/30. Took 0.28348 seconds. 
  Full-batch training loss = 1.640531, test loss = 1.638252
  Training set accuracy = 0.689500, Test set accuracy = 0.687300
 epoch 3/30. Took 0.28196 seconds. 
  Full-batch training loss = 1.084946, test loss = 1.079827
  Training set accuracy = 0.772600, Test set accuracy = 0.775800
 epoch 4/30. Took 0.28566 seconds. 
  Full-batch training loss = 0.800278, test loss = 0.797674
  Training set accuracy = 0.814100, Test set accuracy = 0.811300
 epoch 5/30. Took 0.28433 seconds. 
  Full-batch training loss = 0.648352, test loss = 0.648442
  Training set accuracy = 0.837300, Test set accuracy = 0.831100
 epoch 6/30. Took 0.28471 seconds. 
  Full-batch training loss = 0.569179, test loss = 0.569971
  Training set accuracy = 0.848900, Test set accuracy = 0.847700
 epoch 7/30. Took 0.2847 seconds. 
  Full-batch training loss = 0.515394, test loss = 0.518849
  Training set accuracy = 0.860400, Test set accuracy = 0.856700
 epoch 8/30. Took 0.28603 seconds. 
  Full-batch training loss = 0.470031, test loss = 0.472230
  Training set accuracy = 0.870900, Test set accuracy = 0.871600
 epoch 9/30. Took 0.28538 seconds. 
  Full-batch training loss = 0.443247, test loss = 0.450209
  Training set accuracy = 0.877500, Test set accuracy = 0.876000
 epoch 10/30. Took 0.28537 seconds. 
  Full-batch training loss = 0.413680, test loss = 0.420552
  Training set accuracy = 0.885100, Test set accuracy = 0.884200
 epoch 11/30. Took 0.2851 seconds. 
  Full-batch training loss = 0.392635, test loss = 0.402263
  Training set accuracy = 0.889400, Test set accuracy = 0.888300
 epoch 12/30. Took 0.28516 seconds. 
  Full-batch training loss = 0.368296, test loss = 0.378828
  Training set accuracy = 0.896300, Test set accuracy = 0.893400
 epoch 13/30. Took 0.28735 seconds. 
  Full-batch training loss = 0.352041, test loss = 0.361826
  Training set accuracy = 0.901900, Test set accuracy = 0.899900
 epoch 14/30. Took 0.28408 seconds. 
  Full-batch training loss = 0.338329, test loss = 0.352398
  Training set accuracy = 0.903300, Test set accuracy = 0.901100
 epoch 15/30. Took 0.2864 seconds. 
  Full-batch training loss = 0.322687, test loss = 0.339146
  Training set accuracy = 0.907300, Test set accuracy = 0.904700
 epoch 16/30. Took 0.29261 seconds. 
  Full-batch training loss = 0.311443, test loss = 0.327843
  Training set accuracy = 0.911300, Test set accuracy = 0.908800
 epoch 17/30. Took 0.28341 seconds. 
  Full-batch training loss = 0.304139, test loss = 0.321719
  Training set accuracy = 0.910600, Test set accuracy = 0.909800
 epoch 18/30. Took 0.28802 seconds. 
  Full-batch training loss = 0.289668, test loss = 0.309584
  Training set accuracy = 0.916400, Test set accuracy = 0.913100
 epoch 19/30. Took 0.28512 seconds. 
  Full-batch training loss = 0.282882, test loss = 0.304899
  Training set accuracy = 0.919800, Test set accuracy = 0.913800
 epoch 20/30. Took 0.28484 seconds. 
  Full-batch training loss = 0.272665, test loss = 0.294099
  Training set accuracy = 0.920300, Test set accuracy = 0.915900
 epoch 21/30. Took 0.28563 seconds. 
  Full-batch training loss = 0.266566, test loss = 0.289365
  Training set accuracy = 0.923000, Test set accuracy = 0.915900
 epoch 22/30. Took 0.28624 seconds. 
  Full-batch training loss = 0.258430, test loss = 0.284339
  Training set accuracy = 0.925700, Test set accuracy = 0.918400
 epoch 23/30. Took 0.30306 seconds. 
  Full-batch training loss = 0.250191, test loss = 0.278946
  Training set accuracy = 0.928600, Test set accuracy = 0.921200
 epoch 24/30. Took 0.28297 seconds. 
  Full-batch training loss = 0.242511, test loss = 0.271187
  Training set accuracy = 0.930700, Test set accuracy = 0.921800
 epoch 25/30. Took 0.28378 seconds. 
  Full-batch training loss = 0.236942, test loss = 0.268144
  Training set accuracy = 0.932000, Test set accuracy = 0.922600
 epoch 26/30. Took 0.28505 seconds. 
  Full-batch training loss = 0.231873, test loss = 0.264253
  Training set accuracy = 0.933900, Test set accuracy = 0.924100
 epoch 27/30. Took 0.29303 seconds. 
  Full-batch training loss = 0.226345, test loss = 0.261068
  Training set accuracy = 0.933500, Test set accuracy = 0.924800
 epoch 28/30. Took 0.28465 seconds. 
  Full-batch training loss = 0.218044, test loss = 0.252214
  Training set accuracy = 0.937400, Test set accuracy = 0.926000
 epoch 29/30. Took 0.28521 seconds. 
  Full-batch training loss = 0.214570, test loss = 0.248258
  Training set accuracy = 0.938700, Test set accuracy = 0.927800
 epoch 30/30. Took 0.28519 seconds. 
  Full-batch training loss = 0.208493, test loss = 0.244556
  Training set accuracy = 0.941100, Test set accuracy = 0.928000
Elapsed time is 15.855525 seconds.
End Training
-----
Params 10000 0.010 0.40 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.4958 seconds. 
  Full-batch training loss = 2.101982, test loss = 2.096508
  Training set accuracy = 0.532400, Test set accuracy = 0.547400
 epoch 2/30. Took 0.48933 seconds. 
  Full-batch training loss = 1.524806, test loss = 1.512530
  Training set accuracy = 0.713800, Test set accuracy = 0.713700
 epoch 3/30. Took 0.4804 seconds. 
  Full-batch training loss = 0.918151, test loss = 0.905859
  Training set accuracy = 0.810700, Test set accuracy = 0.808300
 epoch 4/30. Took 0.50452 seconds. 
  Full-batch training loss = 0.661611, test loss = 0.652997
  Training set accuracy = 0.837100, Test set accuracy = 0.838000
 epoch 5/30. Took 0.48729 seconds. 
  Full-batch training loss = 0.549181, test loss = 0.544594
  Training set accuracy = 0.852400, Test set accuracy = 0.852000
 epoch 6/30. Took 0.48058 seconds. 
  Full-batch training loss = 0.478475, test loss = 0.478410
  Training set accuracy = 0.870500, Test set accuracy = 0.871400
 epoch 7/30. Took 0.52056 seconds. 
  Full-batch training loss = 0.433227, test loss = 0.436849
  Training set accuracy = 0.882800, Test set accuracy = 0.881800
 epoch 8/30. Took 0.48794 seconds. 
  Full-batch training loss = 0.399188, test loss = 0.406553
  Training set accuracy = 0.887600, Test set accuracy = 0.888300
 epoch 9/30. Took 0.48304 seconds. 
  Full-batch training loss = 0.374863, test loss = 0.382421
  Training set accuracy = 0.895200, Test set accuracy = 0.894900
 epoch 10/30. Took 0.49457 seconds. 
  Full-batch training loss = 0.354333, test loss = 0.364167
  Training set accuracy = 0.900200, Test set accuracy = 0.898500
 epoch 11/30. Took 0.49583 seconds. 
  Full-batch training loss = 0.334145, test loss = 0.346934
  Training set accuracy = 0.905600, Test set accuracy = 0.903300
 epoch 12/30. Took 0.47808 seconds. 
  Full-batch training loss = 0.319614, test loss = 0.335904
  Training set accuracy = 0.908600, Test set accuracy = 0.905300
 epoch 13/30. Took 0.51551 seconds. 
  Full-batch training loss = 0.304834, test loss = 0.322251
  Training set accuracy = 0.913100, Test set accuracy = 0.908800
 epoch 14/30. Took 0.52753 seconds. 
  Full-batch training loss = 0.297044, test loss = 0.317352
  Training set accuracy = 0.915800, Test set accuracy = 0.909400
 epoch 15/30. Took 0.48697 seconds. 
  Full-batch training loss = 0.282641, test loss = 0.304393
  Training set accuracy = 0.918300, Test set accuracy = 0.913200
 epoch 16/30. Took 0.4907 seconds. 
  Full-batch training loss = 0.273486, test loss = 0.296307
  Training set accuracy = 0.921800, Test set accuracy = 0.915900
 epoch 17/30. Took 0.52827 seconds. 
  Full-batch training loss = 0.264237, test loss = 0.288262
  Training set accuracy = 0.924900, Test set accuracy = 0.919000
 epoch 18/30. Took 0.47704 seconds. 
  Full-batch training loss = 0.254708, test loss = 0.282189
  Training set accuracy = 0.925900, Test set accuracy = 0.919500
 epoch 19/30. Took 0.47968 seconds. 
  Full-batch training loss = 0.247325, test loss = 0.275342
  Training set accuracy = 0.927100, Test set accuracy = 0.920900
 epoch 20/30. Took 0.47423 seconds. 
  Full-batch training loss = 0.238313, test loss = 0.266622
  Training set accuracy = 0.930300, Test set accuracy = 0.922000
 epoch 21/30. Took 0.49479 seconds. 
  Full-batch training loss = 0.230822, test loss = 0.261817
  Training set accuracy = 0.932400, Test set accuracy = 0.923900
 epoch 22/30. Took 0.49779 seconds. 
  Full-batch training loss = 0.224665, test loss = 0.258247
  Training set accuracy = 0.934100, Test set accuracy = 0.924100
 epoch 23/30. Took 0.50018 seconds. 
  Full-batch training loss = 0.218630, test loss = 0.252291
  Training set accuracy = 0.935700, Test set accuracy = 0.925000
 epoch 24/30. Took 0.50107 seconds. 
  Full-batch training loss = 0.213782, test loss = 0.247924
  Training set accuracy = 0.937700, Test set accuracy = 0.926800
 epoch 25/30. Took 0.49333 seconds. 
  Full-batch training loss = 0.207539, test loss = 0.244325
  Training set accuracy = 0.938000, Test set accuracy = 0.928200
 epoch 26/30. Took 0.49701 seconds. 
  Full-batch training loss = 0.201855, test loss = 0.239396
  Training set accuracy = 0.940300, Test set accuracy = 0.928800
 epoch 27/30. Took 0.48226 seconds. 
  Full-batch training loss = 0.194668, test loss = 0.234299
  Training set accuracy = 0.942000, Test set accuracy = 0.929900
 epoch 28/30. Took 0.48531 seconds. 
  Full-batch training loss = 0.190272, test loss = 0.229970
  Training set accuracy = 0.942100, Test set accuracy = 0.931900
 epoch 29/30. Took 0.47906 seconds. 
  Full-batch training loss = 0.184848, test loss = 0.227440
  Training set accuracy = 0.944500, Test set accuracy = 0.931800
 epoch 30/30. Took 0.5001 seconds. 
  Full-batch training loss = 0.178957, test loss = 0.221630
  Training set accuracy = 0.946100, Test set accuracy = 0.933700
Elapsed time is 25.460531 seconds.
End Training
-----
Params 10000 0.010 0.40 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2343 seconds. 
  Full-batch training loss = 2.018668, test loss = 2.014181
  Training set accuracy = 0.642300, Test set accuracy = 0.640200
 epoch 2/30. Took 1.2242 seconds. 
  Full-batch training loss = 1.259414, test loss = 1.246476
  Training set accuracy = 0.732200, Test set accuracy = 0.734900
 epoch 3/30. Took 1.2232 seconds. 
  Full-batch training loss = 0.759517, test loss = 0.748434
  Training set accuracy = 0.826400, Test set accuracy = 0.825200
 epoch 4/30. Took 1.2061 seconds. 
  Full-batch training loss = 0.574034, test loss = 0.567452
  Training set accuracy = 0.856500, Test set accuracy = 0.852800
 epoch 5/30. Took 1.1984 seconds. 
  Full-batch training loss = 0.485467, test loss = 0.480707
  Training set accuracy = 0.873900, Test set accuracy = 0.872700
 epoch 6/30. Took 1.1991 seconds. 
  Full-batch training loss = 0.431019, test loss = 0.427869
  Training set accuracy = 0.887200, Test set accuracy = 0.885400
 epoch 7/30. Took 1.2431 seconds. 
  Full-batch training loss = 0.397221, test loss = 0.397087
  Training set accuracy = 0.893400, Test set accuracy = 0.890500
 epoch 8/30. Took 1.2364 seconds. 
  Full-batch training loss = 0.370366, test loss = 0.374033
  Training set accuracy = 0.898000, Test set accuracy = 0.895100
 epoch 9/30. Took 1.2127 seconds. 
  Full-batch training loss = 0.349681, test loss = 0.354229
  Training set accuracy = 0.905200, Test set accuracy = 0.899700
 epoch 10/30. Took 1.2033 seconds. 
  Full-batch training loss = 0.332900, test loss = 0.338760
  Training set accuracy = 0.907900, Test set accuracy = 0.904100
 epoch 11/30. Took 1.2482 seconds. 
  Full-batch training loss = 0.318782, test loss = 0.328026
  Training set accuracy = 0.912000, Test set accuracy = 0.906700
 epoch 12/30. Took 1.2183 seconds. 
  Full-batch training loss = 0.305700, test loss = 0.316740
  Training set accuracy = 0.912600, Test set accuracy = 0.908700
 epoch 13/30. Took 1.1979 seconds. 
  Full-batch training loss = 0.295242, test loss = 0.309468
  Training set accuracy = 0.916200, Test set accuracy = 0.909700
 epoch 14/30. Took 1.2077 seconds. 
  Full-batch training loss = 0.283778, test loss = 0.300222
  Training set accuracy = 0.918900, Test set accuracy = 0.912700
 epoch 15/30. Took 1.2191 seconds. 
  Full-batch training loss = 0.276775, test loss = 0.294242
  Training set accuracy = 0.920200, Test set accuracy = 0.913200
 epoch 16/30. Took 1.2088 seconds. 
  Full-batch training loss = 0.266244, test loss = 0.285294
  Training set accuracy = 0.924200, Test set accuracy = 0.915300
 epoch 17/30. Took 1.2001 seconds. 
  Full-batch training loss = 0.258873, test loss = 0.280723
  Training set accuracy = 0.925200, Test set accuracy = 0.916800
 epoch 18/30. Took 1.2015 seconds. 
  Full-batch training loss = 0.250217, test loss = 0.273674
  Training set accuracy = 0.927500, Test set accuracy = 0.918900
 epoch 19/30. Took 1.2026 seconds. 
  Full-batch training loss = 0.243940, test loss = 0.265700
  Training set accuracy = 0.930500, Test set accuracy = 0.923000
 epoch 20/30. Took 1.3163 seconds. 
  Full-batch training loss = 0.235835, test loss = 0.261074
  Training set accuracy = 0.932300, Test set accuracy = 0.922400
 epoch 21/30. Took 1.2508 seconds. 
  Full-batch training loss = 0.230630, test loss = 0.256947
  Training set accuracy = 0.933800, Test set accuracy = 0.923900
 epoch 22/30. Took 1.2056 seconds. 
  Full-batch training loss = 0.223208, test loss = 0.250750
  Training set accuracy = 0.937500, Test set accuracy = 0.925300
 epoch 23/30. Took 1.2082 seconds. 
  Full-batch training loss = 0.217918, test loss = 0.248798
  Training set accuracy = 0.938000, Test set accuracy = 0.926200
 epoch 24/30. Took 1.2379 seconds. 
  Full-batch training loss = 0.211678, test loss = 0.242656
  Training set accuracy = 0.939200, Test set accuracy = 0.927700
 epoch 25/30. Took 1.2413 seconds. 
  Full-batch training loss = 0.205394, test loss = 0.237055
  Training set accuracy = 0.941300, Test set accuracy = 0.929700
 epoch 26/30. Took 1.2347 seconds. 
  Full-batch training loss = 0.199708, test loss = 0.233703
  Training set accuracy = 0.943900, Test set accuracy = 0.931900
 epoch 27/30. Took 1.2573 seconds. 
  Full-batch training loss = 0.193825, test loss = 0.228281
  Training set accuracy = 0.944400, Test set accuracy = 0.932800
 epoch 28/30. Took 1.1996 seconds. 
  Full-batch training loss = 0.188315, test loss = 0.223899
  Training set accuracy = 0.947100, Test set accuracy = 0.933600
 epoch 29/30. Took 1.2005 seconds. 
  Full-batch training loss = 0.183531, test loss = 0.221409
  Training set accuracy = 0.948500, Test set accuracy = 0.935200
 epoch 30/30. Took 1.2123 seconds. 
  Full-batch training loss = 0.178731, test loss = 0.219347
  Training set accuracy = 0.950300, Test set accuracy = 0.935000
Elapsed time is 62.596698 seconds.
End Training
-----
Params 10000 0.010 0.40 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.34169 seconds. 
  Full-batch training loss = 2.280564, test loss = 2.280467
  Training set accuracy = 0.213200, Test set accuracy = 0.209300
 epoch 2/30. Took 0.34292 seconds. 
  Full-batch training loss = 2.229686, test loss = 2.228836
  Training set accuracy = 0.348300, Test set accuracy = 0.342100
 epoch 3/30. Took 0.34949 seconds. 
  Full-batch training loss = 2.097984, test loss = 2.095074
  Training set accuracy = 0.403400, Test set accuracy = 0.401000
 epoch 4/30. Took 0.33648 seconds. 
  Full-batch training loss = 1.870876, test loss = 1.863584
  Training set accuracy = 0.521900, Test set accuracy = 0.518200
 epoch 5/30. Took 0.33704 seconds. 
  Full-batch training loss = 1.532081, test loss = 1.519099
  Training set accuracy = 0.601900, Test set accuracy = 0.609400
 epoch 6/30. Took 0.33759 seconds. 
  Full-batch training loss = 1.148364, test loss = 1.133842
  Training set accuracy = 0.700000, Test set accuracy = 0.703700
 epoch 7/30. Took 0.32891 seconds. 
  Full-batch training loss = 0.923010, test loss = 0.907086
  Training set accuracy = 0.760100, Test set accuracy = 0.767900
 epoch 8/30. Took 0.32002 seconds. 
  Full-batch training loss = 0.783337, test loss = 0.768544
  Training set accuracy = 0.796200, Test set accuracy = 0.802000
 epoch 9/30. Took 0.34875 seconds. 
  Full-batch training loss = 0.677977, test loss = 0.668321
  Training set accuracy = 0.818800, Test set accuracy = 0.823500
 epoch 10/30. Took 0.33771 seconds. 
  Full-batch training loss = 0.602016, test loss = 0.592024
  Training set accuracy = 0.827900, Test set accuracy = 0.833600
 epoch 11/30. Took 0.33862 seconds. 
  Full-batch training loss = 0.542889, test loss = 0.536018
  Training set accuracy = 0.850100, Test set accuracy = 0.853200
 epoch 12/30. Took 0.31977 seconds. 
  Full-batch training loss = 0.507950, test loss = 0.501091
  Training set accuracy = 0.856800, Test set accuracy = 0.857900
 epoch 13/30. Took 0.32703 seconds. 
  Full-batch training loss = 0.471414, test loss = 0.467280
  Training set accuracy = 0.867900, Test set accuracy = 0.870700
 epoch 14/30. Took 0.33645 seconds. 
  Full-batch training loss = 0.442509, test loss = 0.439673
  Training set accuracy = 0.876100, Test set accuracy = 0.879500
 epoch 15/30. Took 0.32634 seconds. 
  Full-batch training loss = 0.421495, test loss = 0.421120
  Training set accuracy = 0.882300, Test set accuracy = 0.884200
 epoch 16/30. Took 0.34141 seconds. 
  Full-batch training loss = 0.396506, test loss = 0.399520
  Training set accuracy = 0.888100, Test set accuracy = 0.885700
 epoch 17/30. Took 0.33744 seconds. 
  Full-batch training loss = 0.373907, test loss = 0.377122
  Training set accuracy = 0.895900, Test set accuracy = 0.894900
 epoch 18/30. Took 0.32498 seconds. 
  Full-batch training loss = 0.363246, test loss = 0.368675
  Training set accuracy = 0.899100, Test set accuracy = 0.893300
 epoch 19/30. Took 0.34486 seconds. 
  Full-batch training loss = 0.353748, test loss = 0.364897
  Training set accuracy = 0.901300, Test set accuracy = 0.890900
 epoch 20/30. Took 0.34028 seconds. 
  Full-batch training loss = 0.330035, test loss = 0.340575
  Training set accuracy = 0.909200, Test set accuracy = 0.902900
 epoch 21/30. Took 0.33636 seconds. 
  Full-batch training loss = 0.321586, test loss = 0.332425
  Training set accuracy = 0.908900, Test set accuracy = 0.904500
 epoch 22/30. Took 0.34969 seconds. 
  Full-batch training loss = 0.305502, test loss = 0.319928
  Training set accuracy = 0.914000, Test set accuracy = 0.908100
 epoch 23/30. Took 0.33353 seconds. 
  Full-batch training loss = 0.297548, test loss = 0.315631
  Training set accuracy = 0.916900, Test set accuracy = 0.909000
 epoch 24/30. Took 0.33202 seconds. 
  Full-batch training loss = 0.288710, test loss = 0.307455
  Training set accuracy = 0.918600, Test set accuracy = 0.912500
 epoch 25/30. Took 0.3263 seconds. 
  Full-batch training loss = 0.277532, test loss = 0.299566
  Training set accuracy = 0.922000, Test set accuracy = 0.914300
 epoch 26/30. Took 0.33122 seconds. 
  Full-batch training loss = 0.269354, test loss = 0.292979
  Training set accuracy = 0.922300, Test set accuracy = 0.915300
 epoch 27/30. Took 0.33762 seconds. 
  Full-batch training loss = 0.259598, test loss = 0.288846
  Training set accuracy = 0.925400, Test set accuracy = 0.915200
 epoch 28/30. Took 0.33758 seconds. 
  Full-batch training loss = 0.252265, test loss = 0.280523
  Training set accuracy = 0.927600, Test set accuracy = 0.918300
 epoch 29/30. Took 0.34805 seconds. 
  Full-batch training loss = 0.246094, test loss = 0.275916
  Training set accuracy = 0.929300, Test set accuracy = 0.919200
 epoch 30/30. Took 0.33117 seconds. 
  Full-batch training loss = 0.240402, test loss = 0.274509
  Training set accuracy = 0.931500, Test set accuracy = 0.919500
Elapsed time is 18.226074 seconds.
End Training
-----
Params 10000 0.010 0.40 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.5763 seconds. 
  Full-batch training loss = 2.268066, test loss = 2.267338
  Training set accuracy = 0.371700, Test set accuracy = 0.374800
 epoch 2/30. Took 0.57039 seconds. 
  Full-batch training loss = 2.180543, test loss = 2.180851
  Training set accuracy = 0.491800, Test set accuracy = 0.490600
 epoch 3/30. Took 0.56954 seconds. 
  Full-batch training loss = 1.932564, test loss = 1.932275
  Training set accuracy = 0.574000, Test set accuracy = 0.570700
 epoch 4/30. Took 0.58091 seconds. 
  Full-batch training loss = 1.430935, test loss = 1.426807
  Training set accuracy = 0.630400, Test set accuracy = 0.618700
 epoch 5/30. Took 0.58015 seconds. 
  Full-batch training loss = 0.976791, test loss = 0.977205
  Training set accuracy = 0.710300, Test set accuracy = 0.703800
 epoch 6/30. Took 0.58545 seconds. 
  Full-batch training loss = 0.775144, test loss = 0.777645
  Training set accuracy = 0.772000, Test set accuracy = 0.761700
 epoch 7/30. Took 0.5748 seconds. 
  Full-batch training loss = 0.649846, test loss = 0.654908
  Training set accuracy = 0.813000, Test set accuracy = 0.806800
 epoch 8/30. Took 0.60816 seconds. 
  Full-batch training loss = 0.567837, test loss = 0.571783
  Training set accuracy = 0.836100, Test set accuracy = 0.835500
 epoch 9/30. Took 0.57686 seconds. 
  Full-batch training loss = 0.505870, test loss = 0.511438
  Training set accuracy = 0.856800, Test set accuracy = 0.851300
 epoch 10/30. Took 0.58746 seconds. 
  Full-batch training loss = 0.458381, test loss = 0.463848
  Training set accuracy = 0.870900, Test set accuracy = 0.868400
 epoch 11/30. Took 0.57469 seconds. 
  Full-batch training loss = 0.426361, test loss = 0.433819
  Training set accuracy = 0.882900, Test set accuracy = 0.876900
 epoch 12/30. Took 0.6025 seconds. 
  Full-batch training loss = 0.394609, test loss = 0.401209
  Training set accuracy = 0.890900, Test set accuracy = 0.885500
 epoch 13/30. Took 0.5791 seconds. 
  Full-batch training loss = 0.367472, test loss = 0.376448
  Training set accuracy = 0.901100, Test set accuracy = 0.894200
 epoch 14/30. Took 0.57364 seconds. 
  Full-batch training loss = 0.353392, test loss = 0.366257
  Training set accuracy = 0.903100, Test set accuracy = 0.892000
 epoch 15/30. Took 0.55125 seconds. 
  Full-batch training loss = 0.329827, test loss = 0.342089
  Training set accuracy = 0.909000, Test set accuracy = 0.900100
 epoch 16/30. Took 0.57938 seconds. 
  Full-batch training loss = 0.315729, test loss = 0.330688
  Training set accuracy = 0.911900, Test set accuracy = 0.903000
 epoch 17/30. Took 0.57425 seconds. 
  Full-batch training loss = 0.301450, test loss = 0.318059
  Training set accuracy = 0.915600, Test set accuracy = 0.906000
 epoch 18/30. Took 0.55797 seconds. 
  Full-batch training loss = 0.289152, test loss = 0.306417
  Training set accuracy = 0.918400, Test set accuracy = 0.908900
 epoch 19/30. Took 0.57152 seconds. 
  Full-batch training loss = 0.280100, test loss = 0.301859
  Training set accuracy = 0.920200, Test set accuracy = 0.909400
 epoch 20/30. Took 0.5533 seconds. 
  Full-batch training loss = 0.265437, test loss = 0.288024
  Training set accuracy = 0.924900, Test set accuracy = 0.913900
 epoch 21/30. Took 0.56579 seconds. 
  Full-batch training loss = 0.256982, test loss = 0.283029
  Training set accuracy = 0.927400, Test set accuracy = 0.915600
 epoch 22/30. Took 0.57939 seconds. 
  Full-batch training loss = 0.248567, test loss = 0.278135
  Training set accuracy = 0.928300, Test set accuracy = 0.916600
 epoch 23/30. Took 0.5661 seconds. 
  Full-batch training loss = 0.238362, test loss = 0.268363
  Training set accuracy = 0.931700, Test set accuracy = 0.921000
 epoch 24/30. Took 0.55033 seconds. 
  Full-batch training loss = 0.226399, test loss = 0.256343
  Training set accuracy = 0.936400, Test set accuracy = 0.923500
 epoch 25/30. Took 0.57779 seconds. 
  Full-batch training loss = 0.217729, test loss = 0.250290
  Training set accuracy = 0.938800, Test set accuracy = 0.925900
 epoch 26/30. Took 0.56846 seconds. 
  Full-batch training loss = 0.211579, test loss = 0.244906
  Training set accuracy = 0.940100, Test set accuracy = 0.927100
 epoch 27/30. Took 0.57486 seconds. 
  Full-batch training loss = 0.202556, test loss = 0.240172
  Training set accuracy = 0.941600, Test set accuracy = 0.928400
 epoch 28/30. Took 0.5678 seconds. 
  Full-batch training loss = 0.194973, test loss = 0.234990
  Training set accuracy = 0.945300, Test set accuracy = 0.929200
 epoch 29/30. Took 0.58299 seconds. 
  Full-batch training loss = 0.193378, test loss = 0.236426
  Training set accuracy = 0.945900, Test set accuracy = 0.927900
 epoch 30/30. Took 0.55429 seconds. 
  Full-batch training loss = 0.180339, test loss = 0.223518
  Training set accuracy = 0.949800, Test set accuracy = 0.933700
Elapsed time is 30.486798 seconds.
End Training
-----
Params 10000 0.010 0.40 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.6984 seconds. 
  Full-batch training loss = 2.257217, test loss = 2.258236
  Training set accuracy = 0.392000, Test set accuracy = 0.393100
 epoch 2/30. Took 1.6815 seconds. 
  Full-batch training loss = 2.151398, test loss = 2.152890
  Training set accuracy = 0.479800, Test set accuracy = 0.468200
 epoch 3/30. Took 1.7074 seconds. 
  Full-batch training loss = 1.781809, test loss = 1.781476
  Training set accuracy = 0.647200, Test set accuracy = 0.638300
 epoch 4/30. Took 1.6696 seconds. 
  Full-batch training loss = 1.048971, test loss = 1.043336
  Training set accuracy = 0.745000, Test set accuracy = 0.745800
 epoch 5/30. Took 1.6868 seconds. 
  Full-batch training loss = 0.724411, test loss = 0.723000
  Training set accuracy = 0.799400, Test set accuracy = 0.798700
 epoch 6/30. Took 1.6598 seconds. 
  Full-batch training loss = 0.590028, test loss = 0.591929
  Training set accuracy = 0.833000, Test set accuracy = 0.829300
 epoch 7/30. Took 1.6694 seconds. 
  Full-batch training loss = 0.503414, test loss = 0.506547
  Training set accuracy = 0.858400, Test set accuracy = 0.855800
 epoch 8/30. Took 1.8343 seconds. 
  Full-batch training loss = 0.449048, test loss = 0.456340
  Training set accuracy = 0.872700, Test set accuracy = 0.868100
 epoch 9/30. Took 1.6531 seconds. 
  Full-batch training loss = 0.413734, test loss = 0.422389
  Training set accuracy = 0.882400, Test set accuracy = 0.877900
 epoch 10/30. Took 1.6805 seconds. 
  Full-batch training loss = 0.383145, test loss = 0.392362
  Training set accuracy = 0.891800, Test set accuracy = 0.884400
 epoch 11/30. Took 1.6644 seconds. 
  Full-batch training loss = 0.359606, test loss = 0.373636
  Training set accuracy = 0.895600, Test set accuracy = 0.890500
 epoch 12/30. Took 1.6573 seconds. 
  Full-batch training loss = 0.338441, test loss = 0.352594
  Training set accuracy = 0.901000, Test set accuracy = 0.896800
 epoch 13/30. Took 1.6542 seconds. 
  Full-batch training loss = 0.322149, test loss = 0.335627
  Training set accuracy = 0.906400, Test set accuracy = 0.901100
 epoch 14/30. Took 1.6864 seconds. 
  Full-batch training loss = 0.303940, test loss = 0.320887
  Training set accuracy = 0.912900, Test set accuracy = 0.906200
 epoch 15/30. Took 1.7135 seconds. 
  Full-batch training loss = 0.294367, test loss = 0.315051
  Training set accuracy = 0.914400, Test set accuracy = 0.906600
 epoch 16/30. Took 1.6774 seconds. 
  Full-batch training loss = 0.277913, test loss = 0.299845
  Training set accuracy = 0.919800, Test set accuracy = 0.913000
 epoch 17/30. Took 1.6868 seconds. 
  Full-batch training loss = 0.268945, test loss = 0.292235
  Training set accuracy = 0.921700, Test set accuracy = 0.915100
 epoch 18/30. Took 1.6868 seconds. 
  Full-batch training loss = 0.257919, test loss = 0.283296
  Training set accuracy = 0.925100, Test set accuracy = 0.917300
 epoch 19/30. Took 1.656 seconds. 
  Full-batch training loss = 0.246510, test loss = 0.276312
  Training set accuracy = 0.929200, Test set accuracy = 0.918400
 epoch 20/30. Took 1.6545 seconds. 
  Full-batch training loss = 0.235211, test loss = 0.264553
  Training set accuracy = 0.931700, Test set accuracy = 0.922100
 epoch 21/30. Took 1.6567 seconds. 
  Full-batch training loss = 0.229210, test loss = 0.260928
  Training set accuracy = 0.933500, Test set accuracy = 0.923200
 epoch 22/30. Took 1.6974 seconds. 
  Full-batch training loss = 0.217305, test loss = 0.248697
  Training set accuracy = 0.935600, Test set accuracy = 0.926900
 epoch 23/30. Took 1.6561 seconds. 
  Full-batch training loss = 0.209105, test loss = 0.242895
  Training set accuracy = 0.939400, Test set accuracy = 0.928900
 epoch 24/30. Took 1.6788 seconds. 
  Full-batch training loss = 0.201366, test loss = 0.238740
  Training set accuracy = 0.941200, Test set accuracy = 0.928800
 epoch 25/30. Took 1.6926 seconds. 
  Full-batch training loss = 0.192592, test loss = 0.231244
  Training set accuracy = 0.942500, Test set accuracy = 0.930400
 epoch 26/30. Took 1.6649 seconds. 
  Full-batch training loss = 0.186259, test loss = 0.227680
  Training set accuracy = 0.945900, Test set accuracy = 0.931800
 epoch 27/30. Took 1.6658 seconds. 
  Full-batch training loss = 0.177511, test loss = 0.219538
  Training set accuracy = 0.949100, Test set accuracy = 0.933600
 epoch 28/30. Took 1.663 seconds. 
  Full-batch training loss = 0.172358, test loss = 0.217988
  Training set accuracy = 0.949900, Test set accuracy = 0.934300
 epoch 29/30. Took 1.7852 seconds. 
  Full-batch training loss = 0.165119, test loss = 0.212265
  Training set accuracy = 0.953600, Test set accuracy = 0.935100
 epoch 30/30. Took 1.7131 seconds. 
  Full-batch training loss = 0.157579, test loss = 0.206227
  Training set accuracy = 0.955400, Test set accuracy = 0.937400
Elapsed time is 86.360492 seconds.
End Training
-----
Params 10000 0.010 0.50 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.22574 seconds. 
  Full-batch training loss = 1.707911, test loss = 1.690794
  Training set accuracy = 0.707000, Test set accuracy = 0.717600
 epoch 2/30. Took 0.22911 seconds. 
  Full-batch training loss = 1.090229, test loss = 1.062886
  Training set accuracy = 0.805800, Test set accuracy = 0.812600
 epoch 3/30. Took 0.22826 seconds. 
  Full-batch training loss = 0.800098, test loss = 0.772234
  Training set accuracy = 0.834900, Test set accuracy = 0.841100
 epoch 4/30. Took 0.22928 seconds. 
  Full-batch training loss = 0.660050, test loss = 0.633274
  Training set accuracy = 0.855600, Test set accuracy = 0.866000
 epoch 5/30. Took 0.22867 seconds. 
  Full-batch training loss = 0.579307, test loss = 0.553401
  Training set accuracy = 0.863300, Test set accuracy = 0.871700
 epoch 6/30. Took 0.22293 seconds. 
  Full-batch training loss = 0.527463, test loss = 0.502176
  Training set accuracy = 0.871200, Test set accuracy = 0.878900
 epoch 7/30. Took 0.22476 seconds. 
  Full-batch training loss = 0.489130, test loss = 0.466130
  Training set accuracy = 0.877300, Test set accuracy = 0.885000
 epoch 8/30. Took 0.22484 seconds. 
  Full-batch training loss = 0.457669, test loss = 0.436741
  Training set accuracy = 0.884000, Test set accuracy = 0.890300
 epoch 9/30. Took 0.23229 seconds. 
  Full-batch training loss = 0.438272, test loss = 0.418276
  Training set accuracy = 0.885700, Test set accuracy = 0.892600
 epoch 10/30. Took 0.22355 seconds. 
  Full-batch training loss = 0.417847, test loss = 0.400099
  Training set accuracy = 0.892200, Test set accuracy = 0.897600
 epoch 11/30. Took 0.23009 seconds. 
  Full-batch training loss = 0.400312, test loss = 0.384657
  Training set accuracy = 0.893200, Test set accuracy = 0.899700
 epoch 12/30. Took 0.22257 seconds. 
  Full-batch training loss = 0.386564, test loss = 0.372684
  Training set accuracy = 0.896500, Test set accuracy = 0.901500
 epoch 13/30. Took 0.22499 seconds. 
  Full-batch training loss = 0.374751, test loss = 0.362232
  Training set accuracy = 0.899700, Test set accuracy = 0.901700
 epoch 14/30. Took 0.22196 seconds. 
  Full-batch training loss = 0.363899, test loss = 0.352713
  Training set accuracy = 0.900800, Test set accuracy = 0.904400
 epoch 15/30. Took 0.23654 seconds. 
  Full-batch training loss = 0.352329, test loss = 0.342094
  Training set accuracy = 0.903300, Test set accuracy = 0.906000
 epoch 16/30. Took 0.22638 seconds. 
  Full-batch training loss = 0.343316, test loss = 0.334655
  Training set accuracy = 0.905900, Test set accuracy = 0.907800
 epoch 17/30. Took 0.22656 seconds. 
  Full-batch training loss = 0.334916, test loss = 0.328159
  Training set accuracy = 0.907900, Test set accuracy = 0.910500
 epoch 18/30. Took 0.22529 seconds. 
  Full-batch training loss = 0.327238, test loss = 0.321189
  Training set accuracy = 0.908500, Test set accuracy = 0.911200
 epoch 19/30. Took 0.22831 seconds. 
  Full-batch training loss = 0.319827, test loss = 0.315688
  Training set accuracy = 0.911100, Test set accuracy = 0.913500
 epoch 20/30. Took 0.22129 seconds. 
  Full-batch training loss = 0.313050, test loss = 0.310766
  Training set accuracy = 0.913500, Test set accuracy = 0.914500
 epoch 21/30. Took 0.22759 seconds. 
  Full-batch training loss = 0.307094, test loss = 0.305057
  Training set accuracy = 0.915900, Test set accuracy = 0.916100
 epoch 22/30. Took 0.22857 seconds. 
  Full-batch training loss = 0.301823, test loss = 0.302050
  Training set accuracy = 0.917300, Test set accuracy = 0.916100
 epoch 23/30. Took 0.22656 seconds. 
  Full-batch training loss = 0.294835, test loss = 0.295626
  Training set accuracy = 0.919300, Test set accuracy = 0.917200
 epoch 24/30. Took 0.22893 seconds. 
  Full-batch training loss = 0.288616, test loss = 0.290241
  Training set accuracy = 0.920900, Test set accuracy = 0.919100
 epoch 25/30. Took 0.2271 seconds. 
  Full-batch training loss = 0.283432, test loss = 0.286646
  Training set accuracy = 0.922800, Test set accuracy = 0.919600
 epoch 26/30. Took 0.22707 seconds. 
  Full-batch training loss = 0.278489, test loss = 0.281916
  Training set accuracy = 0.924300, Test set accuracy = 0.921200
 epoch 27/30. Took 0.22298 seconds. 
  Full-batch training loss = 0.273894, test loss = 0.278581
  Training set accuracy = 0.924800, Test set accuracy = 0.921800
 epoch 28/30. Took 0.22487 seconds. 
  Full-batch training loss = 0.269522, test loss = 0.275396
  Training set accuracy = 0.926000, Test set accuracy = 0.921300
 epoch 29/30. Took 0.22165 seconds. 
  Full-batch training loss = 0.267645, test loss = 0.274516
  Training set accuracy = 0.926000, Test set accuracy = 0.921800
 epoch 30/30. Took 0.23252 seconds. 
  Full-batch training loss = 0.260528, test loss = 0.268862
  Training set accuracy = 0.929000, Test set accuracy = 0.924200
Elapsed time is 13.211852 seconds.
End Training
-----
Params 10000 0.010 0.50 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.3631 seconds. 
  Full-batch training loss = 1.563578, test loss = 1.552271
  Training set accuracy = 0.733400, Test set accuracy = 0.739900
 epoch 2/30. Took 0.35952 seconds. 
  Full-batch training loss = 0.951168, test loss = 0.933014
  Training set accuracy = 0.809200, Test set accuracy = 0.813700
 epoch 3/30. Took 0.35932 seconds. 
  Full-batch training loss = 0.707303, test loss = 0.691572
  Training set accuracy = 0.849100, Test set accuracy = 0.851500
 epoch 4/30. Took 0.36281 seconds. 
  Full-batch training loss = 0.590911, test loss = 0.578336
  Training set accuracy = 0.867100, Test set accuracy = 0.867400
 epoch 5/30. Took 0.36825 seconds. 
  Full-batch training loss = 0.519787, test loss = 0.508678
  Training set accuracy = 0.876500, Test set accuracy = 0.878300
 epoch 6/30. Took 0.35779 seconds. 
  Full-batch training loss = 0.473948, test loss = 0.466673
  Training set accuracy = 0.885300, Test set accuracy = 0.884600
 epoch 7/30. Took 0.35924 seconds. 
  Full-batch training loss = 0.440287, test loss = 0.432644
  Training set accuracy = 0.891700, Test set accuracy = 0.890700
 epoch 8/30. Took 0.35641 seconds. 
  Full-batch training loss = 0.414661, test loss = 0.411857
  Training set accuracy = 0.894100, Test set accuracy = 0.892300
 epoch 9/30. Took 0.36247 seconds. 
  Full-batch training loss = 0.395054, test loss = 0.394849
  Training set accuracy = 0.897900, Test set accuracy = 0.895400
 epoch 10/30. Took 0.36111 seconds. 
  Full-batch training loss = 0.377607, test loss = 0.378032
  Training set accuracy = 0.900900, Test set accuracy = 0.898100
 epoch 11/30. Took 0.37508 seconds. 
  Full-batch training loss = 0.363122, test loss = 0.365414
  Training set accuracy = 0.903600, Test set accuracy = 0.901000
 epoch 12/30. Took 0.35925 seconds. 
  Full-batch training loss = 0.350211, test loss = 0.355126
  Training set accuracy = 0.906500, Test set accuracy = 0.903900
 epoch 13/30. Took 0.36007 seconds. 
  Full-batch training loss = 0.338877, test loss = 0.345704
  Training set accuracy = 0.907800, Test set accuracy = 0.905200
 epoch 14/30. Took 0.35841 seconds. 
  Full-batch training loss = 0.328691, test loss = 0.337365
  Training set accuracy = 0.910900, Test set accuracy = 0.906300
 epoch 15/30. Took 0.35925 seconds. 
  Full-batch training loss = 0.320382, test loss = 0.330052
  Training set accuracy = 0.913200, Test set accuracy = 0.907800
 epoch 16/30. Took 0.35904 seconds. 
  Full-batch training loss = 0.312525, test loss = 0.324442
  Training set accuracy = 0.914800, Test set accuracy = 0.909900
 epoch 17/30. Took 0.37039 seconds. 
  Full-batch training loss = 0.303666, test loss = 0.315984
  Training set accuracy = 0.915500, Test set accuracy = 0.911300
 epoch 18/30. Took 0.37483 seconds. 
  Full-batch training loss = 0.297974, test loss = 0.312507
  Training set accuracy = 0.916800, Test set accuracy = 0.912800
 epoch 19/30. Took 0.38988 seconds. 
  Full-batch training loss = 0.290706, test loss = 0.306336
  Training set accuracy = 0.919600, Test set accuracy = 0.912900
 epoch 20/30. Took 0.36161 seconds. 
  Full-batch training loss = 0.283983, test loss = 0.299793
  Training set accuracy = 0.920600, Test set accuracy = 0.916600
 epoch 21/30. Took 0.36043 seconds. 
  Full-batch training loss = 0.279368, test loss = 0.297096
  Training set accuracy = 0.922100, Test set accuracy = 0.916400
 epoch 22/30. Took 0.36059 seconds. 
  Full-batch training loss = 0.273144, test loss = 0.292996
  Training set accuracy = 0.923800, Test set accuracy = 0.916500
 epoch 23/30. Took 0.36611 seconds. 
  Full-batch training loss = 0.267204, test loss = 0.287945
  Training set accuracy = 0.925400, Test set accuracy = 0.919200
 epoch 24/30. Took 0.35796 seconds. 
  Full-batch training loss = 0.261925, test loss = 0.283694
  Training set accuracy = 0.927700, Test set accuracy = 0.920100
 epoch 25/30. Took 0.36057 seconds. 
  Full-batch training loss = 0.256758, test loss = 0.279927
  Training set accuracy = 0.928200, Test set accuracy = 0.920400
 epoch 26/30. Took 0.36081 seconds. 
  Full-batch training loss = 0.252522, test loss = 0.277851
  Training set accuracy = 0.929800, Test set accuracy = 0.920800
 epoch 27/30. Took 0.36099 seconds. 
  Full-batch training loss = 0.247375, test loss = 0.272506
  Training set accuracy = 0.930400, Test set accuracy = 0.921900
 epoch 28/30. Took 0.36046 seconds. 
  Full-batch training loss = 0.242752, test loss = 0.269072
  Training set accuracy = 0.932100, Test set accuracy = 0.923300
 epoch 29/30. Took 0.36039 seconds. 
  Full-batch training loss = 0.238495, test loss = 0.265631
  Training set accuracy = 0.932900, Test set accuracy = 0.924200
 epoch 30/30. Took 0.3597 seconds. 
  Full-batch training loss = 0.234272, test loss = 0.263352
  Training set accuracy = 0.934200, Test set accuracy = 0.925000
Elapsed time is 19.355041 seconds.
End Training
-----
Params 10000 0.010 0.50 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.73663 seconds. 
  Full-batch training loss = 1.430998, test loss = 1.420222
  Training set accuracy = 0.751400, Test set accuracy = 0.755900
 epoch 2/30. Took 0.76509 seconds. 
  Full-batch training loss = 0.861778, test loss = 0.844045
  Training set accuracy = 0.829100, Test set accuracy = 0.832600
 epoch 3/30. Took 0.73165 seconds. 
  Full-batch training loss = 0.649244, test loss = 0.633741
  Training set accuracy = 0.854000, Test set accuracy = 0.853000
 epoch 4/30. Took 0.72676 seconds. 
  Full-batch training loss = 0.545447, test loss = 0.531051
  Training set accuracy = 0.872700, Test set accuracy = 0.873700
 epoch 5/30. Took 0.72525 seconds. 
  Full-batch training loss = 0.486792, test loss = 0.476179
  Training set accuracy = 0.882900, Test set accuracy = 0.880800
 epoch 6/30. Took 0.72752 seconds. 
  Full-batch training loss = 0.446234, test loss = 0.437699
  Training set accuracy = 0.888800, Test set accuracy = 0.890200
 epoch 7/30. Took 0.72956 seconds. 
  Full-batch training loss = 0.414320, test loss = 0.406382
  Training set accuracy = 0.894800, Test set accuracy = 0.894200
 epoch 8/30. Took 0.73693 seconds. 
  Full-batch training loss = 0.393374, test loss = 0.388711
  Training set accuracy = 0.898400, Test set accuracy = 0.895000
 epoch 9/30. Took 0.73677 seconds. 
  Full-batch training loss = 0.372980, test loss = 0.370499
  Training set accuracy = 0.903500, Test set accuracy = 0.901000
 epoch 10/30. Took 0.76273 seconds. 
  Full-batch training loss = 0.357910, test loss = 0.357333
  Training set accuracy = 0.905000, Test set accuracy = 0.903700
 epoch 11/30. Took 0.73673 seconds. 
  Full-batch training loss = 0.345177, test loss = 0.348046
  Training set accuracy = 0.907800, Test set accuracy = 0.905800
 epoch 12/30. Took 0.7275 seconds. 
  Full-batch training loss = 0.334063, test loss = 0.338545
  Training set accuracy = 0.909900, Test set accuracy = 0.907000
 epoch 13/30. Took 0.73789 seconds. 
  Full-batch training loss = 0.322822, test loss = 0.327705
  Training set accuracy = 0.911900, Test set accuracy = 0.910200
 epoch 14/30. Took 0.74701 seconds. 
  Full-batch training loss = 0.313859, test loss = 0.320394
  Training set accuracy = 0.913900, Test set accuracy = 0.912500
 epoch 15/30. Took 0.73325 seconds. 
  Full-batch training loss = 0.306328, test loss = 0.314647
  Training set accuracy = 0.918400, Test set accuracy = 0.914300
 epoch 16/30. Took 0.7286 seconds. 
  Full-batch training loss = 0.297449, test loss = 0.308665
  Training set accuracy = 0.919200, Test set accuracy = 0.915100
 epoch 17/30. Took 0.73914 seconds. 
  Full-batch training loss = 0.291521, test loss = 0.302667
  Training set accuracy = 0.920600, Test set accuracy = 0.915900
 epoch 18/30. Took 0.77551 seconds. 
  Full-batch training loss = 0.283701, test loss = 0.297212
  Training set accuracy = 0.923300, Test set accuracy = 0.917600
 epoch 19/30. Took 0.72976 seconds. 
  Full-batch training loss = 0.277558, test loss = 0.293407
  Training set accuracy = 0.924400, Test set accuracy = 0.918400
 epoch 20/30. Took 0.72626 seconds. 
  Full-batch training loss = 0.271154, test loss = 0.287761
  Training set accuracy = 0.925700, Test set accuracy = 0.919200
 epoch 21/30. Took 0.72687 seconds. 
  Full-batch training loss = 0.264911, test loss = 0.283464
  Training set accuracy = 0.927600, Test set accuracy = 0.921000
 epoch 22/30. Took 0.72531 seconds. 
  Full-batch training loss = 0.259084, test loss = 0.279256
  Training set accuracy = 0.929000, Test set accuracy = 0.922200
 epoch 23/30. Took 0.72885 seconds. 
  Full-batch training loss = 0.253786, test loss = 0.274036
  Training set accuracy = 0.930100, Test set accuracy = 0.923100
 epoch 24/30. Took 0.72693 seconds. 
  Full-batch training loss = 0.248317, test loss = 0.270469
  Training set accuracy = 0.930400, Test set accuracy = 0.924600
 epoch 25/30. Took 0.72874 seconds. 
  Full-batch training loss = 0.243173, test loss = 0.266696
  Training set accuracy = 0.932900, Test set accuracy = 0.925600
 epoch 26/30. Took 0.73941 seconds. 
  Full-batch training loss = 0.239208, test loss = 0.263954
  Training set accuracy = 0.934800, Test set accuracy = 0.925500
 epoch 27/30. Took 0.73005 seconds. 
  Full-batch training loss = 0.234252, test loss = 0.259499
  Training set accuracy = 0.936300, Test set accuracy = 0.926900
 epoch 28/30. Took 0.73372 seconds. 
  Full-batch training loss = 0.229346, test loss = 0.256525
  Training set accuracy = 0.937100, Test set accuracy = 0.927000
 epoch 29/30. Took 0.72894 seconds. 
  Full-batch training loss = 0.226173, test loss = 0.254727
  Training set accuracy = 0.936900, Test set accuracy = 0.926700
 epoch 30/30. Took 0.75125 seconds. 
  Full-batch training loss = 0.221193, test loss = 0.249940
  Training set accuracy = 0.938900, Test set accuracy = 0.928500
Elapsed time is 38.430945 seconds.
End Training
-----
Params 10000 0.010 0.50 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28329 seconds. 
  Full-batch training loss = 2.217481, test loss = 2.216612
  Training set accuracy = 0.398300, Test set accuracy = 0.400500
 epoch 2/30. Took 0.27824 seconds. 
  Full-batch training loss = 2.016569, test loss = 2.013310
  Training set accuracy = 0.564600, Test set accuracy = 0.556900
 epoch 3/30. Took 0.2878 seconds. 
  Full-batch training loss = 1.640481, test loss = 1.635875
  Training set accuracy = 0.665600, Test set accuracy = 0.664600
 epoch 4/30. Took 0.30121 seconds. 
  Full-batch training loss = 1.227825, test loss = 1.224432
  Training set accuracy = 0.736600, Test set accuracy = 0.740400
 epoch 5/30. Took 0.28304 seconds. 
  Full-batch training loss = 0.963803, test loss = 0.961924
  Training set accuracy = 0.784900, Test set accuracy = 0.783200
 epoch 6/30. Took 0.27256 seconds. 
  Full-batch training loss = 0.805915, test loss = 0.805628
  Training set accuracy = 0.818000, Test set accuracy = 0.816100
 epoch 7/30. Took 0.29372 seconds. 
  Full-batch training loss = 0.702699, test loss = 0.704437
  Training set accuracy = 0.838100, Test set accuracy = 0.834300
 epoch 8/30. Took 0.27728 seconds. 
  Full-batch training loss = 0.624230, test loss = 0.627007
  Training set accuracy = 0.849400, Test set accuracy = 0.847700
 epoch 9/30. Took 0.28883 seconds. 
  Full-batch training loss = 0.564813, test loss = 0.567832
  Training set accuracy = 0.864100, Test set accuracy = 0.861100
 epoch 10/30. Took 0.27539 seconds. 
  Full-batch training loss = 0.521258, test loss = 0.525687
  Training set accuracy = 0.873500, Test set accuracy = 0.870900
 epoch 11/30. Took 0.28633 seconds. 
  Full-batch training loss = 0.481948, test loss = 0.488950
  Training set accuracy = 0.882200, Test set accuracy = 0.878100
 epoch 12/30. Took 0.28643 seconds. 
  Full-batch training loss = 0.453122, test loss = 0.462203
  Training set accuracy = 0.886500, Test set accuracy = 0.882300
 epoch 13/30. Took 0.2861 seconds. 
  Full-batch training loss = 0.431081, test loss = 0.441248
  Training set accuracy = 0.890900, Test set accuracy = 0.884600
 epoch 14/30. Took 0.28653 seconds. 
  Full-batch training loss = 0.407996, test loss = 0.420221
  Training set accuracy = 0.895600, Test set accuracy = 0.888200
 epoch 15/30. Took 0.28505 seconds. 
  Full-batch training loss = 0.391042, test loss = 0.405356
  Training set accuracy = 0.899200, Test set accuracy = 0.893900
 epoch 16/30. Took 0.27139 seconds. 
  Full-batch training loss = 0.375831, test loss = 0.390512
  Training set accuracy = 0.901100, Test set accuracy = 0.896200
 epoch 17/30. Took 0.2848 seconds. 
  Full-batch training loss = 0.363244, test loss = 0.379943
  Training set accuracy = 0.905900, Test set accuracy = 0.900000
 epoch 18/30. Took 0.28275 seconds. 
  Full-batch training loss = 0.353743, test loss = 0.373434
  Training set accuracy = 0.906000, Test set accuracy = 0.899000
 epoch 19/30. Took 0.27177 seconds. 
  Full-batch training loss = 0.341716, test loss = 0.361648
  Training set accuracy = 0.910100, Test set accuracy = 0.899900
 epoch 20/30. Took 0.27953 seconds. 
  Full-batch training loss = 0.331725, test loss = 0.351573
  Training set accuracy = 0.909200, Test set accuracy = 0.902100
 epoch 21/30. Took 0.28651 seconds. 
  Full-batch training loss = 0.320165, test loss = 0.343598
  Training set accuracy = 0.913500, Test set accuracy = 0.903500
 epoch 22/30. Took 0.28663 seconds. 
  Full-batch training loss = 0.311904, test loss = 0.334887
  Training set accuracy = 0.915700, Test set accuracy = 0.906400
 epoch 23/30. Took 0.28633 seconds. 
  Full-batch training loss = 0.302560, test loss = 0.327041
  Training set accuracy = 0.916700, Test set accuracy = 0.907500
 epoch 24/30. Took 0.28615 seconds. 
  Full-batch training loss = 0.297083, test loss = 0.323658
  Training set accuracy = 0.918500, Test set accuracy = 0.908600
 epoch 25/30. Took 0.28654 seconds. 
  Full-batch training loss = 0.289887, test loss = 0.317455
  Training set accuracy = 0.919600, Test set accuracy = 0.910500
 epoch 26/30. Took 0.28049 seconds. 
  Full-batch training loss = 0.283320, test loss = 0.312201
  Training set accuracy = 0.923300, Test set accuracy = 0.912500
 epoch 27/30. Took 0.28126 seconds. 
  Full-batch training loss = 0.278832, test loss = 0.310410
  Training set accuracy = 0.922100, Test set accuracy = 0.910100
 epoch 28/30. Took 0.28079 seconds. 
  Full-batch training loss = 0.273765, test loss = 0.304952
  Training set accuracy = 0.925800, Test set accuracy = 0.911100
 epoch 29/30. Took 0.28535 seconds. 
  Full-batch training loss = 0.266260, test loss = 0.297354
  Training set accuracy = 0.926400, Test set accuracy = 0.914000
 epoch 30/30. Took 0.29919 seconds. 
  Full-batch training loss = 0.261716, test loss = 0.294773
  Training set accuracy = 0.926900, Test set accuracy = 0.914800
Elapsed time is 15.805971 seconds.
End Training
-----
Params 10000 0.010 0.50 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.48805 seconds. 
  Full-batch training loss = 2.216635, test loss = 2.218039
  Training set accuracy = 0.412400, Test set accuracy = 0.405800
 epoch 2/30. Took 0.48522 seconds. 
  Full-batch training loss = 1.985117, test loss = 1.986791
  Training set accuracy = 0.581800, Test set accuracy = 0.571000
 epoch 3/30. Took 0.47633 seconds. 
  Full-batch training loss = 1.524134, test loss = 1.521246
  Training set accuracy = 0.700800, Test set accuracy = 0.699500
 epoch 4/30. Took 0.47046 seconds. 
  Full-batch training loss = 1.074346, test loss = 1.067475
  Training set accuracy = 0.757200, Test set accuracy = 0.757900
 epoch 5/30. Took 0.47268 seconds. 
  Full-batch training loss = 0.830798, test loss = 0.823470
  Training set accuracy = 0.800900, Test set accuracy = 0.799400
 epoch 6/30. Took 0.47092 seconds. 
  Full-batch training loss = 0.699915, test loss = 0.693588
  Training set accuracy = 0.830000, Test set accuracy = 0.825800
 epoch 7/30. Took 0.49414 seconds. 
  Full-batch training loss = 0.608946, test loss = 0.602096
  Training set accuracy = 0.846800, Test set accuracy = 0.846100
 epoch 8/30. Took 0.47128 seconds. 
  Full-batch training loss = 0.549357, test loss = 0.543641
  Training set accuracy = 0.852100, Test set accuracy = 0.852300
 epoch 9/30. Took 0.46681 seconds. 
  Full-batch training loss = 0.502171, test loss = 0.497639
  Training set accuracy = 0.865700, Test set accuracy = 0.867300
 epoch 10/30. Took 0.46839 seconds. 
  Full-batch training loss = 0.465643, test loss = 0.462346
  Training set accuracy = 0.873900, Test set accuracy = 0.876200
 epoch 11/30. Took 0.47317 seconds. 
  Full-batch training loss = 0.436708, test loss = 0.434300
  Training set accuracy = 0.880400, Test set accuracy = 0.881800
 epoch 12/30. Took 0.47104 seconds. 
  Full-batch training loss = 0.415880, test loss = 0.415187
  Training set accuracy = 0.885900, Test set accuracy = 0.884800
 epoch 13/30. Took 0.48407 seconds. 
  Full-batch training loss = 0.395297, test loss = 0.396718
  Training set accuracy = 0.889700, Test set accuracy = 0.890500
 epoch 14/30. Took 0.46779 seconds. 
  Full-batch training loss = 0.377498, test loss = 0.379286
  Training set accuracy = 0.893000, Test set accuracy = 0.893600
 epoch 15/30. Took 0.48426 seconds. 
  Full-batch training loss = 0.364232, test loss = 0.368078
  Training set accuracy = 0.896700, Test set accuracy = 0.896300
 epoch 16/30. Took 0.47227 seconds. 
  Full-batch training loss = 0.351498, test loss = 0.355965
  Training set accuracy = 0.898700, Test set accuracy = 0.898800
 epoch 17/30. Took 0.47498 seconds. 
  Full-batch training loss = 0.338200, test loss = 0.343789
  Training set accuracy = 0.903400, Test set accuracy = 0.903200
 epoch 18/30. Took 0.47291 seconds. 
  Full-batch training loss = 0.329122, test loss = 0.337214
  Training set accuracy = 0.906300, Test set accuracy = 0.903700
 epoch 19/30. Took 0.46939 seconds. 
  Full-batch training loss = 0.319748, test loss = 0.327313
  Training set accuracy = 0.908000, Test set accuracy = 0.905200
 epoch 20/30. Took 0.46805 seconds. 
  Full-batch training loss = 0.311328, test loss = 0.320569
  Training set accuracy = 0.909500, Test set accuracy = 0.907700
 epoch 21/30. Took 0.46902 seconds. 
  Full-batch training loss = 0.302762, test loss = 0.314547
  Training set accuracy = 0.912100, Test set accuracy = 0.908600
 epoch 22/30. Took 0.47091 seconds. 
  Full-batch training loss = 0.293642, test loss = 0.305812
  Training set accuracy = 0.914500, Test set accuracy = 0.910700
 epoch 23/30. Took 0.48798 seconds. 
  Full-batch training loss = 0.286016, test loss = 0.299374
  Training set accuracy = 0.915900, Test set accuracy = 0.913000
 epoch 24/30. Took 0.50071 seconds. 
  Full-batch training loss = 0.280840, test loss = 0.296712
  Training set accuracy = 0.917400, Test set accuracy = 0.914000
 epoch 25/30. Took 0.47159 seconds. 
  Full-batch training loss = 0.271017, test loss = 0.288989
  Training set accuracy = 0.919200, Test set accuracy = 0.917300
 epoch 26/30. Took 0.46717 seconds. 
  Full-batch training loss = 0.265119, test loss = 0.284026
  Training set accuracy = 0.922200, Test set accuracy = 0.918700
 epoch 27/30. Took 0.47819 seconds. 
  Full-batch training loss = 0.258442, test loss = 0.278821
  Training set accuracy = 0.923400, Test set accuracy = 0.918800
 epoch 28/30. Took 0.47091 seconds. 
  Full-batch training loss = 0.252625, test loss = 0.273592
  Training set accuracy = 0.924500, Test set accuracy = 0.920300
 epoch 29/30. Took 0.47122 seconds. 
  Full-batch training loss = 0.246910, test loss = 0.270793
  Training set accuracy = 0.927300, Test set accuracy = 0.921600
 epoch 30/30. Took 0.46423 seconds. 
  Full-batch training loss = 0.242990, test loss = 0.267960
  Training set accuracy = 0.928400, Test set accuracy = 0.920700
Elapsed time is 25.159847 seconds.
End Training
-----
Params 10000 0.010 0.50 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2447 seconds. 
  Full-batch training loss = 2.175980, test loss = 2.174385
  Training set accuracy = 0.501200, Test set accuracy = 0.493800
 epoch 2/30. Took 1.2273 seconds. 
  Full-batch training loss = 1.853604, test loss = 1.847106
  Training set accuracy = 0.683300, Test set accuracy = 0.677700
 epoch 3/30. Took 1.2404 seconds. 
  Full-batch training loss = 1.267463, test loss = 1.252808
  Training set accuracy = 0.745800, Test set accuracy = 0.743600
 epoch 4/30. Took 1.209 seconds. 
  Full-batch training loss = 0.856330, test loss = 0.845687
  Training set accuracy = 0.808700, Test set accuracy = 0.807500
 epoch 5/30. Took 1.2021 seconds. 
  Full-batch training loss = 0.665651, test loss = 0.655668
  Training set accuracy = 0.832800, Test set accuracy = 0.834800
 epoch 6/30. Took 1.2316 seconds. 
  Full-batch training loss = 0.566090, test loss = 0.559883
  Training set accuracy = 0.852800, Test set accuracy = 0.851500
 epoch 7/30. Took 1.2175 seconds. 
  Full-batch training loss = 0.504099, test loss = 0.501408
  Training set accuracy = 0.865800, Test set accuracy = 0.863000
 epoch 8/30. Took 1.1988 seconds. 
  Full-batch training loss = 0.458797, test loss = 0.458372
  Training set accuracy = 0.876000, Test set accuracy = 0.874300
 epoch 9/30. Took 1.198 seconds. 
  Full-batch training loss = 0.425735, test loss = 0.427073
  Training set accuracy = 0.883900, Test set accuracy = 0.881100
 epoch 10/30. Took 1.1998 seconds. 
  Full-batch training loss = 0.403260, test loss = 0.407971
  Training set accuracy = 0.887000, Test set accuracy = 0.885700
 epoch 11/30. Took 1.1993 seconds. 
  Full-batch training loss = 0.380572, test loss = 0.387258
  Training set accuracy = 0.894000, Test set accuracy = 0.891500
 epoch 12/30. Took 1.226 seconds. 
  Full-batch training loss = 0.361700, test loss = 0.369778
  Training set accuracy = 0.899000, Test set accuracy = 0.894000
 epoch 13/30. Took 1.2056 seconds. 
  Full-batch training loss = 0.348504, test loss = 0.357571
  Training set accuracy = 0.901800, Test set accuracy = 0.897500
 epoch 14/30. Took 1.1995 seconds. 
  Full-batch training loss = 0.334198, test loss = 0.346909
  Training set accuracy = 0.906900, Test set accuracy = 0.900400
 epoch 15/30. Took 1.2388 seconds. 
  Full-batch training loss = 0.323708, test loss = 0.336538
  Training set accuracy = 0.906600, Test set accuracy = 0.903100
 epoch 16/30. Took 1.2236 seconds. 
  Full-batch training loss = 0.312494, test loss = 0.327541
  Training set accuracy = 0.911400, Test set accuracy = 0.905900
 epoch 17/30. Took 1.2007 seconds. 
  Full-batch training loss = 0.303960, test loss = 0.319737
  Training set accuracy = 0.912100, Test set accuracy = 0.908000
 epoch 18/30. Took 1.229 seconds. 
  Full-batch training loss = 0.296019, test loss = 0.313372
  Training set accuracy = 0.914200, Test set accuracy = 0.908800
 epoch 19/30. Took 1.1984 seconds. 
  Full-batch training loss = 0.288314, test loss = 0.305689
  Training set accuracy = 0.914000, Test set accuracy = 0.910900
 epoch 20/30. Took 1.2259 seconds. 
  Full-batch training loss = 0.278813, test loss = 0.298506
  Training set accuracy = 0.918100, Test set accuracy = 0.912600
 epoch 21/30. Took 1.2202 seconds. 
  Full-batch training loss = 0.273444, test loss = 0.294635
  Training set accuracy = 0.919100, Test set accuracy = 0.914500
 epoch 22/30. Took 1.2584 seconds. 
  Full-batch training loss = 0.265318, test loss = 0.288431
  Training set accuracy = 0.920200, Test set accuracy = 0.916300
 epoch 23/30. Took 1.2858 seconds. 
  Full-batch training loss = 0.259220, test loss = 0.283123
  Training set accuracy = 0.923700, Test set accuracy = 0.915700
 epoch 24/30. Took 1.2212 seconds. 
  Full-batch training loss = 0.250816, test loss = 0.275694
  Training set accuracy = 0.926300, Test set accuracy = 0.917400
 epoch 25/30. Took 1.2537 seconds. 
  Full-batch training loss = 0.245197, test loss = 0.272236
  Training set accuracy = 0.928000, Test set accuracy = 0.918400
 epoch 26/30. Took 1.199 seconds. 
  Full-batch training loss = 0.240741, test loss = 0.268377
  Training set accuracy = 0.929000, Test set accuracy = 0.920600
 epoch 27/30. Took 1.218 seconds. 
  Full-batch training loss = 0.233553, test loss = 0.263826
  Training set accuracy = 0.931500, Test set accuracy = 0.920500
 epoch 28/30. Took 1.2388 seconds. 
  Full-batch training loss = 0.227776, test loss = 0.258838
  Training set accuracy = 0.933300, Test set accuracy = 0.922700
 epoch 29/30. Took 1.2011 seconds. 
  Full-batch training loss = 0.222858, test loss = 0.254954
  Training set accuracy = 0.933900, Test set accuracy = 0.923400
 epoch 30/30. Took 1.2015 seconds. 
  Full-batch training loss = 0.217820, test loss = 0.251499
  Training set accuracy = 0.935900, Test set accuracy = 0.924800
Elapsed time is 62.594557 seconds.
End Training
-----
Params 10000 0.010 0.50 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.34328 seconds. 
  Full-batch training loss = 2.295388, test loss = 2.295109
  Training set accuracy = 0.141300, Test set accuracy = 0.147400
 epoch 2/30. Took 0.33669 seconds. 
  Full-batch training loss = 2.284296, test loss = 2.284006
  Training set accuracy = 0.152100, Test set accuracy = 0.150600
 epoch 3/30. Took 0.35334 seconds. 
  Full-batch training loss = 2.266321, test loss = 2.265576
  Training set accuracy = 0.279400, Test set accuracy = 0.281800
 epoch 4/30. Took 0.32394 seconds. 
  Full-batch training loss = 2.233893, test loss = 2.232377
  Training set accuracy = 0.444600, Test set accuracy = 0.443900
 epoch 5/30. Took 0.33793 seconds. 
  Full-batch training loss = 2.168301, test loss = 2.165138
  Training set accuracy = 0.529500, Test set accuracy = 0.528200
 epoch 6/30. Took 0.33081 seconds. 
  Full-batch training loss = 2.031385, test loss = 2.025592
  Training set accuracy = 0.526000, Test set accuracy = 0.523300
 epoch 7/30. Took 0.33819 seconds. 
  Full-batch training loss = 1.805513, test loss = 1.797555
  Training set accuracy = 0.511700, Test set accuracy = 0.508200
 epoch 8/30. Took 0.33741 seconds. 
  Full-batch training loss = 1.556283, test loss = 1.548419
  Training set accuracy = 0.574800, Test set accuracy = 0.572100
 epoch 9/30. Took 0.34545 seconds. 
  Full-batch training loss = 1.357246, test loss = 1.353208
  Training set accuracy = 0.610800, Test set accuracy = 0.609300
 epoch 10/30. Took 0.3314 seconds. 
  Full-batch training loss = 1.209831, test loss = 1.208213
  Training set accuracy = 0.651500, Test set accuracy = 0.655700
 epoch 11/30. Took 0.32412 seconds. 
  Full-batch training loss = 1.089051, test loss = 1.090003
  Training set accuracy = 0.676700, Test set accuracy = 0.678400
 epoch 12/30. Took 0.31784 seconds. 
  Full-batch training loss = 0.992251, test loss = 0.992320
  Training set accuracy = 0.722300, Test set accuracy = 0.727300
 epoch 13/30. Took 0.33757 seconds. 
  Full-batch training loss = 0.907089, test loss = 0.907355
  Training set accuracy = 0.759700, Test set accuracy = 0.764400
 epoch 14/30. Took 0.33661 seconds. 
  Full-batch training loss = 0.841863, test loss = 0.842826
  Training set accuracy = 0.772000, Test set accuracy = 0.776900
 epoch 15/30. Took 0.33885 seconds. 
  Full-batch training loss = 0.783767, test loss = 0.786802
  Training set accuracy = 0.770200, Test set accuracy = 0.774500
 epoch 16/30. Took 0.33786 seconds. 
  Full-batch training loss = 0.741740, test loss = 0.745527
  Training set accuracy = 0.772900, Test set accuracy = 0.774000
 epoch 17/30. Took 0.33671 seconds. 
  Full-batch training loss = 0.700276, test loss = 0.703882
  Training set accuracy = 0.812100, Test set accuracy = 0.809500
 epoch 18/30. Took 0.33753 seconds. 
  Full-batch training loss = 0.661326, test loss = 0.667716
  Training set accuracy = 0.824600, Test set accuracy = 0.822100
 epoch 19/30. Took 0.35593 seconds. 
  Full-batch training loss = 0.629457, test loss = 0.636205
  Training set accuracy = 0.837300, Test set accuracy = 0.836000
 epoch 20/30. Took 0.32176 seconds. 
  Full-batch training loss = 0.606032, test loss = 0.614742
  Training set accuracy = 0.838000, Test set accuracy = 0.837000
 epoch 21/30. Took 0.33035 seconds. 
  Full-batch training loss = 0.578700, test loss = 0.588526
  Training set accuracy = 0.845900, Test set accuracy = 0.847500
 epoch 22/30. Took 0.35001 seconds. 
  Full-batch training loss = 0.547561, test loss = 0.559015
  Training set accuracy = 0.857600, Test set accuracy = 0.858800
 epoch 23/30. Took 0.33403 seconds. 
  Full-batch training loss = 0.525492, test loss = 0.535150
  Training set accuracy = 0.865100, Test set accuracy = 0.865700
 epoch 24/30. Took 0.33817 seconds. 
  Full-batch training loss = 0.493267, test loss = 0.507663
  Training set accuracy = 0.871900, Test set accuracy = 0.869700
 epoch 25/30. Took 0.32011 seconds. 
  Full-batch training loss = 0.475932, test loss = 0.493039
  Training set accuracy = 0.876100, Test set accuracy = 0.874200
 epoch 26/30. Took 0.31542 seconds. 
  Full-batch training loss = 0.455279, test loss = 0.473389
  Training set accuracy = 0.881200, Test set accuracy = 0.877500
 epoch 27/30. Took 0.33732 seconds. 
  Full-batch training loss = 0.433871, test loss = 0.451687
  Training set accuracy = 0.886900, Test set accuracy = 0.885400
 epoch 28/30. Took 0.32128 seconds. 
  Full-batch training loss = 0.415230, test loss = 0.433953
  Training set accuracy = 0.891000, Test set accuracy = 0.887600
 epoch 29/30. Took 0.33181 seconds. 
  Full-batch training loss = 0.398346, test loss = 0.421362
  Training set accuracy = 0.896200, Test set accuracy = 0.888400
 epoch 30/30. Took 0.33739 seconds. 
  Full-batch training loss = 0.390485, test loss = 0.414902
  Training set accuracy = 0.897900, Test set accuracy = 0.892400
Elapsed time is 18.155577 seconds.
End Training
-----
Params 10000 0.010 0.50 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.56887 seconds. 
  Full-batch training loss = 2.294830, test loss = 2.294403
  Training set accuracy = 0.100700, Test set accuracy = 0.098000
 epoch 2/30. Took 0.56845 seconds. 
  Full-batch training loss = 2.283762, test loss = 2.283019
  Training set accuracy = 0.278700, Test set accuracy = 0.284100
 epoch 3/30. Took 0.56586 seconds. 
  Full-batch training loss = 2.268092, test loss = 2.266887
  Training set accuracy = 0.360600, Test set accuracy = 0.362500
 epoch 4/30. Took 0.64891 seconds. 
  Full-batch training loss = 2.240442, test loss = 2.238517
  Training set accuracy = 0.435700, Test set accuracy = 0.440100
 epoch 5/30. Took 0.57972 seconds. 
  Full-batch training loss = 2.186095, test loss = 2.182918
  Training set accuracy = 0.493800, Test set accuracy = 0.502000
 epoch 6/30. Took 0.57223 seconds. 
  Full-batch training loss = 2.069208, test loss = 2.063883
  Training set accuracy = 0.497700, Test set accuracy = 0.499700
 epoch 7/30. Took 0.56667 seconds. 
  Full-batch training loss = 1.833729, test loss = 1.824150
  Training set accuracy = 0.560200, Test set accuracy = 0.574500
 epoch 8/30. Took 0.57813 seconds. 
  Full-batch training loss = 1.469998, test loss = 1.451915
  Training set accuracy = 0.621400, Test set accuracy = 0.636000
 epoch 9/30. Took 0.60977 seconds. 
  Full-batch training loss = 1.146833, test loss = 1.127148
  Training set accuracy = 0.672700, Test set accuracy = 0.681400
 epoch 10/30. Took 0.60701 seconds. 
  Full-batch training loss = 0.969319, test loss = 0.952879
  Training set accuracy = 0.706300, Test set accuracy = 0.717200
 epoch 11/30. Took 0.57482 seconds. 
  Full-batch training loss = 0.861192, test loss = 0.844227
  Training set accuracy = 0.739900, Test set accuracy = 0.752500
 epoch 12/30. Took 0.57766 seconds. 
  Full-batch training loss = 0.778399, test loss = 0.760685
  Training set accuracy = 0.772700, Test set accuracy = 0.785400
 epoch 13/30. Took 0.55995 seconds. 
  Full-batch training loss = 0.700887, test loss = 0.687228
  Training set accuracy = 0.793300, Test set accuracy = 0.803900
 epoch 14/30. Took 0.56078 seconds. 
  Full-batch training loss = 0.639418, test loss = 0.628264
  Training set accuracy = 0.814800, Test set accuracy = 0.822400
 epoch 15/30. Took 0.56743 seconds. 
  Full-batch training loss = 0.597683, test loss = 0.589223
  Training set accuracy = 0.820900, Test set accuracy = 0.827300
 epoch 16/30. Took 0.58501 seconds. 
  Full-batch training loss = 0.554195, test loss = 0.548092
  Training set accuracy = 0.836500, Test set accuracy = 0.841700
 epoch 17/30. Took 0.57193 seconds. 
  Full-batch training loss = 0.518025, test loss = 0.513014
  Training set accuracy = 0.851600, Test set accuracy = 0.853800
 epoch 18/30. Took 0.55635 seconds. 
  Full-batch training loss = 0.479275, test loss = 0.477891
  Training set accuracy = 0.865400, Test set accuracy = 0.866800
 epoch 19/30. Took 0.57429 seconds. 
  Full-batch training loss = 0.459574, test loss = 0.456328
  Training set accuracy = 0.866500, Test set accuracy = 0.872400
 epoch 20/30. Took 0.64013 seconds. 
  Full-batch training loss = 0.438814, test loss = 0.439829
  Training set accuracy = 0.870300, Test set accuracy = 0.872400
 epoch 21/30. Took 0.58121 seconds. 
  Full-batch training loss = 0.411273, test loss = 0.413329
  Training set accuracy = 0.883600, Test set accuracy = 0.884200
 epoch 22/30. Took 0.61952 seconds. 
  Full-batch training loss = 0.390875, test loss = 0.394872
  Training set accuracy = 0.888700, Test set accuracy = 0.890900
 epoch 23/30. Took 0.59432 seconds. 
  Full-batch training loss = 0.379366, test loss = 0.388840
  Training set accuracy = 0.889800, Test set accuracy = 0.889100
 epoch 24/30. Took 0.57747 seconds. 
  Full-batch training loss = 0.361330, test loss = 0.369159
  Training set accuracy = 0.897400, Test set accuracy = 0.895500
 epoch 25/30. Took 0.5692 seconds. 
  Full-batch training loss = 0.349019, test loss = 0.359665
  Training set accuracy = 0.900500, Test set accuracy = 0.897200
 epoch 26/30. Took 0.5606 seconds. 
  Full-batch training loss = 0.337453, test loss = 0.352121
  Training set accuracy = 0.902100, Test set accuracy = 0.898400
 epoch 27/30. Took 0.55503 seconds. 
  Full-batch training loss = 0.327361, test loss = 0.341875
  Training set accuracy = 0.906000, Test set accuracy = 0.901400
 epoch 28/30. Took 0.57157 seconds. 
  Full-batch training loss = 0.315529, test loss = 0.334403
  Training set accuracy = 0.908600, Test set accuracy = 0.902500
 epoch 29/30. Took 0.6154 seconds. 
  Full-batch training loss = 0.306864, test loss = 0.323022
  Training set accuracy = 0.910800, Test set accuracy = 0.908100
 epoch 30/30. Took 0.58215 seconds. 
  Full-batch training loss = 0.293099, test loss = 0.310428
  Training set accuracy = 0.915900, Test set accuracy = 0.909400
Elapsed time is 30.783006 seconds.
End Training
-----
Params 10000 0.010 0.50 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.6992 seconds. 
  Full-batch training loss = 2.287208, test loss = 2.287745
  Training set accuracy = 0.161600, Test set accuracy = 0.163800
 epoch 2/30. Took 1.6496 seconds. 
  Full-batch training loss = 2.266860, test loss = 2.267143
  Training set accuracy = 0.330000, Test set accuracy = 0.340400
 epoch 3/30. Took 1.6568 seconds. 
  Full-batch training loss = 2.228107, test loss = 2.227988
  Training set accuracy = 0.436800, Test set accuracy = 0.436900
 epoch 4/30. Took 1.6589 seconds. 
  Full-batch training loss = 2.139702, test loss = 2.138432
  Training set accuracy = 0.459300, Test set accuracy = 0.447200
 epoch 5/30. Took 1.6693 seconds. 
  Full-batch training loss = 1.925715, test loss = 1.921332
  Training set accuracy = 0.522500, Test set accuracy = 0.508600
 epoch 6/30. Took 1.6471 seconds. 
  Full-batch training loss = 1.551616, test loss = 1.542891
  Training set accuracy = 0.645600, Test set accuracy = 0.648400
 epoch 7/30. Took 1.6779 seconds. 
  Full-batch training loss = 1.194922, test loss = 1.183546
  Training set accuracy = 0.730400, Test set accuracy = 0.733600
 epoch 8/30. Took 1.717 seconds. 
  Full-batch training loss = 0.913090, test loss = 0.904629
  Training set accuracy = 0.754000, Test set accuracy = 0.764500
 epoch 9/30. Took 1.686 seconds. 
  Full-batch training loss = 0.736826, test loss = 0.732639
  Training set accuracy = 0.786000, Test set accuracy = 0.795500
 epoch 10/30. Took 1.6715 seconds. 
  Full-batch training loss = 0.631188, test loss = 0.630111
  Training set accuracy = 0.820600, Test set accuracy = 0.825300
 epoch 11/30. Took 1.6603 seconds. 
  Full-batch training loss = 0.568356, test loss = 0.571414
  Training set accuracy = 0.828000, Test set accuracy = 0.833600
 epoch 12/30. Took 1.7132 seconds. 
  Full-batch training loss = 0.513294, test loss = 0.518484
  Training set accuracy = 0.848700, Test set accuracy = 0.853100
 epoch 13/30. Took 1.6763 seconds. 
  Full-batch training loss = 0.474516, test loss = 0.477372
  Training set accuracy = 0.860300, Test set accuracy = 0.863900
 epoch 14/30. Took 1.6699 seconds. 
  Full-batch training loss = 0.443986, test loss = 0.453575
  Training set accuracy = 0.868300, Test set accuracy = 0.869300
 epoch 15/30. Took 1.7955 seconds. 
  Full-batch training loss = 0.417263, test loss = 0.429326
  Training set accuracy = 0.879300, Test set accuracy = 0.876500
 epoch 16/30. Took 1.6539 seconds. 
  Full-batch training loss = 0.398241, test loss = 0.412503
  Training set accuracy = 0.882900, Test set accuracy = 0.880100
 epoch 17/30. Took 1.6605 seconds. 
  Full-batch training loss = 0.378515, test loss = 0.396591
  Training set accuracy = 0.888200, Test set accuracy = 0.884700
 epoch 18/30. Took 1.6979 seconds. 
  Full-batch training loss = 0.364002, test loss = 0.380005
  Training set accuracy = 0.893100, Test set accuracy = 0.888200
 epoch 19/30. Took 1.7013 seconds. 
  Full-batch training loss = 0.346222, test loss = 0.368658
  Training set accuracy = 0.896700, Test set accuracy = 0.891500
 epoch 20/30. Took 1.6856 seconds. 
  Full-batch training loss = 0.331304, test loss = 0.353724
  Training set accuracy = 0.900900, Test set accuracy = 0.895700
 epoch 21/30. Took 1.6576 seconds. 
  Full-batch training loss = 0.319610, test loss = 0.343271
  Training set accuracy = 0.904500, Test set accuracy = 0.899000
 epoch 22/30. Took 1.6594 seconds. 
  Full-batch training loss = 0.308238, test loss = 0.334816
  Training set accuracy = 0.908900, Test set accuracy = 0.901200
 epoch 23/30. Took 1.6576 seconds. 
  Full-batch training loss = 0.299014, test loss = 0.326399
  Training set accuracy = 0.911900, Test set accuracy = 0.903500
 epoch 24/30. Took 1.6859 seconds. 
  Full-batch training loss = 0.287188, test loss = 0.316122
  Training set accuracy = 0.914400, Test set accuracy = 0.905500
 epoch 25/30. Took 1.6967 seconds. 
  Full-batch training loss = 0.283707, test loss = 0.314694
  Training set accuracy = 0.915800, Test set accuracy = 0.906200
 epoch 26/30. Took 1.6585 seconds. 
  Full-batch training loss = 0.269947, test loss = 0.302337
  Training set accuracy = 0.918800, Test set accuracy = 0.908600
 epoch 27/30. Took 1.7044 seconds. 
  Full-batch training loss = 0.263996, test loss = 0.299492
  Training set accuracy = 0.920200, Test set accuracy = 0.910100
 epoch 28/30. Took 1.6581 seconds. 
  Full-batch training loss = 0.252094, test loss = 0.288738
  Training set accuracy = 0.923900, Test set accuracy = 0.914100
 epoch 29/30. Took 1.8384 seconds. 
  Full-batch training loss = 0.245932, test loss = 0.282099
  Training set accuracy = 0.925400, Test set accuracy = 0.915500
 epoch 30/30. Took 1.6567 seconds. 
  Full-batch training loss = 0.235630, test loss = 0.273944
  Training set accuracy = 0.929500, Test set accuracy = 0.917500
Elapsed time is 86.400628 seconds.
End Training
-----
Params 10000 0.001 0.00 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.21676 seconds. 
  Full-batch training loss = 2.101447, test loss = 2.101138
  Training set accuracy = 0.430800, Test set accuracy = 0.429900
 epoch 2/30. Took 0.20489 seconds. 
  Full-batch training loss = 1.872687, test loss = 1.869437
  Training set accuracy = 0.594400, Test set accuracy = 0.600100
 epoch 3/30. Took 0.21012 seconds. 
  Full-batch training loss = 1.644723, test loss = 1.637141
  Training set accuracy = 0.672100, Test set accuracy = 0.686800
 epoch 4/30. Took 0.20565 seconds. 
  Full-batch training loss = 1.434262, test loss = 1.423336
  Training set accuracy = 0.713600, Test set accuracy = 0.724000
 epoch 5/30. Took 0.20123 seconds. 
  Full-batch training loss = 1.253080, test loss = 1.239484
  Training set accuracy = 0.746200, Test set accuracy = 0.755800
 epoch 6/30. Took 0.20546 seconds. 
  Full-batch training loss = 1.105402, test loss = 1.089361
  Training set accuracy = 0.782200, Test set accuracy = 0.791400
 epoch 7/30. Took 0.20535 seconds. 
  Full-batch training loss = 0.988428, test loss = 0.970979
  Training set accuracy = 0.804800, Test set accuracy = 0.812300
 epoch 8/30. Took 0.20659 seconds. 
  Full-batch training loss = 0.896501, test loss = 0.878223
  Training set accuracy = 0.821000, Test set accuracy = 0.826300
 epoch 9/30. Took 0.2059 seconds. 
  Full-batch training loss = 0.823291, test loss = 0.804743
  Training set accuracy = 0.831100, Test set accuracy = 0.834500
 epoch 10/30. Took 0.20292 seconds. 
  Full-batch training loss = 0.764555, test loss = 0.745751
  Training set accuracy = 0.840000, Test set accuracy = 0.844200
 epoch 11/30. Took 0.20618 seconds. 
  Full-batch training loss = 0.716873, test loss = 0.698527
  Training set accuracy = 0.847400, Test set accuracy = 0.851400
 epoch 12/30. Took 0.20591 seconds. 
  Full-batch training loss = 0.677343, test loss = 0.659233
  Training set accuracy = 0.851600, Test set accuracy = 0.856400
 epoch 13/30. Took 0.20355 seconds. 
  Full-batch training loss = 0.644090, test loss = 0.626372
  Training set accuracy = 0.855400, Test set accuracy = 0.859700
 epoch 14/30. Took 0.20594 seconds. 
  Full-batch training loss = 0.615902, test loss = 0.598572
  Training set accuracy = 0.858200, Test set accuracy = 0.862000
 epoch 15/30. Took 0.22209 seconds. 
  Full-batch training loss = 0.591445, test loss = 0.574498
  Training set accuracy = 0.863200, Test set accuracy = 0.867200
 epoch 16/30. Took 0.20448 seconds. 
  Full-batch training loss = 0.570210, test loss = 0.553841
  Training set accuracy = 0.865100, Test set accuracy = 0.868600
 epoch 17/30. Took 0.20694 seconds. 
  Full-batch training loss = 0.551572, test loss = 0.535527
  Training set accuracy = 0.867300, Test set accuracy = 0.871300
 epoch 18/30. Took 0.2099 seconds. 
  Full-batch training loss = 0.534994, test loss = 0.519674
  Training set accuracy = 0.870100, Test set accuracy = 0.873700
 epoch 19/30. Took 0.20665 seconds. 
  Full-batch training loss = 0.520415, test loss = 0.505374
  Training set accuracy = 0.873500, Test set accuracy = 0.875200
 epoch 20/30. Took 0.21113 seconds. 
  Full-batch training loss = 0.507012, test loss = 0.492526
  Training set accuracy = 0.875200, Test set accuracy = 0.877700
 epoch 21/30. Took 0.20924 seconds. 
  Full-batch training loss = 0.495072, test loss = 0.481063
  Training set accuracy = 0.877300, Test set accuracy = 0.879400
 epoch 22/30. Took 0.20815 seconds. 
  Full-batch training loss = 0.484152, test loss = 0.470386
  Training set accuracy = 0.879200, Test set accuracy = 0.882100
 epoch 23/30. Took 0.20494 seconds. 
  Full-batch training loss = 0.474329, test loss = 0.461330
  Training set accuracy = 0.882000, Test set accuracy = 0.883700
 epoch 24/30. Took 0.20612 seconds. 
  Full-batch training loss = 0.465128, test loss = 0.452250
  Training set accuracy = 0.881900, Test set accuracy = 0.884500
 epoch 25/30. Took 0.22028 seconds. 
  Full-batch training loss = 0.456886, test loss = 0.444933
  Training set accuracy = 0.885500, Test set accuracy = 0.885900
 epoch 26/30. Took 0.21709 seconds. 
  Full-batch training loss = 0.449100, test loss = 0.437652
  Training set accuracy = 0.886200, Test set accuracy = 0.887300
 epoch 27/30. Took 0.20935 seconds. 
  Full-batch training loss = 0.441926, test loss = 0.430247
  Training set accuracy = 0.885400, Test set accuracy = 0.887900
 epoch 28/30. Took 0.20459 seconds. 
  Full-batch training loss = 0.435057, test loss = 0.424174
  Training set accuracy = 0.889900, Test set accuracy = 0.889300
 epoch 29/30. Took 0.20557 seconds. 
  Full-batch training loss = 0.428717, test loss = 0.418113
  Training set accuracy = 0.889200, Test set accuracy = 0.890000
 epoch 30/30. Took 0.2051 seconds. 
  Full-batch training loss = 0.422807, test loss = 0.412664
  Training set accuracy = 0.890100, Test set accuracy = 0.891300
Elapsed time is 12.452743 seconds.
End Training
-----
Params 10000 0.001 0.00 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.31618 seconds. 
  Full-batch training loss = 2.067512, test loss = 2.061745
  Training set accuracy = 0.475700, Test set accuracy = 0.483500
 epoch 2/30. Took 0.31688 seconds. 
  Full-batch training loss = 1.813011, test loss = 1.802705
  Training set accuracy = 0.702900, Test set accuracy = 0.706900
 epoch 3/30. Took 0.32067 seconds. 
  Full-batch training loss = 1.563919, test loss = 1.549005
  Training set accuracy = 0.754500, Test set accuracy = 0.757300
 epoch 4/30. Took 0.31537 seconds. 
  Full-batch training loss = 1.340587, test loss = 1.321893
  Training set accuracy = 0.784300, Test set accuracy = 0.789500
 epoch 5/30. Took 0.31224 seconds. 
  Full-batch training loss = 1.158808, test loss = 1.138004
  Training set accuracy = 0.799800, Test set accuracy = 0.807600
 epoch 6/30. Took 0.31413 seconds. 
  Full-batch training loss = 1.018967, test loss = 0.996935
  Training set accuracy = 0.814200, Test set accuracy = 0.823800
 epoch 7/30. Took 0.33656 seconds. 
  Full-batch training loss = 0.912557, test loss = 0.889489
  Training set accuracy = 0.827200, Test set accuracy = 0.835600
 epoch 8/30. Took 0.31417 seconds. 
  Full-batch training loss = 0.831066, test loss = 0.807680
  Training set accuracy = 0.834100, Test set accuracy = 0.844500
 epoch 9/30. Took 0.31407 seconds. 
  Full-batch training loss = 0.766932, test loss = 0.744016
  Training set accuracy = 0.839400, Test set accuracy = 0.849400
 epoch 10/30. Took 0.32888 seconds. 
  Full-batch training loss = 0.715801, test loss = 0.693184
  Training set accuracy = 0.845900, Test set accuracy = 0.855400
 epoch 11/30. Took 0.31642 seconds. 
  Full-batch training loss = 0.673883, test loss = 0.651289
  Training set accuracy = 0.851300, Test set accuracy = 0.861600
 epoch 12/30. Took 0.31557 seconds. 
  Full-batch training loss = 0.639180, test loss = 0.617069
  Training set accuracy = 0.856000, Test set accuracy = 0.865000
 epoch 13/30. Took 0.3168 seconds. 
  Full-batch training loss = 0.609944, test loss = 0.588375
  Training set accuracy = 0.858300, Test set accuracy = 0.866800
 epoch 14/30. Took 0.31321 seconds. 
  Full-batch training loss = 0.584799, test loss = 0.563550
  Training set accuracy = 0.863300, Test set accuracy = 0.871800
 epoch 15/30. Took 0.31128 seconds. 
  Full-batch training loss = 0.563120, test loss = 0.542662
  Training set accuracy = 0.865100, Test set accuracy = 0.874000
 epoch 16/30. Took 0.32108 seconds. 
  Full-batch training loss = 0.544067, test loss = 0.523989
  Training set accuracy = 0.869000, Test set accuracy = 0.876300
 epoch 17/30. Took 0.31474 seconds. 
  Full-batch training loss = 0.527304, test loss = 0.507793
  Training set accuracy = 0.871500, Test set accuracy = 0.878600
 epoch 18/30. Took 0.31372 seconds. 
  Full-batch training loss = 0.512479, test loss = 0.493317
  Training set accuracy = 0.872600, Test set accuracy = 0.880700
 epoch 19/30. Took 0.31543 seconds. 
  Full-batch training loss = 0.498950, test loss = 0.480395
  Training set accuracy = 0.875100, Test set accuracy = 0.882800
 epoch 20/30. Took 0.32074 seconds. 
  Full-batch training loss = 0.486863, test loss = 0.469027
  Training set accuracy = 0.877100, Test set accuracy = 0.884800
 epoch 21/30. Took 0.31721 seconds. 
  Full-batch training loss = 0.475924, test loss = 0.458691
  Training set accuracy = 0.877800, Test set accuracy = 0.886600
 epoch 22/30. Took 0.31058 seconds. 
  Full-batch training loss = 0.465922, test loss = 0.448943
  Training set accuracy = 0.879100, Test set accuracy = 0.887700
 epoch 23/30. Took 0.3142 seconds. 
  Full-batch training loss = 0.456633, test loss = 0.440517
  Training set accuracy = 0.881300, Test set accuracy = 0.889000
 epoch 24/30. Took 0.32965 seconds. 
  Full-batch training loss = 0.448304, test loss = 0.432480
  Training set accuracy = 0.883200, Test set accuracy = 0.890200
 epoch 25/30. Took 0.31598 seconds. 
  Full-batch training loss = 0.440421, test loss = 0.425250
  Training set accuracy = 0.883800, Test set accuracy = 0.890900
 epoch 26/30. Took 0.32481 seconds. 
  Full-batch training loss = 0.433115, test loss = 0.418781
  Training set accuracy = 0.886100, Test set accuracy = 0.892800
 epoch 27/30. Took 0.31708 seconds. 
  Full-batch training loss = 0.426505, test loss = 0.412557
  Training set accuracy = 0.886200, Test set accuracy = 0.894000
 epoch 28/30. Took 0.31349 seconds. 
  Full-batch training loss = 0.420178, test loss = 0.407402
  Training set accuracy = 0.887800, Test set accuracy = 0.894600
 epoch 29/30. Took 0.31568 seconds. 
  Full-batch training loss = 0.414269, test loss = 0.401938
  Training set accuracy = 0.888900, Test set accuracy = 0.895800
 epoch 30/30. Took 0.34539 seconds. 
  Full-batch training loss = 0.408801, test loss = 0.397461
  Training set accuracy = 0.890000, Test set accuracy = 0.897400
Elapsed time is 17.551458 seconds.
End Training
-----
Params 10000 0.001 0.00 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.73538 seconds. 
  Full-batch training loss = 2.014730, test loss = 2.007151
  Training set accuracy = 0.530800, Test set accuracy = 0.527800
 epoch 2/30. Took 0.65015 seconds. 
  Full-batch training loss = 1.721826, test loss = 1.709452
  Training set accuracy = 0.697200, Test set accuracy = 0.700800
 epoch 3/30. Took 0.65037 seconds. 
  Full-batch training loss = 1.462233, test loss = 1.446264
  Training set accuracy = 0.752000, Test set accuracy = 0.756800
 epoch 4/30. Took 0.65518 seconds. 
  Full-batch training loss = 1.248270, test loss = 1.229791
  Training set accuracy = 0.788100, Test set accuracy = 0.792100
 epoch 5/30. Took 0.65616 seconds. 
  Full-batch training loss = 1.081538, test loss = 1.062490
  Training set accuracy = 0.809700, Test set accuracy = 0.811300
 epoch 6/30. Took 0.65599 seconds. 
  Full-batch training loss = 0.955216, test loss = 0.936571
  Training set accuracy = 0.826200, Test set accuracy = 0.826300
 epoch 7/30. Took 0.64674 seconds. 
  Full-batch training loss = 0.858611, test loss = 0.840753
  Training set accuracy = 0.838700, Test set accuracy = 0.836700
 epoch 8/30. Took 0.65183 seconds. 
  Full-batch training loss = 0.784262, test loss = 0.767411
  Training set accuracy = 0.846500, Test set accuracy = 0.844900
 epoch 9/30. Took 0.66101 seconds. 
  Full-batch training loss = 0.725629, test loss = 0.709602
  Training set accuracy = 0.853600, Test set accuracy = 0.852300
 epoch 10/30. Took 0.68556 seconds. 
  Full-batch training loss = 0.678609, test loss = 0.663828
  Training set accuracy = 0.858400, Test set accuracy = 0.857000
 epoch 11/30. Took 0.64847 seconds. 
  Full-batch training loss = 0.640002, test loss = 0.626188
  Training set accuracy = 0.862400, Test set accuracy = 0.861300
 epoch 12/30. Took 0.65043 seconds. 
  Full-batch training loss = 0.607849, test loss = 0.595082
  Training set accuracy = 0.867000, Test set accuracy = 0.865700
 epoch 13/30. Took 0.66982 seconds. 
  Full-batch training loss = 0.580624, test loss = 0.568634
  Training set accuracy = 0.869100, Test set accuracy = 0.869500
 epoch 14/30. Took 0.65376 seconds. 
  Full-batch training loss = 0.557225, test loss = 0.546240
  Training set accuracy = 0.872700, Test set accuracy = 0.872700
 epoch 15/30. Took 0.65169 seconds. 
  Full-batch training loss = 0.536899, test loss = 0.526751
  Training set accuracy = 0.875900, Test set accuracy = 0.875000
 epoch 16/30. Took 0.6727 seconds. 
  Full-batch training loss = 0.519271, test loss = 0.509519
  Training set accuracy = 0.878000, Test set accuracy = 0.876900
 epoch 17/30. Took 0.65123 seconds. 
  Full-batch training loss = 0.503602, test loss = 0.495015
  Training set accuracy = 0.880800, Test set accuracy = 0.881000
 epoch 18/30. Took 0.65275 seconds. 
  Full-batch training loss = 0.489583, test loss = 0.481841
  Training set accuracy = 0.881500, Test set accuracy = 0.881600
 epoch 19/30. Took 0.64742 seconds. 
  Full-batch training loss = 0.476985, test loss = 0.469465
  Training set accuracy = 0.882900, Test set accuracy = 0.884100
 epoch 20/30. Took 0.65288 seconds. 
  Full-batch training loss = 0.465642, test loss = 0.459270
  Training set accuracy = 0.886800, Test set accuracy = 0.885400
 epoch 21/30. Took 0.64825 seconds. 
  Full-batch training loss = 0.455334, test loss = 0.449733
  Training set accuracy = 0.887700, Test set accuracy = 0.886600
 epoch 22/30. Took 0.66067 seconds. 
  Full-batch training loss = 0.445969, test loss = 0.440654
  Training set accuracy = 0.889600, Test set accuracy = 0.887900
 epoch 23/30. Took 0.66886 seconds. 
  Full-batch training loss = 0.437550, test loss = 0.432985
  Training set accuracy = 0.892400, Test set accuracy = 0.889300
 epoch 24/30. Took 0.65005 seconds. 
  Full-batch training loss = 0.429440, test loss = 0.425625
  Training set accuracy = 0.892900, Test set accuracy = 0.890800
 epoch 25/30. Took 0.64856 seconds. 
  Full-batch training loss = 0.421956, test loss = 0.418628
  Training set accuracy = 0.893900, Test set accuracy = 0.891500
 epoch 26/30. Took 0.66912 seconds. 
  Full-batch training loss = 0.415201, test loss = 0.411968
  Training set accuracy = 0.894500, Test set accuracy = 0.892400
 epoch 27/30. Took 0.66173 seconds. 
  Full-batch training loss = 0.408746, test loss = 0.406299
  Training set accuracy = 0.895400, Test set accuracy = 0.893700
 epoch 28/30. Took 0.68837 seconds. 
  Full-batch training loss = 0.402755, test loss = 0.400757
  Training set accuracy = 0.896700, Test set accuracy = 0.894800
 epoch 29/30. Took 0.64942 seconds. 
  Full-batch training loss = 0.397130, test loss = 0.395939
  Training set accuracy = 0.897100, Test set accuracy = 0.896200
 epoch 30/30. Took 0.65571 seconds. 
  Full-batch training loss = 0.392021, test loss = 0.391601
  Training set accuracy = 0.899100, Test set accuracy = 0.897300
Elapsed time is 34.801972 seconds.
End Training
-----
Params 10000 0.001 0.00 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.24636 seconds. 
  Full-batch training loss = 2.195197, test loss = 2.198101
  Training set accuracy = 0.238000, Test set accuracy = 0.239100
 epoch 2/30. Took 0.23007 seconds. 
  Full-batch training loss = 2.043942, test loss = 2.041575
  Training set accuracy = 0.487400, Test set accuracy = 0.488500
 epoch 3/30. Took 0.23615 seconds. 
  Full-batch training loss = 1.850639, test loss = 1.842335
  Training set accuracy = 0.615700, Test set accuracy = 0.623300
 epoch 4/30. Took 0.23595 seconds. 
  Full-batch training loss = 1.616617, test loss = 1.602080
  Training set accuracy = 0.684700, Test set accuracy = 0.692400
 epoch 5/30. Took 0.23533 seconds. 
  Full-batch training loss = 1.373716, test loss = 1.353361
  Training set accuracy = 0.737500, Test set accuracy = 0.744100
 epoch 6/30. Took 0.23348 seconds. 
  Full-batch training loss = 1.163016, test loss = 1.139795
  Training set accuracy = 0.769500, Test set accuracy = 0.773800
 epoch 7/30. Took 0.23191 seconds. 
  Full-batch training loss = 0.997777, test loss = 0.972908
  Training set accuracy = 0.790300, Test set accuracy = 0.796800
 epoch 8/30. Took 0.23068 seconds. 
  Full-batch training loss = 0.874571, test loss = 0.849780
  Training set accuracy = 0.811900, Test set accuracy = 0.814700
 epoch 9/30. Took 0.23426 seconds. 
  Full-batch training loss = 0.782702, test loss = 0.760217
  Training set accuracy = 0.822400, Test set accuracy = 0.827100
 epoch 10/30. Took 0.23557 seconds. 
  Full-batch training loss = 0.712229, test loss = 0.689984
  Training set accuracy = 0.836800, Test set accuracy = 0.838500
 epoch 11/30. Took 0.23589 seconds. 
  Full-batch training loss = 0.657330, test loss = 0.637457
  Training set accuracy = 0.843400, Test set accuracy = 0.848800
 epoch 12/30. Took 0.23708 seconds. 
  Full-batch training loss = 0.613591, test loss = 0.594317
  Training set accuracy = 0.851400, Test set accuracy = 0.856000
 epoch 13/30. Took 0.23884 seconds. 
  Full-batch training loss = 0.577315, test loss = 0.560168
  Training set accuracy = 0.856900, Test set accuracy = 0.860300
 epoch 14/30. Took 0.24064 seconds. 
  Full-batch training loss = 0.546859, test loss = 0.531645
  Training set accuracy = 0.863700, Test set accuracy = 0.866000
 epoch 15/30. Took 0.23066 seconds. 
  Full-batch training loss = 0.521779, test loss = 0.507770
  Training set accuracy = 0.866800, Test set accuracy = 0.870200
 epoch 16/30. Took 0.23017 seconds. 
  Full-batch training loss = 0.500039, test loss = 0.487122
  Training set accuracy = 0.871800, Test set accuracy = 0.874400
 epoch 17/30. Took 0.24661 seconds. 
  Full-batch training loss = 0.480977, test loss = 0.469812
  Training set accuracy = 0.876100, Test set accuracy = 0.876600
 epoch 18/30. Took 0.25209 seconds. 
  Full-batch training loss = 0.464379, test loss = 0.453779
  Training set accuracy = 0.879600, Test set accuracy = 0.882000
 epoch 19/30. Took 0.24502 seconds. 
  Full-batch training loss = 0.450069, test loss = 0.440306
  Training set accuracy = 0.882200, Test set accuracy = 0.884200
 epoch 20/30. Took 0.24681 seconds. 
  Full-batch training loss = 0.437141, test loss = 0.429285
  Training set accuracy = 0.886300, Test set accuracy = 0.887100
 epoch 21/30. Took 0.25489 seconds. 
  Full-batch training loss = 0.425465, test loss = 0.419373
  Training set accuracy = 0.888700, Test set accuracy = 0.887600
 epoch 22/30. Took 0.23086 seconds. 
  Full-batch training loss = 0.414924, test loss = 0.408717
  Training set accuracy = 0.889400, Test set accuracy = 0.890400
 epoch 23/30. Took 0.24021 seconds. 
  Full-batch training loss = 0.405529, test loss = 0.401029
  Training set accuracy = 0.892200, Test set accuracy = 0.893500
 epoch 24/30. Took 0.2366 seconds. 
  Full-batch training loss = 0.397138, test loss = 0.393112
  Training set accuracy = 0.892900, Test set accuracy = 0.894800
 epoch 25/30. Took 0.23418 seconds. 
  Full-batch training loss = 0.388563, test loss = 0.385756
  Training set accuracy = 0.895200, Test set accuracy = 0.894500
 epoch 26/30. Took 0.23749 seconds. 
  Full-batch training loss = 0.381211, test loss = 0.379851
  Training set accuracy = 0.898000, Test set accuracy = 0.896600
 epoch 27/30. Took 0.23683 seconds. 
  Full-batch training loss = 0.374392, test loss = 0.373595
  Training set accuracy = 0.898200, Test set accuracy = 0.898200
 epoch 28/30. Took 0.23869 seconds. 
  Full-batch training loss = 0.368371, test loss = 0.368334
  Training set accuracy = 0.901400, Test set accuracy = 0.899400
 epoch 29/30. Took 0.23671 seconds. 
  Full-batch training loss = 0.362269, test loss = 0.363528
  Training set accuracy = 0.901500, Test set accuracy = 0.900400
 epoch 30/30. Took 0.23691 seconds. 
  Full-batch training loss = 0.356977, test loss = 0.359038
  Training set accuracy = 0.902000, Test set accuracy = 0.901700
Elapsed time is 14.067925 seconds.
End Training
-----
Params 10000 0.001 0.00 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.40198 seconds. 
  Full-batch training loss = 2.184095, test loss = 2.182497
  Training set accuracy = 0.335700, Test set accuracy = 0.331100
 epoch 2/30. Took 0.39877 seconds. 
  Full-batch training loss = 2.031534, test loss = 2.026709
  Training set accuracy = 0.572800, Test set accuracy = 0.574000
 epoch 3/30. Took 0.42408 seconds. 
  Full-batch training loss = 1.837373, test loss = 1.830059
  Training set accuracy = 0.672400, Test set accuracy = 0.670200
 epoch 4/30. Took 0.43915 seconds. 
  Full-batch training loss = 1.601704, test loss = 1.592037
  Training set accuracy = 0.730600, Test set accuracy = 0.731500
 epoch 5/30. Took 0.39075 seconds. 
  Full-batch training loss = 1.354732, test loss = 1.342537
  Training set accuracy = 0.771800, Test set accuracy = 0.776400
 epoch 6/30. Took 0.39311 seconds. 
  Full-batch training loss = 1.138361, test loss = 1.124086
  Training set accuracy = 0.795300, Test set accuracy = 0.801700
 epoch 7/30. Took 0.4039 seconds. 
  Full-batch training loss = 0.970339, test loss = 0.954485
  Training set accuracy = 0.813700, Test set accuracy = 0.820600
 epoch 8/30. Took 0.39912 seconds. 
  Full-batch training loss = 0.847128, test loss = 0.830997
  Training set accuracy = 0.822700, Test set accuracy = 0.830200
 epoch 9/30. Took 0.39636 seconds. 
  Full-batch training loss = 0.756685, test loss = 0.739905
  Training set accuracy = 0.835300, Test set accuracy = 0.839600
 epoch 10/30. Took 0.40676 seconds. 
  Full-batch training loss = 0.689121, test loss = 0.672359
  Training set accuracy = 0.842700, Test set accuracy = 0.847500
 epoch 11/30. Took 0.39155 seconds. 
  Full-batch training loss = 0.636719, test loss = 0.620514
  Training set accuracy = 0.850300, Test set accuracy = 0.853200
 epoch 12/30. Took 0.38974 seconds. 
  Full-batch training loss = 0.595524, test loss = 0.580497
  Training set accuracy = 0.855300, Test set accuracy = 0.861700
 epoch 13/30. Took 0.39365 seconds. 
  Full-batch training loss = 0.560614, test loss = 0.544937
  Training set accuracy = 0.860200, Test set accuracy = 0.865700
 epoch 14/30. Took 0.39921 seconds. 
  Full-batch training loss = 0.532489, test loss = 0.517530
  Training set accuracy = 0.866700, Test set accuracy = 0.873400
 epoch 15/30. Took 0.41122 seconds. 
  Full-batch training loss = 0.507904, test loss = 0.494438
  Training set accuracy = 0.870400, Test set accuracy = 0.875500
 epoch 16/30. Took 0.40979 seconds. 
  Full-batch training loss = 0.487222, test loss = 0.473676
  Training set accuracy = 0.872700, Test set accuracy = 0.880000
 epoch 17/30. Took 0.40929 seconds. 
  Full-batch training loss = 0.469259, test loss = 0.457299
  Training set accuracy = 0.877100, Test set accuracy = 0.882400
 epoch 18/30. Took 0.3953 seconds. 
  Full-batch training loss = 0.454092, test loss = 0.443031
  Training set accuracy = 0.880800, Test set accuracy = 0.884900
 epoch 19/30. Took 0.3985 seconds. 
  Full-batch training loss = 0.440421, test loss = 0.430138
  Training set accuracy = 0.883800, Test set accuracy = 0.888200
 epoch 20/30. Took 0.3997 seconds. 
  Full-batch training loss = 0.427737, test loss = 0.418422
  Training set accuracy = 0.885300, Test set accuracy = 0.891100
 epoch 21/30. Took 0.40112 seconds. 
  Full-batch training loss = 0.417056, test loss = 0.408461
  Training set accuracy = 0.887400, Test set accuracy = 0.891700
 epoch 22/30. Took 0.41157 seconds. 
  Full-batch training loss = 0.406933, test loss = 0.399168
  Training set accuracy = 0.888900, Test set accuracy = 0.893600
 epoch 23/30. Took 0.40092 seconds. 
  Full-batch training loss = 0.398791, test loss = 0.393018
  Training set accuracy = 0.890600, Test set accuracy = 0.895400
 epoch 24/30. Took 0.43307 seconds. 
  Full-batch training loss = 0.389586, test loss = 0.384182
  Training set accuracy = 0.892500, Test set accuracy = 0.896400
 epoch 25/30. Took 0.39673 seconds. 
  Full-batch training loss = 0.382710, test loss = 0.377844
  Training set accuracy = 0.893800, Test set accuracy = 0.896600
 epoch 26/30. Took 0.39172 seconds. 
  Full-batch training loss = 0.375469, test loss = 0.372491
  Training set accuracy = 0.895900, Test set accuracy = 0.897400
 epoch 27/30. Took 0.39706 seconds. 
  Full-batch training loss = 0.369450, test loss = 0.366960
  Training set accuracy = 0.895100, Test set accuracy = 0.899100
 epoch 28/30. Took 0.41276 seconds. 
  Full-batch training loss = 0.362955, test loss = 0.360271
  Training set accuracy = 0.896800, Test set accuracy = 0.901100
 epoch 29/30. Took 0.39889 seconds. 
  Full-batch training loss = 0.357528, test loss = 0.355692
  Training set accuracy = 0.898300, Test set accuracy = 0.901600
 epoch 30/30. Took 0.40004 seconds. 
  Full-batch training loss = 0.352161, test loss = 0.352411
  Training set accuracy = 0.899400, Test set accuracy = 0.901800
Elapsed time is 21.780680 seconds.
End Training
-----
Params 10000 0.001 0.00 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.0774 seconds. 
  Full-batch training loss = 2.123886, test loss = 2.118143
  Training set accuracy = 0.500800, Test set accuracy = 0.510900
 epoch 2/30. Took 1.0527 seconds. 
  Full-batch training loss = 1.916167, test loss = 1.903794
  Training set accuracy = 0.665600, Test set accuracy = 0.680000
 epoch 3/30. Took 1.0443 seconds. 
  Full-batch training loss = 1.670463, test loss = 1.650879
  Training set accuracy = 0.714600, Test set accuracy = 0.729100
 epoch 4/30. Took 1.0434 seconds. 
  Full-batch training loss = 1.409240, test loss = 1.382613
  Training set accuracy = 0.758100, Test set accuracy = 0.770500
 epoch 5/30. Took 1.0419 seconds. 
  Full-batch training loss = 1.177746, test loss = 1.146059
  Training set accuracy = 0.784900, Test set accuracy = 0.800200
 epoch 6/30. Took 1.0445 seconds. 
  Full-batch training loss = 0.998597, test loss = 0.964894
  Training set accuracy = 0.806800, Test set accuracy = 0.819800
 epoch 7/30. Took 1.0487 seconds. 
  Full-batch training loss = 0.866581, test loss = 0.832935
  Training set accuracy = 0.824700, Test set accuracy = 0.835500
 epoch 8/30. Took 1.1174 seconds. 
  Full-batch training loss = 0.770386, test loss = 0.736281
  Training set accuracy = 0.831800, Test set accuracy = 0.844900
 epoch 9/30. Took 1.0476 seconds. 
  Full-batch training loss = 0.697435, test loss = 0.664558
  Training set accuracy = 0.847900, Test set accuracy = 0.855800
 epoch 10/30. Took 1.0445 seconds. 
  Full-batch training loss = 0.642478, test loss = 0.611085
  Training set accuracy = 0.852800, Test set accuracy = 0.861300
 epoch 11/30. Took 1.0445 seconds. 
  Full-batch training loss = 0.597836, test loss = 0.566694
  Training set accuracy = 0.861500, Test set accuracy = 0.868800
 epoch 12/30. Took 1.1444 seconds. 
  Full-batch training loss = 0.562710, test loss = 0.533207
  Training set accuracy = 0.868000, Test set accuracy = 0.875400
 epoch 13/30. Took 1.0424 seconds. 
  Full-batch training loss = 0.532995, test loss = 0.503665
  Training set accuracy = 0.873100, Test set accuracy = 0.878100
 epoch 14/30. Took 1.0634 seconds. 
  Full-batch training loss = 0.508094, test loss = 0.479983
  Training set accuracy = 0.876300, Test set accuracy = 0.881500
 epoch 15/30. Took 1.0653 seconds. 
  Full-batch training loss = 0.487758, test loss = 0.461001
  Training set accuracy = 0.880700, Test set accuracy = 0.883700
 epoch 16/30. Took 1.0479 seconds. 
  Full-batch training loss = 0.469082, test loss = 0.443263
  Training set accuracy = 0.884600, Test set accuracy = 0.886600
 epoch 17/30. Took 1.0798 seconds. 
  Full-batch training loss = 0.453183, test loss = 0.428478
  Training set accuracy = 0.886700, Test set accuracy = 0.891100
 epoch 18/30. Took 1.0444 seconds. 
  Full-batch training loss = 0.439846, test loss = 0.416975
  Training set accuracy = 0.888400, Test set accuracy = 0.892100
 epoch 19/30. Took 1.0526 seconds. 
  Full-batch training loss = 0.427205, test loss = 0.404567
  Training set accuracy = 0.891500, Test set accuracy = 0.894500
 epoch 20/30. Took 1.045 seconds. 
  Full-batch training loss = 0.415751, test loss = 0.394649
  Training set accuracy = 0.894800, Test set accuracy = 0.895300
 epoch 21/30. Took 1.0441 seconds. 
  Full-batch training loss = 0.405875, test loss = 0.385767
  Training set accuracy = 0.895600, Test set accuracy = 0.898100
 epoch 22/30. Took 1.0635 seconds. 
  Full-batch training loss = 0.396957, test loss = 0.378263
  Training set accuracy = 0.897500, Test set accuracy = 0.899800
 epoch 23/30. Took 1.0425 seconds. 
  Full-batch training loss = 0.388985, test loss = 0.371364
  Training set accuracy = 0.900000, Test set accuracy = 0.901100
 epoch 24/30. Took 1.0622 seconds. 
  Full-batch training loss = 0.380980, test loss = 0.364270
  Training set accuracy = 0.900600, Test set accuracy = 0.902400
 epoch 25/30. Took 1.056 seconds. 
  Full-batch training loss = 0.374031, test loss = 0.358645
  Training set accuracy = 0.902600, Test set accuracy = 0.903200
 epoch 26/30. Took 1.0548 seconds. 
  Full-batch training loss = 0.367863, test loss = 0.353409
  Training set accuracy = 0.904000, Test set accuracy = 0.904200
 epoch 27/30. Took 1.0412 seconds. 
  Full-batch training loss = 0.361425, test loss = 0.348194
  Training set accuracy = 0.904500, Test set accuracy = 0.904900
 epoch 28/30. Took 1.043 seconds. 
  Full-batch training loss = 0.356394, test loss = 0.344142
  Training set accuracy = 0.905200, Test set accuracy = 0.905800
 epoch 29/30. Took 1.0397 seconds. 
  Full-batch training loss = 0.351105, test loss = 0.339920
  Training set accuracy = 0.906100, Test set accuracy = 0.908000
 epoch 30/30. Took 1.0629 seconds. 
  Full-batch training loss = 0.345609, test loss = 0.335193
  Training set accuracy = 0.907400, Test set accuracy = 0.908100
Elapsed time is 55.402892 seconds.
End Training
-----
Params 10000 0.001 0.00 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28145 seconds. 
  Full-batch training loss = 2.245272, test loss = 2.242247
  Training set accuracy = 0.296800, Test set accuracy = 0.298300
 epoch 2/30. Took 0.26308 seconds. 
  Full-batch training loss = 2.163571, test loss = 2.160109
  Training set accuracy = 0.361400, Test set accuracy = 0.365300
 epoch 3/30. Took 0.26382 seconds. 
  Full-batch training loss = 2.047753, test loss = 2.044297
  Training set accuracy = 0.392100, Test set accuracy = 0.389500
 epoch 4/30. Took 0.27185 seconds. 
  Full-batch training loss = 1.888898, test loss = 1.884466
  Training set accuracy = 0.436400, Test set accuracy = 0.429600
 epoch 5/30. Took 0.25794 seconds. 
  Full-batch training loss = 1.693781, test loss = 1.686670
  Training set accuracy = 0.537900, Test set accuracy = 0.531700
 epoch 6/30. Took 0.27625 seconds. 
  Full-batch training loss = 1.477868, test loss = 1.466893
  Training set accuracy = 0.689400, Test set accuracy = 0.696000
 epoch 7/30. Took 0.2567 seconds. 
  Full-batch training loss = 1.262294, test loss = 1.248775
  Training set accuracy = 0.753400, Test set accuracy = 0.759500
 epoch 8/30. Took 0.25311 seconds. 
  Full-batch training loss = 1.070689, test loss = 1.056128
  Training set accuracy = 0.778800, Test set accuracy = 0.787700
 epoch 9/30. Took 0.25338 seconds. 
  Full-batch training loss = 0.917580, test loss = 0.901960
  Training set accuracy = 0.799700, Test set accuracy = 0.806800
 epoch 10/30. Took 0.25749 seconds. 
  Full-batch training loss = 0.801041, test loss = 0.785533
  Training set accuracy = 0.815800, Test set accuracy = 0.818500
 epoch 11/30. Took 0.25791 seconds. 
  Full-batch training loss = 0.714246, test loss = 0.698544
  Training set accuracy = 0.830000, Test set accuracy = 0.832900
 epoch 12/30. Took 0.26278 seconds. 
  Full-batch training loss = 0.648850, test loss = 0.634053
  Training set accuracy = 0.839100, Test set accuracy = 0.841800
 epoch 13/30. Took 0.25339 seconds. 
  Full-batch training loss = 0.599237, test loss = 0.586301
  Training set accuracy = 0.848900, Test set accuracy = 0.852600
 epoch 14/30. Took 0.26027 seconds. 
  Full-batch training loss = 0.557989, test loss = 0.544647
  Training set accuracy = 0.859400, Test set accuracy = 0.860500
 epoch 15/30. Took 0.25926 seconds. 
  Full-batch training loss = 0.525998, test loss = 0.514557
  Training set accuracy = 0.862500, Test set accuracy = 0.865000
 epoch 16/30. Took 0.26639 seconds. 
  Full-batch training loss = 0.498790, test loss = 0.488256
  Training set accuracy = 0.871300, Test set accuracy = 0.872100
 epoch 17/30. Took 0.26316 seconds. 
  Full-batch training loss = 0.477008, test loss = 0.466900
  Training set accuracy = 0.873600, Test set accuracy = 0.876000
 epoch 18/30. Took 0.26101 seconds. 
  Full-batch training loss = 0.458809, test loss = 0.449679
  Training set accuracy = 0.879000, Test set accuracy = 0.878800
 epoch 19/30. Took 0.26335 seconds. 
  Full-batch training loss = 0.441755, test loss = 0.434590
  Training set accuracy = 0.881400, Test set accuracy = 0.881900
 epoch 20/30. Took 0.26154 seconds. 
  Full-batch training loss = 0.427818, test loss = 0.422442
  Training set accuracy = 0.883000, Test set accuracy = 0.885700
 epoch 21/30. Took 0.26245 seconds. 
  Full-batch training loss = 0.414953, test loss = 0.409997
  Training set accuracy = 0.885400, Test set accuracy = 0.884800
 epoch 22/30. Took 0.26265 seconds. 
  Full-batch training loss = 0.404350, test loss = 0.400165
  Training set accuracy = 0.888900, Test set accuracy = 0.889800
 epoch 23/30. Took 0.25575 seconds. 
  Full-batch training loss = 0.393216, test loss = 0.390707
  Training set accuracy = 0.890700, Test set accuracy = 0.890400
 epoch 24/30. Took 0.2535 seconds. 
  Full-batch training loss = 0.383626, test loss = 0.382196
  Training set accuracy = 0.892600, Test set accuracy = 0.890800
 epoch 25/30. Took 0.26277 seconds. 
  Full-batch training loss = 0.377227, test loss = 0.375685
  Training set accuracy = 0.893500, Test set accuracy = 0.895200
 epoch 26/30. Took 0.26164 seconds. 
  Full-batch training loss = 0.369092, test loss = 0.370231
  Training set accuracy = 0.895400, Test set accuracy = 0.894600
 epoch 27/30. Took 0.26284 seconds. 
  Full-batch training loss = 0.361138, test loss = 0.363178
  Training set accuracy = 0.899200, Test set accuracy = 0.896200
 epoch 28/30. Took 0.2663 seconds. 
  Full-batch training loss = 0.354856, test loss = 0.356932
  Training set accuracy = 0.901000, Test set accuracy = 0.897100
 epoch 29/30. Took 0.28415 seconds. 
  Full-batch training loss = 0.350016, test loss = 0.354875
  Training set accuracy = 0.903000, Test set accuracy = 0.897300
 epoch 30/30. Took 0.25186 seconds. 
  Full-batch training loss = 0.344180, test loss = 0.349272
  Training set accuracy = 0.902100, Test set accuracy = 0.899400
Elapsed time is 15.533881 seconds.
End Training
-----
Params 10000 0.001 0.00 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.53102 seconds. 
  Full-batch training loss = 2.238266, test loss = 2.236325
  Training set accuracy = 0.309100, Test set accuracy = 0.307000
 epoch 2/30. Took 0.45692 seconds. 
  Full-batch training loss = 2.151930, test loss = 2.148647
  Training set accuracy = 0.431800, Test set accuracy = 0.434400
 epoch 3/30. Took 0.46788 seconds. 
  Full-batch training loss = 2.035924, test loss = 2.030921
  Training set accuracy = 0.521500, Test set accuracy = 0.524000
 epoch 4/30. Took 0.46369 seconds. 
  Full-batch training loss = 1.874883, test loss = 1.867543
  Training set accuracy = 0.606500, Test set accuracy = 0.614100
 epoch 5/30. Took 0.46529 seconds. 
  Full-batch training loss = 1.662310, test loss = 1.651523
  Training set accuracy = 0.665500, Test set accuracy = 0.679400
 epoch 6/30. Took 0.45567 seconds. 
  Full-batch training loss = 1.413717, test loss = 1.398598
  Training set accuracy = 0.715300, Test set accuracy = 0.730200
 epoch 7/30. Took 0.46749 seconds. 
  Full-batch training loss = 1.174272, test loss = 1.156250
  Training set accuracy = 0.752700, Test set accuracy = 0.771700
 epoch 8/30. Took 0.48801 seconds. 
  Full-batch training loss = 0.981974, test loss = 0.961811
  Training set accuracy = 0.797800, Test set accuracy = 0.809700
 epoch 9/30. Took 0.46591 seconds. 
  Full-batch training loss = 0.841668, test loss = 0.822880
  Training set accuracy = 0.814400, Test set accuracy = 0.823700
 epoch 10/30. Took 0.51621 seconds. 
  Full-batch training loss = 0.741465, test loss = 0.723383
  Training set accuracy = 0.827000, Test set accuracy = 0.834100
 epoch 11/30. Took 0.46771 seconds. 
  Full-batch training loss = 0.666211, test loss = 0.649052
  Training set accuracy = 0.835500, Test set accuracy = 0.843600
 epoch 12/30. Took 0.49091 seconds. 
  Full-batch training loss = 0.609235, test loss = 0.593634
  Training set accuracy = 0.846000, Test set accuracy = 0.851300
 epoch 13/30. Took 0.46704 seconds. 
  Full-batch training loss = 0.565156, test loss = 0.551288
  Training set accuracy = 0.856900, Test set accuracy = 0.860100
 epoch 14/30. Took 0.46633 seconds. 
  Full-batch training loss = 0.529935, test loss = 0.518062
  Training set accuracy = 0.863800, Test set accuracy = 0.866300
 epoch 15/30. Took 0.45986 seconds. 
  Full-batch training loss = 0.500936, test loss = 0.490383
  Training set accuracy = 0.870700, Test set accuracy = 0.872400
 epoch 16/30. Took 0.45677 seconds. 
  Full-batch training loss = 0.476496, test loss = 0.468475
  Training set accuracy = 0.873900, Test set accuracy = 0.876100
 epoch 17/30. Took 0.45429 seconds. 
  Full-batch training loss = 0.456521, test loss = 0.449512
  Training set accuracy = 0.878000, Test set accuracy = 0.879600
 epoch 18/30. Took 0.46375 seconds. 
  Full-batch training loss = 0.439096, test loss = 0.434204
  Training set accuracy = 0.883000, Test set accuracy = 0.881300
 epoch 19/30. Took 0.45718 seconds. 
  Full-batch training loss = 0.424849, test loss = 0.421062
  Training set accuracy = 0.885200, Test set accuracy = 0.883900
 epoch 20/30. Took 0.51162 seconds. 
  Full-batch training loss = 0.409833, test loss = 0.407998
  Training set accuracy = 0.888600, Test set accuracy = 0.888900
 epoch 21/30. Took 0.46119 seconds. 
  Full-batch training loss = 0.401299, test loss = 0.400921
  Training set accuracy = 0.889800, Test set accuracy = 0.888700
 epoch 22/30. Took 0.45647 seconds. 
  Full-batch training loss = 0.388973, test loss = 0.389390
  Training set accuracy = 0.892700, Test set accuracy = 0.890200
 epoch 23/30. Took 0.46361 seconds. 
  Full-batch training loss = 0.378847, test loss = 0.380785
  Training set accuracy = 0.896300, Test set accuracy = 0.894300
 epoch 24/30. Took 0.48537 seconds. 
  Full-batch training loss = 0.369100, test loss = 0.372575
  Training set accuracy = 0.898600, Test set accuracy = 0.895600
 epoch 25/30. Took 0.46584 seconds. 
  Full-batch training loss = 0.361806, test loss = 0.366839
  Training set accuracy = 0.898700, Test set accuracy = 0.897200
 epoch 26/30. Took 0.46663 seconds. 
  Full-batch training loss = 0.354353, test loss = 0.359920
  Training set accuracy = 0.901400, Test set accuracy = 0.898300
 epoch 27/30. Took 0.46673 seconds. 
  Full-batch training loss = 0.347878, test loss = 0.354826
  Training set accuracy = 0.902800, Test set accuracy = 0.898900
 epoch 28/30. Took 0.46638 seconds. 
  Full-batch training loss = 0.342159, test loss = 0.350668
  Training set accuracy = 0.903700, Test set accuracy = 0.900500
 epoch 29/30. Took 0.46786 seconds. 
  Full-batch training loss = 0.336023, test loss = 0.346376
  Training set accuracy = 0.907800, Test set accuracy = 0.902000
 epoch 30/30. Took 0.46788 seconds. 
  Full-batch training loss = 0.330299, test loss = 0.341929
  Training set accuracy = 0.908100, Test set accuracy = 0.903200
Elapsed time is 27.335358 seconds.
End Training
-----
Params 10000 0.001 0.00 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.4304 seconds. 
  Full-batch training loss = 2.180915, test loss = 2.180978
  Training set accuracy = 0.435100, Test set accuracy = 0.425600
 epoch 2/30. Took 1.4753 seconds. 
  Full-batch training loss = 2.030285, test loss = 2.029151
  Training set accuracy = 0.608300, Test set accuracy = 0.616400
 epoch 3/30. Took 1.4252 seconds. 
  Full-batch training loss = 1.817598, test loss = 1.814285
  Training set accuracy = 0.698400, Test set accuracy = 0.703100
 epoch 4/30. Took 1.4814 seconds. 
  Full-batch training loss = 1.529998, test loss = 1.522472
  Training set accuracy = 0.757800, Test set accuracy = 0.765600
 epoch 5/30. Took 1.4199 seconds. 
  Full-batch training loss = 1.216079, test loss = 1.204887
  Training set accuracy = 0.790900, Test set accuracy = 0.799400
 epoch 6/30. Took 1.429 seconds. 
  Full-batch training loss = 0.962686, test loss = 0.949725
  Training set accuracy = 0.813900, Test set accuracy = 0.816600
 epoch 7/30. Took 1.4187 seconds. 
  Full-batch training loss = 0.792641, test loss = 0.780205
  Training set accuracy = 0.836100, Test set accuracy = 0.838200
 epoch 8/30. Took 1.4192 seconds. 
  Full-batch training loss = 0.680929, test loss = 0.669651
  Training set accuracy = 0.847500, Test set accuracy = 0.849500
 epoch 9/30. Took 1.4193 seconds. 
  Full-batch training loss = 0.605104, test loss = 0.595588
  Training set accuracy = 0.855300, Test set accuracy = 0.857600
 epoch 10/30. Took 1.4286 seconds. 
  Full-batch training loss = 0.548966, test loss = 0.541031
  Training set accuracy = 0.862100, Test set accuracy = 0.865800
 epoch 11/30. Took 1.4236 seconds. 
  Full-batch training loss = 0.507552, test loss = 0.501278
  Training set accuracy = 0.869200, Test set accuracy = 0.871800
 epoch 12/30. Took 1.4252 seconds. 
  Full-batch training loss = 0.474615, test loss = 0.470242
  Training set accuracy = 0.877500, Test set accuracy = 0.879400
 epoch 13/30. Took 1.4755 seconds. 
  Full-batch training loss = 0.448932, test loss = 0.446180
  Training set accuracy = 0.881700, Test set accuracy = 0.883500
 epoch 14/30. Took 1.4784 seconds. 
  Full-batch training loss = 0.427035, test loss = 0.425769
  Training set accuracy = 0.885600, Test set accuracy = 0.888100
 epoch 15/30. Took 1.4276 seconds. 
  Full-batch training loss = 0.408943, test loss = 0.409245
  Training set accuracy = 0.889700, Test set accuracy = 0.890200
 epoch 16/30. Took 1.448 seconds. 
  Full-batch training loss = 0.393576, test loss = 0.396342
  Training set accuracy = 0.893400, Test set accuracy = 0.893300
 epoch 17/30. Took 1.4564 seconds. 
  Full-batch training loss = 0.379899, test loss = 0.383968
  Training set accuracy = 0.897600, Test set accuracy = 0.895100
 epoch 18/30. Took 1.4242 seconds. 
  Full-batch training loss = 0.367945, test loss = 0.373850
  Training set accuracy = 0.900900, Test set accuracy = 0.896700
 epoch 19/30. Took 1.4248 seconds. 
  Full-batch training loss = 0.358488, test loss = 0.364833
  Training set accuracy = 0.899200, Test set accuracy = 0.896500
 epoch 20/30. Took 1.4554 seconds. 
  Full-batch training loss = 0.348483, test loss = 0.356787
  Training set accuracy = 0.904100, Test set accuracy = 0.898700
 epoch 21/30. Took 1.4194 seconds. 
  Full-batch training loss = 0.340041, test loss = 0.350496
  Training set accuracy = 0.906200, Test set accuracy = 0.899700
 epoch 22/30. Took 1.4455 seconds. 
  Full-batch training loss = 0.332010, test loss = 0.344725
  Training set accuracy = 0.908100, Test set accuracy = 0.901500
 epoch 23/30. Took 1.4224 seconds. 
  Full-batch training loss = 0.325502, test loss = 0.338315
  Training set accuracy = 0.909800, Test set accuracy = 0.902200
 epoch 24/30. Took 1.4224 seconds. 
  Full-batch training loss = 0.318633, test loss = 0.333663
  Training set accuracy = 0.910300, Test set accuracy = 0.903600
 epoch 25/30. Took 1.4206 seconds. 
  Full-batch training loss = 0.311656, test loss = 0.327518
  Training set accuracy = 0.911500, Test set accuracy = 0.905700
 epoch 26/30. Took 1.4279 seconds. 
  Full-batch training loss = 0.306862, test loss = 0.324849
  Training set accuracy = 0.913600, Test set accuracy = 0.906300
 epoch 27/30. Took 1.4284 seconds. 
  Full-batch training loss = 0.301757, test loss = 0.320097
  Training set accuracy = 0.915200, Test set accuracy = 0.908200
 epoch 28/30. Took 1.4189 seconds. 
  Full-batch training loss = 0.297392, test loss = 0.316676
  Training set accuracy = 0.914100, Test set accuracy = 0.908600
 epoch 29/30. Took 1.4238 seconds. 
  Full-batch training loss = 0.290933, test loss = 0.312171
  Training set accuracy = 0.916800, Test set accuracy = 0.908800
 epoch 30/30. Took 1.4258 seconds. 
  Full-batch training loss = 0.286788, test loss = 0.308452
  Training set accuracy = 0.917500, Test set accuracy = 0.910100
Elapsed time is 75.659419 seconds.
End Training
-----
Params 10000 0.001 0.10 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23047 seconds. 
  Full-batch training loss = 2.107445, test loss = 2.105070
  Training set accuracy = 0.422300, Test set accuracy = 0.426100
 epoch 2/30. Took 0.23193 seconds. 
  Full-batch training loss = 1.890036, test loss = 1.884814
  Training set accuracy = 0.587500, Test set accuracy = 0.601000
 epoch 3/30. Took 0.23211 seconds. 
  Full-batch training loss = 1.678522, test loss = 1.670123
  Training set accuracy = 0.672900, Test set accuracy = 0.677800
 epoch 4/30. Took 0.23522 seconds. 
  Full-batch training loss = 1.485361, test loss = 1.474987
  Training set accuracy = 0.722400, Test set accuracy = 0.722800
 epoch 5/30. Took 0.22722 seconds. 
  Full-batch training loss = 1.316891, test loss = 1.305214
  Training set accuracy = 0.759200, Test set accuracy = 0.762000
 epoch 6/30. Took 0.24699 seconds. 
  Full-batch training loss = 1.174267, test loss = 1.161967
  Training set accuracy = 0.781700, Test set accuracy = 0.784900
 epoch 7/30. Took 0.22971 seconds. 
  Full-batch training loss = 1.056951, test loss = 1.044144
  Training set accuracy = 0.801000, Test set accuracy = 0.806200
 epoch 8/30. Took 0.23491 seconds. 
  Full-batch training loss = 0.961246, test loss = 0.948650
  Training set accuracy = 0.814400, Test set accuracy = 0.819700
 epoch 9/30. Took 0.23132 seconds. 
  Full-batch training loss = 0.883123, test loss = 0.870497
  Training set accuracy = 0.824000, Test set accuracy = 0.828600
 epoch 10/30. Took 0.23382 seconds. 
  Full-batch training loss = 0.818840, test loss = 0.806597
  Training set accuracy = 0.834600, Test set accuracy = 0.839300
 epoch 11/30. Took 0.23239 seconds. 
  Full-batch training loss = 0.765850, test loss = 0.754308
  Training set accuracy = 0.841200, Test set accuracy = 0.844900
 epoch 12/30. Took 0.23145 seconds. 
  Full-batch training loss = 0.721526, test loss = 0.710351
  Training set accuracy = 0.846400, Test set accuracy = 0.849900
 epoch 13/30. Took 0.23235 seconds. 
  Full-batch training loss = 0.684053, test loss = 0.673354
  Training set accuracy = 0.853400, Test set accuracy = 0.856500
 epoch 14/30. Took 0.23169 seconds. 
  Full-batch training loss = 0.652191, test loss = 0.642370
  Training set accuracy = 0.857800, Test set accuracy = 0.861000
 epoch 15/30. Took 0.23066 seconds. 
  Full-batch training loss = 0.624751, test loss = 0.615578
  Training set accuracy = 0.859900, Test set accuracy = 0.862800
 epoch 16/30. Took 0.23072 seconds. 
  Full-batch training loss = 0.600527, test loss = 0.591731
  Training set accuracy = 0.865400, Test set accuracy = 0.866200
 epoch 17/30. Took 0.23126 seconds. 
  Full-batch training loss = 0.579338, test loss = 0.571267
  Training set accuracy = 0.868500, Test set accuracy = 0.868800
 epoch 18/30. Took 0.23061 seconds. 
  Full-batch training loss = 0.560371, test loss = 0.552985
  Training set accuracy = 0.872000, Test set accuracy = 0.870700
 epoch 19/30. Took 0.23589 seconds. 
  Full-batch training loss = 0.543795, test loss = 0.536907
  Training set accuracy = 0.875800, Test set accuracy = 0.873200
 epoch 20/30. Took 0.24381 seconds. 
  Full-batch training loss = 0.528732, test loss = 0.522326
  Training set accuracy = 0.876800, Test set accuracy = 0.875300
 epoch 21/30. Took 0.24216 seconds. 
  Full-batch training loss = 0.515378, test loss = 0.509580
  Training set accuracy = 0.877000, Test set accuracy = 0.875500
 epoch 22/30. Took 0.2316 seconds. 
  Full-batch training loss = 0.502827, test loss = 0.497538
  Training set accuracy = 0.879700, Test set accuracy = 0.877900
 epoch 23/30. Took 0.23176 seconds. 
  Full-batch training loss = 0.491703, test loss = 0.486954
  Training set accuracy = 0.881600, Test set accuracy = 0.879600
 epoch 24/30. Took 0.23127 seconds. 
  Full-batch training loss = 0.481422, test loss = 0.477055
  Training set accuracy = 0.882500, Test set accuracy = 0.880500
 epoch 25/30. Took 0.2339 seconds. 
  Full-batch training loss = 0.471925, test loss = 0.468047
  Training set accuracy = 0.884800, Test set accuracy = 0.882300
 epoch 26/30. Took 0.22849 seconds. 
  Full-batch training loss = 0.463276, test loss = 0.459950
  Training set accuracy = 0.885100, Test set accuracy = 0.883400
 epoch 27/30. Took 0.23155 seconds. 
  Full-batch training loss = 0.455032, test loss = 0.452270
  Training set accuracy = 0.887200, Test set accuracy = 0.885200
 epoch 28/30. Took 0.22768 seconds. 
  Full-batch training loss = 0.447551, test loss = 0.445444
  Training set accuracy = 0.887800, Test set accuracy = 0.886200
 epoch 29/30. Took 0.24733 seconds. 
  Full-batch training loss = 0.440549, test loss = 0.439191
  Training set accuracy = 0.889200, Test set accuracy = 0.887100
 epoch 30/30. Took 0.22358 seconds. 
  Full-batch training loss = 0.433936, test loss = 0.432935
  Training set accuracy = 0.889600, Test set accuracy = 0.888000
Elapsed time is 13.346075 seconds.
End Training
-----
Params 10000 0.001 0.10 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35207 seconds. 
  Full-batch training loss = 2.118152, test loss = 2.117627
  Training set accuracy = 0.417200, Test set accuracy = 0.412900
 epoch 2/30. Took 0.35591 seconds. 
  Full-batch training loss = 1.915213, test loss = 1.910606
  Training set accuracy = 0.629100, Test set accuracy = 0.632000
 epoch 3/30. Took 0.35169 seconds. 
  Full-batch training loss = 1.705884, test loss = 1.697854
  Training set accuracy = 0.715800, Test set accuracy = 0.714500
 epoch 4/30. Took 0.37974 seconds. 
  Full-batch training loss = 1.505568, test loss = 1.494868
  Training set accuracy = 0.753100, Test set accuracy = 0.757700
 epoch 5/30. Took 0.3791 seconds. 
  Full-batch training loss = 1.327345, test loss = 1.314405
  Training set accuracy = 0.780100, Test set accuracy = 0.787100
 epoch 6/30. Took 0.34925 seconds. 
  Full-batch training loss = 1.177328, test loss = 1.163217
  Training set accuracy = 0.798400, Test set accuracy = 0.806800
 epoch 7/30. Took 0.40051 seconds. 
  Full-batch training loss = 1.054753, test loss = 1.039717
  Training set accuracy = 0.810900, Test set accuracy = 0.819500
 epoch 8/30. Took 0.35064 seconds. 
  Full-batch training loss = 0.956114, test loss = 0.940787
  Training set accuracy = 0.821500, Test set accuracy = 0.829500
 epoch 9/30. Took 0.35804 seconds. 
  Full-batch training loss = 0.876770, test loss = 0.861373
  Training set accuracy = 0.831300, Test set accuracy = 0.836800
 epoch 10/30. Took 0.35097 seconds. 
  Full-batch training loss = 0.812316, test loss = 0.796895
  Training set accuracy = 0.839200, Test set accuracy = 0.844500
 epoch 11/30. Took 0.34988 seconds. 
  Full-batch training loss = 0.759766, test loss = 0.744639
  Training set accuracy = 0.843800, Test set accuracy = 0.849000
 epoch 12/30. Took 0.37128 seconds. 
  Full-batch training loss = 0.715916, test loss = 0.701252
  Training set accuracy = 0.850500, Test set accuracy = 0.853500
 epoch 13/30. Took 0.3509 seconds. 
  Full-batch training loss = 0.679130, test loss = 0.665149
  Training set accuracy = 0.854700, Test set accuracy = 0.857100
 epoch 14/30. Took 0.37578 seconds. 
  Full-batch training loss = 0.647677, test loss = 0.633682
  Training set accuracy = 0.857700, Test set accuracy = 0.861700
 epoch 15/30. Took 0.36359 seconds. 
  Full-batch training loss = 0.620848, test loss = 0.607449
  Training set accuracy = 0.861900, Test set accuracy = 0.866200
 epoch 16/30. Took 0.35096 seconds. 
  Full-batch training loss = 0.597242, test loss = 0.584115
  Training set accuracy = 0.863600, Test set accuracy = 0.868800
 epoch 17/30. Took 0.34937 seconds. 
  Full-batch training loss = 0.576620, test loss = 0.563702
  Training set accuracy = 0.867800, Test set accuracy = 0.870800
 epoch 18/30. Took 0.35278 seconds. 
  Full-batch training loss = 0.558440, test loss = 0.545981
  Training set accuracy = 0.869200, Test set accuracy = 0.873200
 epoch 19/30. Took 0.34836 seconds. 
  Full-batch training loss = 0.542180, test loss = 0.530251
  Training set accuracy = 0.872000, Test set accuracy = 0.875300
 epoch 20/30. Took 0.35356 seconds. 
  Full-batch training loss = 0.527595, test loss = 0.515922
  Training set accuracy = 0.874100, Test set accuracy = 0.877400
 epoch 21/30. Took 0.38439 seconds. 
  Full-batch training loss = 0.514452, test loss = 0.503188
  Training set accuracy = 0.875000, Test set accuracy = 0.877700
 epoch 22/30. Took 0.34945 seconds. 
  Full-batch training loss = 0.502508, test loss = 0.491705
  Training set accuracy = 0.876400, Test set accuracy = 0.880100
 epoch 23/30. Took 0.35206 seconds. 
  Full-batch training loss = 0.491573, test loss = 0.481145
  Training set accuracy = 0.877900, Test set accuracy = 0.882100
 epoch 24/30. Took 0.3499 seconds. 
  Full-batch training loss = 0.481586, test loss = 0.471514
  Training set accuracy = 0.880400, Test set accuracy = 0.882300
 epoch 25/30. Took 0.3518 seconds. 
  Full-batch training loss = 0.472406, test loss = 0.462593
  Training set accuracy = 0.882000, Test set accuracy = 0.883500
 epoch 26/30. Took 0.35021 seconds. 
  Full-batch training loss = 0.463928, test loss = 0.454472
  Training set accuracy = 0.883500, Test set accuracy = 0.885700
 epoch 27/30. Took 0.39696 seconds. 
  Full-batch training loss = 0.456226, test loss = 0.446974
  Training set accuracy = 0.884900, Test set accuracy = 0.886300
 epoch 28/30. Took 0.34852 seconds. 
  Full-batch training loss = 0.448924, test loss = 0.440230
  Training set accuracy = 0.886200, Test set accuracy = 0.888400
 epoch 29/30. Took 0.35083 seconds. 
  Full-batch training loss = 0.442105, test loss = 0.433623
  Training set accuracy = 0.887100, Test set accuracy = 0.888900
 epoch 30/30. Took 0.34801 seconds. 
  Full-batch training loss = 0.435581, test loss = 0.427501
  Training set accuracy = 0.887700, Test set accuracy = 0.890200
Elapsed time is 19.388789 seconds.
End Training
-----
Params 10000 0.001 0.10 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.76917 seconds. 
  Full-batch training loss = 2.056454, test loss = 2.055454
  Training set accuracy = 0.539800, Test set accuracy = 0.535900
 epoch 2/30. Took 0.72679 seconds. 
  Full-batch training loss = 1.813895, test loss = 1.809910
  Training set accuracy = 0.696300, Test set accuracy = 0.698900
 epoch 3/30. Took 0.73292 seconds. 
  Full-batch training loss = 1.587022, test loss = 1.579025
  Training set accuracy = 0.747700, Test set accuracy = 0.752000
 epoch 4/30. Took 0.72652 seconds. 
  Full-batch training loss = 1.384233, test loss = 1.372651
  Training set accuracy = 0.774800, Test set accuracy = 0.786200
 epoch 5/30. Took 0.76686 seconds. 
  Full-batch training loss = 1.213696, test loss = 1.199510
  Training set accuracy = 0.793200, Test set accuracy = 0.804600
 epoch 6/30. Took 0.73138 seconds. 
  Full-batch training loss = 1.076412, test loss = 1.060495
  Training set accuracy = 0.808300, Test set accuracy = 0.819500
 epoch 7/30. Took 0.73388 seconds. 
  Full-batch training loss = 0.967841, test loss = 0.951059
  Training set accuracy = 0.821200, Test set accuracy = 0.831300
 epoch 8/30. Took 0.73626 seconds. 
  Full-batch training loss = 0.881563, test loss = 0.864299
  Training set accuracy = 0.832300, Test set accuracy = 0.840500
 epoch 9/30. Took 0.7424 seconds. 
  Full-batch training loss = 0.812972, test loss = 0.795838
  Training set accuracy = 0.837700, Test set accuracy = 0.845400
 epoch 10/30. Took 0.73672 seconds. 
  Full-batch training loss = 0.757532, test loss = 0.740847
  Training set accuracy = 0.843800, Test set accuracy = 0.851300
 epoch 11/30. Took 0.7295 seconds. 
  Full-batch training loss = 0.711817, test loss = 0.695512
  Training set accuracy = 0.849700, Test set accuracy = 0.856000
 epoch 12/30. Took 0.72805 seconds. 
  Full-batch training loss = 0.673691, test loss = 0.657947
  Training set accuracy = 0.853700, Test set accuracy = 0.860200
 epoch 13/30. Took 0.78368 seconds. 
  Full-batch training loss = 0.641333, test loss = 0.626191
  Training set accuracy = 0.858200, Test set accuracy = 0.863300
 epoch 14/30. Took 0.73287 seconds. 
  Full-batch training loss = 0.613712, test loss = 0.599150
  Training set accuracy = 0.862800, Test set accuracy = 0.867000
 epoch 15/30. Took 0.73741 seconds. 
  Full-batch training loss = 0.589804, test loss = 0.575831
  Training set accuracy = 0.866000, Test set accuracy = 0.870300
 epoch 16/30. Took 0.72749 seconds. 
  Full-batch training loss = 0.568741, test loss = 0.555382
  Training set accuracy = 0.869100, Test set accuracy = 0.872600
 epoch 17/30. Took 0.77224 seconds. 
  Full-batch training loss = 0.550411, test loss = 0.537810
  Training set accuracy = 0.871400, Test set accuracy = 0.874700
 epoch 18/30. Took 0.72993 seconds. 
  Full-batch training loss = 0.533928, test loss = 0.521954
  Training set accuracy = 0.875100, Test set accuracy = 0.877900
 epoch 19/30. Took 0.73013 seconds. 
  Full-batch training loss = 0.519071, test loss = 0.507939
  Training set accuracy = 0.876600, Test set accuracy = 0.880400
 epoch 20/30. Took 0.73693 seconds. 
  Full-batch training loss = 0.505762, test loss = 0.495243
  Training set accuracy = 0.879100, Test set accuracy = 0.881800
 epoch 21/30. Took 0.80373 seconds. 
  Full-batch training loss = 0.493787, test loss = 0.483881
  Training set accuracy = 0.880500, Test set accuracy = 0.882400
 epoch 22/30. Took 0.73081 seconds. 
  Full-batch training loss = 0.482686, test loss = 0.473553
  Training set accuracy = 0.882600, Test set accuracy = 0.885400
 epoch 23/30. Took 0.73316 seconds. 
  Full-batch training loss = 0.472540, test loss = 0.463906
  Training set accuracy = 0.884200, Test set accuracy = 0.887000
 epoch 24/30. Took 0.7968 seconds. 
  Full-batch training loss = 0.463337, test loss = 0.455584
  Training set accuracy = 0.884800, Test set accuracy = 0.887700
 epoch 25/30. Took 0.77973 seconds. 
  Full-batch training loss = 0.454621, test loss = 0.447323
  Training set accuracy = 0.887100, Test set accuracy = 0.888700
 epoch 26/30. Took 0.72769 seconds. 
  Full-batch training loss = 0.446632, test loss = 0.440141
  Training set accuracy = 0.888500, Test set accuracy = 0.889400
 epoch 27/30. Took 0.72907 seconds. 
  Full-batch training loss = 0.439197, test loss = 0.433276
  Training set accuracy = 0.890100, Test set accuracy = 0.891000
 epoch 28/30. Took 0.76051 seconds. 
  Full-batch training loss = 0.432295, test loss = 0.427059
  Training set accuracy = 0.890700, Test set accuracy = 0.892000
 epoch 29/30. Took 0.75531 seconds. 
  Full-batch training loss = 0.425730, test loss = 0.420966
  Training set accuracy = 0.891400, Test set accuracy = 0.892300
 epoch 30/30. Took 0.79751 seconds. 
  Full-batch training loss = 0.419760, test loss = 0.415569
  Training set accuracy = 0.892000, Test set accuracy = 0.892000
Elapsed time is 38.775340 seconds.
End Training
-----
Params 10000 0.001 0.10 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27978 seconds. 
  Full-batch training loss = 2.247428, test loss = 2.243814
  Training set accuracy = 0.125400, Test set accuracy = 0.124400
 epoch 2/30. Took 0.27388 seconds. 
  Full-batch training loss = 2.165571, test loss = 2.160979
  Training set accuracy = 0.243900, Test set accuracy = 0.252500
 epoch 3/30. Took 0.27837 seconds. 
  Full-batch training loss = 2.061490, test loss = 2.055629
  Training set accuracy = 0.435900, Test set accuracy = 0.443000
 epoch 4/30. Took 0.27982 seconds. 
  Full-batch training loss = 1.932211, test loss = 1.924568
  Training set accuracy = 0.563500, Test set accuracy = 0.574500
 epoch 5/30. Took 0.28536 seconds. 
  Full-batch training loss = 1.779061, test loss = 1.768608
  Training set accuracy = 0.641900, Test set accuracy = 0.655500
 epoch 6/30. Took 0.27665 seconds. 
  Full-batch training loss = 1.607998, test loss = 1.594792
  Training set accuracy = 0.682900, Test set accuracy = 0.700700
 epoch 7/30. Took 0.27723 seconds. 
  Full-batch training loss = 1.428702, test loss = 1.413618
  Training set accuracy = 0.722400, Test set accuracy = 0.738300
 epoch 8/30. Took 0.2853 seconds. 
  Full-batch training loss = 1.257231, test loss = 1.240329
  Training set accuracy = 0.761900, Test set accuracy = 0.778200
 epoch 9/30. Took 0.28539 seconds. 
  Full-batch training loss = 1.106414, test loss = 1.089322
  Training set accuracy = 0.784600, Test set accuracy = 0.797200
 epoch 10/30. Took 0.28638 seconds. 
  Full-batch training loss = 0.982684, test loss = 0.964807
  Training set accuracy = 0.805800, Test set accuracy = 0.815900
 epoch 11/30. Took 0.28403 seconds. 
  Full-batch training loss = 0.884438, test loss = 0.866940
  Training set accuracy = 0.815700, Test set accuracy = 0.826100
 epoch 12/30. Took 0.28575 seconds. 
  Full-batch training loss = 0.806740, test loss = 0.790621
  Training set accuracy = 0.825400, Test set accuracy = 0.834300
 epoch 13/30. Took 0.29772 seconds. 
  Full-batch training loss = 0.744355, test loss = 0.728668
  Training set accuracy = 0.834300, Test set accuracy = 0.840800
 epoch 14/30. Took 0.27841 seconds. 
  Full-batch training loss = 0.694774, test loss = 0.679807
  Training set accuracy = 0.843200, Test set accuracy = 0.849300
 epoch 15/30. Took 0.28302 seconds. 
  Full-batch training loss = 0.654186, test loss = 0.640400
  Training set accuracy = 0.846000, Test set accuracy = 0.850400
 epoch 16/30. Took 0.28211 seconds. 
  Full-batch training loss = 0.619459, test loss = 0.605877
  Training set accuracy = 0.853500, Test set accuracy = 0.858100
 epoch 17/30. Took 0.28523 seconds. 
  Full-batch training loss = 0.590695, test loss = 0.578372
  Training set accuracy = 0.857600, Test set accuracy = 0.861600
 epoch 18/30. Took 0.29692 seconds. 
  Full-batch training loss = 0.566582, test loss = 0.554858
  Training set accuracy = 0.859700, Test set accuracy = 0.863600
 epoch 19/30. Took 0.28295 seconds. 
  Full-batch training loss = 0.545146, test loss = 0.534489
  Training set accuracy = 0.866300, Test set accuracy = 0.867600
 epoch 20/30. Took 0.28333 seconds. 
  Full-batch training loss = 0.526442, test loss = 0.516647
  Training set accuracy = 0.868400, Test set accuracy = 0.869500
 epoch 21/30. Took 0.28573 seconds. 
  Full-batch training loss = 0.509326, test loss = 0.499938
  Training set accuracy = 0.874200, Test set accuracy = 0.873300
 epoch 22/30. Took 0.29902 seconds. 
  Full-batch training loss = 0.494124, test loss = 0.485283
  Training set accuracy = 0.876300, Test set accuracy = 0.875500
 epoch 23/30. Took 0.27577 seconds. 
  Full-batch training loss = 0.480721, test loss = 0.472941
  Training set accuracy = 0.877700, Test set accuracy = 0.878500
 epoch 24/30. Took 0.28471 seconds. 
  Full-batch training loss = 0.468255, test loss = 0.461378
  Training set accuracy = 0.880600, Test set accuracy = 0.880100
 epoch 25/30. Took 0.29411 seconds. 
  Full-batch training loss = 0.457620, test loss = 0.450893
  Training set accuracy = 0.881600, Test set accuracy = 0.880900
 epoch 26/30. Took 0.2864 seconds. 
  Full-batch training loss = 0.447282, test loss = 0.441234
  Training set accuracy = 0.885100, Test set accuracy = 0.883800
 epoch 27/30. Took 0.28503 seconds. 
  Full-batch training loss = 0.437496, test loss = 0.432273
  Training set accuracy = 0.886500, Test set accuracy = 0.885500
 epoch 28/30. Took 0.28592 seconds. 
  Full-batch training loss = 0.428956, test loss = 0.424206
  Training set accuracy = 0.888400, Test set accuracy = 0.888100
 epoch 29/30. Took 0.28632 seconds. 
  Full-batch training loss = 0.420801, test loss = 0.416423
  Training set accuracy = 0.889900, Test set accuracy = 0.890200
 epoch 30/30. Took 0.2844 seconds. 
  Full-batch training loss = 0.413257, test loss = 0.409533
  Training set accuracy = 0.891900, Test set accuracy = 0.890800
Elapsed time is 15.797165 seconds.
End Training
-----
Params 10000 0.001 0.10 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.51375 seconds. 
  Full-batch training loss = 2.217665, test loss = 2.216876
  Training set accuracy = 0.319000, Test set accuracy = 0.316300
 epoch 2/30. Took 0.47187 seconds. 
  Full-batch training loss = 2.127383, test loss = 2.126046
  Training set accuracy = 0.508700, Test set accuracy = 0.500500
 epoch 3/30. Took 0.47064 seconds. 
  Full-batch training loss = 2.015313, test loss = 2.013073
  Training set accuracy = 0.608600, Test set accuracy = 0.605000
 epoch 4/30. Took 0.47439 seconds. 
  Full-batch training loss = 1.874690, test loss = 1.870934
  Training set accuracy = 0.663600, Test set accuracy = 0.663300
 epoch 5/30. Took 0.47071 seconds. 
  Full-batch training loss = 1.705092, test loss = 1.698889
  Training set accuracy = 0.706700, Test set accuracy = 0.711300
 epoch 6/30. Took 0.47396 seconds. 
  Full-batch training loss = 1.514676, test loss = 1.505182
  Training set accuracy = 0.738200, Test set accuracy = 0.744000
 epoch 7/30. Took 0.47281 seconds. 
  Full-batch training loss = 1.323592, test loss = 1.310732
  Training set accuracy = 0.760900, Test set accuracy = 0.771300
 epoch 8/30. Took 0.46858 seconds. 
  Full-batch training loss = 1.152389, test loss = 1.136828
  Training set accuracy = 0.783100, Test set accuracy = 0.793200
 epoch 9/30. Took 0.48921 seconds. 
  Full-batch training loss = 1.012218, test loss = 0.994993
  Training set accuracy = 0.797800, Test set accuracy = 0.808000
 epoch 10/30. Took 0.46667 seconds. 
  Full-batch training loss = 0.902091, test loss = 0.884001
  Training set accuracy = 0.812900, Test set accuracy = 0.822000
 epoch 11/30. Took 0.47545 seconds. 
  Full-batch training loss = 0.816866, test loss = 0.798550
  Training set accuracy = 0.828200, Test set accuracy = 0.832700
 epoch 12/30. Took 0.4677 seconds. 
  Full-batch training loss = 0.749742, test loss = 0.731734
  Training set accuracy = 0.831700, Test set accuracy = 0.837800
 epoch 13/30. Took 0.48479 seconds. 
  Full-batch training loss = 0.695984, test loss = 0.678662
  Training set accuracy = 0.841700, Test set accuracy = 0.845800
 epoch 14/30. Took 0.4775 seconds. 
  Full-batch training loss = 0.652187, test loss = 0.635498
  Training set accuracy = 0.846900, Test set accuracy = 0.853500
 epoch 15/30. Took 0.47468 seconds. 
  Full-batch training loss = 0.616536, test loss = 0.600890
  Training set accuracy = 0.851900, Test set accuracy = 0.858000
 epoch 16/30. Took 0.47614 seconds. 
  Full-batch training loss = 0.586781, test loss = 0.571896
  Training set accuracy = 0.855000, Test set accuracy = 0.859600
 epoch 17/30. Took 0.4715 seconds. 
  Full-batch training loss = 0.560994, test loss = 0.547675
  Training set accuracy = 0.860800, Test set accuracy = 0.864200
 epoch 18/30. Took 0.47368 seconds. 
  Full-batch training loss = 0.538391, test loss = 0.525612
  Training set accuracy = 0.862000, Test set accuracy = 0.867600
 epoch 19/30. Took 0.47289 seconds. 
  Full-batch training loss = 0.518739, test loss = 0.507228
  Training set accuracy = 0.867000, Test set accuracy = 0.870000
 epoch 20/30. Took 0.47115 seconds. 
  Full-batch training loss = 0.501579, test loss = 0.490972
  Training set accuracy = 0.872400, Test set accuracy = 0.874900
 epoch 21/30. Took 0.48943 seconds. 
  Full-batch training loss = 0.486159, test loss = 0.476110
  Training set accuracy = 0.872900, Test set accuracy = 0.876300
 epoch 22/30. Took 0.4783 seconds. 
  Full-batch training loss = 0.472359, test loss = 0.463387
  Training set accuracy = 0.875300, Test set accuracy = 0.877900
 epoch 23/30. Took 0.47366 seconds. 
  Full-batch training loss = 0.459955, test loss = 0.451974
  Training set accuracy = 0.878100, Test set accuracy = 0.880500
 epoch 24/30. Took 0.47647 seconds. 
  Full-batch training loss = 0.448758, test loss = 0.442251
  Training set accuracy = 0.880900, Test set accuracy = 0.882800
 epoch 25/30. Took 0.47184 seconds. 
  Full-batch training loss = 0.438911, test loss = 0.432887
  Training set accuracy = 0.882700, Test set accuracy = 0.884200
 epoch 26/30. Took 0.47021 seconds. 
  Full-batch training loss = 0.429502, test loss = 0.425887
  Training set accuracy = 0.885600, Test set accuracy = 0.885200
 epoch 27/30. Took 0.47074 seconds. 
  Full-batch training loss = 0.420848, test loss = 0.417350
  Training set accuracy = 0.885400, Test set accuracy = 0.886400
 epoch 28/30. Took 0.48019 seconds. 
  Full-batch training loss = 0.412513, test loss = 0.409660
  Training set accuracy = 0.888400, Test set accuracy = 0.888500
 epoch 29/30. Took 0.50476 seconds. 
  Full-batch training loss = 0.404988, test loss = 0.403800
  Training set accuracy = 0.891100, Test set accuracy = 0.889600
 epoch 30/30. Took 0.51099 seconds. 
  Full-batch training loss = 0.397884, test loss = 0.397313
  Training set accuracy = 0.893000, Test set accuracy = 0.891300
Elapsed time is 25.166403 seconds.
End Training
-----
Params 10000 0.001 0.10 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2172 seconds. 
  Full-batch training loss = 2.179897, test loss = 2.181011
  Training set accuracy = 0.294600, Test set accuracy = 0.290200
 epoch 2/30. Took 1.2072 seconds. 
  Full-batch training loss = 2.037366, test loss = 2.035358
  Training set accuracy = 0.603400, Test set accuracy = 0.590800
 epoch 3/30. Took 1.2013 seconds. 
  Full-batch training loss = 1.868831, test loss = 1.863765
  Training set accuracy = 0.699800, Test set accuracy = 0.699200
 epoch 4/30. Took 1.2223 seconds. 
  Full-batch training loss = 1.668705, test loss = 1.660015
  Training set accuracy = 0.735000, Test set accuracy = 0.743600
 epoch 5/30. Took 1.2228 seconds. 
  Full-batch training loss = 1.452585, test loss = 1.439848
  Training set accuracy = 0.762900, Test set accuracy = 0.773400
 epoch 6/30. Took 1.2524 seconds. 
  Full-batch training loss = 1.249110, test loss = 1.232995
  Training set accuracy = 0.781100, Test set accuracy = 0.791200
 epoch 7/30. Took 1.2232 seconds. 
  Full-batch training loss = 1.078095, test loss = 1.058643
  Training set accuracy = 0.801400, Test set accuracy = 0.812200
 epoch 8/30. Took 1.2069 seconds. 
  Full-batch training loss = 0.944884, test loss = 0.923316
  Training set accuracy = 0.815600, Test set accuracy = 0.823800
 epoch 9/30. Took 1.1972 seconds. 
  Full-batch training loss = 0.843226, test loss = 0.820220
  Training set accuracy = 0.825000, Test set accuracy = 0.831500
 epoch 10/30. Took 1.1995 seconds. 
  Full-batch training loss = 0.765344, test loss = 0.741942
  Training set accuracy = 0.834900, Test set accuracy = 0.842500
 epoch 11/30. Took 1.1962 seconds. 
  Full-batch training loss = 0.704188, test loss = 0.680628
  Training set accuracy = 0.841400, Test set accuracy = 0.850100
 epoch 12/30. Took 1.2515 seconds. 
  Full-batch training loss = 0.655945, test loss = 0.632063
  Training set accuracy = 0.844000, Test set accuracy = 0.854700
 epoch 13/30. Took 1.2535 seconds. 
  Full-batch training loss = 0.616533, test loss = 0.592759
  Training set accuracy = 0.850200, Test set accuracy = 0.861300
 epoch 14/30. Took 1.2014 seconds. 
  Full-batch training loss = 0.584414, test loss = 0.560524
  Training set accuracy = 0.854300, Test set accuracy = 0.865600
 epoch 15/30. Took 1.2007 seconds. 
  Full-batch training loss = 0.557147, test loss = 0.534317
  Training set accuracy = 0.857300, Test set accuracy = 0.868700
 epoch 16/30. Took 1.2006 seconds. 
  Full-batch training loss = 0.533748, test loss = 0.511170
  Training set accuracy = 0.863500, Test set accuracy = 0.875600
 epoch 17/30. Took 1.1966 seconds. 
  Full-batch training loss = 0.513620, test loss = 0.491714
  Training set accuracy = 0.865600, Test set accuracy = 0.877200
 epoch 18/30. Took 1.2018 seconds. 
  Full-batch training loss = 0.495854, test loss = 0.474931
  Training set accuracy = 0.869500, Test set accuracy = 0.880400
 epoch 19/30. Took 1.2175 seconds. 
  Full-batch training loss = 0.480905, test loss = 0.459723
  Training set accuracy = 0.871200, Test set accuracy = 0.883300
 epoch 20/30. Took 1.2284 seconds. 
  Full-batch training loss = 0.466676, test loss = 0.446691
  Training set accuracy = 0.876100, Test set accuracy = 0.886100
 epoch 21/30. Took 1.2095 seconds. 
  Full-batch training loss = 0.454530, test loss = 0.435654
  Training set accuracy = 0.878000, Test set accuracy = 0.888100
 epoch 22/30. Took 1.2097 seconds. 
  Full-batch training loss = 0.443575, test loss = 0.424308
  Training set accuracy = 0.880900, Test set accuracy = 0.889900
 epoch 23/30. Took 1.2399 seconds. 
  Full-batch training loss = 0.433068, test loss = 0.415025
  Training set accuracy = 0.883500, Test set accuracy = 0.891600
 epoch 24/30. Took 1.2232 seconds. 
  Full-batch training loss = 0.423949, test loss = 0.406662
  Training set accuracy = 0.885500, Test set accuracy = 0.892900
 epoch 25/30. Took 1.2072 seconds. 
  Full-batch training loss = 0.415609, test loss = 0.398829
  Training set accuracy = 0.886600, Test set accuracy = 0.892700
 epoch 26/30. Took 1.2309 seconds. 
  Full-batch training loss = 0.407245, test loss = 0.391247
  Training set accuracy = 0.890000, Test set accuracy = 0.894800
 epoch 27/30. Took 1.2859 seconds. 
  Full-batch training loss = 0.400203, test loss = 0.385113
  Training set accuracy = 0.891400, Test set accuracy = 0.896000
 epoch 28/30. Took 1.2143 seconds. 
  Full-batch training loss = 0.393504, test loss = 0.379043
  Training set accuracy = 0.894000, Test set accuracy = 0.898400
 epoch 29/30. Took 1.2034 seconds. 
  Full-batch training loss = 0.386845, test loss = 0.373224
  Training set accuracy = 0.894400, Test set accuracy = 0.898500
 epoch 30/30. Took 1.2433 seconds. 
  Full-batch training loss = 0.381121, test loss = 0.367869
  Training set accuracy = 0.894900, Test set accuracy = 0.898600
Elapsed time is 62.508333 seconds.
End Training
-----
Params 10000 0.001 0.10 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35382 seconds. 
  Full-batch training loss = 2.287648, test loss = 2.288718
  Training set accuracy = 0.125800, Test set accuracy = 0.122900
 epoch 2/30. Took 0.31513 seconds. 
  Full-batch training loss = 2.257686, test loss = 2.257624
  Training set accuracy = 0.263900, Test set accuracy = 0.259500
 epoch 3/30. Took 0.31563 seconds. 
  Full-batch training loss = 2.223110, test loss = 2.221892
  Training set accuracy = 0.391300, Test set accuracy = 0.395400
 epoch 4/30. Took 0.3377 seconds. 
  Full-batch training loss = 2.180421, test loss = 2.177791
  Training set accuracy = 0.459100, Test set accuracy = 0.464500
 epoch 5/30. Took 0.32081 seconds. 
  Full-batch training loss = 2.124625, test loss = 2.120326
  Training set accuracy = 0.513900, Test set accuracy = 0.518500
 epoch 6/30. Took 0.3241 seconds. 
  Full-batch training loss = 2.050519, test loss = 2.044236
  Training set accuracy = 0.561900, Test set accuracy = 0.567500
 epoch 7/30. Took 0.33754 seconds. 
  Full-batch training loss = 1.952442, test loss = 1.943532
  Training set accuracy = 0.597900, Test set accuracy = 0.601900
 epoch 8/30. Took 0.33788 seconds. 
  Full-batch training loss = 1.825482, test loss = 1.813268
  Training set accuracy = 0.633100, Test set accuracy = 0.631900
 epoch 9/30. Took 0.33773 seconds. 
  Full-batch training loss = 1.673587, test loss = 1.658473
  Training set accuracy = 0.652600, Test set accuracy = 0.658400
 epoch 10/30. Took 0.33865 seconds. 
  Full-batch training loss = 1.508171, test loss = 1.490845
  Training set accuracy = 0.671100, Test set accuracy = 0.677700
 epoch 11/30. Took 0.34589 seconds. 
  Full-batch training loss = 1.348623, test loss = 1.330325
  Training set accuracy = 0.688300, Test set accuracy = 0.691800
 epoch 12/30. Took 0.3372 seconds. 
  Full-batch training loss = 1.205654, test loss = 1.187164
  Training set accuracy = 0.710200, Test set accuracy = 0.712900
 epoch 13/30. Took 0.34371 seconds. 
  Full-batch training loss = 1.088439, test loss = 1.070924
  Training set accuracy = 0.727100, Test set accuracy = 0.733400
 epoch 14/30. Took 0.33742 seconds. 
  Full-batch training loss = 0.990946, test loss = 0.973458
  Training set accuracy = 0.745200, Test set accuracy = 0.753900
 epoch 15/30. Took 0.34475 seconds. 
  Full-batch training loss = 0.911567, test loss = 0.894969
  Training set accuracy = 0.764500, Test set accuracy = 0.776400
 epoch 16/30. Took 0.32086 seconds. 
  Full-batch training loss = 0.844642, test loss = 0.828300
  Training set accuracy = 0.775000, Test set accuracy = 0.787600
 epoch 17/30. Took 0.31494 seconds. 
  Full-batch training loss = 0.787480, test loss = 0.771128
  Training set accuracy = 0.787400, Test set accuracy = 0.800500
 epoch 18/30. Took 0.32728 seconds. 
  Full-batch training loss = 0.739886, test loss = 0.724167
  Training set accuracy = 0.798400, Test set accuracy = 0.811300
 epoch 19/30. Took 0.3213 seconds. 
  Full-batch training loss = 0.695990, test loss = 0.679546
  Training set accuracy = 0.808000, Test set accuracy = 0.816100
 epoch 20/30. Took 0.33706 seconds. 
  Full-batch training loss = 0.659024, test loss = 0.643372
  Training set accuracy = 0.815500, Test set accuracy = 0.826600
 epoch 21/30. Took 0.31971 seconds. 
  Full-batch training loss = 0.626086, test loss = 0.610745
  Training set accuracy = 0.825300, Test set accuracy = 0.833400
 epoch 22/30. Took 0.31722 seconds. 
  Full-batch training loss = 0.598193, test loss = 0.583779
  Training set accuracy = 0.832700, Test set accuracy = 0.840800
 epoch 23/30. Took 0.33679 seconds. 
  Full-batch training loss = 0.573459, test loss = 0.559446
  Training set accuracy = 0.839000, Test set accuracy = 0.847900
 epoch 24/30. Took 0.3386 seconds. 
  Full-batch training loss = 0.550462, test loss = 0.536849
  Training set accuracy = 0.845100, Test set accuracy = 0.852700
 epoch 25/30. Took 0.34688 seconds. 
  Full-batch training loss = 0.533012, test loss = 0.519717
  Training set accuracy = 0.850600, Test set accuracy = 0.858200
 epoch 26/30. Took 0.33537 seconds. 
  Full-batch training loss = 0.514112, test loss = 0.502146
  Training set accuracy = 0.854400, Test set accuracy = 0.861700
 epoch 27/30. Took 0.3434 seconds. 
  Full-batch training loss = 0.498081, test loss = 0.486786
  Training set accuracy = 0.857600, Test set accuracy = 0.867300
 epoch 28/30. Took 0.31732 seconds. 
  Full-batch training loss = 0.483437, test loss = 0.473097
  Training set accuracy = 0.861800, Test set accuracy = 0.872100
 epoch 29/30. Took 0.33862 seconds. 
  Full-batch training loss = 0.470342, test loss = 0.460415
  Training set accuracy = 0.864600, Test set accuracy = 0.875300
 epoch 30/30. Took 0.3368 seconds. 
  Full-batch training loss = 0.457677, test loss = 0.448711
  Training set accuracy = 0.869900, Test set accuracy = 0.878200
Elapsed time is 18.155088 seconds.
End Training
-----
Params 10000 0.001 0.10 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.62981 seconds. 
  Full-batch training loss = 2.277635, test loss = 2.278875
  Training set accuracy = 0.103600, Test set accuracy = 0.096600
 epoch 2/30. Took 0.57474 seconds. 
  Full-batch training loss = 2.241165, test loss = 2.241982
  Training set accuracy = 0.123500, Test set accuracy = 0.119700
 epoch 3/30. Took 0.57585 seconds. 
  Full-batch training loss = 2.196097, test loss = 2.196450
  Training set accuracy = 0.227400, Test set accuracy = 0.237800
 epoch 4/30. Took 0.58083 seconds. 
  Full-batch training loss = 2.135795, test loss = 2.135341
  Training set accuracy = 0.407900, Test set accuracy = 0.413500
 epoch 5/30. Took 0.57766 seconds. 
  Full-batch training loss = 2.051995, test loss = 2.050246
  Training set accuracy = 0.554400, Test set accuracy = 0.557500
 epoch 6/30. Took 0.57011 seconds. 
  Full-batch training loss = 1.932466, test loss = 1.929023
  Training set accuracy = 0.640100, Test set accuracy = 0.638600
 epoch 7/30. Took 0.56085 seconds. 
  Full-batch training loss = 1.768669, test loss = 1.762663
  Training set accuracy = 0.691000, Test set accuracy = 0.684500
 epoch 8/30. Took 0.57245 seconds. 
  Full-batch training loss = 1.565456, test loss = 1.556337
  Training set accuracy = 0.724400, Test set accuracy = 0.719700
 epoch 9/30. Took 0.57602 seconds. 
  Full-batch training loss = 1.349930, test loss = 1.337611
  Training set accuracy = 0.743100, Test set accuracy = 0.744900
 epoch 10/30. Took 0.56839 seconds. 
  Full-batch training loss = 1.156747, test loss = 1.140742
  Training set accuracy = 0.765800, Test set accuracy = 0.769400
 epoch 11/30. Took 0.58234 seconds. 
  Full-batch training loss = 1.000482, test loss = 0.982453
  Training set accuracy = 0.786400, Test set accuracy = 0.794500
 epoch 12/30. Took 0.58401 seconds. 
  Full-batch training loss = 0.882574, test loss = 0.865155
  Training set accuracy = 0.796000, Test set accuracy = 0.802100
 epoch 13/30. Took 0.58141 seconds. 
  Full-batch training loss = 0.793202, test loss = 0.775012
  Training set accuracy = 0.811200, Test set accuracy = 0.812400
 epoch 14/30. Took 0.57601 seconds. 
  Full-batch training loss = 0.724483, test loss = 0.707297
  Training set accuracy = 0.821000, Test set accuracy = 0.824600
 epoch 15/30. Took 0.5767 seconds. 
  Full-batch training loss = 0.671369, test loss = 0.654369
  Training set accuracy = 0.828300, Test set accuracy = 0.832200
 epoch 16/30. Took 0.58293 seconds. 
  Full-batch training loss = 0.629739, test loss = 0.612561
  Training set accuracy = 0.833400, Test set accuracy = 0.836300
 epoch 17/30. Took 0.56573 seconds. 
  Full-batch training loss = 0.594329, test loss = 0.578996
  Training set accuracy = 0.840100, Test set accuracy = 0.845100
 epoch 18/30. Took 0.6257 seconds. 
  Full-batch training loss = 0.566033, test loss = 0.550529
  Training set accuracy = 0.845700, Test set accuracy = 0.850400
 epoch 19/30. Took 0.59349 seconds. 
  Full-batch training loss = 0.541081, test loss = 0.526721
  Training set accuracy = 0.852200, Test set accuracy = 0.856500
 epoch 20/30. Took 0.56879 seconds. 
  Full-batch training loss = 0.520582, test loss = 0.507556
  Training set accuracy = 0.854700, Test set accuracy = 0.861400
 epoch 21/30. Took 0.55969 seconds. 
  Full-batch training loss = 0.502786, test loss = 0.491461
  Training set accuracy = 0.861500, Test set accuracy = 0.864600
 epoch 22/30. Took 0.59091 seconds. 
  Full-batch training loss = 0.486430, test loss = 0.474901
  Training set accuracy = 0.864700, Test set accuracy = 0.869100
 epoch 23/30. Took 0.57704 seconds. 
  Full-batch training loss = 0.472880, test loss = 0.462590
  Training set accuracy = 0.868800, Test set accuracy = 0.871400
 epoch 24/30. Took 0.57431 seconds. 
  Full-batch training loss = 0.460736, test loss = 0.451526
  Training set accuracy = 0.870400, Test set accuracy = 0.874700
 epoch 25/30. Took 0.58413 seconds. 
  Full-batch training loss = 0.448341, test loss = 0.439429
  Training set accuracy = 0.875300, Test set accuracy = 0.878800
 epoch 26/30. Took 0.59376 seconds. 
  Full-batch training loss = 0.438255, test loss = 0.431297
  Training set accuracy = 0.877000, Test set accuracy = 0.879900
 epoch 27/30. Took 0.56833 seconds. 
  Full-batch training loss = 0.429701, test loss = 0.420771
  Training set accuracy = 0.880500, Test set accuracy = 0.882800
 epoch 28/30. Took 0.57571 seconds. 
  Full-batch training loss = 0.420685, test loss = 0.413853
  Training set accuracy = 0.884000, Test set accuracy = 0.882500
 epoch 29/30. Took 0.63788 seconds. 
  Full-batch training loss = 0.412660, test loss = 0.406919
  Training set accuracy = 0.885500, Test set accuracy = 0.883900
 epoch 30/30. Took 0.56218 seconds. 
  Full-batch training loss = 0.404470, test loss = 0.399123
  Training set accuracy = 0.887000, Test set accuracy = 0.887800
Elapsed time is 30.697407 seconds.
End Training
-----
Params 10000 0.001 0.10 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.6931 seconds. 
  Full-batch training loss = 2.243609, test loss = 2.243569
  Training set accuracy = 0.229200, Test set accuracy = 0.227200
 epoch 2/30. Took 1.6806 seconds. 
  Full-batch training loss = 2.180611, test loss = 2.179759
  Training set accuracy = 0.378700, Test set accuracy = 0.377800
 epoch 3/30. Took 1.7171 seconds. 
  Full-batch training loss = 2.101705, test loss = 2.100002
  Training set accuracy = 0.491500, Test set accuracy = 0.493500
 epoch 4/30. Took 1.6634 seconds. 
  Full-batch training loss = 1.995764, test loss = 1.992552
  Training set accuracy = 0.590900, Test set accuracy = 0.589100
 epoch 5/30. Took 1.6794 seconds. 
  Full-batch training loss = 1.850614, test loss = 1.845716
  Training set accuracy = 0.646600, Test set accuracy = 0.640500
 epoch 6/30. Took 1.6636 seconds. 
  Full-batch training loss = 1.659700, test loss = 1.651937
  Training set accuracy = 0.695900, Test set accuracy = 0.692800
 epoch 7/30. Took 1.7233 seconds. 
  Full-batch training loss = 1.436290, test loss = 1.425764
  Training set accuracy = 0.723800, Test set accuracy = 0.720200
 epoch 8/30. Took 1.7499 seconds. 
  Full-batch training loss = 1.213798, test loss = 1.202448
  Training set accuracy = 0.763400, Test set accuracy = 0.767700
 epoch 9/30. Took 1.8452 seconds. 
  Full-batch training loss = 1.026776, test loss = 1.015313
  Training set accuracy = 0.796000, Test set accuracy = 0.794800
 epoch 10/30. Took 1.701 seconds. 
  Full-batch training loss = 0.884094, test loss = 0.875459
  Training set accuracy = 0.813700, Test set accuracy = 0.812400
 epoch 11/30. Took 1.7024 seconds. 
  Full-batch training loss = 0.775334, test loss = 0.767609
  Training set accuracy = 0.828900, Test set accuracy = 0.828100
 epoch 12/30. Took 1.6765 seconds. 
  Full-batch training loss = 0.694506, test loss = 0.689516
  Training set accuracy = 0.837700, Test set accuracy = 0.836900
 epoch 13/30. Took 1.7672 seconds. 
  Full-batch training loss = 0.633427, test loss = 0.630898
  Training set accuracy = 0.845000, Test set accuracy = 0.845000
 epoch 14/30. Took 1.6884 seconds. 
  Full-batch training loss = 0.585483, test loss = 0.586233
  Training set accuracy = 0.852200, Test set accuracy = 0.850800
 epoch 15/30. Took 1.6825 seconds. 
  Full-batch training loss = 0.547742, test loss = 0.551308
  Training set accuracy = 0.857100, Test set accuracy = 0.855500
 epoch 16/30. Took 1.6616 seconds. 
  Full-batch training loss = 0.516361, test loss = 0.520569
  Training set accuracy = 0.864800, Test set accuracy = 0.862600
 epoch 17/30. Took 1.6602 seconds. 
  Full-batch training loss = 0.489205, test loss = 0.495138
  Training set accuracy = 0.869900, Test set accuracy = 0.866800
 epoch 18/30. Took 1.6651 seconds. 
  Full-batch training loss = 0.467526, test loss = 0.475988
  Training set accuracy = 0.875400, Test set accuracy = 0.871200
 epoch 19/30. Took 1.6582 seconds. 
  Full-batch training loss = 0.448958, test loss = 0.457433
  Training set accuracy = 0.878200, Test set accuracy = 0.875400
 epoch 20/30. Took 1.7021 seconds. 
  Full-batch training loss = 0.432826, test loss = 0.443086
  Training set accuracy = 0.881100, Test set accuracy = 0.878800
 epoch 21/30. Took 1.7104 seconds. 
  Full-batch training loss = 0.417377, test loss = 0.430009
  Training set accuracy = 0.886000, Test set accuracy = 0.881100
 epoch 22/30. Took 1.6581 seconds. 
  Full-batch training loss = 0.404888, test loss = 0.418763
  Training set accuracy = 0.887800, Test set accuracy = 0.882500
 epoch 23/30. Took 1.7271 seconds. 
  Full-batch training loss = 0.392669, test loss = 0.407962
  Training set accuracy = 0.890500, Test set accuracy = 0.886300
 epoch 24/30. Took 1.6612 seconds. 
  Full-batch training loss = 0.382986, test loss = 0.399459
  Training set accuracy = 0.894300, Test set accuracy = 0.888700
 epoch 25/30. Took 1.6649 seconds. 
  Full-batch training loss = 0.374121, test loss = 0.392006
  Training set accuracy = 0.894600, Test set accuracy = 0.889500
 epoch 26/30. Took 1.7332 seconds. 
  Full-batch training loss = 0.365347, test loss = 0.382272
  Training set accuracy = 0.898100, Test set accuracy = 0.890300
 epoch 27/30. Took 1.7007 seconds. 
  Full-batch training loss = 0.357127, test loss = 0.377170
  Training set accuracy = 0.898200, Test set accuracy = 0.893600
 epoch 28/30. Took 1.7106 seconds. 
  Full-batch training loss = 0.349819, test loss = 0.369388
  Training set accuracy = 0.902100, Test set accuracy = 0.895300
 epoch 29/30. Took 1.6631 seconds. 
  Full-batch training loss = 0.343182, test loss = 0.362967
  Training set accuracy = 0.902900, Test set accuracy = 0.897100
 epoch 30/30. Took 1.8182 seconds. 
  Full-batch training loss = 0.336660, test loss = 0.358019
  Training set accuracy = 0.904600, Test set accuracy = 0.897000
Elapsed time is 86.837011 seconds.
End Training
-----
Params 10000 0.001 0.20 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23213 seconds. 
  Full-batch training loss = 2.175267, test loss = 2.178021
  Training set accuracy = 0.322800, Test set accuracy = 0.320700
 epoch 2/30. Took 0.23662 seconds. 
  Full-batch training loss = 2.013011, test loss = 2.012910
  Training set accuracy = 0.515300, Test set accuracy = 0.512200
 epoch 3/30. Took 0.22936 seconds. 
  Full-batch training loss = 1.846761, test loss = 1.843931
  Training set accuracy = 0.615700, Test set accuracy = 0.613500
 epoch 4/30. Took 0.23098 seconds. 
  Full-batch training loss = 1.679825, test loss = 1.673749
  Training set accuracy = 0.673900, Test set accuracy = 0.677200
 epoch 5/30. Took 0.23105 seconds. 
  Full-batch training loss = 1.519453, test loss = 1.510418
  Training set accuracy = 0.709800, Test set accuracy = 0.712300
 epoch 6/30. Took 0.23045 seconds. 
  Full-batch training loss = 1.374184, test loss = 1.362213
  Training set accuracy = 0.741600, Test set accuracy = 0.744400
 epoch 7/30. Took 0.23152 seconds. 
  Full-batch training loss = 1.246202, test loss = 1.232082
  Training set accuracy = 0.763700, Test set accuracy = 0.768900
 epoch 8/30. Took 0.23172 seconds. 
  Full-batch training loss = 1.135725, test loss = 1.119622
  Training set accuracy = 0.780500, Test set accuracy = 0.788100
 epoch 9/30. Took 0.23099 seconds. 
  Full-batch training loss = 1.042562, test loss = 1.025265
  Training set accuracy = 0.796000, Test set accuracy = 0.806200
 epoch 10/30. Took 0.22988 seconds. 
  Full-batch training loss = 0.964689, test loss = 0.946808
  Training set accuracy = 0.809400, Test set accuracy = 0.816600
 epoch 11/30. Took 0.23002 seconds. 
  Full-batch training loss = 0.899277, test loss = 0.880992
  Training set accuracy = 0.819500, Test set accuracy = 0.826200
 epoch 12/30. Took 0.2303 seconds. 
  Full-batch training loss = 0.843687, test loss = 0.825514
  Training set accuracy = 0.829200, Test set accuracy = 0.836300
 epoch 13/30. Took 0.22815 seconds. 
  Full-batch training loss = 0.796538, test loss = 0.778414
  Training set accuracy = 0.837000, Test set accuracy = 0.841300
 epoch 14/30. Took 0.23145 seconds. 
  Full-batch training loss = 0.756083, test loss = 0.738235
  Training set accuracy = 0.841300, Test set accuracy = 0.846600
 epoch 15/30. Took 0.22999 seconds. 
  Full-batch training loss = 0.721180, test loss = 0.703571
  Training set accuracy = 0.847800, Test set accuracy = 0.851800
 epoch 16/30. Took 0.23228 seconds. 
  Full-batch training loss = 0.690742, test loss = 0.673583
  Training set accuracy = 0.851800, Test set accuracy = 0.854800
 epoch 17/30. Took 0.23078 seconds. 
  Full-batch training loss = 0.663785, test loss = 0.646798
  Training set accuracy = 0.854400, Test set accuracy = 0.857100
 epoch 18/30. Took 0.23163 seconds. 
  Full-batch training loss = 0.640074, test loss = 0.623747
  Training set accuracy = 0.858400, Test set accuracy = 0.861500
 epoch 19/30. Took 0.23077 seconds. 
  Full-batch training loss = 0.619165, test loss = 0.603152
  Training set accuracy = 0.859500, Test set accuracy = 0.863200
 epoch 20/30. Took 0.22926 seconds. 
  Full-batch training loss = 0.600366, test loss = 0.585079
  Training set accuracy = 0.862300, Test set accuracy = 0.866900
 epoch 21/30. Took 0.22982 seconds. 
  Full-batch training loss = 0.583274, test loss = 0.568051
  Training set accuracy = 0.865600, Test set accuracy = 0.869900
 epoch 22/30. Took 0.22452 seconds. 
  Full-batch training loss = 0.567657, test loss = 0.552999
  Training set accuracy = 0.868200, Test set accuracy = 0.871300
 epoch 23/30. Took 0.24363 seconds. 
  Full-batch training loss = 0.553733, test loss = 0.539486
  Training set accuracy = 0.870900, Test set accuracy = 0.873100
 epoch 24/30. Took 0.23059 seconds. 
  Full-batch training loss = 0.540841, test loss = 0.527025
  Training set accuracy = 0.872600, Test set accuracy = 0.874200
 epoch 25/30. Took 0.23019 seconds. 
  Full-batch training loss = 0.529196, test loss = 0.516063
  Training set accuracy = 0.874000, Test set accuracy = 0.876200
 epoch 26/30. Took 0.23104 seconds. 
  Full-batch training loss = 0.518430, test loss = 0.505847
  Training set accuracy = 0.875200, Test set accuracy = 0.877300
 epoch 27/30. Took 0.22934 seconds. 
  Full-batch training loss = 0.508613, test loss = 0.495977
  Training set accuracy = 0.878000, Test set accuracy = 0.879900
 epoch 28/30. Took 0.22714 seconds. 
  Full-batch training loss = 0.499563, test loss = 0.487313
  Training set accuracy = 0.879800, Test set accuracy = 0.880400
 epoch 29/30. Took 0.22683 seconds. 
  Full-batch training loss = 0.491063, test loss = 0.479388
  Training set accuracy = 0.880700, Test set accuracy = 0.882200
 epoch 30/30. Took 0.2297 seconds. 
  Full-batch training loss = 0.483166, test loss = 0.471677
  Training set accuracy = 0.881700, Test set accuracy = 0.882700
Elapsed time is 13.317191 seconds.
End Training
-----
Params 10000 0.001 0.20 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35162 seconds. 
  Full-batch training loss = 2.146571, test loss = 2.149951
  Training set accuracy = 0.349400, Test set accuracy = 0.349500
 epoch 2/30. Took 0.34811 seconds. 
  Full-batch training loss = 1.979566, test loss = 1.981098
  Training set accuracy = 0.581100, Test set accuracy = 0.588100
 epoch 3/30. Took 0.34916 seconds. 
  Full-batch training loss = 1.810235, test loss = 1.809514
  Training set accuracy = 0.671800, Test set accuracy = 0.674100
 epoch 4/30. Took 0.38293 seconds. 
  Full-batch training loss = 1.639796, test loss = 1.636855
  Training set accuracy = 0.713600, Test set accuracy = 0.715300
 epoch 5/30. Took 0.3497 seconds. 
  Full-batch training loss = 1.475877, test loss = 1.470878
  Training set accuracy = 0.739200, Test set accuracy = 0.741100
 epoch 6/30. Took 0.34693 seconds. 
  Full-batch training loss = 1.326854, test loss = 1.320508
  Training set accuracy = 0.761200, Test set accuracy = 0.764400
 epoch 7/30. Took 0.35328 seconds. 
  Full-batch training loss = 1.196751, test loss = 1.189295
  Training set accuracy = 0.783200, Test set accuracy = 0.787500
 epoch 8/30. Took 0.34773 seconds. 
  Full-batch training loss = 1.085976, test loss = 1.078166
  Training set accuracy = 0.800400, Test set accuracy = 0.801800
 epoch 9/30. Took 0.3483 seconds. 
  Full-batch training loss = 0.993795, test loss = 0.985684
  Training set accuracy = 0.816500, Test set accuracy = 0.815500
 epoch 10/30. Took 0.34971 seconds. 
  Full-batch training loss = 0.917080, test loss = 0.909372
  Training set accuracy = 0.824300, Test set accuracy = 0.825200
 epoch 11/30. Took 0.348 seconds. 
  Full-batch training loss = 0.853043, test loss = 0.845934
  Training set accuracy = 0.832800, Test set accuracy = 0.834300
 epoch 12/30. Took 0.36851 seconds. 
  Full-batch training loss = 0.799765, test loss = 0.793295
  Training set accuracy = 0.839900, Test set accuracy = 0.839700
 epoch 13/30. Took 0.36753 seconds. 
  Full-batch training loss = 0.754368, test loss = 0.748581
  Training set accuracy = 0.847000, Test set accuracy = 0.845400
 epoch 14/30. Took 0.34667 seconds. 
  Full-batch training loss = 0.715747, test loss = 0.710655
  Training set accuracy = 0.850800, Test set accuracy = 0.848300
 epoch 15/30. Took 0.35048 seconds. 
  Full-batch training loss = 0.682314, test loss = 0.678034
  Training set accuracy = 0.855100, Test set accuracy = 0.852700
 epoch 16/30. Took 0.3487 seconds. 
  Full-batch training loss = 0.653236, test loss = 0.649628
  Training set accuracy = 0.859100, Test set accuracy = 0.858400
 epoch 17/30. Took 0.34588 seconds. 
  Full-batch training loss = 0.628001, test loss = 0.625181
  Training set accuracy = 0.861500, Test set accuracy = 0.861600
 epoch 18/30. Took 0.36921 seconds. 
  Full-batch training loss = 0.605380, test loss = 0.603269
  Training set accuracy = 0.865500, Test set accuracy = 0.865200
 epoch 19/30. Took 0.3506 seconds. 
  Full-batch training loss = 0.585452, test loss = 0.584158
  Training set accuracy = 0.867800, Test set accuracy = 0.867200
 epoch 20/30. Took 0.35962 seconds. 
  Full-batch training loss = 0.567591, test loss = 0.566917
  Training set accuracy = 0.870300, Test set accuracy = 0.869300
 epoch 21/30. Took 0.35283 seconds. 
  Full-batch training loss = 0.551546, test loss = 0.551277
  Training set accuracy = 0.872800, Test set accuracy = 0.871400
 epoch 22/30. Took 0.34628 seconds. 
  Full-batch training loss = 0.537067, test loss = 0.537443
  Training set accuracy = 0.874400, Test set accuracy = 0.873800
 epoch 23/30. Took 0.38207 seconds. 
  Full-batch training loss = 0.523807, test loss = 0.524837
  Training set accuracy = 0.876600, Test set accuracy = 0.877000
 epoch 24/30. Took 0.34934 seconds. 
  Full-batch training loss = 0.511920, test loss = 0.513533
  Training set accuracy = 0.878500, Test set accuracy = 0.877800
 epoch 25/30. Took 0.35651 seconds. 
  Full-batch training loss = 0.500690, test loss = 0.502729
  Training set accuracy = 0.880600, Test set accuracy = 0.879600
 epoch 26/30. Took 0.3464 seconds. 
  Full-batch training loss = 0.490413, test loss = 0.492942
  Training set accuracy = 0.882800, Test set accuracy = 0.880400
 epoch 27/30. Took 0.34868 seconds. 
  Full-batch training loss = 0.481120, test loss = 0.484441
  Training set accuracy = 0.883600, Test set accuracy = 0.881300
 epoch 28/30. Took 0.34797 seconds. 
  Full-batch training loss = 0.472215, test loss = 0.475902
  Training set accuracy = 0.885800, Test set accuracy = 0.883500
 epoch 29/30. Took 0.35013 seconds. 
  Full-batch training loss = 0.464236, test loss = 0.468499
  Training set accuracy = 0.886800, Test set accuracy = 0.884400
 epoch 30/30. Took 0.35399 seconds. 
  Full-batch training loss = 0.456382, test loss = 0.461070
  Training set accuracy = 0.888400, Test set accuracy = 0.885400
Elapsed time is 19.281876 seconds.
End Training
-----
Params 10000 0.001 0.20 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.7497 seconds. 
  Full-batch training loss = 2.101716, test loss = 2.104276
  Training set accuracy = 0.443800, Test set accuracy = 0.436800
 epoch 2/30. Took 0.73203 seconds. 
  Full-batch training loss = 1.896634, test loss = 1.898085
  Training set accuracy = 0.640600, Test set accuracy = 0.630300
 epoch 3/30. Took 0.72799 seconds. 
  Full-batch training loss = 1.700435, test loss = 1.699515
  Training set accuracy = 0.710800, Test set accuracy = 0.709100
 epoch 4/30. Took 0.74548 seconds. 
  Full-batch training loss = 1.515876, test loss = 1.512180
  Training set accuracy = 0.749700, Test set accuracy = 0.749900
 epoch 5/30. Took 0.74623 seconds. 
  Full-batch training loss = 1.350461, test loss = 1.344572
  Training set accuracy = 0.768300, Test set accuracy = 0.770800
 epoch 6/30. Took 0.72877 seconds. 
  Full-batch training loss = 1.209359, test loss = 1.201393
  Training set accuracy = 0.785800, Test set accuracy = 0.792100
 epoch 7/30. Took 0.73048 seconds. 
  Full-batch training loss = 1.091785, test loss = 1.082219
  Training set accuracy = 0.802200, Test set accuracy = 0.805000
 epoch 8/30. Took 0.75381 seconds. 
  Full-batch training loss = 0.995043, test loss = 0.984330
  Training set accuracy = 0.814500, Test set accuracy = 0.819500
 epoch 9/30. Took 0.72854 seconds. 
  Full-batch training loss = 0.915863, test loss = 0.904414
  Training set accuracy = 0.823800, Test set accuracy = 0.828300
 epoch 10/30. Took 0.75631 seconds. 
  Full-batch training loss = 0.850806, test loss = 0.839252
  Training set accuracy = 0.831600, Test set accuracy = 0.834800
 epoch 11/30. Took 0.79023 seconds. 
  Full-batch training loss = 0.796575, test loss = 0.784814
  Training set accuracy = 0.838300, Test set accuracy = 0.843000
 epoch 12/30. Took 0.72661 seconds. 
  Full-batch training loss = 0.751209, test loss = 0.739243
  Training set accuracy = 0.844300, Test set accuracy = 0.848300
 epoch 13/30. Took 0.74962 seconds. 
  Full-batch training loss = 0.712489, test loss = 0.700965
  Training set accuracy = 0.848800, Test set accuracy = 0.852100
 epoch 14/30. Took 0.73524 seconds. 
  Full-batch training loss = 0.679373, test loss = 0.668188
  Training set accuracy = 0.852000, Test set accuracy = 0.854200
 epoch 15/30. Took 0.72907 seconds. 
  Full-batch training loss = 0.650474, test loss = 0.639415
  Training set accuracy = 0.856500, Test set accuracy = 0.858400
 epoch 16/30. Took 0.76386 seconds. 
  Full-batch training loss = 0.625246, test loss = 0.614555
  Training set accuracy = 0.858600, Test set accuracy = 0.861200
 epoch 17/30. Took 0.7291 seconds. 
  Full-batch training loss = 0.603131, test loss = 0.592971
  Training set accuracy = 0.862000, Test set accuracy = 0.863500
 epoch 18/30. Took 0.7269 seconds. 
  Full-batch training loss = 0.583620, test loss = 0.573840
  Training set accuracy = 0.864700, Test set accuracy = 0.867000
 epoch 19/30. Took 0.73999 seconds. 
  Full-batch training loss = 0.565932, test loss = 0.556746
  Training set accuracy = 0.866500, Test set accuracy = 0.867400
 epoch 20/30. Took 0.73357 seconds. 
  Full-batch training loss = 0.550156, test loss = 0.541492
  Training set accuracy = 0.868600, Test set accuracy = 0.870000
 epoch 21/30. Took 0.73037 seconds. 
  Full-batch training loss = 0.535886, test loss = 0.527495
  Training set accuracy = 0.871800, Test set accuracy = 0.871100
 epoch 22/30. Took 0.7284 seconds. 
  Full-batch training loss = 0.522654, test loss = 0.514786
  Training set accuracy = 0.873200, Test set accuracy = 0.873600
 epoch 23/30. Took 0.73082 seconds. 
  Full-batch training loss = 0.510721, test loss = 0.503266
  Training set accuracy = 0.875200, Test set accuracy = 0.875400
 epoch 24/30. Took 0.72626 seconds. 
  Full-batch training loss = 0.499775, test loss = 0.492920
  Training set accuracy = 0.876900, Test set accuracy = 0.876500
 epoch 25/30. Took 0.79661 seconds. 
  Full-batch training loss = 0.489820, test loss = 0.483305
  Training set accuracy = 0.878400, Test set accuracy = 0.880000
 epoch 26/30. Took 0.72795 seconds. 
  Full-batch training loss = 0.480388, test loss = 0.474423
  Training set accuracy = 0.879300, Test set accuracy = 0.880600
 epoch 27/30. Took 0.74058 seconds. 
  Full-batch training loss = 0.471769, test loss = 0.466253
  Training set accuracy = 0.881500, Test set accuracy = 0.881700
 epoch 28/30. Took 0.73652 seconds. 
  Full-batch training loss = 0.463594, test loss = 0.458490
  Training set accuracy = 0.882600, Test set accuracy = 0.883500
 epoch 29/30. Took 0.73126 seconds. 
  Full-batch training loss = 0.456181, test loss = 0.451567
  Training set accuracy = 0.884400, Test set accuracy = 0.884200
 epoch 30/30. Took 0.73127 seconds. 
  Full-batch training loss = 0.449159, test loss = 0.444936
  Training set accuracy = 0.885900, Test set accuracy = 0.885700
Elapsed time is 38.552020 seconds.
End Training
-----
Params 10000 0.001 0.20 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28338 seconds. 
  Full-batch training loss = 2.283685, test loss = 2.285105
  Training set accuracy = 0.147200, Test set accuracy = 0.146400
 epoch 2/30. Took 0.29142 seconds. 
  Full-batch training loss = 2.245975, test loss = 2.246669
  Training set accuracy = 0.219100, Test set accuracy = 0.219200
 epoch 3/30. Took 0.28389 seconds. 
  Full-batch training loss = 2.200648, test loss = 2.200480
  Training set accuracy = 0.322400, Test set accuracy = 0.320900
 epoch 4/30. Took 0.29287 seconds. 
  Full-batch training loss = 2.146231, test loss = 2.145188
  Training set accuracy = 0.386100, Test set accuracy = 0.380800
 epoch 5/30. Took 0.27054 seconds. 
  Full-batch training loss = 2.081857, test loss = 2.079750
  Training set accuracy = 0.438100, Test set accuracy = 0.431100
 epoch 6/30. Took 0.29791 seconds. 
  Full-batch training loss = 2.005440, test loss = 2.001935
  Training set accuracy = 0.504300, Test set accuracy = 0.500100
 epoch 7/30. Took 0.28437 seconds. 
  Full-batch training loss = 1.913336, test loss = 1.907893
  Training set accuracy = 0.555200, Test set accuracy = 0.559500
 epoch 8/30. Took 0.28393 seconds. 
  Full-batch training loss = 1.807573, test loss = 1.799752
  Training set accuracy = 0.596400, Test set accuracy = 0.603500
 epoch 9/30. Took 0.28353 seconds. 
  Full-batch training loss = 1.691378, test loss = 1.680955
  Training set accuracy = 0.634200, Test set accuracy = 0.645000
 epoch 10/30. Took 0.27449 seconds. 
  Full-batch training loss = 1.568518, test loss = 1.555579
  Training set accuracy = 0.663300, Test set accuracy = 0.672400
 epoch 11/30. Took 0.26945 seconds. 
  Full-batch training loss = 1.444237, test loss = 1.428821
  Training set accuracy = 0.696400, Test set accuracy = 0.705400
 epoch 12/30. Took 0.27577 seconds. 
  Full-batch training loss = 1.325332, test loss = 1.307666
  Training set accuracy = 0.722000, Test set accuracy = 0.734500
 epoch 13/30. Took 0.28436 seconds. 
  Full-batch training loss = 1.215110, test loss = 1.196241
  Training set accuracy = 0.746800, Test set accuracy = 0.757700
 epoch 14/30. Took 0.27865 seconds. 
  Full-batch training loss = 1.116668, test loss = 1.096647
  Training set accuracy = 0.763600, Test set accuracy = 0.774400
 epoch 15/30. Took 0.27327 seconds. 
  Full-batch training loss = 1.031308, test loss = 1.010606
  Training set accuracy = 0.778900, Test set accuracy = 0.788300
 epoch 16/30. Took 0.28218 seconds. 
  Full-batch training loss = 0.958807, test loss = 0.937506
  Training set accuracy = 0.791000, Test set accuracy = 0.799300
 epoch 17/30. Took 0.27321 seconds. 
  Full-batch training loss = 0.896197, test loss = 0.874767
  Training set accuracy = 0.801100, Test set accuracy = 0.806100
 epoch 18/30. Took 0.26994 seconds. 
  Full-batch training loss = 0.842588, test loss = 0.821258
  Training set accuracy = 0.806300, Test set accuracy = 0.812800
 epoch 19/30. Took 0.27977 seconds. 
  Full-batch training loss = 0.796626, test loss = 0.776072
  Training set accuracy = 0.815400, Test set accuracy = 0.820300
 epoch 20/30. Took 0.29894 seconds. 
  Full-batch training loss = 0.756405, test loss = 0.735594
  Training set accuracy = 0.822900, Test set accuracy = 0.826900
 epoch 21/30. Took 0.26715 seconds. 
  Full-batch training loss = 0.721796, test loss = 0.701380
  Training set accuracy = 0.825900, Test set accuracy = 0.830500
 epoch 22/30. Took 0.27407 seconds. 
  Full-batch training loss = 0.691616, test loss = 0.671420
  Training set accuracy = 0.833300, Test set accuracy = 0.837700
 epoch 23/30. Took 0.27197 seconds. 
  Full-batch training loss = 0.665185, test loss = 0.645439
  Training set accuracy = 0.838300, Test set accuracy = 0.840900
 epoch 24/30. Took 0.28362 seconds. 
  Full-batch training loss = 0.641241, test loss = 0.622313
  Training set accuracy = 0.841700, Test set accuracy = 0.844200
 epoch 25/30. Took 0.28435 seconds. 
  Full-batch training loss = 0.619818, test loss = 0.601052
  Training set accuracy = 0.845700, Test set accuracy = 0.849600
 epoch 26/30. Took 0.28396 seconds. 
  Full-batch training loss = 0.601014, test loss = 0.582435
  Training set accuracy = 0.849600, Test set accuracy = 0.850800
 epoch 27/30. Took 0.28443 seconds. 
  Full-batch training loss = 0.584089, test loss = 0.565949
  Training set accuracy = 0.853700, Test set accuracy = 0.853400
 epoch 28/30. Took 0.28394 seconds. 
  Full-batch training loss = 0.568597, test loss = 0.550760
  Training set accuracy = 0.856000, Test set accuracy = 0.856400
 epoch 29/30. Took 0.28432 seconds. 
  Full-batch training loss = 0.554451, test loss = 0.537281
  Training set accuracy = 0.859500, Test set accuracy = 0.859800
 epoch 30/30. Took 0.28096 seconds. 
  Full-batch training loss = 0.542425, test loss = 0.525867
  Training set accuracy = 0.862500, Test set accuracy = 0.862200
Elapsed time is 15.676040 seconds.
End Training
-----
Params 10000 0.001 0.20 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.50029 seconds. 
  Full-batch training loss = 2.267564, test loss = 2.268929
  Training set accuracy = 0.204700, Test set accuracy = 0.206300
 epoch 2/30. Took 0.46939 seconds. 
  Full-batch training loss = 2.215165, test loss = 2.215663
  Training set accuracy = 0.358100, Test set accuracy = 0.350900
 epoch 3/30. Took 0.49689 seconds. 
  Full-batch training loss = 2.154801, test loss = 2.154045
  Training set accuracy = 0.458400, Test set accuracy = 0.451900
 epoch 4/30. Took 0.47334 seconds. 
  Full-batch training loss = 2.082322, test loss = 2.079861
  Training set accuracy = 0.549600, Test set accuracy = 0.546700
 epoch 5/30. Took 0.48353 seconds. 
  Full-batch training loss = 1.992617, test loss = 1.987945
  Training set accuracy = 0.620300, Test set accuracy = 0.623800
 epoch 6/30. Took 0.47051 seconds. 
  Full-batch training loss = 1.884609, test loss = 1.877209
  Training set accuracy = 0.671000, Test set accuracy = 0.680600
 epoch 7/30. Took 0.50186 seconds. 
  Full-batch training loss = 1.757231, test loss = 1.746595
  Training set accuracy = 0.702200, Test set accuracy = 0.710600
 epoch 8/30. Took 0.46678 seconds. 
  Full-batch training loss = 1.613404, test loss = 1.599818
  Training set accuracy = 0.725100, Test set accuracy = 0.731900
 epoch 9/30. Took 0.47069 seconds. 
  Full-batch training loss = 1.461740, test loss = 1.445335
  Training set accuracy = 0.737000, Test set accuracy = 0.742800
 epoch 10/30. Took 0.46676 seconds. 
  Full-batch training loss = 1.312469, test loss = 1.294434
  Training set accuracy = 0.758000, Test set accuracy = 0.759900
 epoch 11/30. Took 0.46775 seconds. 
  Full-batch training loss = 1.177051, test loss = 1.158520
  Training set accuracy = 0.770600, Test set accuracy = 0.771300
 epoch 12/30. Took 0.47453 seconds. 
  Full-batch training loss = 1.059677, test loss = 1.040305
  Training set accuracy = 0.787600, Test set accuracy = 0.785200
 epoch 13/30. Took 0.47304 seconds. 
  Full-batch training loss = 0.962078, test loss = 0.942557
  Training set accuracy = 0.798200, Test set accuracy = 0.800300
 epoch 14/30. Took 0.47224 seconds. 
  Full-batch training loss = 0.882094, test loss = 0.863462
  Training set accuracy = 0.808600, Test set accuracy = 0.810700
 epoch 15/30. Took 0.46973 seconds. 
  Full-batch training loss = 0.815889, test loss = 0.797572
  Training set accuracy = 0.817400, Test set accuracy = 0.821000
 epoch 16/30. Took 0.47308 seconds. 
  Full-batch training loss = 0.761438, test loss = 0.743820
  Training set accuracy = 0.824200, Test set accuracy = 0.829300
 epoch 17/30. Took 0.51042 seconds. 
  Full-batch training loss = 0.716215, test loss = 0.698898
  Training set accuracy = 0.832400, Test set accuracy = 0.837000
 epoch 18/30. Took 0.47367 seconds. 
  Full-batch training loss = 0.677810, test loss = 0.661277
  Training set accuracy = 0.836000, Test set accuracy = 0.841600
 epoch 19/30. Took 0.47156 seconds. 
  Full-batch training loss = 0.645814, test loss = 0.629775
  Training set accuracy = 0.842000, Test set accuracy = 0.847500
 epoch 20/30. Took 0.47792 seconds. 
  Full-batch training loss = 0.618188, test loss = 0.602919
  Training set accuracy = 0.846000, Test set accuracy = 0.851000
 epoch 21/30. Took 0.46848 seconds. 
  Full-batch training loss = 0.594126, test loss = 0.579673
  Training set accuracy = 0.852200, Test set accuracy = 0.854100
 epoch 22/30. Took 0.46863 seconds. 
  Full-batch training loss = 0.573012, test loss = 0.559442
  Training set accuracy = 0.857100, Test set accuracy = 0.857100
 epoch 23/30. Took 0.48556 seconds. 
  Full-batch training loss = 0.554359, test loss = 0.540215
  Training set accuracy = 0.859700, Test set accuracy = 0.861900
 epoch 24/30. Took 0.51867 seconds. 
  Full-batch training loss = 0.537366, test loss = 0.524067
  Training set accuracy = 0.863600, Test set accuracy = 0.864600
 epoch 25/30. Took 0.49956 seconds. 
  Full-batch training loss = 0.522003, test loss = 0.509515
  Training set accuracy = 0.867800, Test set accuracy = 0.868800
 epoch 26/30. Took 0.47224 seconds. 
  Full-batch training loss = 0.508341, test loss = 0.496143
  Training set accuracy = 0.870300, Test set accuracy = 0.871400
 epoch 27/30. Took 0.49098 seconds. 
  Full-batch training loss = 0.495934, test loss = 0.483720
  Training set accuracy = 0.872200, Test set accuracy = 0.874600
 epoch 28/30. Took 0.47552 seconds. 
  Full-batch training loss = 0.484522, test loss = 0.472785
  Training set accuracy = 0.873900, Test set accuracy = 0.876700
 epoch 29/30. Took 0.4746 seconds. 
  Full-batch training loss = 0.474261, test loss = 0.463709
  Training set accuracy = 0.875700, Test set accuracy = 0.878900
 epoch 30/30. Took 0.47299 seconds. 
  Full-batch training loss = 0.464445, test loss = 0.454233
  Training set accuracy = 0.877600, Test set accuracy = 0.880300
Elapsed time is 25.230257 seconds.
End Training
-----
Params 10000 0.001 0.20 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.307 seconds. 
  Full-batch training loss = 2.238068, test loss = 2.239669
  Training set accuracy = 0.356600, Test set accuracy = 0.352900
 epoch 2/30. Took 1.2289 seconds. 
  Full-batch training loss = 2.157626, test loss = 2.158061
  Training set accuracy = 0.490300, Test set accuracy = 0.483600
 epoch 3/30. Took 1.2338 seconds. 
  Full-batch training loss = 2.066468, test loss = 2.065763
  Training set accuracy = 0.570700, Test set accuracy = 0.564200
 epoch 4/30. Took 1.2015 seconds. 
  Full-batch training loss = 1.957138, test loss = 1.954990
  Training set accuracy = 0.626300, Test set accuracy = 0.622900
 epoch 5/30. Took 1.2053 seconds. 
  Full-batch training loss = 1.826687, test loss = 1.822643
  Training set accuracy = 0.666900, Test set accuracy = 0.664400
 epoch 6/30. Took 1.2253 seconds. 
  Full-batch training loss = 1.677421, test loss = 1.671493
  Training set accuracy = 0.693600, Test set accuracy = 0.691200
 epoch 7/30. Took 1.2389 seconds. 
  Full-batch training loss = 1.517614, test loss = 1.509995
  Training set accuracy = 0.713300, Test set accuracy = 0.714100
 epoch 8/30. Took 1.2395 seconds. 
  Full-batch training loss = 1.359512, test loss = 1.349850
  Training set accuracy = 0.742100, Test set accuracy = 0.745200
 epoch 9/30. Took 1.2224 seconds. 
  Full-batch training loss = 1.214102, test loss = 1.202563
  Training set accuracy = 0.767000, Test set accuracy = 0.768900
 epoch 10/30. Took 1.2319 seconds. 
  Full-batch training loss = 1.088375, test loss = 1.076116
  Training set accuracy = 0.784000, Test set accuracy = 0.787500
 epoch 11/30. Took 1.2083 seconds. 
  Full-batch training loss = 0.983573, test loss = 0.970417
  Training set accuracy = 0.800600, Test set accuracy = 0.804000
 epoch 12/30. Took 1.2825 seconds. 
  Full-batch training loss = 0.897076, test loss = 0.884029
  Training set accuracy = 0.809900, Test set accuracy = 0.812400
 epoch 13/30. Took 1.26 seconds. 
  Full-batch training loss = 0.826047, test loss = 0.813142
  Training set accuracy = 0.818100, Test set accuracy = 0.819800
 epoch 14/30. Took 1.199 seconds. 
  Full-batch training loss = 0.767637, test loss = 0.755032
  Training set accuracy = 0.824900, Test set accuracy = 0.830800
 epoch 15/30. Took 1.298 seconds. 
  Full-batch training loss = 0.718951, test loss = 0.706671
  Training set accuracy = 0.832900, Test set accuracy = 0.838200
 epoch 16/30. Took 1.2071 seconds. 
  Full-batch training loss = 0.677664, test loss = 0.666029
  Training set accuracy = 0.836600, Test set accuracy = 0.843500
 epoch 17/30. Took 1.2562 seconds. 
  Full-batch training loss = 0.642481, test loss = 0.631724
  Training set accuracy = 0.846100, Test set accuracy = 0.852100
 epoch 18/30. Took 1.2001 seconds. 
  Full-batch training loss = 0.613039, test loss = 0.602523
  Training set accuracy = 0.850200, Test set accuracy = 0.856100
 epoch 19/30. Took 1.205 seconds. 
  Full-batch training loss = 0.586681, test loss = 0.576831
  Training set accuracy = 0.851100, Test set accuracy = 0.858600
 epoch 20/30. Took 1.2187 seconds. 
  Full-batch training loss = 0.563472, test loss = 0.554848
  Training set accuracy = 0.857600, Test set accuracy = 0.862600
 epoch 21/30. Took 1.2031 seconds. 
  Full-batch training loss = 0.543108, test loss = 0.535048
  Training set accuracy = 0.860100, Test set accuracy = 0.866700
 epoch 22/30. Took 1.2265 seconds. 
  Full-batch training loss = 0.525336, test loss = 0.517208
  Training set accuracy = 0.863700, Test set accuracy = 0.868400
 epoch 23/30. Took 1.23 seconds. 
  Full-batch training loss = 0.509176, test loss = 0.501857
  Training set accuracy = 0.866100, Test set accuracy = 0.871500
 epoch 24/30. Took 1.2105 seconds. 
  Full-batch training loss = 0.494645, test loss = 0.488012
  Training set accuracy = 0.870900, Test set accuracy = 0.874200
 epoch 25/30. Took 1.1994 seconds. 
  Full-batch training loss = 0.481872, test loss = 0.475999
  Training set accuracy = 0.872200, Test set accuracy = 0.875200
 epoch 26/30. Took 1.2239 seconds. 
  Full-batch training loss = 0.469845, test loss = 0.464564
  Training set accuracy = 0.875900, Test set accuracy = 0.877900
 epoch 27/30. Took 1.255 seconds. 
  Full-batch training loss = 0.458544, test loss = 0.453588
  Training set accuracy = 0.879500, Test set accuracy = 0.880600
 epoch 28/30. Took 1.2028 seconds. 
  Full-batch training loss = 0.448240, test loss = 0.444609
  Training set accuracy = 0.880900, Test set accuracy = 0.882500
 epoch 29/30. Took 1.2209 seconds. 
  Full-batch training loss = 0.438995, test loss = 0.435888
  Training set accuracy = 0.883600, Test set accuracy = 0.884100
 epoch 30/30. Took 1.2101 seconds. 
  Full-batch training loss = 0.430842, test loss = 0.428098
  Training set accuracy = 0.884000, Test set accuracy = 0.885300
Elapsed time is 62.827651 seconds.
End Training
-----
Params 10000 0.001 0.20 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.33974 seconds. 
  Full-batch training loss = 2.295937, test loss = 2.294601
  Training set accuracy = 0.096800, Test set accuracy = 0.099400
 epoch 2/30. Took 0.33636 seconds. 
  Full-batch training loss = 2.274737, test loss = 2.273387
  Training set accuracy = 0.134300, Test set accuracy = 0.140400
 epoch 3/30. Took 0.33837 seconds. 
  Full-batch training loss = 2.251436, test loss = 2.250110
  Training set accuracy = 0.246400, Test set accuracy = 0.241900
 epoch 4/30. Took 0.3321 seconds. 
  Full-batch training loss = 2.224832, test loss = 2.223506
  Training set accuracy = 0.334600, Test set accuracy = 0.327000
 epoch 5/30. Took 0.34111 seconds. 
  Full-batch training loss = 2.193844, test loss = 2.192449
  Training set accuracy = 0.391600, Test set accuracy = 0.381900
 epoch 6/30. Took 0.33818 seconds. 
  Full-batch training loss = 2.156757, test loss = 2.155335
  Training set accuracy = 0.429500, Test set accuracy = 0.420000
 epoch 7/30. Took 0.31912 seconds. 
  Full-batch training loss = 2.111893, test loss = 2.110461
  Training set accuracy = 0.452200, Test set accuracy = 0.445200
 epoch 8/30. Took 0.34076 seconds. 
  Full-batch training loss = 2.056562, test loss = 2.055161
  Training set accuracy = 0.469500, Test set accuracy = 0.460100
 epoch 9/30. Took 0.31997 seconds. 
  Full-batch training loss = 1.988773, test loss = 1.987347
  Training set accuracy = 0.495100, Test set accuracy = 0.486100
 epoch 10/30. Took 0.32191 seconds. 
  Full-batch training loss = 1.906937, test loss = 1.905491
  Training set accuracy = 0.517600, Test set accuracy = 0.507700
 epoch 11/30. Took 0.31914 seconds. 
  Full-batch training loss = 1.811780, test loss = 1.809999
  Training set accuracy = 0.537500, Test set accuracy = 0.530600
 epoch 12/30. Took 0.32322 seconds. 
  Full-batch training loss = 1.705207, test loss = 1.703300
  Training set accuracy = 0.562600, Test set accuracy = 0.552600
 epoch 13/30. Took 0.34949 seconds. 
  Full-batch training loss = 1.592827, test loss = 1.590394
  Training set accuracy = 0.590200, Test set accuracy = 0.582200
 epoch 14/30. Took 0.33137 seconds. 
  Full-batch training loss = 1.477265, test loss = 1.474307
  Training set accuracy = 0.616900, Test set accuracy = 0.610900
 epoch 15/30. Took 0.33433 seconds. 
  Full-batch training loss = 1.365486, test loss = 1.361478
  Training set accuracy = 0.651900, Test set accuracy = 0.651000
 epoch 16/30. Took 0.33594 seconds. 
  Full-batch training loss = 1.259652, test loss = 1.254914
  Training set accuracy = 0.673400, Test set accuracy = 0.673700
 epoch 17/30. Took 0.32751 seconds. 
  Full-batch training loss = 1.164861, test loss = 1.159951
  Training set accuracy = 0.694600, Test set accuracy = 0.691800
 epoch 18/30. Took 0.33009 seconds. 
  Full-batch training loss = 1.080078, test loss = 1.074702
  Training set accuracy = 0.715700, Test set accuracy = 0.708800
 epoch 19/30. Took 0.33808 seconds. 
  Full-batch training loss = 1.007368, test loss = 1.002088
  Training set accuracy = 0.732900, Test set accuracy = 0.724700
 epoch 20/30. Took 0.33531 seconds. 
  Full-batch training loss = 0.944596, test loss = 0.938971
  Training set accuracy = 0.745700, Test set accuracy = 0.740200
 epoch 21/30. Took 0.3209 seconds. 
  Full-batch training loss = 0.890655, test loss = 0.884646
  Training set accuracy = 0.760000, Test set accuracy = 0.757600
 epoch 22/30. Took 0.32876 seconds. 
  Full-batch training loss = 0.843094, test loss = 0.837006
  Training set accuracy = 0.776000, Test set accuracy = 0.773100
 epoch 23/30. Took 0.33592 seconds. 
  Full-batch training loss = 0.803589, test loss = 0.797921
  Training set accuracy = 0.780800, Test set accuracy = 0.779100
 epoch 24/30. Took 0.33656 seconds. 
  Full-batch training loss = 0.767812, test loss = 0.762184
  Training set accuracy = 0.791100, Test set accuracy = 0.789500
 epoch 25/30. Took 0.33702 seconds. 
  Full-batch training loss = 0.736683, test loss = 0.730410
  Training set accuracy = 0.802100, Test set accuracy = 0.800000
 epoch 26/30. Took 0.33714 seconds. 
  Full-batch training loss = 0.708972, test loss = 0.703612
  Training set accuracy = 0.803400, Test set accuracy = 0.802000
 epoch 27/30. Took 0.33716 seconds. 
  Full-batch training loss = 0.684314, test loss = 0.679011
  Training set accuracy = 0.812900, Test set accuracy = 0.811100
 epoch 28/30. Took 0.33569 seconds. 
  Full-batch training loss = 0.662081, test loss = 0.656588
  Training set accuracy = 0.818300, Test set accuracy = 0.818200
 epoch 29/30. Took 0.33807 seconds. 
  Full-batch training loss = 0.641682, test loss = 0.636018
  Training set accuracy = 0.825400, Test set accuracy = 0.824200
 epoch 30/30. Took 0.34781 seconds. 
  Full-batch training loss = 0.622306, test loss = 0.617243
  Training set accuracy = 0.830300, Test set accuracy = 0.832100
Elapsed time is 18.176931 seconds.
End Training
-----
Params 10000 0.001 0.20 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.58176 seconds. 
  Full-batch training loss = 2.284686, test loss = 2.285648
  Training set accuracy = 0.136000, Test set accuracy = 0.127800
 epoch 2/30. Took 0.57335 seconds. 
  Full-batch training loss = 2.265997, test loss = 2.266461
  Training set accuracy = 0.244500, Test set accuracy = 0.224100
 epoch 3/30. Took 0.63636 seconds. 
  Full-batch training loss = 2.244837, test loss = 2.244744
  Training set accuracy = 0.396200, Test set accuracy = 0.390300
 epoch 4/30. Took 0.57536 seconds. 
  Full-batch training loss = 2.219329, test loss = 2.218556
  Training set accuracy = 0.499800, Test set accuracy = 0.495000
 epoch 5/30. Took 0.57871 seconds. 
  Full-batch training loss = 2.187646, test loss = 2.186164
  Training set accuracy = 0.557200, Test set accuracy = 0.552600
 epoch 6/30. Took 0.55522 seconds. 
  Full-batch training loss = 2.146863, test loss = 2.144494
  Training set accuracy = 0.588700, Test set accuracy = 0.585800
 epoch 7/30. Took 0.5707 seconds. 
  Full-batch training loss = 2.093817, test loss = 2.090270
  Training set accuracy = 0.616400, Test set accuracy = 0.612900
 epoch 8/30. Took 0.56838 seconds. 
  Full-batch training loss = 2.025790, test loss = 2.020718
  Training set accuracy = 0.649400, Test set accuracy = 0.646500
 epoch 9/30. Took 0.57877 seconds. 
  Full-batch training loss = 1.939764, test loss = 1.932789
  Training set accuracy = 0.685300, Test set accuracy = 0.683300
 epoch 10/30. Took 0.57047 seconds. 
  Full-batch training loss = 1.832983, test loss = 1.823855
  Training set accuracy = 0.702400, Test set accuracy = 0.702500
 epoch 11/30. Took 0.57756 seconds. 
  Full-batch training loss = 1.705112, test loss = 1.693621
  Training set accuracy = 0.721000, Test set accuracy = 0.723000
 epoch 12/30. Took 0.5779 seconds. 
  Full-batch training loss = 1.557392, test loss = 1.543334
  Training set accuracy = 0.737300, Test set accuracy = 0.739600
 epoch 13/30. Took 0.57727 seconds. 
  Full-batch training loss = 1.400878, test loss = 1.384830
  Training set accuracy = 0.751500, Test set accuracy = 0.750900
 epoch 14/30. Took 0.5658 seconds. 
  Full-batch training loss = 1.248195, test loss = 1.230476
  Training set accuracy = 0.763900, Test set accuracy = 0.765400
 epoch 15/30. Took 0.57206 seconds. 
  Full-batch training loss = 1.111963, test loss = 1.094133
  Training set accuracy = 0.775700, Test set accuracy = 0.780000
 epoch 16/30. Took 0.57581 seconds. 
  Full-batch training loss = 0.997195, test loss = 0.979208
  Training set accuracy = 0.788100, Test set accuracy = 0.793000
 epoch 17/30. Took 0.57801 seconds. 
  Full-batch training loss = 0.905497, test loss = 0.888001
  Training set accuracy = 0.792000, Test set accuracy = 0.798100
 epoch 18/30. Took 0.57785 seconds. 
  Full-batch training loss = 0.831387, test loss = 0.813937
  Training set accuracy = 0.806300, Test set accuracy = 0.811100
 epoch 19/30. Took 0.57441 seconds. 
  Full-batch training loss = 0.773437, test loss = 0.756196
  Training set accuracy = 0.812100, Test set accuracy = 0.816500
 epoch 20/30. Took 0.5895 seconds. 
  Full-batch training loss = 0.725616, test loss = 0.708904
  Training set accuracy = 0.821900, Test set accuracy = 0.824800
 epoch 21/30. Took 0.57686 seconds. 
  Full-batch training loss = 0.685948, test loss = 0.668611
  Training set accuracy = 0.828900, Test set accuracy = 0.831400
 epoch 22/30. Took 0.57879 seconds. 
  Full-batch training loss = 0.653457, test loss = 0.636481
  Training set accuracy = 0.833600, Test set accuracy = 0.835600
 epoch 23/30. Took 0.57393 seconds. 
  Full-batch training loss = 0.625666, test loss = 0.608946
  Training set accuracy = 0.841800, Test set accuracy = 0.844600
 epoch 24/30. Took 0.57462 seconds. 
  Full-batch training loss = 0.601516, test loss = 0.585503
  Training set accuracy = 0.844300, Test set accuracy = 0.845900
 epoch 25/30. Took 0.57777 seconds. 
  Full-batch training loss = 0.581131, test loss = 0.564909
  Training set accuracy = 0.847400, Test set accuracy = 0.852200
 epoch 26/30. Took 0.58511 seconds. 
  Full-batch training loss = 0.562884, test loss = 0.547090
  Training set accuracy = 0.850200, Test set accuracy = 0.855600
 epoch 27/30. Took 0.59639 seconds. 
  Full-batch training loss = 0.546385, test loss = 0.531305
  Training set accuracy = 0.854300, Test set accuracy = 0.857800
 epoch 28/30. Took 0.56471 seconds. 
  Full-batch training loss = 0.532563, test loss = 0.517960
  Training set accuracy = 0.857400, Test set accuracy = 0.860100
 epoch 29/30. Took 0.57243 seconds. 
  Full-batch training loss = 0.518127, test loss = 0.503697
  Training set accuracy = 0.861100, Test set accuracy = 0.865600
 epoch 30/30. Took 0.57335 seconds. 
  Full-batch training loss = 0.506081, test loss = 0.492168
  Training set accuracy = 0.863500, Test set accuracy = 0.866900
Elapsed time is 30.671343 seconds.
End Training
-----
Params 10000 0.001 0.20 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.7696 seconds. 
  Full-batch training loss = 2.277786, test loss = 2.276089
  Training set accuracy = 0.226800, Test set accuracy = 0.241000
 epoch 2/30. Took 1.7035 seconds. 
  Full-batch training loss = 2.249170, test loss = 2.247149
  Training set accuracy = 0.390900, Test set accuracy = 0.408300
 epoch 3/30. Took 1.6882 seconds. 
  Full-batch training loss = 2.217170, test loss = 2.214709
  Training set accuracy = 0.469100, Test set accuracy = 0.490100
 epoch 4/30. Took 1.701 seconds. 
  Full-batch training loss = 2.179220, test loss = 2.176213
  Training set accuracy = 0.518800, Test set accuracy = 0.540800
 epoch 5/30. Took 1.6685 seconds. 
  Full-batch training loss = 2.132851, test loss = 2.129147
  Training set accuracy = 0.557600, Test set accuracy = 0.573600
 epoch 6/30. Took 1.6744 seconds. 
  Full-batch training loss = 2.074907, test loss = 2.070294
  Training set accuracy = 0.597200, Test set accuracy = 0.609700
 epoch 7/30. Took 1.653 seconds. 
  Full-batch training loss = 2.001399, test loss = 1.995545
  Training set accuracy = 0.639200, Test set accuracy = 0.648000
 epoch 8/30. Took 1.6592 seconds. 
  Full-batch training loss = 1.908323, test loss = 1.900829
  Training set accuracy = 0.669500, Test set accuracy = 0.678600
 epoch 9/30. Took 1.7332 seconds. 
  Full-batch training loss = 1.791989, test loss = 1.782121
  Training set accuracy = 0.689900, Test set accuracy = 0.699000
 epoch 10/30. Took 1.7083 seconds. 
  Full-batch training loss = 1.653410, test loss = 1.641050
  Training set accuracy = 0.707500, Test set accuracy = 0.717900
 epoch 11/30. Took 1.6873 seconds. 
  Full-batch training loss = 1.498807, test loss = 1.483932
  Training set accuracy = 0.722000, Test set accuracy = 0.732500
 epoch 12/30. Took 1.6621 seconds. 
  Full-batch training loss = 1.340601, test loss = 1.323529
  Training set accuracy = 0.734900, Test set accuracy = 0.745400
 epoch 13/30. Took 1.6917 seconds. 
  Full-batch training loss = 1.192432, test loss = 1.173713
  Training set accuracy = 0.754200, Test set accuracy = 0.761100
 epoch 14/30. Took 1.6957 seconds. 
  Full-batch training loss = 1.063434, test loss = 1.044107
  Training set accuracy = 0.772800, Test set accuracy = 0.779300
 epoch 15/30. Took 1.7464 seconds. 
  Full-batch training loss = 0.956301, test loss = 0.937087
  Training set accuracy = 0.788800, Test set accuracy = 0.791300
 epoch 16/30. Took 1.7192 seconds. 
  Full-batch training loss = 0.868925, test loss = 0.849794
  Training set accuracy = 0.801300, Test set accuracy = 0.802800
 epoch 17/30. Took 1.6625 seconds. 
  Full-batch training loss = 0.798041, test loss = 0.779310
  Training set accuracy = 0.810600, Test set accuracy = 0.814100
 epoch 18/30. Took 1.684 seconds. 
  Full-batch training loss = 0.740040, test loss = 0.721721
  Training set accuracy = 0.822200, Test set accuracy = 0.823000
 epoch 19/30. Took 1.6612 seconds. 
  Full-batch training loss = 0.691254, test loss = 0.672989
  Training set accuracy = 0.830500, Test set accuracy = 0.835400
 epoch 20/30. Took 1.6842 seconds. 
  Full-batch training loss = 0.651834, test loss = 0.634661
  Training set accuracy = 0.833900, Test set accuracy = 0.837400
 epoch 21/30. Took 1.6854 seconds. 
  Full-batch training loss = 0.617420, test loss = 0.600645
  Training set accuracy = 0.845800, Test set accuracy = 0.850700
 epoch 22/30. Took 1.6738 seconds. 
  Full-batch training loss = 0.587895, test loss = 0.571975
  Training set accuracy = 0.850400, Test set accuracy = 0.852700
 epoch 23/30. Took 1.7212 seconds. 
  Full-batch training loss = 0.562077, test loss = 0.547431
  Training set accuracy = 0.856500, Test set accuracy = 0.858100
 epoch 24/30. Took 1.6738 seconds. 
  Full-batch training loss = 0.541085, test loss = 0.526750
  Training set accuracy = 0.860200, Test set accuracy = 0.861200
 epoch 25/30. Took 1.6606 seconds. 
  Full-batch training loss = 0.521577, test loss = 0.507534
  Training set accuracy = 0.863800, Test set accuracy = 0.866400
 epoch 26/30. Took 1.711 seconds. 
  Full-batch training loss = 0.505038, test loss = 0.492105
  Training set accuracy = 0.867500, Test set accuracy = 0.869600
 epoch 27/30. Took 1.6952 seconds. 
  Full-batch training loss = 0.489527, test loss = 0.477371
  Training set accuracy = 0.870200, Test set accuracy = 0.871200
 epoch 28/30. Took 1.6566 seconds. 
  Full-batch training loss = 0.475472, test loss = 0.463712
  Training set accuracy = 0.872900, Test set accuracy = 0.876100
 epoch 29/30. Took 1.6635 seconds. 
  Full-batch training loss = 0.461575, test loss = 0.449435
  Training set accuracy = 0.878000, Test set accuracy = 0.879500
 epoch 30/30. Took 1.7119 seconds. 
  Full-batch training loss = 0.450426, test loss = 0.439705
  Training set accuracy = 0.881300, Test set accuracy = 0.880600
Elapsed time is 86.670506 seconds.
End Training
-----
Params 10000 0.001 0.30 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23054 seconds. 
  Full-batch training loss = 2.165755, test loss = 2.165286
  Training set accuracy = 0.308900, Test set accuracy = 0.308400
 epoch 2/30. Took 0.23463 seconds. 
  Full-batch training loss = 2.031773, test loss = 2.029884
  Training set accuracy = 0.460900, Test set accuracy = 0.470300
 epoch 3/30. Took 0.22602 seconds. 
  Full-batch training loss = 1.895227, test loss = 1.892223
  Training set accuracy = 0.574800, Test set accuracy = 0.592400
 epoch 4/30. Took 0.22985 seconds. 
  Full-batch training loss = 1.757264, test loss = 1.753093
  Training set accuracy = 0.658500, Test set accuracy = 0.671000
 epoch 5/30. Took 0.23355 seconds. 
  Full-batch training loss = 1.621797, test loss = 1.616127
  Training set accuracy = 0.714400, Test set accuracy = 0.727600
 epoch 6/30. Took 0.22393 seconds. 
  Full-batch training loss = 1.493435, test loss = 1.486128
  Training set accuracy = 0.750900, Test set accuracy = 0.760800
 epoch 7/30. Took 0.22437 seconds. 
  Full-batch training loss = 1.374347, test loss = 1.365654
  Training set accuracy = 0.777600, Test set accuracy = 0.787200
 epoch 8/30. Took 0.22364 seconds. 
  Full-batch training loss = 1.266651, test loss = 1.256631
  Training set accuracy = 0.795600, Test set accuracy = 0.803700
 epoch 9/30. Took 0.22868 seconds. 
  Full-batch training loss = 1.171315, test loss = 1.160329
  Training set accuracy = 0.808200, Test set accuracy = 0.815500
 epoch 10/30. Took 0.23129 seconds. 
  Full-batch training loss = 1.088184, test loss = 1.076476
  Training set accuracy = 0.816000, Test set accuracy = 0.822700
 epoch 11/30. Took 0.23248 seconds. 
  Full-batch training loss = 1.015713, test loss = 1.003651
  Training set accuracy = 0.823600, Test set accuracy = 0.829900
 epoch 12/30. Took 0.22543 seconds. 
  Full-batch training loss = 0.953342, test loss = 0.941074
  Training set accuracy = 0.829100, Test set accuracy = 0.836200
 epoch 13/30. Took 0.22984 seconds. 
  Full-batch training loss = 0.898858, test loss = 0.886571
  Training set accuracy = 0.834100, Test set accuracy = 0.839400
 epoch 14/30. Took 0.22912 seconds. 
  Full-batch training loss = 0.851567, test loss = 0.839605
  Training set accuracy = 0.838600, Test set accuracy = 0.843500
 epoch 15/30. Took 0.22995 seconds. 
  Full-batch training loss = 0.810523, test loss = 0.798734
  Training set accuracy = 0.842000, Test set accuracy = 0.847200
 epoch 16/30. Took 0.22874 seconds. 
  Full-batch training loss = 0.774507, test loss = 0.762942
  Training set accuracy = 0.846500, Test set accuracy = 0.850900
 epoch 17/30. Took 0.23199 seconds. 
  Full-batch training loss = 0.742300, test loss = 0.731407
  Training set accuracy = 0.849500, Test set accuracy = 0.854600
 epoch 18/30. Took 0.2343 seconds. 
  Full-batch training loss = 0.714148, test loss = 0.703762
  Training set accuracy = 0.852100, Test set accuracy = 0.855700
 epoch 19/30. Took 0.2347 seconds. 
  Full-batch training loss = 0.688691, test loss = 0.678855
  Training set accuracy = 0.854700, Test set accuracy = 0.860000
 epoch 20/30. Took 0.22857 seconds. 
  Full-batch training loss = 0.665952, test loss = 0.656765
  Training set accuracy = 0.858400, Test set accuracy = 0.862300
 epoch 21/30. Took 0.22616 seconds. 
  Full-batch training loss = 0.645607, test loss = 0.637051
  Training set accuracy = 0.859800, Test set accuracy = 0.864400
 epoch 22/30. Took 0.22404 seconds. 
  Full-batch training loss = 0.627458, test loss = 0.619523
  Training set accuracy = 0.863300, Test set accuracy = 0.865400
 epoch 23/30. Took 0.22358 seconds. 
  Full-batch training loss = 0.610680, test loss = 0.603305
  Training set accuracy = 0.864900, Test set accuracy = 0.867400
 epoch 24/30. Took 0.22794 seconds. 
  Full-batch training loss = 0.594908, test loss = 0.588003
  Training set accuracy = 0.866500, Test set accuracy = 0.869300
 epoch 25/30. Took 0.23059 seconds. 
  Full-batch training loss = 0.580935, test loss = 0.574311
  Training set accuracy = 0.868000, Test set accuracy = 0.869900
 epoch 26/30. Took 0.22714 seconds. 
  Full-batch training loss = 0.568117, test loss = 0.562003
  Training set accuracy = 0.869000, Test set accuracy = 0.871800
 epoch 27/30. Took 0.22815 seconds. 
  Full-batch training loss = 0.555961, test loss = 0.550451
  Training set accuracy = 0.871000, Test set accuracy = 0.872100
 epoch 28/30. Took 0.22509 seconds. 
  Full-batch training loss = 0.544807, test loss = 0.539914
  Training set accuracy = 0.872200, Test set accuracy = 0.874700
 epoch 29/30. Took 0.22991 seconds. 
  Full-batch training loss = 0.534242, test loss = 0.529649
  Training set accuracy = 0.873500, Test set accuracy = 0.876700
 epoch 30/30. Took 0.22425 seconds. 
  Full-batch training loss = 0.524589, test loss = 0.520609
  Training set accuracy = 0.875900, Test set accuracy = 0.877700
Elapsed time is 13.237881 seconds.
End Training
-----
Params 10000 0.001 0.30 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35572 seconds. 
  Full-batch training loss = 2.181656, test loss = 2.176006
  Training set accuracy = 0.346300, Test set accuracy = 0.356800
 epoch 2/30. Took 0.35746 seconds. 
  Full-batch training loss = 2.041620, test loss = 2.034013
  Training set accuracy = 0.554000, Test set accuracy = 0.570100
 epoch 3/30. Took 0.35144 seconds. 
  Full-batch training loss = 1.898260, test loss = 1.888838
  Training set accuracy = 0.648700, Test set accuracy = 0.657300
 epoch 4/30. Took 0.36748 seconds. 
  Full-batch training loss = 1.750207, test loss = 1.738887
  Training set accuracy = 0.696700, Test set accuracy = 0.706400
 epoch 5/30. Took 0.35319 seconds. 
  Full-batch training loss = 1.604152, test loss = 1.591071
  Training set accuracy = 0.727900, Test set accuracy = 0.737900
 epoch 6/30. Took 0.35184 seconds. 
  Full-batch training loss = 1.466064, test loss = 1.451722
  Training set accuracy = 0.750000, Test set accuracy = 0.760300
 epoch 7/30. Took 0.35177 seconds. 
  Full-batch training loss = 1.340801, test loss = 1.325396
  Training set accuracy = 0.768900, Test set accuracy = 0.778800
 epoch 8/30. Took 0.34982 seconds. 
  Full-batch training loss = 1.230472, test loss = 1.214700
  Training set accuracy = 0.782500, Test set accuracy = 0.790700
 epoch 9/30. Took 0.35376 seconds. 
  Full-batch training loss = 1.134334, test loss = 1.118556
  Training set accuracy = 0.795400, Test set accuracy = 0.801300
 epoch 10/30. Took 0.35354 seconds. 
  Full-batch training loss = 1.051943, test loss = 1.036432
  Training set accuracy = 0.804900, Test set accuracy = 0.810400
 epoch 11/30. Took 0.37765 seconds. 
  Full-batch training loss = 0.981946, test loss = 0.966976
  Training set accuracy = 0.813100, Test set accuracy = 0.818400
 epoch 12/30. Took 0.35157 seconds. 
  Full-batch training loss = 0.921912, test loss = 0.907539
  Training set accuracy = 0.819400, Test set accuracy = 0.825700
 epoch 13/30. Took 0.35315 seconds. 
  Full-batch training loss = 0.870035, test loss = 0.856232
  Training set accuracy = 0.825600, Test set accuracy = 0.831700
 epoch 14/30. Took 0.34972 seconds. 
  Full-batch training loss = 0.825374, test loss = 0.812162
  Training set accuracy = 0.832200, Test set accuracy = 0.837400
 epoch 15/30. Took 0.35192 seconds. 
  Full-batch training loss = 0.786278, test loss = 0.773555
  Training set accuracy = 0.836600, Test set accuracy = 0.842100
 epoch 16/30. Took 0.35147 seconds. 
  Full-batch training loss = 0.752165, test loss = 0.739996
  Training set accuracy = 0.842200, Test set accuracy = 0.847700
 epoch 17/30. Took 0.35168 seconds. 
  Full-batch training loss = 0.722093, test loss = 0.710650
  Training set accuracy = 0.844600, Test set accuracy = 0.849300
 epoch 18/30. Took 0.35068 seconds. 
  Full-batch training loss = 0.695305, test loss = 0.684369
  Training set accuracy = 0.849000, Test set accuracy = 0.853400
 epoch 19/30. Took 0.37865 seconds. 
  Full-batch training loss = 0.671471, test loss = 0.660798
  Training set accuracy = 0.852600, Test set accuracy = 0.857300
 epoch 20/30. Took 0.3515 seconds. 
  Full-batch training loss = 0.650143, test loss = 0.640189
  Training set accuracy = 0.856700, Test set accuracy = 0.859600
 epoch 21/30. Took 0.35322 seconds. 
  Full-batch training loss = 0.630658, test loss = 0.621220
  Training set accuracy = 0.859100, Test set accuracy = 0.860600
 epoch 22/30. Took 0.34894 seconds. 
  Full-batch training loss = 0.613082, test loss = 0.604046
  Training set accuracy = 0.860800, Test set accuracy = 0.863800
 epoch 23/30. Took 0.38197 seconds. 
  Full-batch training loss = 0.597086, test loss = 0.588379
  Training set accuracy = 0.863100, Test set accuracy = 0.866600
 epoch 24/30. Took 0.35835 seconds. 
  Full-batch training loss = 0.582228, test loss = 0.574093
  Training set accuracy = 0.867000, Test set accuracy = 0.868500
 epoch 25/30. Took 0.38775 seconds. 
  Full-batch training loss = 0.568661, test loss = 0.560972
  Training set accuracy = 0.868500, Test set accuracy = 0.869400
 epoch 26/30. Took 0.34833 seconds. 
  Full-batch training loss = 0.556342, test loss = 0.548716
  Training set accuracy = 0.869700, Test set accuracy = 0.872000
 epoch 27/30. Took 0.35106 seconds. 
  Full-batch training loss = 0.544899, test loss = 0.537775
  Training set accuracy = 0.871800, Test set accuracy = 0.874100
 epoch 28/30. Took 0.35205 seconds. 
  Full-batch training loss = 0.534163, test loss = 0.527440
  Training set accuracy = 0.873400, Test set accuracy = 0.875800
 epoch 29/30. Took 0.35222 seconds. 
  Full-batch training loss = 0.524028, test loss = 0.517659
  Training set accuracy = 0.875600, Test set accuracy = 0.878400
 epoch 30/30. Took 0.35294 seconds. 
  Full-batch training loss = 0.514725, test loss = 0.508921
  Training set accuracy = 0.876800, Test set accuracy = 0.878900
Elapsed time is 19.330225 seconds.
End Training
-----
Params 10000 0.001 0.30 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.7226 seconds. 
  Full-batch training loss = 2.176629, test loss = 2.175932
  Training set accuracy = 0.294600, Test set accuracy = 0.291200
 epoch 2/30. Took 0.80403 seconds. 
  Full-batch training loss = 2.014015, test loss = 2.011744
  Training set accuracy = 0.599800, Test set accuracy = 0.600700
 epoch 3/30. Took 0.75232 seconds. 
  Full-batch training loss = 1.853302, test loss = 1.849070
  Training set accuracy = 0.705900, Test set accuracy = 0.705500
 epoch 4/30. Took 0.72152 seconds. 
  Full-batch training loss = 1.693449, test loss = 1.687291
  Training set accuracy = 0.745300, Test set accuracy = 0.743300
 epoch 5/30. Took 0.72846 seconds. 
  Full-batch training loss = 1.539195, test loss = 1.531253
  Training set accuracy = 0.768400, Test set accuracy = 0.768400
 epoch 6/30. Took 0.72218 seconds. 
  Full-batch training loss = 1.396166, test loss = 1.386532
  Training set accuracy = 0.785000, Test set accuracy = 0.784800
 epoch 7/30. Took 0.73382 seconds. 
  Full-batch training loss = 1.268348, test loss = 1.257464
  Training set accuracy = 0.797200, Test set accuracy = 0.797700
 epoch 8/30. Took 0.74162 seconds. 
  Full-batch training loss = 1.157848, test loss = 1.146175
  Training set accuracy = 0.808700, Test set accuracy = 0.809300
 epoch 9/30. Took 0.76266 seconds. 
  Full-batch training loss = 1.063616, test loss = 1.051127
  Training set accuracy = 0.818200, Test set accuracy = 0.817700
 epoch 10/30. Took 0.71838 seconds. 
  Full-batch training loss = 0.984767, test loss = 0.971758
  Training set accuracy = 0.826800, Test set accuracy = 0.826800
 epoch 11/30. Took 0.71855 seconds. 
  Full-batch training loss = 0.918106, test loss = 0.905021
  Training set accuracy = 0.831200, Test set accuracy = 0.831400
 epoch 12/30. Took 0.74988 seconds. 
  Full-batch training loss = 0.861784, test loss = 0.848505
  Training set accuracy = 0.837900, Test set accuracy = 0.838400
 epoch 13/30. Took 0.73661 seconds. 
  Full-batch training loss = 0.814007, test loss = 0.800973
  Training set accuracy = 0.840600, Test set accuracy = 0.840600
 epoch 14/30. Took 0.78188 seconds. 
  Full-batch training loss = 0.772922, test loss = 0.759862
  Training set accuracy = 0.845900, Test set accuracy = 0.846000
 epoch 15/30. Took 0.71858 seconds. 
  Full-batch training loss = 0.737315, test loss = 0.724426
  Training set accuracy = 0.848700, Test set accuracy = 0.849200
 epoch 16/30. Took 0.72022 seconds. 
  Full-batch training loss = 0.706387, test loss = 0.693456
  Training set accuracy = 0.853700, Test set accuracy = 0.854500
 epoch 17/30. Took 0.72308 seconds. 
  Full-batch training loss = 0.679257, test loss = 0.666724
  Training set accuracy = 0.856500, Test set accuracy = 0.856100
 epoch 18/30. Took 0.73139 seconds. 
  Full-batch training loss = 0.655194, test loss = 0.642691
  Training set accuracy = 0.858200, Test set accuracy = 0.859100
 epoch 19/30. Took 0.72071 seconds. 
  Full-batch training loss = 0.633609, test loss = 0.621471
  Training set accuracy = 0.862100, Test set accuracy = 0.861100
 epoch 20/30. Took 0.72581 seconds. 
  Full-batch training loss = 0.614491, test loss = 0.602425
  Training set accuracy = 0.863400, Test set accuracy = 0.862700
 epoch 21/30. Took 0.72702 seconds. 
  Full-batch training loss = 0.597176, test loss = 0.585506
  Training set accuracy = 0.865700, Test set accuracy = 0.865200
 epoch 22/30. Took 0.72118 seconds. 
  Full-batch training loss = 0.581406, test loss = 0.570018
  Training set accuracy = 0.867100, Test set accuracy = 0.868100
 epoch 23/30. Took 0.72351 seconds. 
  Full-batch training loss = 0.567060, test loss = 0.555713
  Training set accuracy = 0.870300, Test set accuracy = 0.871100
 epoch 24/30. Took 0.76284 seconds. 
  Full-batch training loss = 0.553879, test loss = 0.542761
  Training set accuracy = 0.871600, Test set accuracy = 0.872000
 epoch 25/30. Took 0.72027 seconds. 
  Full-batch training loss = 0.541724, test loss = 0.530931
  Training set accuracy = 0.874300, Test set accuracy = 0.873800
 epoch 26/30. Took 0.76657 seconds. 
  Full-batch training loss = 0.530702, test loss = 0.520384
  Training set accuracy = 0.876400, Test set accuracy = 0.876500
 epoch 27/30. Took 0.82562 seconds. 
  Full-batch training loss = 0.520461, test loss = 0.510318
  Training set accuracy = 0.878200, Test set accuracy = 0.878700
 epoch 28/30. Took 0.73004 seconds. 
  Full-batch training loss = 0.511002, test loss = 0.500904
  Training set accuracy = 0.879200, Test set accuracy = 0.879200
 epoch 29/30. Took 0.72219 seconds. 
  Full-batch training loss = 0.502127, test loss = 0.492626
  Training set accuracy = 0.881400, Test set accuracy = 0.881100
 epoch 30/30. Took 0.72011 seconds. 
  Full-batch training loss = 0.493891, test loss = 0.484892
  Training set accuracy = 0.882200, Test set accuracy = 0.882700
Elapsed time is 38.575570 seconds.
End Training
-----
Params 10000 0.001 0.30 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.28535 seconds. 
  Full-batch training loss = 2.279036, test loss = 2.280815
  Training set accuracy = 0.111400, Test set accuracy = 0.102000
 epoch 2/30. Took 0.27392 seconds. 
  Full-batch training loss = 2.252766, test loss = 2.254060
  Training set accuracy = 0.218000, Test set accuracy = 0.216900
 epoch 3/30. Took 0.27347 seconds. 
  Full-batch training loss = 2.224594, test loss = 2.225444
  Training set accuracy = 0.339500, Test set accuracy = 0.342700
 epoch 4/30. Took 0.28691 seconds. 
  Full-batch training loss = 2.192567, test loss = 2.192887
  Training set accuracy = 0.450400, Test set accuracy = 0.450800
 epoch 5/30. Took 0.28634 seconds. 
  Full-batch training loss = 2.154370, test loss = 2.153885
  Training set accuracy = 0.524300, Test set accuracy = 0.527600
 epoch 6/30. Took 0.28633 seconds. 
  Full-batch training loss = 2.109371, test loss = 2.108096
  Training set accuracy = 0.565800, Test set accuracy = 0.570900
 epoch 7/30. Took 0.28677 seconds. 
  Full-batch training loss = 2.055662, test loss = 2.053510
  Training set accuracy = 0.594400, Test set accuracy = 0.595300
 epoch 8/30. Took 0.28548 seconds. 
  Full-batch training loss = 1.993810, test loss = 1.990782
  Training set accuracy = 0.614200, Test set accuracy = 0.614600
 epoch 9/30. Took 0.28824 seconds. 
  Full-batch training loss = 1.922093, test loss = 1.918115
  Training set accuracy = 0.630000, Test set accuracy = 0.626000
 epoch 10/30. Took 0.29963 seconds. 
  Full-batch training loss = 1.841887, test loss = 1.836834
  Training set accuracy = 0.644300, Test set accuracy = 0.641900
 epoch 11/30. Took 0.27475 seconds. 
  Full-batch training loss = 1.754001, test loss = 1.747842
  Training set accuracy = 0.660100, Test set accuracy = 0.656700
 epoch 12/30. Took 0.28606 seconds. 
  Full-batch training loss = 1.660901, test loss = 1.653429
  Training set accuracy = 0.676200, Test set accuracy = 0.673100
 epoch 13/30. Took 0.28694 seconds. 
  Full-batch training loss = 1.565787, test loss = 1.556975
  Training set accuracy = 0.689900, Test set accuracy = 0.688800
 epoch 14/30. Took 0.27599 seconds. 
  Full-batch training loss = 1.471126, test loss = 1.460577
  Training set accuracy = 0.705600, Test set accuracy = 0.705800
 epoch 15/30. Took 0.29388 seconds. 
  Full-batch training loss = 1.379707, test loss = 1.368083
  Training set accuracy = 0.722500, Test set accuracy = 0.721600
 epoch 16/30. Took 0.28551 seconds. 
  Full-batch training loss = 1.292769, test loss = 1.280421
  Training set accuracy = 0.739200, Test set accuracy = 0.738600
 epoch 17/30. Took 0.28555 seconds. 
  Full-batch training loss = 1.212512, test loss = 1.199572
  Training set accuracy = 0.754800, Test set accuracy = 0.755700
 epoch 18/30. Took 0.28267 seconds. 
  Full-batch training loss = 1.139011, test loss = 1.125230
  Training set accuracy = 0.771700, Test set accuracy = 0.768400
 epoch 19/30. Took 0.29351 seconds. 
  Full-batch training loss = 1.072320, test loss = 1.058348
  Training set accuracy = 0.782400, Test set accuracy = 0.779900
 epoch 20/30. Took 0.28583 seconds. 
  Full-batch training loss = 1.014100, test loss = 1.000248
  Training set accuracy = 0.795800, Test set accuracy = 0.793700
 epoch 21/30. Took 0.29078 seconds. 
  Full-batch training loss = 0.960965, test loss = 0.947151
  Training set accuracy = 0.802700, Test set accuracy = 0.801200
 epoch 22/30. Took 0.29355 seconds. 
  Full-batch training loss = 0.914650, test loss = 0.900970
  Training set accuracy = 0.810000, Test set accuracy = 0.807800
 epoch 23/30. Took 0.28382 seconds. 
  Full-batch training loss = 0.873897, test loss = 0.860554
  Training set accuracy = 0.816100, Test set accuracy = 0.813400
 epoch 24/30. Took 0.30762 seconds. 
  Full-batch training loss = 0.837637, test loss = 0.824646
  Training set accuracy = 0.823100, Test set accuracy = 0.821300
 epoch 25/30. Took 0.287 seconds. 
  Full-batch training loss = 0.804422, test loss = 0.792245
  Training set accuracy = 0.827800, Test set accuracy = 0.826400
 epoch 26/30. Took 0.28723 seconds. 
  Full-batch training loss = 0.774651, test loss = 0.762452
  Training set accuracy = 0.832700, Test set accuracy = 0.830900
 epoch 27/30. Took 0.29679 seconds. 
  Full-batch training loss = 0.747891, test loss = 0.735899
  Training set accuracy = 0.835300, Test set accuracy = 0.834400
 epoch 28/30. Took 0.28437 seconds. 
  Full-batch training loss = 0.723063, test loss = 0.711514
  Training set accuracy = 0.839100, Test set accuracy = 0.838300
 epoch 29/30. Took 0.2961 seconds. 
  Full-batch training loss = 0.700696, test loss = 0.689107
  Training set accuracy = 0.842100, Test set accuracy = 0.841400
 epoch 30/30. Took 0.28405 seconds. 
  Full-batch training loss = 0.681095, test loss = 0.669890
  Training set accuracy = 0.844900, Test set accuracy = 0.844100
Elapsed time is 15.942085 seconds.
End Training
-----
Params 10000 0.001 0.30 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.47894 seconds. 
  Full-batch training loss = 2.279280, test loss = 2.278762
  Training set accuracy = 0.154100, Test set accuracy = 0.156900
 epoch 2/30. Took 0.47304 seconds. 
  Full-batch training loss = 2.241011, test loss = 2.239915
  Training set accuracy = 0.321400, Test set accuracy = 0.320100
 epoch 3/30. Took 0.47643 seconds. 
  Full-batch training loss = 2.201350, test loss = 2.199718
  Training set accuracy = 0.414200, Test set accuracy = 0.414400
 epoch 4/30. Took 0.46777 seconds. 
  Full-batch training loss = 2.157527, test loss = 2.155442
  Training set accuracy = 0.467900, Test set accuracy = 0.471200
 epoch 5/30. Took 0.47441 seconds. 
  Full-batch training loss = 2.107189, test loss = 2.104465
  Training set accuracy = 0.523700, Test set accuracy = 0.527400
 epoch 6/30. Took 0.46649 seconds. 
  Full-batch training loss = 2.048297, test loss = 2.044695
  Training set accuracy = 0.580600, Test set accuracy = 0.584100
 epoch 7/30. Took 0.47174 seconds. 
  Full-batch training loss = 1.979050, test loss = 1.974493
  Training set accuracy = 0.628600, Test set accuracy = 0.623600
 epoch 8/30. Took 0.48899 seconds. 
  Full-batch training loss = 1.898718, test loss = 1.893056
  Training set accuracy = 0.662900, Test set accuracy = 0.661000
 epoch 9/30. Took 0.47236 seconds. 
  Full-batch training loss = 1.806921, test loss = 1.799911
  Training set accuracy = 0.685300, Test set accuracy = 0.684900
 epoch 10/30. Took 0.47047 seconds. 
  Full-batch training loss = 1.705391, test loss = 1.696968
  Training set accuracy = 0.702900, Test set accuracy = 0.699400
 epoch 11/30. Took 0.47189 seconds. 
  Full-batch training loss = 1.596255, test loss = 1.586619
  Training set accuracy = 0.721200, Test set accuracy = 0.717700
 epoch 12/30. Took 0.47022 seconds. 
  Full-batch training loss = 1.484285, test loss = 1.473379
  Training set accuracy = 0.734500, Test set accuracy = 0.733100
 epoch 13/30. Took 0.50471 seconds. 
  Full-batch training loss = 1.372898, test loss = 1.361030
  Training set accuracy = 0.752600, Test set accuracy = 0.750700
 epoch 14/30. Took 0.48153 seconds. 
  Full-batch training loss = 1.267179, test loss = 1.254741
  Training set accuracy = 0.766000, Test set accuracy = 0.763200
 epoch 15/30. Took 0.46766 seconds. 
  Full-batch training loss = 1.170167, test loss = 1.157286
  Training set accuracy = 0.780400, Test set accuracy = 0.777700
 epoch 16/30. Took 0.50548 seconds. 
  Full-batch training loss = 1.083559, test loss = 1.070423
  Training set accuracy = 0.793800, Test set accuracy = 0.790100
 epoch 17/30. Took 0.48753 seconds. 
  Full-batch training loss = 1.007848, test loss = 0.994931
  Training set accuracy = 0.802200, Test set accuracy = 0.799700
 epoch 18/30. Took 0.4734 seconds. 
  Full-batch training loss = 0.942783, test loss = 0.930339
  Training set accuracy = 0.809900, Test set accuracy = 0.806600
 epoch 19/30. Took 0.47396 seconds. 
  Full-batch training loss = 0.886942, test loss = 0.874597
  Training set accuracy = 0.814800, Test set accuracy = 0.811400
 epoch 20/30. Took 0.47163 seconds. 
  Full-batch training loss = 0.838794, test loss = 0.827337
  Training set accuracy = 0.817700, Test set accuracy = 0.814500
 epoch 21/30. Took 0.46834 seconds. 
  Full-batch training loss = 0.796660, test loss = 0.785208
  Training set accuracy = 0.821200, Test set accuracy = 0.819800
 epoch 22/30. Took 0.47231 seconds. 
  Full-batch training loss = 0.759996, test loss = 0.748777
  Training set accuracy = 0.826300, Test set accuracy = 0.825800
 epoch 23/30. Took 0.47254 seconds. 
  Full-batch training loss = 0.728169, test loss = 0.717740
  Training set accuracy = 0.827700, Test set accuracy = 0.827600
 epoch 24/30. Took 0.47582 seconds. 
  Full-batch training loss = 0.700852, test loss = 0.691727
  Training set accuracy = 0.830200, Test set accuracy = 0.829900
 epoch 25/30. Took 0.51326 seconds. 
  Full-batch training loss = 0.675282, test loss = 0.665589
  Training set accuracy = 0.838300, Test set accuracy = 0.836800
 epoch 26/30. Took 0.48457 seconds. 
  Full-batch training loss = 0.652460, test loss = 0.643625
  Training set accuracy = 0.842300, Test set accuracy = 0.840100
 epoch 27/30. Took 0.47024 seconds. 
  Full-batch training loss = 0.632298, test loss = 0.623681
  Training set accuracy = 0.842600, Test set accuracy = 0.841900
 epoch 28/30. Took 0.48192 seconds. 
  Full-batch training loss = 0.613957, test loss = 0.605684
  Training set accuracy = 0.848300, Test set accuracy = 0.846100
 epoch 29/30. Took 0.46733 seconds. 
  Full-batch training loss = 0.597900, test loss = 0.590149
  Training set accuracy = 0.850100, Test set accuracy = 0.848800
 epoch 30/30. Took 0.47147 seconds. 
  Full-batch training loss = 0.582564, test loss = 0.575024
  Training set accuracy = 0.852900, Test set accuracy = 0.852000
Elapsed time is 25.242483 seconds.
End Training
-----
Params 10000 0.001 0.30 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2285 seconds. 
  Full-batch training loss = 2.267163, test loss = 2.266725
  Training set accuracy = 0.236600, Test set accuracy = 0.247400
 epoch 2/30. Took 1.2069 seconds. 
  Full-batch training loss = 2.225583, test loss = 2.224389
  Training set accuracy = 0.417000, Test set accuracy = 0.428400
 epoch 3/30. Took 1.3125 seconds. 
  Full-batch training loss = 2.180720, test loss = 2.178726
  Training set accuracy = 0.548500, Test set accuracy = 0.550800
 epoch 4/30. Took 1.2141 seconds. 
  Full-batch training loss = 2.129737, test loss = 2.126821
  Training set accuracy = 0.617700, Test set accuracy = 0.618400
 epoch 5/30. Took 1.239 seconds. 
  Full-batch training loss = 2.070056, test loss = 2.066166
  Training set accuracy = 0.648800, Test set accuracy = 0.651000
 epoch 6/30. Took 1.2093 seconds. 
  Full-batch training loss = 1.999353, test loss = 1.994327
  Training set accuracy = 0.674200, Test set accuracy = 0.675400
 epoch 7/30. Took 1.2015 seconds. 
  Full-batch training loss = 1.915894, test loss = 1.909618
  Training set accuracy = 0.695800, Test set accuracy = 0.694900
 epoch 8/30. Took 1.2029 seconds. 
  Full-batch training loss = 1.818868, test loss = 1.811156
  Training set accuracy = 0.713700, Test set accuracy = 0.714000
 epoch 9/30. Took 1.1984 seconds. 
  Full-batch training loss = 1.709485, test loss = 1.700177
  Training set accuracy = 0.732900, Test set accuracy = 0.732700
 epoch 10/30. Took 1.2033 seconds. 
  Full-batch training loss = 1.590235, test loss = 1.579658
  Training set accuracy = 0.745500, Test set accuracy = 0.745700
 epoch 11/30. Took 1.2038 seconds. 
  Full-batch training loss = 1.464970, test loss = 1.453161
  Training set accuracy = 0.760300, Test set accuracy = 0.761200
 epoch 12/30. Took 1.2039 seconds. 
  Full-batch training loss = 1.341300, test loss = 1.328921
  Training set accuracy = 0.773200, Test set accuracy = 0.777200
 epoch 13/30. Took 1.3505 seconds. 
  Full-batch training loss = 1.224623, test loss = 1.212082
  Training set accuracy = 0.784300, Test set accuracy = 0.789800
 epoch 14/30. Took 1.1982 seconds. 
  Full-batch training loss = 1.119699, test loss = 1.107030
  Training set accuracy = 0.795500, Test set accuracy = 0.799800
 epoch 15/30. Took 1.2338 seconds. 
  Full-batch training loss = 1.027277, test loss = 1.015004
  Training set accuracy = 0.806800, Test set accuracy = 0.808300
 epoch 16/30. Took 1.2014 seconds. 
  Full-batch training loss = 0.948375, test loss = 0.937077
  Training set accuracy = 0.811700, Test set accuracy = 0.816400
 epoch 17/30. Took 1.2196 seconds. 
  Full-batch training loss = 0.880697, test loss = 0.870120
  Training set accuracy = 0.820200, Test set accuracy = 0.823000
 epoch 18/30. Took 1.2755 seconds. 
  Full-batch training loss = 0.822969, test loss = 0.813005
  Training set accuracy = 0.826500, Test set accuracy = 0.829100
 epoch 19/30. Took 1.2005 seconds. 
  Full-batch training loss = 0.774405, test loss = 0.765239
  Training set accuracy = 0.833000, Test set accuracy = 0.833300
 epoch 20/30. Took 1.2309 seconds. 
  Full-batch training loss = 0.732530, test loss = 0.724497
  Training set accuracy = 0.835700, Test set accuracy = 0.836900
 epoch 21/30. Took 1.2018 seconds. 
  Full-batch training loss = 0.695917, test loss = 0.688759
  Training set accuracy = 0.843100, Test set accuracy = 0.842300
 epoch 22/30. Took 1.2132 seconds. 
  Full-batch training loss = 0.664192, test loss = 0.657899
  Training set accuracy = 0.846500, Test set accuracy = 0.846300
 epoch 23/30. Took 1.2002 seconds. 
  Full-batch training loss = 0.636454, test loss = 0.630793
  Training set accuracy = 0.848700, Test set accuracy = 0.849400
 epoch 24/30. Took 1.2081 seconds. 
  Full-batch training loss = 0.612224, test loss = 0.607518
  Training set accuracy = 0.856300, Test set accuracy = 0.855500
 epoch 25/30. Took 1.3177 seconds. 
  Full-batch training loss = 0.590367, test loss = 0.586238
  Training set accuracy = 0.857100, Test set accuracy = 0.856900
 epoch 26/30. Took 1.2203 seconds. 
  Full-batch training loss = 0.570816, test loss = 0.567549
  Training set accuracy = 0.861700, Test set accuracy = 0.862400
 epoch 27/30. Took 1.2174 seconds. 
  Full-batch training loss = 0.553453, test loss = 0.551064
  Training set accuracy = 0.865300, Test set accuracy = 0.865700
 epoch 28/30. Took 1.2848 seconds. 
  Full-batch training loss = 0.537787, test loss = 0.535628
  Training set accuracy = 0.867300, Test set accuracy = 0.867200
 epoch 29/30. Took 1.1996 seconds. 
  Full-batch training loss = 0.523321, test loss = 0.522471
  Training set accuracy = 0.869000, Test set accuracy = 0.870800
 epoch 30/30. Took 1.2163 seconds. 
  Full-batch training loss = 0.510124, test loss = 0.509715
  Training set accuracy = 0.870800, Test set accuracy = 0.870700
Elapsed time is 62.870690 seconds.
End Training
-----
Params 10000 0.001 0.30 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.34442 seconds. 
  Full-batch training loss = 2.298502, test loss = 2.297481
  Training set accuracy = 0.099900, Test set accuracy = 0.109000
 epoch 2/30. Took 0.33624 seconds. 
  Full-batch training loss = 2.292926, test loss = 2.291941
  Training set accuracy = 0.123300, Test set accuracy = 0.137000
 epoch 3/30. Took 0.31735 seconds. 
  Full-batch training loss = 2.287389, test loss = 2.286391
  Training set accuracy = 0.177100, Test set accuracy = 0.185700
 epoch 4/30. Took 0.33255 seconds. 
  Full-batch training loss = 2.281514, test loss = 2.280494
  Training set accuracy = 0.235300, Test set accuracy = 0.240300
 epoch 5/30. Took 0.34926 seconds. 
  Full-batch training loss = 2.274989, test loss = 2.273893
  Training set accuracy = 0.263400, Test set accuracy = 0.267600
 epoch 6/30. Took 0.32486 seconds. 
  Full-batch training loss = 2.267380, test loss = 2.266133
  Training set accuracy = 0.297000, Test set accuracy = 0.289900
 epoch 7/30. Took 0.32709 seconds. 
  Full-batch training loss = 2.258662, test loss = 2.257234
  Training set accuracy = 0.326500, Test set accuracy = 0.316300
 epoch 8/30. Took 0.31583 seconds. 
  Full-batch training loss = 2.248368, test loss = 2.246693
  Training set accuracy = 0.356500, Test set accuracy = 0.348300
 epoch 9/30. Took 0.31824 seconds. 
  Full-batch training loss = 2.236066, test loss = 2.234060
  Training set accuracy = 0.382100, Test set accuracy = 0.376500
 epoch 10/30. Took 0.33305 seconds. 
  Full-batch training loss = 2.221295, test loss = 2.218925
  Training set accuracy = 0.409200, Test set accuracy = 0.406200
 epoch 11/30. Took 0.33865 seconds. 
  Full-batch training loss = 2.203903, test loss = 2.201118
  Training set accuracy = 0.430900, Test set accuracy = 0.430700
 epoch 12/30. Took 0.31788 seconds. 
  Full-batch training loss = 2.183283, test loss = 2.180047
  Training set accuracy = 0.449700, Test set accuracy = 0.449800
 epoch 13/30. Took 0.3247 seconds. 
  Full-batch training loss = 2.158824, test loss = 2.155094
  Training set accuracy = 0.466100, Test set accuracy = 0.464500
 epoch 14/30. Took 0.32613 seconds. 
  Full-batch training loss = 2.130029, test loss = 2.125722
  Training set accuracy = 0.479600, Test set accuracy = 0.477700
 epoch 15/30. Took 0.32973 seconds. 
  Full-batch training loss = 2.096361, test loss = 2.091417
  Training set accuracy = 0.496000, Test set accuracy = 0.488900
 epoch 16/30. Took 0.32591 seconds. 
  Full-batch training loss = 2.055732, test loss = 2.050094
  Training set accuracy = 0.513200, Test set accuracy = 0.508400
 epoch 17/30. Took 0.33246 seconds. 
  Full-batch training loss = 2.008989, test loss = 2.002704
  Training set accuracy = 0.540400, Test set accuracy = 0.533100
 epoch 18/30. Took 0.32078 seconds. 
  Full-batch training loss = 1.954623, test loss = 1.947506
  Training set accuracy = 0.568600, Test set accuracy = 0.563100
 epoch 19/30. Took 0.31756 seconds. 
  Full-batch training loss = 1.891627, test loss = 1.883634
  Training set accuracy = 0.592700, Test set accuracy = 0.586600
 epoch 20/30. Took 0.31727 seconds. 
  Full-batch training loss = 1.820663, test loss = 1.811893
  Training set accuracy = 0.609800, Test set accuracy = 0.605000
 epoch 21/30. Took 0.3164 seconds. 
  Full-batch training loss = 1.743078, test loss = 1.733694
  Training set accuracy = 0.616700, Test set accuracy = 0.612500
 epoch 22/30. Took 0.31723 seconds. 
  Full-batch training loss = 1.661625, test loss = 1.651879
  Training set accuracy = 0.625800, Test set accuracy = 0.623800
 epoch 23/30. Took 0.33836 seconds. 
  Full-batch training loss = 1.576262, test loss = 1.566278
  Training set accuracy = 0.630100, Test set accuracy = 0.631000
 epoch 24/30. Took 0.33892 seconds. 
  Full-batch training loss = 1.489612, test loss = 1.479605
  Training set accuracy = 0.638700, Test set accuracy = 0.639400
 epoch 25/30. Took 0.33236 seconds. 
  Full-batch training loss = 1.405778, test loss = 1.395731
  Training set accuracy = 0.649100, Test set accuracy = 0.647900
 epoch 26/30. Took 0.34593 seconds. 
  Full-batch training loss = 1.327519, test loss = 1.318035
  Training set accuracy = 0.662200, Test set accuracy = 0.662000
 epoch 27/30. Took 0.34007 seconds. 
  Full-batch training loss = 1.255058, test loss = 1.245506
  Training set accuracy = 0.672200, Test set accuracy = 0.673600
 epoch 28/30. Took 0.33862 seconds. 
  Full-batch training loss = 1.188466, test loss = 1.179443
  Training set accuracy = 0.685000, Test set accuracy = 0.685500
 epoch 29/30. Took 0.33897 seconds. 
  Full-batch training loss = 1.131146, test loss = 1.122786
  Training set accuracy = 0.695600, Test set accuracy = 0.696800
 epoch 30/30. Took 0.3253 seconds. 
  Full-batch training loss = 1.080953, test loss = 1.072847
  Training set accuracy = 0.710400, Test set accuracy = 0.710700
Elapsed time is 18.050335 seconds.
End Training
-----
Params 10000 0.001 0.30 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.57971 seconds. 
  Full-batch training loss = 2.300332, test loss = 2.301336
  Training set accuracy = 0.129800, Test set accuracy = 0.132600
 epoch 2/30. Took 0.60261 seconds. 
  Full-batch training loss = 2.291904, test loss = 2.292674
  Training set accuracy = 0.151500, Test set accuracy = 0.151400
 epoch 3/30. Took 0.59844 seconds. 
  Full-batch training loss = 2.283504, test loss = 2.284072
  Training set accuracy = 0.168400, Test set accuracy = 0.165300
 epoch 4/30. Took 0.59007 seconds. 
  Full-batch training loss = 2.274654, test loss = 2.275040
  Training set accuracy = 0.181900, Test set accuracy = 0.178000
 epoch 5/30. Took 0.59261 seconds. 
  Full-batch training loss = 2.265186, test loss = 2.265395
  Training set accuracy = 0.219400, Test set accuracy = 0.216000
 epoch 6/30. Took 0.60301 seconds. 
  Full-batch training loss = 2.254845, test loss = 2.254885
  Training set accuracy = 0.281500, Test set accuracy = 0.273900
 epoch 7/30. Took 0.57106 seconds. 
  Full-batch training loss = 2.243128, test loss = 2.243009
  Training set accuracy = 0.320400, Test set accuracy = 0.316200
 epoch 8/30. Took 0.57994 seconds. 
  Full-batch training loss = 2.229878, test loss = 2.229609
  Training set accuracy = 0.350200, Test set accuracy = 0.343900
 epoch 9/30. Took 0.57868 seconds. 
  Full-batch training loss = 2.214442, test loss = 2.214017
  Training set accuracy = 0.377700, Test set accuracy = 0.370200
 epoch 10/30. Took 0.57941 seconds. 
  Full-batch training loss = 2.196444, test loss = 2.195865
  Training set accuracy = 0.408400, Test set accuracy = 0.399500
 epoch 11/30. Took 0.58114 seconds. 
  Full-batch training loss = 2.175163, test loss = 2.174406
  Training set accuracy = 0.434800, Test set accuracy = 0.424400
 epoch 12/30. Took 0.56032 seconds. 
  Full-batch training loss = 2.149946, test loss = 2.148995
  Training set accuracy = 0.452500, Test set accuracy = 0.443200
 epoch 13/30. Took 0.57952 seconds. 
  Full-batch training loss = 2.120424, test loss = 2.119207
  Training set accuracy = 0.475400, Test set accuracy = 0.462800
 epoch 14/30. Took 0.57432 seconds. 
  Full-batch training loss = 2.085311, test loss = 2.083819
  Training set accuracy = 0.490300, Test set accuracy = 0.477800
 epoch 15/30. Took 0.56585 seconds. 
  Full-batch training loss = 2.044148, test loss = 2.042302
  Training set accuracy = 0.510900, Test set accuracy = 0.496800
 epoch 16/30. Took 0.57386 seconds. 
  Full-batch training loss = 1.996974, test loss = 1.994635
  Training set accuracy = 0.526700, Test set accuracy = 0.516800
 epoch 17/30. Took 0.56027 seconds. 
  Full-batch training loss = 1.942395, test loss = 1.939481
  Training set accuracy = 0.542800, Test set accuracy = 0.536800
 epoch 18/30. Took 0.58699 seconds. 
  Full-batch training loss = 1.880750, test loss = 1.877099
  Training set accuracy = 0.562900, Test set accuracy = 0.556600
 epoch 19/30. Took 0.57179 seconds. 
  Full-batch training loss = 1.811666, test loss = 1.807028
  Training set accuracy = 0.578900, Test set accuracy = 0.575700
 epoch 20/30. Took 0.58209 seconds. 
  Full-batch training loss = 1.734372, test loss = 1.728841
  Training set accuracy = 0.596000, Test set accuracy = 0.596400
 epoch 21/30. Took 0.58168 seconds. 
  Full-batch training loss = 1.649373, test loss = 1.642834
  Training set accuracy = 0.607600, Test set accuracy = 0.609700
 epoch 22/30. Took 0.56344 seconds. 
  Full-batch training loss = 1.559925, test loss = 1.552036
  Training set accuracy = 0.621900, Test set accuracy = 0.626100
 epoch 23/30. Took 0.5837 seconds. 
  Full-batch training loss = 1.468609, test loss = 1.459918
  Training set accuracy = 0.639100, Test set accuracy = 0.639400
 epoch 24/30. Took 0.57367 seconds. 
  Full-batch training loss = 1.376570, test loss = 1.367337
  Training set accuracy = 0.651300, Test set accuracy = 0.651100
 epoch 25/30. Took 0.58438 seconds. 
  Full-batch training loss = 1.290512, test loss = 1.280813
  Training set accuracy = 0.662800, Test set accuracy = 0.664100
 epoch 26/30. Took 0.58149 seconds. 
  Full-batch training loss = 1.211948, test loss = 1.201842
  Training set accuracy = 0.681600, Test set accuracy = 0.680100
 epoch 27/30. Took 0.57867 seconds. 
  Full-batch training loss = 1.142215, test loss = 1.132161
  Training set accuracy = 0.691400, Test set accuracy = 0.689700
 epoch 28/30. Took 0.61271 seconds. 
  Full-batch training loss = 1.080212, test loss = 1.070482
  Training set accuracy = 0.708900, Test set accuracy = 0.710900
 epoch 29/30. Took 0.58807 seconds. 
  Full-batch training loss = 1.024947, test loss = 1.015692
  Training set accuracy = 0.721300, Test set accuracy = 0.722500
 epoch 30/30. Took 0.58943 seconds. 
  Full-batch training loss = 0.976700, test loss = 0.967366
  Training set accuracy = 0.732000, Test set accuracy = 0.737100
Elapsed time is 30.767019 seconds.
End Training
-----
Params 10000 0.001 0.30 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.6664 seconds. 
  Full-batch training loss = 2.292832, test loss = 2.294166
  Training set accuracy = 0.109600, Test set accuracy = 0.101500
 epoch 2/30. Took 1.7247 seconds. 
  Full-batch training loss = 2.281550, test loss = 2.282601
  Training set accuracy = 0.171900, Test set accuracy = 0.163200
 epoch 3/30. Took 1.7331 seconds. 
  Full-batch training loss = 2.269957, test loss = 2.270714
  Training set accuracy = 0.247200, Test set accuracy = 0.242600
 epoch 4/30. Took 1.654 seconds. 
  Full-batch training loss = 2.257537, test loss = 2.257998
  Training set accuracy = 0.319500, Test set accuracy = 0.318200
 epoch 5/30. Took 1.6611 seconds. 
  Full-batch training loss = 2.243773, test loss = 2.243874
  Training set accuracy = 0.376800, Test set accuracy = 0.384100
 epoch 6/30. Took 1.6706 seconds. 
  Full-batch training loss = 2.228178, test loss = 2.227888
  Training set accuracy = 0.426700, Test set accuracy = 0.433600
 epoch 7/30. Took 1.7196 seconds. 
  Full-batch training loss = 2.210481, test loss = 2.209723
  Training set accuracy = 0.484400, Test set accuracy = 0.494000
 epoch 8/30. Took 1.705 seconds. 
  Full-batch training loss = 2.189622, test loss = 2.188346
  Training set accuracy = 0.531100, Test set accuracy = 0.543800
 epoch 9/30. Took 1.6576 seconds. 
  Full-batch training loss = 2.165214, test loss = 2.163319
  Training set accuracy = 0.573900, Test set accuracy = 0.584700
 epoch 10/30. Took 1.6624 seconds. 
  Full-batch training loss = 2.135777, test loss = 2.133123
  Training set accuracy = 0.605600, Test set accuracy = 0.612900
 epoch 11/30. Took 1.7878 seconds. 
  Full-batch training loss = 2.100218, test loss = 2.096634
  Training set accuracy = 0.627900, Test set accuracy = 0.630900
 epoch 12/30. Took 1.6713 seconds. 
  Full-batch training loss = 2.057007, test loss = 2.052314
  Training set accuracy = 0.644200, Test set accuracy = 0.649300
 epoch 13/30. Took 1.7021 seconds. 
  Full-batch training loss = 2.004228, test loss = 1.998197
  Training set accuracy = 0.658000, Test set accuracy = 0.662800
 epoch 14/30. Took 1.6604 seconds. 
  Full-batch training loss = 1.940138, test loss = 1.932554
  Training set accuracy = 0.671100, Test set accuracy = 0.670400
 epoch 15/30. Took 1.6638 seconds. 
  Full-batch training loss = 1.863556, test loss = 1.854284
  Training set accuracy = 0.682800, Test set accuracy = 0.680200
 epoch 16/30. Took 1.712 seconds. 
  Full-batch training loss = 1.773219, test loss = 1.761917
  Training set accuracy = 0.692100, Test set accuracy = 0.690000
 epoch 17/30. Took 1.7287 seconds. 
  Full-batch training loss = 1.671763, test loss = 1.658579
  Training set accuracy = 0.698300, Test set accuracy = 0.694200
 epoch 18/30. Took 1.6934 seconds. 
  Full-batch training loss = 1.561430, test loss = 1.546250
  Training set accuracy = 0.708400, Test set accuracy = 0.707600
 epoch 19/30. Took 1.7269 seconds. 
  Full-batch training loss = 1.447428, test loss = 1.430362
  Training set accuracy = 0.720700, Test set accuracy = 0.723700
 epoch 20/30. Took 1.7082 seconds. 
  Full-batch training loss = 1.337060, test loss = 1.318622
  Training set accuracy = 0.730100, Test set accuracy = 0.736500
 epoch 21/30. Took 1.7492 seconds. 
  Full-batch training loss = 1.233894, test loss = 1.214666
  Training set accuracy = 0.741600, Test set accuracy = 0.749100
 epoch 22/30. Took 1.7316 seconds. 
  Full-batch training loss = 1.140763, test loss = 1.120727
  Training set accuracy = 0.755200, Test set accuracy = 0.764300
 epoch 23/30. Took 1.7711 seconds. 
  Full-batch training loss = 1.058271, test loss = 1.037850
  Training set accuracy = 0.762800, Test set accuracy = 0.769400
 epoch 24/30. Took 1.78 seconds. 
  Full-batch training loss = 0.985884, test loss = 0.965448
  Training set accuracy = 0.773300, Test set accuracy = 0.779900
 epoch 25/30. Took 1.7041 seconds. 
  Full-batch training loss = 0.922141, test loss = 0.902379
  Training set accuracy = 0.781600, Test set accuracy = 0.787900
 epoch 26/30. Took 1.6796 seconds. 
  Full-batch training loss = 0.866560, test loss = 0.846649
  Training set accuracy = 0.791700, Test set accuracy = 0.797600
 epoch 27/30. Took 1.6718 seconds. 
  Full-batch training loss = 0.820152, test loss = 0.801094
  Training set accuracy = 0.794800, Test set accuracy = 0.801200
 epoch 28/30. Took 1.7192 seconds. 
  Full-batch training loss = 0.779117, test loss = 0.760472
  Training set accuracy = 0.803100, Test set accuracy = 0.809500
 epoch 29/30. Took 1.6903 seconds. 
  Full-batch training loss = 0.743306, test loss = 0.725039
  Training set accuracy = 0.805000, Test set accuracy = 0.813600
 epoch 30/30. Took 1.7073 seconds. 
  Full-batch training loss = 0.710865, test loss = 0.692603
  Training set accuracy = 0.812800, Test set accuracy = 0.818700
Elapsed time is 86.948960 seconds.
End Training
-----
Params 10000 0.001 0.40 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23628 seconds. 
  Full-batch training loss = 2.239365, test loss = 2.239208
  Training set accuracy = 0.179400, Test set accuracy = 0.178400
 epoch 2/30. Took 0.22983 seconds. 
  Full-batch training loss = 2.159939, test loss = 2.157089
  Training set accuracy = 0.361800, Test set accuracy = 0.362300
 epoch 3/30. Took 0.23307 seconds. 
  Full-batch training loss = 2.074705, test loss = 2.069104
  Training set accuracy = 0.514500, Test set accuracy = 0.511700
 epoch 4/30. Took 0.23567 seconds. 
  Full-batch training loss = 1.981771, test loss = 1.973309
  Training set accuracy = 0.611200, Test set accuracy = 0.608700
 epoch 5/30. Took 0.23403 seconds. 
  Full-batch training loss = 1.882756, test loss = 1.871469
  Training set accuracy = 0.658600, Test set accuracy = 0.658500
 epoch 6/30. Took 0.23103 seconds. 
  Full-batch training loss = 1.779934, test loss = 1.765987
  Training set accuracy = 0.687400, Test set accuracy = 0.688000
 epoch 7/30. Took 0.23232 seconds. 
  Full-batch training loss = 1.674234, test loss = 1.657836
  Training set accuracy = 0.710500, Test set accuracy = 0.709200
 epoch 8/30. Took 0.2328 seconds. 
  Full-batch training loss = 1.569536, test loss = 1.551270
  Training set accuracy = 0.728400, Test set accuracy = 0.727900
 epoch 9/30. Took 0.22873 seconds. 
  Full-batch training loss = 1.468147, test loss = 1.448513
  Training set accuracy = 0.748400, Test set accuracy = 0.750000
 epoch 10/30. Took 0.233 seconds. 
  Full-batch training loss = 1.374316, test loss = 1.353334
  Training set accuracy = 0.768500, Test set accuracy = 0.769400
 epoch 11/30. Took 0.23285 seconds. 
  Full-batch training loss = 1.287958, test loss = 1.266108
  Training set accuracy = 0.782100, Test set accuracy = 0.785700
 epoch 12/30. Took 0.23331 seconds. 
  Full-batch training loss = 1.210130, test loss = 1.187790
  Training set accuracy = 0.793300, Test set accuracy = 0.800800
 epoch 13/30. Took 0.23109 seconds. 
  Full-batch training loss = 1.140961, test loss = 1.118120
  Training set accuracy = 0.802400, Test set accuracy = 0.809600
 epoch 14/30. Took 0.23317 seconds. 
  Full-batch training loss = 1.078690, test loss = 1.055626
  Training set accuracy = 0.810100, Test set accuracy = 0.818000
 epoch 15/30. Took 0.232 seconds. 
  Full-batch training loss = 1.023451, test loss = 1.000151
  Training set accuracy = 0.816400, Test set accuracy = 0.824800
 epoch 16/30. Took 0.23261 seconds. 
  Full-batch training loss = 0.974637, test loss = 0.951520
  Training set accuracy = 0.820300, Test set accuracy = 0.830500
 epoch 17/30. Took 0.23375 seconds. 
  Full-batch training loss = 0.931417, test loss = 0.908508
  Training set accuracy = 0.823200, Test set accuracy = 0.834400
 epoch 18/30. Took 0.23204 seconds. 
  Full-batch training loss = 0.892411, test loss = 0.869428
  Training set accuracy = 0.829400, Test set accuracy = 0.839200
 epoch 19/30. Took 0.2287 seconds. 
  Full-batch training loss = 0.857932, test loss = 0.834935
  Training set accuracy = 0.834100, Test set accuracy = 0.840900
 epoch 20/30. Took 0.23063 seconds. 
  Full-batch training loss = 0.826279, test loss = 0.803611
  Training set accuracy = 0.837000, Test set accuracy = 0.844600
 epoch 21/30. Took 0.23387 seconds. 
  Full-batch training loss = 0.797936, test loss = 0.775357
  Training set accuracy = 0.840500, Test set accuracy = 0.847700
 epoch 22/30. Took 0.23405 seconds. 
  Full-batch training loss = 0.772673, test loss = 0.750174
  Training set accuracy = 0.843200, Test set accuracy = 0.850500
 epoch 23/30. Took 0.24799 seconds. 
  Full-batch training loss = 0.749863, test loss = 0.727839
  Training set accuracy = 0.845100, Test set accuracy = 0.853300
 epoch 24/30. Took 0.22931 seconds. 
  Full-batch training loss = 0.728699, test loss = 0.706724
  Training set accuracy = 0.848000, Test set accuracy = 0.855400
 epoch 25/30. Took 0.22626 seconds. 
  Full-batch training loss = 0.709291, test loss = 0.687759
  Training set accuracy = 0.847500, Test set accuracy = 0.856400
 epoch 26/30. Took 0.23095 seconds. 
  Full-batch training loss = 0.691428, test loss = 0.670209
  Training set accuracy = 0.850600, Test set accuracy = 0.858100
 epoch 27/30. Took 0.22582 seconds. 
  Full-batch training loss = 0.675358, test loss = 0.654274
  Training set accuracy = 0.851900, Test set accuracy = 0.860300
 epoch 28/30. Took 0.22542 seconds. 
  Full-batch training loss = 0.660439, test loss = 0.639541
  Training set accuracy = 0.854700, Test set accuracy = 0.863000
 epoch 29/30. Took 0.22738 seconds. 
  Full-batch training loss = 0.646093, test loss = 0.625364
  Training set accuracy = 0.855800, Test set accuracy = 0.864400
 epoch 30/30. Took 0.2243 seconds. 
  Full-batch training loss = 0.633380, test loss = 0.612897
  Training set accuracy = 0.856400, Test set accuracy = 0.864800
Elapsed time is 13.369482 seconds.
End Training
-----
Params 10000 0.001 0.40 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.37268 seconds. 
  Full-batch training loss = 2.206457, test loss = 2.205731
  Training set accuracy = 0.312000, Test set accuracy = 0.319300
 epoch 2/30. Took 0.35329 seconds. 
  Full-batch training loss = 2.105344, test loss = 2.103283
  Training set accuracy = 0.521300, Test set accuracy = 0.527200
 epoch 3/30. Took 0.36486 seconds. 
  Full-batch training loss = 2.000070, test loss = 1.996655
  Training set accuracy = 0.627200, Test set accuracy = 0.630200
 epoch 4/30. Took 0.37687 seconds. 
  Full-batch training loss = 1.889705, test loss = 1.885056
  Training set accuracy = 0.678300, Test set accuracy = 0.676200
 epoch 5/30. Took 0.35139 seconds. 
  Full-batch training loss = 1.775540, test loss = 1.769732
  Training set accuracy = 0.708900, Test set accuracy = 0.704400
 epoch 6/30. Took 0.36369 seconds. 
  Full-batch training loss = 1.660634, test loss = 1.653585
  Training set accuracy = 0.727200, Test set accuracy = 0.729400
 epoch 7/30. Took 0.38256 seconds. 
  Full-batch training loss = 1.548203, test loss = 1.540127
  Training set accuracy = 0.739700, Test set accuracy = 0.744900
 epoch 8/30. Took 0.36891 seconds. 
  Full-batch training loss = 1.441477, test loss = 1.432472
  Training set accuracy = 0.750300, Test set accuracy = 0.756500
 epoch 9/30. Took 0.35482 seconds. 
  Full-batch training loss = 1.343127, test loss = 1.333561
  Training set accuracy = 0.760600, Test set accuracy = 0.765700
 epoch 10/30. Took 0.35366 seconds. 
  Full-batch training loss = 1.253782, test loss = 1.243636
  Training set accuracy = 0.772200, Test set accuracy = 0.776600
 epoch 11/30. Took 0.35386 seconds. 
  Full-batch training loss = 1.174168, test loss = 1.163352
  Training set accuracy = 0.784300, Test set accuracy = 0.789100
 epoch 12/30. Took 0.3557 seconds. 
  Full-batch training loss = 1.103020, test loss = 1.091936
  Training set accuracy = 0.795700, Test set accuracy = 0.797200
 epoch 13/30. Took 0.36866 seconds. 
  Full-batch training loss = 1.039695, test loss = 1.028399
  Training set accuracy = 0.805400, Test set accuracy = 0.806200
 epoch 14/30. Took 0.35389 seconds. 
  Full-batch training loss = 0.983916, test loss = 0.972514
  Training set accuracy = 0.813300, Test set accuracy = 0.812500
 epoch 15/30. Took 0.35504 seconds. 
  Full-batch training loss = 0.934823, test loss = 0.923345
  Training set accuracy = 0.820300, Test set accuracy = 0.820100
 epoch 16/30. Took 0.35398 seconds. 
  Full-batch training loss = 0.891331, test loss = 0.879901
  Training set accuracy = 0.826400, Test set accuracy = 0.825500
 epoch 17/30. Took 0.35025 seconds. 
  Full-batch training loss = 0.852452, test loss = 0.841290
  Training set accuracy = 0.831000, Test set accuracy = 0.829900
 epoch 18/30. Took 0.38863 seconds. 
  Full-batch training loss = 0.817520, test loss = 0.806556
  Training set accuracy = 0.835600, Test set accuracy = 0.833300
 epoch 19/30. Took 0.35319 seconds. 
  Full-batch training loss = 0.786278, test loss = 0.775406
  Training set accuracy = 0.839100, Test set accuracy = 0.837800
 epoch 20/30. Took 0.37728 seconds. 
  Full-batch training loss = 0.758116, test loss = 0.747577
  Training set accuracy = 0.843300, Test set accuracy = 0.841800
 epoch 21/30. Took 0.40046 seconds. 
  Full-batch training loss = 0.733037, test loss = 0.722940
  Training set accuracy = 0.846800, Test set accuracy = 0.845400
 epoch 22/30. Took 0.35485 seconds. 
  Full-batch training loss = 0.709949, test loss = 0.700059
  Training set accuracy = 0.849600, Test set accuracy = 0.849000
 epoch 23/30. Took 0.35366 seconds. 
  Full-batch training loss = 0.688787, test loss = 0.679092
  Training set accuracy = 0.852200, Test set accuracy = 0.852200
 epoch 24/30. Took 0.38351 seconds. 
  Full-batch training loss = 0.669574, test loss = 0.660144
  Training set accuracy = 0.854600, Test set accuracy = 0.854500
 epoch 25/30. Took 0.35996 seconds. 
  Full-batch training loss = 0.651937, test loss = 0.642852
  Training set accuracy = 0.857200, Test set accuracy = 0.856900
 epoch 26/30. Took 0.39569 seconds. 
  Full-batch training loss = 0.635974, test loss = 0.627513
  Training set accuracy = 0.858000, Test set accuracy = 0.857000
 epoch 27/30. Took 0.35183 seconds. 
  Full-batch training loss = 0.620923, test loss = 0.612626
  Training set accuracy = 0.861700, Test set accuracy = 0.862400
 epoch 28/30. Took 0.35421 seconds. 
  Full-batch training loss = 0.606815, test loss = 0.598886
  Training set accuracy = 0.864100, Test set accuracy = 0.865200
 epoch 29/30. Took 0.35328 seconds. 
  Full-batch training loss = 0.593749, test loss = 0.586078
  Training set accuracy = 0.866800, Test set accuracy = 0.867000
 epoch 30/30. Took 0.35198 seconds. 
  Full-batch training loss = 0.581759, test loss = 0.574521
  Training set accuracy = 0.868600, Test set accuracy = 0.868300
Elapsed time is 19.521298 seconds.
End Training
-----
Params 10000 0.001 0.40 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.74138 seconds. 
  Full-batch training loss = 2.181279, test loss = 2.178068
  Training set accuracy = 0.365600, Test set accuracy = 0.369400
 epoch 2/30. Took 0.76609 seconds. 
  Full-batch training loss = 2.053470, test loss = 2.049240
  Training set accuracy = 0.611400, Test set accuracy = 0.618300
 epoch 3/30. Took 0.75554 seconds. 
  Full-batch training loss = 1.926979, test loss = 1.921276
  Training set accuracy = 0.686300, Test set accuracy = 0.689600
 epoch 4/30. Took 0.73355 seconds. 
  Full-batch training loss = 1.799531, test loss = 1.792373
  Training set accuracy = 0.714300, Test set accuracy = 0.715500
 epoch 5/30. Took 0.73965 seconds. 
  Full-batch training loss = 1.672921, test loss = 1.664065
  Training set accuracy = 0.735900, Test set accuracy = 0.736900
 epoch 6/30. Took 0.73488 seconds. 
  Full-batch training loss = 1.550357, test loss = 1.539901
  Training set accuracy = 0.756000, Test set accuracy = 0.758200
 epoch 7/30. Took 0.75063 seconds. 
  Full-batch training loss = 1.435036, test loss = 1.423123
  Training set accuracy = 0.773200, Test set accuracy = 0.775800
 epoch 8/30. Took 0.76371 seconds. 
  Full-batch training loss = 1.328346, test loss = 1.315229
  Training set accuracy = 0.782600, Test set accuracy = 0.787300
 epoch 9/30. Took 0.73476 seconds. 
  Full-batch training loss = 1.232656, test loss = 1.218862
  Training set accuracy = 0.789700, Test set accuracy = 0.797600
 epoch 10/30. Took 0.74884 seconds. 
  Full-batch training loss = 1.147572, test loss = 1.133217
  Training set accuracy = 0.801400, Test set accuracy = 0.809500
 epoch 11/30. Took 0.76017 seconds. 
  Full-batch training loss = 1.072566, test loss = 1.057861
  Training set accuracy = 0.809300, Test set accuracy = 0.814900
 epoch 12/30. Took 0.73689 seconds. 
  Full-batch training loss = 1.007015, test loss = 0.992167
  Training set accuracy = 0.817000, Test set accuracy = 0.821600
 epoch 13/30. Took 0.73442 seconds. 
  Full-batch training loss = 0.949481, test loss = 0.934721
  Training set accuracy = 0.824600, Test set accuracy = 0.827200
 epoch 14/30. Took 0.73097 seconds. 
  Full-batch training loss = 0.899039, test loss = 0.884177
  Training set accuracy = 0.829300, Test set accuracy = 0.832500
 epoch 15/30. Took 0.73192 seconds. 
  Full-batch training loss = 0.854923, test loss = 0.840496
  Training set accuracy = 0.834400, Test set accuracy = 0.838100
 epoch 16/30. Took 0.73247 seconds. 
  Full-batch training loss = 0.815835, test loss = 0.801562
  Training set accuracy = 0.837200, Test set accuracy = 0.841700
 epoch 17/30. Took 0.73885 seconds. 
  Full-batch training loss = 0.781422, test loss = 0.767667
  Training set accuracy = 0.840900, Test set accuracy = 0.846500
 epoch 18/30. Took 0.74349 seconds. 
  Full-batch training loss = 0.750525, test loss = 0.736972
  Training set accuracy = 0.844000, Test set accuracy = 0.850300
 epoch 19/30. Took 0.75069 seconds. 
  Full-batch training loss = 0.723011, test loss = 0.709842
  Training set accuracy = 0.846900, Test set accuracy = 0.853900
 epoch 20/30. Took 0.73174 seconds. 
  Full-batch training loss = 0.698324, test loss = 0.685625
  Training set accuracy = 0.849500, Test set accuracy = 0.856600
 epoch 21/30. Took 0.73313 seconds. 
  Full-batch training loss = 0.675813, test loss = 0.663544
  Training set accuracy = 0.852000, Test set accuracy = 0.859300
 epoch 22/30. Took 0.73916 seconds. 
  Full-batch training loss = 0.655558, test loss = 0.643550
  Training set accuracy = 0.855000, Test set accuracy = 0.861400
 epoch 23/30. Took 0.73051 seconds. 
  Full-batch training loss = 0.637232, test loss = 0.625957
  Training set accuracy = 0.857300, Test set accuracy = 0.863200
 epoch 24/30. Took 0.73103 seconds. 
  Full-batch training loss = 0.620387, test loss = 0.609314
  Training set accuracy = 0.859600, Test set accuracy = 0.864800
 epoch 25/30. Took 0.76016 seconds. 
  Full-batch training loss = 0.604890, test loss = 0.594423
  Training set accuracy = 0.862000, Test set accuracy = 0.867200
 epoch 26/30. Took 0.76008 seconds. 
  Full-batch training loss = 0.590775, test loss = 0.580863
  Training set accuracy = 0.862400, Test set accuracy = 0.867800
 epoch 27/30. Took 0.73174 seconds. 
  Full-batch training loss = 0.577586, test loss = 0.567716
  Training set accuracy = 0.864700, Test set accuracy = 0.870700
 epoch 28/30. Took 0.72916 seconds. 
  Full-batch training loss = 0.565246, test loss = 0.555863
  Training set accuracy = 0.866200, Test set accuracy = 0.872000
 epoch 29/30. Took 0.72966 seconds. 
  Full-batch training loss = 0.554007, test loss = 0.545202
  Training set accuracy = 0.867100, Test set accuracy = 0.872400
 epoch 30/30. Took 0.75369 seconds. 
  Full-batch training loss = 0.543292, test loss = 0.534806
  Training set accuracy = 0.870400, Test set accuracy = 0.874600
Elapsed time is 38.636653 seconds.
End Training
-----
Params 10000 0.001 0.40 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27062 seconds. 
  Full-batch training loss = 2.294726, test loss = 2.294107
  Training set accuracy = 0.095100, Test set accuracy = 0.097300
 epoch 2/30. Took 0.28497 seconds. 
  Full-batch training loss = 2.281291, test loss = 2.280405
  Training set accuracy = 0.133900, Test set accuracy = 0.135800
 epoch 3/30. Took 0.27223 seconds. 
  Full-batch training loss = 2.266917, test loss = 2.265731
  Training set accuracy = 0.213600, Test set accuracy = 0.219000
 epoch 4/30. Took 0.28042 seconds. 
  Full-batch training loss = 2.251262, test loss = 2.249757
  Training set accuracy = 0.293400, Test set accuracy = 0.297700
 epoch 5/30. Took 0.28662 seconds. 
  Full-batch training loss = 2.233881, test loss = 2.232017
  Training set accuracy = 0.394100, Test set accuracy = 0.394700
 epoch 6/30. Took 0.3111 seconds. 
  Full-batch training loss = 2.214183, test loss = 2.211989
  Training set accuracy = 0.471700, Test set accuracy = 0.470900
 epoch 7/30. Took 0.29197 seconds. 
  Full-batch training loss = 2.192272, test loss = 2.189745
  Training set accuracy = 0.511200, Test set accuracy = 0.517000
 epoch 8/30. Took 0.28158 seconds. 
  Full-batch training loss = 2.167236, test loss = 2.164350
  Training set accuracy = 0.535300, Test set accuracy = 0.538900
 epoch 9/30. Took 0.27856 seconds. 
  Full-batch training loss = 2.138292, test loss = 2.135000
  Training set accuracy = 0.549000, Test set accuracy = 0.551500
 epoch 10/30. Took 0.28452 seconds. 
  Full-batch training loss = 2.106360, test loss = 2.102551
  Training set accuracy = 0.564300, Test set accuracy = 0.564600
 epoch 11/30. Took 0.28724 seconds. 
  Full-batch training loss = 2.069602, test loss = 2.065280
  Training set accuracy = 0.572300, Test set accuracy = 0.574500
 epoch 12/30. Took 0.29929 seconds. 
  Full-batch training loss = 2.028810, test loss = 2.023920
  Training set accuracy = 0.581400, Test set accuracy = 0.580900
 epoch 13/30. Took 0.29635 seconds. 
  Full-batch training loss = 1.983638, test loss = 1.978050
  Training set accuracy = 0.590200, Test set accuracy = 0.590400
 epoch 14/30. Took 0.28262 seconds. 
  Full-batch training loss = 1.934580, test loss = 1.928229
  Training set accuracy = 0.607100, Test set accuracy = 0.605500
 epoch 15/30. Took 0.2757 seconds. 
  Full-batch training loss = 1.881723, test loss = 1.874586
  Training set accuracy = 0.620400, Test set accuracy = 0.621500
 epoch 16/30. Took 0.28888 seconds. 
  Full-batch training loss = 1.824375, test loss = 1.816408
  Training set accuracy = 0.636900, Test set accuracy = 0.636500
 epoch 17/30. Took 0.27859 seconds. 
  Full-batch training loss = 1.764161, test loss = 1.755317
  Training set accuracy = 0.656400, Test set accuracy = 0.652800
 epoch 18/30. Took 0.27741 seconds. 
  Full-batch training loss = 1.701920, test loss = 1.692219
  Training set accuracy = 0.676000, Test set accuracy = 0.668500
 epoch 19/30. Took 0.28654 seconds. 
  Full-batch training loss = 1.637509, test loss = 1.626925
  Training set accuracy = 0.693400, Test set accuracy = 0.684900
 epoch 20/30. Took 0.28317 seconds. 
  Full-batch training loss = 1.573195, test loss = 1.561774
  Training set accuracy = 0.701100, Test set accuracy = 0.695700
 epoch 21/30. Took 0.28726 seconds. 
  Full-batch training loss = 1.506925, test loss = 1.494749
  Training set accuracy = 0.712200, Test set accuracy = 0.708800
 epoch 22/30. Took 0.28627 seconds. 
  Full-batch training loss = 1.443777, test loss = 1.430931
  Training set accuracy = 0.724700, Test set accuracy = 0.721700
 epoch 23/30. Took 0.28741 seconds. 
  Full-batch training loss = 1.381488, test loss = 1.368089
  Training set accuracy = 0.733400, Test set accuracy = 0.732100
 epoch 24/30. Took 0.28639 seconds. 
  Full-batch training loss = 1.321591, test loss = 1.307674
  Training set accuracy = 0.743700, Test set accuracy = 0.742700
 epoch 25/30. Took 0.28804 seconds. 
  Full-batch training loss = 1.265435, test loss = 1.251105
  Training set accuracy = 0.755200, Test set accuracy = 0.755200
 epoch 26/30. Took 0.28668 seconds. 
  Full-batch training loss = 1.213573, test loss = 1.199012
  Training set accuracy = 0.759100, Test set accuracy = 0.761900
 epoch 27/30. Took 0.29126 seconds. 
  Full-batch training loss = 1.163398, test loss = 1.148757
  Training set accuracy = 0.768700, Test set accuracy = 0.768900
 epoch 28/30. Took 0.2739 seconds. 
  Full-batch training loss = 1.117717, test loss = 1.102989
  Training set accuracy = 0.775000, Test set accuracy = 0.775900
 epoch 29/30. Took 0.27869 seconds. 
  Full-batch training loss = 1.075964, test loss = 1.061244
  Training set accuracy = 0.781400, Test set accuracy = 0.782700
 epoch 30/30. Took 0.28765 seconds. 
  Full-batch training loss = 1.037204, test loss = 1.022713
  Training set accuracy = 0.784000, Test set accuracy = 0.785100
Elapsed time is 15.889769 seconds.
End Training
-----
Params 10000 0.001 0.40 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.47583 seconds. 
  Full-batch training loss = 2.287672, test loss = 2.289309
  Training set accuracy = 0.150700, Test set accuracy = 0.152600
 epoch 2/30. Took 0.51778 seconds. 
  Full-batch training loss = 2.271169, test loss = 2.272946
  Training set accuracy = 0.228600, Test set accuracy = 0.219900
 epoch 3/30. Took 0.47051 seconds. 
  Full-batch training loss = 2.254024, test loss = 2.255887
  Training set accuracy = 0.324700, Test set accuracy = 0.311200
 epoch 4/30. Took 0.48597 seconds. 
  Full-batch training loss = 2.235422, test loss = 2.237364
  Training set accuracy = 0.388400, Test set accuracy = 0.378200
 epoch 5/30. Took 0.47213 seconds. 
  Full-batch training loss = 2.214661, test loss = 2.216678
  Training set accuracy = 0.439800, Test set accuracy = 0.429500
 epoch 6/30. Took 0.48147 seconds. 
  Full-batch training loss = 2.191331, test loss = 2.193420
  Training set accuracy = 0.487500, Test set accuracy = 0.473200
 epoch 7/30. Took 0.48588 seconds. 
  Full-batch training loss = 2.164337, test loss = 2.166531
  Training set accuracy = 0.517300, Test set accuracy = 0.503800
 epoch 8/30. Took 0.49213 seconds. 
  Full-batch training loss = 2.133220, test loss = 2.135522
  Training set accuracy = 0.547500, Test set accuracy = 0.534600
 epoch 9/30. Took 0.50317 seconds. 
  Full-batch training loss = 2.097002, test loss = 2.099509
  Training set accuracy = 0.571500, Test set accuracy = 0.557600
 epoch 10/30. Took 0.48379 seconds. 
  Full-batch training loss = 2.055799, test loss = 2.058482
  Training set accuracy = 0.595700, Test set accuracy = 0.586600
 epoch 11/30. Took 0.50399 seconds. 
  Full-batch training loss = 2.009166, test loss = 2.012046
  Training set accuracy = 0.622900, Test set accuracy = 0.610600
 epoch 12/30. Took 0.46242 seconds. 
  Full-batch training loss = 1.955929, test loss = 1.958950
  Training set accuracy = 0.644400, Test set accuracy = 0.633000
 epoch 13/30. Took 0.46977 seconds. 
  Full-batch training loss = 1.896632, test loss = 1.899674
  Training set accuracy = 0.661600, Test set accuracy = 0.653100
 epoch 14/30. Took 0.47013 seconds. 
  Full-batch training loss = 1.830982, test loss = 1.833934
  Training set accuracy = 0.676600, Test set accuracy = 0.670800
 epoch 15/30. Took 0.47136 seconds. 
  Full-batch training loss = 1.760123, test loss = 1.762954
  Training set accuracy = 0.692000, Test set accuracy = 0.685800
 epoch 16/30. Took 0.48164 seconds. 
  Full-batch training loss = 1.684882, test loss = 1.687246
  Training set accuracy = 0.704500, Test set accuracy = 0.701700
 epoch 17/30. Took 0.48633 seconds. 
  Full-batch training loss = 1.605852, test loss = 1.607775
  Training set accuracy = 0.714900, Test set accuracy = 0.710900
 epoch 18/30. Took 0.47537 seconds. 
  Full-batch training loss = 1.525055, test loss = 1.526359
  Training set accuracy = 0.726400, Test set accuracy = 0.723900
 epoch 19/30. Took 0.47977 seconds. 
  Full-batch training loss = 1.445052, test loss = 1.445531
  Training set accuracy = 0.736700, Test set accuracy = 0.736400
 epoch 20/30. Took 0.50157 seconds. 
  Full-batch training loss = 1.366632, test loss = 1.366442
  Training set accuracy = 0.745300, Test set accuracy = 0.746400
 epoch 21/30. Took 0.4707 seconds. 
  Full-batch training loss = 1.290707, test loss = 1.290190
  Training set accuracy = 0.750200, Test set accuracy = 0.753200
 epoch 22/30. Took 0.50967 seconds. 
  Full-batch training loss = 1.219842, test loss = 1.218331
  Training set accuracy = 0.761100, Test set accuracy = 0.766400
 epoch 23/30. Took 0.47696 seconds. 
  Full-batch training loss = 1.153227, test loss = 1.151114
  Training set accuracy = 0.772700, Test set accuracy = 0.776800
 epoch 24/30. Took 0.46561 seconds. 
  Full-batch training loss = 1.094112, test loss = 1.091704
  Training set accuracy = 0.780200, Test set accuracy = 0.782600
 epoch 25/30. Took 0.46776 seconds. 
  Full-batch training loss = 1.040209, test loss = 1.037232
  Training set accuracy = 0.785600, Test set accuracy = 0.790000
 epoch 26/30. Took 0.48541 seconds. 
  Full-batch training loss = 0.991357, test loss = 0.988197
  Training set accuracy = 0.791300, Test set accuracy = 0.794400
 epoch 27/30. Took 0.52046 seconds. 
  Full-batch training loss = 0.946878, test loss = 0.943423
  Training set accuracy = 0.795500, Test set accuracy = 0.800700
 epoch 28/30. Took 0.46879 seconds. 
  Full-batch training loss = 0.906757, test loss = 0.902827
  Training set accuracy = 0.802700, Test set accuracy = 0.806300
 epoch 29/30. Took 0.47124 seconds. 
  Full-batch training loss = 0.871359, test loss = 0.867299
  Training set accuracy = 0.806200, Test set accuracy = 0.810500
 epoch 30/30. Took 0.47473 seconds. 
  Full-batch training loss = 0.839369, test loss = 0.835424
  Training set accuracy = 0.809000, Test set accuracy = 0.814000
Elapsed time is 25.301410 seconds.
End Training
-----
Params 10000 0.001 0.40 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2796 seconds. 
  Full-batch training loss = 2.279445, test loss = 2.280368
  Training set accuracy = 0.216600, Test set accuracy = 0.209900
 epoch 2/30. Took 1.1994 seconds. 
  Full-batch training loss = 2.256315, test loss = 2.256827
  Training set accuracy = 0.313700, Test set accuracy = 0.299300
 epoch 3/30. Took 1.2028 seconds. 
  Full-batch training loss = 2.232396, test loss = 2.232462
  Training set accuracy = 0.423600, Test set accuracy = 0.408700
 epoch 4/30. Took 1.2018 seconds. 
  Full-batch training loss = 2.206380, test loss = 2.205995
  Training set accuracy = 0.509100, Test set accuracy = 0.499300
 epoch 5/30. Took 1.2407 seconds. 
  Full-batch training loss = 2.177170, test loss = 2.176328
  Training set accuracy = 0.564700, Test set accuracy = 0.560900
 epoch 6/30. Took 1.2095 seconds. 
  Full-batch training loss = 2.144094, test loss = 2.142788
  Training set accuracy = 0.604700, Test set accuracy = 0.605600
 epoch 7/30. Took 1.2011 seconds. 
  Full-batch training loss = 2.106163, test loss = 2.104278
  Training set accuracy = 0.637600, Test set accuracy = 0.638700
 epoch 8/30. Took 1.2003 seconds. 
  Full-batch training loss = 2.061792, test loss = 2.059256
  Training set accuracy = 0.659100, Test set accuracy = 0.662300
 epoch 9/30. Took 1.2171 seconds. 
  Full-batch training loss = 2.011066, test loss = 2.007871
  Training set accuracy = 0.673200, Test set accuracy = 0.678000
 epoch 10/30. Took 1.2114 seconds. 
  Full-batch training loss = 1.952340, test loss = 1.948478
  Training set accuracy = 0.680300, Test set accuracy = 0.686200
 epoch 11/30. Took 1.2342 seconds. 
  Full-batch training loss = 1.885510, test loss = 1.880874
  Training set accuracy = 0.691000, Test set accuracy = 0.700300
 epoch 12/30. Took 1.2153 seconds. 
  Full-batch training loss = 1.810284, test loss = 1.804845
  Training set accuracy = 0.697800, Test set accuracy = 0.709200
 epoch 13/30. Took 1.2022 seconds. 
  Full-batch training loss = 1.727120, test loss = 1.720723
  Training set accuracy = 0.715300, Test set accuracy = 0.723900
 epoch 14/30. Took 1.2023 seconds. 
  Full-batch training loss = 1.637365, test loss = 1.630098
  Training set accuracy = 0.726500, Test set accuracy = 0.733600
 epoch 15/30. Took 1.2326 seconds. 
  Full-batch training loss = 1.544025, test loss = 1.536026
  Training set accuracy = 0.737500, Test set accuracy = 0.743900
 epoch 16/30. Took 1.2272 seconds. 
  Full-batch training loss = 1.449670, test loss = 1.440878
  Training set accuracy = 0.749300, Test set accuracy = 0.755800
 epoch 17/30. Took 1.2033 seconds. 
  Full-batch training loss = 1.357712, test loss = 1.348003
  Training set accuracy = 0.761300, Test set accuracy = 0.769400
 epoch 18/30. Took 1.2307 seconds. 
  Full-batch training loss = 1.270089, test loss = 1.259850
  Training set accuracy = 0.769600, Test set accuracy = 0.778200
 epoch 19/30. Took 1.3244 seconds. 
  Full-batch training loss = 1.188617, test loss = 1.177513
  Training set accuracy = 0.778000, Test set accuracy = 0.786300
 epoch 20/30. Took 1.2028 seconds. 
  Full-batch training loss = 1.114878, test loss = 1.103372
  Training set accuracy = 0.786400, Test set accuracy = 0.795000
 epoch 21/30. Took 1.2193 seconds. 
  Full-batch training loss = 1.048937, test loss = 1.037309
  Training set accuracy = 0.791600, Test set accuracy = 0.799600
 epoch 22/30. Took 1.3258 seconds. 
  Full-batch training loss = 0.990110, test loss = 0.978503
  Training set accuracy = 0.800500, Test set accuracy = 0.808400
 epoch 23/30. Took 1.1983 seconds. 
  Full-batch training loss = 0.937952, test loss = 0.926180
  Training set accuracy = 0.805200, Test set accuracy = 0.812600
 epoch 24/30. Took 1.3353 seconds. 
  Full-batch training loss = 0.891517, test loss = 0.879671
  Training set accuracy = 0.809400, Test set accuracy = 0.816000
 epoch 25/30. Took 1.2162 seconds. 
  Full-batch training loss = 0.850622, test loss = 0.838848
  Training set accuracy = 0.814800, Test set accuracy = 0.822400
 epoch 26/30. Took 1.229 seconds. 
  Full-batch training loss = 0.813859, test loss = 0.802200
  Training set accuracy = 0.821300, Test set accuracy = 0.826900
 epoch 27/30. Took 1.2043 seconds. 
  Full-batch training loss = 0.781149, test loss = 0.769582
  Training set accuracy = 0.825000, Test set accuracy = 0.830600
 epoch 28/30. Took 1.2173 seconds. 
  Full-batch training loss = 0.751996, test loss = 0.740855
  Training set accuracy = 0.828900, Test set accuracy = 0.834600
 epoch 29/30. Took 1.2412 seconds. 
  Full-batch training loss = 0.725732, test loss = 0.714699
  Training set accuracy = 0.831500, Test set accuracy = 0.838900
 epoch 30/30. Took 1.2101 seconds. 
  Full-batch training loss = 0.701972, test loss = 0.690849
  Training set accuracy = 0.834500, Test set accuracy = 0.841200
Elapsed time is 62.909748 seconds.
End Training
-----
Params 10000 0.001 0.40 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.32525 seconds. 
  Full-batch training loss = 2.310324, test loss = 2.310752
  Training set accuracy = 0.099000, Test set accuracy = 0.097700
 epoch 2/30. Took 0.34598 seconds. 
  Full-batch training loss = 2.305673, test loss = 2.306119
  Training set accuracy = 0.114500, Test set accuracy = 0.116200
 epoch 3/30. Took 0.33786 seconds. 
  Full-batch training loss = 2.301265, test loss = 2.301700
  Training set accuracy = 0.131800, Test set accuracy = 0.134100
 epoch 4/30. Took 0.33842 seconds. 
  Full-batch training loss = 2.296978, test loss = 2.297384
  Training set accuracy = 0.154000, Test set accuracy = 0.155400
 epoch 5/30. Took 0.35201 seconds. 
  Full-batch training loss = 2.292825, test loss = 2.293192
  Training set accuracy = 0.174900, Test set accuracy = 0.172300
 epoch 6/30. Took 0.3394 seconds. 
  Full-batch training loss = 2.288560, test loss = 2.288870
  Training set accuracy = 0.182800, Test set accuracy = 0.178800
 epoch 7/30. Took 0.33868 seconds. 
  Full-batch training loss = 2.284267, test loss = 2.284504
  Training set accuracy = 0.187800, Test set accuracy = 0.183600
 epoch 8/30. Took 0.35636 seconds. 
  Full-batch training loss = 2.279894, test loss = 2.280041
  Training set accuracy = 0.196300, Test set accuracy = 0.194500
 epoch 9/30. Took 0.33509 seconds. 
  Full-batch training loss = 2.275345, test loss = 2.275391
  Training set accuracy = 0.220500, Test set accuracy = 0.224000
 epoch 10/30. Took 0.33698 seconds. 
  Full-batch training loss = 2.270585, test loss = 2.270535
  Training set accuracy = 0.264900, Test set accuracy = 0.267600
 epoch 11/30. Took 0.34482 seconds. 
  Full-batch training loss = 2.265594, test loss = 2.265428
  Training set accuracy = 0.307100, Test set accuracy = 0.313000
 epoch 12/30. Took 0.34057 seconds. 
  Full-batch training loss = 2.260241, test loss = 2.259958
  Training set accuracy = 0.342000, Test set accuracy = 0.350100
 epoch 13/30. Took 0.33665 seconds. 
  Full-batch training loss = 2.254626, test loss = 2.254196
  Training set accuracy = 0.367600, Test set accuracy = 0.376600
 epoch 14/30. Took 0.35307 seconds. 
  Full-batch training loss = 2.248613, test loss = 2.248046
  Training set accuracy = 0.392800, Test set accuracy = 0.397000
 epoch 15/30. Took 0.33735 seconds. 
  Full-batch training loss = 2.242119, test loss = 2.241413
  Training set accuracy = 0.410200, Test set accuracy = 0.413000
 epoch 16/30. Took 0.33804 seconds. 
  Full-batch training loss = 2.235099, test loss = 2.234256
  Training set accuracy = 0.428900, Test set accuracy = 0.431200
 epoch 17/30. Took 0.33781 seconds. 
  Full-batch training loss = 2.227437, test loss = 2.226405
  Training set accuracy = 0.438900, Test set accuracy = 0.446900
 epoch 18/30. Took 0.35196 seconds. 
  Full-batch training loss = 2.218970, test loss = 2.217731
  Training set accuracy = 0.449600, Test set accuracy = 0.457200
 epoch 19/30. Took 0.33341 seconds. 
  Full-batch training loss = 2.209681, test loss = 2.208186
  Training set accuracy = 0.463600, Test set accuracy = 0.474300
 epoch 20/30. Took 0.32821 seconds. 
  Full-batch training loss = 2.199499, test loss = 2.197771
  Training set accuracy = 0.475800, Test set accuracy = 0.486400
 epoch 21/30. Took 0.33519 seconds. 
  Full-batch training loss = 2.188289, test loss = 2.186329
  Training set accuracy = 0.482700, Test set accuracy = 0.493800
 epoch 22/30. Took 0.33767 seconds. 
  Full-batch training loss = 2.175736, test loss = 2.173492
  Training set accuracy = 0.493600, Test set accuracy = 0.502600
 epoch 23/30. Took 0.33833 seconds. 
  Full-batch training loss = 2.161744, test loss = 2.159173
  Training set accuracy = 0.500000, Test set accuracy = 0.508100
 epoch 24/30. Took 0.32753 seconds. 
  Full-batch training loss = 2.145852, test loss = 2.142924
  Training set accuracy = 0.509100, Test set accuracy = 0.515200
 epoch 25/30. Took 0.32062 seconds. 
  Full-batch training loss = 2.128382, test loss = 2.125084
  Training set accuracy = 0.514200, Test set accuracy = 0.519900
 epoch 26/30. Took 0.3383 seconds. 
  Full-batch training loss = 2.108984, test loss = 2.105285
  Training set accuracy = 0.519600, Test set accuracy = 0.525300
 epoch 27/30. Took 0.33749 seconds. 
  Full-batch training loss = 2.087059, test loss = 2.082941
  Training set accuracy = 0.524400, Test set accuracy = 0.529400
 epoch 28/30. Took 0.32684 seconds. 
  Full-batch training loss = 2.062457, test loss = 2.057838
  Training set accuracy = 0.530800, Test set accuracy = 0.536100
 epoch 29/30. Took 0.33879 seconds. 
  Full-batch training loss = 2.035739, test loss = 2.030690
  Training set accuracy = 0.534900, Test set accuracy = 0.539600
 epoch 30/30. Took 0.32357 seconds. 
  Full-batch training loss = 2.005089, test loss = 1.999523
  Training set accuracy = 0.541200, Test set accuracy = 0.546600
Elapsed time is 18.350435 seconds.
End Training
-----
Params 10000 0.001 0.40 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.56894 seconds. 
  Full-batch training loss = 2.303173, test loss = 2.303615
  Training set accuracy = 0.131900, Test set accuracy = 0.127100
 epoch 2/30. Took 0.55621 seconds. 
  Full-batch training loss = 2.300578, test loss = 2.301079
  Training set accuracy = 0.140000, Test set accuracy = 0.137000
 epoch 3/30. Took 0.57834 seconds. 
  Full-batch training loss = 2.298037, test loss = 2.298599
  Training set accuracy = 0.159700, Test set accuracy = 0.156300
 epoch 4/30. Took 0.57879 seconds. 
  Full-batch training loss = 2.295547, test loss = 2.296150
  Training set accuracy = 0.146200, Test set accuracy = 0.143200
 epoch 5/30. Took 0.62114 seconds. 
  Full-batch training loss = 2.293071, test loss = 2.293711
  Training set accuracy = 0.135900, Test set accuracy = 0.131700
 epoch 6/30. Took 0.56343 seconds. 
  Full-batch training loss = 2.290587, test loss = 2.291255
  Training set accuracy = 0.130500, Test set accuracy = 0.125500
 epoch 7/30. Took 0.5578 seconds. 
  Full-batch training loss = 2.287983, test loss = 2.288678
  Training set accuracy = 0.126800, Test set accuracy = 0.122200
 epoch 8/30. Took 0.57276 seconds. 
  Full-batch training loss = 2.285235, test loss = 2.285951
  Training set accuracy = 0.123400, Test set accuracy = 0.118800
 epoch 9/30. Took 0.58568 seconds. 
  Full-batch training loss = 2.282334, test loss = 2.283059
  Training set accuracy = 0.122600, Test set accuracy = 0.118000
 epoch 10/30. Took 0.57876 seconds. 
  Full-batch training loss = 2.279197, test loss = 2.279925
  Training set accuracy = 0.122700, Test set accuracy = 0.118500
 epoch 11/30. Took 0.64594 seconds. 
  Full-batch training loss = 2.275771, test loss = 2.276490
  Training set accuracy = 0.125200, Test set accuracy = 0.120400
 epoch 12/30. Took 0.63025 seconds. 
  Full-batch training loss = 2.272174, test loss = 2.272872
  Training set accuracy = 0.131200, Test set accuracy = 0.128000
 epoch 13/30. Took 0.59269 seconds. 
  Full-batch training loss = 2.268219, test loss = 2.268893
  Training set accuracy = 0.148400, Test set accuracy = 0.142200
 epoch 14/30. Took 0.57772 seconds. 
  Full-batch training loss = 2.263912, test loss = 2.264547
  Training set accuracy = 0.173100, Test set accuracy = 0.169500
 epoch 15/30. Took 0.5932 seconds. 
  Full-batch training loss = 2.259055, test loss = 2.259641
  Training set accuracy = 0.204100, Test set accuracy = 0.201600
 epoch 16/30. Took 0.59857 seconds. 
  Full-batch training loss = 2.253707, test loss = 2.254233
  Training set accuracy = 0.237500, Test set accuracy = 0.235200
 epoch 17/30. Took 0.55721 seconds. 
  Full-batch training loss = 2.247768, test loss = 2.248245
  Training set accuracy = 0.275700, Test set accuracy = 0.275800
 epoch 18/30. Took 0.56641 seconds. 
  Full-batch training loss = 2.241311, test loss = 2.241717
  Training set accuracy = 0.313800, Test set accuracy = 0.318000
 epoch 19/30. Took 0.61287 seconds. 
  Full-batch training loss = 2.233950, test loss = 2.234271
  Training set accuracy = 0.349600, Test set accuracy = 0.353500
 epoch 20/30. Took 0.57984 seconds. 
  Full-batch training loss = 2.225835, test loss = 2.226045
  Training set accuracy = 0.382900, Test set accuracy = 0.387600
 epoch 21/30. Took 0.5981 seconds. 
  Full-batch training loss = 2.216690, test loss = 2.216763
  Training set accuracy = 0.414100, Test set accuracy = 0.418800
 epoch 22/30. Took 0.56417 seconds. 
  Full-batch training loss = 2.206623, test loss = 2.206555
  Training set accuracy = 0.437500, Test set accuracy = 0.439300
 epoch 23/30. Took 0.56261 seconds. 
  Full-batch training loss = 2.195130, test loss = 2.194912
  Training set accuracy = 0.453400, Test set accuracy = 0.454700
 epoch 24/30. Took 0.55791 seconds. 
  Full-batch training loss = 2.182526, test loss = 2.182148
  Training set accuracy = 0.465100, Test set accuracy = 0.465200
 epoch 25/30. Took 0.57723 seconds. 
  Full-batch training loss = 2.168294, test loss = 2.167715
  Training set accuracy = 0.471500, Test set accuracy = 0.470500
 epoch 26/30. Took 0.5575 seconds. 
  Full-batch training loss = 2.152370, test loss = 2.151556
  Training set accuracy = 0.477800, Test set accuracy = 0.474400
 epoch 27/30. Took 0.55689 seconds. 
  Full-batch training loss = 2.134307, test loss = 2.133215
  Training set accuracy = 0.484000, Test set accuracy = 0.482200
 epoch 28/30. Took 0.55817 seconds. 
  Full-batch training loss = 2.113989, test loss = 2.112579
  Training set accuracy = 0.485900, Test set accuracy = 0.484700
 epoch 29/30. Took 0.56748 seconds. 
  Full-batch training loss = 2.091437, test loss = 2.089667
  Training set accuracy = 0.495700, Test set accuracy = 0.493500
 epoch 30/30. Took 0.57567 seconds. 
  Full-batch training loss = 2.066081, test loss = 2.063922
  Training set accuracy = 0.501000, Test set accuracy = 0.497500
Elapsed time is 30.622046 seconds.
End Training
-----
Params 10000 0.001 0.40 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.681 seconds. 
  Full-batch training loss = 2.298552, test loss = 2.297448
  Training set accuracy = 0.107100, Test set accuracy = 0.116100
 epoch 2/30. Took 1.6698 seconds. 
  Full-batch training loss = 2.293760, test loss = 2.292793
  Training set accuracy = 0.142100, Test set accuracy = 0.147100
 epoch 3/30. Took 1.6772 seconds. 
  Full-batch training loss = 2.289067, test loss = 2.288212
  Training set accuracy = 0.199400, Test set accuracy = 0.203500
 epoch 4/30. Took 1.6873 seconds. 
  Full-batch training loss = 2.284258, test loss = 2.283507
  Training set accuracy = 0.259100, Test set accuracy = 0.263100
 epoch 5/30. Took 1.6627 seconds. 
  Full-batch training loss = 2.279363, test loss = 2.278684
  Training set accuracy = 0.301700, Test set accuracy = 0.307000
 epoch 6/30. Took 1.6937 seconds. 
  Full-batch training loss = 2.274237, test loss = 2.273637
  Training set accuracy = 0.343200, Test set accuracy = 0.349400
 epoch 7/30. Took 1.6812 seconds. 
  Full-batch training loss = 2.268800, test loss = 2.268274
  Training set accuracy = 0.369900, Test set accuracy = 0.376100
 epoch 8/30. Took 1.6751 seconds. 
  Full-batch training loss = 2.263041, test loss = 2.262561
  Training set accuracy = 0.396300, Test set accuracy = 0.398200
 epoch 9/30. Took 1.6556 seconds. 
  Full-batch training loss = 2.256787, test loss = 2.256326
  Training set accuracy = 0.416000, Test set accuracy = 0.422700
 epoch 10/30. Took 1.755 seconds. 
  Full-batch training loss = 2.249987, test loss = 2.249570
  Training set accuracy = 0.436400, Test set accuracy = 0.441600
 epoch 11/30. Took 1.7156 seconds. 
  Full-batch training loss = 2.242555, test loss = 2.242150
  Training set accuracy = 0.452800, Test set accuracy = 0.457800
 epoch 12/30. Took 1.7769 seconds. 
  Full-batch training loss = 2.234400, test loss = 2.233986
  Training set accuracy = 0.472300, Test set accuracy = 0.476900
 epoch 13/30. Took 1.6788 seconds. 
  Full-batch training loss = 2.225198, test loss = 2.224785
  Training set accuracy = 0.484800, Test set accuracy = 0.484900
 epoch 14/30. Took 1.7179 seconds. 
  Full-batch training loss = 2.214968, test loss = 2.214544
  Training set accuracy = 0.495100, Test set accuracy = 0.491600
 epoch 15/30. Took 1.6928 seconds. 
  Full-batch training loss = 2.203346, test loss = 2.202895
  Training set accuracy = 0.503300, Test set accuracy = 0.499400
 epoch 16/30. Took 1.7592 seconds. 
  Full-batch training loss = 2.190256, test loss = 2.189743
  Training set accuracy = 0.514100, Test set accuracy = 0.507600
 epoch 17/30. Took 1.6686 seconds. 
  Full-batch training loss = 2.175311, test loss = 2.174761
  Training set accuracy = 0.521600, Test set accuracy = 0.512900
 epoch 18/30. Took 1.6766 seconds. 
  Full-batch training loss = 2.158281, test loss = 2.157662
  Training set accuracy = 0.527400, Test set accuracy = 0.518000
 epoch 19/30. Took 1.692 seconds. 
  Full-batch training loss = 2.138755, test loss = 2.138042
  Training set accuracy = 0.534100, Test set accuracy = 0.523500
 epoch 20/30. Took 1.664 seconds. 
  Full-batch training loss = 2.116187, test loss = 2.115370
  Training set accuracy = 0.540500, Test set accuracy = 0.528800
 epoch 21/30. Took 1.6647 seconds. 
  Full-batch training loss = 2.090380, test loss = 2.089418
  Training set accuracy = 0.547100, Test set accuracy = 0.537600
 epoch 22/30. Took 1.7465 seconds. 
  Full-batch training loss = 2.060384, test loss = 2.059238
  Training set accuracy = 0.554800, Test set accuracy = 0.544400
 epoch 23/30. Took 1.6652 seconds. 
  Full-batch training loss = 2.025507, test loss = 2.024126
  Training set accuracy = 0.562000, Test set accuracy = 0.554600
 epoch 24/30. Took 1.6493 seconds. 
  Full-batch training loss = 1.985254, test loss = 1.983529
  Training set accuracy = 0.571800, Test set accuracy = 0.567300
 epoch 25/30. Took 1.6859 seconds. 
  Full-batch training loss = 1.938820, test loss = 1.936724
  Training set accuracy = 0.581300, Test set accuracy = 0.578500
 epoch 26/30. Took 1.7026 seconds. 
  Full-batch training loss = 1.885601, test loss = 1.882996
  Training set accuracy = 0.596400, Test set accuracy = 0.593600
 epoch 27/30. Took 1.6535 seconds. 
  Full-batch training loss = 1.825479, test loss = 1.822253
  Training set accuracy = 0.605800, Test set accuracy = 0.603300
 epoch 28/30. Took 1.6888 seconds. 
  Full-batch training loss = 1.758487, test loss = 1.754623
  Training set accuracy = 0.616600, Test set accuracy = 0.611800
 epoch 29/30. Took 1.6758 seconds. 
  Full-batch training loss = 1.684183, test loss = 1.679682
  Training set accuracy = 0.626400, Test set accuracy = 0.620500
 epoch 30/30. Took 1.692 seconds. 
  Full-batch training loss = 1.604638, test loss = 1.599242
  Training set accuracy = 0.638100, Test set accuracy = 0.634700
Elapsed time is 86.570588 seconds.
End Training
-----
Params 10000 0.001 0.50 1 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (100)
Training NN  (784  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.23232 seconds. 
  Full-batch training loss = 2.255086, test loss = 2.251900
  Training set accuracy = 0.213900, Test set accuracy = 0.220800
 epoch 2/30. Took 0.22709 seconds. 
  Full-batch training loss = 2.192140, test loss = 2.187739
  Training set accuracy = 0.360200, Test set accuracy = 0.364200
 epoch 3/30. Took 0.22326 seconds. 
  Full-batch training loss = 2.124471, test loss = 2.118837
  Training set accuracy = 0.501800, Test set accuracy = 0.503900
 epoch 4/30. Took 0.22737 seconds. 
  Full-batch training loss = 2.050940, test loss = 2.043812
  Training set accuracy = 0.586800, Test set accuracy = 0.593800
 epoch 5/30. Took 0.22832 seconds. 
  Full-batch training loss = 1.973434, test loss = 1.964883
  Training set accuracy = 0.639900, Test set accuracy = 0.651900
 epoch 6/30. Took 0.22913 seconds. 
  Full-batch training loss = 1.892878, test loss = 1.882767
  Training set accuracy = 0.676500, Test set accuracy = 0.688500
 epoch 7/30. Took 0.2362 seconds. 
  Full-batch training loss = 1.810583, test loss = 1.798962
  Training set accuracy = 0.700300, Test set accuracy = 0.708800
 epoch 8/30. Took 0.25035 seconds. 
  Full-batch training loss = 1.727484, test loss = 1.714362
  Training set accuracy = 0.715300, Test set accuracy = 0.726200
 epoch 9/30. Took 0.22717 seconds. 
  Full-batch training loss = 1.645839, test loss = 1.631252
  Training set accuracy = 0.729400, Test set accuracy = 0.741700
 epoch 10/30. Took 0.22891 seconds. 
  Full-batch training loss = 1.566840, test loss = 1.550911
  Training set accuracy = 0.741000, Test set accuracy = 0.755000
 epoch 11/30. Took 0.23128 seconds. 
  Full-batch training loss = 1.490782, test loss = 1.473579
  Training set accuracy = 0.748400, Test set accuracy = 0.762900
 epoch 12/30. Took 0.23078 seconds. 
  Full-batch training loss = 1.418412, test loss = 1.400191
  Training set accuracy = 0.757400, Test set accuracy = 0.769000
 epoch 13/30. Took 0.22738 seconds. 
  Full-batch training loss = 1.350823, test loss = 1.331871
  Training set accuracy = 0.767600, Test set accuracy = 0.779700
 epoch 14/30. Took 0.22876 seconds. 
  Full-batch training loss = 1.288250, test loss = 1.268514
  Training set accuracy = 0.776700, Test set accuracy = 0.788000
 epoch 15/30. Took 0.22742 seconds. 
  Full-batch training loss = 1.229959, test loss = 1.209611
  Training set accuracy = 0.782300, Test set accuracy = 0.792400
 epoch 16/30. Took 0.22982 seconds. 
  Full-batch training loss = 1.176774, test loss = 1.156167
  Training set accuracy = 0.790500, Test set accuracy = 0.799400
 epoch 17/30. Took 0.23064 seconds. 
  Full-batch training loss = 1.127873, test loss = 1.106803
  Training set accuracy = 0.796000, Test set accuracy = 0.805200
 epoch 18/30. Took 0.22923 seconds. 
  Full-batch training loss = 1.083582, test loss = 1.062175
  Training set accuracy = 0.800400, Test set accuracy = 0.810900
 epoch 19/30. Took 0.22931 seconds. 
  Full-batch training loss = 1.042268, test loss = 1.020762
  Training set accuracy = 0.806400, Test set accuracy = 0.815400
 epoch 20/30. Took 0.22982 seconds. 
  Full-batch training loss = 1.004698, test loss = 0.982995
  Training set accuracy = 0.812000, Test set accuracy = 0.819400
 epoch 21/30. Took 0.23096 seconds. 
  Full-batch training loss = 0.969733, test loss = 0.947909
  Training set accuracy = 0.815900, Test set accuracy = 0.823200
 epoch 22/30. Took 0.23042 seconds. 
  Full-batch training loss = 0.938194, test loss = 0.916374
  Training set accuracy = 0.819500, Test set accuracy = 0.826900
 epoch 23/30. Took 0.22665 seconds. 
  Full-batch training loss = 0.909243, test loss = 0.887445
  Training set accuracy = 0.824500, Test set accuracy = 0.829500
 epoch 24/30. Took 0.22937 seconds. 
  Full-batch training loss = 0.882009, test loss = 0.860239
  Training set accuracy = 0.826500, Test set accuracy = 0.834000
 epoch 25/30. Took 0.23194 seconds. 
  Full-batch training loss = 0.857144, test loss = 0.835288
  Training set accuracy = 0.830600, Test set accuracy = 0.837500
 epoch 26/30. Took 0.23857 seconds. 
  Full-batch training loss = 0.834211, test loss = 0.812623
  Training set accuracy = 0.835700, Test set accuracy = 0.841100
 epoch 27/30. Took 0.23 seconds. 
  Full-batch training loss = 0.813033, test loss = 0.791717
  Training set accuracy = 0.838700, Test set accuracy = 0.842800
 epoch 28/30. Took 0.2352 seconds. 
  Full-batch training loss = 0.793668, test loss = 0.772442
  Training set accuracy = 0.841100, Test set accuracy = 0.845300
 epoch 29/30. Took 0.23138 seconds. 
  Full-batch training loss = 0.775171, test loss = 0.753932
  Training set accuracy = 0.843400, Test set accuracy = 0.848300
 epoch 30/30. Took 0.23135 seconds. 
  Full-batch training loss = 0.757510, test loss = 0.736393
  Training set accuracy = 0.845300, Test set accuracy = 0.850500
Elapsed time is 13.333559 seconds.
End Training
-----
Params 10000 0.001 0.50 1 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (200)
Training NN  (784  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.35679 seconds. 
  Full-batch training loss = 2.231678, test loss = 2.228146
  Training set accuracy = 0.304700, Test set accuracy = 0.311900
 epoch 2/30. Took 0.35013 seconds. 
  Full-batch training loss = 2.159909, test loss = 2.154818
  Training set accuracy = 0.451400, Test set accuracy = 0.463300
 epoch 3/30. Took 0.37033 seconds. 
  Full-batch training loss = 2.086096, test loss = 2.079446
  Training set accuracy = 0.541200, Test set accuracy = 0.559700
 epoch 4/30. Took 0.35692 seconds. 
  Full-batch training loss = 2.008881, test loss = 2.000664
  Training set accuracy = 0.609800, Test set accuracy = 0.625700
 epoch 5/30. Took 0.34894 seconds. 
  Full-batch training loss = 1.927608, test loss = 1.917698
  Training set accuracy = 0.654400, Test set accuracy = 0.666800
 epoch 6/30. Took 0.3515 seconds. 
  Full-batch training loss = 1.843081, test loss = 1.831400
  Training set accuracy = 0.685800, Test set accuracy = 0.693100
 epoch 7/30. Took 0.34805 seconds. 
  Full-batch training loss = 1.755799, test loss = 1.742442
  Training set accuracy = 0.705400, Test set accuracy = 0.715500
 epoch 8/30. Took 0.35691 seconds. 
  Full-batch training loss = 1.668183, test loss = 1.653267
  Training set accuracy = 0.720400, Test set accuracy = 0.729800
 epoch 9/30. Took 0.35017 seconds. 
  Full-batch training loss = 1.581553, test loss = 1.565111
  Training set accuracy = 0.734200, Test set accuracy = 0.744700
 epoch 10/30. Took 0.34661 seconds. 
  Full-batch training loss = 1.498267, test loss = 1.480633
  Training set accuracy = 0.744900, Test set accuracy = 0.755100
 epoch 11/30. Took 0.3509 seconds. 
  Full-batch training loss = 1.419032, test loss = 1.400189
  Training set accuracy = 0.753900, Test set accuracy = 0.764300
 epoch 12/30. Took 0.35049 seconds. 
  Full-batch training loss = 1.344388, test loss = 1.324525
  Training set accuracy = 0.763800, Test set accuracy = 0.774700
 epoch 13/30. Took 0.35184 seconds. 
  Full-batch training loss = 1.275343, test loss = 1.254767
  Training set accuracy = 0.771600, Test set accuracy = 0.782900
 epoch 14/30. Took 0.35226 seconds. 
  Full-batch training loss = 1.211599, test loss = 1.190529
  Training set accuracy = 0.780300, Test set accuracy = 0.790300
 epoch 15/30. Took 0.35139 seconds. 
  Full-batch training loss = 1.153392, test loss = 1.131948
  Training set accuracy = 0.788600, Test set accuracy = 0.796300
 epoch 16/30. Took 0.35838 seconds. 
  Full-batch training loss = 1.099894, test loss = 1.078136
  Training set accuracy = 0.796400, Test set accuracy = 0.802600
 epoch 17/30. Took 0.37239 seconds. 
  Full-batch training loss = 1.050828, test loss = 1.028840
  Training set accuracy = 0.803100, Test set accuracy = 0.807700
 epoch 18/30. Took 0.3462 seconds. 
  Full-batch training loss = 1.006515, test loss = 0.984427
  Training set accuracy = 0.808900, Test set accuracy = 0.814400
 epoch 19/30. Took 0.36435 seconds. 
  Full-batch training loss = 0.966320, test loss = 0.944170
  Training set accuracy = 0.813400, Test set accuracy = 0.819900
 epoch 20/30. Took 0.34647 seconds. 
  Full-batch training loss = 0.929731, test loss = 0.907850
  Training set accuracy = 0.818000, Test set accuracy = 0.824800
 epoch 21/30. Took 0.34799 seconds. 
  Full-batch training loss = 0.896294, test loss = 0.874687
  Training set accuracy = 0.820800, Test set accuracy = 0.827300
 epoch 22/30. Took 0.34487 seconds. 
  Full-batch training loss = 0.865491, test loss = 0.844056
  Training set accuracy = 0.824100, Test set accuracy = 0.831100
 epoch 23/30. Took 0.36185 seconds. 
  Full-batch training loss = 0.837270, test loss = 0.816132
  Training set accuracy = 0.826900, Test set accuracy = 0.833400
 epoch 24/30. Took 0.34806 seconds. 
  Full-batch training loss = 0.811721, test loss = 0.790983
  Training set accuracy = 0.831300, Test set accuracy = 0.837600
 epoch 25/30. Took 0.35152 seconds. 
  Full-batch training loss = 0.787955, test loss = 0.767536
  Training set accuracy = 0.834600, Test set accuracy = 0.840800
 epoch 26/30. Took 0.34597 seconds. 
  Full-batch training loss = 0.766107, test loss = 0.745988
  Training set accuracy = 0.838000, Test set accuracy = 0.843800
 epoch 27/30. Took 0.35116 seconds. 
  Full-batch training loss = 0.746173, test loss = 0.726337
  Training set accuracy = 0.840100, Test set accuracy = 0.846100
 epoch 28/30. Took 0.34643 seconds. 
  Full-batch training loss = 0.727638, test loss = 0.708192
  Training set accuracy = 0.842800, Test set accuracy = 0.848700
 epoch 29/30. Took 0.35058 seconds. 
  Full-batch training loss = 0.710518, test loss = 0.691359
  Training set accuracy = 0.846500, Test set accuracy = 0.849700
 epoch 30/30. Took 0.35523 seconds. 
  Full-batch training loss = 0.694507, test loss = 0.675771
  Training set accuracy = 0.847800, Test set accuracy = 0.852500
Elapsed time is 19.274243 seconds.
End Training
-----
Params 10000 0.001 0.50 1 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 1 (500)
Training NN  (784  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.73495 seconds. 
  Full-batch training loss = 2.237057, test loss = 2.234454
  Training set accuracy = 0.181800, Test set accuracy = 0.184500
 epoch 2/30. Took 0.73222 seconds. 
  Full-batch training loss = 2.152879, test loss = 2.149172
  Training set accuracy = 0.488700, Test set accuracy = 0.495200
 epoch 3/30. Took 0.73265 seconds. 
  Full-batch training loss = 2.069231, test loss = 2.064403
  Training set accuracy = 0.606500, Test set accuracy = 0.609600
 epoch 4/30. Took 0.72995 seconds. 
  Full-batch training loss = 1.983526, test loss = 1.977459
  Training set accuracy = 0.657800, Test set accuracy = 0.658600
 epoch 5/30. Took 0.72688 seconds. 
  Full-batch training loss = 1.894491, test loss = 1.887098
  Training set accuracy = 0.684300, Test set accuracy = 0.690600
 epoch 6/30. Took 0.72849 seconds. 
  Full-batch training loss = 1.802076, test loss = 1.793302
  Training set accuracy = 0.704600, Test set accuracy = 0.714100
 epoch 7/30. Took 0.73778 seconds. 
  Full-batch training loss = 1.708234, test loss = 1.697951
  Training set accuracy = 0.722800, Test set accuracy = 0.731500
 epoch 8/30. Took 0.80495 seconds. 
  Full-batch training loss = 1.614099, test loss = 1.602368
  Training set accuracy = 0.737400, Test set accuracy = 0.747300
 epoch 9/30. Took 0.75161 seconds. 
  Full-batch training loss = 1.521417, test loss = 1.508404
  Training set accuracy = 0.754800, Test set accuracy = 0.760800
 epoch 10/30. Took 0.7576 seconds. 
  Full-batch training loss = 1.432609, test loss = 1.418407
  Training set accuracy = 0.766700, Test set accuracy = 0.773000
 epoch 11/30. Took 0.83107 seconds. 
  Full-batch training loss = 1.348605, test loss = 1.333425
  Training set accuracy = 0.776100, Test set accuracy = 0.783600
 epoch 12/30. Took 0.73469 seconds. 
  Full-batch training loss = 1.270566, test loss = 1.254548
  Training set accuracy = 0.786400, Test set accuracy = 0.793400
 epoch 13/30. Took 0.7345 seconds. 
  Full-batch training loss = 1.198884, test loss = 1.182250
  Training set accuracy = 0.795000, Test set accuracy = 0.803400
 epoch 14/30. Took 0.73189 seconds. 
  Full-batch training loss = 1.133624, test loss = 1.116570
  Training set accuracy = 0.804500, Test set accuracy = 0.812000
 epoch 15/30. Took 0.73254 seconds. 
  Full-batch training loss = 1.074945, test loss = 1.057611
  Training set accuracy = 0.810200, Test set accuracy = 0.817500
 epoch 16/30. Took 0.73926 seconds. 
  Full-batch training loss = 1.021977, test loss = 1.004490
  Training set accuracy = 0.814700, Test set accuracy = 0.822700
 epoch 17/30. Took 0.72804 seconds. 
  Full-batch training loss = 0.974298, test loss = 0.956701
  Training set accuracy = 0.820700, Test set accuracy = 0.828400
 epoch 18/30. Took 0.75148 seconds. 
  Full-batch training loss = 0.931487, test loss = 0.913944
  Training set accuracy = 0.826400, Test set accuracy = 0.832400
 epoch 19/30. Took 0.73022 seconds. 
  Full-batch training loss = 0.892750, test loss = 0.875232
  Training set accuracy = 0.830700, Test set accuracy = 0.835800
 epoch 20/30. Took 0.75478 seconds. 
  Full-batch training loss = 0.858000, test loss = 0.840658
  Training set accuracy = 0.834500, Test set accuracy = 0.839000
 epoch 21/30. Took 0.75483 seconds. 
  Full-batch training loss = 0.826553, test loss = 0.809453
  Training set accuracy = 0.838900, Test set accuracy = 0.841800
 epoch 22/30. Took 0.73204 seconds. 
  Full-batch training loss = 0.798058, test loss = 0.781089
  Training set accuracy = 0.843800, Test set accuracy = 0.846100
 epoch 23/30. Took 0.745 seconds. 
  Full-batch training loss = 0.772115, test loss = 0.755296
  Training set accuracy = 0.846000, Test set accuracy = 0.849000
 epoch 24/30. Took 0.73554 seconds. 
  Full-batch training loss = 0.748464, test loss = 0.731707
  Training set accuracy = 0.847600, Test set accuracy = 0.849900
 epoch 25/30. Took 0.73129 seconds. 
  Full-batch training loss = 0.726865, test loss = 0.710579
  Training set accuracy = 0.850100, Test set accuracy = 0.852800
 epoch 26/30. Took 0.7301 seconds. 
  Full-batch training loss = 0.707015, test loss = 0.690968
  Training set accuracy = 0.852200, Test set accuracy = 0.854600
 epoch 27/30. Took 0.73762 seconds. 
  Full-batch training loss = 0.688737, test loss = 0.673018
  Training set accuracy = 0.855600, Test set accuracy = 0.856900
 epoch 28/30. Took 0.75179 seconds. 
  Full-batch training loss = 0.671826, test loss = 0.656274
  Training set accuracy = 0.857500, Test set accuracy = 0.857100
 epoch 29/30. Took 0.75691 seconds. 
  Full-batch training loss = 0.656190, test loss = 0.640934
  Training set accuracy = 0.860200, Test set accuracy = 0.859400
 epoch 30/30. Took 0.74416 seconds. 
  Full-batch training loss = 0.641853, test loss = 0.626777
  Training set accuracy = 0.861600, Test set accuracy = 0.860900
Elapsed time is 38.687654 seconds.
End Training
-----
Params 10000 0.001 0.50 2 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (100  100)
Training NN  (784  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.27863 seconds. 
  Full-batch training loss = 2.295726, test loss = 2.297049
  Training set accuracy = 0.124800, Test set accuracy = 0.121700
 epoch 2/30. Took 0.2677 seconds. 
  Full-batch training loss = 2.287407, test loss = 2.288589
  Training set accuracy = 0.129700, Test set accuracy = 0.125100
 epoch 3/30. Took 0.27843 seconds. 
  Full-batch training loss = 2.278756, test loss = 2.279802
  Training set accuracy = 0.132800, Test set accuracy = 0.127300
 epoch 4/30. Took 0.28671 seconds. 
  Full-batch training loss = 2.269566, test loss = 2.270471
  Training set accuracy = 0.132900, Test set accuracy = 0.127700
 epoch 5/30. Took 0.29509 seconds. 
  Full-batch training loss = 2.259858, test loss = 2.260646
  Training set accuracy = 0.139900, Test set accuracy = 0.135400
 epoch 6/30. Took 0.3075 seconds. 
  Full-batch training loss = 2.249697, test loss = 2.250344
  Training set accuracy = 0.174000, Test set accuracy = 0.170300
 epoch 7/30. Took 0.27589 seconds. 
  Full-batch training loss = 2.238702, test loss = 2.239195
  Training set accuracy = 0.232500, Test set accuracy = 0.223600
 epoch 8/30. Took 0.28391 seconds. 
  Full-batch training loss = 2.226703, test loss = 2.227080
  Training set accuracy = 0.302700, Test set accuracy = 0.292000
 epoch 9/30. Took 0.28523 seconds. 
  Full-batch training loss = 2.213539, test loss = 2.213757
  Training set accuracy = 0.366300, Test set accuracy = 0.354000
 epoch 10/30. Took 0.29175 seconds. 
  Full-batch training loss = 2.199152, test loss = 2.199164
  Training set accuracy = 0.422600, Test set accuracy = 0.414300
 epoch 11/30. Took 0.2776 seconds. 
  Full-batch training loss = 2.183619, test loss = 2.183413
  Training set accuracy = 0.469200, Test set accuracy = 0.466600
 epoch 12/30. Took 0.28462 seconds. 
  Full-batch training loss = 2.166517, test loss = 2.166105
  Training set accuracy = 0.511200, Test set accuracy = 0.506900
 epoch 13/30. Took 0.30304 seconds. 
  Full-batch training loss = 2.147496, test loss = 2.146886
  Training set accuracy = 0.542300, Test set accuracy = 0.539000
 epoch 14/30. Took 0.28538 seconds. 
  Full-batch training loss = 2.127033, test loss = 2.126103
  Training set accuracy = 0.571100, Test set accuracy = 0.568200
 epoch 15/30. Took 0.27188 seconds. 
  Full-batch training loss = 2.104375, test loss = 2.103163
  Training set accuracy = 0.589800, Test set accuracy = 0.589400
 epoch 16/30. Took 0.28596 seconds. 
  Full-batch training loss = 2.080216, test loss = 2.078628
  Training set accuracy = 0.609000, Test set accuracy = 0.609100
 epoch 17/30. Took 0.28531 seconds. 
  Full-batch training loss = 2.052950, test loss = 2.051023
  Training set accuracy = 0.622100, Test set accuracy = 0.622600
 epoch 18/30. Took 0.28564 seconds. 
  Full-batch training loss = 2.024277, test loss = 2.021931
  Training set accuracy = 0.639700, Test set accuracy = 0.639700
 epoch 19/30. Took 0.28508 seconds. 
  Full-batch training loss = 1.993003, test loss = 1.990143
  Training set accuracy = 0.652600, Test set accuracy = 0.652400
 epoch 20/30. Took 0.27537 seconds. 
  Full-batch training loss = 1.959391, test loss = 1.956051
  Training set accuracy = 0.662700, Test set accuracy = 0.662400
 epoch 21/30. Took 0.27217 seconds. 
  Full-batch training loss = 1.923597, test loss = 1.919676
  Training set accuracy = 0.673100, Test set accuracy = 0.672800
 epoch 22/30. Took 0.28533 seconds. 
  Full-batch training loss = 1.885958, test loss = 1.881384
  Training set accuracy = 0.685700, Test set accuracy = 0.682800
 epoch 23/30. Took 0.28806 seconds. 
  Full-batch training loss = 1.846620, test loss = 1.841318
  Training set accuracy = 0.695600, Test set accuracy = 0.692200
 epoch 24/30. Took 0.28583 seconds. 
  Full-batch training loss = 1.805306, test loss = 1.799327
  Training set accuracy = 0.703500, Test set accuracy = 0.701900
 epoch 25/30. Took 0.28482 seconds. 
  Full-batch training loss = 1.761448, test loss = 1.754800
  Training set accuracy = 0.708600, Test set accuracy = 0.708200
 epoch 26/30. Took 0.28477 seconds. 
  Full-batch training loss = 1.716309, test loss = 1.708827
  Training set accuracy = 0.715700, Test set accuracy = 0.717400
 epoch 27/30. Took 0.28458 seconds. 
  Full-batch training loss = 1.670373, test loss = 1.662126
  Training set accuracy = 0.721600, Test set accuracy = 0.722900
 epoch 28/30. Took 0.28453 seconds. 
  Full-batch training loss = 1.623802, test loss = 1.614697
  Training set accuracy = 0.726900, Test set accuracy = 0.730200
 epoch 29/30. Took 0.29281 seconds. 
  Full-batch training loss = 1.576167, test loss = 1.566339
  Training set accuracy = 0.731000, Test set accuracy = 0.733800
 epoch 30/30. Took 0.28496 seconds. 
  Full-batch training loss = 1.528851, test loss = 1.518221
  Training set accuracy = 0.736500, Test set accuracy = 0.739700
Elapsed time is 15.853238 seconds.
End Training
-----
Params 10000 0.001 0.50 2 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (200  200)
Training NN  (784  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.46966 seconds. 
  Full-batch training loss = 2.299231, test loss = 2.299144
  Training set accuracy = 0.117800, Test set accuracy = 0.116000
 epoch 2/30. Took 0.46477 seconds. 
  Full-batch training loss = 2.290694, test loss = 2.290400
  Training set accuracy = 0.134700, Test set accuracy = 0.133000
 epoch 3/30. Took 0.474 seconds. 
  Full-batch training loss = 2.282009, test loss = 2.281559
  Training set accuracy = 0.155800, Test set accuracy = 0.157700
 epoch 4/30. Took 0.47406 seconds. 
  Full-batch training loss = 2.273187, test loss = 2.272524
  Training set accuracy = 0.182800, Test set accuracy = 0.187800
 epoch 5/30. Took 0.46996 seconds. 
  Full-batch training loss = 2.264031, test loss = 2.263165
  Training set accuracy = 0.208800, Test set accuracy = 0.217700
 epoch 6/30. Took 0.47514 seconds. 
  Full-batch training loss = 2.254256, test loss = 2.253188
  Training set accuracy = 0.243900, Test set accuracy = 0.253000
 epoch 7/30. Took 0.48686 seconds. 
  Full-batch training loss = 2.243849, test loss = 2.242586
  Training set accuracy = 0.290900, Test set accuracy = 0.302700
 epoch 8/30. Took 0.47404 seconds. 
  Full-batch training loss = 2.232554, test loss = 2.231090
  Training set accuracy = 0.385600, Test set accuracy = 0.394800
 epoch 9/30. Took 0.4735 seconds. 
  Full-batch training loss = 2.220075, test loss = 2.218406
  Training set accuracy = 0.442900, Test set accuracy = 0.453400
 epoch 10/30. Took 0.48855 seconds. 
  Full-batch training loss = 2.206517, test loss = 2.204624
  Training set accuracy = 0.477500, Test set accuracy = 0.492200
 epoch 11/30. Took 0.46615 seconds. 
  Full-batch training loss = 2.191345, test loss = 2.189198
  Training set accuracy = 0.504700, Test set accuracy = 0.521200
 epoch 12/30. Took 0.46896 seconds. 
  Full-batch training loss = 2.174461, test loss = 2.172062
  Training set accuracy = 0.528600, Test set accuracy = 0.546800
 epoch 13/30. Took 0.47667 seconds. 
  Full-batch training loss = 2.155835, test loss = 2.153121
  Training set accuracy = 0.555700, Test set accuracy = 0.569200
 epoch 14/30. Took 0.4683 seconds. 
  Full-batch training loss = 2.134735, test loss = 2.131699
  Training set accuracy = 0.572200, Test set accuracy = 0.580700
 epoch 15/30. Took 0.46814 seconds. 
  Full-batch training loss = 2.111595, test loss = 2.108221
  Training set accuracy = 0.586600, Test set accuracy = 0.596200
 epoch 16/30. Took 0.49435 seconds. 
  Full-batch training loss = 2.085823, test loss = 2.082037
  Training set accuracy = 0.600800, Test set accuracy = 0.610300
 epoch 17/30. Took 0.47066 seconds. 
  Full-batch training loss = 2.057533, test loss = 2.053303
  Training set accuracy = 0.612100, Test set accuracy = 0.621500
 epoch 18/30. Took 0.50107 seconds. 
  Full-batch training loss = 2.025883, test loss = 2.021132
  Training set accuracy = 0.623400, Test set accuracy = 0.630500
 epoch 19/30. Took 0.47569 seconds. 
  Full-batch training loss = 1.991909, test loss = 1.986627
  Training set accuracy = 0.630800, Test set accuracy = 0.640800
 epoch 20/30. Took 0.49217 seconds. 
  Full-batch training loss = 1.954544, test loss = 1.948666
  Training set accuracy = 0.637100, Test set accuracy = 0.643900
 epoch 21/30. Took 0.48678 seconds. 
  Full-batch training loss = 1.914415, test loss = 1.907890
  Training set accuracy = 0.646800, Test set accuracy = 0.652200
 epoch 22/30. Took 0.47492 seconds. 
  Full-batch training loss = 1.871329, test loss = 1.864142
  Training set accuracy = 0.659000, Test set accuracy = 0.661500
 epoch 23/30. Took 0.48441 seconds. 
  Full-batch training loss = 1.825240, test loss = 1.817344
  Training set accuracy = 0.670700, Test set accuracy = 0.670500
 epoch 24/30. Took 0.48763 seconds. 
  Full-batch training loss = 1.776612, test loss = 1.767926
  Training set accuracy = 0.679700, Test set accuracy = 0.677600
 epoch 25/30. Took 0.47272 seconds. 
  Full-batch training loss = 1.725166, test loss = 1.715667
  Training set accuracy = 0.688300, Test set accuracy = 0.685700
 epoch 26/30. Took 0.47451 seconds. 
  Full-batch training loss = 1.672246, test loss = 1.662030
  Training set accuracy = 0.694200, Test set accuracy = 0.692700
 epoch 27/30. Took 0.46712 seconds. 
  Full-batch training loss = 1.618066, test loss = 1.607095
  Training set accuracy = 0.701300, Test set accuracy = 0.701700
 epoch 28/30. Took 0.47428 seconds. 
  Full-batch training loss = 1.563633, test loss = 1.552086
  Training set accuracy = 0.711000, Test set accuracy = 0.710600
 epoch 29/30. Took 0.48878 seconds. 
  Full-batch training loss = 1.508888, test loss = 1.496712
  Training set accuracy = 0.715500, Test set accuracy = 0.716400
 epoch 30/30. Took 0.48969 seconds. 
  Full-batch training loss = 1.454598, test loss = 1.441879
  Training set accuracy = 0.724500, Test set accuracy = 0.723300
Elapsed time is 25.095806 seconds.
End Training
-----
Params 10000 0.001 0.50 2 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 2 (500  500)
Training NN  (784  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.2694 seconds. 
  Full-batch training loss = 2.289346, test loss = 2.288559
  Training set accuracy = 0.175200, Test set accuracy = 0.185600
 epoch 2/30. Took 1.2132 seconds. 
  Full-batch training loss = 2.278198, test loss = 2.277295
  Training set accuracy = 0.230200, Test set accuracy = 0.231000
 epoch 3/30. Took 1.2066 seconds. 
  Full-batch training loss = 2.266855, test loss = 2.265825
  Training set accuracy = 0.271600, Test set accuracy = 0.268100
 epoch 4/30. Took 1.2483 seconds. 
  Full-batch training loss = 2.255006, test loss = 2.253839
  Training set accuracy = 0.304900, Test set accuracy = 0.303400
 epoch 5/30. Took 1.2337 seconds. 
  Full-batch training loss = 2.242494, test loss = 2.241192
  Training set accuracy = 0.334600, Test set accuracy = 0.336400
 epoch 6/30. Took 1.2408 seconds. 
  Full-batch training loss = 2.229075, test loss = 2.227646
  Training set accuracy = 0.382900, Test set accuracy = 0.385300
 epoch 7/30. Took 1.2005 seconds. 
  Full-batch training loss = 2.214452, test loss = 2.212882
  Training set accuracy = 0.442800, Test set accuracy = 0.449900
 epoch 8/30. Took 1.2302 seconds. 
  Full-batch training loss = 2.198330, test loss = 2.196632
  Training set accuracy = 0.484300, Test set accuracy = 0.493400
 epoch 9/30. Took 1.2206 seconds. 
  Full-batch training loss = 2.180640, test loss = 2.178802
  Training set accuracy = 0.514600, Test set accuracy = 0.526800
 epoch 10/30. Took 1.2177 seconds. 
  Full-batch training loss = 2.161099, test loss = 2.159119
  Training set accuracy = 0.542100, Test set accuracy = 0.549900
 epoch 11/30. Took 1.2029 seconds. 
  Full-batch training loss = 2.139255, test loss = 2.137127
  Training set accuracy = 0.562100, Test set accuracy = 0.568400
 epoch 12/30. Took 1.3003 seconds. 
  Full-batch training loss = 2.114809, test loss = 2.112554
  Training set accuracy = 0.576600, Test set accuracy = 0.587700
 epoch 13/30. Took 1.2556 seconds. 
  Full-batch training loss = 2.087591, test loss = 2.085181
  Training set accuracy = 0.594500, Test set accuracy = 0.602100
 epoch 14/30. Took 1.2546 seconds. 
  Full-batch training loss = 2.056789, test loss = 2.054196
  Training set accuracy = 0.606000, Test set accuracy = 0.613500
 epoch 15/30. Took 1.208 seconds. 
  Full-batch training loss = 2.022699, test loss = 2.019837
  Training set accuracy = 0.619800, Test set accuracy = 0.625000
 epoch 16/30. Took 1.2137 seconds. 
  Full-batch training loss = 1.984429, test loss = 1.981272
  Training set accuracy = 0.632800, Test set accuracy = 0.638800
 epoch 17/30. Took 1.2192 seconds. 
  Full-batch training loss = 1.942495, test loss = 1.938937
  Training set accuracy = 0.644100, Test set accuracy = 0.650400
 epoch 18/30. Took 1.2029 seconds. 
  Full-batch training loss = 1.896512, test loss = 1.892493
  Training set accuracy = 0.656000, Test set accuracy = 0.662900
 epoch 19/30. Took 1.1984 seconds. 
  Full-batch training loss = 1.846912, test loss = 1.842319
  Training set accuracy = 0.669300, Test set accuracy = 0.676500
 epoch 20/30. Took 1.2177 seconds. 
  Full-batch training loss = 1.793610, test loss = 1.788402
  Training set accuracy = 0.680600, Test set accuracy = 0.687800
 epoch 21/30. Took 1.2641 seconds. 
  Full-batch training loss = 1.736914, test loss = 1.731002
  Training set accuracy = 0.689800, Test set accuracy = 0.698100
 epoch 22/30. Took 1.2246 seconds. 
  Full-batch training loss = 1.677760, test loss = 1.671040
  Training set accuracy = 0.701400, Test set accuracy = 0.712300
 epoch 23/30. Took 1.2015 seconds. 
  Full-batch training loss = 1.616659, test loss = 1.609238
  Training set accuracy = 0.712200, Test set accuracy = 0.721700
 epoch 24/30. Took 1.2215 seconds. 
  Full-batch training loss = 1.554043, test loss = 1.545664
  Training set accuracy = 0.727500, Test set accuracy = 0.736900
 epoch 25/30. Took 1.2135 seconds. 
  Full-batch training loss = 1.490818, test loss = 1.481481
  Training set accuracy = 0.735800, Test set accuracy = 0.747000
 epoch 26/30. Took 1.2026 seconds. 
  Full-batch training loss = 1.427543, test loss = 1.417359
  Training set accuracy = 0.745400, Test set accuracy = 0.757100
 epoch 27/30. Took 1.2067 seconds. 
  Full-batch training loss = 1.365996, test loss = 1.354984
  Training set accuracy = 0.756800, Test set accuracy = 0.768500
 epoch 28/30. Took 1.213 seconds. 
  Full-batch training loss = 1.306146, test loss = 1.294413
  Training set accuracy = 0.764200, Test set accuracy = 0.775600
 epoch 29/30. Took 1.2138 seconds. 
  Full-batch training loss = 1.248333, test loss = 1.236087
  Training set accuracy = 0.769000, Test set accuracy = 0.780100
 epoch 30/30. Took 1.2051 seconds. 
  Full-batch training loss = 1.193222, test loss = 1.180267
  Training set accuracy = 0.776500, Test set accuracy = 0.785900
Elapsed time is 62.645436 seconds.
End Training
-----
Params 10000 0.001 0.50 3 100
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (100  100  100)
Training NN  (784  100  100  100   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.34007 seconds. 
  Full-batch training loss = 2.306281, test loss = 2.304957
  Training set accuracy = 0.102300, Test set accuracy = 0.103100
 epoch 2/30. Took 0.33698 seconds. 
  Full-batch training loss = 2.304574, test loss = 2.303420
  Training set accuracy = 0.102200, Test set accuracy = 0.102900
 epoch 3/30. Took 0.33061 seconds. 
  Full-batch training loss = 2.302978, test loss = 2.301971
  Training set accuracy = 0.102200, Test set accuracy = 0.102800
 epoch 4/30. Took 0.31867 seconds. 
  Full-batch training loss = 2.301454, test loss = 2.300603
  Training set accuracy = 0.102200, Test set accuracy = 0.102800
 epoch 5/30. Took 0.33639 seconds. 
  Full-batch training loss = 2.300016, test loss = 2.299308
  Training set accuracy = 0.102200, Test set accuracy = 0.102800
 epoch 6/30. Took 0.33854 seconds. 
  Full-batch training loss = 2.298631, test loss = 2.298047
  Training set accuracy = 0.102200, Test set accuracy = 0.102800
 epoch 7/30. Took 0.34908 seconds. 
  Full-batch training loss = 2.297341, test loss = 2.296873
  Training set accuracy = 0.102200, Test set accuracy = 0.102800
 epoch 8/30. Took 0.33345 seconds. 
  Full-batch training loss = 2.296027, test loss = 2.295669
  Training set accuracy = 0.102200, Test set accuracy = 0.102800
 epoch 9/30. Took 0.33751 seconds. 
  Full-batch training loss = 2.294733, test loss = 2.294486
  Training set accuracy = 0.102200, Test set accuracy = 0.102800
 epoch 10/30. Took 0.33904 seconds. 
  Full-batch training loss = 2.293434, test loss = 2.293293
  Training set accuracy = 0.102200, Test set accuracy = 0.102900
 epoch 11/30. Took 0.33956 seconds. 
  Full-batch training loss = 2.292138, test loss = 2.292087
  Training set accuracy = 0.103000, Test set accuracy = 0.103100
 epoch 12/30. Took 0.321 seconds. 
  Full-batch training loss = 2.290860, test loss = 2.290905
  Training set accuracy = 0.114600, Test set accuracy = 0.116200
 epoch 13/30. Took 0.32364 seconds. 
  Full-batch training loss = 2.289556, test loss = 2.289680
  Training set accuracy = 0.158100, Test set accuracy = 0.159900
 epoch 14/30. Took 0.33255 seconds. 
  Full-batch training loss = 2.288257, test loss = 2.288465
  Training set accuracy = 0.193900, Test set accuracy = 0.194300
 epoch 15/30. Took 0.33837 seconds. 
  Full-batch training loss = 2.286888, test loss = 2.287172
  Training set accuracy = 0.218400, Test set accuracy = 0.219400
 epoch 16/30. Took 0.32729 seconds. 
  Full-batch training loss = 2.285485, test loss = 2.285850
  Training set accuracy = 0.218500, Test set accuracy = 0.217600
 epoch 17/30. Took 0.34071 seconds. 
  Full-batch training loss = 2.284094, test loss = 2.284527
  Training set accuracy = 0.217400, Test set accuracy = 0.214500
 epoch 18/30. Took 0.33693 seconds. 
  Full-batch training loss = 2.282612, test loss = 2.283116
  Training set accuracy = 0.211600, Test set accuracy = 0.209000
 epoch 19/30. Took 0.33657 seconds. 
  Full-batch training loss = 2.281133, test loss = 2.281693
  Training set accuracy = 0.207100, Test set accuracy = 0.204400
 epoch 20/30. Took 0.3376 seconds. 
  Full-batch training loss = 2.279616, test loss = 2.280237
  Training set accuracy = 0.205600, Test set accuracy = 0.201900
 epoch 21/30. Took 0.32755 seconds. 
  Full-batch training loss = 2.277992, test loss = 2.278662
  Training set accuracy = 0.203400, Test set accuracy = 0.199400
 epoch 22/30. Took 0.33449 seconds. 
  Full-batch training loss = 2.276337, test loss = 2.277064
  Training set accuracy = 0.204100, Test set accuracy = 0.198400
 epoch 23/30. Took 0.33784 seconds. 
  Full-batch training loss = 2.274559, test loss = 2.275333
  Training set accuracy = 0.212200, Test set accuracy = 0.207400
 epoch 24/30. Took 0.33595 seconds. 
  Full-batch training loss = 2.272720, test loss = 2.273540
  Training set accuracy = 0.226900, Test set accuracy = 0.220900
 epoch 25/30. Took 0.33711 seconds. 
  Full-batch training loss = 2.270831, test loss = 2.271694
  Training set accuracy = 0.239300, Test set accuracy = 0.234300
 epoch 26/30. Took 0.32022 seconds. 
  Full-batch training loss = 2.268854, test loss = 2.269741
  Training set accuracy = 0.251400, Test set accuracy = 0.246500
 epoch 27/30. Took 0.33789 seconds. 
  Full-batch training loss = 2.266758, test loss = 2.267688
  Training set accuracy = 0.260600, Test set accuracy = 0.256600
 epoch 28/30. Took 0.33672 seconds. 
  Full-batch training loss = 2.264459, test loss = 2.265427
  Training set accuracy = 0.267600, Test set accuracy = 0.262400
 epoch 29/30. Took 0.33726 seconds. 
  Full-batch training loss = 2.262113, test loss = 2.263129
  Training set accuracy = 0.273000, Test set accuracy = 0.267100
 epoch 30/30. Took 0.33706 seconds. 
  Full-batch training loss = 2.259522, test loss = 2.260576
  Training set accuracy = 0.278700, Test set accuracy = 0.272300
Elapsed time is 18.175943 seconds.
End Training
-----
Params 10000 0.001 0.50 3 200
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (200  200  200)
Training NN  (784  200  200  200   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 0.55985 seconds. 
  Full-batch training loss = 2.303208, test loss = 2.302437
  Training set accuracy = 0.115700, Test set accuracy = 0.116200
 epoch 2/30. Took 0.57263 seconds. 
  Full-batch training loss = 2.302145, test loss = 2.301443
  Training set accuracy = 0.139900, Test set accuracy = 0.139800
 epoch 3/30. Took 0.57206 seconds. 
  Full-batch training loss = 2.301093, test loss = 2.300446
  Training set accuracy = 0.137200, Test set accuracy = 0.136100
 epoch 4/30. Took 0.59511 seconds. 
  Full-batch training loss = 2.300064, test loss = 2.299472
  Training set accuracy = 0.125300, Test set accuracy = 0.124100
 epoch 5/30. Took 0.5792 seconds. 
  Full-batch training loss = 2.299108, test loss = 2.298567
  Training set accuracy = 0.117600, Test set accuracy = 0.116900
 epoch 6/30. Took 0.57446 seconds. 
  Full-batch training loss = 2.298163, test loss = 2.297665
  Training set accuracy = 0.115300, Test set accuracy = 0.114600
 epoch 7/30. Took 0.55825 seconds. 
  Full-batch training loss = 2.297221, test loss = 2.296766
  Training set accuracy = 0.114700, Test set accuracy = 0.113800
 epoch 8/30. Took 0.57451 seconds. 
  Full-batch training loss = 2.296276, test loss = 2.295860
  Training set accuracy = 0.114600, Test set accuracy = 0.113700
 epoch 9/30. Took 0.61202 seconds. 
  Full-batch training loss = 2.295349, test loss = 2.294965
  Training set accuracy = 0.114600, Test set accuracy = 0.113600
 epoch 10/30. Took 0.60368 seconds. 
  Full-batch training loss = 2.294427, test loss = 2.294078
  Training set accuracy = 0.114600, Test set accuracy = 0.113500
 epoch 11/30. Took 0.56419 seconds. 
  Full-batch training loss = 2.293512, test loss = 2.293189
  Training set accuracy = 0.114600, Test set accuracy = 0.113500
 epoch 12/30. Took 0.55256 seconds. 
  Full-batch training loss = 2.292573, test loss = 2.292273
  Training set accuracy = 0.114600, Test set accuracy = 0.113500
 epoch 13/30. Took 0.57099 seconds. 
  Full-batch training loss = 2.291624, test loss = 2.291347
  Training set accuracy = 0.114600, Test set accuracy = 0.113500
 epoch 14/30. Took 0.57299 seconds. 
  Full-batch training loss = 2.290627, test loss = 2.290371
  Training set accuracy = 0.114600, Test set accuracy = 0.113500
 epoch 15/30. Took 0.5749 seconds. 
  Full-batch training loss = 2.289604, test loss = 2.289363
  Training set accuracy = 0.114600, Test set accuracy = 0.113500
 epoch 16/30. Took 0.57414 seconds. 
  Full-batch training loss = 2.288612, test loss = 2.288377
  Training set accuracy = 0.114600, Test set accuracy = 0.113500
 epoch 17/30. Took 0.57578 seconds. 
  Full-batch training loss = 2.287547, test loss = 2.287328
  Training set accuracy = 0.114500, Test set accuracy = 0.113500
 epoch 18/30. Took 0.5696 seconds. 
  Full-batch training loss = 2.286455, test loss = 2.286234
  Training set accuracy = 0.114500, Test set accuracy = 0.113500
 epoch 19/30. Took 0.5689 seconds. 
  Full-batch training loss = 2.285310, test loss = 2.285094
  Training set accuracy = 0.114500, Test set accuracy = 0.113500
 epoch 20/30. Took 0.57599 seconds. 
  Full-batch training loss = 2.284139, test loss = 2.283919
  Training set accuracy = 0.114500, Test set accuracy = 0.113500
 epoch 21/30. Took 0.55129 seconds. 
  Full-batch training loss = 2.282906, test loss = 2.282679
  Training set accuracy = 0.114500, Test set accuracy = 0.113600
 epoch 22/30. Took 0.57408 seconds. 
  Full-batch training loss = 2.281572, test loss = 2.281339
  Training set accuracy = 0.114600, Test set accuracy = 0.113700
 epoch 23/30. Took 0.5535 seconds. 
  Full-batch training loss = 2.280197, test loss = 2.279955
  Training set accuracy = 0.115300, Test set accuracy = 0.114600
 epoch 24/30. Took 0.55907 seconds. 
  Full-batch training loss = 2.278740, test loss = 2.278488
  Training set accuracy = 0.117600, Test set accuracy = 0.116600
 epoch 25/30. Took 0.62364 seconds. 
  Full-batch training loss = 2.277199, test loss = 2.276938
  Training set accuracy = 0.121600, Test set accuracy = 0.121300
 epoch 26/30. Took 0.57466 seconds. 
  Full-batch training loss = 2.275514, test loss = 2.275246
  Training set accuracy = 0.128000, Test set accuracy = 0.128700
 epoch 27/30. Took 0.55729 seconds. 
  Full-batch training loss = 2.273755, test loss = 2.273461
  Training set accuracy = 0.137800, Test set accuracy = 0.139700
 epoch 28/30. Took 0.57586 seconds. 
  Full-batch training loss = 2.271864, test loss = 2.271561
  Training set accuracy = 0.151300, Test set accuracy = 0.152500
 epoch 29/30. Took 0.59264 seconds. 
  Full-batch training loss = 2.269869, test loss = 2.269544
  Training set accuracy = 0.171900, Test set accuracy = 0.171600
 epoch 30/30. Took 0.57729 seconds. 
  Full-batch training loss = 2.267735, test loss = 2.267388
  Training set accuracy = 0.193800, Test set accuracy = 0.198000
Elapsed time is 30.480916 seconds.
End Training
-----
Params 10000 0.001 0.50 3 500
Setting parameters
Start Training
Number of training examples: 10000
Number of inputs: 784
Number of outputs: 10
Number of hidden layers: 3 (500  500  500)
Training NN  (784  500  500  500   10) with BackPropagation for 30 epochs (batchsize: 100)
 epoch 1/30. Took 1.7291 seconds. 
  Full-batch training loss = 2.301543, test loss = 2.300189
  Training set accuracy = 0.108500, Test set accuracy = 0.113700
 epoch 2/30. Took 1.6699 seconds. 
  Full-batch training loss = 2.299792, test loss = 2.298484
  Training set accuracy = 0.108600, Test set accuracy = 0.113800
 epoch 3/30. Took 1.677 seconds. 
  Full-batch training loss = 2.298085, test loss = 2.296817
  Training set accuracy = 0.108500, Test set accuracy = 0.113800
 epoch 4/30. Took 1.6649 seconds. 
  Full-batch training loss = 2.296396, test loss = 2.295166
  Training set accuracy = 0.108600, Test set accuracy = 0.113900
 epoch 5/30. Took 1.6579 seconds. 
  Full-batch training loss = 2.294681, test loss = 2.293489
  Training set accuracy = 0.108900, Test set accuracy = 0.114100
 epoch 6/30. Took 1.7312 seconds. 
  Full-batch training loss = 2.293001, test loss = 2.291835
  Training set accuracy = 0.110100, Test set accuracy = 0.115300
 epoch 7/30. Took 1.6924 seconds. 
  Full-batch training loss = 2.291303, test loss = 2.290161
  Training set accuracy = 0.113400, Test set accuracy = 0.119700
 epoch 8/30. Took 1.6933 seconds. 
  Full-batch training loss = 2.289539, test loss = 2.288423
  Training set accuracy = 0.117600, Test set accuracy = 0.124700
 epoch 9/30. Took 1.6593 seconds. 
  Full-batch training loss = 2.287771, test loss = 2.286669
  Training set accuracy = 0.126700, Test set accuracy = 0.135400
 epoch 10/30. Took 1.6575 seconds. 
  Full-batch training loss = 2.285937, test loss = 2.284844
  Training set accuracy = 0.144400, Test set accuracy = 0.151500
 epoch 11/30. Took 1.6575 seconds. 
  Full-batch training loss = 2.284079, test loss = 2.282997
  Training set accuracy = 0.165800, Test set accuracy = 0.175100
 epoch 12/30. Took 1.676 seconds. 
  Full-batch training loss = 2.282114, test loss = 2.281040
  Training set accuracy = 0.195000, Test set accuracy = 0.201700
 epoch 13/30. Took 1.6578 seconds. 
  Full-batch training loss = 2.280056, test loss = 2.278994
  Training set accuracy = 0.223900, Test set accuracy = 0.227500
 epoch 14/30. Took 1.6688 seconds. 
  Full-batch training loss = 2.277928, test loss = 2.276862
  Training set accuracy = 0.244900, Test set accuracy = 0.247800
 epoch 15/30. Took 1.6528 seconds. 
  Full-batch training loss = 2.275675, test loss = 2.274612
  Training set accuracy = 0.259400, Test set accuracy = 0.262700
 epoch 16/30. Took 1.6858 seconds. 
  Full-batch training loss = 2.273322, test loss = 2.272260
  Training set accuracy = 0.269700, Test set accuracy = 0.271600
 epoch 17/30. Took 1.7179 seconds. 
  Full-batch training loss = 2.270832, test loss = 2.269764
  Training set accuracy = 0.280300, Test set accuracy = 0.281600
 epoch 18/30. Took 1.6852 seconds. 
  Full-batch training loss = 2.268156, test loss = 2.267076
  Training set accuracy = 0.287500, Test set accuracy = 0.290600
 epoch 19/30. Took 1.6662 seconds. 
  Full-batch training loss = 2.265329, test loss = 2.264239
  Training set accuracy = 0.290700, Test set accuracy = 0.298300
 epoch 20/30. Took 1.7453 seconds. 
  Full-batch training loss = 2.262296, test loss = 2.261199
  Training set accuracy = 0.296300, Test set accuracy = 0.308300
 epoch 21/30. Took 1.7025 seconds. 
  Full-batch training loss = 2.259050, test loss = 2.257943
  Training set accuracy = 0.300000, Test set accuracy = 0.314900
 epoch 22/30. Took 1.7045 seconds. 
  Full-batch training loss = 2.255563, test loss = 2.254440
  Training set accuracy = 0.301700, Test set accuracy = 0.318800
 epoch 23/30. Took 1.7719 seconds. 
  Full-batch training loss = 2.251755, test loss = 2.250620
  Training set accuracy = 0.301400, Test set accuracy = 0.321400
 epoch 24/30. Took 1.6954 seconds. 
  Full-batch training loss = 2.247621, test loss = 2.246463
  Training set accuracy = 0.304100, Test set accuracy = 0.324600
 epoch 25/30. Took 1.6918 seconds. 
  Full-batch training loss = 2.243144, test loss = 2.241980
  Training set accuracy = 0.306000, Test set accuracy = 0.326900
 epoch 26/30. Took 1.6907 seconds. 
  Full-batch training loss = 2.238313, test loss = 2.237139
  Training set accuracy = 0.305700, Test set accuracy = 0.328000
 epoch 27/30. Took 1.6614 seconds. 
  Full-batch training loss = 2.233054, test loss = 2.231853
  Training set accuracy = 0.310200, Test set accuracy = 0.330900
 epoch 28/30. Took 1.6583 seconds. 
  Full-batch training loss = 2.227312, test loss = 2.226088
  Training set accuracy = 0.314300, Test set accuracy = 0.333500
 epoch 29/30. Took 1.7008 seconds. 
  Full-batch training loss = 2.221072, test loss = 2.219836
  Training set accuracy = 0.313400, Test set accuracy = 0.330900
 epoch 30/30. Took 1.6635 seconds. 
  Full-batch training loss = 2.214331, test loss = 2.213065
  Training set accuracy = 0.318200, Test set accuracy = 0.335300
Elapsed time is 86.318641 seconds.
End Training
-----
